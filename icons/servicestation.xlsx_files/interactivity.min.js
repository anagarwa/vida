var interactivity=(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[22],{1636:function(e,t,n){"use strict";n.d(t,"a",(function(){return At}));var r=n(82),a=n(81),i=n(214),o=n(2209);const s=["auxclick","click","contextmenu","dblclick","mousedown","mouseenter","mouseleave","mouseout","mouseover","mouseup","pointerover","pointerenter","pointerdown","pointerup","pointercancel","pointerout","pointerleave","gotpointercapture","lostpointercapture","touchstart","touchend","touchcancel","keydown","keypress","keyup","beforeinput","input","compositionstart","compositionupdate","compositionend","dragstart","dragend","dragenter","dragleave","dragover","drop"],c={events:["click","keypress","mousedown"],durationThresholdInMs:100};let l={},u={};function d(e="EndOfState"){const t=m(e);return JSON.parse(JSON.stringify(t))}function m(e){switch(e){case"Periodic":return u;case"EndOfState":return l;default:return r.a.sendTraceTag(508303315,a.a.msoulscat_Wac_BrowserGeneral,i.a.Error,"InteractivityTracker.getTrackedUserActionReportMap wrong report mode"),l}}function f(e,t,n=1){Ee()||p(e,t,"EndOfState",n),Ie()&&p(e,t,"Periodic",n)}function p(e,t,n,r=1){const a=v(e,n);"total"===t&&(a.total+=r),"slow"===t&&(a.slow+=r)}function v(e,t="EndOfState"){const n=m(t);let r=n[e.action];return r||(r={total:0,slow:0,actionBucket:e.actionBucket},n[e.action]=r),r}function T(){Ee()||(l={}),Ie()&&(u={})}let g=void 0;const h={};function w(e){return h[e]}function k(e){let t=-1;const n=Se();e.getEntries().forEach(e=>{const o=e.entryType;r.a.shipAssertTag(539829780,a.a.msoulscat_Wac_BrowserGeneral,"event"===o,"ResponsivenessTracker:handleObservedEvents - unexpected observed entry type: "+o),function(e,t){if(!w(e.name))return;const n=function(e){return Ze(et(e.name,e.startTime))}(e);if(function(e,t,n){const r=t[0];return void 0!==r.state&&r.state!==n&&(Ze(et(e.name,e.startTime)),!0)}(e,n,t))return;const o=e.startTime+e.duration;n.forEach(t=>{"undefined"!==t.action?(function(e,t,n){const{deviceMemory:o,hardwareConcurrency:s}=le(),c=t.name,l=`InteractivityTracker:logSlowEvent - EventTiming - state: ${e.state}, userAction: ${e.action}, eventName: ${c}, eventStartToNextFrame: ${t.duration.toFixed(2)}, startTime: ${t.startTime.toFixed(2)}, processingStart: ${t.processingStart.toFixed(2)}, processingEnd: ${t.processingEnd.toFixed(2)}, renderTime: ${n.toFixed(2)}, `+me()+", "+` deviceMemory: ${o}, hardwareConcurrency: ${s}`+`, actionBucket: ${ke(e)}, context: ${JSON.stringify(e.contexts)}`;r.a.sendTraceTag(137704134,a.a.msoulscat_Wac_BrowserGeneral,i.a.Info,l);const u={};e.contexts.forEach(e=>{u[e.itemKey]=e.value});const d={};d.state=e.state,d.userAction=e.action,d.eventName=c,d.eventStartToNextFrame=t.duration.toFixed(2),d.startTime=t.startTime.toFixed(2),d.processingStart=t.processingStart.toFixed(2),d.processingEnd=t.processingEnd.toFixed(2),d.renderTime=n.toFixed(2),d.appInfo=me(),d.deviceMemory=o,d.hardwareConcurrency=s,d.actionBucket=ke(e),d.contexts=u;const m=JSON.stringify(d);var f,p,v;r.a.sendTraceTag(137704576,a.a.msoulscat_Wac_BrowserGeneral,i.a.Info,m),he("VSO:8185150")&&(f=m,null===(p=x)||void 0===p||null===(v=p.logSlowActionsHandler)||void 0===v||v.call(p,f))}(t,e,o),Qe(e.startTime,t,o)):r.a.sendTraceTag(523621256,a.a.msoulscat_Wac_BrowserGeneral,i.a.Info,"ResponsivenessTracker:processEventTimingEntry - undefined slow action, probably due to duplicate slow actions")})}(e,n),e.startTime>t&&(t=e.startTime)}),function(e){let t=0;for(const n in xe){const r=tt(n);r&&r<e&&performance.now()-r>3e3&&(Ze(n),t+=1)}r.a.sendTraceTag(539829781,a.a.msoulscat_Wac_BrowserGeneral,i.a.Info,`InteractivityTracker:clearTrackedEventsToUserAction - cleared ${t} tracked events}`)}(t)}let y=300,A=void 0,S=1e4;const _=new Map,E=new Set;function I(e,t,n,o,s){let c=void 0;for(const l of o)if(!l.isReported&&!(e.renderTime-l.startTime>S)&&l.startTime<=n&&(!c||l.startTime>c.startTime)){if(c&&!c.isReportedAsDuplicate){c.isReportedAsDuplicate=!0;const e={matchingUserActionStartTime:c.startTime,userActionStartTime:l.startTime,identifier:t,uiMutationTime:n,userActionContexts:l.contexts,contextValue:s};r.a.sendTraceTag(508072512,a.a.msoulscat_Wac_BrowserGeneral,i.a.Info,"AsyncUiTracker:handleObservedEvents - more than one matching pending entry: "+JSON.stringify(e))}c=l}return c}function b(e){const t=e.getEntries();for(const e of t){const t=e.identifier;if(!t){Object({NODE_ENV:"production"}).DEBUG&&r.a.debugAssertTag(508065293,a.a.msoulscat_Wac_BrowserGeneral,!1,"asyncUiTracker.handleObservedEvents - missing identifier on entry");continue}const n=e.element,o=null==n?void 0:n.getAttribute("data-ui-mutation-time");if(!o)continue;const s=$e[t],c=null==n?void 0:n.getAttribute("data-ui-mutation-context-value"),l=null==n?void 0:n.getAttribute("data-ui-mutation-remove-element");if(he("OfficeVSO:8650749_shouldRemoveElementFromDom")&&l&&(window.requestIdleCallback?window.requestIdleCallback(()=>B(n)):setTimeout(()=>B(n),0)),!s||0===s.length){r.a.sendTraceTag(508121942,a.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,`AsyncUiTracker:handleObservedEvents - missing pending entry, identifier = ${t}, contextValue = ${c}`);continue}const u=parseFloat(o),d=I(e,t,u,s,c);d?(Boolean(c)&&(d.action=c),C(e,Se(),d)):r.a.sendTraceTag(508121941,a.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,`AsyncUiTracker:handleObservedEvents - no matching pending entry, identifier = ${t}, uiMutationTime = ${u}, contextValue = ${c} there are ${s.length} pending entries.`)}!function(e){const t=performance.now()-e;for(const e of Object.keys($e)){const n=$e[e];$e[e]=n.filter(e=>e.startTime>t&&!e.isReported);const o=n.filter(e=>e.isReported).length,s=n.length-o-$e[e].length;if(ae())for(const e of n)e.startTime<=t&&Ye(e);0===$e[e].length&&delete $e[e],s>0&&r.a.sendTraceTag(508121939,a.a.msoulscat_Wac_BrowserGeneral,i.a.Info,`InteractivityTracker:clearOldAsyncActions - cleared ${s} timed out tracked actions for ${e}`)}}(S)}function C(e,t,n){var o;if(n.state&&n.state!==t)return;n.isReported=!0,function(e,t){const n={};e.contexts.forEach(e=>{n[e.itemKey]=e.value});const{deviceMemory:o,hardwareConcurrency:s}=le(),c={userAction:e.action,startTime:e.startTime.toFixed(2),renderTime:t.renderTime.toFixed(2),appInfo:me(),deviceMemory:o,hardwareConcurrency:s,actionBucket:ke(e),contexts:n,appState:e.state},l=JSON.stringify(c);var u,d,m;r.a.sendTraceTag(137703444,a.a.msoulscat_Wac_BrowserGeneral,i.a.Important,l),he("OfficeVSO:8645877_addAsyncActionsCustomHandler")&&(c.contexts=e.contexts,u=c,null===(d=x)||void 0===d||null===(m=d.logAsyncActionHandler)||void 0===m||m.call(d,u))}(n,e),f(n,"total"),ae()&&Ye(n),performance.measure("Async UI Action: "+n.action,{start:n.startTime,end:e.renderTime});const s=null!==(o=_.get(n.action))&&void 0!==o?o:y;e.renderTime-n.startTime>s&&Qe(n.startTime,n,e.renderTime)}function B(e){var t;null===(t=e.parentElement)||void 0===t||t.removeChild(e)}class W{constructor(e){this.isLoafPerfImpactTestEnabled=e}start(e){return!!PerformanceObserver.supportedEntryTypes.includes("long-animation-frame")&&(this.onEntry=e,this.observer=new PerformanceObserver(e=>{if(!this.isLoafPerfImpactTestEnabled)for(const t of e.getEntries()){const e=t,{renderStart:n,startTime:r,duration:a,styleAndLayoutStart:i}=e;this.reportData(r,n?n-r:a,"preRenderTaskDuration"),this.reportData(n,i?i-n:0,"renderPreStyleAndLayoutDuration"),this.reportData(i,i?r+a-i:0,"renderStyleAndLayoutDuration"),this.reportScriptsData(e)}}),this.observer.observe({type:"long-animation-frame"}),!0)}stop(){var e;null===(e=this.observer)||void 0===e||e.disconnect()}reportScriptsData(e){const{renderStart:t}=e;if(!t)return;let n=0,r=0,a=0;for(const t of e.scripts)n+=t.duration,r+=t.executionStart-t.startTime,a+=t.forcedStyleAndLayoutDuration;this.reportData(t,n,"totalScriptsRunTime"),this.reportData(t,r,"totalScriptsCompileTime"),this.reportData(t,a,"forcedStyleAndLayoutDuration")}reportData(e,t,n){t>0&&this.onEntry({startTime:e,duration:t,source:"long-animation-frame",data:n})}}let O=[],G=[];const P=[];let x,$=0,M=!1,U=!1,D=void 0;function N(e){if(O.push(e),M){const t=G.find(t=>F(t,e));t&&r.a.sendTraceTag(507312265,a.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,`Timeline entry is intersecting with an already reported slow action: timelineEntry: ${JSON.stringify(e)}, ${JSON.stringify(t)}`)}}function F(e,t){return e.startTime<=t.startTime+t.duration&&e.endTime>=t.startTime}function R(){const e=performance.now()-12e4;O=O.filter(t=>t.startTime>=e),G=G.filter(t=>t.startTime>=e),U&&L(R,3e4)}function J(e){e&&L(()=>function(e){const t=O.filter(t=>F(e,t)).map(t=>function(e,t){const n=Math.max(e.startTime,t.startTime);return{startTime:n,duration:Math.min(e.startTime+e.duration,t.endTime)-n,source:e.source,data:e.data}}(t,e));M&&G.push(e);const n=function(e,t){var n,r,a;return JSON.stringify({action:{startTime:e.startTime,endTime:e.endTime,actionName:(null===(n=e.actionProps)||void 0===n?void 0:n.name)||"",actionBucket:(null===(r=e.actionProps)||void 0===r?void 0:r.actionBucket)||""},appState:null===(a=e.actionProps)||void 0===a?void 0:a.appState,timelineEntries:t})}(e,t);r.a.sendTraceTag(137704651,a.a.msoulscat_Wac_BrowserGeneral,i.a.Info,n)}(e),$)}function L(e,t){"scheduler"in window?window.scheduler.postTask(e,{delay:t,priority:"background"}):setTimeout(e,t)}let V,K,j,q=void 0,H=void 0,z=void 0,Q=void 0,X=void 0,Y=!1,Z=void 0,ee=void 0,te=void 0,ne=new Set,re=!1;function ae(){return re}function ie(e){return ne.has(e)}function oe(e){ne.add(e)}let se,ce=!1;function le(){var e,t;return Z=null!==(e=Z)&&void 0!==e?e:navigator.deviceMemory||0,ee=null!==(t=ee)&&void 0!==t?t:navigator.hardwareConcurrency||0,{deviceMemory:Z,hardwareConcurrency:ee}}function ue(){var e;return null!==(e=q)&&void 0!==e?e:void 0}function de(){var e;return null!==(e=H)&&void 0!==e?e:void 0}function me(){var e,t;return z||(t=H,z=JSON.stringify(t)),null!==(e=z)&&void 0!==e?e:void 0}function fe(e=c){if(x=null==e?void 0:e.callbacks,Te()&&(r.a.sendTraceTag(539829774,a.a.msoulscat_Wac_BrowserGeneral,i.a.Info,"InteractivityTracker:canStartObserver:false - repeated start attempt"),1))return r.a.sendTraceTag(539829765,a.a.msoulscat_Wac_BrowserGeneral,i.a.Info,"InteractivityTracker:startInteractivityTracker - cannot start interactivityTracker"),{started:!1,failureReason:"cannot start interactivityTracker"};Y=!0;const t=function(e){if(!e.durationThresholdInMs||e.durationThresholdInMs<0)return r.a.shipAssertTag(539829770,a.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - unexpected options.durationThresholdInMs undefined or < 0"),c;if(null==e.events||0===e.events.length)return r.a.shipAssertTag(539829771,a.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - unexpected options.events missing or empty"),c;for(const t of e.events)if(t&&s.indexOf(t)<0)return r.a.shipAssertTag(539829772,a.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - invalid event in options.events "+t),c;if(e.callbacks&&"function"!=typeof e.callbacks.getAppState)return r.a.shipAssertTag(539829773,a.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - getAppState is not a function"),c;if(e.periodicReportIntervalMs&&e.periodicReportIntervalMs<0)return r.a.shipAssertTag(509195584,a.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - Invalid periodicReport.intervalMs"),c;if(e.animationTracking){if(!e.animationTracking.chunkDurationMs||!e.animationTracking.minFramesPerChunk)return r.a.shipAssertTag(508343188,a.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - Invalid animationTracking properties"),c;if(e.animationTracking.chunkDurationMs<100)return r.a.shipAssertTag(508343187,a.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - Invalid animationTracking.chunkDurationMs (less than 100)"),c;if(e.animationTracking.minFramesPerChunk<0)return r.a.shipAssertTag(508343186,a.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - Invalid animationTracking.minFramesPerChunk (less than 0)"),c}return e}(e);re=Boolean(t.allowAsyncUIContextReporting),V=t.periodicReportIntervalMs,K=t.animationTracking,ce=Boolean(t.asyncUiTracking),Ae(),q=Se(),H=_e(),Ie()&&Be(),window.addEventListener("beforeunload",pe),window.addEventListener("visibilitychange",Ae),j={lastTrackedActionTime:0,lastTrackedAsyncUiTime:0,lastTrackedAnimationTime:0,isDuringAnimationTracking:!1};try{if(function(e){!function(e){var t;null===(t=e.events)||void 0===t||t.forEach(e=>{h[e]=!0})}(e),g=new PerformanceObserver(k),g.observe({type:"event",buffered:!0,durationThreshold:e.durationThresholdInMs})}(t),Ce()){!function(e){var t,n,r,a,i;if(y=null!==(t=null===(n=e.asyncUiTracking)||void 0===n?void 0:n.slowUiEventThresholdMs)&&void 0!==t?t:y,S=null!==(r=null===(a=e.asyncUiTracking)||void 0===a?void 0:a.asyncUiEventTimeoutMs)&&void 0!==r?r:S,null===(i=e.asyncUiTracking)||void 0===i||null===(i=i.slowActionTimeoutOverrides)||void 0===i||i.forEach(e=>{null!=e&&e.actionName&&_.set(e.actionName,e.slowActionThreshold)}),he("OfficeVSO:9029660_OverrideActionLogPercentage")&&e.asyncUiTracking&&e.asyncUiTracking.actionSampleRates)for(const[t,n]of Object.entries(e.asyncUiTracking.actionSampleRates))0<=n&&n<=100&&Math.random()>=n/100&&E.add(t);A=new PerformanceObserver(b),A.observe({type:"element"})}(t);let e=[];var n,l;he("OfficeVSO:8880204_RemoveAllowedAsyncUiNamesList")||(e=null!==(n=null===(l=t.asyncUiTracking)||void 0===l?void 0:l.allowedAsyncUiNames)&&void 0!==n?n:[],e.length>0&&(ne=new Set(e)))}t.timeline&&function(e,t,n,s){U=!0,D={add:t,remove:n},$=e.reportDelayMs,M=e.runSlowActionsPassiveTestEnabled,t(o.a.EndTrackSlowAction,J),function(e,t){for(const n of e){let e;switch(n.type){case"long-animation-frame":const o=t("Microsoft.Office.Excel.LoafPerfImpactTest",!1);e=new W(o);break;case"custom":e=n.customReporter;break;default:r.a.sendTraceTag(507312266,a.a.msoulscat_Wac_BrowserGeneral,i.a.Error,"Unknown timeline reporter type: "+n.type);continue}e.start(N)&&P.push(e)}}(e.reporters,s),L(R,3e4)}(t.timeline,Fe,Re,we),r.a.sendTraceTag(539829775,a.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"InteractivityTracker:startInteractivityTracker - started")}catch(e){return r.a.sendTraceTag(539829776,a.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"InteractivityTracker:startInteractivityTracker - failed to start. Error: "+e),ve(),{started:!1,failureReason:"Error: "+e}}return{started:!0}}function pe(){Oe(),T()}function ve(){return Te()?(null===(e=g)||void 0===e||e.disconnect(),g=void 0,null===(t=A)||void 0===t||t.disconnect(),A=void 0,U&&(G=[],O=[],null===(n=D)||void 0===n||n.remove(o.a.EndTrackSlowAction,J),P.forEach(e=>{e.stop()}),U=!1),window.removeEventListener("beforeunload",pe),window.removeEventListener("visibilitychange",Ae),nt(),T(),Y=!1,!0):(r.a.shipAssertTag(539829766,a.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:stopInteractivityTracker - attempt stop non-started"),!1);var e,t,n}function Te(){return Y}function ge(){var e;return!ye(null===(e=x)||void 0===e?void 0:e.getCurrentAppInfo)}function he(e){var t;if(null!==(t=x)&&void 0!==t&&t.isChangeGateEnabled)try{var n;return null===(n=x)||void 0===n?void 0:n.isChangeGateEnabled(e)}catch(e){r.a.sendTraceTag(539829767,a.a.msoulscat_Wac_BrowserGeneral,i.a.Error,"InteractivityTracker:isChangeGateEnabled - failed to call isChangeGateEnabledCallback. Error: "+e)}return!1}function we(e,t){var n;if(null!==(n=x)&&void 0!==n&&n.getBooleanFeatureGate)try{var o;return null===(o=x)||void 0===o?void 0:o.getBooleanFeatureGate(e,t)}catch(e){r.a.sendTraceTag(525173323,a.a.msoulscat_Wac_BrowserGeneral,i.a.Error,"InteractivityTracker:getBooleanFeatureGate - failed to call getBooleanFeatureGateCallback. Error: "+e)}return!1}function ke(e){var t;if(e.actionBucket)return e.actionBucket;const n=e.action;if(null!==(t=x)&&void 0!==t&&t.getActionBucket){var r;const e=null===(r=x)||void 0===r?void 0:r.getActionBucket(n);return null!=e?e:"undefined"}return""}function ye(e){return null==e}function Ae(){he("OfficeVSO:5610366_StopTrackingEventsWhenPageIsHidden")&&"hidden"===document.visibilityState&&nt()}function Se(){var e;if(null!==(e=x)&&void 0!==e&&e.getAppState)try{var t;return null===(t=x)||void 0===t?void 0:t.getAppState()}catch(e){r.a.sendTraceTag(539829768,a.a.msoulscat_Wac_BrowserGeneral,i.a.Error,"InteractivityTracker:getAppState - failed to call getAppStateCallback. Error: "+e)}}function _e(){var e;if(null!==(e=x)&&void 0!==e&&e.getCurrentAppInfo)try{var t;return{...null===(t=x)||void 0===t?void 0:t.getCurrentAppInfo()}}catch(e){r.a.sendTraceTag(539829769,a.a.msoulscat_Wac_BrowserGeneral,i.a.Error,"InteractivityTracker:getCurrentAppInfo - failed to call getCurrentAppInfoCallback. Error: "+e)}}function Ee(){return Boolean(V)}function Ie(){return!!V}function be(){return!ye(K)}function Ce(){return ce&&(void 0===te&&(te=!("undefined"==typeof window||((null===(e=window.PerformanceObserver)||void 0===e?void 0:e.supportedEntryTypes)||[]).indexOf("element")<0)&&"elementTiming"in new Image,te||r.a.sendTraceTag(508118157,a.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"trackerState:isElementTimingSupported - element timing not supported")),te);var e}function Be(){X=window.setTimeout(We,V)}function We(){X&&window.clearTimeout(X),Q&&window.cancelIdleCallback(Q),Q=window.requestIdleCallback(()=>{Ge("Periodic"),u={},Be()})}function Oe(){Ee()||Ge("EndOfState"),Ie()&&Ge("Periodic")}function Ge(e){r.a.shipAssertTag(539829777,a.a.msoulscat_Wac_BrowserGeneral,Te(),"InteractivityTracker:validateTrackerStarted - non-started tracker: caller logInteractivityReport");const t=function(e){const t=[];for(const n in e){const r=e[n];r.action=n,r.actionBucket=ke(r),t.push(r)}return t}(d(e));if("Periodic"===e&&0===t.length)return;const n=function(){let e,t;var n,r;return ge()?(e=null===(n=de())||void 0===n?void 0:n.appState,he("OfficeVSO:6215934_CoauthInteractivityRegressionDetection")&&(t=""+(null===(r=x)||void 0===r?void 0:r.getAppInfoForReport()))):e=ue(),`${t} state: ${e}`.trim()}();var o,s,c,l,u;o=137704527,s=i.a.Warning,c=`InteractivityTracker:logInteractivityReport - ${n} totals: ${JSON.stringify(t)}`,null!==(l=x)&&void 0!==l&&l.sendBeaconTraceTag?null===(u=x)||void 0===u||u.sendBeaconTraceTag(o,s,!1,c):(r.a.sendTraceTag(539550627,a.a.msoulscat_Wac_BrowserGeneral,i.a.Info,"InteractivityTracker:sendBeaconTraceTag - interactivityTrackerCallbacks.sendBeaconTraceTag does not exist. Sending trace tag instead for tag: "+o),r.a.sendTraceTag(o,a.a.msoulscat_Wac_BrowserGeneral,s,c))}function Pe(){return void 0===se&&(se=new Map([]),se.set(o.a.EndTrackSlowAction,"EndTrackSlowAction"),se.set(o.a.StartTrackAction,"StartTrackAction")),se}let xe={},$e={},Me=new Map;const Ue=new Map,De=new Map;let Ne=void 0;function Fe(e,t){Ne||(Ne=new EventTarget);const n=Pe().get(e);n&&Ne.addEventListener(n,e=>t(e.detail))}function Re(e,t){if(!Ne)return void r.a.sendTraceTag(527522002,a.a.msoulscat_Wac_BrowserGeneral,i.a.Error,"InteractivityTracker.removeEventListener InteractivityTrackerEventTarget is null}");const n=Pe().get(e);n&&Ne.removeEventListener(n,e=>t(e.detail))}function Je(e,t){return e+"_@@@_"+t}function Le(e,t,n,r){if(!je(r,e))return[];j.lastTrackedAsyncUiTime=performance.now();const a=[];for(const i of e){if(!i||he("OfficeVSO:9029660_OverrideActionLogPercentage")&&Ke(i))continue;ie(i)||oe(i);const e={action:i+"-default",state:t,contexts:n?[...n]:[],startTime:r.timeStamp,actionBucket:i};rt(e,i,!0),a.push(e),Xe(o.a.StartTrackAction,e,t)}return a}function Ve(e,t,n,s){if(!function(e,t){return!!qe(t)&&(!!He(e)&&(!!w(e.type)||(Object({NODE_ENV:"production"}).DEBUG&&r.a.debugAssertTag(538543693,a.a.msoulscat_Wac_BrowserGeneral,!1,`InteractivityTracker:validateTrackEventParams - InteractivityTracker doesn't support tracking of this event type: ${e.type}, userAction: ${t}`),r.a.sendTraceTag(508839814,a.a.msoulscat_Wac_BrowserGeneral,i.a.Info,`InteractivityTracker:validateTrackEventParams - InteractivityTracker doesn't support tracking of this event type: ${e.type}, userAction: ${t}`),!1)))}(e,t))return;if(!ze(t))return;j.lastTrackedActionTime=performance.now();const c=et(e.type,e.timeStamp),l=function(e,t,n){const o=xe[e],s=void 0!==o&&void 0!==o.find(e=>e.action===n);return(!s||"keypress"!==t.type)&&(!!s&&(r.a.sendTraceTag(539829784,a.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,`InteractivityTracker:checkDuplicateAction - duplicate tracked action. Same action: ${n} was already tracked on the same event with type: ${t.type}`),r.a.debugAssertTag(539829785,a.a.msoulscat_Wac_BrowserGeneral,!1,`InteractivityTracker:checkDuplicateAction - duplicate tracked action. Same action: ${n} was already tracked on the same event with type: ${t.type}`),!0))}(c,e,t),u=at(),d={action:t,state:u,contexts:n?[...n]:[],startTime:e.timeStamp};let m=[];if(!l&&(rt(d,c),f(d,"total"),Xe(o.a.StartTrackAction,d,u),Ce()&&s)){const r=n?[...n]:[];r.push({itemKey:"action",value:t}),m=Le(s,u,r,e)}let p=`InteractivityTracker:trackEvent - userActionKey: ${c} userAction: ${t}, ${me()}, actionBucket: ${ke(d)}, context: ${JSON.stringify(n)}`;Ce()&&(l&&(p+=", isDuplicateAction: "+l),s&&s.length>0&&(p+=", asyncUiNames: "+JSON.stringify(s))),r.a.sendTraceTag(137704644,a.a.msoulscat_Wac_BrowserGeneral,i.a.Info,p);const v=Je(c,t);if(ae()){Me.set(v,new Set([...m,d]));for(const e of m)e.contextKey=v;d.contextKey=v}return v}function Ke(e){return E.has(e)}function je(e,t){return!(!He(e)||(!t||0===t.length)&&(r.a.sendTraceTag(507557069,a.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"InteractivityTracker:validateTrackAsyncUiParams -  no async UI Names"),1))}function qe(e){return!(!e||0===e.length&&(r.a.sendTraceTag(539829786,a.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"InteractivityTracker:validateEventAndAction -  no userAction value"),1))}function He(e){return!!e&&e instanceof Event}function ze(e){return!!Te()||(r.a.sendTraceTag(539829787,a.a.msoulscat_Wac_BrowserGeneral,i.a.Info,"InteractivityTracker:validateTrackerStarted - tracker not started. userAction dropped: "+e),!1)}function Qe(e,t,n){var s;const c=de(),l=v(t,Ee()?"Periodic":"EndOfState");Xe(o.a.EndTrackSlowAction,t,null!==(s=t.state)&&void 0!==s?s:null==c?void 0:c.appState,e,n),f(t,"slow"),l.slow>l.total&&"undefined"!==t.action&&r.a.sendTraceTag(539829788,a.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,`InteractivityTracker:processSlowEventActionTimingEntry: action ${t.action} slow count (${l.slow}) higher then total (${l.total}). trackedEventsToUserAction size is ${Object.keys(xe).length}`)}function Xe(e,t,n,r,a){var i;if(!Ne)return;const o={name:t.action,appState:n,recentAppInfoProperties:null===(i=de())||void 0===i?void 0:i.appInfoProperties};o.actionBucket=ke(t);const s=Pe().get(e);s&&Ne.dispatchEvent(new CustomEvent(s,{detail:{startTime:r,endTime:a,actionProps:o}}))}function Ye(e){const t=e.contextKey;if(t){const n=Me.get(t);n&&(n.delete(e),0===n.size&&Me.delete(t))}}function Ze(e){const t=xe[e];if(!t)return[{action:"undefined",state:void 0,contexts:[],startTime:-1}];if(ae())for(const e of t)Ye(e);return delete xe[e],t}function et(e,t){return`${e}_${t}`}function tt(e){const t=e.indexOf("_"),n=t>-1?e.substring(t+1):void 0;return n?parseFloat(n):void 0}function nt(){xe={},$e={},Me=new Map}function rt(e,t,n=!1){if(n){const t=(Ue.get(e.action)||0)+1;Ue.set(e.action,t),e.contexts.push({itemKey:"actionIndex",value:t.toString()});const n=ke(e),r=(De.get(n)||0)+1;De.set(n,r),e.contexts.push({itemKey:"bucketIndex",value:r.toString()})}let r=xe;n&&(r=$e);const a=r[t];a?a.push(e):r[t]=[e]}function at(){var e;let t;var n;return ge()?(function(){var e;const t=_e();var n;(null===(e=de())||void 0===e?void 0:e.appState)!==(null==t?void 0:t.appState)&&(Oe(),T()),(n=t)&&(H=n,z=void 0)}(),t=null===(n=de())||void 0===n?void 0:n.appState):(function(){const e=Se();return e!==ue()&&(q=e,!0)}()&&(Oe(),T()),t=ue()),null!==(e=t)&&void 0!==e?e:"undefined"}class it{constructor(){this.collectedActions=[],this.collectingEnabled=!1,this.startCollectingSlowActions=this.startCollectingSlowActions.bind(this),this.stopCollectingSlowActions=this.stopCollectingSlowActions.bind(this),this.collectSlowUserAction=this.collectSlowUserAction.bind(this),this.retrieveAllSlowActions=this.retrieveAllSlowActions.bind(this),this.cleanCollectedActions=this.cleanCollectedActions.bind(this),this.retrieveSlowActionsBetweenTimeRange=this.retrieveSlowActionsBetweenTimeRange.bind(this)}startCollectingSlowActions(e){e||this.cleanCollectedActions(),this.collectingEnabled=!0}stopCollectingSlowActions(){this.collectingEnabled=!1}collectSlowUserAction(e){this.collectingEnabled&&e&&this.collectedActions.push(e)}retrieveAllSlowActions(){return[...this.collectedActions]}cleanCollectedActions(){this.collectedActions=[]}retrieveSlowActionsBetweenTimeRange(e,t){return this.collectedActions.filter(n=>e>=n.startTime&&e<=n.endTime||t>=n.startTime&&t<=n.endTime)}}var ot;let st;function ct(e){return st={animationStart:e&&e.timeStamp?e.timeStamp:performance.now(),lastAnimationChunkStart:performance.now(),currentAnimationFrameTimestamp:performance.now(),currentChunkFrameCount:0,currentAnimationTotalChunks:0,currentAnimationSlowChunks:0,lastAppState:"",rafId:void 0,wasClearedOnTimeout:!1},st}function lt(){return st}n(744),new class{constructor(){this.elements=[]}push(e){this.elements.unshift(e)}pop(){return this.elements.shift()}peek(){return this.elements.length>0?this.elements[0]:void 0}},function(e){e.SendBeacon="sendBeacon"}(ot||(ot={}));let ut,dt=!1;function mt(e){return window.requestAnimationFrame(()=>{!function(e){!function(e){const t=lt();if(wt(t))return ht(t,e),void(j.isDuringAnimationTracking=!1);j.isDuringAnimationTracking=!0,j.lastTrackedAnimationTime=performance.now(),t.currentAnimationFrameTimestamp=performance.now();const n=t.currentAnimationFrameTimestamp-t.lastAnimationChunkStart,r=K.chunkDurationMs;if(n<r)t.currentChunkFrameCount++;else{const a=Math.floor(n/r);!function(e,t,n){const r={name:e,chunks:t,slowChunksDetails:void 0},a=lt();a.currentChunkFrameCount<K.minFramesPerChunk?r.slowChunksDetails={slowAnimationPeriodStart:a.lastAnimationChunkStart,slowAnimationPeriodDuration:t*n,slowChunksNumber:t}:t>1&&(r.slowChunksDetails={slowAnimationPeriodStart:a.lastAnimationChunkStart+n,slowAnimationPeriodDuration:(t-1)*n,slowChunksNumber:t-1}),performance.measure("ConsecutiveChunksMeasure",{start:a.lastAnimationChunkStart,duration:t*n,detail:r})}(e,a,r),t.lastAnimationChunkStart+=a*r,t.currentChunkFrameCount=1}}(e),pt(lt())&&(lt().rafId=mt(e))}(e)})}function ft(e){Tt().disconnect(),performance.clearMeasures("ConsecutiveChunksMeasure"),window.cancelAnimationFrame(e.rafId),e.currentAnimationTotalChunks=0,e.currentAnimationSlowChunks=0,e.rafId=void 0}function pt(e){return void 0!==(null==e?void 0:e.rafId)}function vt(e){e.getEntriesByName("ConsecutiveChunksMeasure").forEach(e=>{!function(e){r.a.debugAssertTag(507912414,a.a.msoulscat_Wac_BrowserGeneral,"measure"===e.entryType,"AnimationTracker:validateMeasureEntry - unexpected observed entry type: "+e.entryType)}(e);const t=lt(),n=e.detail,i=n.name;t.currentAnimationTotalChunks+=n.chunks;const s=n.slowChunksDetails;if(!ye(s)){t.currentAnimationSlowChunks+=s.slowChunksNumber;const e={action:i};Xe(o.a.EndTrackSlowAction,e,t.lastAppState,s.slowAnimationPeriodStart,s.slowAnimationPeriodStart+s.slowAnimationPeriodDuration)}}),performance.clearMeasures("ConsecutiveChunksMeasure")}function Tt(){return void 0!==ut||(ut=new PerformanceObserver(vt)),ut}function gt(e){return"hidden"===document.visibilityState&&(ft(e),r.a.sendTraceTag(507593093,a.a.msoulscat_Wac_BrowserGeneral,i.a.Info,"AnimationTracker: updateDocumentVisibility - clear animation tracking due to document visibility: "+document.visibilityState),!0)}function ht(e,t){ft(e),e.wasClearedOnTimeout=!0,r.a.sendTraceTag(507593045,a.a.msoulscat_Wac_BrowserGeneral,i.a.Info,`AnimationTracker:handleTimeOut - animation timeout for animation: ${t}, gap: ${e.currentAnimationFrameTimestamp-e.animationStart}, docmunet visibility: ${document.visibilityState}`)}function wt(e){return e.currentAnimationFrameTimestamp-e.animationStart>K.animationTimeoutMs}ct();let kt=!1;class yt{start(e){return fe(e)}stop(){return ve()}track(e,t,n){return kt||(kt=!0,r.a.sendTraceTag(508056529,a.a.msoulscat_Wac_BrowserGeneral,i.a.Info,"InteractivityTrackerFactory.track: used deprecated method track")),Ve(e,t,n,void 0)}trackInteraction(e,t,n,r){return Ve(e,t,n,r)}trackAsyncUi(e,t,n,r){!function(e,t,n,r){if(!je(e,t))return;if(!ze(r))return;if(!Ce())return;const a=n?[...n]:[];qe(r)&&a.push({itemKey:"action",value:r});const i=Le(t,at(),n,e);if(ae()&&i.length>0){const n=Je(et(e.type,e.timeStamp),r||t[0]);Me.set(n,new Set(i));for(const e of i)e.contextKey=n}}(e,t,n,r)}addContext(e,t,n){e&&t&&function(e,t){if(ae()){for(const n of Array.from(Me.get(e)||[]))n.contexts.push(t);return}const n=function(e){const[t,n]=e.split("_@@@_");if(xe[t])return xe[t].find(e=>e.action===n)}(e);null==n||n.contexts.push(t)}(e,{itemKey:t,value:n})}isEventSupportedForTracking(e){return!!e&&w(e.type)}createActionsRetriever(){const e=new it;return Fe(o.a.EndTrackSlowAction,e.collectSlowUserAction),e}addEventListener(e,t){t&&Fe(e,t)}removeEventListener(e,t){t&&Re(e,t)}recentAppState(){return ue()}trackedUserActionsReport(){const e=d();if(e){const t=[];for(const[n,r]of Object.entries(e)){const e={action:n,actionBucket:r.actionBucket};t.push({userAction:n,actionBucket:ke(e),total:r.total,slow:r.slow})}return t}}startTrackAnimation(e,t){return!!t&&function(e,t){if(!be()||ye(t))return!1;let n=lt();return pt(n)&&ft(n),n=ct(e),he("OfficeVSO:8625874_clearAnimationTrackingWhenUnvisible")&&!dt&&function(e){window.addEventListener("visibilitychange",()=>{pt(e)&&gt(e)}),dt=!0}(n),n.lastAppState=at(),Tt().observe({type:"measure",buffered:!0}),n.rafId=mt(t),!he("OfficeVSO:8625874_clearAnimationTrackingWhenUnvisible")||!gt(n)}(e,t)}stopTrackAnimation(e,t=!1){e&&function(e,t=!1){if(!be()||ye(e))return;j.isDuringAnimationTracking=!1;const n=lt();if(t)return void ft(n);if(n.wasClearedOnTimeout)return n.wasClearedOnTimeout=!1,void r.a.sendTraceTag(507912418,a.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"AnimationTracker:stopAnimationTracking - called stop animation after timeout: "+e);if(void 0===n.rafId)return void r.a.sendTraceTag(507912417,a.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"AnimationTracker:stopAnimationTracking - stop animation for animation wasn't started: "+e);if(he("OfficeVSO:8625874_clearAnimationTrackingWhenUnvisible")&&wt(n))return void ht(n,e);const o={action:e};n.currentAnimationTotalChunks>0&&(f(o,"total",n.currentAnimationTotalChunks),f(o,"slow",n.currentAnimationSlowChunks),r.a.sendTraceTag(507912415,a.a.msoulscat_Wac_BrowserGeneral,i.a.Info,`AnimationTracker.stopTrackAnimation - animationName: ${e} totalChunks: ${n.currentAnimationTotalChunks} slowChunks: ${n.currentAnimationSlowChunks}`)),ft(n)}(e,t)}isAsyncUiNameAllowed(e){return!!e&&ie(e)}getStatus(){return{...j}}}const At=new class{create(){if(!function(){var e;if(!window.PerformanceObserver)return r.a.sendTraceTag(539829760,a.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"InteractivityTracker:isInteractivityTrackerSupported:false - no PerformanceObserver"),!1;if(!PerformanceObserver.supportedEntryTypes)return r.a.sendTraceTag(539829761,a.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"isInteractivityTrackerSupported:false - PerformanceObserver missing supportedEntryTypes"),!1;if((null===(e=PerformanceObserver)||void 0===e||null===(e=e.supportedEntryTypes)||void 0===e?void 0:e.indexOf("event"))<0)return r.a.sendTraceTag(539829762,a.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"isInteractivityTrackerSupported:false - PerformanceObserver not supporting event timing"),!1;const t="undefined"==typeof navigator?"":navigator.userAgent;return function(e){return 0!==e.localeCompare("")&&null!==e.match(/(Chrome\/|CriOS\/)/g)}(t)?!(function(e){const t=e.match(/((Chrome\/|CriOS\/)(\d|\.)+)/g);if(null==t)return-1;const n=t[0].split("/");if(n.length<2)return-1;const r=n[1].split(".");if(r.length<4)return-1;const a=r[0],i=parseInt(a,10);return isNaN(i)?-1:i}(t)<85&&(r.a.sendTraceTag(539829764,a.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"isInteractivityTrackerSupported:false - user agent chromium version < 85"),1)):(r.a.sendTraceTag(539829763,a.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"isInteractivityTrackerSupported:false - user agent is not chromium based."),!1)}())return;let e=window.__InteractivityTracker__;return e||(e=window.__InteractivityTracker__=new yt),e}}},2054:function(e,t,n){"use strict";n.r(t);var r=n(1636);n.d(t,"InteractivityTrackerFactoryGlobal",(function(){return r.a}))},2209:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.StartTrackAction=0]="StartTrackAction",e[e.EndTrackSlowAction=1]="EndTrackSlowAction"}(r||(r={}))},744:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));class r{getCurrentTimestamp(){return performance.now()}}class a{constructor(e,t,n){return this.performanceAPIChecker=e,this.performanceTimestampRetriever=t,this.logger=n,this.startTimestamp=-1,this.stopTimestamp=-1,this.performanceAPIChecker.isPerformanceAPIAvailable()?this.performanceAPIChecker.isPerformanceNowDefined()?void(this.unsupportedEnvironment=!1):(this.logger.logPerformanceNowMissingInJSEnvironment(),void(this.unsupportedEnvironment=!0)):(this.logger.logPerformanceMissingInJSEnvironment(),void(this.unsupportedEnvironment=!0))}start(){this.unsupportedEnvironment?this.logger.logStopWatchStartingInUnsupportedEnvironment():this.startTimestamp=this.performanceTimestampRetriever.getCurrentTimestamp()}stop(){this.unsupportedEnvironment?this.logger.logStopWatchStoppingInUnsupportedEnvironment():this.stopTimestamp=this.performanceTimestampRetriever.getCurrentTimestamp()}getElapsedTime(){if(-1===this.startTimestamp)return this.logger.logGetElapsedTimeCalledWithoutCallingStart(),-1;if(-1===this.stopTimestamp)return this.logger.logGetElapsedTimeCalledWithoutCallingStop(),-1;const e=this.stopTimestamp-this.startTimestamp;return this.resetTimestamps(),e}resetTimestamps(){this.startTimestamp=-1,this.stopTimestamp=-1}}var i=n(82),o=n(81),s=n(214);class c{logPerformanceMissingInJSEnvironment(){i.a.sendTraceTag(579110677,o.a.msoulscat_Wac_Telemetry,s.a.Error,"Unable to find performance in the JS environment")}logPerformanceNowMissingInJSEnvironment(){i.a.sendTraceTag(579110678,o.a.msoulscat_Wac_Telemetry,s.a.Error,"Unable to find performance.now in the JS environment")}logStopWatchStartingInUnsupportedEnvironment(){i.a.sendTraceTag(579110679,o.a.msoulscat_Wac_Telemetry,s.a.Error,"Starting the stopwatch in an unsupported environment. Incorrect data will be stored")}logStopWatchStoppingInUnsupportedEnvironment(){i.a.sendTraceTag(579110680,o.a.msoulscat_Wac_Telemetry,s.a.Error,"Stopping the stopwatch in an unsupported environment. Incorrect data will be stored")}logGetElapsedTimeCalledWithoutCallingStart(){i.a.sendTraceTag(579110683,o.a.msoulscat_Wac_Telemetry,s.a.Error,"Stopwatch needs to be started before you can get elapsed time")}logGetElapsedTimeCalledWithoutCallingStop(){i.a.sendTraceTag(579110684,o.a.msoulscat_Wac_Telemetry,s.a.Error,"Stopwatch needs to be stopped before you can get elapsed time")}}class l{isPerformanceAPIAvailable(){return null!=performance}isPerformanceNowDefined(){return"now"in performance}}class u{static createNewStopWatch(){const e=new c,t=new l,n=new r;return new a(t,n,e)}}}},[[2054,2,0]]]);
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/interactivity.min.js.map/52275b37a345bb322d2a45a194b68f55/interactivity.min.js.map