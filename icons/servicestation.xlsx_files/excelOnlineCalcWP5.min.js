/*! For license information please see excelOnlineCalcWP5.min.js.LICENSE.txt */
var excelOnlineCalc;!function(){var e={92582:function(e,t,r){"use strict";var n,i,o;r.r(t),r.d(t,{FormulaByExampleAnnotation:function(){return u},FormulaByExampleInvocationMethod:function(){return i},FormulaByExampleResultKind:function(){return n},FormulaByExampleSignal:function(){return s},FormulaByExampleWarmUpAnnotation:function(){return c},FormulaByExampleWarmUpSignal:function(){return l},ValueType:function(){return o}}),function(e){e[e.Success=0]="Success",e[e.NoFormulas=1]="NoFormulas",e[e.Failed=2]="Failed"}(n||(n={})),function(e){e[e.Explicit=0]="Explicit",e[e.Implicit=1]="Implicit"}(i||(i={})),function(e){e[e.General=0]="General",e[e.Number=1]="Number",e[e.DateTime=2]="DateTime"}(o||(o={}));class a{static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_?e.H_.B_:[]}static getAllTypesFor(e){const t=a.getTypeNameFor(e);return t?[t,...a.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,t){if(!Array.isArray(t)||0===t.length)return!0;const r=a.getTypeNameFor(e),n=a.getBaseTypesFor(e);for(const e of t){if(e===r)return!0;if(n.indexOf(e)>=0)return!0}return!1}static assign(e,t,r){if(r)for(const e of Object.keys(r))t[e]=r[e];return t.H_=e.H_,t}constructor(e){a.assign(a,this,e)}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class s{static getTypeName(){return"AugLoop_FormulaByExample_FormulaByExampleSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return a.matchesTypesFor(e,[s.getTypeName()])}constructor(e){a.assign(s,this,e)}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class l{static getTypeName(){return"AugLoop_FormulaByExample_FormulaByExampleWarmUpSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return a.matchesTypesFor(e,[l.getTypeName()])}constructor(e){a.assign(l,this,e)}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_FormulaByExample_FormulaByExampleAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return a.matchesTypesFor(e,[u.getTypeName()])}constructor(e){a.assign(u,this,e)}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_FormulaByExample_FormulaByExampleWarmUpAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return a.matchesTypesFor(e,[c.getTypeName()])}constructor(e){a.assign(c,this,e)}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()}},53930:function(e,t,r){"use strict";r.d(t,{EW:function(){return p},Il:function(){return c},KJ:function(){return d},Kz:function(){return F},Mu:function(){return y},My:function(){return S},Nn:function(){return f},OD:function(){return l},Q7:function(){return u},TA:function(){return v},ay:function(){return g},qw:function(){return h},rh:function(){return m}});var n=r(4725);function i(e,t){return e?e+"."+t:t}function o(e,t,r,o,a){void 0===a&&(a=4),o&&e.push((0,n.m9)("".concat(i(t,r)),o,a))}function a(e,t,r,o){"boolean"==typeof o&&e.push((0,n.LK)("".concat(i(t,r)),o))}function s(e,t,r,o){"number"==typeof o&&e.push((0,n.Ug)("".concat(i(t,r)),o))}var l,u={getFields:function(e){var t="Activity.Result",r=[];return s(r,t,"Code",e.code),o(r,t,"Type",e.type),s(r,t,"Tag",e.tag),a(r,t,"IsExpected",e.isExpected),r.push((0,n.m9)("zC.Activity.Result","Office.System.Result")),r}},c={contractName:"Office.System.Activity",getFields:function(e){var t="Activity",r=[];return o(r,t,"CV",e.cV),s(r,t,"Duration",e.duration),s(r,t,"Count",e.count),s(r,t,"AggMode",e.aggMode),a(r,t,"Success",e.success),e.result&&r.push.apply(r,u.getFields(e.result)),r.push((0,n.m9)("zC.Activity",this.contractName)),r}},d={getFields:function(e){var t="User",r=[];return o(r,t,"PrimaryIdentityHash",e.primaryIdentityHash),o(r,t,"PrimaryIdentitySpace",e.primaryIdentitySpace),o(r,t,"TenantId",e.tenantId,1),o(r,t,"TenantGroup",e.tenantGroup,1),a(r,t,"IsAnonymous",e.isAnonymous),a(r,t,"IsSignedIn",e.isSignedIn),r}},m={getFields:function(e,t){var r=[];return o(r,e,"Name",t.name),o(r,e,"State",t.state),r}},g={getFields:function(e){var t="UserAction",r=[];return s(r,t,"Id",e.id),o(r,t,"Name",e.name),o(r,t,"CommandSurface",e.commandSurface),o(r,t,"ParentName",e.parentName),o(r,t,"TriggerMethod",e.triggerMethod),s(r,t,"TimeOffsetMs",e.timeOffsetMs),r}};!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.iOS="iOS",e.Android="Android"}(l||(l={}));var p,h={getFields:function(e){var t="App",r=[];return o(r,t,"Name",e.name,1),o(r,t,"Platform",e.platform,1),o(r,t,"Version",e.version,1),r}},f={getFields:function(e){var t="Session",r=[];return o(r,t,"Id",e.id,1),o(r,t,"EcsETag",e.ecsETag,1),r}},S={getFields:function(e){var t=[];return t.push((0,n.m9)("Pillar",e.pillar)),t.push((0,n.m9)("Veto",e.veto)),t.push((0,n.LK)("IsIntentional",e.isIntentional)),t.push((0,n.LK)("IsInternal",e.isInternal)),t.push((0,n.LK)("AlertOnPillar",e.alertOnPillar)),t.push((0,n.LK)("IsSessionEndingError",e.isSessionEndingError)),a(t,void 0,"InStaging",e.inStaging),t}};!function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(p||(p={}));var v,y,F={getFields:function(e){var t=[];return o(t,"Release","AudienceGroup",e.audienceGroup,1),t}};!function(e){var t,r,i,s,l="Copilot";(s=e.FeatureActionType||(e.FeatureActionType={})).IsEnabled="IsEnabled",s.IsSeen="IsSeen",s.IsTried="IsTried",s.IsKept="IsKept",s.IsRejected="IsRejected",(i=e.Capability||(e.Capability={})).ContentGeneration="Content Generation",i.Commanding="Commanding",i.QAandSummaries="QA and Summaries",i.Collaboration="Collaboration",i.Suggestions="Suggestions",(r=e.EntryPoint||(e.EntryPoint={})).Chat="Chat",r.Canvas="Canvas",(t=e.Verb||(e.Verb={})).Create="Create",t.Command="Command",t.Ask="Ask",t.Summarize="Summarize",t.Share="Share",t.Analyze="Analyze",e.getFields=function(e){var t=[];return o(t,l,"FeatureActionType",e.featureActionType),a(t,l,"IsUserInitiated",e.isUserInitiated),o(t,l,"FeatureName",e.featureName),o(t,l,"SubFeatureName",e.subFeatureName),o(t,l,"Capability",e.capability),a(t,l,"IsThumbsUp",e.isThumbsUp),o(t,l,"EntryPoint",e.entryPoint),o(t,l,"Verb",e.verb),o(t,l,"InteractionId",e.interactionId),t.push((0,n.m9)("zC.".concat(l),"Office.System.Copilot")),t}}(v||(v={})),function(e){var t,r="Asha";(t=e.EventType||(e.EventType={})).Pillar="Pillar",t.Error="Error",e.getFields=function(e){var t=[];return o(t,r,"EventType",e.eventType),o(t,r,"Pillar",e.pillar),o(t,r,"Scenario",e.scenario),o(t,r,"Veto",e.veto),o(t,r,"Error",e.error),a(t,r,"InStaging",e.inStaging),a(t,r,"IsSessionEndingError",e.isSessionEndingError),a(t,r,"IsIntentional",e.isIntentional),a(t,r,"IsInternal",e.isInternal),t.push((0,n.m9)("zC.".concat(r),"Office.System.Asha")),t}}(y||(y={}))},30474:function(e,t,r){"use strict";var n;r.d(t,{CV:function(){return i},N:function(){return o}});var i=function(){function e(e){this.value=e,this.nextChild=0}return e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.nextChild))},e}();function o(){if(!n){for(var e=[],t=0;t<22;t++)e.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(Math.floor(64*Math.random())));n=new i(e.join(""))}return n}},4725:function(e,t,r){"use strict";function n(e,t,r){return l(e,1,t,r)}function i(e,t,r){return l(e,2,t,r)}function o(e,t,r){return l(e,3,t,r)}function a(e,t,r){return l(e,0,t,r)}function s(e,t,r){return l(e,4,t,r)}function l(e,t,r,n){return{name:e,dataType:t,value:r,classification:n||4}}r.d(t,{LK:function(){return n},Ug:function(){return i},ip:function(){return o},k:function(){return s},m9:function(){return a}})},66627:function(e,t,r){"use strict";r.d(t,{d$:function(){return o},vV:function(){return s},wC:function(){return a}});var n,i=(n=[],{fireEvent:function(e){n.forEach((function(t){return t(e)}))},addListener:function(e){e&&n.push(e)}});function o(){return i}function a(e,t,r){i.fireEvent({level:e,category:t,message:r})}function s(e,t,r){a(0,e,(function(){var e=r instanceof Error?r.message:"";return"".concat(t,": ").concat(e)}))}},94463:function(e,t,r){"use strict";r.d(t,{GV:function(){return S},di:function(){return h},EY:function(){return f}});var n=r(19181),i=r(66627),o={};function a(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?o[e]?(t.ariaTenantToken&&(o[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(o[e].dnmToken=t.dnmToken)):o[e]=t:(0,i.wC)(0,0,(function(){return"Namespace: ".concat(e)}))}function s(e,t){for(var r=e.length;r>0;){var n=e.substr(0,r);if(o[n]){var i=o[n];return t.ariaTenantToken=i.ariaTenantToken,t.dnmToken=i.dnmToken,!0}r=e.lastIndexOf(".",r-1)}return!1}var l=9007199254740991,u=-l,c=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,d=/^[a-zA-Z0-9_\.]{1,95}$/;function m(e){return d.test(e)}function g(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!m(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<u||e>l)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}var p=r(4725),h=-1;function f(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?(0,n.__assign)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var S=function(){function e(e,t,r){var i,o,a;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=r||{},e&&(this.telemetrySinks=e.telemetrySinks,(i=this.persistentDataFields).push.apply(i,e.persistentDataFields),this.config=(0,n.__assign)((0,n.__assign)({},e.getConfig()),this.config),(o=this.partAFields).push.apply(o,e.partAFields)),t&&(a=this.persistentDataFields).push.apply(a,t)}return e.prototype.addEventContentType=function(e,t){e.push((0,p.Ug)("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=f(e),r=t.telemetryProperties;r.nexusTenantToken=h;var n=r.ariaTenantToken;n||s(t.eventName,r)||n?this.sendTelemetryEventInternal(t,1):(0,i.wC)(0,0,(function(){return"No tenant token: "+e.eventName}))},e.prototype.sendNonStandardEvent=function(e,t){var r=f(e);this.sendTelemetryEventInternal(r,t)},e.prototype.sendCustomerContent=function(e){var t=f(e),r=t.telemetryProperties,n=r.customerContentVersion;return(!n||n>2)&&(r.customerContentVersion=2),r.ariaTenantToken=void 0,r.nexusTenantToken=void 0,r.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=f(e),r=t.telemetryProperties;r.dnmToken||s(t.eventName,r)||r.dnmToken?(this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)):(0,i.wC)(0,0,(function(){return"No dnm token: "+t.eventName}))},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):(0,i.wC)(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e,t)}catch(e){return void(0,i.vV)(0,"SendTelemetryEvent",e)}this.telemetrySinks.forEach((function(r){try{3===t||2===t?r.sendNonStandardEvent&&r.sendNonStandardEvent(e,t):r.sendTelemetryEvent(e)}catch(e){}}))}else(0,i.wC)(0,0,(function(){return"Customer content"}))},e.prototype.processTelemetryEvent=function(e,t){var r,n,i;if(e.dataFields&&(null===(i=e.dataFields)||void 0===i||i.unshift((0,p.m9)("OTelJS.Version","4.19.5")),3!==t&&this.persistentDataFields&&(r=e.dataFields).unshift.apply(r,this.persistentDataFields)),this.partAFields.length>0){var o=e.eventContract||{name:"",dataFields:[]};(n=o.dataFields).push.apply(n,this.partAFields),e.eventContract=o}this.config.disableValidation||function(e){if(!(t=e.eventName)||t.length>98||!c.test(t))throw new Error("Invalid eventName");var t,r=e.eventContract;if(r){if(r.name&&!m(r.name))throw new Error("Invalid eventContract");g(r.dataFields)}g(e.dataFields)}(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,r=e;t<r.length;t++){var n=r[t],i=n[0],o=n[1];this.sendTelemetryEventInternal(i,o)}},e.prototype.setTenantToken=function(e,t,r){a(e,{ariaTenantToken:t,nexusTenantToken:r})},e.prototype.setDNMToken=function(e,t){a(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return f(e)},e.prototype.getConfig=function(){return this.config},e}()},27328:function(e,t,r){"use strict";r.d(t,{M:function(){return d}});var n=r(19181),i=r(94463),o=r(53930),a=r(66627),s=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(s=function(){return 1e3*Math.floor(window.performance.now())});var l=function(e){var t,r=s(),u=(0,i.EY)(e.telemetryEvent);return(0,n.__assign)((0,n.__assign)({cv:e.parentCv.getNext()},u),{createChildActivity:function(t){return l({telemetryEvent:t,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,t,r){this.result={code:e,type:t,tag:r}},endNow:function(){var n,i,l=this;if(!t){void 0===this.success&&void 0===this.result&&(0,a.wC)(1,0,(function(){return"Activity does not have success or result set"}));var u=s();t=!0;var c={duration:u-r,count:1,aggMode:0,cV:this.cv.value,success:this.success,result:this.result},d=null!==(i=null===(n=this.eventContract)||void 0===n?void 0:n.dataFields)&&void 0!==i?i:[];return d.push.apply(d,o.Il.getFields(c)),this.eventContract={name:o.Il.contractName,dataFields:d},e.sendTelemetryEvent(this)}(0,a.wC)(0,0,(function(){return"'".concat(l.eventName,"' already ended")}))}})},u=r(4725),c=r(30474),d=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this;return i.baseCv=(0,c.N)(),i}return(0,n.__extends)(t,e),t.prototype.createActivity=function(e){return l({sendTelemetryEvent:this.sendTelemetryEvent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t.prototype.sendActivity=function(e,t,r,n){return this.sendTelemetryEvent({eventName:e,eventContract:{name:o.Il.contractName,dataFields:o.Il.getFields(t)},dataFields:r,eventFlags:n})},t.prototype.sendError=function(e){var t=function(e){var t="Error",r=[];return r.push((0,u.m9)("".concat(t,".ErrorGroup"),e.errorGroup)),r.push((0,u.Ug)("".concat(t,".Tag"),e.tag)),void 0!==e.code&&r.push((0,u.Ug)("".concat(t,".Code"),e.code)),void 0!==e.id&&r.push((0,u.Ug)("".concat(t,".Id"),e.id)),void 0!==e.count&&r.push((0,u.Ug)("".concat(t,".Count"),e.count)),r}(e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t.prototype.createCustomerContentActivity=function(e){return l({sendTelemetryEvent:this.sendCustomerContent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t}(i.GV)},54930:function(e,t,r){"use strict";var n;r.d(t,{o:function(){return n}}),function(e){e.DataClassification={EssentialServiceMetadata:1,AccountData:2,SystemMetadata:4,OrganizationIdentifiableInformation:8,EndUserIdentifiableInformation:16,CustomerContent:32,AccessControl:64,PublicNonPersonalData:128,EndUserPseudonymousInformation:256,PublicPersonalData:512,SupportData:1024,DirectMeasurementData:2048,Everything:65535},e.DataFieldType={String:0,Boolean:1,Int64:2,Double:3,Guid:4},e.SamplingPolicy={NotSet:0,Measure:1,Diagnostics:2,CriticalBusinessImpact:191,CriticalCensus:192,CriticalExperimentation:193,CriticalUsage:194},e.PersistencePriority={NotSet:0,Normal:1,High:2},e.CostPriority={NotSet:0,Normal:1,High:2},e.DataCategories={NotSet:0,SoftwareSetup:1,ProductServiceUsage:2,ProductServicePerformance:4,DeviceConfiguration:8,InkingTypingSpeech:16},e.DiagnosticLevel={ReservedDoNotUse:0,Required:10,BasicEvent:10,Optional:100,FullEvent:100,RequiredServiceData:110,NecessaryServiceDataEvent:110,RequiredServiceDataForEssentialServices:120,AlwaysOnNecessaryServiceDataEvent:120},e.DnmInterval={Hourly:1,Daily:2},e.AllowedPartA={ReleaseAudienceGroup:1,WacRing:2,AppName:3,AppPlatform:4,AppVersion:5},e.CustomerContentType={None:0,MocaAddIn:1},e.LogLevel={Error:0,Warning:1,Info:2,Verbose:3},e.Category={Core:0,Sink:1,Transport:2},e.PrimaryIdentitySpace={UserObjectId:"UserObjectId",MSACID:"MSACID",OrgIdPuid:"OrgIdPuid",OrgIdPUID:"OrgIdPUID",OrgIdCID:"OrgIdCID",MsaPuid:"MsaPuid",MSAPUID:"MSAPUID",WopiAuth:"WopiAuth",ThirdParty:"ThirdParty",Other:"Other"},e.AudienceGroup={Automation:"Automation",Dogfood:"Dogfood",Microsoft:"Microsoft",Insiders:"Insiders",Production:"Production"}}(n||(n={}))},45851:function(e,t,r){"use strict";r.r(t),r.d(t,{Activity:function(){return y.Il},App:function(){return y.qw},Asha:function(){return y.Mu},AudienceGroup:function(){return y.EW},CV:function(){return F.CV},Contracts:function(){return d},Copilot:function(){return y.TA},EnumObjects:function(){return k.o},Funnel:function(){return y.rh},HealthQosError:function(){return y.My},Platform:function(){return y.OD},Release:function(){return y.Kz},Result:function(){return y.Q7},Session:function(){return y.Nn},SimpleTelemetryLogger:function(){return E.GV},SuppressNexus:function(){return E.di},TelemetryLogger:function(){return T.M},TraceContext:function(){return q},TraceFlags:function(){return b},TraceParent:function(){return G},TraceState:function(){return L},User:function(){return y.KJ},UserAction:function(){return y.ay},cloneEvent:function(){return E.EY},createTraceContext:function(){return z},getEffectiveEventFlags:function(){return R},logError:function(){return C.vV},logNotification:function(){return C.wC},makeBooleanDataField:function(){return c.LK},makeDoubleDataField:function(){return c.ip},makeGuidDataField:function(){return c.k},makeInt64DataField:function(){return c.Ug},makeStringDataField:function(){return c.m9},onNotification:function(){return C.d$},parseTraceContext:function(){return H},sendHealthQosError:function(){return N}});var n,i,o,a,s,l,u,c=r(4725);!function(e){e.getFields=function(e,t){var r=[];return r.push((0,c.Ug)("".concat(e,".Code"),t.code)),void 0!==t.type&&r.push((0,c.m9)("".concat(e,".Type"),t.type)),void 0!==t.tag&&r.push((0,c.Ug)("".concat(e,".Tag"),t.tag)),void 0!==t.isExpected&&r.push((0,c.LK)("".concat(e,".IsExpected"),t.isExpected)),r.push((0,c.m9)("zC.Activity.Result","Office.System.Result")),r}}(n||(n={})),function(e){e.contractName="Office.System.Activity",e.getFields=function(t){var r="Activity",i=[];return void 0!==t.cV&&i.push((0,c.m9)("".concat(r,".CV"),t.cV)),i.push((0,c.Ug)("".concat(r,".Duration"),t.duration)),i.push((0,c.Ug)("".concat(r,".Count"),t.count)),i.push((0,c.Ug)("".concat(r,".AggMode"),t.aggMode)),void 0!==t.success&&i.push((0,c.LK)("".concat(r,".Success"),t.success)),void 0!==t.result&&i.push.apply(i,n.getFields("".concat(r,".Result"),t.result)),i.push((0,c.m9)("zC.Activity",e.contractName)),i}}(i||(i={})),function(e){e.getFields=function(e,t){var r=[];return void 0!==t.id&&r.push((0,c.m9)("".concat(e,".Id"),t.id)),void 0!==t.version&&r.push((0,c.m9)("".concat(e,".Version"),t.version)),void 0!==t.sessionId&&r.push((0,c.m9)("".concat(e,".SessionId"),t.sessionId)),r}}(o||(o={})),function(e){e.getFields=function(e,t){var r=[];return void 0!==t.alias&&r.push((0,c.m9)("".concat(e,".Alias"),t.alias)),void 0!==t.primaryIdentityHash&&r.push((0,c.m9)("".concat(e,".PrimaryIdentityHash"),t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&r.push((0,c.m9)("".concat(e,".PrimaryIdentitySpace"),t.primaryIdentitySpace)),void 0!==t.tenantId&&r.push((0,c.m9)("".concat(e,".TenantId"),t.tenantId)),void 0!==t.tenantGroup&&r.push((0,c.m9)("".concat(e,".TenantGroup"),t.tenantGroup)),void 0!==t.isAnonymous&&r.push((0,c.LK)("".concat(e,".IsAnonymous"),t.isAnonymous)),r}}(a||(a={})),function(e){e.getFields=function(e,t){var r=[];return void 0!==t.name&&r.push((0,c.m9)("".concat(e,".Name"),t.name)),void 0!==t.state&&r.push((0,c.m9)("".concat(e,".State"),t.state)),r}}(s||(s={})),function(e){e.getFields=function(e,t){var r=[];return void 0!==t.id&&r.push((0,c.Ug)("".concat(e,".Id"),t.id)),void 0!==t.name&&r.push((0,c.m9)("".concat(e,".Name"),t.name)),void 0!==t.commandSurface&&r.push((0,c.m9)("".concat(e,".CommandSurface"),t.commandSurface)),void 0!==t.parentName&&r.push((0,c.m9)("".concat(e,".ParentName"),t.parentName)),void 0!==t.triggerMethod&&r.push((0,c.m9)("".concat(e,".TriggerMethod"),t.triggerMethod)),void 0!==t.timeOffsetMs&&r.push((0,c.Ug)("".concat(e,".TimeOffsetMs"),t.timeOffsetMs)),r}}(l||(l={})),function(e){e.getFields=function(e,t){var r=[];return r.push((0,c.m9)("".concat(e,".ErrorGroup"),t.errorGroup)),r.push((0,c.Ug)("".concat(e,".Tag"),t.tag)),void 0!==t.code&&r.push((0,c.Ug)("".concat(e,".Code"),t.code)),void 0!==t.id&&r.push((0,c.Ug)("".concat(e,".Id"),t.id)),void 0!==t.count&&r.push((0,c.Ug)("".concat(e,".Count"),t.count)),r}}(u||(u={}));var d,m=i,g=n,p=u,h=s,f=o,S=l,v=a;!function(e){var t,r;t=e.Office||(e.Office={}),(r=t.System||(t.System={})).Activity=m,r.Result=g,r.Error=p,r.Funnel=h,r.Host=f,r.User=v,r.UserAction=S}(d||(d={}));var y=r(53930),F=r(30474),C=r(66627);function R(e){var t={costPriority:1,samplingPolicy:1,persistencePriority:1,dataCategories:0,diagnosticLevel:100};return e.eventFlags&&e.eventFlags.dataCategories||(0,C.wC)(0,0,(function(){return"DataCategories"})),e.eventFlags?(e.eventFlags.costPriority&&(t.costPriority=e.eventFlags.costPriority),e.eventFlags.samplingPolicy&&(t.samplingPolicy=e.eventFlags.samplingPolicy),e.eventFlags.persistencePriority&&(t.persistencePriority=e.eventFlags.persistencePriority),e.eventFlags.dataCategories&&(t.dataCategories=e.eventFlags.dataCategories),e.eventFlags.diagnosticLevel&&(t.diagnosticLevel=e.eventFlags.diagnosticLevel),t):t}var b,E=r(94463),T=r(27328),k=r(54930),P=r(19181);function N(e,t,r,n,i,o,a,s,l,u,c){n.forEach((function(n){e.sendTelemetryEvent({eventName:t.name+".Qos.Error."+r,eventFlags:{diagnosticLevel:110},dataFields:(0,P.__spreadArray)((0,P.__spreadArray)([],y.My.getFields({veto:n,pillar:i,isIntentional:o,isInternal:a,alertOnPillar:s,isSessionEndingError:l,inStaging:u}),!0),c||[],!0),telemetryProperties:{ariaTenantToken:t.token,nexusTenantToken:E.di}})}))}!function(e){e[e.None=0]="None",e[e.Sampled=1]="Sampled"}(b||(b={}));var A="[-_*/0-9a-z]",I="[a-z]".concat(A,"{0,255}"),O="[0-9a-z]".concat(A,"{0,240}"),_="[a-z]".concat(A,"{0,13}"),M="".concat(O,"@").concat(_),D=new RegExp("^(?:".concat(I,"|").concat(M,")$")),w=/^[ -+--<>-~]{0,255}[!-+--<>-~]$/,L=function(){function e(){this._listMemberMap=new Map}return e.prototype.set=function(e,t){if(!D.test(e)||!w.test(t))return!1;var r=this._listMemberMap;return r.has(e)&&r.delete(e),r.set(e,t),r.size>32&&r.delete(r.keys().next().value),!0},e.prototype.unset=function(e){this._listMemberMap.delete(e)},e.prototype.get=function(e){return this._listMemberMap.get(e)},Object.defineProperty(e.prototype,"keys",{get:function(){return Array.from(this._listMemberMap.keys()).reverse()},enumerable:!1,configurable:!0}),e.prototype.serialize=function(){var e=this;return this.keys.map((function(t){return"".concat(t).concat("=").concat(e._listMemberMap.get(t))})).join(",")},e.parse=function(t){var r=new e,n=t.split(","),i=!0;return n.reverse().forEach((function(e){var t=e.trim();if(t){var n=t.split("=");2===n.length&&r.set(n[0],n[1])||((0,C.wC)(1,0,(function(){return"Invalid trace state entry '".concat(t,"'")})),i=!1)}})),i?r:void 0},e}(),x=/^([\da-f]{2})-([\da-f]{32})-([\da-f]{16})-([\da-f]{2})(-\S+)?$/,K=function(e){return/^0+$/.test(e)},U=/^([\da-f]{16})$/,B=16,G=function(){function e(e,t,r){void 0===e&&(e=V()),void 0===t&&(t=j()),this.traceId=e,this.version="00",this._parentId=t,this._traceFlags=function(e){return void 0===e&&(e=b.None),e&b.Sampled}(r)}return Object.defineProperty(e.prototype,"parentId",{get:function(){return this._parentId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"traceFlags",{get:function(){return this._traceFlags},enumerable:!1,configurable:!0}),e.prototype.isValid=function(){return x.test(this.serialize())&&!K(this.traceId)&&!K(this._parentId)},e.prototype.isSampled=function(){return(this.traceFlags&b.Sampled)===b.Sampled},e.prototype.updateSampled=function(e,t){return t!==this._parentId&&!!this.updateParentId(t)&&(this._traceFlags=e?this._traceFlags|b.Sampled:this._traceFlags&~b.Sampled,!0)},e.prototype.updateParentId=function(e){return e?!(!U.test(e)||K(e)||(this._parentId=e,0)):(this._parentId=j(),!0)},e.prototype.serialize=function(){return"".concat(this.version,"-").concat(this.traceId,"-").concat(this._parentId,"-0").concat(this._traceFlags)},e.create=function(t,r,n){var i=new e(t,r,n);return i.isValid()?i:void 0},e.createNew=function(t){return new e(V(),j(),t)},e.parse=function(t){var r=x.exec(t);if(r&&"ff"!==r[1]&&("00"!==r[1]||!r[5]))return e.create(r[2],r[3],parseInt(r[4],B))},e}();function W(e){var t=new Uint8Array(e);window.crypto.getRandomValues(t);var r=Array.from(t).map((function(e){return(256+e).toString(B).slice(1)})).join("");return K(r)?r.slice(1)+"1":r}function V(){return W(16)}function j(){return W(8)}var q=function(){function e(){}return e.getFields=function(e){var t="Event.",r=e.parent,n=e.state,i=n?n.serialize():void 0;return(0,P.__spreadArray)([(0,c.m9)(t+"TraceId",r.traceId),(0,c.m9)(t+"TraceParentId",r.parentId),(0,c.Ug)(t+"TraceFlags",r.traceFlags)],i?[(0,c.m9)(t+"TraceState",i)]:[],!0)},e}();function H(e,t){var r,n=G.parse(e);return n&&t&&(r=L.parse(t)),r=r||new L,{parent:n||G.createNew(),state:r}}function z(e){return{parent:G.createNew(e),state:new L}}},45856:function(){!function(e,t){"use strict";if(!e.setImmediate){var r,n,i,o,a,s=1,l={},u=!1,c=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?r=function(e){process.nextTick((function(){g(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?(o="setImmediate$"+Math.random()+"$",a=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&g(+t.data.slice(o.length))},e.addEventListener?e.addEventListener("message",a,!1):e.attachEvent("onmessage",a),r=function(t){e.postMessage(o+t,"*")}):e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){g(e.data)},r=function(e){i.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(n=c.documentElement,r=function(e){var t=c.createElement("script");t.onreadystatechange=function(){g(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):r=function(e){setTimeout(g,0,e)},d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return l[s]=i,r(s),s++},d.clearImmediate=m}function m(e){delete l[e]}function g(e){if(u)setTimeout(g,0,e);else{var t=l[e];if(t){u=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(undefined,r)}}(t)}finally{m(e),u=!1}}}}}("undefined"==typeof self?"undefined"==typeof global?this:global:self)},19181:function(e,t,r){"use strict";r.r(t),r.d(t,{__assign:function(){return o},__asyncDelegator:function(){return T},__asyncGenerator:function(){return E},__asyncValues:function(){return k},__await:function(){return b},__awaiter:function(){return p},__classPrivateFieldGet:function(){return O},__classPrivateFieldIn:function(){return M},__classPrivateFieldSet:function(){return _},__createBinding:function(){return f},__decorate:function(){return s},__esDecorate:function(){return u},__exportStar:function(){return S},__extends:function(){return i},__generator:function(){return h},__importDefault:function(){return I},__importStar:function(){return A},__makeTemplateObject:function(){return P},__metadata:function(){return g},__param:function(){return l},__propKey:function(){return d},__read:function(){return y},__rest:function(){return a},__runInitializers:function(){return c},__setFunctionName:function(){return m},__spread:function(){return F},__spreadArray:function(){return R},__spreadArrays:function(){return C},__values:function(){return v}});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function s(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function l(e,t){return function(r,n){t(r,n,e)}}function u(e,t,r,n,i,o){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,l=n.kind,u="getter"===l?"get":"setter"===l?"set":"value",c=!t&&e?n.static?e:e.prototype:null,d=t||(c?Object.getOwnPropertyDescriptor(c,n.name):{}),m=!1,g=r.length-1;g>=0;g--){var p={};for(var h in n)p[h]="access"===h?{}:n[h];for(var h in n.access)p.access[h]=n.access[h];p.addInitializer=function(e){if(m)throw new TypeError("Cannot add initializers after decoration has completed");o.push(a(e||null))};var f=(0,r[g])("accessor"===l?{get:d.get,set:d.set}:d[u],p);if("accessor"===l){if(void 0===f)continue;if(null===f||"object"!=typeof f)throw new TypeError("Object expected");(s=a(f.get))&&(d.get=s),(s=a(f.set))&&(d.set=s),(s=a(f.init))&&i.push(s)}else(s=a(f))&&("field"===l?i.push(s):d[u]=s)}c&&Object.defineProperty(c,n.name,d),m=!0}function c(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function m(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function g(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function p(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))}function h(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(l){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}var f=Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function S(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||f(t,e,r)}function v(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}function F(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function C(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n}function R(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function E(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){o.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{(r=i[e](t)).value instanceof b?Promise.resolve(r.value.v).then(l,u):c(o[0][2],r)}catch(e){c(o[0][3],e)}var r}function l(e){s("next",e)}function u(e){s("throw",e)}function c(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function T(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:b(e[n](t)),done:!1}:i?i(t):t}:i}}function k(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=v(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,i,(t=e[r](t)).done,t.value)}))}}}function P(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var N=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function A(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&f(t,e,r);return N(t,e),t}function I(e){return e&&e.__esModule?e:{default:e}}function O(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function _(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r}function M(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},70994:function(e,t){"use strict";function r(e,t,r){for(var n=0,i=e.length;n<i;){var o=Math.floor((n+i)/2);r(e[o],t)<0?n=o+1:i=o}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.strict_binsearch=t.binsearch=void 0,t.binsearch=function(e,t,n){return void 0===n&&(n=void 0),void 0===n&&(n=function(e,t){return e===t?0:e<t?-1:1}),r(e,t,n)},t.strict_binsearch=function(e,t,n){void 0===n&&(n=void 0);var i=r(e,t,n);return i===e.length||0!==n(e[i],t)?-1:i}},14488:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.numComparator=t.find_all_proposed_fixes=t.Colorize=t.tuple=void 0;var n=r(56103),i=r(74421),o=r(12742),a=r(96272),s=r(14936),l=r(70164),u=r(70994);function c(e,t){if("number"==typeof e)return e-t;for(var r=0;r<e.length;r+=1){var n=c(e[r],t[r]);if(0!==n)return n}return 0}function d(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e}t.tuple=d;var m=function(){function e(){}return e.setReportingThreshold=function(t){e.reportingThreshold=t},e.getReportingThreshold=function(){return e.reportingThreshold},e.setFormattingDiscount=function(t){e.formattingDiscount=t},e.getFormattingDiscount=function(){return e.formattingDiscount},e.process_formulas=function(t,r,i){(0,l.watchdog)("wd0xea1170");for(var o=JSON.stringify(n.ExcelUtils.baseVector()),a=function(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2]]},s=[],u=0;u<t.length;u++){(0,l.watchdog)("wd0xa1597b");for(var c=t[u],d=0;d<c.length;d++){(0,l.watchdog)("wd0x0d7fc8");var m=c[d].toString();if(m.length>0){var g=n.ExcelUtils.all_dependencies(u,d,i+u,r+d,t),p=d+r+1,h=u+i+1;if(0===g.length)"="===m[0]&&s.push([[p,h,0],e.distinguishedZeroHash]);else{var f=g.reduce(a);if(JSON.stringify(f)===o)s.push([[p,h,0],f.toString()]);else{var S=this.hash_vector(f).toString();s.push([[p,h,0],S])}}}}}return s},e.color_all_data=function(t){for(var r=[],n=0,i=Object.keys(t);n<i.length;n++){var o=i[n];(0,l.watchdog)("wd0xc22046");var a=o.split(","),s=Number(a[0]),u=Number(a[1]);r.push([[s,u,0],e.distinguishedZeroHash])}return r},e.process_values=function(t,r,n,i){for(var o=[],a=0;a<t.length;a++){(0,l.watchdog)("wd0x503d57");for(var s=t[a],u=0;u<s.length;u++){(0,l.watchdog)("wd0x366ad1");var c=s[u].toString();if(c.length>0&&"="!==r[a][u][0]&&Number(c).toString()===c){var d=u+n+1,m=a+i+1;o.push([[d,m,1],e.distinguishedZeroHash])}}}return o},e.identify_ranges=function(e,t){for(var r={},n=0,i=e;n<i.length;n++){var o=i[n];(0,l.watchdog)("wd0x770d8c"),r[o[1]]=r[o[1]]||[],r[o[1]].push(o[0])}for(var a=0,s=Object.keys(r);a<s.length;a++){var u=s[a];(0,l.watchdog)("wd0x84ae4d"),r[u].sort(t)}return r},e.group_ranges=function(e,t){var r={},n=0,i=1;t||(n=1,i=0);for(var o=0,a=Object.keys(e);o<a.length;o++){var s=a[o];(0,l.watchdog)("wd0xa372ae"),r[s]=[];for(var u=e[s].shift(),c=u,d=0,m=e[s];d<m.length;d++){var g=m[d];g[n]===c[n]&&g[i]===c[i]+1||(r[s].push([u,c]),u=g),c=g}r[s].push([u,c])}return r},e.identify_groups=function(e){var t=this.identify_ranges(e,(function(e,t){return e[0]===t[0]?e[1]-t[1]:e[0]-t[0]})),r=this.group_ranges(t,!0),n=a.JSONclone.clone(r);return this.merge_groups(n)},e.processed_to_matrix=function(t,r,n,i,o){for(var a=new Array(t),s=0;s<t;s++)a[s]=new Array(r).fill(0);for(var l=0,u=o;l<u.length;l++){var c=u[l],d=c[0],m=d[0],g=d[1],p=d[2],h=c[1],f=g-i-1,S=m-n-1,v=Number(e.distinguishedZeroHash);1===p||(v=Number(h)),a[f][S]=v}return a},e.stencilize=function(e){return s.Stencil.stencil_computation(e,(function(e,t){return e*t}),1)},e.compute_stencil_probabilities=function(e,t,r){for(var n=new Array(e),i=0;i<e;i++)n[i]=new Array(t).fill(0);var o=0,a={};for(i=0;i<e;i++)for(var s=0;s<t;s++)a[r[i][s]]=a[r[i][s]]+1||1,0!==r[i][s]&&(o+=1);for(i=0;i<e;i++)for(s=0;s<t;s++)n[i][s]=a[r[i][s]]/o;var l=0;for(i=0;i<e;i++)for(s=0;s<t;s++)r[i][s]>0&&(l+=a[r[i][s]]);for(i=0;i<e;i++)for(s=0;s<t;s++)a[r[i][s]]>0&&this.entropy(a[r[i][s]]/l);return Math.log2(o),n},e.generate_suspicious_cells=function(e,t,r,n,i,o,a){void 0===a&&(a=.01);for(var s=[],l=0,u=0,c=0;c<e;c++)for(var d=0;d<t;d++){var m=d+r+1,g=c+n+1;o[c][d]>0&&(l+=i[c][d],u+=1,o[c][d]<=a&&0!==i[c][d]&&s.push([m,g,o[c][d]]))}var p=l/u;return s.sort((function(e,t){return Math.abs(t[2]-p)-Math.abs(e[2]-p)})),s},e.process_suspicious=function(t,r,i){(0,l.watchdog)("wd0x72fd38"),new o.Timer("process_suspicious");var a=n.ExcelUtils.extract_sheet_cell(t),s=(a[0],a[1]),u=n.ExcelUtils.cell_dependency(s,0,0),c=[];r.length>this.formulasThreshold?console.warn("Too many formulas to perform formula analysis."):c=e.process_formulas(r,u[0]-1,u[1]-1);var m=[],g=[],p=i.length,h=i[0].length;if(i.length>this.valuesThreshold)console.warn("Too many values to perform reference analysis.");else{var f=n.ExcelUtils.generate_all_references(r,u[0]-1,u[1]-1);m=e.color_all_data(f),g=e.process_values(i,r,u[0]-1,u[1]-1)}var S=e.identify_groups(m),v=e.identify_groups(c),y=[];return i.length<1e4&&(y=e.find_suspicious_cells(p,h,u,r,c,g,1)),d(y,v,S,e.generate_proposed_fixes(v))},e.entropy=function(e){return-e*Math.log2(e)},e.entropydiff=function(e,t){var r=e+t;return-(this.entropy(e/r)+this.entropy(t/r))/Math.log2(r)},e.fix_metric=function(e,t,r,n){var o=t[0],a=t[1],s=n[0],l=n[1],u=i.RectangleUtils.area([[o[0],o[1],0],[a[0],a[1],0]]),c=i.RectangleUtils.area([[s[0],s[1],0],[l[0],l[1],0]]),d=Math.min(u,c),m=Math.max(u,c),g=Math.min(r,e),p=Math.max(r,e),h=Math.abs(p-g)/this.Multiplier;h<1&&(h=1);var f=(1+this.entropydiff(d,m))/(h*d);return-f},e.count_proposed_fixes=function(e){var t=0;for(var r in e){var n=e[r][1],o=n[0],a=n[1],s=e[r][2],l=s[0],u=s[1];t+=i.RectangleUtils.diagonal([[o[0],o[1],0],[a[0],a[1],0]]),t+=i.RectangleUtils.diagonal([[l[0],l[1],0],[u[0],u[1],0]])}return t},e.fix_proposed_fixes=function(t){var r={},n={};for(var i in t){if(t[i][1]>t[i][2]){var o=t[i][1];t[i][1]=t[i][2],t[i][2]=o}r[JSON.stringify(t[i][1])]=t[i],n[JSON.stringify(t[i][2])]=t[i]}var a=[],s={};for(var i in t){var l=t[i][0];if(!(-l<e.reportingThreshold/100)){var u=JSON.stringify(t[i][1]),c=JSON.stringify(t[i][2]);if(u in n||c in r){if(!s[u]&&u in n){var d=[-l*JSON.parse(n[u][0]),t[i][1],n[u][1]];a.push(d),s[u]=!0,s[c]=!0;continue}!s[c]&&c in r&&(d=[-l*JSON.parse(r[c][0]),t[i][1],r[c][2]],a.push(d),s[c]=!0,s[u]=!0)}else a.push(t[i])}}return a},e.generate_proposed_fixes=function(e){var t=p(e);return t.sort(c),t},e.merge_groups=function(e){for(var t=0,r=Object.keys(e);t<r.length;t++){var n=r[t];(0,l.watchdog)("wd0x781a33");var i=e[n].slice();e[n]=this.merge_individual_groups(i)}return e},e.merge_individual_groups=function(e){var t=new o.Timer("merge_individual_groups"),r=0;for(e=e.sort();;){(0,l.watchdog)("wd0x0a3668");for(var n=!1,a={},s=[],u=e.slice();u.length>0;)for(var c=u.shift(),d=0;d<u.length;d++)if((0,l.watchdog)("wd0x9cf1d5"),i.RectangleUtils.is_mergeable(c,u[d])){var m=JSON.stringify(c),g=JSON.stringify(u[d]);if(!(m in a)&&!(g in a)){s.push(i.RectangleUtils.bounding_box(c,u[d])),a[m]=!0,a[g]=!0,n=!0;break}}for(d=0;d<e.length;d++)(0,l.watchdog)("wd0x1bc2bb"),JSON.stringify(e[d])in a||s.push(e[d]);if(s.sort(),!n)return s;if(e=s.slice(),++r>2e3)return console.warn("Too many iterations; abandoning this group."),t.split("done, "+r+" iterations."),[[[-1,-1,0],[-1,-1,0]]]}},e.hash_vector=function(e){var t=Math.abs(e[0]-0),r=Math.abs(e[1]-0),n=e[2];return this.Multiplier*(t+r+n)},e.adjust_proposed_fixes=function(e,t,r,n){return e.map((function(e){var i=e[0];if(100*-i<1)return null;for(var o=e[1].map((function(e){return e.toString().padStart(10,"0")})),a=e[2].map((function(e){return e.toString().padStart(10,"0")})),s=o<a?e[1]:e[2],l=o<a?e[2]:e[1],u=s[0],c=u[0],m=u[1],g=s[1],p=(g[0],g[1],l[0]),h=(p[0],p[1],l[1]),f=h[0],S=h[1],v=c-r-1,y=m-n-1,F=f-r-1,C=S-n-1,R=!0,b=JSON.stringify(t[y][v]),E=y;E<=C;E++)for(var T=v;T<=F;T++)if(JSON.stringify(t[E][T])!==b){R=!1;break}return d(i,s,l,R)})).filter((function(e){return null!==e}))},e.find_suspicious_cells=function(e,t,r,n,i,o,a){return(0,l.watchdog)("wd0x8cabd6"),[]},e.reportingThreshold=35,e.suspiciousCellsReportingThreshold=85,e.formattingDiscount=50,e.formulasThreshold=1e4,e.valuesThreshold=1e4,e.Multiplier=1,e.distinguishedZeroHash="12345",e}();function g(e,t){var r=e[0],n=(e[1],t[0]);return t[1],r[0]!==n[0]?r[0]-n[0]:r[1]-n[1]}function p(e){var t=[],r={};!function(e,t){for(var r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];(0,l.watchdog)("wd0xa287cd"),t[i]=e[i].sort(g).map((function(e,t,r){return[e[0].map((function(e,t,r){return Number(e)})),e[1].map((function(e,t,r){return Number(e)}))]}))}}(e,r);for(var n={},i={},o=0,a=Object.keys(e);o<a.length;o++){var s=a[o];(0,l.watchdog)("wd0xb02b87"),n[s]=r[s].map((function(e,t,r){var n=e[0];return e[1],n})),i[s]=r[s].map((function(e,t,r){return e[0],e[1]}))}var u=function(e){for(var t={},r=0,n=Object.keys(e);r<n.length;r++){for(var i=n[r],o=1e6,a=1e6,s=-1e6,l=-1e6,u=0;u<e[i].length;u++){var c=e[i][u][0][0],d=e[i][u][1][0],m=e[i][u][0][1],g=e[i][u][1][1];d>s&&(s=d),c<o&&(o=c),g>l&&(l=g),m<a&&(a=m)}t[i]=[[o,a,0],[s,l,0]]}return t}(e),c=Object.keys(e);h(c,(function(e,t){return u[e][0][0]-u[t][0][0]}));var d=c.map((function(e,t,r){return u[e]})),m=Object.keys(e);h(m,(function(e,t){return u[e][0][1]-u[t][0][1]}));for(var p,v=m.map((function(e,t,r){return u[e]})),y=0,F=Object.keys(e);y<F.length;y++){s=F[y];for(var C=0;C<r[s].length;C++){(0,l.watchdog)("wd0xe37031");var R=S(s,r[s][C],0,c,m,n,i,u,d,v);t=t.concat(R)}}return t=t.map((function(e,t,r){return f(e[1],e[2])<0?[e[0],e[2],e[1]]:[e[0],e[1],e[2]]})),p={},t.filter((function(e){return!(p[e]=e in p)}))}function h(e,t){for(var r=e.map((function(e,t){return{item:e,index:t}})).sort((function(e,r){return t(e.item,r.item)||e.index-r.index})).map((function(e){return e.item})),n=0;n<e.length;n+=1)e[n]=r[n];return e}function f(e,t){for(var r=0;r<3;r++){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1}return 0}function S(e,t,r,n,i,o,a,s,l,c){var d,g,p,h=t[0],S=t[1],v=[],y=(0,u.binsearch)(l,t,(function(e,t){return e[0][0]-t[0][0]})),F=(0,u.binsearch)(c,t,(function(e,t){return e[0][1]-t[0][1]}));y>F?(d=n,p=y,g=0):(d=i,p=F,g=1),p>0&&(p-=1);for(var C=function(r){var n=d[r];if(n===e)return"continue";var i=s[n];if(0===g){if(S[0]+1<i[0][0])return"break"}else if(S[1]+1<i[0][1])return"break";if(S[0]+1<i[0][0]||S[1]+1<i[0][1]||i[1][0]+1<h[0]||i[1][1]+1<h[1]);else{var l=function(e,t,r,n){var i=e[0],o=e[1],a=t[0],s=t[1],l=[i-1,s,0],c=[a,o-1,0],d=[a+1,o,0],m=[i,s+1,0],g=[],p=-1;if(-1!==(p=(0,u.strict_binsearch)(n,l,f))&&r[p][1]===o){var h=[r[p],n[p]];g.push(h)}return-1!==(p=(0,u.strict_binsearch)(n,c,f))&&r[p][0]===i&&(h=[r[p],n[p]],g.push(h)),-1!==(p=(0,u.strict_binsearch)(r,d,f))&&n[p][1]===s&&(h=[r[p],n[p]],g.push(h)),-1!==(p=(0,u.strict_binsearch)(r,m,f))&&n[p][0]===a&&(h=[r[p],n[p]],g.push(h)),g}(h,S,o[n],a[n]);l.length>0&&(v=v.concat(l.map((function(r,i,o){return[m.fix_metric(parseFloat(e),t,parseFloat(n),r),t,r]}))))}},R=p;R<d.length&&"break"!==C(R);R++);return v}t.Colorize=m,t.find_all_proposed_fixes=p,t.numComparator=f},52376:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detect_errors=void 0;var n=r(56103),i=r(14488),o=r(12742),a=r(70164);function s(e,t){for(var r=e[0],n=e[1],i=t[0],o=t[1],a=[],s=r;s<=i;s++)for(var l=n;l<=o;l++)a.push([s,l,0]);return a}t.detect_errors=function(e,t,r,l){void 0===l&&(l=1/0),t=null!=t?t:i.Colorize.getFormattingDiscount(),r=null!=r?r:i.Colorize.getReportingThreshold(),a.watchdog.arm(l);for(var u=e.worksheets.map((function(e){if((0,a.watchdog)("wd0x8d98cc"),0===e.formulas.length&&0===e.values.length)return{name:"",out:null};var l=e.usedRangeAddress;l=l.replace(/!(!+)/,"!");var u=new o.Timer("excelint"),c=i.Colorize.process_suspicious(l,e.formulas,e.values),d=(c[0],c[1],c[2],c[3]);(0,a.watchdog)("wd0x7919b4");var m=u.elapsedTime(),g=i.Colorize.adjust_proposed_fixes(d,e.styles,0,0),p=u.elapsedTime(),h=g.map((function(e){(0,a.watchdog)("wd0xfb8f16");var n=e[0],o=e[1],s=e[2],l=e[3],u=-n;return l||(u*=(100-t)/100),100*u>=r?(0,i.tuple)(u,o,s,l):null})).filter((function(e){return null!==e})),f=function(e,t){return(t[0]-e[0]+1)*(t[1]-e[1]+1)*(t[2]-e[2]+1)},S=u.elapsedTime(),v=h.map((function(t){(0,a.watchdog)("wd0x2375dd");for(var r=t[1][0][0]===t[2][0][0]?"vertical":"horizontal",i=[],o=[],s=[],l=[],u=[],c=[],d=[],m=[],g=[],p=t[3],h=[f.apply(void 0,t[1]),f.apply(void 0,t[2])],S=0;S<2;S++){var v=t[S+1][0],y=v[1]-1,F=v[0]-1,C=e.formulas[y][F],R=n.ExcelUtils.numeric_constants(C);u.push(R),c.push(c.reduce((function(e,t){return e+t}),0));var b=n.ExcelUtils.all_cell_dependencies(C,F+1,y+1,!1);d.push(b.length);var E=n.ExcelUtils.formulaToR1C1(C,F+1,y+1),T=n.ExcelUtils.column_index_to_name(F+1)+(y+1)+":",k=T+E;s.push(E),l.push(k),i.push(C),o.push(T+C),m.push((C.match(/\$/g)||[]).length),g.push(b)}var P=Math.abs(c[0]-c[1]),N=[];for(S=0;S<g.length;S++)if(g[S].length>0){if("vertical"===r&&0===g[S][0][0]&&-1===g[S][0][1]){N.push("recurrent-formula");break}if("horizontal"===r&&-1===g[S][0][0]&&0===g[S][0][1]){N.push("recurrent-formula");break}}for(d[0]!==d[1]&&N.push("different-referent-count"),u[0].length!==u[1].length&&(1===Math.abs(u[0].length-u[1].length)?N.push("one-extra-constant"):N.push("number-of-constants-mismatch")),u[0].length>0&&u[1].length>0&&(d[0]+d[1]===0?N.push("both-constants"):d[0]*d[1]==0&&N.push("one-is-all-constants")),s[0]!==s[1]&&JSON.stringify(g[0].sort())!==JSON.stringify(g[1].sort())&&N.push("r1c1-mismatch"),m[0]!==m[1]&&N.push("absolute-ref-mismatch"),S=0;S<g.length;S++)if(g[S].length>0&&g[S][0][0]*g[S][0][1]!=0){N.push("off-axis-reference");break}return 0===N.length&&N.push("unclassified"),{bin:N,direction:r,sameFormat:p,rangeSizes:h,numbers:c,sameConstants:u[0]===u[1],numeric_difference:P,magnitude_numeric_difference:0===P?0:Math.log10(P),formulas:o,r1c1formulas:l,dependence_vectors:g}})),y=u.elapsedTime(),F=e.formulas.flat().filter((function(e){return e.length>0})).length,C=e.values.flat().filter((function(e){return e.length>0})).length,R=e.values[0].length,b=e.values.length,E=b*R,T=h.map((function(e){return e[0]})).reduce((function(e,t){return e+t}),0),k=h.map((function(e){return(0,a.watchdog)("wd0xbcc23c"),e[0]>=r/100?s(e[1][0],e[1][1]).concat(s(e[2][0],e[2][1])):[]})),P=Array.from(new Set(k.flat(1).map((function(e){return JSON.stringify(e)}))));k=P.map((function(e){return JSON.parse(e)}));var N=u.elapsedTime(),A={suspiciousnessThreshold:r,formattingDiscount:t,proposedFixes:h,exampleFixes:v,suspiciousRanges:h.length,weightedSuspiciousRanges:T,suspiciousCells:k.length,elapsedTimeSeconds:N/1e3,proposedFixesTimeSeconds:m/1e3,adjustProposedFixesTimeSeconds:(p-m)/1e3,adjustFormatProposedFixesTimeSeconds:(S-p)/1e3,exampleFixesTimeSeconds:(y-S)/1e3,numCountingTimeSeconds:(N-y)/1e3,columns:R,rows:b,totalCells:E,numFormulaCells:F,numValueCells:C};return{name:e.sheetName,out:A}})).filter((function(e){return null!==e.out})),c={},d=0,m=u;d<m.length;d++){var g=m[d],p=g.name,h=g.out;c[p]=h}return{workbookName:e.workbookName,worksheets:c}}},56103:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExcelUtils=void 0;var n=r(70164),i=function(){function e(){}return e.column_name_to_index=function(e){if(1===e.length)return e[0].charCodeAt(0)-"A".charCodeAt(0)+1;for(var t=0,r=0,n=e.split("");r<n.length;r++)t*=26,t+=n[r].charCodeAt(0)-"A".charCodeAt(0)+1;return t},e.column_index_to_name=function(e){for(var t="";e>0;)t+=String.fromCharCode((e-1)%26+65),e=Math.floor((e-1)/26);return t.split("").reverse().join("")},e.cell_dependency=function(t,r,i){var o;if((0,n.watchdog)("wd0x1a9bd3"),o=e.cell_both_absolute.exec(t)){var a=e.column_name_to_index(o[1]),s=Number(o[2]);return o[2][0]>=""&&(s=Number(o[2].charCodeAt(0)-16384)),[a,s,0]}if((0,n.watchdog)("wd0xa26bda"),o=e.cell_col_absolute.exec(t))return a=e.column_name_to_index(o[1]),s=Number(o[2]),o[2][0]>=""&&(s=Number(o[2].charCodeAt(0)-16384)),[a,s-i,0];if((0,n.watchdog)("wd0x2a23e1"),o=e.cell_row_absolute.exec(t))return a=e.column_name_to_index(o[1]),s=Number(o[2]),o[2][0]>=""&&(s=Number(o[2].charCodeAt(0)-16384)),[a-r,s,0];if((0,n.watchdog)("wd0x3ebc91"),o=e.cell_both_relative.exec(t))return a=e.column_name_to_index(o[1]),s=Number(o[2]),o[2][0]>=""&&(s=Number(o[2].charCodeAt(0)-16384)),[a-r,s-i,0];throw new Error("We should never get here.")},e.toR1C1=function(t,r,n){void 0===n&&(n=!1);var i=e.cell_dependency(t,0,0),o=e.cell_dependency(r,0,0),a="R",s="C";n&&(a="",s="");var l=[];o.forEach((function(e,t,r){l.push(e-i[t])}));var u="";return e.cell_both_absolute.exec(r)?u=a+o[1]+s+o[0]:e.cell_col_absolute.exec(r)?(0===l[1]?u+=a:u+=a+"["+l[1]+"]",u+=s+o[0]):e.cell_row_absolute.exec(r)?(0===l[0]?u+=s:u+=s+"["+l[0]+"]",u=a+o[1]+u):(0===l[1]?u+=a:u+=a+"["+l[1]+"]",0===l[0]?u+=s:u+=s+"["+l[0]+"]"),u},e.formulaToR1C1=function(t,r,n){for(var i,o=t.slice(),a=e.column_index_to_name(r)+n;i=e.range_pair.exec(o);)if(i){var s=i[1];i[2],o=o.replace(i[0],e.toR1C1(a,i[1],!0)+":"+e.toR1C1(a,i[2],!0))}for(var l=null;l=e.single_dep.exec(o);)l&&(s=l[1],o=o.replace(l[0],e.toR1C1(a,s,!0)));return(o=o.replace(//g,"R")).replace(//g,"C")},e.extract_sheet_cell=function(t){(0,n.watchdog)("wd0x012630");var r=e.sheet_plus_cell.exec(t);return r?[r[1],r[2],r[2]]:["","",""]},e.all_cell_dependencies=function(t,r,i,o){void 0===o&&(o=!0),(0,n.watchdog)("wd0x2f82fe");var a=null,s=[];if("string"!=typeof t)return null;for(t=(t=(t=(t=(t=(t=(t=t.replace(this.formulas_with_numbers,"_")).replace(this.formulas_with_quoted_sheetnames_2,"_")).replace(this.formulas_with_quoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_2,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_structured_references,"_");a=e.range_pair.exec(t);)if((0,n.watchdog)("wd0x784918"),a){for(var l=a[1],u=e.cell_dependency(l,r,i),c=a[2],d=e.cell_dependency(c,r,i),m=d[0]-u[0]+1,g=d[1]-u[1]+1,p=0;p<m;p++)for(var h=0;h<g;h++)s.push([p+u[0],h+u[1],0]);t=t.replace(a[0],"_")}for(var f=null;f=e.single_dep.exec(t);)if((0,n.watchdog)("wd0x0fb232"),f){l=f[1];var S=e.cell_dependency(l,r,i);s.push(S),t=t.replace(f[0],"_")}if(o)for(var v=null;v=e.number_dep.exec(t);)(0,n.watchdog)("wd0xd82ed1"),v&&(s.push([0,0,1]),t=t.replace(v[0],"_"));return s},e.numeric_constants=function(t){var r=[];if("string"!=typeof(t=t.slice()))return r;t=(t=(t=(t=(t=(t=(t=t.replace(this.formulas_with_numbers,"_")).replace(this.formulas_with_quoted_sheetnames_2,"_")).replace(this.formulas_with_quoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_2,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_structured_references,"_");for(var n=null;n=e.range_pair.exec(t);)n&&(t=t.replace(n[0],"_"));for(var i=null;i=e.single_dep.exec(t);)i&&(t=t.replace(i[0],"_"));for(var o=null;o=e.number_dep.exec(t);)o&&(r.push(parseFloat(o)),t=t.replace(o[0],"_"));return r},e.baseVector=function(){return[0,0,0]},e.all_dependencies=function(t,r,i,o,a){(0,n.watchdog)("wd0x961028");var s=[];if(t>=a.length||r>=a[0].length||t<0||r<0)return[];var l=a[t][r];return l.length>1&&"="===l[0]&&(s=e.all_cell_dependencies(l,o,i)),s},e.generate_all_references=function(t,r,i){(0,n.watchdog)("wd0x6a6002");for(var o={},a=0;a<t.length;a++)for(var s=t[a],l=0;l<s.length;l++){(0,n.watchdog)("wd0x93d412");var u=s[l];if("="===u[0])for(var c=0,d=e.all_cell_dependencies(u,0,0);c<d.length;c++){var m=d[c];if((0,n.watchdog)("wd0x8a466e"),0===m[0]&&0===m[1]&&0!==m[2]);else{var g=m[0]-r-1,p=m[1]-i-1,h=!1;if(p>=t.length||g>=t[0].length||g<0||p<0)h=!0;else{var f=t[p][g];void 0!==f&&"="!==f[0]&&(h=!0)}h&&(o[m.join(",")]=!0)}}}return o},e.general_re="\\$?[A-Z][A-Z]?\\$?[\\d\\u2000-\\u6000]+",e.sheet_re="[^\\!]+",e.sheet_plus_cell=new RegExp("("+e.sheet_re+")\\!("+e.general_re+")"),e.sheet_plus_range=new RegExp("("+e.sheet_re+")\\!("+e.general_re+"):("+e.general_re+")"),e.single_dep=new RegExp("("+e.general_re+")"),e.range_pair=new RegExp("("+e.general_re+"):("+e.general_re+")","g"),e.number_dep=new RegExp("([0-9]+\\.?[0-9]*)"),e.cell_both_relative=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),e.cell_col_absolute=new RegExp("\\$([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),e.cell_row_absolute=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),e.cell_both_absolute=new RegExp("\\$([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),e.formulas_with_numbers=new RegExp("/ATAN2|BIN2DEC|BIN2HEX|BIN2OCT|DAYS360|DEC2BIN|DEC2HEX|DEC2OCT|HEX2BIN|HEX2DEC|HEX2OCT|IMLOG2|IMLOG10|LOG10|OCT2BIN|OCT2DEC|OCT2HEX|SUNX2MY2|SUMX2PY2|SUMXMY2|T.DIST.2T|T.INV.2T/","g"),e.formulas_with_quoted_sheetnames_1=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_quoted_sheetnames_2=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_unquoted_sheetnames_1=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_unquoted_sheetnames_2=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_structured_references=new RegExp("\\[([^\\]])*\\]","g"),e.originalSheetSuffix="_EL",e}();t.ExcelUtils=i},5055:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detect_errors=void 0;var n=r(52376);Object.defineProperty(t,"detect_errors",{enumerable:!0,get:function(){return n.detect_errors}})},14936:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Stencil=t.InfoGain=void 0;var r=function(){function e(){}return e.normalized_entropy=function(e){for(var t=e.reduce((function(e,t){return e+t}),0),r=0,n=0;n<e.length;n++){var i=e[n]/t;0!==i&&(r-=i*Math.log2(i))}return r/Math.log2(t)},e}();t.InfoGain=r;var n=function(){function e(){}return e.initialize=function(){if(!e.initialized){if(e.stencil_right=e.stencil.filter((function(e){var t=e[0];return e[1],t<=0})),e.stencil_left=e.stencil.filter((function(e){var t=e[0];return e[1],t>=0})),e.stencil_top=e.stencil.filter((function(e){return e[0],e[1]>=0})),e.stencil_bottom=e.stencil.filter((function(e){return e[0],e[1]<=0})),e.stencil_topleft=e.stencil_top.filter((function(e){var t=e[0];return e[1],t>=0})),e.stencil_topright=e.stencil_top.filter((function(e){var t=e[0];return e[1],t<=0})),e.stencil_bottomleft=e.stencil_bottom.filter((function(e){var t=e[0];return e[1],t>=0})),e.stencil_bottomright=e.stencil_bottom.filter((function(e){var t=e[0];return e[1],t<=0})),e.reflectStencils){var t=void 0;t=e.stencil.filter((function(e){var t=e[0];return e[1],t>0})).map((function(e){return[-e[0],e[1]]})),e.stencil_right=e.stencil_right.concat(t),t=e.stencil.filter((function(e){var t=e[0];return e[1],t<0})).map((function(e){return[-e[0],e[1]]})),e.stencil_left=e.stencil_left.concat(t),t=e.stencil.filter((function(e){return e[0],e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_top=e.stencil_top.concat(t),t=e.stencil.filter((function(e){return e[0],e[1]>0})).map((function(e){return[e[0],-e[1]]})),e.stencil_bottom=e.stencil_bottom.concat(t),t=e.stencil_top.filter((function(e){var t=e[0];return e[1],t<0})).map((function(e){return[-e[0],e[1]]})),e.stencil_topleft=e.stencil_topleft.concat(t),t=e.stencil_left.filter((function(e){return e[0],e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_topleft=e.stencil_topleft.concat(t),e.stencil_topleft.splice(e.stencil_topleft.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([1,1])})),1),t=e.stencil_top.filter((function(e){var t=e[0];return e[1],t>0})).map((function(e){return[-e[0],e[1]]})),e.stencil_topright=e.stencil_topright.concat(t),t=e.stencil_right.filter((function(e){return e[0],e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_topright=e.stencil_topright.concat(t),e.stencil_topright.splice(e.stencil_topright.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([-1,1])})),1),t=e.stencil_bottom.map((function(e){return[-e[0],e[1]]})).filter((function(e){var t=e[0];return e[1],t>0})),e.stencil_bottomleft=e.stencil_bottomleft.concat(t),t=e.stencil_left.map((function(e){return[e[0],-e[1]]})).filter((function(e){return e[0],e[1]<0})),e.stencil_bottomleft=e.stencil_bottomleft.concat(t),e.stencil_bottomleft.splice(e.stencil_bottomleft.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([1,-1])})),1),t=e.stencil_bottom.map((function(e){return[-e[0],e[1]]})).filter((function(e){var t=e[0];return e[1],t<0})),e.stencil_bottomright=e.stencil_bottomright.concat(t),t=e.stencil_right.map((function(e){return[e[0],-e[1]]})).filter((function(e){return e[0],e[1]<0})),e.stencil_bottomright=e.stencil_bottomright.concat(t),e.stencil_bottomright.splice(e.stencil_bottomright.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([-1,-1])})),1)}e.initialized=!0}},e.apply_stencil=function(t,r,n,i,o,a){if(t.length!==e.stencil.length)throw Error("Length mismatched");for(var s=o,l=0;l<t.length;l++){var u=t[l],c=u[0];s=a(s,r[n+u[1]][i+c])}return s},e.stencil_computation=function(t,r,n){e.initialize();for(var i=t.length,o=t[0].length,a=Array(i).fill(0).map((function(){return Array(o).fill(0)})),s=1;s<o-1;s++)for(var l=1;l<i-1;l++)a[l][s]=e.apply_stencil(e.stencil,t,s,l,n,r);for(l=1;l<o-1;l++)a[0][l]=e.apply_stencil(e.stencil_top,t,0,l,n,r),a[i-1][l]=e.apply_stencil(e.stencil_bottom,t,i-1,l,n,r);for(s=1;s<i-1;s++)a[s][0]=e.apply_stencil(e.stencil_left,t,s,0,n,r),a[s][o-1]=e.apply_stencil(e.stencil_right,t,s,o-1,n,r);return a[0][0]=e.apply_stencil(e.stencil_topleft,t,0,0,n,r),a[0][o-1]=e.apply_stencil(e.stencil_topright,t,0,o-1,n,r),a[i-1][0]=e.apply_stencil(e.stencil_bottomleft,t,i-1,0,n,r),a[i-1][o-1]=e.apply_stencil(e.stencil_bottomright,t,i-1,o-1,n,r),a},e.reflectStencils=!0,e.ninePointStencil=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,0],[0,1],[1,-1],[1,0],[1,1]],e.stencil=e.ninePointStencil,e.initialized=!1,e}();t.Stencil=n},96272:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSONclone=void 0;var r=function(){function e(){}return e.clone=function(t){if(t){if(Array.isArray(t))return t.slice();if(t.constructor===Object){for(var r={},n=0,i=Object.keys(t);n<i.length;n++){var o=i[n];r[o]=e.clone(t[o])}return r}return t}return null},e}();t.JSONclone=r},74421:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RectangleUtils=void 0;var r=function(){function e(){}return e.is_adjacent=function(e,t){var r=e[0],n=r[0],i=r[1],o=(r[2],e[1]),a=o[0],s=o[1],l=(o[2],t[0]),u=l[0],c=l[1],d=(l[2],t[1]),m=d[0],g=d[1];return d[2],!(n-m>1||u-a>1||i-g>1||c-s>1)},e.bounding_box=function(e,t){var r=e[0],n=r[0],i=r[1],o=(r[2],e[1]),a=o[0],s=o[1],l=(o[2],t[0]),u=l[0],c=l[1],d=(l[2],t[1]),m=d[0],g=d[1];return d[2],[[Math.min(n,u),Math.min(i,c),0],[Math.max(a,m),Math.max(s,g),0]]},e.area=function(e){var t=e[0],r=t[0],n=t[1],i=(t[2],e[1]),o=i[0],a=i[1];return i[2],(o-r+1)*(a-n+1)},e.diagonal=function(e){var t=e[0],r=t[0],n=t[1],i=(t[2],e[1]),o=i[0],a=i[1],s=(i[2],o-r+1),l=a-n+1;return Math.sqrt(s*s+l*l)},e.overlap=function(e,t){var r=e[0],n=r[0],i=r[1],o=(r[2],e[1]),a=o[0],s=o[1],l=(o[2],t[0]),u=l[0],c=l[1],d=(l[2],t[1]),m=d[0],g=d[1];return d[2],(a>m?m-n+1:a-u+1)*(s>g?g-i+1:s-c+1)},e.is_mergeable=function(t,r){return e.is_adjacent(t,r)&&e.area(t)+e.area(r)-e.overlap(t,r)===e.area(e.bounding_box(t,r))},e}();t.RectangleUtils=r},12742:function(e,t){"use strict";function r(){return"undefined"!=typeof process?{now:function(){var e=process.hrtime();return(1e9*e[0]+e[1])/1e6}}:"undefined"!=typeof performance?performance:Date}Object.defineProperty(t,"__esModule",{value:!0}),t.Timer=t.createPerf=void 0,t.createPerf=r;var n=function(){function e(e){this.perf=r(),this.name=e,this.start()}return e.prototype.start=function(){this.startTimeMS=this.perf.now(),this.splitTimeMS=this.startTimeMS},e.prototype.split=function(e){var t=this.perf.now(),r=t-this.splitTimeMS;console.warn("timer: "+this.name+" @ "+e+" : = "+this.roundMe(r)+" (total = "+this.roundMe(t-this.startTimeMS)+")"),this.splitTimeMS=t},e.prototype.elapsedTime=function(){return this.perf.now()-this.startTimeMS},e.prototype.roundMe=function(e){return Math.round(100*e)/100},e}();t.Timer=n},70164:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.watchdog=void 0;var n,i,o=(0,r(12742).createPerf)();t.watchdog=(n=1/0,(i=function(e){if(void 0===e&&(e=""),o.now()>n)throw new Error("Time limit exceeded with message: ".concat(e))}).arm=function(e){n=o.now()+e},i)},4133:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.anonymizeFormulaString=t.anonymizeMagnitude=t.kindAnonymizers=t.anonymize=void 0;const n=r(34911);function i(e){return e}function o(e,r){if("string"==typeof r&&null!=a[r])return e;const n=function(e){if("object"==typeof e&&null!==e){const t=e.kind;if("string"==typeof t)return t}}(e);let i=void 0!==n?t.kindAnonymizers[n]:void 0;return void 0===i&&(i=s[function(e){const t=typeof e;if("object"===t){if(null===e)return"null";if(Array.isArray(e))return"Array"}return t}(e)]),void 0!==i?i(e,r):"<unexpected>"}t.anonymize=function(e){try{return String(JSON.stringify(o(e,void 0)))}catch(e){if(null==e||"object"!=typeof e)return`<error: ${String(JSON.stringify(e))}>`;const t=String(e.name),r=String(e.message);return r.indexOf(t)>=0?`<error ${r}>`:`<error ${t}: ${r}>`}};const a={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},s={boolean:i,symbol:function(e){return"symbol"!=typeof e?"<unexpected>":`<symbol ${String(e)}>`},undefined:i,null:i,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},bigint:function(e){return"bigint"!=typeof e?"<unexpected>":"<bigint>"},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";const t=e.name;return"string"==typeof t&&t.length>0?`<function ${t}>`:"<function>"},object:function(e){if("object"!=typeof e)return"<unexpected>";const t={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=o(e[r],r));return t},Array:function(e){return"object"==typeof e&&Array.isArray(e)?e.map(o):"<unexpected>"}};t.kindAnonymizers=Object.create(null),t.anonymizeMagnitude=function(e){const t=Math.abs(e);return 0===t?-1e4:Math.floor((0,n.mathLog2)(t))};const l=new RegExp("[^=\\[\\]\\.\\\\\\/%@#\\-_\\+,;\\(\\):?\"&<>'!\\{\\}~\\^\\*$\\sd]","g"),u=/[0-9]/g,c=/d/g;t.anonymizeFormulaString=function(e){return e.toLowerCase().replace(c,"w").replace(u,"d").replace(l,"w")}},24939:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.broadcastArray2D=t.broadcastArray=t.sparseArray2DTo1D=t.transposeSparseArray2D=t.transposeArray2D=t.colArray2D=t.rowArray2D=t.singletonArray2D=t.constantArray2D=t.constantArray=t.array2DToJaggedArray=t.jaggedArray=t.array2DForall2=t.array2DForall=t.NonstrictSparseArray2D=t.NonstrictArray2D=t.StrictSparseArray2D=t.StrictArray2D=void 0;const n=r(12484),i=r(64678);class o{get(e,t){return(0,n.assertIndex)("calc.common.StrictArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.StrictArray2D.get",t,this.cols),this.elements[e][t]}strict(){return this}map(e){return new s(this.rows,this.cols,((t,r)=>e(this.elements[t][r])))}constructor(e,t,r){(0,n.assertNatural)("calc.common.StrictArray2D",e),(0,n.assertNatural)("calc.common.StrictArray2D",t);const i=r.length;i<e&&(0,n.assertFalse)(`calc.common.StrictArray2D: expected elements.length >= ${e}; given ${i}`);for(let o=0;o<i;o+=1){const i=r[o].length;i<t&&(0,n.assertFalse)(`calc.common.StrictArray2D: expected elements[${o}].length >= ${e}; given ${i}`)}this.rows=e,this.cols=t,this.elements=r}}t.StrictArray2D=o;class a{get(e,t){return(0,n.assertIndex)("calc.common.StrictSparseArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.StrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseElements[e][t]:this.sparseElement}getSparse(){return this.sparseElement}strict(){return this}map(e){return new l(this.rows,this.cols,this.denseRows,this.denseCols,((t,r)=>e(this.denseElements[t][r])),(()=>e(this.sparseElement)))}constructor(e,t,r,i,o,a){(0,n.assertNatural)("calc.common.StrictSparseArray2D",e),(0,n.assertNatural)("calc.common.StrictSparseArray2D",t),(0,n.assertIndex)("calc.common.StrictSparseArray2D",r,e+1),(0,n.assertIndex)("calc.common.StrictSparseArray2D",i,t+1);const s=o.length;s<r&&(0,n.assertFalse)(`calc.common.StrictSparseArray2D: expected elements.length >= ${r}; given ${s}`);for(let e=0;e<s;e+=1){const t=o[e].length;t<i&&(0,n.assertFalse)(`calc.common.StrictSparseArray2D: expected elements[${e}].length >= ${i}; given ${t}`)}this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=i,this.denseElements=o,this.sparseElement=a}}t.StrictSparseArray2D=a;class s{get(e,t){return(0,n.assertIndex)("calc.common.NonstrictArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.NonstrictArray2D.get",t,this.cols),this.func(e,t)}strict(){const e=u(this.rows,this.cols,this.func);return new o(this.rows,this.cols,e)}map(e){return new s(this.rows,this.cols,((t,r)=>e(this.func(t,r))))}constructor(e,t,r){(0,n.assertNatural)("calc.common.NonstrictArray2D",e),(0,n.assertNatural)("calc.common.NonstrictArray2D",t),this.rows=e,this.cols=t,this.func=r}}t.NonstrictArray2D=s;class l{get(e,t){return(0,n.assertIndex)("calc.common.NonstrictSparseArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseFunc(e,t):this.sparseFunc()}getSparse(){return this.sparseFunc()}strict(){const e=u(this.denseRows,this.denseCols,this.denseFunc),t=this.sparseFunc();return new a(this.rows,this.cols,this.denseRows,this.denseCols,e,t)}map(e){return new l(this.rows,this.cols,this.denseRows,this.denseCols,((t,r)=>e(this.denseFunc(t,r))),(()=>e(this.sparseFunc())))}constructor(e,t,r,i,o,a){(0,n.assertNatural)("calc.common.NonstrictSparseArray2D",e),(0,n.assertNatural)("calc.common.NonstrictSparseArray2D",t),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D",r,e+1),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D",i,t+1),this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=i,this.denseFunc=o,this.sparseFunc=a}}function u(e,t,r){const n=[];for(let i=0;i<e;i+=1){const e=[];for(let n=0;n<t;n+=1)e[n]=r(i,n);n[i]=e}return n}function c(e,t,r){const n=[],i=[];for(let e=0;e<t;e+=1)i[e]=r;for(let t=0;t<e;t+=1)n[t]=i;return n}function d(e,t,r){return new s(e,t,((e,t)=>r))}t.NonstrictSparseArray2D=l,t.array2DForall=function(e,t){for(let r=0;r<t.rows;r+=1)for(let n=0;n<t.cols;n+=1)if(!e(t.get(r,n)))return!1;return!0},t.array2DForall2=function(e,t,r){const n=(0,i.fastMin)(t.rows,r.rows),o=(0,i.fastMin)(t.cols,r.cols);for(let i=0;i<n;i+=1)for(let n=0;n<o;n+=1)if(!e(t.get(i,n),r.get(i,n)))return!1;return!0},t.jaggedArray=u,t.array2DToJaggedArray=function(e){return u(e.rows,e.cols,e.get.bind(e))},t.constantArray=c,t.constantArray2D=d,t.singletonArray2D=function(e){return d(1,1,e)},t.rowArray2D=function(e){return new s(1,e.length,((t,r)=>e[r]))},t.colArray2D=function(e){return new s(e.length,1,((t,r)=>e[t]))},t.transposeArray2D=function(e){return new s(e.cols,e.rows,((t,r)=>e.get(r,t)))},t.transposeSparseArray2D=function(e){return new l(e.cols,e.rows,e.denseCols,e.denseRows,((t,r)=>e.get(r,t)),(()=>e.getSparse()))},t.sparseArray2DTo1D=function(e,t){const r=e.getSparse.bind(e);return(0,n.assertTrue)("calc.common.sparseArray2DTo1D",t?0===e.cols||e.rows>0:0===e.rows||e.cols>0),t?{length:e.cols,denseLength:e.denseCols,get:t=>e.get(0,t),getSparse:r}:{length:e.rows,denseLength:e.denseRows,get:t=>e.get(t,0),getSparse:r}},t.broadcastArray=function(e,t,r,n,i,o){if(e===r&&t===n)return i;if(1===e&&1===t)return c(r,n,void 0===i[0]?o:i[0][0]);const a=[];let s;s=1===e?(e,r)=>r<t?i[0][r]:o:1===t?(t,r)=>t<e?i[t][0]:o:(r,n)=>r<e&&n<t?i[r][n]:o;for(let e=0;e<r;e+=1){a.push([]);for(let t=0;t<n;t+=1)a[e][t]=s(e,t)}return a},t.broadcastArray2D=function(e,t,r,n){return r.rows===e&&r.cols===t?r:1===r.rows&&1===r.cols?d(e,t,r.get(0,0)):1===r.rows?new s(e,t,((e,t)=>t<r.cols?r.get(0,t):n)):1===r.cols?new s(e,t,((e,t)=>e<r.rows?r.get(e,0):n)):new s(e,t,((e,t)=>e<r.rows&&t<r.cols?r.get(e,t):n))}},12484:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertIndex=t.assertPositiveInteger=t.assertNatural=t.assertInteger=t.assertTrue=t.assertFalse=t.assertNever=t.ulsLogger=void 0;const n=r(43512),i=r(35097),o=r(4133);function a(e,t){return function(r,n,i,o){if(e(r,n,i,o),!i)throw new Error(`${t} ${r} ${n} ${o}`)}}function s(e){return{shipAssertTag:a(e.shipAssertTag.bind(e),"shipAssertTag"),assertTag:a(e.assertTag.bind(e),"assertTag"),traceTag:e.traceTag.bind(e),debugTraceTag:e.debugTraceTag.bind(e),dnmTraceTag:e.dnmTraceTag.bind(e)}}function l(e){return(...t)=>{try{return e(...t)}catch(e){}}}class u{createBufferingCallback(e){return(...t)=>{this.callBuffer.length<this.callBufferCapacity&&this.callBuffer.push({method:e,args:t})}}invokeBufferedCalls(){if(0===this.callBuffer.length)return;const e=this.callBuffer;this.callBuffer=[];const r=`calc.common.DefaultLogger.invokeBufferedCalls: ${e.length} calls before initLogger`;t.ulsLogger.ULS.traceTag(579736781,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,r);for(const r of e)t.ulsLogger.noThrowLogger[r.method](...r.args)}constructor(){this.callBufferCapacity=100,this.callBuffer=[],this.shipAssertTag=this.createBufferingCallback("shipAssertTag"),this.assertTag=this.createBufferingCallback("assertTag"),this.traceTag=this.createBufferingCallback("traceTag"),this.dnmTraceTag=this.createBufferingCallback("dnmTraceTag"),this.debugTraceTag=this.createBufferingCallback("debugTraceTag")}}function c(e){return t.ulsLogger.ULS.assertTag(595980873,n.LogCategory.msoulscat_ES_EWAJS,!1,e)}t.ulsLogger=new class{setLogger(e){const t=this.logger;this.logger=e,this.ULS=s(e),this.noThrowLogger=function(e){return{shipAssertTag:l(e.shipAssertTag.bind(e)),assertTag:l(e.assertTag.bind(e)),traceTag:l(e.traceTag.bind(e)),debugTraceTag:l(e.debugTraceTag.bind(e)),dnmTraceTag:l(e.dnmTraceTag.bind(e))}}(e),t instanceof u&&t.invokeBufferedCalls()}constructor(){this.logger=new u,this.ULS=s(this.logger),this.noThrowLogger=this.logger}},t.assertNever=function(e,r){const i=`${e}: code should be unreachable because a value has type 'never'; given ${(0,o.anonymize)(r)}`;return t.ulsLogger.ULS.assertTag(595980872,n.LogCategory.msoulscat_ES_EWAJS,!1,i)},t.assertFalse=c,t.assertTrue=function(e,t){t||c(`${e}: expected condition to be true`)},t.assertInteger=function(e,t){(0,i.isInteger)(t)||c(`${e}: expected integer; given ${(0,o.anonymize)(t)}`)},t.assertNatural=function(e,t){(!(0,i.isInteger)(t)||t<0)&&c(`${e}: expected natural number; given ${(0,o.anonymize)(t)}`)},t.assertPositiveInteger=function(e,t){(!(0,i.isInteger)(t)||t<=0)&&c(`${e}: expected positive integer; given ${(0,o.anonymize)(t)}`)},t.assertIndex=function(e,t,r){(!(0,i.isInteger)(t)||t<0||t>=r)&&c(`${e}: expected natural number less than ${(0,o.anonymize)(r)}; given ${(0,o.anonymize)(t)}`)},t.assertPositiveLength=function(e,t,r){(!(0,i.isInteger)(t)||t<=0||t>r)&&c(`${e}: expected positive integer at most ${(0,o.anonymize)(r)}; given ${(0,o.anonymize)(t)}`)}},96849:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9307:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asyncLoop=t.asyncLoopFactory=t.delayPromiseImpl=void 0;const n=r(64678),i=r(50136),o=r(94639);function a(e){return t=>new Promise((r=>e.setTimeout(r,t,void 0)))}function s(e){return(t,r)=>{var o,a,s;const l=null!==(o=null==r?void 0:r.timeThreshold)&&void 0!==o?o:10,u=null!==(a=null==r?void 0:r.costThreshold)&&void 0!==a?a:1,c=null!==(s=null==r?void 0:r.macrotaskDelay)&&void 0!==s?s:0,d={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},[m,[g,p]]=(0,i.newPromise)();let h=!0,f=e(c),S=(0,n.now)();return function r(){if(!h||!function(){try{let e=0;for(;e<u;){d.iterations+=1;const r=t();if(void 0===r)return!1;e+=r}return!0}catch(e){return p(e),!1}}())return g();const i=(0,n.now)();i-S<l?(Promise.resolve().then(r),d.microtaskContinues+=1):(f.then((()=>{f=e(c),S=(0,n.now)(),d.macrotaskTotalDelay+=S-i,r()})),d.macrotaskContinues+=1)}(),{promise:m,stop:function(){h=!1},stats:d}}}t.delayPromiseImpl=a,t.asyncLoopFactory=s,t.asyncLoop=s(a(o.defaultSetTimeoutInterface))},43691:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.capitalize=void 0,t.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)}},50444:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointTilde=t.codePointRightCurlyBracket=t.codePointPipe=t.codePointLeftCurlyBracket=t.codePointBacktick=t.codePointUnderscore=t.codePointCircumflexAccent=t.codePointRightSquareBracket=t.codePointBackslash=t.codePointLeftSquareBracket=t.codePointAtSign=t.codePointQuestionMark=t.codePointGreaterThanSign=t.codePointEqualsSign=t.codePointLessThanSign=t.codePointSemicolon=t.codePointColon=t.codePointDigitNine=t.codePointDigitEight=t.codePointDigitSeven=t.codePointDigitSix=t.codePointDigitFive=t.codePointDigitFour=t.codePointDigitThree=t.codePointDigitTwo=t.codePointDigitOne=t.codePointDigitZero=t.codePointSlash=t.codePointFullStop=t.codePointMinusSign=t.codePointComma=t.codePointPlusSign=t.codePointAsterisk=t.codePointRightParen=t.codePointLeftParen=t.codePointSingleQuote=t.codePointAmpersand=t.codePointPercentSign=t.codePointDollarSign=t.codePointHash=t.codePointDoubleQuote=t.codePointExclamationMark=t.codePointSpace=t.codePointCR=t.codePointLF=t.codePointTab=void 0,t.codePointThaiDigitNine=t.codePointThaiDigitZero=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=void 0,t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointRightSingleQuotationMark=t.codePointLeftSingleQuotationMark=t.codePointEuroSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitNine=t.codePointFullwidthDigitZero=void 0,t.codePointTab=9,t.codePointLF=10,t.codePointCR=13,t.codePointSpace=32,t.codePointExclamationMark=33,t.codePointDoubleQuote=34,t.codePointHash=35,t.codePointDollarSign=36,t.codePointPercentSign=37,t.codePointAmpersand=38,t.codePointSingleQuote=39,t.codePointLeftParen=40,t.codePointRightParen=41,t.codePointAsterisk=42,t.codePointPlusSign=43,t.codePointComma=44,t.codePointMinusSign=45,t.codePointFullStop=46,t.codePointSlash=47,t.codePointDigitZero=48,t.codePointDigitOne=49,t.codePointDigitTwo=50,t.codePointDigitThree=51,t.codePointDigitFour=52,t.codePointDigitFive=53,t.codePointDigitSix=54,t.codePointDigitSeven=55,t.codePointDigitEight=56,t.codePointDigitNine=57,t.codePointColon=58,t.codePointSemicolon=59,t.codePointLessThanSign=60,t.codePointEqualsSign=61,t.codePointGreaterThanSign=62,t.codePointQuestionMark=63,t.codePointAtSign=64,t.codePointLeftSquareBracket=91,t.codePointBackslash=92,t.codePointRightSquareBracket=93,t.codePointCircumflexAccent=94,t.codePointUnderscore=95,t.codePointBacktick=96,t.codePointLeftCurlyBracket=123,t.codePointPipe=124,t.codePointRightCurlyBracket=125,t.codePointTilde=126,t.codePointCapitalA=65,t.codePointCapitalB=66,t.codePointCapitalC=67,t.codePointCapitalD=68,t.codePointCapitalE=69,t.codePointCapitalF=70,t.codePointCapitalG=71,t.codePointCapitalH=72,t.codePointCapitalI=73,t.codePointCapitalJ=74,t.codePointCapitalK=75,t.codePointCapitalL=76,t.codePointCapitalM=77,t.codePointCapitalN=78,t.codePointCapitalO=79,t.codePointCapitalP=80,t.codePointCapitalQ=81,t.codePointCapitalR=82,t.codePointCapitalS=83,t.codePointCapitalT=84,t.codePointCapitalU=85,t.codePointCapitalV=86,t.codePointCapitalW=87,t.codePointCapitalX=88,t.codePointCapitalY=89,t.codePointCapitalZ=90,t.codePointSmallA=97,t.codePointSmallB=98,t.codePointSmallC=99,t.codePointSmallD=100,t.codePointSmallE=101,t.codePointSmallF=102,t.codePointSmallG=103,t.codePointSmallH=104,t.codePointSmallI=105,t.codePointSmallJ=106,t.codePointSmallK=107,t.codePointSmallL=108,t.codePointSmallM=109,t.codePointSmallN=110,t.codePointSmallO=111,t.codePointSmallP=112,t.codePointSmallQ=113,t.codePointSmallR=114,t.codePointSmallS=115,t.codePointSmallT=116,t.codePointSmallU=117,t.codePointSmallV=118,t.codePointSmallW=119,t.codePointSmallX=120,t.codePointSmallY=121,t.codePointSmallZ=122,t.codePointThaiDigitZero=3664,t.codePointThaiDigitNine=3673,t.codePointFullwidthDigitZero=65296,t.codePointFullwidthDigitNine=65305,t.codePointFullwidthLatinCapitalA=65313,t.codePointFullwidthLatinCapitalZ=65338,t.codePointFullwidthLatinSmallA=65345,t.codePointFullwidthLatinSmallZ=65370,t.codePointEuroSign=8364,t.codePointLeftSingleQuotationMark=8216,t.codePointRightSingleQuotationMark=8217,t.codePointInvertedExclamationMark=161,t.codePointInvertedQuestionMark=191},19749:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combinations=void 0,t.combinations=function e(...t){if(0===t.length)return[[]];const[r,...n]=t,i=e(...n),o=[];for(const e of r)for(const t of i)o.push([e,...t]);return o}},43619:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initCalcThread=t.initCalcInThread=t.initCalc=t.getCalcAbsUrlOrThrow=t.getCalcAbsUrl=t.isCalcInit=t.maxRetriesForLoadingScript=t.initCalcCalled=void 0;const n=r(19181),i=r(43512),o=n.__importStar(r(66932)),a=r(12484),s=r(45986),l=r(17697),u=r(35097),c=r(50136),d=r(15138);t.initCalcCalled=new c.ResolvablePromise,t.maxRetriesForLoadingScript=9;const m=/^(https)|(http)|(file):\/\//;let g,p=!1;function h(){if(null==g)throw new Error("initCalc was not passed calcAbsUrl");return g}function f(e,r,n,c){if(p){const e="calc.config.initCalc: Calc is already initialized";return void a.ulsLogger.ULS.traceTag(595910878,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,e)}if(a.ulsLogger.setLogger(e),(0,s.initStopwatch)(e),(0,l.initFeatureConfiguration)(r),null!=n&&!m.test(n)){const e=`calc.config.initCalc: calcAbsUrl is not absolute: ${n}`;a.ulsLogger.ULS.traceTag(595910879,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,e)}o.setConfig(null!=c?c:{importScriptsMaxRetries:t.maxRetriesForLoadingScript,onWorkerError(e){const t={error:(0,u.messageFromError)(e),innerError:e.info.error?(0,u.messageFromError)(e.info.error):void 0},r=`calc.onWorkerError: ${JSON.stringify(t)}`;a.ulsLogger.ULS.traceTag(593335298,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r)},onCreateWorker(e){const t=`calc.onCreateWorker: ${JSON.stringify(e)}`;a.ulsLogger.ULS.traceTag(593335299,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,t)}}),g=n,p=!0;const h=`calc.config.initCalc: package version ${d.packageVersion} (production) initialized`;a.ulsLogger.ULS.traceTag(594642132,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,h),t.initCalcCalled.resolve(void 0)}t.isCalcInit=function(){return p},t.getCalcAbsUrl=function(){return g},t.getCalcAbsUrlOrThrow=h,t.initCalc=function(e,t,r){f(e,t,r,void 0)},t.initCalcInThread=function(e,t,r,i){return n.__awaiter(this,void 0,void 0,(function*(){f(function(e){const t=e=>`[${(new Date).toISOString()}] ${e}`;return{shipAssertTag(r,n,i,o){e.shipAssertTag(r,n,i,t(o))},assertTag(r,n,i,o){e.assertTag(r,n,i,t(o))},traceTag(r,n,i,o){e.traceTag(r,n,i,t(o))},debugTraceTag(r,n,i,o){e.debugTraceTag(r,n,i,t(o))},dnmTraceTag(r,n,i,o){e.dnmTraceTag(r,n,i,t(o))}}}((yield o.Endpoint.createOutside(e)).post),(e=>!0===t[e]),r,i)}))},t.initCalcThread=function(e){return n.__awaiter(this,void 0,void 0,(function*(){const t=h(),r=new MessageChannel,n={port:r.port1,options:{id:"WorkerThreadLogger"}},i={port:r.port2,options:{id:"WorkerThreadLogger"}};try{const[r]=yield Promise.all([o.Endpoint.createInside(n,(()=>a.ulsLogger.noThrowLogger)),e.call.initCalcThreadInside.transfer([i.port],i,(0,l.getFeatures)(),t)]);return r}catch(e){throw n.port.close(),e}}))}},64678:function(e,t){"use strict";function r(){const e=Object.create(null);return e.___=void 0,delete e.___,e}function n(e){return Object.keys(e).map((e=>Number(e))).filter((e=>!isNaN(e)))}function i(e,t){for(const r of t)e.push(r);return e}function o(e){return null!=e}Object.defineProperty(t,"__esModule",{value:!0}),t.mapFromArrayOfPairs=t.singleton=t.now=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0,t.makeNewtypeIso=function(e,t){return{wrap:e,unwrap:t}},t.staticAssertExtends=function(){},t.staticAssertSame=function(){},t.staticAssertIs=function(){return e=>e},t.staticAssertIsOptional=e=>e,t.identity=function(e){return e},t.makeStringMap=r,t.cloneStringMap=function(e){const t=r();for(const r in e)t[r]=e[r];return t},t.numEnumArray=n,t.numEnumMap=function(e,t){const r={};for(const i of n(e))r[i]=t(i);return r},t.strEnumArray=function(e){return Object.keys(e).map((e=>e)).map((t=>e[t])).sort()},t.safePush=i,t.safeConcat=function(e,t){const r=[];i(r,e);for(const e of t)i(r,e);return r},t.isDefined=o,t.isNone=function(e){return null==e},t.filterOutNones=function(e){return e.filter(o)},t.pair=function(e,t){return[e,t]},t.fastMin=function(e,t){return e<t?e:t},t.fastMax=function(e,t){return e<t?t:e},t.fastAbs=function(e){return e<0?-e:e},t.makeStringCompareCI=function(e){const t={sensitivity:"accent"};try{const r=new Intl.Collator(function(e){const t=[e],r=e.indexOf("-");return r>0&&t.push(e.substring(0,r)),"en"!==t[t.length-1]&&t.push("en"),t}(e),t);return r.compare.bind(r)}catch(e){return function(e,t){return e===t?0:e.toLocaleUpperCase().localeCompare(t.toLocaleUpperCase())}}},t.typedInstanceCreator=function(){return e=>e},t.now="undefined"!=typeof self&&null!=self.performance&&null!=self.performance.now?()=>self.performance.now():"undefined"!=typeof process&&null!=process.hrtime?()=>{const[e,t]=process.hrtime();return 1e3*e+t/1e6}:()=>Date.now(),t.singleton=function(e){class t{static instance(){return void 0===t.value&&(t.value=e()),t.value}instance(){return t.instance()}}return t.value=void 0,t},t.mapFromArrayOfPairs=function(e){return e.reduce(((e,[t,r])=>(e[t]=r,e)),{})}},82974:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enumerateKeysInOrder=t.enumerateInOrder=t.RootPointer=t.ArrayMapTree=t.floorToPowerOf2=void 0;const n=r(84751);function i(e){if(0===e)return 0;let t=e;return t=(t|t>>>1)>>>0,t=(t|t>>>2)>>>0,t=(t|t>>>4)>>>0,t=(t|t>>>8)>>>0,t=(t|t>>>16)>>>0,t+=1,t/2}t.floorToPowerOf2=i;class o{static create(e){return new o(e,[],[])}setValue(e,t){return this.setValues([[e,t]])}remove(e){return void 0===this.getKeyIndex(e)?this:this.filter((t=>t!==e))}getOrSetValue(e,t){const r=this.getKeyIndex(e);if(void 0===r){const r=t();return[this.setValue(e,r),r]}return[this,this.values[r]]}filter(e){const t=[];for(let r=0;r<this.keys.length;r+=1){const n=this.keys[r],i=this.values[r];e(n,i)&&t.push([n,i])}return t.length===this.getCount()?this:this.ofSequence(t)}getCount(){return this.keys.length}getValue(e){const t=this.getKeyIndex(e);if(void 0!==t)return this.values[t]}getEntry(e){const t=this.getKeyIndex(e);if(void 0!==t)return(0,n.entry)(this.keys[t],this.values[t])}contains(e){return void 0!==this.getKeyIndex(e)}forEach(e){for(let t=0;t<this.keys.length;t+=1)if(!e(this.keys[t],this.values[t]))return!1;return!0}setValues(e){const t=this.keys.map(((e,t)=>[e,this.values[t],t])),r=t.length;e.forEach((([e,n],i)=>t.push([e,n,i+r]))),t.sort((([e,,t],[r,,n])=>{const i=this.keyCompare(e,r);return 0!==i?i:t-n}));const n=[];let i;for(let e=0;e<t.length;e+=1){const[r,o]=t[e];void 0===i||0!==this.keyCompare(r,i)?(n.push([r,o]),i=r):n[n.length-1]=[r,o]}return this.ofSequence(n)}getKeyIndex(e){let r=t.RootPointer;for(;r>=0&&r<this.keys.length;){const t=this.keyCompare(e,this.keys[r]);if(0===t)return r;t<0?r=u(r):t>0&&(r=c(r))}}ofSequence(e){const r=e.slice();r.sort((([e],[t])=>this.keyCompare(e,t)));const n=new Array(r.length),i=new Array(r.length),a=function(e){const r=new Array(e);return l(t.RootPointer,r,0,e),r}(r.length);for(let e=0;e<r.length;e+=1){const[t,o]=r[a[e]];n[e]=t,i[e]=o}return new o(this.keyCompare,n,i)}constructor(e,t,r){this.keyCompare=e,this.keys=t,this.values=r}}function a(e,t){const r=[];return s(e,t,r),r}function s(e,t,r){t<0||t>=e.keys.length||(s(e,u(t),r),r.push([e.keys[t],e.values[t]]),s(e,c(t),r))}function l(e,t,r,n){if(e>=t.length)return;const o=function(e){const t=i(e);return t/2-1<=e-t?t-1:e-t/2}(n);t[e]=r+o,l(u(e),t,r,o),l(c(e),t,r+o+1,n-o-1)}function u(e){return 2*e+1}function c(e){return 2*e+2}t.ArrayMapTree=o,t.RootPointer=0,t.enumerateInOrder=a,t.enumerateKeysInOrder=function(e,t){return a(e,t).map((([e])=>e))}},85408:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BinaryHeap=void 0,t.BinaryHeap=class{insert(e){this.items.push(e);let t=this.getCount()-1;for(;t>0;){const r=t-1>>>1,n=this.items[r];if(!(this.cmp(n,e)>0))break;this.items[t]=n,t=r}this.items[t]=e}peek(){return this.items[0]}removeMin(){const e=this.peek(),t=this.items.pop(),r=this.getCount()-1;if(r<0||void 0===t)return e;let n=0;for(this.items[0]=t;n<r;){let e=n;const i=1+(n<<1),o=2+(n<<1);if(i<=r&&this.cmp(this.items[i],t)<0&&(e=i),o<=r&&this.cmp(this.items[o],e===i?this.items[e]:t)<0&&(e=o),n===e)break;this.items[n]=this.items[e],n=e}return this.items[n]=t,e}getCount(){return this.items.length}clear(){this.items.length=0}forEach(e){for(const t of this.items)if(!e(t))return}constructor(e){this.items=[],this.cmp=e}}},45588:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachKeyUntyped=t.forEachKey=t.getNodeCount=t.complement=t.symmetricDiff=t.lazy=t.empty=t.dense=t.compareUntyped=t.combineCmp=t.compare=t.exceptUntyped=t.except=t.meetsUntyped=t.meets=t.intersectUntyped=t.intersect=t.unionUntyped=t.union=t.fromUntyped=t.createFromKey=t.cacheKeySplitting=t.SetKind=void 0;const n=r(19181).__assign;var i;function o(e,t,r=10){return n=>{if(void 0!==n.split)return n.split;const i=e(n),o=n===t?0:n.depth;return void 0!==o&&o<r&&(n.split=i,i[0][0].depth=o+1,i[1][0].depth=o+1),i}}function a(e,r){return r===t.empty?t.empty:r===t.dense?t.dense:{setOperations:e,root:r}}function s(e,r){return r===t.empty?e:r===t.dense||e===t.empty?r:e===t.dense?e:a(e.setOperations,l(e.setOperations,e.setOperations.top,e.root,r.root))}function l(e,r,n,i){if(i===t.empty)return n;if(i===t.dense)return i;if(n===t.empty)return i;if(n===t.dense)return n;if(n.isExact&&i.isExact){const o=function(e,r,n,i){const{key:o}=n,{key:a}=i,s=e.compare(o,a);if(void 0!==s)return s<0?i:n;const l=e.union(o,a);if(void 0!==l){const n=e.compare(l,r);return void 0!==n&&0===n?t.dense:v(e,r,l,!0)}}(e,r,n,i);if(void 0!==o)return o}const o=y(e,r,n),a=y(e,r,i),[[s],[u]]=e.split(r);return h(e,s,u,l(e,s,o.left,a.left),l(e,u,o.right,a.right))}function u(e,r,n,i){if(n===t.empty)return n;if(i===t.empty)return i;if(n===t.dense)return i;if(i===t.dense)return n;if(n.isExact&&i.isExact){const o=function(e,r,n,i){const{key:o}=n,{key:a}=i;if(!e.meets(o,a))return t.empty;const s=e.compare(o,a);if(void 0!==s)return s<0?n:i;const l=e.intersect(o,a);return void 0!==l?v(e,r,l,!0):void 0}(e,r,n,i);if(void 0!==o)return o}const o=y(e,r,n),a=y(e,r,i),[[s],[l]]=e.split(r);return h(e,s,l,u(e,s,o.left,a.left),u(e,l,o.right,a.right))}function c(e,r,n,i){if(n===t.empty||i===t.empty)return!1;if(n===t.dense||i===t.dense)return!0;if(n.isExact&&i.isExact)return e.meets(n.key,i.key);const o=y(e,r,n),a=y(e,r,i),[[s],[l]]=e.split(r);return c(e,s,o.left,a.left)||c(e,l,o.right,a.right)}function d(e,r){return e===t.empty||r===t.empty?e:r===t.dense?t.empty:e===t.dense?a(r.setOperations,m(r.setOperations,r.setOperations.top,e,r.root)):a(e.setOperations,m(e.setOperations,e.setOperations.top,e.root,r.root))}function m(e,r,n,i){if(n===t.empty)return n;if(i===t.empty)return n;if(i===t.dense)return t.empty;if(n===t.dense){const n=y(e,r,i),[[o],[a]]=e.split(r);return h(e,o,a,m(e,o,t.dense,n.left),m(e,a,t.dense,n.right))}if(n.isExact&&i.isExact){const t=function(e,t,r,n){const{key:i}=r,{key:o}=n;if(!e.meets(i,o))return r;const a=e.except(i,o);return void 0!==a?v(e,t,a,!0):void 0}(e,r,n,i);if(void 0!==t)return t}const o=y(e,r,n),a=y(e,r,i),[[s],[l]]=e.split(r);return h(e,s,l,m(e,s,o.left,a.left),m(e,l,o.right,a.right))}function g(e,t){if(void 0!==e&&void 0!==t)return 0===e?t:0===t||e===t?e:void 0}function p(e,r,n,i){if(n===i)return 0;if(n===t.empty)return-1;if(i===t.empty)return 1;if(n===t.dense)return i===t.dense?0:1;if(i===t.dense)return-1;if(n.isExact&&i.isExact)return function(e,t,r){return e.compare(t.key,r.key)}(e,n,i);const o=y(e,r,n),a=y(e,r,i),[[s],[l]]=e.split(r),u=p(e,s,o.left,a.left);if(void 0===u)return;const c=p(e,l,o.right,a.right);return void 0!==c?g(u,c):void 0}function h(e,r,n,i,o){return i===t.empty?o===t.empty?t.empty:o===t.dense?f(i,o,void 0,!1,e.infimum(n,n),e.supremum(n,n)):f(i,o,void 0,!1,o.infimum,o.supremum):o===t.empty?i===t.dense?f(i,o,void 0,!1,e.infimum(r,r),e.supremum(r,r)):f(i,o,void 0,!1,i.infimum,i.supremum):i===t.dense?o===t.dense?t.dense:f(i,o,void 0,!1,e.combineInfima(e.infimum(r,r),o.infimum),e.combineSuprema(e.supremum(r,r),o.supremum)):o===t.dense?f(i,o,void 0,!1,e.combineInfima(i.infimum,e.infimum(n,n)),e.combineSuprema(i.supremum,e.supremum(n,n))):f(i,o,void 0,!1,e.combineInfima(i.infimum,o.infimum),e.combineSuprema(i.supremum,o.supremum))}function f(e,t,r,n,i,o){return{key:r,left:e,right:t,isExact:n,infimum:i,supremum:o}}function S(e,r,n){if(!e.meets(r,n))return t.empty;const i=e.compare(r,n);if(void 0!==i)return i<=0?t.dense:v(e,r,n,!0);const o=e.intersect(r,n);return void 0!==o?v(e,r,o,!0):v(e,r,n,!1)}function v(e,t,r,n){return f(void 0,void 0,r,!!n,e.infimum(r,t),e.supremum(r,t))}function y(e,r,i){if(void 0!==i.left)return i;const[[o],[a]]=e.split(r),s=h(e,o,a,S(e,o,i.key),S(e,a,i.key));if(s===t.empty||s===t.dense)throw new Error("incorrect set operations implementation");const l=s;return n(i,{left:l.left,right:l.right})}function F(e){return void 0===e||e===t.empty||e===t.dense?0:F(e.left)+F(e.right)+1}function C(e,r,n){return function r(i,o){if(o===t.empty)return!0;if(o===t.dense)return n(i);if(o.isExact)return n(o.key);const a=y(e,i,o),[[s],[l]]=e.split(i);return r(s,a.left)&&r(l,a.right)}(e.top,r)}!function(e){e[e.Dense=0]="Dense",e[e.Empty=1]="Empty"}(i||(t.SetKind=i={})),t.cacheKeySplitting=o,t.createFromKey=function(e){const t=Object.assign(Object.assign({},e),{split:o(e.split,e.top)});return e=>a(t,S(t,t.top,e))},t.fromUntyped=a,t.union=s,t.unionUntyped=l,t.intersect=function(e,r){return e===t.empty?e:r===t.empty||e===t.dense?r:r===t.dense?e:a(e.setOperations,u(e.setOperations,e.setOperations.top,e.root,r.root))},t.intersectUntyped=u,t.meets=function(e,r){return e!==t.empty&&r!==t.empty&&(e===t.dense||r===t.dense||c(e.setOperations,e.setOperations.top,e.root,r.root))},t.meetsUntyped=c,t.except=d,t.exceptUntyped=m,t.compare=function(e,r){return e===r?0:e===t.empty?-1:r===t.empty?1:e===t.dense?r===t.dense?0:1:r===t.dense?-1:p(e.setOperations,e.setOperations.top,e.root,r.root)},t.combineCmp=g,t.compareUntyped=p,t.dense=i.Dense,t.empty=i.Empty,t.lazy=S,t.symmetricDiff=function(e,t){return s(d(e,t),d(t,e))},t.complement=function(e){return d(t.dense,e)},t.getNodeCount=function(e){return e===t.empty||e===t.dense?0:F(e.root)},t.forEachKey=function(e,r){return e===t.empty||C(e.setOperations,e.root,r)},t.forEachKeyUntyped=C},11623:function(e,t){"use strict";function r(e,t){return e&t-1}Object.defineProperty(t,"__esModule",{value:!0}),t.Deque=void 0,t.Deque=class{getCount(){return this.count}maybeResize(){const e=this.values.length;if(this.count>=e){this.values.length=e<<1;for(let t=0;t<this.front;t+=1)this.values[e+t]=this.values[t],this.values[t]=void 0;return}const t=e>>4;if(t>=1&&this.count<t){for(let n=0;n<this.count;n+=1)this.values[r(this.front+n,t)]=this.values[r(this.front+n,e)];this.values.length=t,this.front=r(this.front,t)}}pushBack(e){this.maybeResize(),this.values[r(this.front+this.count,this.values.length)]=e,this.count+=1}pushFront(e){this.maybeResize();const t=r(this.front-1,this.values.length);this.values[t]=e,this.front=t,this.count+=1}peekBack(){return this.values[r(this.front+this.count-1,this.values.length)]}peekFront(){return this.values[this.front]}peekPos(e){if(!(e<0||e>=this.count))return this.values[r(this.front+e,this.values.length)]}popBack(){const e=r(this.front+this.count-1,this.values.length),t=this.values[e];return void 0!==t&&(this.values[e]=void 0,this.count-=1),t}popFront(){const e=this.values[this.front];return void 0!==e&&(this.values[this.front]=void 0,this.front=r(this.front+1,this.values.length),this.count-=1),e}forEach(e){const t=this.values.length;for(let n=0;n<this.count;n+=1)if(!e(this.values[r(this.front+n,t)]))return!1;return!0}constructor(){this.front=0,this.count=0,this.values=[void 0]}}},36319:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeNumberDict=t.makeStringDict=t.makeDictionary=void 0;const n=r(84751),i=r(64678);function o(e){function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}return{entries:(0,i.makeStringMap)(),keyToString:e,getCount(){return Object.keys(this.entries).length},getValue(e){const r=this.keyToString(e),n=t(this.entries,r)?this.entries[r]:void 0;return(0,i.isDefined)(n)?n.value:void 0},getEntry(e){const t=this.getValue(e);return void 0===t?void 0:(0,n.entry)(e,t)},setValue(e,r){const o=this.keyToString(e),a=t(this.entries,o)?this.entries[o]:void 0;(0,i.isDefined)(a)?a.value=r:this.entries[o]=(0,n.entry)(e,r)},contains(e){const r=this.keyToString(e),n=t(this.entries,r)?this.entries[r]:void 0;return(0,i.isDefined)(n)},remove(e){const r=this.keyToString(e);return!!t(this.entries,r)&&(delete this.entries[r],!0)},getOrSetValue(e,r){const o=this.keyToString(e),a=t(this.entries,o)?this.entries[o]:void 0;if((0,i.isDefined)(a))return a.value;const s=r();return delete this.entries[o],this.entries[o]=(0,n.entry)(e,s),s},forEach(e){for(const r in this.entries){const n=t(this.entries,r)?this.entries[r]:void 0;if((0,i.isDefined)(n)&&!e(n.key,n.value))return!1}return!0},filter(e){const t=[];this.forEach(((r,n)=>(e(r,n)||t.push(r),!0)));for(const e of t)this.remove(e)}}}t.makeDictionary=o,t.makeStringDict=function(){return o(i.identity)},t.makeNumberDict=function(){return o((e=>String(e)))}},28099:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHashSet=void 0;const n=r(64678),i=r(5074);t.makeHashSet=function(e,t){return{map:{},keyToHash:e,keyEquals:t,nelements:0,add(e){const t=this.keyToHash(e);if((0,n.isNone)(this.map[t]))this.map[t]=[e],this.nelements+=1;else{const r=this.map[t];for(let t=0;t<r.length;t+=1)if(this.keyEquals(e,r[t]))return;(0,i.logCollisionKey)(e),r.push(e),this.nelements+=1}},contains(e){const t=this.keyToHash(e),r=this.map[t];if((0,n.isNone)(r))return!1;for(let t=0;t<r.length;t+=1)if(this.keyEquals(e,r[t]))return!0;return(0,i.logCollisionKey)(e),!1},forEach(e){Object.keys(this.map).forEach((t=>{this.map[Number(t)].forEach((t=>{e(t)}))}))},size(){return this.nelements},remove(e){const t=this.keyToHash(e),r=this.map[t];if((0,n.isNone)(r))return!1;const o=[];let a=!1;return r.forEach((t=>{this.keyEquals(e,t)?(this.nelements-=1,a=!0):o.push(t)})),this.map[t]=o,a||(0,i.logCollisionKey)(e),a}}}},84319:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHashTable=void 0;const n=r(84751),i=r(5074),o=r(64678);t.makeHashTable=function(e,t){return{map:{},nentries:0,keyToHash:e,keyEquals:t,getCount(){return this.nentries},getValue(e){const t=this.getEntry(e);return void 0===t?void 0:t.value},getEntry(e){const t=this.keyToHash(e),r=this.map[t];if(!(0,o.isNone)(r)){for(let t=0;t<r.length;t+=1){const n=r[t];if(this.keyEquals(e,n.key))return n}(0,i.logCollisionKey)(e)}},contains(e){return void 0!==this.getValue(e)},setValue(e,t){const r=this.keyToHash(e),o=this.map[r];if(null==o)this.map[r]=[(0,n.entry)(e,t)],this.nentries+=1;else{for(let r=0;r<o.length;r+=1){const n=o[r];if(this.keyEquals(n.key,e))return void(n.value=t)}o.push((0,n.entry)(e,t)),this.nentries+=1,(0,i.logCollisionKey)(e)}},remove(e){const t=this.keyToHash(e),r=this.map[t];if((0,o.isNone)(r))return!1;const n=[];let a=!1;for(let t=0;t<r.length;t+=1){const i=r[t];this.keyEquals(e,i.key)?(this.nentries-=1,a=!0):n.push(i)}return this.map[t]=n,a||(0,i.logCollisionKey)(e),a},getOrSetValue(e,t){const r=this.keyToHash(e),a=this.map[r];if((0,o.isNone)(a)){const i=t();return this.map[r]=[(0,n.entry)(e,i)],this.nentries+=1,i}for(let t=0;t<a.length;t+=1){const r=a[t];if(this.keyEquals(e,r.key))return r.value}const s=t();return a.push((0,n.entry)(e,s)),this.nentries+=1,(0,i.logCollisionKey)(e),s},forEach(e){return Object.keys(this.map).every((t=>this.map[Number(t)].every((t=>e(t.key,t.value)))))},filter(e){const t=[];this.forEach(((r,n)=>(e(r,n)||t.push(r),!0)));for(const e of t)this.remove(e)}}}},43545:function(e,t){"use strict";function r(e,t,r,n,i){let o=t,a=t+r-1;for(;o<=a;){const t=o+(a-o>>>1),r=i(e[t],n);if(0===r)return t;r<0?o=t+1:a=t-1}return~o}Object.defineProperty(t,"__esModule",{value:!0}),t.binarySearch=t.exponentialBuckets=t.linearBuckets=t.Histogram=void 0,t.Histogram=class{addSample(e){let t=this.findBucket(e);t<0&&(t=~t),this.sampleCounts[t]+=1}reset(){const e={buckets:this.buckets,sampleCounts:this.sampleCounts};return this.sampleCounts=this.createSampleCounts(),e}constructor(e){this.buckets=e,this.createSampleCounts=()=>new Array(this.buckets.length+1).fill(0),this.sampleCounts=this.createSampleCounts(),this.findBucket=(()=>{const e=(e,t)=>e-t,t=this.buckets.length;return n=>r(this.buckets,0,t,n,e)})()}},t.linearBuckets=function(e,t,r){const n=(t-e)/(r-1),i=[];for(let t=e,o=0;o<r;t+=n,o+=1)i.push(t);return i},t.exponentialBuckets=function(e,t,r){const n=Math.log(e),i=(Math.log(t)-n)/(r-1),o=[];for(let e=0,t=0;t<r;e+=i,t+=1)o.push(Math.exp(n+e));return o},t.binarySearch=r},69414:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ivlCompare=t.ivlExcept=t.ivlMeetsOrTouches=t.ivlMeets=t.ivlDistance=t.ivlMeet=t.ivlJoin=void 0;const n=r(64678);t.ivlJoin=function(e,t){const[r,i]=e,[o,a]=t;return[(0,n.fastMin)(r,o),(0,n.fastMax)(i,a)]},t.ivlMeet=function(e,t){const[r,i]=e,[o,a]=t;return[(0,n.fastMax)(r,o),(0,n.fastMin)(i,a)]},t.ivlDistance=function(e,t){const[r,i]=e,[o,a]=t;return.5*(0,n.fastAbs)(r+i-(o+a))},t.ivlMeets=function(e,t){const[r,i]=e,[o,a]=t;return(0,n.fastMax)(r,o)<(0,n.fastMin)(i,a)},t.ivlMeetsOrTouches=function(e,t){const[r,i]=e,[o,a]=t;return(0,n.fastMax)(r,o)<=(0,n.fastMin)(i,a)},t.ivlExcept=function(e,t){const[r,n]=e,[i,o]=t;return r<i&&o>=n?[r,i]:r>=i&&o<n?[o,n]:void 0},t.ivlCompare=function(e,t){const[r,n]=e,[i,o]=t;return r===i&&n===o?0:r>=i&&n<=o?-1:r<=i&&n>=o?1:void 0}},48296:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PriorityQueue=void 0;const n=r(85408);t.PriorityQueue=class{peek(){const e=this.heap.peek();if(void 0!==e)return e[0]}enqueue(e){this.max+=1,this.heap.insert([e,this.max])}push(e){this.min-=1,this.heap.insert([e,this.min])}pop(){const e=this.heap.removeMin();return void 0===e?(this.min=0,void(this.max=0)):e[0]}getCount(){return this.heap.getCount()}clear(){this.heap.clear()}constructor(e){this.min=0,this.max=0,this.heap=new n.BinaryHeap((([t,r],[n,i])=>{const o=e(t,n);return 0!==o?o:r-i}))}}},43658:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.productSetSerializer=t.ProductSetSerializer=t.getSubspaceCount=t.forEachProduct=t.getSubspaces=t.symmetricDiffProduct=t.complementProduct=t.meetsProduct=t.compareProduct=t.exceptProduct=t.intersectProduct=t.unionProduct=t.project=t.createFromProduct=void 0;const n=r(19181),i=r(45588),o=([e],[t])=>{return(r=String(e))<(n=String(t))?-1:r>n?1:0;var r,n},a={},s=e=>{const t=[];for(const r of Object.keys(e)){const n=r;t.push([n,e[n].id])}const r=function(e){let t="";for(const r of e)t+=String(r[0]),t+="\0",t+=String(r[1]),t+="\0";return t}(t.sort(o));let n=a[r];return void 0===n&&(n={box:{},probabilities:{},depth:1},a[r]=n),n};function l(e){return Object.getOwnPropertyNames(e).length>0}function u(e){return l(e)?{isSubspace:!0,bounds:e}:i.dense}function c(e){return e.isSubspace?1:e.subspaceCount}const d=(e,t,r)=>({isSubspace:!1,left:e,right:t,bounds:r,subspaceCount:c(e)+c(t)});function m(e,t){if(t===i.dense)return t;if(t.isSubspace){let r=!1;for(const n of Object.keys(t.bounds))if(Object.prototype.hasOwnProperty.call(e,n)){r=!0;break}if(!r)return i.dense}return{productOperations:e,root:t}}function g(e){return void 0===e?i.dense:e}const p={unzip(e){const t={},r={};for(const n of Object.keys(e)){const o=n;if(Object.prototype.hasOwnProperty.call(e,o)){const n=e[o];if(n===i.empty)return i.empty;if(n===i.dense)continue;t[o]=n.setOperations,r[o]=n.root}}return m(t,u(r))},combineProduct(e,t,r,n){const o={};for(const a of Object.keys(e)){const s=a;if(Object.prototype.hasOwnProperty.call(e,s)){const a=n(e[s],e[s].top,g(t[s]),g(r[s]));if(a===i.empty)return i.empty;if(a===i.dense)continue;o[s]=a}}return o},restrict(e,...t){const r={};for(const n of t)if(Object.prototype.hasOwnProperty.call(e,n)){const t=e[n];r[n]=t}return r},fromUntypedProduct(e,t,r){const n={};for(const o of r){const r=t[o];n[o]=(0,i.fromUntyped)(e[o],void 0!==r?r:i.dense)}return n},denseProduct(e){const t={};for(const r of e)t[r]=i.dense;return t}};function h(e,t,r){const n=p.combineProduct(e,t,r,i.unionUntyped);if(n===i.empty)throw new Error("broken invariant: the union of two non-empty products cannot be empty");return n}function f(e,t,r){let n=0;for(const o of Object.keys(e)){const a=o;if(Object.prototype.hasOwnProperty.call(e,a)){const o=g(t[a]),s=g(r[a]),l=e[a];if(n=(0,i.combineCmp)(n,(0,i.compareUntyped)(l,l.top,o,s)),void 0===n)return}}return n}t.createFromProduct=p.unzip.bind(p);const S=(()=>{const e={};return(t,r,o)=>{if(r===e.left&&o===e.right)return e.res;e.left=r,e.right=o;const a=f(t,r.bounds,o.bounds);if(void 0!==a)return e.res=a<=0?o:r;let s;const l=Object.keys(t);for(const n of l)if(Object.prototype.hasOwnProperty.call(t,n)&&0!==(0,i.compareUntyped)(t[n],t[n].top,g(r.bounds[n]),g(o.bounds[n]))){if(void 0!==s)return e.res=void 0;s=n}if(void 0!==s){const a=(0,i.unionUntyped)(t[s],t[s].top,g(r.bounds[s]),g(o.bounds[s]));if(a===i.empty)return e.res=i.empty;if(a===i.dense){const t=r.bounds,i=s,o=(t[i],n.__rest(t,["symbol"==typeof i?i:i+""]));return e.res=u(o)}const l=Object.assign(Object.assign({},r.bounds),{[s]:a});return e.res=u(l)}return e.res=void 0}})();function v(e,t,r){if(r===i.empty)return t;if(r===i.dense)return r;if(t===i.empty)return r;if(t===i.dense)return t;if(!t.isSubspace||!r.isSubspace)return d(t,r,h(e,t.bounds,r.bounds));const n=S(e,t,r);return void 0!==n?n:d(t,r,h(e,t.bounds,r.bounds))}function y(e,t,r,...n){if(t===i.empty||t===i.dense)return t;if(t.isSubspace)return u(p.restrict(t.bounds,...n));const[o,a]=C(e,r),[s,l]=b(e,t,o,a);return v(e,y(e,s,o,...n),y(e,l,a,...n))}function F(e,...t){if(e===i.dense||e===i.empty)return e;const r=p.restrict(e.productOperations,...t);if(!l(r))return i.dense;const n=y(r,e.root,s(r),...t);return n===i.empty?n:m(r,n)}function C(e,t){if(void 0!==t.children)return t.children;const{box:r,probabilities:n}=t;let o,a,s=0;const l=Object.keys(e);for(const t of l)if(Object.prototype.hasOwnProperty.call(e,t)){const l=n[t],u=e[t];if(void 0===l){o=t,a=u.top;break}if(l>s){const e=g(r[t]);if(e===i.empty)throw new Error("the key split can never return empty");let n=u.top;if(e!==i.dense){if(!e.isExact)throw new Error("the key can always be represented exactly");n=e.key}if(!u.canSplit(n))continue;o=t,s=l,a=n}}if(void 0===o||void 0===a)throw new Error("there has to be at least one dimension");const u=e[o],[[c,d],[m,p]]=u.split(a),h=[{box:Object.assign(Object.assign({},r),{[o]:(0,i.lazy)(u,u.top,c)}),probabilities:Object.assign(Object.assign({},n),{[o]:d}),depth:t.depth+1},{box:Object.assign(Object.assign({},r),{[o]:(0,i.lazy)(u,u.top,m)}),probabilities:Object.assign(Object.assign({},n),{[o]:p}),depth:t.depth+1}];return t.depth<10&&(t.children=h),h}function R(e,t,r,n){if(t===i.empty)return[i.empty,i.empty];if(t===i.dense)return[u(r),u(n)];const o=f(e,t.bounds,r);if(void 0!==o&&o<=0)return[t,i.empty];const a=p.combineProduct(e,t.bounds,r,i.intersectUntyped);if(a===i.empty)return[i.empty,t];const s=p.combineProduct(e,t.bounds,n,i.intersectUntyped);if(t.isSubspace)return[u(a),s===i.empty?i.empty:u(s)];const[l,c]=R(e,t.left,r,n),[d,m]=R(e,t.right,r,n);return[v(e,l,d),v(e,c,m)]}t.project=F;const b=(e,t,{box:r},{box:n})=>R(e,t,r,n);function E(e,t,r,n,o){const[a,s]=C(e,n),[l,u]=b(e,t,a,s),[c,d]=b(e,r,a,s),m=o(e,l,c,a);return m===i.dense?i.dense:v(e,m,o(e,u,d,s))}function T(e,t,r,n){if(r===i.empty)return t;if(t===i.empty)return r;if(t===i.dense)return t;if(r===i.dense)return r;if(t.isSubspace&&r.isSubspace){const n=S(e,t,r);if(void 0!==n)return n}return E(e,t,r,n,T)}function k(e,t){if(t===i.empty)return e;if(t===i.dense)return t;if(e===i.empty)return t;if(e===i.dense)return e;const r=Object.assign(Object.assign({},e.productOperations),t.productOperations),n=T(r,e.root,t.root,s(r));return n===i.empty?n:m(r,n)}function P(e,t,r,n){if(t===i.empty||r===i.empty)return i.empty;if(t===i.dense)return r;if(r===i.dense)return t;if(t.isSubspace&&r.isSubspace){const n=p.combineProduct(e,t.bounds,r.bounds,i.intersectUntyped);return n===i.empty?i.empty:u(n)}return E(e,t,r,n,P)}function N(e,t,r,o){if(t===i.empty)return t;if(r===i.dense)return i.empty;if(r===i.empty)return t;if(t===i.dense)return E(e,t,r,o,N);if(t.isSubspace&&r.isSubspace){const o=function(e,t,r){const o=f(e,t.bounds,r.bounds);if(0===o||-1===o)return i.empty;let a;const s=Object.keys(e);for(const n of s)if(Object.prototype.hasOwnProperty.call(e,n)){const o=(0,i.compareUntyped)(e[n],e[n].top,g(t.bounds[n]),g(r.bounds[n]));if(void 0===o||o>0){if(void 0!==a)return;a=n}}if(void 0!==a){const o=(0,i.exceptUntyped)(e[a],e[a].top,g(t.bounds[a]),g(r.bounds[a]));if(o===i.empty)return i.empty;if(o===i.dense){const e=t.bounds,r=a;return e[r],u(n.__rest(e,["symbol"==typeof r?r:r+""]))}return u(Object.assign(Object.assign({},t.bounds),{[a]:o}))}}(e,t,r);if(void 0!==o)return o}return E(e,t,r,o,N)}function A(e,t){if(e===i.empty)return e;if(t===i.empty)return e;if(t===i.dense)return i.empty;if(e===i.dense){const e=N(t.productOperations,i.dense,t.root,s(t.productOperations));return e===i.empty?e:m(t.productOperations,e)}const r=Object.assign(Object.assign({},e.productOperations),t.productOperations),n=N(r,e.root,t.root,s(r));return n===i.empty?n:m(r,n)}function I(e,t,r,n){if(t===r)return 0;if(t===i.empty)return-1;if(r===i.empty)return 1;if(t===i.dense)return r===i.dense?0:1;if(r===i.dense)return-1;if(t.isSubspace&&r.isSubspace)return f(e,t.bounds,r.bounds);const[o,a]=C(e,n),[s,l]=b(e,t,o,a),[u,c]=b(e,r,o,a),d=I(e,s,u,o);return void 0!==d?(0,i.combineCmp)(d,I(e,l,c,a)):void 0}function O(e,t,r,n){if(t===i.empty||r===i.empty)return!1;if(t===i.dense||r===i.dense)return!0;if(!function(e,t,r){for(const n of Object.keys(e)){const o=n;if(Object.prototype.hasOwnProperty.call(e,o)){const n=g(t[o]),a=g(r[o]),s=e[o];if(!(0,i.meetsUntyped)(s,s.top,n,a))return!1}}return!0}(e,t.bounds,r.bounds))return!1;if(t.isSubspace&&r.isSubspace)return!0;const[o,a]=C(e,n),[s,l]=b(e,t,o,a),[u,c]=b(e,r,o,a);return O(e,s,u,o)||O(e,l,c,a)}t.unionProduct=k,t.intersectProduct=function(e,t){if(e===i.empty)return e;if(t===i.empty)return t;if(e===i.dense)return t;if(t===i.dense)return e;const r=Object.assign(Object.assign({},e.productOperations),t.productOperations),n=P(r,e.root,t.root,s(r));return n===i.empty?n:m(r,n)},t.exceptProduct=A,t.compareProduct=function(e,t){if(e===t)return 0;if(e===i.empty)return-1;if(t===i.empty)return 1;if(e===i.dense)return t===i.dense?0:1;if(t===i.dense)return-1;const r=Object.assign(Object.assign({},e.productOperations),t.productOperations);return I(r,e.root,t.root,s(r))},t.meetsProduct=function(e,t){if(e===i.empty||t===i.empty)return!1;if(e===i.dense||t===i.dense)return!0;const r=Object.assign(Object.assign({},e.productOperations),t.productOperations);return O(r,e.root,t.root,s(r))},t.complementProduct=e=>A(i.dense,e),t.symmetricDiffProduct=(e,t)=>k(A(e,t),A(t,e)),t.getSubspaces=function(e){if(e===i.empty||e===i.dense)return[];const t=[];return function e(r){r.isSubspace?t.push(r.bounds):(e(r.left),e(r.right))}(e.root),t},t.forEachProduct=function(e,t,...r){const n=F(e,...r);if(n===i.empty)return!0;if(n===i.dense)return t(p.denseProduct(r));const{productOperations:o,root:a}=n;return function e(n){return n.isSubspace?t(p.fromUntypedProduct(o,n.bounds,r)):e(n.left)&&e(n.right)}(a)},t.getSubspaceCount=function(e){return e===i.empty||e===i.dense?0:c(e.root)};class _{putBack(e){this.cursor-=1,this.buffer[this.cursor]=e}pick(){return this.buffer[this.cursor]}get length(){return this.buffer.length-this.cursor}get empty(){return 0===this.length}pop(){const e=this.pick();return this.cursor+=1,e}constructor(e=[]){this.buffer=e,this.cursor=0}}class M{constructor(){this.size=0,this.clear=()=>{},this.get=()=>{},this.set=()=>this}}function D(e,t){return function(r,n,...i){const o=t.get(r);void 0===o?(e(r,n,...i),t.set(r,t.size)):n.push("__cached__",o)}}function w(e,t){return function(r,...n){if("__cached__"===r.pick()){r.pop();const e=r.pop();return t[e]}const i=e(r,...n);return t.push(i),i}}class L{getDims(e){return Object.keys(e)}serialize(e){this.cached.clear();const t=[];t.push(e.length);for(const r of e)this.serializeProductSetCached(r,t);return JSON.stringify(t)}deserialize(e){this.cache.length=0;const t=new _(JSON.parse(e)),r=t.pop(),n=[];for(let e=0;e<r;e+=1){const e=this.deserializeProductSetCached(t);n.push(e)}return n}static normalizeKey(e){if(Array.isArray(e))return[...e];if("object"==typeof e){const t=Object.assign({},e);return delete t.depth,delete t.split,t}return e}constructor(e){var t,r,n,o;this.globalProductOperations=e,this.cached="undefined"!=typeof Map?new Map:new M,this.cache=[],this.serializers={},this.serializeProductSet=(e,t)=>{if(e===i.empty||e===i.dense)return void t.push(e);const r=e,n=this.getDims(r.productOperations);t.push(n),this.serializeUntypedSparseProductCached(r.root,t,n)},this.deserializeProductSet=e=>{const t=e.pop();if(t===i.empty||t===i.dense)return t;e.putBack(t);const r={},n=e.pop();for(const e of n){const t=this.globalProductOperations[e];r[e]=t}return{productOperations:r,root:this.deserializeUntypedSparseProductCached(e,n)}},this.serializeUntypedSparse=(e,t,r)=>{t.push(null==e?void 0:e.isExact),t.push(this.serializers[r].serializeBound(null==e?void 0:e.infimum)),t.push(this.serializers[r].serializeBound(null==e?void 0:e.supremum));const n=L.normalizeKey(null==e?void 0:e.key);t.push(this.serializers[r].serializeKey(n));for(const n of[null==e?void 0:e.left,null==e?void 0:e.right])null==n||n===i.empty||n===i.dense?t.push(n):(t.push("us"),this.serializeUntypedSparseCached(n,t,r))},this.deserializeUntypedSparse=(e,t)=>{const r=e.pop(),n=this.serializers[t].deserializeBound(e.pop()),i=this.serializers[t].deserializeBound(e.pop()),o=this.serializers[t].deserializeKey(e.pop()),[a,s]=["left","right"].map((r=>{const n=e.pop();return"us"===n?this.deserializeUntypedSparseCached(e,t):n}));return{infimum:n,supremum:i,isExact:r,key:o,left:a,right:s}},this.serializeUntypedSparseProduct=(e,t,r)=>{t.push(e.isSubspace);for(const n of r){const r=e.bounds[n];this.serializeUntypedSparseCached(r,t,n)}e.isSubspace||(this.serializeUntypedSparseProductCached(e.left,t,r),this.serializeUntypedSparseProductCached(e.right,t,r),t.push(e.subspaceCount))},this.deserializeUntypedSparseProduct=(e,t)=>{const r=e.pop(),n={};for(const r of t){const t=this.deserializeUntypedSparseCached(e,r);n[r]=t}return r?{isSubspace:r,bounds:n}:{isSubspace:r,bounds:n,left:this.deserializeUntypedSparseProductCached(e,t),right:this.deserializeUntypedSparseProductCached(e,t),subspaceCount:e.pop()}},this.serializeUntypedSparseCached=D(this.serializeUntypedSparse,this.cached),this.deserializeUntypedSparseCached=w(this.deserializeUntypedSparse,this.cache),this.serializeProductSetCached=D(this.serializeProductSet,this.cached),this.deserializeProductSetCached=w(this.deserializeProductSet,this.cache),this.serializeUntypedSparseProductCached=D(this.serializeUntypedSparseProduct,this.cached),this.deserializeUntypedSparseProductCached=w(this.deserializeUntypedSparseProduct,this.cache);for(const i in e){const a={serializeKey:null!==(t=e[i].serializeKey)&&void 0!==t?t:e=>JSON.stringify(e),deserializeKey:null!==(r=e[i].deserializeKey)&&void 0!==r?r:e=>JSON.parse(e),serializeBound:null!==(n=e[i].serializeBound)&&void 0!==n?n:e=>JSON.stringify(e),deserializeBound:null!==(o=e[i].deserializeBound)&&void 0!==o?o:e=>JSON.parse(e)};this.serializers[i]=a}}}t.ProductSetSerializer=L,t.productSetSerializer=function(e){return new L(e)}},72561:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RTree=t.RTKind=t.copyExcept=void 0;const n=r(64678),i=r(84751);function o(e,t,r){if(void 0!==r){const n=e.slice();return n[t]=r,n}const n=e.slice(0,-1);return t<e.length-1&&(n[t]=e[e.length-1]),n}var a,s;function l(e,t,r){return{kind:e,key:t,value:r}}function u(e,t){return l(a.Ptr,e,t)}function c(e,t){return l(a.Leaf,e,t)}function d(e,t){return l(a.Branch,e,t)}t.copyExcept=o,function(e){e[e.Ptr=1]="Ptr",e[e.Leaf=2]="Leaf",e[e.Branch=3]="Branch"}(a||(t.RTKind=a={})),function(e){e[e.NotFound=1]="NotFound",e[e.Removed=2]="Removed",e[e.Delete=3]="Delete"}(s||(s={}));class m{static create(e,t,r,n,i=2){const o=i>1?Math.ceil(i):1;return new m({keyJoin:e,keyMeets:t,keyCompare:r,keyDistance:n,minChildren:o,maxChildren:2*o,keyGe:function(e,t){const n=r(e,t);return void 0!==n&&n>=0},keyLe:function(e,t){const n=r(e,t);return void 0!==n&&n<=0}},void 0,0)}getCount(){return this.count}get bounds(){var e;return null===(e=this.root)||void 0===e?void 0:e.key}getValue(e){if(void 0!==this.root)return function t(r,n){const i=r.keyCompare(n.key,e);if(n.kind===a.Ptr)return 0===i?n.value:void 0;if(!(void 0===i||i<0))for(const e of n.value){const n=t(r,e);if(void 0!==n)return n}}(this.lattice,this.root)}getEntry(e){const t=this.getValue(e);return void 0===t?void 0:(0,i.entry)(e,t)}setValue(e,t,r=(e=>!0)){const n=S(this.lattice,this.root,e,r,t);return void 0!==n?n===this.root?this:new m(this.lattice,n,this.count):new m(this.lattice,f(this.lattice,this.root,u(e,t)),this.count+1)}filter(e){let t=new m(this.lattice,void 0,0);return this.forEach(((r,n)=>(e(r,n)&&(t=t.setValue(r,n)),!0))),t}contains(e,t=(e=>!0)){return void 0!==S(this.lattice,this.root,e,t)}getOrSetValue(e,t){const r=this.getValue(e);if(void 0===r){const r=t();return[this.setValue(e,r),r]}return[this,r]}forEach(e){return g(this.root,e)}forEachGe(e,t){return g(this.root,t,(t=>this.lattice.keyGe(t,e)),(t=>this.lattice.keyGe(t,e)))}forEachLe(e,t){return g(this.root,t,(t=>this.lattice.keyMeets(t,e)),(t=>this.lattice.keyLe(t,e)))}forEachMeets(e,t){return g(this.root,t,(t=>this.lattice.keyMeets(t,e)),(t=>this.lattice.keyMeets(t,e)))}remove(e){if(null==this.root)return this;const t=[],r=this.lattice,i=(l,u)=>{const m=r.keyCompare(l.key,e);if(void 0===m||m<0)return(0,n.pair)(l,s.NotFound);if(l.kind===a.Leaf){const i=l.value;for(let a=0;a<i.length;a+=1)if(0===r.keyCompare(i[a].key,e)){const e=o(i,a);if(e.length<u){const r=c(l.key,e);return t.push(r),(0,n.pair)(r,s.Delete)}return(0,n.pair)(c(p(r,e),e),s.Removed)}}else{const e=l.value;for(let a=0;a<e.length;a+=1){const[c,m]=i(e[a],r.minChildren);if(m===s.Delete){const i=o(e,a);if(i.length>=u)return(0,n.pair)(d(p(r,i),i),s.Removed);const c=d(l.key,i);return t.push(c),(0,n.pair)(c,s.Delete)}if(m===s.Removed)return(0,n.pair)(d(l.key,o(e,a,c)),s.Removed)}}return(0,n.pair)(l,s.NotFound)},l=this.root.kind===a.Leaf?1:2,[h,S]=i(this.root,l);if(h===this.root)return this;let v=S===s.Delete?void 0:h;for(let e=0;e<t.length;e+=1)g(t[e],((e,t)=>(v=f(this.lattice,v,u(e,t)),!0)));return new m(this.lattice,v,this.count-1)}constructor(e,t,r){this.lattice=e,this.root=t,this.count=r}}function g(e,t,r,n){const i=void 0!==r?r:()=>!0,o=void 0!==n?n:()=>!0;if(null==e)return!0;const s=e=>{if(!i(e.key))return!0;if(e.kind===a.Leaf){const r=e.value;for(let e=0;e<r.length;e+=1){const n=r[e];if(o(n.key)&&!t(n.key,n.value))return!1}}else{const t=e.value;for(let e=0;e<t.length;e+=1)if(!s(t[e]))return!1}return!0};return s(e)}function p(e,t){let r=t[0].key;for(let n=1;n<t.length;n+=1)r=e.keyJoin(r,t[n].key);return r}function h(e,t,r){const[i,o]=function(e,t){const[r,i]=function(e,t){let r=0,i=1,o=e.keyDistance(t[0].key,t[1].key);for(let n=2;n<t.length;n+=1)for(let a=0;a<n;a+=1){const s=e.keyDistance(t[a].key,t[n].key);s>o&&(r=a,i=n,o=s)}return(0,n.pair)(r,i)}(e,t),o=t[r].key,a=t[i].key,s=[];for(let r=0;r<t.length;r+=1){const n=t[r];s.push([n,e.keyDistance(o,n.key)-e.keyDistance(a,n.key)])}s.sort(((e,t)=>e[1]-t[1]));let l=e.minChildren;for(;l<t.length-e.minChildren&&s[l][1]<0;l+=1);const u=[],c=[];for(let e=0;e<l;e+=1)u.push(s[e][0]);for(let e=l;e<t.length;e+=1)c.push(s[e][0]);return(0,n.pair)(u,c)}(e,r);return(0,n.pair)(l(t,p(e,i),i),l(t,p(e,o),o))}function f(e,t,r){if(null==t)return c(r.key,[r]);const[i,o]=function t(i){if(i.kind===a.Leaf){const t=[...i.value,r];if(t.length>e.maxChildren){const[r,o]=h(e,i.kind,t);return(0,n.pair)(c(r.key,r.value),o)}return(0,n.pair)(c(e.keyJoin(i.key,r.key),t),void 0)}const o=i.value.slice(),s=function(e,t,r){let n=0,i=e.keyDistance(t[0].key,r),o=t[0].value.length;for(let a=1;a<t.length;a+=1){const s=t[a],l=e.keyDistance(s.key,r);(l<i||l===i&&s.value.length<o)&&(n=a,i=l,o=s.value.length)}return n}(e,o,r.key),[l,u]=t(o[s]);if(o[s]=l,null!=u&&(o.push(u),o.length>e.maxChildren)){const[t,r]=h(e,i.kind,o);return(0,n.pair)(d(t.key,t.value),r)}return(0,n.pair)(d(e.keyJoin(i.key,r.key),o),void 0)}(t);return null!=o?d(e.keyJoin(i.key,o.key),[i,o]):i}function S(e,t,r,n,i){if(void 0!==t)return function t(n){if(n.kind!==a.Leaf)for(let i=0;i<n.value.length;i+=1){const a=n.value[i];if(e.keyMeets(a.key,r)){const e=t(a);if(void 0!==e)return d(n.key,o(n.value,i,e))}}else for(let e=0;e<n.value.length;e+=1){const t=s(n.value[e]);if(void 0!==t)return c(n.key,o(n.value,e,t))}}(t);function s(t){if(0===e.keyCompare(t.key,r))return void 0!==i&&t.value!==i&&n(t.value)?u(t.key,i):t}}t.RTree=m},12013:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;const n=r(30839);class i{static create(e){return new i(n.emptyUntyped,0,e)}getCount(){return this.count}getValue(e){const t=(0,n.findUntyped)(this,e,this.root);return null==t?void 0:t.value}getEntry(e){return(0,n.findUntyped)(this,e,this.root)}contains(e){return void 0!==this.getValue(e)}forEach(e){return(0,n.forEachUntyped)(e,this.root)}setValue(e,t){return new i((0,n.insertUntyped)(this,e,t,this.root),this.contains(e)?this.count:this.count+1,this.keyCompare)}remove(e){return this.contains(e)?new i((0,n.removeUntyped)(this,e,this.root),this.count-1,this.keyCompare):this}getOrSetValue(e,t){const r=this.getValue(e);if(void 0!==r)return[this,r];const o=t();return[new i((0,n.insertUntyped)(this,e,o,this.root),this.count+1,this.keyCompare),o]}filter(e){let t=n.emptyUntyped,r=0;return this.forEach(((i,o)=>(e(i,o)&&(t=(0,n.insertUntyped)(this,i,o,t),r+=1),!1))),new i(t,r,this.keyCompare)}constructor(e,t,r){this.root=e,this.count=t,this.keyCompare=r}}t.RedBlackMapTree=i},30839:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.remove=t.removeUntyped=t.insert=t.insertUntyped=t.forEach=t.forEachUntyped=t.find=t.findUntyped=t.empty=t.emptyUntyped=t.isLeaf=t.fromUntyped=t.Color=void 0;const n=r(12484);var i,o;!function(e){e[e.Red=0]="Red",e[e.Black=1]="Black"}(i||(t.Color=i={})),function(e){e[e.DoubleBlack=2]="DoubleBlack"}(o||(o={}));const a=i.Red,s=i.Black,l=o.DoubleBlack,u={c:s,l:void 0,r:void 0},c={c:l,l:void 0,r:void 0};function d(e,t){return{ops:e,root:t}}function m(e){return void 0===e.l}function g(e){return e.c===a}function p(e){return e.c===s&&void 0!==e.l}function h(e){return e.c===s&&void 0===e.l}function f(e,t,r,n,i){return{c:e,l:t,key:r,value:n,r:i}}function S(e,{l:t,key:r,value:n,r:i}){return f(e,t,r,n,i)}function v(e){return m(e)?u:S(s,e)}function y(e,t,r){if(m(r))return;const n=e.keyCompare(t,r.key);return n<0?y(e,t,r.l):n>0?y(e,t,r.r):r}function F(e,t){return!!m(t)||!!F(e,t.l)&&!!e(t.key,t.value)&&F(e,t.r)}function C(e,t,r,n,i){if(e===s){if(g(t)&&g(t.l))return f(a,S(s,t.l),t.key,t.value,f(s,t.r,r,n,i));if(g(i)&&g(i.r))return f(a,f(s,t,r,n,i.l),i.key,i.value,S(s,i.r));if(g(t)&&g(t.r))return f(a,f(s,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,f(s,t.r.r,r,n,i));if(g(i)&&g(i.l))return f(a,f(s,t,r,n,i.l.l),i.l.key,i.l.value,f(s,i.l.r,i.key,i.value,i.r))}if(e===l){if(g(i)&&g(i.l))return f(s,f(s,t,r,n,i.l.l),i.l.key,i.l.value,f(s,i.l.r,i.key,i.value,i.r));if(g(t)&&g(t.r))return f(s,f(s,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,f(s,t.r.r,r,n,i))}return f(e,t,r,n,i)}function R(e,t,r,i,o){return e===a&&t.c===l&&p(o)?C(s,f(a,v(t),r,i,o.l),o.key,o.value,o.r):e===a&&p(t)&&o.c===l?C(s,t.l,t.key,t.value,f(a,t.r,r,i,v(o))):e===s&&t.c===l&&p(o)?C(l,f(a,v(t),r,i,o.l),o.key,o.value,o.r):e===s&&p(t)&&o.c===l?C(l,t.l,t.key,t.value,f(a,t.r,r,i,v(o))):e===s&&t.c===l&&g(o)&&p(o.l)?f(s,C(s,f(a,v(t),r,i,o.l.l),o.l.key,o.l.value,o.l.r),o.key,o.value,o.r):e===s&&g(t)&&p(t.r)&&o.c===l?f(s,t.l,t.key,t.value,C(s,t.r.l,t.r.key,t.r.value,f(a,t.r.r,r,i,v(o)))):((0,n.assertTrue)("calc.common.rbTree.rotate: expected R|B",t.c!==l&&o.c!==l),f(e,t,r,i,o))}function b(e,t,r,n){if(m(n))return f(a,u,t,r,u);const i=e.keyCompare(t,n.key);return i<0?C(n.c,b(e,t,r,n.l),n.key,n.value,n.r):i>0?C(n.c,n.l,n.key,n.value,b(e,t,r,n.r)):f(n.c,n.l,t,r,n.r)}function E(e,t,r,n){return function(e){return!g(e)||e.l.c!==a&&e.r.c!==a?e:S(s,e)}(b(e,t,r,n))}function T(e,t,r){if(m(r))return r;if(r.c===a&&h(r.l)&&h(r.r))return 0===e.keyCompare(t,r.key)?u:r;if(r.c===s&&h(r.l)&&h(r.r))return 0===e.keyCompare(t,r.key)?c:r;if(r.c===s&&g(r.l)&&h(r.l.l)&&h(r.l.r)&&h(r.r)){const n=e.keyCompare(t,r.key);return n<0?f(s,T(e,t,r.l),r.key,r.value,u):n>0?r:f(s,u,r.l.key,r.l.value,u)}const i=e.keyCompare(t,r.key);if(i<0)return R(r.c,T(e,t,r.l),r.key,r.value,r.r);if(i>0)return R(r.c,r.l,r.key,r.value,T(e,t,r.r));(0,n.assertTrue)("calc.common.rbTree.rem: expected node",!m(r.r));const[o,l,d]=k(r.r);return R(r.c,r.l,o,l,d)}function k(e){if(e.c===a&&h(e.l)&&h(e.r))return[e.key,e.value,u];if(e.c===s&&h(e.l)&&h(e.r))return[e.key,e.value,c];if(e.c===s&&h(e.l)&&g(e.r))return[e.key,e.value,S(s,e.r)];(0,n.assertTrue)("calc.common.rbTree.remMin: expected node",!m(e.l));const[t,r,i]=k(e.l);return[t,r,R(e.c,i,e.key,e.value,e.r)]}function P(e,t,r){const i=T(e,t,function(e){return p(e)&&e.l.c===s&&e.r.c===s?S(a,e):e}(r));return(0,n.assertTrue)("calc.common.rbTree.remove: expected R|B",i.c===a||i.c===s),i}t.fromUntyped=d,t.isLeaf=m,t.emptyUntyped=u,t.empty=function(e){return d(e,t.emptyUntyped)},t.findUntyped=y,t.find=function(e,t){return y(t.ops,e,t.root)},t.forEachUntyped=F,t.forEach=function(e,t){return F(e,t.root)},t.insertUntyped=E,t.insert=function(e,t,r){return d(r.ops,E(r.ops,e,t,r.root))},t.removeUntyped=P,t.remove=function(e,t){return d(t.ops,P(t.ops,e,t.root))}},87919:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RingBuffer=void 0,t.RingBuffer=class{count(){return this.counter}isEmpty(){return 0===this.counter}enqueue(e){this.list[this.writeIndex]=e,0!==this.counter&&this.writeIndex===this.readIndex?this.readIndex=(this.readIndex+1)%this.capacity:this.counter++,this.writeIndex=(this.writeIndex+1)%this.capacity}dequeue(){if(this.isEmpty())return;const e=this.list[this.readIndex];return this.list[this.readIndex]=void 0,this.readIndex=(this.readIndex+1)%this.capacity,this.counter--,e}executeOnEveryElement(e){for(let t=0;t<this.counter;t++){const r=(this.readIndex+t)%this.capacity,n=this.list[r];if(void 0!==n&&!e(n))return!1}return!0}constructor(e=1/0){this.list=e<1/0?new Array(e):new Array,this.counter=0,this.capacity=e,this.readIndex=0,this.writeIndex=0}}},11459:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boundedParetoSetOperations=t.boundedParetoSplitter=t.boundedPareto=void 0;const n=r(64678),i=r(69414);function o(e,t,r){const n=Math.pow(t,e),i=1-Math.pow(t/r,e),o=Math.pow(r,e),a=o*n,s=o-n,l=-1/e;return{cdf:1===e?e=>(1-n/e)/i:t=>(1-n*Math.pow(t,-e))/i,invCdf:1===e?e=>1/((o-e*s)/a):e=>Math.pow((o-e*s)/a,l)}}function a(e,t,r){const i=o(e,t,r);return{canSplit:([e,t])=>t-e>1,split([e,t]){const r=i.cdf(t),o=i.cdf(e+1),a=i.invCdf((r+o)/2),s=(0,n.fastMin)((0,n.fastMax)(Math.round(a),e+1),t-1);return[[[e,s],i.cdf(s)-i.cdf(e+1)],[[s,t],i.cdf(t)-i.cdf(s)]]}}}t.boundedPareto=o,t.boundedParetoSplitter=a,t.boundedParetoSetOperations=function(e,t,r,o,s){const l=a(e,t,r);return{id:s,split:e=>l.split(e),canSplit:e=>l.canSplit(e),meets:i.ivlMeets,intersect:i.ivlMeet,union:(e,t)=>(0,i.ivlMeetsOrTouches)(e,t)?(0,i.ivlJoin)(e,t):void 0,except:i.ivlExcept,compare:i.ivlCompare,top:o,infimum:([e])=>e,supremum:([,e])=>e,combineInfima:(e,t)=>(0,n.fastMin)(e,t),combineSuprema:(e,t)=>(0,n.fastMax)(e,t)}}},84751:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entry=t.makeEmptyTable=void 0;const r={getCount:()=>0,getValue:()=>{},getEntry:()=>{},contains:()=>!1,forEach:()=>!0};t.makeEmptyTable=function(){return r},t.entry=function(e,t){return{key:e,value:t}}},5074:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logCollisionKey=void 0;const n=r(43512),i=r(12484);let o={},a=0;t.logCollisionKey=function(e){!function(e){const t=o[e];o[e]=(void 0===t?0:t)+1,a+=1,a%100==0&&(i.ulsLogger.ULS.traceTag(595858520,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,`calc.common.hashUtils.logCollision: ${JSON.stringify(o)}.`),o={})}(function(e){return"object"==typeof e?null===e?"null":`Object {${Object.keys(e)}}`:typeof e}(e))}},17697:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTypedChangeGateEnabled=t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;const n=r(12484),i=r(43512),o=r(12367);var a;!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcPreventSpillingHack="CalcPreventSpillingHack",e.CalcLegacyImplicitIntersection="CalcLegacyImplicitIntersection",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcNestedRecordFunction="CalcNestedRecordFunction",e.CalcLetRecFunction="CalcLetRecFunction",e.CalcLambdaBasicFunctions="CalcLambdaBasicFunctions",e.CalcLambdaDefaultParameters="CalcLambdaDefaultParameters",e.CalcLambdaCellValues="CalcLambdaCellValues",e.CalcLambdaArrayLifting="CalcLambdaArrayLifting"}(a||(t.FeatureName=a={}));let s=e=>{const t=`calc.common.isFeatureEnabledCallback: called with ${e} before initCalc`;return n.ulsLogger.ULS.traceTag(526989323,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,t),!1};const l={};function u(e){return void 0===l[e]&&(l[e]=s(e)),l[e]}t.initFeatureConfiguration=function(e){"function"==typeof e&&(s=e)},t.isFeatureEnabled=u,t.getFeatures=function(){const e={};for(const t in a){const r=a[t];null!=r&&(e[r]=u(r))}return e},t.getTypedFeatureGate=(0,o.makeGetTypedFeatureGate)({"Microsoft.Office.Excel.ProseFormulaRepairExperimentLogBuggyIsEnabled":!1,"Microsoft.Office.Excel.ProseFormulaRepairExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSDemoFeatureGateString":"DummyStringValue","Microsoft.Office.Excel.CalcTSDemoFeatureGateInt":42,"Microsoft.Office.Excel.CalcTSDemoFeatureGateBoolean":!1,"Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSUnitExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled":!1,"Microsoft.Office.Excel.SmartFormulaBarUseDevScheduler":!1,"Microsoft.Office.Excel.x10DoNotThrowOnDoublePluginRegistration":!0,"Microsoft.Office.Excel.AutocompleteRangeSuggestionPlugin":!1,"Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompleteBinaryModelExperimentPlugin":!1,TESTING_ONLY_RECALC_SERVICE_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_SCHEDULER_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_TEST_PLUGIN_IMPORTSCRIPTS_FAIL:!1,"Microsoft.Office.Excel.FormulaCollection":!1,"Microsoft.Office.Excel.x10ParserPerformanceMeasurements":!1,"Microsoft.Office.Excel.ArgumentAssistanceOnMainThread":!1,"Microsoft.Office.Excel.AutoCompleteOnMainThread":!1,"Microsoft.Office.Excel.UnitlessTimeAndDate":!1,"Microsoft.Office.Excel.UnitExpIgnoreDivMul":!1,"Microsoft.Office.Excel.x10PythonAutocompletionEnabled":!1,"Microsoft.Office.Excel.MockWorkerThreadPlugin":!1,"Microsoft.Office.Excel.EnableFullSessionLogging":!0,"Microsoft.Office.Excel.ChatGPTPluginEnabled":!1,"Microsoft.Office.Excel.FormulaRepairSuggestionsLimit":1,"Microsoft.Office.Excel.ProseExcelRepairEngineV34":!1,"Microsoft.Office.Excel.FormulaByExamplePluginSuggestionShowing":!1,"Microsoft.Office.Excel.SetCellPrefetchPluginEnabled":!1,"Microsoft.Office.Excel.FormulaRemediation":!1,"Microsoft.Office.Excel.PluginResponseWindowDebugTimeExtension":0,"Microsoft.Office.Excel.FormulaByExampleConditionals":!1,"Microsoft.Office.Excel.FormulaByExampleReferenceRowFormula":!1,"Microsoft.Office.Excel.CalcTsDec2023Funcs":!1,"Microsoft.Office.Excel.GotoCtrlClick":!1,"Microsoft.Office.Excel.CalcEtaLambda":!1,"Microsoft.Office.Excel.EtaReducedLambdas":!1,"Microsoft.Office.Excel.DesktopX10VPEnabled":!1});var c=r(12367);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return c.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return c.setFeatureGateDictionaryGetter}}),t.isTypedChangeGateEnabled=(0,o.makeTypedIsChangeGateEnabled)(["OfficeVSO:XXX_TestChangeGate","OfficeVSO:6476056_OnlySendNestedDotNotationPath","OfficeVSO:7396249_getTableHeadersFromServer","OfficeVSO:7903424_Microsoft.Office.Excel.ProvideX10FeaturesFromSchedulerFeatures","OfficeVSO:7920319_fixArgumentAssistanceHandlingWhitespaces","Microsoft.Office.Excel.X10IntelligentPythonWP5","OfficeVSO:8501373_CalcTsFuncsFirstSlice","OfficeVSO_8554430_CalcTsColRowSumProdFuncs","OfficeVSO:8557722_x10GetNumOfComputationsFromFrame","OfficeVSO:8579351_x10ProcessNotificationsAfterShouldRunPlugin","OfficeVSO:8575821_x10MapGetRichValueFieldListContext","OfficeVSO:8620448_x10SchedulerThrowsFailures","OfficeVSO:8786821_x10SendLoggerMessagesToMainThread","OfficeVSO:8846142_x10SendTelemetryWithUTel","Microsoft.Office.Excel.UseObjectInsteadOfMapForFunctionShortDescriptions","Microsoft.Office.Excel.CalcTsLstr","Microsoft.Office.Excel.CalcTsInvalidChartMacro","OfficeVSO:8927842_CalcWP5ES6"])},6724:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findIsomorphicSubtrees=void 0,t.findIsomorphicSubtrees=function(e,t,r=(()=>""),n=(()=>1)){const i=[e],o=new Set(i);for(let e=0;e<i.length;e+=1)for(const r of t(i[e]))o.has(r)||(o.add(r),i.push(r));o.clear(),i.reverse();const a=new Map,s=[],l=new Map,u=[];i.forEach(((e,i)=>{const o=t(e).map((e=>a.get(e)));if(o.some((e=>void 0===e)))throw new Error("Circular references in the tree");const c=o.map((e=>s[e])),d=function(e){let t=l.get(e);return void 0!==t||(t=l.size,l.set(e,t)),t}(c.join("/")+"/"+r(e));if(s.push(d),void 0===u[d]){const t=c.map((e=>u[e])),r=t.map((e=>e.size)).reduce(((e,t)=>e+t),n(e)),i=t.map((e=>e.depth)).reduce(((e,t)=>Math.max(e,t)),0)+1;u[d]={subtrees:[e],size:r,depth:i}}else u[d].subtrees.push(e);a.set(e,i)}));for(const e of u)e.subtrees.reverse();const c=new Array(i.length);for(const e of u)c[c.length-a.get(e.subtrees[0])-1]=e;return c.filter((e=>void 0!==e))}},46337:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fnv1a=void 0,t.fnv1a=function(e){let t=2166136261;const r=e.length;for(let n=0;n<r;n+=1)t^=e.charCodeAt(n),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}},15138:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.packageVersion=void 0,t.packageVersion="7.5.68"},57777:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.revocableSingleton=t.testUtils=t.pledge=t.machine=t.testConfig=t.arrayLogger=t.wrapIntoAsyncModule=t.unicode=t.result=t.mixin=t.promise=t.stopwatch=t.resolvablePromise=t.config=t.codePoint=t.setTimeoutInterfaceModule=t.asyncLoopModule=t.async=t.arrayUtils=t.table=t.split=t.rTree=t.ringBuffer=t.rbTree=t.rbMapTree=t.productSet=t.priorityQueue=t.interval=t.histogram=t.hashTable=t.hashSet=t.dictionary=t.deque=t.bspSet=t.binaryHeap=t.arrayMapTree=t.testUtil=t.core=t.featureConfiguration=t.assertions=t.util=t.anonymizer=t.combinations=t.findIsomorphicSubtrees=t.JSF32=t.fnv1a=t.PackageName=void 0;const n=r(19181);t.PackageName="excel-online-calc-common";var i=r(46337);Object.defineProperty(t,"fnv1a",{enumerable:!0,get:function(){return i.fnv1a}});var o=r(57855);Object.defineProperty(t,"JSF32",{enumerable:!0,get:function(){return o.JSF32}});var a=r(6724);Object.defineProperty(t,"findIsomorphicSubtrees",{enumerable:!0,get:function(){return a.findIsomorphicSubtrees}});var s=r(19749);Object.defineProperty(t,"combinations",{enumerable:!0,get:function(){return s.combinations}}),n.__exportStar(r(43691),t);const l=n.__importStar(r(4133));t.anonymizer=l;const u=n.__importStar(r(35097));t.util=u;const c=n.__importStar(r(12484));t.assertions=c;const d=n.__importStar(r(17697));t.featureConfiguration=d;const m=n.__importStar(r(64678));t.core=m;const g=n.__importStar(r(71201));t.testUtil=g;const p=n.__importStar(r(82974));t.arrayMapTree=p;const h=n.__importStar(r(85408));t.binaryHeap=h;const f=n.__importStar(r(45588));t.bspSet=f;const S=n.__importStar(r(11623));t.deque=S;const v=n.__importStar(r(36319));t.dictionary=v;const y=n.__importStar(r(28099));t.hashSet=y;const F=n.__importStar(r(84319));t.hashTable=F;const C=n.__importStar(r(43545));t.histogram=C;const R=n.__importStar(r(69414));t.interval=R;const b=n.__importStar(r(48296));t.priorityQueue=b;const E=n.__importStar(r(43658));t.productSet=E;const T=n.__importStar(r(12013));t.rbMapTree=T;const k=n.__importStar(r(30839));t.rbTree=k;const P=n.__importStar(r(87919));t.ringBuffer=P;const N=n.__importStar(r(72561));t.rTree=N;const A=n.__importStar(r(11459));t.split=A;const I=n.__importStar(r(84751));t.table=I,t.arrayUtils=n.__importStar(r(24939)),t.async=n.__importStar(r(96849)),t.asyncLoopModule=n.__importStar(r(9307)),t.setTimeoutInterfaceModule=n.__importStar(r(94639)),t.codePoint=n.__importStar(r(50444)),t.config=n.__importStar(r(43619)),t.resolvablePromise=n.__importStar(r(50136)),t.stopwatch=n.__importStar(r(45986)),t.promise=n.__importStar(r(50136));var O=r(6416);Object.defineProperty(t,"mixin",{enumerable:!0,get:function(){return O.mixin}}),t.result=n.__importStar(r(7104)),t.unicode=n.__importStar(r(15054)),t.wrapIntoAsyncModule=n.__importStar(r(34099)),t.arrayLogger=n.__importStar(r(75079)),t.testConfig=n.__importStar(r(46238)),t.machine=n.__importStar(r(95763)),t.pledge=n.__importStar(r(66177)),t.testUtils=n.__importStar(r(3635)),t.revocableSingleton=n.__importStar(r(7292))},57855:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSF32=void 0;const r=(e,t)=>(e<<t|e>>>32-t)>>>0;t.JSF32=class{next(){return this.nextU32()*(1/4294967296)}nextU32(){const e=this.x[0]-r(this.x[1],27)>>>0;return this.x[0]=(this.x[1]^r(this.x[2],17))>>>0,this.x[1]=this.x[2]+this.x[3]>>>0,this.x[2]=this.x[3]+e>>>0,this.x[3]=e+this.x[0]>>>0}constructor(e){this.x=new Uint32Array([4058668781,e,e,e]);for(let e=0;e<20;e+=1)this.nextU32()}}},34911:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.mathLog2=void 0,t.mathLog2=null!==(r=Math.log2)&&void 0!==r?r:e=>Math.log(e)*Math.LOG2E},6416:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mixin=void 0,t.mixin=function(e,t,r){return class extends e{constructor(...e){super(...e);const n=t(this);for(const e of r)Object.defineProperty(this,e,{value:n[e].bind(n),enumerable:!1,configurable:!1})}}}},50136:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MaybeThenable=t.collapseThenable=t.bindMaybeThenable=t.isThenable=t.promiseLoop=t.newPromise=t.promiseFinally=t.ResolvablePromiseWithTimeout=t.ResolvablePromiseWithSyncValue=t.ResolvablePromise=void 0;const n=r(64678);class i{then(e,t){return this.promise.then(e,t)}toPromise(){return this.promise}resolve(e){return this._resolve(e),o(e)?this.promise.then():void 0}reject(e){return this._reject(e),o(e)?this.promise.then():void 0}constructor(){this.promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}}function o(e){return(0,n.isDefined)(e)&&"function"==typeof e.then}t.ResolvablePromise=i,t.ResolvablePromiseWithSyncValue=class extends i{getCurrentValue(){return this.value}resolve(e){return o(e)||this.isUninitialized&&(this.value=e,this.isUninitialized=!1),super.resolve(e)}constructor(){super(),this.value=void 0,this.isUninitialized=!0,this.then((e=>this.value=e))}},t.ResolvablePromiseWithTimeout=class extends i{constructor(e,t){super(),t.setTimeout((()=>{const e=new Error("Promise timeout");e.name="TimeoutError",this.reject(e)}),e)}},t.promiseFinally=function(e,t){return e.then((e=>(t(),e)),(e=>(t(),Promise.reject(e))))},t.newPromise=function(){let e;return[new Promise(((t,r)=>e=[t,r])),e]},t.promiseLoop=function(e,t){let r;return new Promise(((n,i)=>{Promise.resolve(t).then((function t(o){if(void 0!==o){r=o;try{Promise.resolve(e(r)).then(t,i)}catch(e){i(e)}}else n(r)}),i)}))},t.isThenable=o,t.bindMaybeThenable=function(e,t,r){return o(e)?e.then(t,r):t(e)},t.collapseThenable=function(e){return e},t.MaybeThenable={all:e=>{const t=new Array(e.length),r=new i;let n=0;return e.forEach(((i,a)=>{o(i)?i.then((i=>{t[a]=i,++n===e.length&&r.resolve(t)}),(e=>{r.reject(e)})):t[a]=i})),r},any:e=>{const t=new i;return e.forEach(((e,r)=>{if(!o(e))return t.resolve({result:e,resolvedIndex:r});e.then((e=>{t.resolve({result:e,resolvedIndex:r})}),(e=>{t.reject(e)}))})),t}}},7104:function(e,t){"use strict";var r,n;function i(e){return{kind:r.Success,value:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.javaScriptError=t.ReasonKind=t.isSuccess=t.failure=t.successUndefined=t.success=t.ResultKind=void 0,function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused",e.Breaked="Breaked"}(r||(t.ResultKind=r={})),t.success=i,t.successUndefined=i(void 0),t.failure=function(e){return{kind:r.Failure,reason:e}},t.isSuccess=function(e){return e.kind===r.Success},function(e){e.JavaScriptError="JavaScriptError"}(n||(t.ReasonKind=n={})),t.javaScriptError=function(e){return{kind:n.JavaScriptError,error:e}}},95763:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VoidMachine=t.AllMachine=t.MachineRuntime=t.MachineCycle=t.nextOnSuccessReceiver=t.callMachineTransition=t.breakTransition=t.nextTransition=t.TransitionKind=void 0;const n=r(7104);var i;function o(e,t,r){return{kind:e,machine:t,receiver:r}}function a(e,t){return o(i.CallMachine,e,t)}!function(e){e[e.Next=1]="Next",e[e.CallMachine=2]="CallMachine",e[e.Break=3]="Break"}(i||(t.TransitionKind=i={})),t.nextTransition=o(i.Next,void 0,void 0),t.breakTransition=o(i.Break,void 0,void 0),t.callMachineTransition=a;const s={receiveResult:e=>(0,n.isSuccess)(e)?t.nextTransition:e};t.nextOnSuccessReceiver=function(){return s};class l extends Error{constructor(e,t){super("Cycle detected: tried to call an already-running Machine"),this.machine=e,this.stackDepth=t;const r=new.target.prototype;Object.getPrototypeOf(this)!==r&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r)}}t.MachineCycle=l;class u{static resetStats(){u.maxStackDepth=0,u.numPauses=0,u.numCycles=0}pushFrame(e){const t=this.stack.length,r=e.machine;if(!0===r.runStatus)throw u.numCycles+=1,new l(r,t);!1===r.runStatus&&(r.runStatus=!0),this.stack.push(e),u.maxStackDepth<t+1&&(u.maxStackDepth=t+1)}advanceTopFrame(){const e=this.stack[this.stack.length-1].machine;return"boolean"!=typeof e.runStatus?e.runStatus:e.next()}step(){this.numSteps+=1;const e=this.transition;try{switch(e.kind){case i.Next:return this.transition=this.advanceTopFrame(),t.nextTransition;case i.CallMachine:return this.pushFrame(e),this.transition=this.advanceTopFrame(),t.nextTransition;case i.Break:return this.transition=t.nextTransition,e;default:const r=this.stack.pop();return r?(r.machine.runStatus=e,this.transition=r.receiver.receiveResult(e),t.nextTransition):e}}catch(e){return this.transition=(0,n.failure)((0,n.javaScriptError)(e)),t.nextTransition}}run(e=(()=>!1)){if(this.result)return this.result;try{for(;;){const t=this.step();if(t.kind===i.Break)return t;if(t.kind!==i.Next)return this.result=t;if(e())return u.numPauses+=1,t}}catch(e){return this.result=(0,n.failure)((0,n.javaScriptError)(e))}}runToResult(){for(;;){const e=this.run();if(e.kind!==i.Break)return e}}constructor(e){this.numSteps=0,this.stack=[];try{this.pushFrame(a(e,{receiveResult:e=>e})),this.transition=t.nextTransition}catch(e){this.transition=(0,n.failure)((0,n.javaScriptError)(e))}}}t.MachineRuntime=u,u.maxStackDepth=0,u.numPauses=0,u.numCycles=0,t.AllMachine=class{next(){return this.values.length<this.machines.length?a(this.machines[this.values.length],this):(0,n.success)(this.values)}receiveResult(e){return(0,n.isSuccess)(e)?(this.values.push(e.value),this.next()):e}constructor(e){this.machines=e,this.runStatus=!1,this.values=[]}},t.VoidMachine=class{next(){return a(this.machine,this)}receiveResult(e){return(0,n.isSuccess)(e)?n.successUndefined:e}constructor(e){this.machine=e,this.runStatus=!1}}},66177:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;const n=r(95763),i=r(7104);class o{setState(e,t,r){return this.onFulfilled=t,this.onRejected=r,this.transition=e,e}next(){return this.transition instanceof o?this.transition=(0,n.callMachineTransition)(this.transition,this):this.transition}receiveResult(e){let t;try{if((0,i.isSuccess)(e)){if(!this.onFulfilled)return this.setState(e,void 0,void 0);t=this.onFulfilled(e.value)}else{if(!this.onRejected)return this.setState(e,void 0,void 0);t=this.onRejected(e.reason)}}catch(e){return this.setState((0,i.failure)((0,i.javaScriptError)(e)),void 0,void 0)}return t instanceof o?(this.setState(t.transition,t.onFulfilled,t.onRejected),t.setState(this,void 0,void 0),this.next()):this.setState((0,i.success)(t),void 0,void 0)}bind(e){return new o(this,e,void 0)}catch(e){return new o(this,void 0,e)}finally(e){return new o(this,(t=>(e(),t)),(t=>(e(),o.reject(t))))}static all(e){return o.fromMachine(new n.AllMachine(e.map(o.resolve)))}settle(){return new n.MachineRuntime(this).runToResult()}static settleOrThrow(e){const t=e.settle();if((0,i.isSuccess)(t))return t.value;throw t.reason.error}constructor(e,t,r){this.transition=e,this.onFulfilled=t,this.onRejected=r,this.runStatus=!(e instanceof o||e.kind===n.TransitionKind.CallMachine)&&e}}t.Pledge=o,o.resolve=e=>e instanceof o?e:new o((0,i.success)(e),void 0,void 0),o.reject=e=>new o((0,i.failure)(e),void 0,void 0),o.undefinedPledge=o.resolve(void 0),o.fromMachine=e=>{if(e instanceof o)return e;const t=new o(o.undefinedPledge,void 0,void 0);return t.transition=(0,n.callMachineTransition)(e,t),t},o.try=e=>o.undefinedPledge.bind(e),o.RepeatMachine=class{next(){const e=this.onLoop(this.accum);return e instanceof o?(0,n.callMachineTransition)(e,this):this.receiveSuccess(e)}receiveResult(e){return(0,i.isSuccess)(e)?this.receiveSuccess(e.value):e}receiveSuccess(e){return void 0===e?(0,i.success)(this.accum):(this.accum=e,n.nextTransition)}constructor(e,t){this.onLoop=e,this.accum=t,this.runStatus=!1}},o.repeat=(e,t)=>o.resolve(t).bind((t=>o.fromMachine(new o.RepeatMachine(e,t))))},3635:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throwAfterSteps=t.pauseAfterSteps=void 0,t.pauseAfterSteps=function(e){const t=Math.max(1,Math.floor(e));let r=0;return function(){return r+=1,r>=t}},t.throwAfterSteps=function(e){const t=Math.max(1,Math.floor(e));let r=0;return function(){if(r+=1,r<t)return!1;throw t}}},94639:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSetTimeoutInterface=t.clearTimerUnified=t.setImmediateUnified=void 0;const n=r(12484);function i(e,...t){return{kind:"Immediate",timer:setImmediate(e,...t)}}function o(e){switch(e.kind){case"Immediate":clearImmediate(e.timer);break;case"Timeout":clearTimeout(e.timer);break;case"Mocking":e.delayedCallback.isValid=!1;break;default:(0,n.assertNever)("unknown timer.kind",e)}}t.setImmediateUnified=i,t.clearTimerUnified=o,t.defaultSetTimeoutInterface={setImmediate:i,setTimeout:function(e,t,...r){return{kind:"Timeout",timer:setTimeout(e,t,...r)}},clearImmediate:o,clearTimeout:o}},45986:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatch=t.ulsStopwatchFactory=void 0;const n=r(43512),i={ULS:new n.NulLogger};t.ulsStopwatchFactory=(0,n.initStopwatchFactory)((e=>i.ULS.traceTag(595948114,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,e))),t.initStopwatch=function(e){i.ULS=e}},75079:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createArrayLogger=void 0,t.createArrayLogger=function(e=!1,t=(()=>!0),r){const n=new Set,i=new Set;return{log:[],addTriggerListener(e){n.add(e)},waitForMessage(e,t){return new Promise((r=>{const n=setTimeout((()=>{console.warn(`ArrayLogger.waitForMessage: timed out waiting for message; timeout = ${t}`),r(!1)}),t);this.addTriggerListener((t=>{const i=e(t);return i&&(clearTimeout(n),r(!0)),i}))}))},waitForReceivedButDelayedMessages(){const e=[];return i.forEach((t=>e.push(t))),Promise.all(e).then((()=>{}))},addLogMessage(o){if(!t(o))return;const a=new Promise((t=>{var i;i=()=>{this.log.push(o),e&&console.log((new Date).toISOString(),...o),n.forEach((e=>{e(o)&&n.delete(e)})),t()},void 0===r?i():setTimeout((()=>i()),r)})).then((()=>{i.delete(a)}));i.add(a)},shipAssertTag(...e){this.addLogMessage(["shipAssertTag",e]);const{2:t,3:r}=e;if(!t)throw new TypeError(`shipAssertTag: ${r}`)},assertTag(...e){this.addLogMessage(["assertTag",e]);const{2:t,3:r}=e;if(!t)throw new TypeError(`assertTag: ${r}`)},traceTag(...e){this.addLogMessage(["traceTag",e])},dnmTraceTag(...e){this.addLogMessage(["dnmTraceTag",e])},debugTraceTag(...e){this.addLogMessage(["debugTraceTag",e])}}}},46238:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.featureEnabledDummyCallback=t.AssertLogger=t.ConsoleLogger=void 0;const n=r(17697);t.ConsoleLogger=class{shipAssertTag(e,t,r,n){if(console.assert(r,`shipAssertTag2 ${e} ${t} ${n}`),!r)throw new Error(`shipAssertTag2 ${e} ${t} ${n}`)}assertTag(e,t,r,n){if(console.assert(r,`assertTag2 ${e} ${t} ${n}`),!r)throw new Error(`assertTag2 ${e} ${t} ${n}`)}traceTag(e,t,r,n){console.log("traceTag2",e,n,t,r)}dnmTraceTag(e,t,r,n){console.log("dnmTraceTag2",e,n,t,r)}debugTraceTag(e,t,r,n){console.log("debugTraceTag2",e,n,t,r)}},t.AssertLogger=class{shipAssertTag(e,t,r,n){if(!r)throw new Error(`shipAssertTag2 ${e} ${t} ${n}`)}assertTag(e,t,r,n){if(!r)throw new Error(`assertTag2 ${e} ${t} ${n}`)}constructor(){this.traceTag=()=>{},this.debugTraceTag=()=>{},this.dnmTraceTag=()=>{}}},t.featureEnabledDummyCallback=function(e){switch(e){case n.FeatureName.FeatureCheckingEnabled:case n.FeatureName.CalcRecordFunctions:case n.FeatureName.CalcNestedRecordFunction:case n.FeatureName.CalcLetRecFunction:case n.FeatureName.CalcLambdaBasicFunctions:case n.FeatureName.CalcLambdaDefaultParameters:case n.FeatureName.CalcLambdaCellValues:case n.FeatureName.CalcLambdaArrayLifting:return!0;default:return e.startsWith("OfficeVSO:")}}},7292:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RevocableSingleton=void 0;class r{revoke(){this.isRevoked=!0}constructor(e,t){this.target=e,this.isRevoked=!1;const r=e=>{if(this.isRevoked)throw new TypeError(`${String(e)}: ${t}`)};this.proxy="undefined"==typeof Proxy?e:new Proxy(e,{get:(e,t,n)=>(r(t),Reflect.get(e,t,n)),set:(e,t,n,i)=>(r(t),Reflect.set(e,t,n,i))})}}t.RevocableSingleton=class{getInstance(){var e;return null===(e=this.instance)||void 0===e?void 0:e.proxy}setInstance(e){var t;return null===(t=this.instance)||void 0===t||t.revoke(),void 0===e?this.instance=void 0:(this.instance=new r(e,this.message),this.instance.proxy)}revokeInstance(){if(this.instance)return this.instance.revoke(),this.instance=new r(this.instance.target,this.message),this.instance.proxy}constructor(e){this.message=e}}},71201:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomElement=t.randomShuffled=t.randomIndex=t.randomFloat=void 0;const n=r(12484),i=r(57855),o=function(e){const t=null!={NODE_ENV:"production"}.BXL_RUN?.4531024141007942:Math.random()*Date.now();return new i.JSF32(t)}();function a(e){return(0,n.assertTrue)("calc.common.randomIndex",e>0),Math.min(e-1,Math.floor(o.next()*e))}t.randomFloat=function(){return o.next()},t.randomIndex=a,t.randomShuffled=function(e){return e.map((e=>[o.next(),e])).sort(((e,t)=>e[0]<t[0]?-1:e[0]===t[0]?0:1)).map((e=>e[1]))},t.randomElement=function(e){return e[a(e.length)]}},15054:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeIsInClass=t.forEachClassInterval=t.codePointIterator=t.numCodeUnits=t.stringCodePointAt=t.countCodePoints=t.scanCodePointsBack=t.scanCodePoints=t.stringFromCodePoint=t.surrogatePairToCodePoint=t.isAnySurrogate=t.isLowSurrogate=t.isHighSurrogate=void 0;const n=r(64678),i=55296,o=56320;function a(e){return(64512&e)===i}function s(e){return(64512&e)===o}function l(e){return 55296==(63488&e)}function u(e,t){if(a(e)&&s(t))return 65536+((1023&e)<<10|1023&t)}function c(e,t){const r=e.charCodeAt(t);if(!l(r))return r;if(t+1>=e.length)return 65533;const n=u(r,e.charCodeAt(t+1));return null!=n?n:65533}function d(e){return e>=65536?2:1}function m(e,t){if(1==(1&e.length))throw new Error("Invalid class length");for(let r=0;r<e.length;r+=2)t(e[r],e[r+1])}t.isHighSurrogate=a,t.isLowSurrogate=s,t.isAnySurrogate=l,t.surrogatePairToCodePoint=u,t.stringFromCodePoint=function(e){if(e<=65535)return String.fromCharCode(e);const t=e-65536;return String.fromCharCode(t>>10|i,1023&t|o)},t.scanCodePoints=function(e,t,r){let n=t;for(let t=0;t<r;t+=1){if(n>=e.length)return;a(e.charCodeAt(n))&&n+1<e.length&&s(e.charCodeAt(n+1))?n+=2:n+=1}return n},t.scanCodePointsBack=function(e,t,r){let n=t;for(let t=0;t<r;t+=1){if(n-1<0)return;s(e.charCodeAt(n-1))&&n-2>=0&&a(e.charCodeAt(n-2))?n-=2:n-=1}return n},t.countCodePoints=function(e,t,r){let n=0;for(let i=t;i<r;n+=1)a(e.charCodeAt(i))&&i+1<r&&s(e.charCodeAt(i+1))?i+=2:i+=1;return n},t.stringCodePointAt=c,t.numCodeUnits=d,t.codePointIterator=function(e,t=0){const r=[];let n=t;for(;n<e.length;){const t=c(e,n);r.push(t),n+=d(t)}return r},t.forEachClassInterval=m;t.makeIsInClass=function(e){const t=function(e){const t=[];for(let e=0;e<512;++e)t.push([]);return m(e,((e,r)=>{const i=r-1>>7;for(let o=e>>7;o<=i;++o){const i=o<<7,a=o+1<<7;t[o].push((0,n.fastMax)(e,i),(0,n.fastMin)(r,a))}})),t}(e);return e=>{if(e<0||e>65535)return!1;const r=t[e>>>7];for(let t=0;t<r.length;t+=2){const n=r[t],i=r[t+1];if(e>=n&&e<i)return!0}return!1}}},35097:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.prependErrorMessage=t.messageFromError=t.partialArray=t.arrayFill=t.repeat=t.stringEndsWith=t.stringStartsWith=t.isInteger=t.mathLog2=void 0;const n=r(4133);var i=r(34911);function o(e){try{return e()}catch(e){return!1}}Object.defineProperty(t,"mathLog2",{enumerable:!0,get:function(){return i.mathLog2}}),t.isInteger="function"==typeof Number.isInteger&&o((()=>Number.isInteger(1)&&!Number.isInteger(1.1)))?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,t.stringStartsWith="function"==typeof"".startsWith&&o((()=>"ab".startsWith("a")&&!"ab".startsWith("b")&&"abc".startsWith("b",1)&&!"abc".startsWith("a",1)))?(e,t,r=0)=>e.startsWith(t,r):(e,t,r=0)=>r+t.length<=e.length&&e.substring(r,r+t.length)===t,t.stringEndsWith="function"==typeof"".endsWith&&o((()=>"ab".endsWith("b")&&!"ab".endsWith("a")))?(e,t)=>e.endsWith(t):(e,t)=>t.length<=e.length&&e.substring(e.length-t.length,e.length)===t,t.repeat="function"==typeof"".repeat&&o((()=>"aaa"==="a".repeat(3)))?(e,t)=>e.repeat(t):(e,t)=>Array(t+1).join(e),t.arrayFill=function(e,t){for(let r=0;r<e.length;r+=1)e[r]=t;return e},t.partialArray=function(e){const t=[];return Object.keys(e).map(Number).forEach((r=>t[r]=e[r])),t},t.messageFromError=function(e){if(null==e||"object"!=typeof e)return(0,n.anonymize)(e);const t=e,r=String(t.name),i=String(t.message);if(null!=t.stack){const e=String(t.stack);return e.indexOf(i)>=0&&e.indexOf(r)>=0?e:`${r}: ${i}\n${e}`}return i.indexOf(r)>=0?i:`${r}: ${i}`},t.prependErrorMessage=function(e,t){if(null==e||"object"!=typeof e)return e;const r=e;return r.message=`${t} ${String(r.message)}`,r},t.values=function(e){const t=[];for(const r in e)Object.hasOwnProperty.call(e,r)&&t.push(e[r]);return t}},34099:function(e,t){"use strict";function r(){return e=>function(e){const t=class{constructor(e){this.obj=e}};for(const r of e)t.prototype[r]=function(...e){const t=this.obj[r](...e);return Promise.resolve(t)};return t}(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.wrapIntoAsync=t.wrapIntoAsyncClass=void 0,t.wrapIntoAsyncClass=r,t.wrapIntoAsync=function(e,t){return new(r()(t))(e)}},2485:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustFormulaOrigin=void 0;const n=r(20797),i=r(1194),o=r(9230),a=r(96945),s=r(85199),l=r(93387),u=r(83387),c=r(62376),d=r(28733),m=r(64198);function g(e,t,r,n){if(r.kind===i.PosKind.Abs)return r;const o=(0,s.wrapPosition)(e,r.index,n)-t;return o===r.index?r:(0,i.pos)(i.PosKind.Rel,o)}function p(e,t,r,o){const s=g(t.row,r.row,o.row,n.sheetRows),l=g(t.col,r.col,o.col,n.sheetCols),u=(0,a.canonicaliseBrackets)(e,s)||(0,a.canonicaliseBrackets)(e,l);return(0,i.cellRefSingle)(s,l,u,o.label)}function h(e,t,r,o){switch(o.kind){case i.CellRefKind.Error:case i.CellRefKind.Bad:return o;case i.CellRefKind.Single:return p(e,t,r,o);case i.CellRefKind.Range:{const n=p(e,t,r,o.ref1),a=p(e,t,r,o.ref2);return n===o.ref1&&a===o.ref2?o:(0,i.cellRefRange)(n,a,o.label)}case i.CellRefKind.Row:{const s=g(t.row,r.row,o.row1,n.sheetRows),l=g(t.row,r.row,o.row2,n.sheetRows),u=(0,a.canonicaliseBrackets)(e,s)||(0,a.canonicaliseBrackets)(e,l);return(0,i.cellRefRow)(s,l,u,o.label)}case i.CellRefKind.Col:{const s=g(t.col,r.col,o.col1,n.sheetCols),l=g(t.col,r.col,o.col2,n.sheetCols),u=(0,a.canonicaliseBrackets)(e,s)||(0,a.canonicaliseBrackets)(e,l);return(0,i.cellRefCol)(s,l,u,o.label)}}}const f=(0,o.createFailureErrorClass)("TransformRefsError");class S extends m.IdentityVisitor{nameNode(e,t,r){const n=(0,i.nameNode)(e,t,r),{headResolved:o,fieldsResolved:a}=this.resolver.resolveDottedName(this.locals,n,this.annotations),s=(0,i.flattenNameParts)(e).parts;if((0,d.canDenoteCellRef)(this.locals,t,s)){const[e,n,...d]=s;if(o.kind===c.ResolvedKind.ResolvedCellRef){(0,u.assertTrue)("calc.analyze.adjustFormulaOrigin: all flattened field parts resolved",s.length===1+a.length);const l=this.fn(e.ref);if(l.kind===i.CellRefKind.Single||l.kind===i.CellRefKind.Row||l.kind===i.CellRefKind.Col){const o=(e,t)=>(0,i.fieldRefNamePart)(e,t.rhs,t.canDenoteNamedObject,t.label,t.qualifiedLabel);return(0,i.nameNode)(d.reduce(o,o((0,i.cellRefNamePart)(l,e.asWhole,e.label,e.qualifiedLabel),n)),t,r)}const c=(e,{rhs:t,qualifiedLabel:r})=>(0,i.fieldRefNode)(e,t,r);return d.reduce(c,c((0,i.cellRefNode)(l,o.node.qualifier,o.node.label),n))}if(o.resolution.kind!==l.ResultKind.Success&&o.resolution.reason.kind!==c.ResolveReasonKind.NoOriginSheet&&o.resolution.reason.kind!==c.ResolveReasonKind.InvalidQualifier)throw new f(o.resolution.reason)}return n}cellRefNode(e,t,r){return(0,i.cellRefNode)(this.fn(e),t,r)}constructor(e,t,r,n){super(),this.fn=e,this.locals=r,this.annotations=n,this.resolver=(0,d.createResolver)(t)}}t.adjustFormulaOrigin=function(e,t,r,n){const i=t.originGridCell.value;if((0,o.isGridCellEqual)(i,r))return(0,l.success)(n);try{const o=(0,m.reduceBottomUp)(new S(h.bind(void 0,e.config.refStyle,i,r),e,t,n.annotations),n);return(0,l.success)(Object.assign(Object.assign({},n),{node:o}))}catch(e){if(e instanceof f)return(0,l.failure)(e.reason);throw e}}},2278:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildAnnotations=void 0;const n=r(83387),i=r(58938),o=r(31174),a=r(50175),s=r(1194),l=r(9230),u=r(64198);class c extends u.PledgeReducer{appNode(e,t,r,n){return o.Pledge.try((()=>(e.kind===s.NodeKind.Name&&(this.annotations[e.label]=s.appHeadNameAnnotation),super.appNode(e,t,r,n))))}letNode(e,t,r,i){const s=e.id===a.WorksheetFuncId.LETREC||e.id!==a.WorksheetFuncId.LET&&(0,n.assertFalse)("calc.lang.buildAnnotations"),l=this.bindNames(t),c=l[t.length];return this.lazyVisitAppHeadNode(e).bind((e=>s?o.Pledge.all(t.map((({binder:e})=>o.Pledge.try((()=>(0,u.visitFormulaNode)(c,e.arg)))))):o.Pledge.all(t.map((({binder:e},t)=>{const r=l[t];return o.Pledge.try((()=>(0,u.visitFormulaNode)(r,e.arg)))}))))).bind((e=>void 0===r?void 0:(0,u.visitFormulaNode)(c,r.arg))).bind((e=>o.Pledge.all(i.map((e=>o.Pledge.try((()=>(0,u.visitFormulaNode)(this,e.arg)))))))).bind((e=>{}))}lambdaNode(e,t,r,n){const i=this.bindNames(t),a=i[t.length];return this.lazyVisitAppHeadNode(e).bind((e=>o.Pledge.all(t.map((({name:e},t)=>{if(void 0===e.arg.def)return o.Pledge.resolve(void 0);const r=i[t],n=e.arg.def;return o.Pledge.try((()=>(0,u.visitFormulaNode)(r,n.rhs)))}))))).bind((e=>void 0===r?void 0:(0,u.visitFormulaNode)(a,r.arg))).bind((e=>o.Pledge.all(n.map((e=>o.Pledge.try((()=>(0,u.visitFormulaNode)(this,e.arg)))))))).bind((e=>{}))}bindNames(e){const t=[this];return e.reduce(((e,{name:r})=>{if(void 0===r.arg.wholeName)return t.push(new c(this.localeInfo,this.annotations,e)),e;const n=(0,l.getBoundName)(this.localeInfo,r.arg.wholeName),i=e.setValue(n,r.arg);return t.push(new c(this.localeInfo,this.annotations,i)),this.annotations[r.arg.label]=(0,s.localNameDeclAnnotation)(n,r.arg.wholeName),i}),this.names),t}nameNode(e,t,r){return o.Pledge.try((()=>{if(void 0===t){const t=(0,s.headNamePart)(e),r=this.names.getEntry((0,l.getBoundName)(this.localeInfo,t.asWhole));void 0===r||(r.value.kind===s.NodeKind.ContextName?this.annotations[t.label]=(0,s.localNameUseAnnotation)(r.key,r.value.whole,r.value.label):(this.annotations[t.label]=(0,s.localNameUseAnnotation)(r.key,r.value.wholeName,r.value.label),this.annotations[r.value.label].uses.push({label:t.label})))}return super.nameNode(e,t,r)}))}constructor(e,t,r){super(u.voidVisitor),this.localeInfo=e,this.annotations=t,this.names=r}}t.buildAnnotations=function(e,t,r,n){const o=[];return(0,u.reduceTopDown_Pledge)(new c(e,o,(null!=r?r:[]).reduce(((t,r)=>{const n=(0,l.getBoundName)(e,r.whole);return t.setValue(n,r)}),i.RedBlackMapTree.create(e.stringCompareCI))),t),o[t.label]=(0,s.formulaRootAnnotation)(r,n),o}},96945:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatName=t.formatGridRange=t.quoteQualifier=t.formatQualifier=t.shouldQuoteQualifier=t.canonicaliseRangePos=t.formatRangePos=t.canonicaliseCellPos=t.formatCellPos=t.canonicaliseColRange=t.canonicaliseRowRange=t.formatColRange=t.formatRowRange=t.canonicaliseCol=t.canonicaliseRow=t.formatCol=t.formatRow=t.resolvePosition=t.canonicaliseBrackets=t.columnName=void 0;const n=r(19181),i=r(20797),o=r(1194),a=r(85199),s=r(83387),l=n.__importStar(r(75253)),u=r(14687),c=r(78666),d=(0,o.pos)(o.PosKind.Abs,0),m=(0,o.pos)(o.PosKind.Abs,i.sheetRows-1),{codePointCapitalA:g,codePointFullStop:p}=l;function h(e){let t=e+1,r="";for(;t>0;){const e=(t-1)%26;r=String.fromCharCode(g+e)+r,t=Math.floor((t-e)/26)}return r}function f(e,t,r,n){if(t.kind===o.PosKind.Abs)return t.index;if(n)return(0,a.wrapPosition)(e,t.index,r);const i=e+t.index;return 0<=i&&i<r?i:void 0}function S(e,t,r,n,i,a){const s=f(r,n,i,a);if(void 0===s)return;if(n.kind===o.PosKind.Abs)return t+(s+1).toFixed();const l=s-r;return 0===l?t:t+e.rcLeftBracket+l.toFixed()+e.rcRightBracket}function v(e,t,r,n,a){return t===o.RefStyle.A1?function(e,t,r){const n=f(e,t,i.sheetRows,r);if(void 0===n)return;const a=(n+1).toFixed();return t.kind===o.PosKind.Abs?"$"+a:a}(r,n,a):S(e,e.rowLetter,r,n,i.sheetRows,a)}function y(e,t,r,n,a){return t===o.RefStyle.A1?function(e,t,r){const n=f(e,t,i.sheetCols,r);if(void 0===n)return;const a=h(n);return t.kind===o.PosKind.Abs?"$"+a:a}(r,n,a):S(e,e.columnLetter,r,n,i.sheetCols,a)}function F(e,t,r,n){if(r.kind===o.PosKind.Abs)return r;const i=f(t,r,e,n);if(void 0===i)return;const a=i-t;return a===r.index?r:(0,o.pos)(o.PosKind.Rel,a)}function C(e,t,r,n,i){const o=f(e,t,n,i),a=f(e,r,n,i);if(void 0!==o&&void 0!==a)return o<=a?[t,r,o,a]:[r,t,a,o]}function R(e,t,r,n,i,a,s,l,u){const c=C(a,s,l,r,u);if(void 0===c)return;const[d,m,g,p]=c;if(void 0!==t&&0===g&&p===r-1&&s.kind===l.kind)return t(n,i,u);const h=e(n,i,a,d,u);if(void 0===h)return;if(i===o.RefStyle.R1C1&&d.kind===m.kind&&d.index===m.index)return h;const f=e(n,i,a,m,u);return void 0!==f?h+":"+f:void 0}function b(e,t,r,n,i,o){const a=C(r,n,i,t,o);if(void 0===a)return;const[s,l,u,c]=a;if(void 0!==e&&0===u&&c===t-1&&n.kind===i.kind)return e;const d=F(t,r,s,o),m=F(t,r,l,o);return void 0!==d&&void 0!==m?[!1,d,m]:void 0}function E(e,t,r,n,i,a){const s=v(e,t,r.row,n,a),l=y(e,t,r.col,i,a);if(void 0!==s&&void 0!==l)return t===o.RefStyle.A1?l+s:s+l}function T(e,r,n,o,a,s,l,u){const c=C(n.row,o,s,i.sheetRows,u),d=C(n.col,a,l,i.sheetCols,u);if(void 0===c||void 0===d)return;const[m,g,p,h]=c,[f,S,v,y]=d;if(0===v&&y===i.sheetCols-1&&a.kind===l.kind)return(0,t.formatRowRange)(e,r,n.row,m,g,u);if(0===p&&h===i.sheetRows-1&&o.kind===s.kind)return(0,t.formatColRange)(e,r,n.col,f,S,u);const F=E(e,r,n,m,f,u),R=E(e,r,n,g,S,u);return void 0!==F&&void 0!==R?F+":"+R:void 0}function k(e,t){return t===p||e.isIdentContinue(t)}t.columnName=h,t.canonicaliseBrackets=function(e,t){return e===o.RefStyle.R1C1&&t.kind===o.PosKind.Rel&&0!==t.index},t.resolvePosition=f,t.formatRow=v,t.formatCol=y,t.canonicaliseRow=F.bind(void 0,i.sheetRows),t.canonicaliseCol=F.bind(void 0,i.sheetCols),t.formatRowRange=R.bind(void 0,v,void 0,i.sheetRows),t.formatColRange=R.bind(void 0,y,((e,r,n)=>(0,t.formatRowRange)(e,r,0,d,m,n)),i.sheetCols),t.canonicaliseRowRange=b.bind(void 0,void 0,i.sheetRows),t.canonicaliseColRange=b.bind(void 0,[!0,d,m],i.sheetCols),t.formatCellPos=E,t.canonicaliseCellPos=function(e,r,n,i){const o=(0,t.canonicaliseRow)(e.row,r,i),a=(0,t.canonicaliseCol)(e.col,n,i);if(void 0!==o&&void 0!==a)return{row:o,col:a}},t.formatRangePos=T,t.canonicaliseRangePos=function(e,r,n,o,a,s){const l=C(e.row,r,o,i.sheetRows,s),u=C(e.col,n,a,i.sheetCols,s);if(void 0===l||void 0===u)return;const[c,d,m,g]=l,[p,h,f,S]=u,v=(0,t.canonicaliseRow)(e.row,c,s),y=(0,t.canonicaliseCol)(e.col,p,s),F=(0,t.canonicaliseRow)(e.row,d,s),R=(0,t.canonicaliseCol)(e.col,h,s);return void 0!==v&&void 0!==y&&void 0!==F&&void 0!==R?0===f&&S===i.sheetCols-1&&n.kind===a.kind?{row1:v,row2:F,col1:void 0,col2:void 0}:0===m&&g===i.sheetRows-1&&r.kind===o.kind?{col1:y,col2:R,row1:void 0,row2:void 0}:{row1:v,col1:y,row2:F,col2:R}:void 0};const P=/'/g;function N(e,t){if(0===t.length)return!1;let r=0;const n=(0,u.stringCodePointAt)(t,r);if(!e.isIdentStart(n))return!1;r+=(0,u.numCodeUnits)(n);for(const n of(0,u.codePointIterator)(t,r))if(!k(e,n))return!1;return!0}const A=(0,i.gridCell)(0,0);function I(e,t,r){if(0===e.stringCompareCI(r,e.trueName))return!0;if(0===e.stringCompareCI(r,e.falseName))return!0;const n=(0,a.parseCellRef)(e,t,A,r,0);if(void 0!==n)if(n.refStyle===o.RefStyle.A1){const{i:t}=n;if(t>=r.length&&void 0===e.getWorksheetFuncId(r.substring(0,t)))return!0}else if(!(0,a.isR1C1IdentStart)(n.row,n.col))return!0;return!N(e,r)&&!function(e,t){let r=0;if(!(0,c.stringStartsWith)(t,e.leftBracket,r))return!1;if(r+=e.leftBracket.length,r===t.length)return!1;const n=(0,u.stringCodePointAt)(t,r);if(!k(e,n))return!1;for(r+=(0,u.numCodeUnits)(n);;){if((0,c.stringStartsWith)(t,e.rightBracket,r)){r+=e.rightBracket.length;break}if(r===t.length)return!1;const n=(0,u.stringCodePointAt)(t,r);if(!k(e,n))return!1;r+=(0,u.numCodeUnits)(n)}const i=t.indexOf(":",r);return i<0?N(e,t.substring(r)):N(e,t.substring(r,i))&&N(e,t.substring(i+1))}(e,r)&&!function(e,t){const r=e.leftBracket.length,n=e.rightBracket.length;return!(t.length<r+n)&&t.substring(0,r)===e.leftBracket&&t.substring(t.length-n)===e.rightBracket&&N(e,t.substring(r,t.length-n))}(e,r)}function O(e,t,r){return I(e,t,r)?_(r):r}function _(e){return`'${e.replace(P,"''")}'`}t.shouldQuoteQualifier=I,t.formatQualifier=O,t.quoteQualifier=_,t.formatGridRange=function(e,t,r=o.RefStyle.A1,n,a){const l=1===t.cols&&1===t.rows?E(e,r,(0,i.gridCell)(0,0),(0,o.pos)(o.PosKind.Rel,t.row),(0,o.pos)(o.PosKind.Rel,t.col),!1):T(e,r,(0,i.gridCell)(0,0),(0,o.pos)(o.PosKind.Rel,t.row),(0,o.pos)(o.PosKind.Rel,t.col),(0,o.pos)(o.PosKind.Rel,t.row+t.rows-1),(0,o.pos)(o.PosKind.Rel,t.col+t.cols-1),!1);if((0,s.assertTrue)("calc.lang.formatGridRange",void 0!==l),void 0===n&&void 0===a)return l;if(void 0===n||void 0===a)return O(e,r,null!=n?n:a)+"!"+l;const u=n+":"+a;return(I(e,r,n)||I(e,r,a)?_(u):u)+"!"+l},t.formatName=function(e,t,r=o.RefStyle.A1,n){return void 0===n?t:O(e,r,n)+"!"+t}},85199:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapPosition=t.parseQualifier=t.parseGridRangeA1=t.parseGridCellA1=t.parseCellRef=t.isR1C1IdentStart=t.SpecialPos=void 0;const n=r(19181),i=r(20797),o=r(80873),a=r(1194),s=r(21572),l=n.__importStar(r(75253)),u=r(78666),c=r(14687),d=i.sheetRows,m=d.toString(10).length,g=i.sheetCols,p=g.toString(26).length,h=g.toString(10).length,{codePointCapitalA:f,codePointCapitalZ:S,codePointSmallA:v,codePointSmallZ:y,codePointPlusSign:F,codePointMinusSign:C,codePointColon:R}=l;function b(e){return e>=v&&e<=y||e>=f&&e<=S}function E(e){return 1+(e>=v?e-v:e-f)}function T(e,t,r,n){return function(i,o,s,l,d){const[m,g]=function(e,t){return(0,u.stringStartsWith)(e,"$",t)?[a.PosKind.Abs,t+1]:[a.PosKind.Rel,t]}(s,l),[p,h]=e(i,r,s,g);if(h>g){if(p<1||p>t)return m===a.PosKind.Abs||(!0===n?"object"==typeof d&&d.kind===a.PosKind.Abs||d===w.A1BadDollar:(0,u.stringStartsWith)(s,"$",h))?[w.A1BadDollar,!0,h]:void 0;const e=m===a.PosKind.Rel?p-o:p;return[(0,a.pos)(m,e-1),m===a.PosKind.Abs,h]}return m!==a.PosKind.Abs||!0!==n&&h!==s.length&&i.isNumeral((0,c.stringCodePointAt)(s,h))?[void 0,!1,l]:[w.A1BadDollar,!0,h]}}function k(e,t,r){return x(e,t,r)-e}function P(e,t,r,n){return function(i,o,l,c){const d=t?e?"R":i.rowLetter:e?"C":i.columnLetter;if(c>=l.length||0!==i.stringCompareCI(d,l[c]))return[void 0,!1,c];let m=c+d.length;const[g,p]=(0,s.parseUint)(i,n,l,m);if(p>m&&g>=1&&g<=r)return[(0,a.pos)(a.PosKind.Abs,g-1),!1,p];if((0,u.stringStartsWith)(l,i.rcLeftBracket,m)){if(m+=i.rcLeftBracket.length,(0,u.stringStartsWith)(l,i.rcRightBracket,m))return[(0,a.pos)(a.PosKind.Rel,k(o,0,r)),!0,m+i.rcRightBracket.length];let e=1;const t=l.charCodeAt(m);t===F?m+=1:t===C&&(e=-1,m+=1);const[c,d]=(0,s.parseUint)(i,n,l,m);if(d>m&&c<r&&(0,u.stringStartsWith)(l,i.rcRightBracket,d))return[(0,a.pos)(a.PosKind.Rel,k(o,c*e,r)),!0,d+i.rcRightBracket.length]}return[w.RCNoNum,!1,c+d.length]}}function N(e,t,r,n,i,o,a){const s=n(e,t,o,a,void 0);if(null==s)return[void 0,void 0,a];const[l,u,c]=s;if(c>a){const t=i(e,r,o,c,l);if(null==t)return u?[l,void 0,c]:[void 0,void 0,a];const[n,,s]=t;return s>c?[l,n,s]:[l,void 0,c]}const d=i(e,r,o,a,l);if(null==d)return[void 0,void 0,a];const[m,,g]=d;return g>a?[void 0,m,g]:[void 0,void 0,a]}const A=T(s.parseUint,d,m,!0),I=T(((e,t,r,n)=>function(e,t,r){let n=0,i=r;const a=(0,o.fastMin)(t.length,r+e);for(;i<a;i+=1){const e=t.charCodeAt(i);if(!b(e))break;n=26*n+E(e)}return i===a&&i<t.length&&b(t.charCodeAt(i))?[0,r]:[n,i]}(t,r,n)),g,p,!1),O=P(!1,!0,d,m),_=P(!1,!1,g,h),M=P(!0,!0,d,m),D=P(!0,!1,g,h);var w;function L(e,t){return"object"!=typeof e&&"object"!=typeof t}function x(e,t,r){return e+t&r-1}!function(e){e[e.RCNoNum=0]="RCNoNum",e[e.A1BadDollar=1]="A1BadDollar"}(w||(t.SpecialPos=w={})),t.isR1C1IdentStart=L,t.parseCellRef=function(e,t,r,n,i){const o=function(e,t,r,n,i){const{col:o,row:s}=r,[l,u,d]=N(e,o,s,I,A,n,i),m="object"==typeof u&&u.kind===a.PosKind.Abs||u===w.A1BadDollar||"object"==typeof l&&l.kind===a.PosKind.Abs||l===w.A1BadDollar;if(null!=u&&null!=l||m||(null!=u||null!=l)&&(i-1>=0&&n.charCodeAt(i-1)===R||d<n.length&&n.charCodeAt(d)===R)){if(d<n.length&&e.isIdentContinue((0,c.stringCodePointAt)(n,d)))return;if(t!==a.RefStyle.A1&&!m)return;return{refStyle:a.RefStyle.A1,row:u,col:l,i:d}}}(e,t,r,n,i);return void 0!==o?o:function(e,t,r,n,i){const{col:o,row:s}=r;let l=!1,[u,d,m]=N(e,s,o,O,_,n,i);if(null!=u||null!=d||"R"===e.rowLetter&&"C"===e.columnLetter||(l=!0,[u,d,m]=N(e,s,o,M,D,n,i)),(null!=u||null!=d)&&(m>=n.length||!L(u,d)||!e.isIdentContinue((0,c.stringCodePointAt)(n,m))))return{refStyle:a.RefStyle.R1C1,row:u,col:d,i:m,enLocale:l}}(e,0,r,n,i)},t.parseGridCellA1=function(e,t){const[r,n,o]=N(e,0,0,I,A,t,0);return"object"==typeof r&&"object"==typeof n&&o===t.length?(0,i.gridCell)(n.index,r.index):void 0},t.parseGridRangeA1=function(e,t){const[r,n,a]=N(e,0,0,I,A,t,0);if("object"!=typeof r||"object"!=typeof n)return;if(a===t.length)return(0,i.gridCell)(n.index,r.index);if(t.charCodeAt(a)!==R)return;const[s,l,u]=N(e,0,0,I,A,t,a+1);if("object"!=typeof s||"object"!=typeof l)return;if(u!==t.length)return;const c=(0,o.fastMin)(n.index,l.index),d=(0,o.fastMin)(r.index,s.index);return(0,i.gridRange)(c,d,(0,o.fastMax)(n.index,l.index)+1-c,(0,o.fastMax)(r.index,s.index)+1-d)},t.parseQualifier=function(e){const t=e.lastIndexOf("!");if(t<0||0===t||t===e.length-1)return;const r=e.substring(0,t),n=e.substring(t+1);if(r.indexOf("'")<0)return{qualifier:r,unqualified:n};if(!(0,u.stringStartsWith)(r,"'")||!(0,u.stringEndsWith)(r,"'"))return;const i=[];for(let e=1;e<r.length-1;++e){const t=r.charAt(e);if("'"===t){if(e+1>=r.length-1||"'"!==r.charAt(e+1))return;i.push(t),++e}else i.push(t)}return{qualifier:i.join(""),unqualified:n}},t.wrapPosition=x},48398:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;const n=r(57777);t.anonymize=n.anonymizer.anonymize,t.anonymizeFormulaString=n.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=n.anonymizer.anonymizeMagnitude,t.kindAnonymizers=n.anonymizer.kindAnonymizers},83387:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;const n=r(57777);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},75253:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointExclamationMark=t.codePointEuroSign=t.codePointEqualsSign=t.codePointDoubleQuote=t.codePointDollarSign=t.codePointDigitZero=t.codePointDigitTwo=t.codePointDigitThree=t.codePointDigitSix=t.codePointDigitSeven=t.codePointDigitOne=t.codePointDigitNine=t.codePointDigitFour=t.codePointDigitFive=t.codePointDigitEight=t.codePointComma=t.codePointColon=t.codePointCircumflexAccent=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointCR=t.codePointBacktick=t.codePointBackslash=t.codePointAtSign=t.codePointAsterisk=t.codePointAmpersand=void 0,t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointSlash=t.codePointSingleQuote=t.codePointSemicolon=t.codePointRightSquareBracket=t.codePointRightParen=t.codePointRightCurlyBracket=t.codePointQuestionMark=t.codePointPlusSign=t.codePointPipe=t.codePointPercentSign=t.codePointMinusSign=t.codePointLessThanSign=t.codePointLeftSquareBracket=t.codePointLeftParen=t.codePointLeftCurlyBracket=t.codePointLF=t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointHash=t.codePointGreaterThanSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitZero=t.codePointFullwidthDigitNine=t.codePointFullStop=void 0,t.codePointUnderscore=t.codePointTilde=t.codePointThaiDigitZero=t.codePointThaiDigitNine=t.codePointTab=t.codePointSpace=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=void 0;const n=r(57777);t.codePointAmpersand=n.codePoint.codePointAmpersand,t.codePointAsterisk=n.codePoint.codePointAsterisk,t.codePointAtSign=n.codePoint.codePointAtSign,t.codePointBackslash=n.codePoint.codePointBackslash,t.codePointBacktick=n.codePoint.codePointBacktick,t.codePointCR=n.codePoint.codePointCR,t.codePointCapitalA=n.codePoint.codePointCapitalA,t.codePointCapitalB=n.codePoint.codePointCapitalB,t.codePointCapitalC=n.codePoint.codePointCapitalC,t.codePointCapitalD=n.codePoint.codePointCapitalD,t.codePointCapitalE=n.codePoint.codePointCapitalE,t.codePointCapitalF=n.codePoint.codePointCapitalF,t.codePointCapitalG=n.codePoint.codePointCapitalG,t.codePointCapitalH=n.codePoint.codePointCapitalH,t.codePointCapitalI=n.codePoint.codePointCapitalI,t.codePointCapitalJ=n.codePoint.codePointCapitalJ,t.codePointCapitalK=n.codePoint.codePointCapitalK,t.codePointCapitalL=n.codePoint.codePointCapitalL,t.codePointCapitalM=n.codePoint.codePointCapitalM,t.codePointCapitalN=n.codePoint.codePointCapitalN,t.codePointCapitalO=n.codePoint.codePointCapitalO,t.codePointCapitalP=n.codePoint.codePointCapitalP,t.codePointCapitalQ=n.codePoint.codePointCapitalQ,t.codePointCapitalR=n.codePoint.codePointCapitalR,t.codePointCapitalS=n.codePoint.codePointCapitalS,t.codePointCapitalT=n.codePoint.codePointCapitalT,t.codePointCapitalU=n.codePoint.codePointCapitalU,t.codePointCapitalV=n.codePoint.codePointCapitalV,t.codePointCapitalW=n.codePoint.codePointCapitalW,t.codePointCapitalX=n.codePoint.codePointCapitalX,t.codePointCapitalY=n.codePoint.codePointCapitalY,t.codePointCapitalZ=n.codePoint.codePointCapitalZ,t.codePointCircumflexAccent=n.codePoint.codePointCircumflexAccent,t.codePointColon=n.codePoint.codePointColon,t.codePointComma=n.codePoint.codePointComma,t.codePointDigitEight=n.codePoint.codePointDigitEight,t.codePointDigitFive=n.codePoint.codePointDigitFive,t.codePointDigitFour=n.codePoint.codePointDigitFour,t.codePointDigitNine=n.codePoint.codePointDigitNine,t.codePointDigitOne=n.codePoint.codePointDigitOne,t.codePointDigitSeven=n.codePoint.codePointDigitSeven,t.codePointDigitSix=n.codePoint.codePointDigitSix,t.codePointDigitThree=n.codePoint.codePointDigitThree,t.codePointDigitTwo=n.codePoint.codePointDigitTwo,t.codePointDigitZero=n.codePoint.codePointDigitZero,t.codePointDollarSign=n.codePoint.codePointDollarSign,t.codePointDoubleQuote=n.codePoint.codePointDoubleQuote,t.codePointEqualsSign=n.codePoint.codePointEqualsSign,t.codePointEuroSign=n.codePoint.codePointEuroSign,t.codePointExclamationMark=n.codePoint.codePointExclamationMark,t.codePointFullStop=n.codePoint.codePointFullStop,t.codePointFullwidthDigitNine=n.codePoint.codePointFullwidthDigitNine,t.codePointFullwidthDigitZero=n.codePoint.codePointFullwidthDigitZero,t.codePointFullwidthLatinCapitalA=n.codePoint.codePointFullwidthLatinCapitalA,t.codePointFullwidthLatinCapitalZ=n.codePoint.codePointFullwidthLatinCapitalZ,t.codePointFullwidthLatinSmallA=n.codePoint.codePointFullwidthLatinSmallA,t.codePointFullwidthLatinSmallZ=n.codePoint.codePointFullwidthLatinSmallZ,t.codePointGreaterThanSign=n.codePoint.codePointGreaterThanSign,t.codePointHash=n.codePoint.codePointHash,t.codePointInvertedExclamationMark=n.codePoint.codePointInvertedExclamationMark,t.codePointInvertedQuestionMark=n.codePoint.codePointInvertedQuestionMark,t.codePointLF=n.codePoint.codePointLF,t.codePointLeftCurlyBracket=n.codePoint.codePointLeftCurlyBracket,t.codePointLeftParen=n.codePoint.codePointLeftParen,t.codePointLeftSquareBracket=n.codePoint.codePointLeftSquareBracket,t.codePointLessThanSign=n.codePoint.codePointLessThanSign,t.codePointMinusSign=n.codePoint.codePointMinusSign,t.codePointPercentSign=n.codePoint.codePointPercentSign,t.codePointPipe=n.codePoint.codePointPipe,t.codePointPlusSign=n.codePoint.codePointPlusSign,t.codePointQuestionMark=n.codePoint.codePointQuestionMark,t.codePointRightCurlyBracket=n.codePoint.codePointRightCurlyBracket,t.codePointRightParen=n.codePoint.codePointRightParen,t.codePointRightSquareBracket=n.codePoint.codePointRightSquareBracket,t.codePointSemicolon=n.codePoint.codePointSemicolon,t.codePointSingleQuote=n.codePoint.codePointSingleQuote,t.codePointSlash=n.codePoint.codePointSlash,t.codePointSmallA=n.codePoint.codePointSmallA,t.codePointSmallB=n.codePoint.codePointSmallB,t.codePointSmallC=n.codePoint.codePointSmallC,t.codePointSmallD=n.codePoint.codePointSmallD,t.codePointSmallE=n.codePoint.codePointSmallE,t.codePointSmallF=n.codePoint.codePointSmallF,t.codePointSmallG=n.codePoint.codePointSmallG,t.codePointSmallH=n.codePoint.codePointSmallH,t.codePointSmallI=n.codePoint.codePointSmallI,t.codePointSmallJ=n.codePoint.codePointSmallJ,t.codePointSmallK=n.codePoint.codePointSmallK,t.codePointSmallL=n.codePoint.codePointSmallL,t.codePointSmallM=n.codePoint.codePointSmallM,t.codePointSmallN=n.codePoint.codePointSmallN,t.codePointSmallO=n.codePoint.codePointSmallO,t.codePointSmallP=n.codePoint.codePointSmallP,t.codePointSmallQ=n.codePoint.codePointSmallQ,t.codePointSmallR=n.codePoint.codePointSmallR,t.codePointSmallS=n.codePoint.codePointSmallS,t.codePointSmallT=n.codePoint.codePointSmallT,t.codePointSmallU=n.codePoint.codePointSmallU,t.codePointSmallV=n.codePoint.codePointSmallV,t.codePointSmallW=n.codePoint.codePointSmallW,t.codePointSmallX=n.codePoint.codePointSmallX,t.codePointSmallY=n.codePoint.codePointSmallY,t.codePointSmallZ=n.codePoint.codePointSmallZ,t.codePointSpace=n.codePoint.codePointSpace,t.codePointTab=n.codePoint.codePointTab,t.codePointThaiDigitNine=n.codePoint.codePointThaiDigitNine,t.codePointThaiDigitZero=n.codePoint.codePointThaiDigitZero,t.codePointTilde=n.codePoint.codePointTilde,t.codePointUnderscore=n.codePoint.codePointUnderscore},80873:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;const n=r(57777);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},20903:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enumerateKeysInOrder=t.enumerateInOrder=t.RootPointer=t.ArrayMapTree=t.floorToPowerOf2=void 0;const n=r(57777);t.floorToPowerOf2=n.arrayMapTree.floorToPowerOf2,t.ArrayMapTree=n.arrayMapTree.ArrayMapTree,t.RootPointer=n.arrayMapTree.RootPointer,t.enumerateInOrder=n.arrayMapTree.enumerateInOrder,t.enumerateKeysInOrder=n.arrayMapTree.enumerateKeysInOrder},9103:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ivlCompare=t.ivlExcept=t.ivlMeetsOrTouches=t.ivlMeets=t.ivlDistance=t.ivlMeet=t.ivlJoin=void 0;const n=r(57777);t.ivlJoin=n.interval.ivlJoin,t.ivlMeet=n.interval.ivlMeet,t.ivlDistance=n.interval.ivlDistance,t.ivlMeets=n.interval.ivlMeets,t.ivlMeetsOrTouches=n.interval.ivlMeetsOrTouches,t.ivlExcept=n.interval.ivlExcept,t.ivlCompare=n.interval.ivlCompare},58938:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;const n=r(57777);t.RedBlackMapTree=n.rbMapTree.RedBlackMapTree},21068:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entry=t.makeEmptyTable=void 0;const n=r(57777);t.makeEmptyTable=n.table.makeEmptyTable,t.entry=n.table.entry},88658:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;const n=r(57777);t.FeatureName=n.featureConfiguration.FeatureName,t.initFeatureConfiguration=n.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=n.featureConfiguration.isFeatureEnabled,t.getFeatures=n.featureConfiguration.getFeatures,t.getTypedFeatureGate=n.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=n.featureConfiguration.isTypedChangeGateEnabled;var i=r(12367);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return i.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return i.setFeatureGateDictionaryGetter}})},93387:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;const n=r(57777);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},31174:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;const n=r(57777);t.Pledge=n.pledge.Pledge},14687:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.surrogatePairToCodePoint=t.stringFromCodePoint=t.stringCodePointAt=t.scanCodePointsBack=t.scanCodePoints=t.numCodeUnits=t.makeIsInClass=t.isLowSurrogate=t.isHighSurrogate=t.isAnySurrogate=t.forEachClassInterval=t.countCodePoints=t.codePointIterator=void 0;const n=r(57777);t.codePointIterator=n.unicode.codePointIterator,t.countCodePoints=n.unicode.countCodePoints,t.forEachClassInterval=n.unicode.forEachClassInterval,t.isAnySurrogate=n.unicode.isAnySurrogate,t.isHighSurrogate=n.unicode.isHighSurrogate,t.isLowSurrogate=n.unicode.isLowSurrogate,t.makeIsInClass=n.unicode.makeIsInClass,t.numCodeUnits=n.unicode.numCodeUnits,t.scanCodePoints=n.unicode.scanCodePoints,t.scanCodePointsBack=n.unicode.scanCodePointsBack,t.stringCodePointAt=n.unicode.stringCodePointAt,t.stringFromCodePoint=n.unicode.stringFromCodePoint,t.surrogatePairToCodePoint=n.unicode.surrogatePairToCodePoint},78666:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;const n=r(57777);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},98064:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEnglishLocaleInfo=t.createIsThousandsPositionCallback=t.createWorksheetFuncNameCallbacks=t.getEnglishWorksheetFuncIdToName=t.operatorIdToName=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishPictureDbnum=t.englishPictureColor=t.englishPictureSingle=t.englishPictureSpecial=t.englishSpecialRefNames=t.englishErrorNames=t.isIdentContinue=t.isIdentStart=t.getNumberShape=t.getOrdinal=t.isNumeral=t.LCID=t.Country=t.localeInfo=t.calcConfig=t.ulsLogger=t.NulLogger=t.TraceLevel=t.LogCategory=t.PictureSingle=t.PictureSpecial=t.PictureDbnum=t.PictureColor=void 0;const n=r(43512);Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return n.LogCategory}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return n.TraceLevel}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return n.NulLogger}});const i=r(80873),o=r(83387);Object.defineProperty(t,"ulsLogger",{enumerable:!0,get:function(){return o.ulsLogger}});const a=r(47098),s=r(78666),l=r(87673),u=r(20903),c=r(15833),d=r(1194),m=r(20653),g=r(96279),p=r(84357),h=r(18538);function f(e,t,r,n,i,o,a,s,l,u,c,d,m,g,p,h,f,S,v,y,F,C,R,b,E,T,k,P,N,A,I,O,_,M,D,w,L,x,K,U,B,G,W,V,j,q,H,z,$,Q,Y,J,X,Z,ee,te,re,ne,ie,oe,ae,se,le,ue,ce,de,me,ge){return{getWorksheetFuncId:e,getWorksheetFuncName:t,isNumeral:r,getOrdinal:n,getNumberShape:i,isThousandsPosition:o,isIdentStart:a,isIdentContinue:s,stringCompareCI:l,errorNames:u,specialRefNames:c,trueName:d,falseName:m,rowLetter:g,columnLetter:p,leftBrace:h,rightBrace:f,leftBracket:S,rightBracket:v,rcLeftBracket:y,rcRightBracket:F,decimalSeparator:C,listSeparator:R,columnSeparator:b,rowSeparator:E,thousandsSeparator:T,statementSeparator:k,lcid:P,country:N,isThai:A,isEastAsia:I,isKorea:O,isJapan:_,isChinaT:M,isChinaS:D,isComplexScript:w,numberDecimals:L,isExpSepBySpace:x,fractionSeparator:K,isPercentSepBySpace:U,currencyFormat:B,isCurrencySymbolLead:G,isCurrencySepBySpace:W,currencySymbol:V,currencyDecimals:j,dateOrder:q,dateSeparator:H,dateAltSeparator:z,year4Digits:$,month2Digits:Q,day2Digits:Y,longDateFormat:J,timeSeparator:X,timeAltSeparator:Z,hour2Digits:ee,clock24Hour:te,isAMPMSepBySpace:re,ampmSymbols:ne,dayNameShort:ie,dayNameLong:oe,monthNameShort:ae,monthNameLong:se,pictureSpecial:le,pictureSingle:ue,pictureColor:ce,pictureDbnum:de,sysDateFormat:me,sysTimeFormat:ge}}var S,v;function y(e){const t=0|e;if(t<128)return t>=48&&t<58;const r=15&t;switch(2147483632&t){case 1632:case 1776:case 3664:case 3792:case 3872:case 4160:case 6112:case 6160:return r<=9;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:return r>=6&&r<=15;case 4960:return r>=9;case 4976:return r<=1;default:return!1}}function F(e){const t=0|e;if(t<128)return(t<48||t>=58)&&(0,o.assertFalse)("calc.config.getOrdinal"),15&t;const r=15&t;let n;switch(2147483632&t){case 1632:case 1776:case 3664:case 3792:case 3872:case 4160:case 6112:case 6160:n=r;break;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:n=r-6;break;case 4960:n=r-8;break;case 4976:n=r+8;break;default:return(0,o.assertFalse)("calc.config.getOrdinal")}return(n<0||n>9||4968===t)&&(0,o.assertFalse)("calc.config.getOrdinal"),n}function C(e){const t=0|e;if(t<128)return(t<48||t>=58)&&(0,o.assertFalse)("calc.config.getNumberShape"),m.NumberShape.ASCII;switch(y(t)||(0,o.assertFalse)("calc.config.getNumberShape"),2147483632&t){case 1632:return m.NumberShape.ArabicIndic;case 1776:return m.NumberShape.ExtendedArabicIndic;case 2400:return m.NumberShape.Devanagari;case 2528:return m.NumberShape.Bengali;case 2656:return m.NumberShape.Gurmukhi;case 2784:return m.NumberShape.Gujarati;case 2912:return m.NumberShape.Oriya;case 3040:return m.NumberShape.Tamil;case 3168:return m.NumberShape.Telugu;case 3296:return m.NumberShape.Kannada;case 3424:return m.NumberShape.Malayalam;case 3664:return m.NumberShape.Thai;case 3792:return m.NumberShape.Lao;case 3872:return m.NumberShape.Tibetan;case 4160:return m.NumberShape.Myanmar;case 4960:case 4976:return m.NumberShape.Ethiopic;case 6112:return m.NumberShape.Khmer;case 6160:return m.NumberShape.Mongolian;default:return(0,o.assertFalse)("calc.config.getNumberShape")}}Object.defineProperty(t,"PictureColor",{enumerable:!0,get:function(){return h.PictureColor}}),Object.defineProperty(t,"PictureDbnum",{enumerable:!0,get:function(){return h.PictureDbnum}}),Object.defineProperty(t,"PictureSingle",{enumerable:!0,get:function(){return h.PictureSingle}}),Object.defineProperty(t,"PictureSpecial",{enumerable:!0,get:function(){return h.PictureSpecial}}),t.calcConfig=function(e,t=d.RefStyle.A1,r=p.xlMathpack,n=!1,i=!0,o=g.tzUTC,a=g.xlDatepack){return{localeInfo:e,refStyle:t,mathpack:r,date1904:n,dateCompatibility:i,timezone:o,datepack:a}},t.localeInfo=f,function(e){e[e.USA=1]="USA",e[e.UK=44]="UK",e[e.AUS=61]="AUS",e[e.NZ=64]="NZ",e[e.UNK=1]="UNK",e[e.CAN=2]="CAN",e[e.DUT=31]="DUT",e[e.FRN=33]="FRN",e[e.SPA=34]="SPA",e[e.ITN=39]="ITN",e[e.SWE=46]="SWE",e[e.GER=49]="GER",e[e.JPN=81]="JPN",e[e.MEX=52]="MEX",e[e.BRA=55]="BRA",e[e.LAM=3]="LAM",e[e.BEL=32]="BEL",e[e.SWZ=41]="SWZ",e[e.SWG=41]="SWG",e[e.SWF=41]="SWF",e[e.AUT=43]="AUT",e[e.DAN=45]="DAN",e[e.NOR=47]="NOR",e[e.POR=351]="POR",e[e.FIN=358]="FIN",e[e.ICE=354]="ICE",e[e.GRK=30]="GRK",e[e.TUR=90]="TUR",e[e.CZE=420]="CZE",e[e.HUN=36]="HUN",e[e.POL=48]="POL",e[e.RUS=7]="RUS",e[e.HEB=972]="HEB",e[e.ARB=966]="ARB",e[e.PER=981]="PER",e[e.ARB_Algeria=213]="ARB_Algeria",e[e.ARB_Bahrain=966]="ARB_Bahrain",e[e.ARB_Djibouti=253]="ARB_Djibouti",e[e.ARB_Egypt=20]="ARB_Egypt",e[e.ARB_Iraq=964]="ARB_Iraq",e[e.ARB_Jordan=962]="ARB_Jordan",e[e.ARB_Kuwait=965]="ARB_Kuwait",e[e.ARB_Lebanon=961]="ARB_Lebanon",e[e.ARB_Libya=218]="ARB_Libya",e[e.ARB_Mauritania=222]="ARB_Mauritania",e[e.ARB_Morocco=216]="ARB_Morocco",e[e.ARB_Oman=968]="ARB_Oman",e[e.ARB_Qatar=974]="ARB_Qatar",e[e.ARB_SaudiArabia=966]="ARB_SaudiArabia",e[e.ARB_Somalia=1]="ARB_Somalia",e[e.ARB_Sudan=249]="ARB_Sudan",e[e.ARB_Syria=963]="ARB_Syria",e[e.ARB_Tunisia=216]="ARB_Tunisia",e[e.ARB_UAE=971]="ARB_UAE",e[e.ARB_Yemen=969]="ARB_Yemen",e[e.KOR=82]="KOR",e[e.TW=886]="TW",e[e.PRC=86]="PRC",e[e.THA=66]="THA",e[e.VIET=84]="VIET"}(S||(t.Country=S={})),function(e){e[e.None=0]="None",e[e.USA=1033]="USA",e[e.Greek=1032]="Greek",e[e.Hungarian=1038]="Hungarian",e[e.Turkish=1055]="Turkish",e[e.Thailand=1054]="Thailand",e[e.Vietnam=1066]="Vietnam",e[e.Arabic=1025]="Arabic",e[e.Hebrew=1037]="Hebrew",e[e.Tamil=1097]="Tamil",e[e.Syriac=1114]="Syriac",e[e.Iraq=2049]="Iraq",e[e.Algerian=5121]="Algerian",e[e.Basque=1069]="Basque",e[e.PortBrazil=1046]="PortBrazil",e[e.Croatian=1050]="Croatian",e[e.Czech=1029]="Czech",e[e.Danish=1030]="Danish",e[e.Dutch=1043]="Dutch",e[e.Australian=3081]="Australian",e[e.CanadianEnglish=4105]="CanadianEnglish",e[e.British=2057]="British",e[e.Finnish=1035]="Finnish",e[e.French=1036]="French",e[e.FrenchCanadian=3084]="FrenchCanadian",e[e.Italian=1040]="Italian",e[e.NorskBokmal=1044]="NorskBokmal",e[e.NorskNynorsk=2068]="NorskNynorsk",e[e.Polish=1045]="Polish",e[e.PortIberian=2070]="PortIberian",e[e.Romanian=1048]="Romanian",e[e.Russian=1049]="Russian",e[e.Ukrainian=1058]="Ukrainian",e[e.Belarusian=1059]="Belarusian",e[e.SerbianCyrillic=3098]="SerbianCyrillic",e[e.SerbianLatin=2074]="SerbianLatin",e[e.Slovak=1051]="Slovak",e[e.Slovenian=1060]="Slovenian",e[e.SpanishModern=3082]="SpanishModern",e[e.Swedish=1053]="Swedish",e[e.HongKong=3076]="HongKong",e[e.ChinaT=1028]="ChinaT",e[e.Korea=1042]="Korea",e[e.Japan=1041]="Japan",e[e.China=2052]="China",e[e.ChinaStroke=133124]="ChinaStroke",e[e.Devihi=1125]="Devihi",e[e.Hindi=1081]="Hindi",e[e.German=1031]="German",e[e.Swiss=4108]="Swiss",e[e.Indonesia=1057]="Indonesia",e[e.EnglishIndonesia=14345]="EnglishIndonesia",e[e.EnglishIndia=16393]="EnglishIndia",e[e.Singapore=4100]="Singapore",e[e.EnglishSingapore=18441]="EnglishSingapore",e[e.Serbia=9242]="Serbia",e[e.Mexico=2058]="Mexico",e[e.Ireland=6153]="Ireland",e[e.EnglishZimbabwe=12297]="EnglishZimbabwe",e[e.Belgium=2067]="Belgium",e[e.SystemTime=62464]="SystemTime",e[e.SystemLongDate=63488]="SystemLongDate",e[e.EuroTrailing=1]="EuroTrailing",e[e.EuroLeading=2]="EuroLeading",e[e.LANG=1023]="LANG",e[e.COUNTRY=64512]="COUNTRY",e[e.OPTIONS=16711680]="OPTIONS"}(v||(t.LCID=v={})),t.isNumeral=y,t.getOrdinal=F,t.getNumberShape=C;const R=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,2,0,0,2,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0]);function b(e){const t=0|e;return t>=0&&t<128?R[t]>=2:(0,l.isIdentStart)(t)}function E(e){const t=0|e;return t>=0&&t<128?R[t]>=1:(0,l.isIdentContinue)(t)}let T;t.isIdentStart=b,t.isIdentContinue=E,t.englishErrorNames=(0,s.partialArray)({[c.ErrorType.NULL]:"#NULL!",[c.ErrorType.DIV0]:"#DIV/0!",[c.ErrorType.VALUE]:"#VALUE!",[c.ErrorType.REF]:"#REF!",[c.ErrorType.NAME]:"#NAME?",[c.ErrorType.NUM]:"#NUM!",[c.ErrorType.NA]:"#N/A",[c.ErrorType.GETTING_DATA]:"#GETTING_DATA",[c.ErrorType.SPILL]:"#SPILL!",[c.ErrorType.CONNECT]:"#CONNECT!",[c.ErrorType.BLOCKED]:"#BLOCKED!",[c.ErrorType.UNKNOWN]:"#UNKNOWN!",[c.ErrorType.FIELD]:"#FIELD!",[c.ErrorType.CALC]:"#CALC!",[c.ErrorType.BUSY]:"#BUSY!",[c.ErrorType.EXTERNAL]:"#EXTERNAL!"}),t.englishSpecialRefNames=(0,s.partialArray)({[d.SpecialRefId.All]:"#All",[d.SpecialRefId.Data]:"#Data",[d.SpecialRefId.Headers]:"#Headers",[d.SpecialRefId.Totals]:"#Totals",[d.SpecialRefId.ThisRow]:"#This Row"}),t.englishPictureSpecial=(0,s.partialArray)({[h.PictureSpecial.AP1]:"AM/PM",[h.PictureSpecial.AP2]:"A/P",[h.PictureSpecial.AP3]:"/",[h.PictureSpecial.General]:"General",[h.PictureSpecial.Currency]:"$"}),t.englishPictureSingle=(0,s.partialArray)({[h.PictureSingle.Sep]:";",[h.PictureSingle.Hash]:"#",[h.PictureSingle.Zero]:"0",[h.PictureSingle.Decimal]:".",[h.PictureSingle.Percent]:"%",[h.PictureSingle.Comma]:",",[h.PictureSingle.Colon]:":",[h.PictureSingle.DateSep]:"/",[h.PictureSingle.Slash]:"/",[h.PictureSingle.Space]:" ",[h.PictureSingle.Minus]:"-",[h.PictureSingle.Plus]:"+",[h.PictureSingle.OpenParen]:"(",[h.PictureSingle.CloseParen]:")",[h.PictureSingle.Backslash]:"\\",[h.PictureSingle.Star]:"*",[h.PictureSingle.Year]:"y",[h.PictureSingle.Month]:"m",[h.PictureSingle.Day]:"d",[h.PictureSingle.Hour]:"h",[h.PictureSingle.Minute]:"m",[h.PictureSingle.Second]:"s",[h.PictureSingle.E]:"E",[h.PictureSingle.APDelim]:"/",[h.PictureSingle.Quote]:'"',[h.PictureSingle.ColorStart]:"[",[h.PictureSingle.ColorEnd]:"]",[h.PictureSingle.Text]:"@",[h.PictureSingle.Question]:"?",[h.PictureSingle.Underscore]:"_",[h.PictureSingle.Reign]:"r",[h.PictureSingle.LocDay]:"a",[h.PictureSingle.Era]:"g",[h.PictureSingle.EraYear]:"e",[h.PictureSingle.BidiDate]:"B",[h.PictureSingle.BidiNum]:"N",[h.PictureSingle.DayTh]:"",[h.PictureSingle.MonthTh]:"",[h.PictureSingle.YearTh]:"",[h.PictureSingle.EngYearTh]:"b",[h.PictureSingle.ThYear]:"",[h.PictureSingle.HourTh]:"",[h.PictureSingle.MinuteTh]:"",[h.PictureSingle.SecondTh]:"",[h.PictureSingle.ZeroTh]:""}),t.englishPictureColor=(0,s.partialArray)({[h.PictureColor.Black]:"Black",[h.PictureColor.White]:"White",[h.PictureColor.Red]:"Red",[h.PictureColor.Green]:"Green",[h.PictureColor.Blue]:"Blue",[h.PictureColor.Yellow]:"Yellow",[h.PictureColor.Magenta]:"Magenta",[h.PictureColor.Cyan]:"Cyan",[h.PictureColor.Color]:"Color"}),t.englishPictureDbnum=(0,s.partialArray)({[h.PictureDbnum.DBNUM1]:"DBNum1",[h.PictureDbnum.DBNUM2]:"DBNum2",[h.PictureDbnum.DBNUM3]:"DBNum3",[h.PictureDbnum.DBNUM4]:"DBNum4"}),t.englishSysDateFormat="dddd, mmmm dd, yyyy",t.englishSysTimeFormat="h:mm:ss AM/PM",t.englishWorksheetFuncIdToName=function(e){const t=P()[e];return void 0===t?`wsf:${e}`:t},t.englishErrorTypeToName=function(e){const r=t.englishErrorNames[e];return void 0===r?`error.type:${e}`:r},t.englishOperatorIdToName=function(e){if(e===a.OperatorId.Isect)return" ";if(e===a.OperatorId.Union)return",";const t=a.operatorStrings[e];return void 0===t?`op:${e}`:t},t.operatorIdToName=function(e,t,r){return t===a.OperatorId.Isect?r:t===a.OperatorId.Union?e.listSeparator:a.operatorStrings[t]};const k=/_/g;function P(){if(null==T){T=[];for(const e of(0,i.numEnumArray)(a.WorksheetFuncId)){const t=(0,a.getWorksheetFuncEnglishName)(e),r=null!=t?t:a.WorksheetFuncId[e].replace(k,".");T[e]=r}}return T}function N(e,t){const r=function(e,t){const r=[];return t.forEach(((e,t)=>{null!=e&&r.push([e,t])})),u.ArrayMapTree.create(e).setValues(r)}(e,t);return{getWorksheetFuncId:e=>r.getValue(e),getWorksheetFuncName(e){const r=t[e];return null==r?(0,o.assertFalse)(`calc.config.getWorksheetFuncName: unknown function ID ${e}`):r}}}let A;t.getEnglishWorksheetFuncIdToName=P,t.createWorksheetFuncNameCallbacks=N,t.createIsThousandsPositionCallback=function(e){if(0===e.length||0===e[0])return()=>!1;if(2===e.length&&0===e[1]){const t=e[0];return e=>e>0&&e%t==0}const t=0===e[e.length-1]&&e.length>=2;return r=>{if(r<=0)return!1;let n=r;for(let t=0;t<e.length&&(n-=e[t],!(n<=0));t+=1);return n>0&&t?n%e[e.length-2]==0:0===n}},t.getEnglishLocaleInfo=function(){return null==A&&(A=function(){const e=P(),r=(0,i.makeStringCompareCI)("en-US"),{getWorksheetFuncId:n,getWorksheetFuncName:o}=N(r,e);return f(n,o,y,F,C,(e=>e>0&&e%3==0),b,E,r,t.englishErrorNames,t.englishSpecialRefNames,"TRUE","FALSE","R","C","{","}","[","]","[","]",".",",",",",";",",",";",v.USA,S.USA,!1,!1,!1,!1,!1,!1,!1,2,!1," ",!1,m.CurrencyFormat.Paren,!0,!1,"$",2,m.DateOrder.MDY,"/","-",!0,!1,!1,!0,":",void 0,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],t.englishPictureSpecial,t.englishPictureSingle,t.englishPictureColor,t.englishPictureDbnum,t.englishSysDateFormat,t.englishSysTimeFormat)}()),A}},96279:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.TimeGranularity=t.TimeDivision=t.dateTime=t.Rounding=t.tzUTC=t.tzData=void 0;const n=r(55843),i=r(15833),o=r(80873);var a;t.tzData=(0,o.typedInstanceCreator)()(((e,t,r,n,i)=>({bias:e,standardDate:t,standardBias:r,daylightDate:n,daylightBias:i}))),t.tzUTC=(0,t.tzData)(0,void 0,0,void 0,0),t.Rounding=n.dtr.Rounding,t.dateTime=n.dtr.dtr,t.TimeDivision=n.dtr.TimeDivision,function(e){e[e.Year=0]="Year",e[e.Day=1]="Day",e[e.Instant=2]="Instant"}(a||(t.TimeGranularity=a={})),t.xlDatepack={fromNum:function(e,t,r){return n.dtr.fromNum(e.mathpack.toNumber(t),r,e.date1904,e.dateCompatibility)},toNum:function(e,t){const r=n.dtr.toNum(t,e.date1904,e.dateCompatibility);return"number"==typeof r?e.mathpack.fromNumber(r):i.numErrorOper},toNumWithDuration:function(e,t,r,o){const a=n.dtr.toNumWithDuration(t,e.date1904,e.dateCompatibility,r,o);return"number"==typeof a?e.mathpack.fromNumber(a):i.numErrorOper},daysPerMonth:n.dtr.daysPerMonth,toDays:function(e,t){return n.dtr.toDays(t,e.date1904,e.dateCompatibility)},toTime:function(e,t,r,i){return n.dtr.toTime(e.mathpack.toNumber(t),r,i)},utcToLocal:function(e,t,r){return n.dtr.utcToLocal(t,r,e.date1904,e.dateCompatibility)}}},1194:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wsfNode=t.operatorNode=t.lambdaNode=t.lambdaParam=t.paramNode=t.paramDefault=t.paramName=t.flattenLambdaArgs=t.letNode=t.letVar=t.varNode=t.indexedArg=t.flattenLetArgs=t.appNode=t.arrayNode=t.literalNode=t.formulaRootAnnotation=t.localNameDeclAnnotation=t.localNameUseAnnotation=t.formulaSpan=t.multiLineComment=t.singleLineComment=t.formula=t.cellRefBad=t.cellRefCol=t.cellRefRow=t.cellRefRange=t.cellRefSingle=t.cellRefError=t.pos=t.badQualifier=t.sheetRangeQualifier=t.identQualifier=t.sheetQualifier=t.documentQualifier=t.relativeQualifier=t.errorQualifier=t.BadType=t.StructRefKind=t.SpecialRefId=t.NamePartKind=t.NodeKind=t.appHeadNameAnnotation=t.AnnotationKind=t.CommentKind=t.PosKind=t.CellRefKind=t.QualifierKind=t.SyntaxFeature=t.RefStyle=void 0,t.getDepthUpperBound=t.badSequenceNode=t.badCharsNode=t.missingNode=t.identNode=t.structRef=t.badRef=t.missingRef=t.thisRowOpRef=t.commaOpRef=t.rangeOpRef=t.columnRef=t.specialRef=t.structRefNode=t.fieldRef=t.fieldRefNode=t.cellRefNode=t.contextNameNode=t.headNamePart=t.flattenNameParts=t.fieldRefNamePart=t.cellRefNamePart=t.identNamePart=t.nameNode=t.parenNode=void 0;const n=r(83387),i=r(80873),o=r(80873);var a,s,l,u,c,d,m,g,p,h,f,S;function v(e){return void 0!==e.kind}function y(e){const t=[];for(const{arg:r,index:i}of e)(0,n.assertIndex)("calc.lang.flattenNumberedArgs: idx",i,e.length),(0,n.assertTrue)("calc.lang.flattenNumberedArgs: repetition",void 0===t[i]),t[i]=r;return t}function F(e,t,r){return y((0,o.safeConcat)([...void 0===t?[]:[t],...r],e.map((({name:e,binder:t})=>[e,t]))))}function C(e,t){return(0,n.assertNatural)("calc.lang.indexedArg: index",t),{arg:e,index:t}}function R(e,t){return{name:e,binder:t}}function b(e,t,r=[]){return y([...e.map((e=>e.name)),...void 0===t?[]:[t],...r])}function E(e){return{name:e}}!function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"}(a||(t.RefStyle=a={})),function(e){e.Comments="Comments",e.Statements="Statements"}(s||(t.SyntaxFeature=s={})),function(e){e.Error="ErrorQualifier",e.Relative="RelativeQualifier",e.Document="DocumentQualifier",e.Sheet="SheetQualifier",e.Ident="IdentQualifier",e.SheetRange="SheetRangeQualifier",e.Bad="BadQualifier"}(l||(t.QualifierKind=l={})),function(e){e.Error="CellRefError",e.Single="CellRefSingle",e.Range="CellRefRange",e.Row="CellRefRow",e.Col="CellRefCol",e.Bad="CellRefBad"}(u||(t.CellRefKind=u={})),function(e){e.Abs="Abs",e.Rel="Rel"}(c||(t.PosKind=c={})),function(e){e.SingleLine="SingleLineComment",e.MultiLine="MultiLineComment"}(d||(t.CommentKind=d={})),function(e){e.LocalNameUse="LocalNameUse",e.LocalNameDecl="LocalNameDecl",e.AppHeadName="AppHeadName",e.FormulaRoot="FormulaRoot"}(m||(t.AnnotationKind=m={})),t.appHeadNameAnnotation={kind:m.AppHeadName},function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Let="Let",e.Lambda="Lambda",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.FieldRef="FieldRef",e.StructRef="StructRef",e.Missing="Missing",e.BadChars="BadChars",e.BadSequence="BadSequence",e.Operator="Operator",e.WSF="WSF",e.Var="Var",e.Param="Param",e.ContextName="ContextName",e.Ident="Ident",e.ParamName="ParamName",e.ParamDef="ParamDef",e.FieldRefRHS="FieldRefRHS",e.StructRefRHS="StructRefRHS"}(g||(t.NodeKind=g={})),function(e){e.IdentNamePart="IdentNamePart",e.CellRefNamePart="CellRefNamePart",e.FieldRefNamePart="FieldRefNamePart"}(p||(t.NamePartKind=p={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(h||(t.SpecialRefId=h={})),function(e){e.SpecialRef="SpecialStructRef",e.ColumnRef="ColumnStructRef",e.RangeOpRef="RangeOpStructRef",e.CommaOpRef="CommaOpStructRef",e.ThisRowOpRef="ThisRowOpStructRef",e.MissingRef="MissingStructRef",e.BadRef="BadStructRef"}(f||(t.StructRefKind=f={})),function(e){e.Unexpected="Unexpected",e.Qualifier="Qualifier",e.NumberLiteral="NumberLiteral",e.StringLiteral="StringLiteral",e.ErrorLiteral="ErrorLiteral",e.FieldName="FieldName",e.ParamName="ParamName",e.StructRef="StructRef",e.FieldRef="FieldRef"}(S||(t.BadType=S={})),t.errorQualifier=function(e=0){return{kind:l.Error,isQuoted:!1,isClosed:!0,isTerminated:!0,label:e}},t.relativeQualifier=function(e=0){return{kind:l.Relative,isQuoted:!1,isClosed:!0,isTerminated:!0,label:e}},t.documentQualifier=function(e,t,r=!1,n=0){return{kind:l.Document,isQuoted:r,isClosed:!0,isTerminated:!0,label:n,document:e,path:t}},t.sheetQualifier=function(e,t,r=!1,n=0){return{kind:l.Sheet,isQuoted:r,isClosed:!0,isTerminated:!0,label:n,sheet:e,document:t}},t.identQualifier=function(e,t=!1,r=0){return{kind:l.Ident,isQuoted:t,isClosed:!0,isTerminated:!0,label:r,name:e}},t.sheetRangeQualifier=function(e,t,r,n=!1,i=0){return{kind:l.SheetRange,isQuoted:n,isClosed:!0,isTerminated:!0,label:i,sheet1:e,sheet2:t,document:r}},t.badQualifier=function(e,t=!1,r=!0,n=!0,i=0){return{kind:l.Bad,isQuoted:t,isClosed:r,isTerminated:n,label:i,chars:e}},t.pos=function(e,t){return{kind:e,index:t}},t.cellRefError=function(e=0){return{kind:u.Error,label:e,isBracketed:!1}},t.cellRefSingle=function(e,t,r=!1,n=0){return{kind:u.Single,label:n,row:e,col:t,isBracketed:r}},t.cellRefRange=function(e,t,r=0){const n=e.isBracketed||t.isBracketed;return{kind:u.Range,label:r,ref1:e,ref2:t,isBracketed:n}},t.cellRefRow=function(e,t,r=!1,n=0){return{kind:u.Row,label:n,row1:e,row2:t,isBracketed:r}},t.cellRefCol=function(e,t,r=!1,n=0){return{kind:u.Col,label:n,col1:e,col2:t,isBracketed:r}},t.cellRefBad=function(e,t=!1,r=0){return{kind:u.Bad,label:r,chars:e,isBracketed:t}},t.formula=function(e,t,r,n){return{node:e,spans:t,annotations:r,depthUpperBound:null!=n?n:P(e)}},t.singleLineComment=function(e,t=0){return{kind:d.SingleLine,label:t,chars:e,isClosed:!0}},t.multiLineComment=function(e,t=!0,r=0){return{kind:d.MultiLine,label:r,chars:e,isClosed:t}},t.formulaSpan=function(e,t,r,i,o,a){return(0,n.assertNatural)("calc.lang.formulaSpan",e),(0,n.assertInteger)("calc.lang.formulaSpan",t),t<e&&(0,n.assertFalse)(`calc.lang.formulaSpan: expected end >= ${e}; given ${t}`),{start:e,end:t,pre:r,post:i,preComments:o,postComments:a}},t.localNameUseAnnotation=function(e,t,r){return{kind:m.LocalNameUse,name:e,whole:t,label:r}},t.localNameDeclAnnotation=function(e,t,r=[]){return{kind:m.LocalNameDecl,name:e,whole:t,uses:r}},t.formulaRootAnnotation=function(e,t){return{kind:m.FormulaRoot,contextNames:e,syntaxFeatures:t}},t.literalNode=function(e,t=!0,r=0){return{kind:g.Literal,label:r,oper:e,isClosed:t}},t.arrayNode=function(e,t=!0,r=0){return{kind:g.Array,label:r,nodes:e,isClosed:t}},t.appNode=function(e,t,r=!0,n=0){return{kind:g.App,label:n,head:e,args:t,isClosed:r}},t.flattenLetArgs=F,t.indexedArg=C,t.varNode=function(e,t=0){return{kind:g.Var,label:t,name:e,wholeName:e.whole}},t.letVar=R,t.letNode=function(e,t,r,n=[],i=!0,o=0){const a=t.map(((e,t)=>{return r=e,Array.isArray(r)?R(C(e[0],2*t),C(e[1],2*t+1)):e;var r})).sort(((e,t)=>e.name.index-t.name.index)),s=void 0!==r&&v(r)?C(r,2*a.length):r,l=F(a,s,n);return{kind:g.Let,label:o,head:e,args:l,isClosed:i,vars:a,body:s,badArgs:n}},t.flattenLambdaArgs=b,t.paramName=function(e,t,r=!0,n=0){return{kind:g.ParamName,label:n,name:e,isBracketed:t,isClosed:r}},t.paramDefault=function(e,t=0){return{kind:g.ParamDef,label:t,rhs:e}},t.paramNode=function(e,t,r=0){return{kind:g.Param,label:r,name:e,wholeName:e.name.kind===g.Ident?e.name.whole:void 0,def:t,isOptional:e.isBracketed||void 0!==t}},t.lambdaParam=E,t.lambdaNode=function(e,t,r,n=[],i=!0,o=0){const a=t.map(((e,t)=>v(e)?E(C(e,t)):e)).sort(((e,t)=>e.name.index-t.name.index)),s=void 0!==r&&v(r)?C(r,a.length):r,l=b(a,s,n);return{kind:g.Lambda,label:o,head:e,args:l,isClosed:i,params:a,body:s,badArgs:n}},t.operatorNode=function(e,t=0){return{kind:g.Operator,label:t,id:e}},t.wsfNode=function(e,t,r=0){return{kind:g.WSF,label:r,id:e,whole:t}},t.parenNode=function(e,t=!0,r=0){return{kind:g.Paren,label:r,node:e,isClosed:t}},t.nameNode=function(e,t,r=0){return{kind:g.Name,label:r,whole:e.asWhole,parts:e,qualifier:t}},t.identNamePart=function(e,t=!0,r=0,n=0){return{kind:p.IdentNamePart,label:r,qualifiedLabel:n,asWhole:e,canDenoteNamedObject:t}},t.cellRefNamePart=function(e,t,r=0,n=0){return{kind:p.CellRefNamePart,label:r,qualifiedLabel:n,asWhole:t,canDenoteNamedObject:!1,ref:e}},t.fieldRefNamePart=function(e,t,r=!0,i=0,o=0){return(0,n.assertTrue)("calc.lang.fieldRefNamePart",t.isClosed&&!t.isBracketed),{kind:p.FieldRefNamePart,label:i,qualifiedLabel:o,asWhole:e.asWhole+"."+(t.field.kind===g.Ident?t.field.whole:t.field.chars),canDenoteNamedObject:r,lhs:e,rhs:t}},t.flattenNameParts=function(e){const t=[e];let r=t[0];for(;r.kind===p.FieldRefNamePart;)t.push(r.lhs),r=r.lhs;return t.reverse(),{kind:r.kind,parts:t}},t.headNamePart=function(e){let t=e;for(;t.kind===p.FieldRefNamePart;)t=t.lhs;return t},t.contextNameNode=function(e,t=0){return{kind:g.ContextName,label:t,whole:e}},t.cellRefNode=function(e,t,r=0){return{kind:g.CellRef,label:r,ref:e,qualifier:t}},t.fieldRefNode=function(e,t,r=0){return{kind:g.FieldRef,label:r,lhs:e,rhs:t}},t.fieldRef=function(e,t=!1,r=!0,n=!1,i=0){return{kind:g.FieldRefRHS,label:i,field:e,isBracketed:t,isClosed:r,shouldBeBracketed:n}},t.structRefNode=function(e,t,r=0){return{kind:g.StructRef,label:r,lhs:e,rhs:t}},t.specialRef=function(e,t=!1,r=!0,n=0){return{kind:f.SpecialRef,label:n,id:e,isBracketed:t,isClosed:r}},t.columnRef=function(e,t=!1,r=!0,n=0){return{kind:f.ColumnRef,label:n,name:e,isBracketed:t,isClosed:r}},t.rangeOpRef=function(e,t,r=0){return{kind:f.RangeOpRef,label:r,lhs:e,rhs:t}},t.commaOpRef=function(e,t=0){const r={[h.All]:!1,[h.Data]:!1,[h.Headers]:!1,[h.Totals]:!1,[h.ThisRow]:!1},n=[];for(const t of e)switch(t.kind){case f.SpecialRef:r[t.id]=!0;break;case f.ColumnRef:case f.RangeOpRef:n.push(t)}return{kind:f.CommaOpRef,label:t,refs:e,specialRefs:r,columnRefs:n}},t.thisRowOpRef=function(e,t=0){return{kind:f.ThisRowOpRef,label:t,ref:e}},t.missingRef=function(e=0){return{kind:f.MissingRef,label:e}},t.badRef=function(e,t=!1,r=!0,n=0){return{kind:f.BadRef,chars:e,isBracketed:t,isClosed:r,label:n}},t.structRef=function(e,t=!0,r=0){return{kind:g.StructRefRHS,label:r,isClosed:t,innerRef:e}},t.identNode=function(e,t=0){return{kind:g.Ident,label:t,whole:e}},t.missingNode=function(e="",t=0){return{kind:g.Missing,label:t,chars:e}},t.badCharsNode=function(e,t,r=0){return{kind:g.BadChars,label:r,type:e,chars:t}},t.badSequenceNode=function(e,t,r=0){return{kind:g.BadSequence,label:r,type:e,contents:t}};const T=50;function k(e,t){if(t>T)return 1/0;switch(e.kind){case g.Array:{let r=0;for(const n of e.nodes)for(const e of n)r=(0,i.fastMax)(r,k(e,t+1));return r+1}case g.Param:return void 0===e.def?1:k(e.def.rhs,t+1)+1;case g.Let:case g.Lambda:case g.App:{let r=k(e.head,t+1);for(const n of e.args)r=(0,i.fastMax)(r,k(n,t+1));return r+1}case g.Paren:return k(e.node,t+1)+1;case g.FieldRef:return k(e.lhs,t+1)+1;case g.Var:case g.Name:case g.CellRef:case g.StructRef:case g.Literal:case g.Operator:case g.WSF:case g.Missing:case g.BadChars:return 1;case g.BadSequence:{let r=0;for(const n of e.contents)r=(0,i.fastMax)(r,k(n,t+1));return r+1}default:return(0,n.assertNever)("calc.lang.getDepthUpperBound",e)}}function P(e){return k(e,0)}t.getDepthUpperBound=P},87673:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isIdentContinue=t.isIdentStart=void 0;var n=r(57777).unicode.makeIsInClass;t.isIdentStart=n([65,91,92,93,95,96,97,123,161,162,164,165,167,169,170,171,173,174,175,187,188,697,699,706,711,712,713,716,717,718,720,722,728,732,733,734,736,741,750,751,880,884,886,888,890,894,902,903,904,907,908,909,910,930,931,1014,1015,1154,1162,1316,1329,1367,1369,1370,1377,1416,1488,1515,1520,1523,1569,1611,1646,1648,1649,1748,1749,1750,1765,1767,1774,1776,1786,1789,1791,1792,1808,1809,1810,1840,1869,1958,1969,1970,1994,2027,2036,2038,2042,2043,2308,2362,2365,2366,2384,2385,2392,2402,2417,2419,2427,2432,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2493,2494,2510,2511,2524,2526,2527,2530,2544,2546,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2649,2653,2654,2655,2674,2677,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2749,2750,2768,2769,2784,2786,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2877,2878,2908,2910,2911,2914,2929,2930,2947,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3024,3025,3077,3085,3086,3089,3090,3113,3114,3124,3125,3130,3133,3134,3160,3162,3168,3170,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3261,3262,3294,3295,3296,3298,3333,3341,3342,3345,3346,3369,3370,3386,3389,3390,3424,3426,3450,3456,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3585,3643,3648,3663,3713,3715,3716,3717,3719,3721,3722,3723,3725,3726,3732,3736,3737,3744,3745,3748,3749,3750,3751,3752,3754,3756,3757,3761,3762,3764,3773,3774,3776,3781,3782,3783,3804,3806,3840,3841,3904,3912,3913,3949,3976,3980,4096,4139,4159,4160,4176,4182,4186,4190,4193,4194,4197,4199,4206,4209,4213,4226,4238,4239,4256,4294,4304,4347,4348,4349,4352,4442,4447,4515,4520,4602,4608,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4992,5008,5024,5109,5121,5741,5743,5751,5761,5787,5792,5867,5870,5873,5888,5901,5902,5906,5920,5938,5952,5970,5984,5997,5998,6001,6016,6068,6103,6104,6108,6109,6176,6264,6272,6313,6314,6315,6400,6429,6480,6510,6512,6517,6528,6570,6593,6600,6656,6679,6917,6964,6981,6988,7043,7073,7086,7088,7168,7204,7245,7248,7258,7294,7424,7616,7680,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8125,8126,8127,8130,8133,8134,8141,8144,8148,8150,8156,8160,8173,8178,8181,8182,8189,8208,8209,8211,8215,8216,8218,8220,8222,8224,8226,8229,8232,8240,8241,8242,8244,8245,8246,8251,8252,8305,8306,8308,8309,8319,8320,8321,8325,8336,8341,8450,8452,8453,8454,8455,8456,8457,8468,8469,8471,8473,8478,8481,8483,8484,8485,8486,8487,8488,8489,8490,8494,8495,8506,8508,8512,8517,8522,8526,8527,8531,8533,8539,8543,8544,8585,8592,8602,8658,8659,8660,8661,8704,8705,8706,8708,8711,8713,8715,8716,8719,8720,8721,8722,8725,8726,8730,8731,8733,8737,8739,8740,8741,8742,8743,8749,8750,8751,8756,8760,8764,8766,8776,8777,8780,8781,8786,8787,8800,8802,8804,8808,8810,8812,8814,8816,8834,8836,8838,8840,8853,8854,8857,8858,8869,8870,8895,8896,8978,8979,9312,9398,9424,9450,9472,9548,9552,9589,9601,9616,9618,9622,9632,9634,9635,9642,9650,9652,9654,9656,9660,9662,9664,9666,9670,9673,9675,9676,9678,9682,9698,9702,9711,9712,9733,9735,9737,9738,9742,9744,9756,9757,9758,9759,9792,9793,9794,9795,9824,9826,9827,9830,9831,9835,9836,9838,9839,9840,11264,11311,11312,11359,11360,11376,11377,11390,11392,11493,11520,11558,11568,11622,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,12288,12292,12293,12312,12317,12320,12321,12330,12337,12342,12344,12349,12353,12439,12443,12448,12449,12544,12549,12590,12593,12687,12704,12728,12784,12829,12832,12842,12849,12851,12857,12858,12896,12924,12927,12928,12963,12969,13059,13060,13069,13070,13076,13077,13080,13081,13090,13092,13094,13096,13099,13100,13110,13111,13115,13116,13129,13131,13133,13134,13137,13138,13143,13144,13179,13183,13184,13189,13192,13259,13261,13268,13269,13271,13272,13273,13275,13278,13312,19894,19968,40900,40960,42125,42240,42509,42512,42528,42538,42540,42560,42592,42594,42607,42624,42648,42786,42888,42891,42893,43003,43010,43011,43014,43015,43019,43020,43043,43072,43124,43138,43188,43274,43302,43312,43335,43520,43561,43584,43587,43588,43596,44032,55204,57344,63561,63744,64046,64048,64107,64112,64218,64256,64263,64275,64280,64285,64286,64287,64297,64298,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65020,65072,65074,65075,65093,65097,65107,65108,65112,65113,65127,65128,65132,65136,65141,65142,65277,65281,65375,65377,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511]),t.isIdentContinue=n([48,58,63,64,65,91,92,93,95,96,97,123,161,162,164,165,167,169,170,171,173,174,175,187,188,888,890,894,900,903,904,907,908,909,910,930,931,1316,1329,1367,1369,1370,1377,1416,1425,1470,1471,1472,1473,1475,1476,1478,1479,1480,1488,1515,1520,1523,1536,1540,1542,1545,1547,1548,1550,1563,1567,1568,1569,1631,1632,1642,1646,1748,1749,1792,1807,1867,1869,1970,1984,2039,2042,2043,2305,2362,2364,2382,2384,2389,2392,2404,2406,2416,2417,2419,2427,2432,2433,2436,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2492,2501,2503,2505,2507,2511,2519,2520,2524,2526,2527,2532,2534,2555,2561,2564,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2620,2621,2622,2627,2631,2633,2635,2638,2641,2642,2649,2653,2654,2655,2662,2678,2689,2692,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2748,2758,2759,2762,2763,2766,2768,2769,2784,2788,2790,2800,2801,2802,2817,2820,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2876,2885,2887,2889,2891,2894,2902,2904,2908,2910,2911,2916,2918,2930,2946,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3006,3011,3014,3017,3018,3022,3024,3025,3031,3032,3046,3067,3073,3076,3077,3085,3086,3089,3090,3113,3114,3124,3125,3130,3133,3141,3142,3145,3146,3150,3157,3159,3160,3162,3168,3172,3174,3184,3192,3200,3202,3204,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3260,3269,3270,3273,3274,3278,3285,3287,3294,3295,3296,3300,3302,3312,3313,3315,3330,3332,3333,3341,3342,3345,3346,3369,3370,3386,3389,3397,3398,3401,3402,3406,3415,3416,3424,3428,3430,3446,3449,3456,3458,3460,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3530,3531,3535,3541,3542,3543,3544,3552,3570,3572,3585,3643,3647,3663,3664,3674,3713,3715,3716,3717,3719,3721,3722,3723,3725,3726,3732,3736,3737,3744,3745,3748,3749,3750,3751,3752,3754,3756,3757,3770,3771,3774,3776,3781,3782,3783,3784,3790,3792,3802,3804,3806,3840,3844,3859,3898,3902,3912,3913,3949,3953,3973,3974,3980,3984,3992,3993,4029,4030,4045,4046,4048,4096,4170,4176,4250,4254,4294,4304,4347,4348,4349,4352,4442,4447,4515,4520,4602,4608,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4959,4961,4969,4989,4992,5018,5024,5109,5121,5741,5743,5751,5760,5787,5792,5867,5870,5873,5888,5901,5902,5909,5920,5941,5952,5972,5984,5997,5998,6001,6002,6004,6016,6100,6103,6104,6107,6110,6112,6122,6128,6138,6155,6159,6160,6170,6176,6264,6272,6315,6400,6429,6432,6444,6448,6460,6464,6465,6470,6510,6512,6517,6528,6570,6576,6602,6608,6618,6624,6684,6912,6988,6992,7002,7009,7037,7040,7083,7086,7098,7168,7224,7232,7242,7245,7294,7424,7655,7678,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8133,8134,8148,8150,8156,8157,8176,8178,8181,8182,8191,8192,8209,8211,8215,8216,8218,8220,8222,8224,8226,8229,8241,8242,8244,8245,8246,8251,8252,8260,8261,8274,8275,8287,8293,8298,8306,8308,8317,8319,8333,8336,8341,8352,8374,8400,8433,8448,8528,8531,8585,8592,9001,9003,9192,9216,9255,9280,9291,9312,9886,9888,9917,9920,9924,9985,9989,9990,9994,9996,10024,10025,10060,10061,10062,10063,10067,10070,10071,10072,10079,10081,10088,10102,10133,10136,10160,10161,10175,10176,10181,10183,10187,10188,10189,10192,10214,10224,10627,10649,10712,10716,10748,10750,11085,11088,11093,11264,11311,11312,11359,11360,11376,11377,11390,11392,11499,11517,11518,11520,11558,11568,11622,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,11744,11776,11823,11824,11904,11930,11931,12020,12032,12246,12272,12284,12288,12312,12317,12336,12337,12349,12350,12352,12353,12439,12441,12448,12449,12544,12549,12590,12593,12687,12688,12728,12736,12772,12784,12831,12832,12868,12880,13055,13056,19894,19904,40900,40960,42125,42128,42183,42240,42509,42512,42540,42560,42592,42594,42611,42620,42622,42623,42648,42752,42893,43003,43052,43072,43124,43136,43205,43216,43226,43264,43311,43312,43348,43520,43575,43584,43598,43600,43610,44032,55204,57344,64046,64048,64107,64112,64218,64256,64263,64275,64280,64285,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65022,65024,65040,65056,65063,65072,65074,65075,65093,65097,65107,65108,65112,65113,65127,65128,65132,65136,65141,65142,65277,65279,65280,65281,65375,65377,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511,65512,65519,65529,65534])},50175:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.worksheetFuncTypes=t.worksheetFuncEnglishNames=t.WorksheetFuncId=void 0;const n=r(36745);var i;!function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e._FV=612]="_FV",e[e.FIELDVALUE=613]="FIELDVALUE",e[e.FILTER=614]="FILTER",e[e.SORT=615]="SORT",e[e.UNIQUE=616]="UNIQUE",e[e.RICHSEARCH=617]="RICHSEARCH",e[e.LARGEPROPERTY=618]="LARGEPROPERTY",e[e.SMALLPROPERTY=619]="SMALLPROPERTY",e[e.AVERAGEPROPERTY=620]="AVERAGEPROPERTY",e[e.FINDN=621]="FINDN",e[e.TEXTSLICE=622]="TEXTSLICE",e[e.TEXTBEFORE=623]="TEXTBEFORE",e[e.TEXTAFTER=624]="TEXTAFTER",e[e.TEXTSPLIT=625]="TEXTSPLIT",e[e._SORT=626]="_SORT",e[e._ONEDARRAY=627]="_ONEDARRAY",e[e.XMATCH=628]="XMATCH",e[e.XLOOKUP=629]="XLOOKUP",e[e.SORTBY=630]="SORTBY",e[e.RANDARRAY=631]="RANDARRAY",e[e.SEQUENCE=632]="SEQUENCE",e[e.STOCKHISTORY=633]="STOCKHISTORY",e[e.WRAPROWS=634]="WRAPROWS",e[e.VSTACK=635]="VSTACK",e[e.HSTACK=636]="HSTACK",e[e.CHOOSEROWS=637]="CHOOSEROWS",e[e.CHOOSECOLS=638]="CHOOSECOLS",e[e.LET=639]="LET",e[e.LAMBDA=640]="LAMBDA",e[e.MAKEARRAY=641]="MAKEARRAY",e[e.APPLY=642]="APPLY",e[e.ISLAMBDA=643]="ISLAMBDA",e[e.ARITY=644]="ARITY",e[e.RECURSE=645]="RECURSE",e[e.PERCENTOF=646]="PERCENTOF",e[e.VALUETOTEXT=647]="VALUETOTEXT",e[e.ARRAYTOTEXT=648]="ARRAYTOTEXT",e[e.FORMATTEDNUMBER=649]="FORMATTEDNUMBER",e[e.TOCOL=650]="TOCOL",e[e.TOROW=651]="TOROW",e[e.WRAPCOLS=652]="WRAPCOLS",e[e.MAP=653]="MAP",e[e.REDUCE=654]="REDUCE",e[e.SCAN=655]="SCAN",e[e.BYROW=656]="BYROW",e[e.BYCOL=657]="BYCOL",e[e.ISOMITTED=658]="ISOMITTED",e[e.EXPAND=659]="EXPAND",e[e.TAKE=660]="TAKE",e[e.DROP=661]="DROP",e[e.PY=662]="PY",e[e.IMAGE=664]="IMAGE",e[e.UNIT=665]="UNIT",e[e.GROUPBY=666]="GROUPBY",e[e.PIVOTBY=667]="PIVOTBY",e[e.PQSOURCE=668]="PQSOURCE",e[e.PYTHON_STR=669]="PYTHON_STR",e[e.PYTHON_TYPE=670]="PYTHON_TYPE",e[e.PYTHON_TYPENAME=671]="PYTHON_TYPENAME",e[e._FF=672]="_FF",e[e.FIELDFUNCTION=673]="FIELDFUNCTION",e[e.TRANSLATE=674]="TRANSLATE",e[e.DETECTLANGUAGE=675]="DETECTLANGUAGE",e[e.SUPPORTEDLANGUAGES=676]="SUPPORTEDLANGUAGES",e[e.REGEXTEST=677]="REGEXTEST",e[e.REGEXREPLACE=678]="REGEXREPLACE",e[e.REGEXEXTRACT=679]="REGEXEXTRACT",e[e.TESTFUNCTIONBEGIN=680]="TESTFUNCTIONBEGIN",e[e.GRF=681]="GRF",e[e.RICHERROR=682]="RICHERROR",e[e.COUNTER=683]="COUNTER",e[e.BROKENRECORD=684]="BROKENRECORD",e[e.STREAM=685]="STREAM",e[e.GETRICHERRORS=686]="GETRICHERRORS",e[e.DBGSTAT=687]="DBGSTAT",e[e.RICHNUMBER=688]="RICHNUMBER",e[e.RICHERNUMBER=689]="RICHERNUMBER",e[e.DBGWRITE=690]="DBGWRITE",e[e.TEST=691]="TEST",e[e.AAC=692]="AAC",e[e.AWC=693]="AWC",e[e.PARSEDEXPRESSION=694]="PARSEDEXPRESSION",e[e.AGE_CONTACTTEST=695]="AGE_CONTACTTEST",e[e.FIRSTNAME_CONTACTTEST=696]="FIRSTNAME_CONTACTTEST",e[e.FULLNAME_CONTACTTEST=697]="FULLNAME_CONTACTTEST",e[e.LASTNAME_CONTACTTEST=698]="LASTNAME_CONTACTTEST",e[e.TRANSLATENAME_CONTACTTEST=699]="TRANSLATENAME_CONTACTTEST",e[e.ARRAYVALUE=700]="ARRAYVALUE",e[e.RECORD=701]="RECORD",e[e.DISPLAYSTRING_GENERALTEST=702]="DISPLAYSTRING_GENERALTEST",e[e.LAMBDADOC=703]="LAMBDADOC",e[e.REFIDENTITY=704]="REFIDENTITY",e[e.GROUPBY2=705]="GROUPBY2",e[e.PIVOTBY2=706]="PIVOTBY2",e[e.PQEVALUATE=707]="PQEVALUATE",e[e.LETREC=750]="LETREC",e[e.NESTEDRECORD=751]="NESTEDRECORD"}(i||(t.WorksheetFuncId=i={})),t.worksheetFuncEnglishNames=[[255,"255"],[268,"GET.WORKBOOK"],[349,"OPTIONS.LISTS.GET"],[355,"OPEN.DIALOG"],[356,"SAVE.DIALOG"],[360,"PHONETIC"],[369,"THAIDAYOFWEEK"],[371,"THAIMONTHOFYEAR"],[612,"_FV"],[626,"_SORT"],[627,"_ONEDARRAY"],[669,"PYTHON_STR"],[670,"PYTHON_TYPE"],[671,"PYTHON_TYPENAME"],[672,"_FF"],[695,"AGE_CONTACTTEST"],[696,"FIRSTNAME_CONTACTTEST"],[697,"FULLNAME_CONTACTTEST"],[698,"LASTNAME_CONTACTTEST"],[699,"TRANSLATENAME_CONTACTTEST"],[702,"DISPLAYSTRING_GENERALTEST"]].reduce(((e,t)=>(e[t[0]]=t[1],e)),[]);const o=[];t.worksheetFuncTypes=[[1,255,o,[57],o,1,0,32],[1,3,[36,831,831],o,o,823,0,64],[1,1,[271],o,o,4,0,64],[1,1,[271],o,o,4,0,64],[1,255,o,[305],o,1,0,32],[1,255,o,[49],o,1,0,32],[1,255,o,[49],o,1,0,32],[1,255,o,[49],o,1,0,32],[0,1,[16],o,o,33,0,0],[0,1,[16],o,o,33,0,0],[0,0,o,o,o,3,0,32],[2,255,[1],[49],o,1,0,32],[1,255,o,[49],o,1,0,32],[1,2,[1,1],o,o,2,0,64],[1,3,[1,65,4],o,o,2,0,64],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[0,0,o,o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,3,[263,48,48],o,o,263,0,0],[2,4,[48,1,1,1],o,o,311,0,0],[2,2,[2,1],o,o,2,0,64],[3,3,[2,1,1],o,o,2,0,64],[1,1,[2],o,o,1,0,64],[1,1,[7],o,o,1,0,64],[0,0,o,o,o,4,0,32],[0,0,o,o,o,4,0,32],[1,255,o,[52],o,4,0,32],[1,255,o,[52],o,4,0,32],[1,1,[4],o,o,4,0,32],[2,2,[1,1],o,o,1,0,0],[3,3,[16,83,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[1,255,o,[49],o,1,0,32],[3,3,[16,19,18],o,o,1,0,0],[2,2,[263,2],o,o,2,0,64],[1,4,[48,112,84,84],o,o,32,0,0],[1,4,[48,112,112,84],o,o,32,0,0],[1,4,[48,112,84,84],o,o,32,0,0],[1,4,[48,112,112,84],o,o,32,0,0],[1,1,[16],o,o,512,0,2],[0,1,[4],o,o,512,0,2],[0,1,[575],o,o,512,0,2],[3,5,[1,1,1,1,1],o,o,1,0,0],[3,5,[1,1,1,1,1],o,o,1,0,0],[3,5,[1,1,1,1,1],o,o,1,0,0],[3,5,[1,1,1,1,1],o,o,1,0,0],[3,6,[1,1,1,1,1,1],o,o,1,0,0],[3,3,[48,1,1],o,o,1,0,32],[1,2,[48,1],o,o,1,0,0],[0,0,o,o,o,1,16383,0],[2,3,[263,305,17],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,2,[1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[0,0,o,o,o,1,16383,0],[1,1,[16],o,o,1,0,0],[1,1,[48],o,o,1,0,0],[1,1,[48],o,o,1,0,0],[3,5,[16,65,65,65,65],o,o,16,16383,0],[2,2,[2,16],o,o,16,0,2],[2,2,[16,16],o,o,2,0,2],[0,3,[66,81,16],o,o,4,0,2],[2,3,[2,2,1],o,o,1,0,64],[1,1,[39],o,o,32,0,0],[0,2,[1,24],o,o,4,0,2],[0,0,o,o,o,4,0,2],[1,1,[303],o,o,1,0,0],[0,1,[4],o,o,4,0,2],[1,2,[2,63],o,o,4,0,2],[0,0,o,o,o,50,0,2],[1,1,[16],o,o,47,0,2],[0,2,[65,66],o,o,32,0,2],[4,5,[87,117,117,1,117],o,o,4,0,4],[0,2,[1,66],o,o,32,0,2],[0,0,o,o,o,16,0,2],[0,0,o,o,o,16,0,2],[0,1,[1],o,o,4,0,2],[2,2,[1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[2,255,[33],[831],o,823,0,0],[3,4,[263,49,49,4],o,o,295,0,0],[3,4,[263,49,49,4],o,o,295,0,0],[0,2,[66,65],o,o,32,0,2],[1,7,[2,65,66,67,65,65,2],o,o,575,0,2],[1,1,[63],o,o,4,0,64],[1,1,[18],o,o,2,0,2],[1,2,[2,4],o,o,6,0,2],[2,2,[16,47],o,o,4,0,2],[1,2,[1,1],o,o,1,0,0],[1,4,[2,1,4,4],o,o,7,0,2],[1,1,[1],o,o,2,0,64],[1,1,[2],o,o,2,0,64],[1,1,[2],o,o,2,0,64],[1,1,[2],o,o,2,0,64],[1,2,[2,9],o,o,2,0,64],[1,2,[2,9],o,o,2,0,64],[2,2,[258,258],o,o,4,0,64],[1,1,[2],o,o,2,0,64],[4,4,[2,1,1,2],o,o,2,0,64],[3,4,[2,2,2,2],o,o,2,0,64],[1,1,[2],o,o,1,0,0],[0,3,[66,65,66],o,o,32,0,2],[0,1,[2],o,o,2,0,2],[2,3,[2,2,1],o,o,1,0,64],[1,2,[2,16],o,o,303,16383,0],[1,1,[271],o,o,4,0,64],[1,1,[399],o,o,4,0,64],[1,1,[399],o,o,4,0,64],[1,1,[399],o,o,4,0,64],[1,1,[23],o,o,2,0,0],[1,1,[23],o,o,1,0,0],[1,2,[2,1],o,o,1,0,2],[1,1,[1],o,o,1,0,2],[1,1,[1],o,o,1,0,2],[1,1,[1],o,o,2,0,2],[2,2,[1,1],o,o,2,0,2],[2,2,[1,2],o,o,1,0,2],[2,2,[1,2],o,o,1,0,2],[1,2,[1,1],o,o,1,0,2],[1,1,[3],o,o,1,0,64],[1,1,[3],o,o,1,0,64],[3,3,[1,1,1],o,o,1,0,0],[4,4,[1,1,1,1],o,o,1,0,0],[4,5,[1,1,1,1,1],o,o,1,0,0],[1,3,[2,66,65],o,o,2,0,2],[1,2,[16,4],o,o,2,0,2],[1,2,[2,4],o,o,16,0,2],[1,2,[2,4],o,o,16,16383,0],[1,255,[2,3,66,66,66,65,67,66,67],[66],o,3,0,2],[1,255,[3],[127],o,575,0,2],[0,1,[3],o,o,1,0,2],[2,4,[3,115,83,3],o,o,1,0,2],[3,5,[3,83,115,83,3],o,o,1,0,2],[4,5,[3,3,3,4,3],o,o,4,0,2],[4,5,[3,3,3,4,3],o,o,4,0,2],[4,5,[3,3,3,3,3],o,o,4,0,2],[0,1,[3],o,o,4,0,2],[2,3,[3,3,3],o,o,4,0,2],[3,4,[3,3,3,3],o,o,4,0,2],[1,3,[1,67,66],o,o,1,0,2],[1,1,[52],o,o,36,0,2],[1,1,[2],o,o,2,0,64],[1,1,[32],o,o,1,0,0],[1,1,[32],o,o,32,0,0],[2,2,[32,32],o,o,32,0,0],[0,2,[2,2],o,o,32,0,2],[4,6,[1,1,1,1,1,1],o,o,1,0,0],[4,6,[1,1,1,1,1,1],o,o,1,0,0],[1,255,o,[121],o,1,0,32],[0,2,[1,16],o,o,4,0,2],[3,4,[2,1,1,1],o,o,512,0,2],[1,1,[4],o,o,512,0,2],[0,0,o,o,o,512,0,2],[0,0,o,o,o,512,0,2],[2,2,[2,2],o,o,1,0,2],[2,2,[1,2],o,o,32,0,2],[3,3,[1,18,18],o,o,4,0,2],[2,2,[1,2],o,o,4,0,2],[1,1,[1],o,o,4,0,2],[0,1,[1],o,o,512,0,2],[0,1,[2],o,o,4,0,2],[0,4,[3,3,3,3],o,o,3,0,2],[1,255,o,[113],o,1,0,32],[1,1,[1],o,o,1,0,0],[1,2,[1,16],o,o,47,0,2],[1,1,[1],o,o,47,0,2],[1,2,[1,2],o,o,47,0,2],[1,2,[1,2],o,o,63,0,2],[3,3,[16,19,18],o,o,1,0,0],[1,1,[143],o,o,4,0,64],[0,3,[82,65,65],o,o,2,0,2],[0,4,[66,82,17,17],o,o,1,0,2],[1,255,o,[49],o,1,0,32],[1,255,o,[49],o,1,0,32],[3,3,[16,19,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[1,2,[1,1],o,o,1,0,0],[1,1,[143],o,o,4,0,64],[3,3,[16,83,18],o,o,1,0,0],[1,1,[3],o,o,4,0,2],[1,1,[3],o,o,4,0,2],void 0,void 0,[1,2,[1,1],o,o,2,0,192],[2,3,[2,2,1],o,o,1,0,192],[2,3,[2,2,1],o,o,1,0,192],[4,4,[2,1,1,2],o,o,2,0,192],[1,2,[2,9],o,o,2,0,192],[1,2,[2,9],o,o,2,0,192],[3,3,[2,1,1],o,o,2,0,192],[1,1,[2],o,o,1,0,192],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[1,1,[2],o,o,2,0,192],[1,1,[2],o,o,2,0,192],[2,3,[1,16,4],o,o,1,0,32],void 0,void 0,[2,5,[1,65,65,68,66],o,o,2,0,0],[2,3,[1,1,4],o,o,1,0,0],[0,0,o,o,o,1,16383,0],[5,7,[1,1,1,1,1,1,4],o,o,1,0,0],[0,0,o,o,o,512,0,2],[1,1,[12],o,o,512,0,2],[0,0,o,o,o,512,0,2],[1,3,[2,82,84],o,o,512,0,2],[1,255,o,[49],o,1,0,32],[1,255,o,[32],o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,3,[16,19,18],o,o,263,0,0],[2,11,[1,18,17,17,18,17,17,115,84,21,17],o,o,2,0,2],[0,1,[4],o,o,4,0,2],[0,0,o,o,o,16,0,2],[0,2,[2,2],o,o,4,0,2],[0,3,[2,2,2],o,o,4,0,2],[2,5,[2,23,23,23,23],o,o,2,0,66],[2,4,[2,1,1,2],o,o,1,0,2],[1,4,[2,66,65,65],o,o,1,0,2],[1,1,[2],o,o,3,16383,0],[0,0,o,o,o,2,0,2],[1,5,[1,2,1,1,1],o,o,47,0,2],[4,5,[1,1,1,1,1],o,o,1,0,0],[0,1,[4],o,o,512,0,2],void 0,void 0,[0,1,[1],o,o,512,0,2],[2,2,[48,48],o,o,32,0,32],[0,2,[66,96],o,o,2,0,2],[1,1,[2],o,o,4,0,2],[1,255,[17],[127],o,575,0,192],[1,1,[3],o,o,4,0,2],[1,1,[2],o,o,63,0,2],[1,2,[1,3],o,o,47,0,2],[1,3,[1,3,1],o,o,47,0,2],[1,3,[2,66,4],o,o,4,0,2],[1,1,[15],o,o,1,0,0],[0,1,[2],o,o,4,0,2],[0,1,[2],o,o,4,0,2],[0,2,[99,66],o,o,4,0,2],[3,3,[3,1,4],o,o,4,0,2],[3,3,[3,1,4],o,o,4,0,2],[2,3,[2,3,66],o,o,1,0,2],[1,2,[1,2],o,o,35,0,2],[1,255,o,[49],o,1,0,32],[3,5,[1,1,1,65,65],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,5,[1,1,1,65,65],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,3,[1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[4,4,[1,1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[3,3,[1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[3,3,[1,32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[4,4,[32,32,1,1],o,o,1,0,0],[3,4,[32,32,1,65],o,o,1,0,0],[1,255,o,[49],o,1,0,32],[1,255,o,[49],o,1,0,32],[1,255,o,[49],o,1,0,32],[1,255,o,[49],o,1,0,32],[1,255,o,[49],o,1,0,32],[1,255,o,[49],o,1,0,32],[2,3,[49,1,1],o,o,1,0,32],[2,2,[49,1],o,o,1,0,32],[2,2,[49,1],o,o,1,0,32],[2,2,[49,1],o,o,1,0,32],[2,2,[49,1],o,o,1,0,32],[2,3,[49,1,65],o,o,1,0,32],[1,255,o,[32],o,1,0,32],[2,2,[49,1],o,o,1,0,32],[2,2,[1,1],o,o,1,0,0],void 0,[3,4,[2,1,1,1],o,o,1,0,130],[2,3,[2,1,1],o,o,1,0,130],[1,255,o,[2],o,2,0,64],[2,2,[1,1],o,o,1,0,0],[2,9,[66,2,66,65,65,65,66,66,66],o,o,2,0,2],[1,2,[1,2],o,o,35,0,2],[1,3,[1,66,2],o,o,35,0,2],[1,4,[1,66,66,2],o,o,7,0,2],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[2,255,[1],[16],o,1,0,0],[2,3,[16,15,16],o,o,1,0,64],[2,2,[16,15],o,o,1,0,64],[1,1,[16],o,o,1,0,0],[1,2,[1,2],o,o,19,0,2],[1,1,[33],o,o,33,0,2],[4,4,[1,1,1,1],o,o,1,0,0],[3,3,[1,1,2],o,o,1,0,128],[1,1,[1],o,o,2,0,192],[2,2,[1,1],o,o,2,0,192],[1,2,[1,5],o,o,2,0,0],[0,4,[66,66,66,65],o,o,6,0,2],[0,5,[66,66,66,66,65],o,o,6,0,2],[1,2,[1,2],o,o,19,0,2],[2,255,[18,18],[2,79],o,15,0,0],[1,2,[2,39],o,o,39,0,0],[1,1,[16],o,o,2,0,128],[1,255,o,[49],o,1,0,32],[1,255,o,[49],o,1,0,32],[1,255,o,[49],o,1,0,32],[1,255,o,[49],o,1,0,32],[1,255,o,[49],o,1,0,32],[1,255,o,[49],o,1,0,32],[1,255,o,[49],o,1,0,32],[1,1,[1],o,o,2,0,64],[1,1,[1],o,o,2,0,192],[1,1,[3],o,o,2,0,192],[1,1,[1],o,o,2,0,192],[1,1,[1],o,o,2,0,192],[1,1,[1],o,o,2,0,192],[1,1,[2],o,o,1,0,192],[1,1,[2],o,o,4,0,192],[1,1,[1],o,o,1,0,192],[1,1,[1],o,o,1,0,192],[1,1,[1],o,o,1,0,192],[3,255,o,[2],o,2,0,0],[1,255,[2],[50],o,15,0,0],[2,3,[2,50,2],o,o,10,0,0],[3,3,[2,2,2],o,o,15,0,0],[3,4,[2,2,1,2],o,o,10,0,0],[1,2,[95,95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,3,[95,95,95],o,o,9,0,0],[1,255,o,[127],o,9,0,0],[1,255,o,[127],o,9,0,0],[4,4,[95,95,95,127],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,3,[127,127,95],o,o,9,0,0],[3,3,[95,127,127],o,o,9,0,0],[5,6,[95,95,95,95,95,95],o,o,9,0,0],[5,6,[95,95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[3,3,[95,95,95],o,o,9,0,0],[3,3,[95,95,95],o,o,9,0,0],[3,3,[95,95,95],o,o,9,0,0],[6,7,[95,95,95,95,95,95,95],o,o,9,0,0],[6,7,[95,95,95,95,95,95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[6,6,[95,95,95,95,95,95],o,o,9,0,0],[6,6,[95,95,95,95,95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,3,[95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[5,6,[95,95,95,95,95,95],o,o,9,0,0],[5,6,[95,95,95,95,95,95],o,o,9,0,0],[7,8,[95,95,95,95,95,95,95,95],o,o,9,0,0],[7,8,[95,95,95,95,95,95,95,95],o,o,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],o,o,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,16383,0],[1,2,[95,95],o,o,9,0,0],[6,7,[95,95,95,95,95,95,95],o,o,9,0,128],[6,7,[95,95,95,95,95,95,95],o,o,9,0,0],[3,3,[95,95,95],o,o,9,0,0],[6,8,[95,95,95,95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[2,3,[95,95,127],o,o,9,0,0],[2,3,[95,95,127],o,o,9,0,0],[1,255,o,[127],o,9,0,0],[1,255,o,[127],o,9,0,0],[1,255,o,[127],o,9,0,0],[2,2,[95,127],o,o,9,0,0],[3,4,[2,2,1,2],o,o,10,0,0],[2,5,[2,50,2,1,2],o,o,10,0,64],[1,1,[2],o,o,9,0,0],[2,2,[47,575],o,o,303,0,0],[2,255,o,[16,15],o,1,0,64],[3,255,[16],[16,15],o,1,0,64],[2,3,[16,15,16],o,o,1,0,64],[3,255,[16],[16,15],o,1,0,64],[3,254,[1,1,48,17],[16],o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[3,3,[1,1,4],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,254,o,[32],o,32,0,32],[1,254,o,[32],o,1,0,32],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[2,2,[49,1],o,o,1,0,32],[2,2,[49,1],o,o,1,0,32],[2,3,[49,1,65],o,o,1,0,32],[2,3,[49,1,65],o,o,1,0,32],[3,3,[1,1,4],o,o,1,0,0],[2,2,[49,1],o,o,1,0,32],[2,2,[49,1],o,o,1,0,32],[2,3,[1,16,4],o,o,1,0,32],[2,3,[1,16,4],o,o,1,0,32],[1,254,o,[49],o,1,0,32],[1,254,o,[49],o,1,0,32],[3,3,[1,1,4],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[1,254,o,[49],o,1,0,32],[1,254,o,[49],o,1,0,32],[4,4,[1,1,1,4],o,o,1,0,0],[2,4,[95,95,75,127],o,o,9,0,0],[2,4,[95,95,75,127],o,o,9,0,0],[2,2,[1,1],o,o,1,0,128],[1,2,[1,65],o,o,1,0,128],void 0,[4,6,[1,1,1,4,65,65],o,o,1,0,0],[3,5,[1,1,1,65,65],o,o,1,0,0],[3,3,[1,1,4],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[5,5,[1,1,1,1,4],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[2,2,[1,4],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[4,4,[32,32,1,1],o,o,1,0,0],[2,3,[49,1,1],o,o,1,0,32],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[1],o,o,1,0,0],[1,2,[1,65],o,o,1,0,128],[1,2,[1,65],o,o,1,0,128],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[1,254,o,[52],o,4,0,32],[3,3,[1,1,1],o,o,1,0,0],[2,3,[1,1,65],o,o,2,0,0],[2,2,[2,1],o,o,1,0,0],[2,2,[3,3],o,o,1,0,64],[3,4,[1,1,1,65],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,254,o,[49],o,1,0,32],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,2,0,0],[1,1,[2],o,o,1,0,0],[1,1,[1],o,o,32,0,0],[1,1,[2],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,3,[2,66,66],o,o,1,0,0],[0,1,[50],o,o,1,16383,32],[0,1,[48],o,o,1,16383,32],[1,1,[16],o,o,2,16383,0],[1,1,[16],o,o,4,0,0],[2,2,[47,575],o,o,303,0,0],[1,3,[1,65,65],o,o,1,0,0],[1,3,[1,65,65],o,o,1,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,2,[2,2],o,o,47,0,64],[1,1,[2],o,o,10,0,64],[1,1,[2],o,o,10,0,64],[3,6,[1,48,48,65,65,65],o,o,1,0,0],[3,7,[1,48,48,65,65,65,65],o,o,1,0,0],[2,4,[48,48,65,65],o,o,1,0,0],[3,3,[1,32,32],o,o,1,0,0],[3,6,[48,48,1,65,65,65],o,o,1,0,0],[3,254,[16],[16,15],o,1,0,64],[3,254,[16],[16,15],o,1,0,64],[3,254,[114,68],[114],o,2,0,96],[1,254,o,[114],o,2,0,96],[2,254,o,[44,575],o,831,0,64],[3,254,[47],[575,575],[575],831,0,64],[1,1,[1527],o,o,1503,0,233],[2,254,o,[113,113],o,1,0,33],[1,1,[16],o,o,48,0,41],[2,3,[271,2,4],o,o,303,0,105],[2,2,[271,2],o,o,303,0,97],[2,3,[48,48,111],o,o,303,0,65],[1,4,[160,96,96,4],o,o,32,0,65],[1,3,[160,4,4],o,o,32,0,65],[2,2,[2,256],o,o,1,0,80],[3,3,[2,49,1],o,o,1,0,48],[3,3,[2,49,1],o,o,1,0,48],[2,254,[2],[49],o,1,0,48],[2,7,[34,2,65,65,65,74,68],o,o,1,0,65],[1,3,[2,65,65],o,o,2,0,65],[2,6,[2,34,65,65,65,74],o,o,2,0,65],[2,6,[2,34,65,65,65,74],o,o,2,0,65],[2,6,[2,98,98,68,65,495],o,o,32,0,65],[1,4,[32,96,96,4],o,o,32,0,81],[2,2,[4,16],o,o,32,0,49],[2,4,[391,48,65,65],o,o,1,0,65],[3,6,[391,48,48,511,65,65],o,o,319,0,65],[2,254,[160],[160,65],o,32,0,65],[0,5,[65,65,65,65,68],o,o,32,16383,1],[1,4,[65,65,65,65],o,o,32,0,1],[2,254,[258,1,65,65,65],[65],o,32,0,97],[2,3,[32,1,463],o,o,32,0,65],[1,254,o,[48],o,32,0,33],[1,254,o,[48],o,32,0,33],[2,254,[48],[33],o,32,0,1],[2,254,[48],[33],o,32,0,1],[3,254,o,[319,319],[319],319,0,1],[1,254,o,[319],o,319,0,1],[3,3,[65,65,319],o,o,32,0,1],[1,254,o,[319],o,319,0,1],[1,1,[271],o,o,4,0,1],[1,1,[271],o,o,9,0,1],[0,0,o,o,o,319,0,1],[2,2,[49,49],o,o,9,0,1],[1,2,[399,1],o,o,2,0,65],[1,2,[32,1],o,o,2,0,65],[2,2,[15,2],o,o,256,0,97],[1,3,[48,65,68],o,o,32,0,97],[1,3,[48,65,68],o,o,32,0,97],[2,3,[32,1,463],o,o,32,0,65],[2,254,[48],[319],o,32,0,65],[3,3,[511,48,271],o,o,319,0,65],[3,3,[511,48,271],o,o,32,0,65],[1,2,[48,271],o,o,32,0,65],[1,2,[48,271],o,o,32,0,65],[1,1,[1535],o,o,4,0,65],[2,4,[32,65,65,495],o,o,32,0,65],[2,3,[48,65,65],o,o,48,0,65],[2,3,[48,65,65],o,o,48,0,65],[2,254,[1,1],[447],o,303,0,97],void 0,[1,5,[2,66,65,65,65],o,o,264,0,65],[2,2,[15,2],o,o,271,0,97],[3,7,[112,96,96,65,65,96,96],o,o,32,0,65],[4,10,[112,112,96,96,65,65,96,65,96,96],o,o,32,0,65],[1,1,[2],o,o,264,0,9],[1,1,[256],o,o,2,0,97],[1,1,[256],o,o,2,0,97],[1,1,[256],o,o,2,0,97],[3,254,[256,2,4],[47],o,303,0,105],[2,254,[256,2],[47],o,303,0,97],[2,3,[2,2,2],o,o,2,0,65],[2,2,[2,1],o,o,2,0,65],[2,2,[2,1],o,o,32,0,65],[2,3,[2,2,4],o,o,4,0,65],[3,5,[2,2,2,1,4],o,o,2,0,65],[2,4,[2,2,1,4],o,o,32,0,65],[0,0,o,o,o,1,0,1],[1,2,[287,2],o,o,288,0,97],[1,2,[1,1],o,o,10,0,97],[0,0,o,o,o,1,0,1],[3,254,[47],[2,47],o,47,0,97],[0,1,[1],o,o,1,0,1],[0,1,[1],o,o,32,0,1],[1,2,[2,1],o,o,47,0,1],[1,1,[1],o,o,264,0,97],[1,1,[1],o,o,264,0,97],[2,2,[2,47],o,o,47,0,1],[1,254,[2],[1151],o,1087,0,96],[1,254,[1],[1151],o,1087,0,0],[1,254,[1],[1151],o,1087,0,0],[1,1,[16],o,o,32,0,1],[1,1,[256],o,o,2,0,97],[1,1,[256],o,o,2,0,97],[1,1,[256],o,o,2,0,97],[1,1,[256],o,o,2,0,97],[2,2,[256,2],o,o,2,0,97],[1,1,[32],o,o,256,0,97],[3,254,[15],[2,47],o,303,0,97],[1,1,[256],o,o,2,0,97],[4,254,[256,66,66,66],[66,96],o,319,0,1],[1,1,[48],o,o,16,0,97],[3,8,[112,96,96,65,65,96,96,68],o,o,32,0,65],[4,11,[112,112,96,96,65,65,96,65,96,96,65],o,o,32,0,65],[2,2,[2,2],o,o,2,0,65],void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[3,254,o,[319,319],[319],319,0,1],[3,254,[15],[2,303],o,303,0,97]].map((e=>void 0===e?void 0:(0,n.functionType)(...e)))},81836:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.styleServiceTypes=t.testUtil=t.printServiceTypes=t.printService=t.mathpackIEEE=t.relabel=t.visitor=t.mathpack=t.signature=t.literalParse=t.resolveServiceTypes=t.resolveService=t.util=t.numfmt=t.formulaModule=t.datepack=t.mathpackXL=t.config=t.cellParse=t.cellFormat=t.annotations=t.adjust=t.worksheetFuncTypesModule=t.location=t.value=t.types=t.PackageName=void 0;const n=r(19181);t.PackageName="excel-online-calc-lang",t.types=n.__importStar(r(36745)),t.value=n.__importStar(r(15833)),t.location=n.__importStar(r(20797)),t.worksheetFuncTypesModule=n.__importStar(r(50175)),t.adjust=n.__importStar(r(2485)),t.annotations=n.__importStar(r(2278)),t.cellFormat=n.__importStar(r(96945)),t.cellParse=n.__importStar(r(85199)),t.config=n.__importStar(r(98064)),t.mathpackXL=n.__importStar(r(84357)),t.datepack=n.__importStar(r(96279)),t.formulaModule=n.__importStar(r(1194)),t.numfmt=n.__importStar(r(20653)),t.util=n.__importStar(r(9230)),t.resolveService=n.__importStar(r(28733)),t.resolveServiceTypes=n.__importStar(r(62376)),t.literalParse=n.__importStar(r(21572)),t.signature=n.__importStar(r(47098)),t.mathpack=n.__importStar(r(537)),t.visitor=n.__importStar(r(64198)),t.relabel=n.__importStar(r(2917)),t.mathpackIEEE=n.__importStar(r(55393)),t.printService=n.__importStar(r(96892)),t.printServiceTypes=n.__importStar(r(82955)),t.testUtil=n.__importStar(r(18702)),t.styleServiceTypes=n.__importStar(r(31232))},21572:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSignedLiteral=t.parseNumberLiteral=t.parseUint=t.isLineBreak=t.isSpace=void 0;const n=r(19181),i=r(80873),o=r(83387),a=r(78666),s=r(14687),l=r(20653),u=n.__importStar(r(75253)),c=r(9230),{codePointSpace:d,codePointLF:m,codePointMinusSign:g,codePointPlusSign:p,codePointSlash:h}=u;function f(e){return e===d||e===m}function S(e,t,r,n){(0,o.assertIndex)("calc.parse.parseUint",t,16);let a=0,l=n,u=r.length;for(;l<u;){const n=(0,s.stringCodePointAt)(r,l);if(!e.isNumeral(n))break;const o=e.getOrdinal(n);0===a&&0!==o&&(u=(0,i.fastMin)(u,l+t)),a=10*a+o,l+=(0,s.numCodeUnits)(n)}return l===u&&l<r.length&&e.isNumeral((0,s.stringCodePointAt)(r,l))?[0,n]:[a,l]}function v(e,t,r,n){let i=n;const[a,s]=S(e,5,r,i);if(s===i)return!1;if(a>32767)return!1;if(i=s,!(i<r.length&&r.charCodeAt(i)===h))return!1;i+=1;const[l,u]=S(e,5,r,i);if(u===i)return!1;if(l>32767)return!1;if(i=u,0===l)return[!1,0,i];const d=t.div(t.fromNumber(a),t.fromNumber(l));return(0,o.assertTrue)("calc.lang.tryTokenizeFrac",(0,c.isNumberOper)(d)),[d,l,i]}function y(e,t,r,n,u,d,m){let h,y,F,C=n,R=0,b="",E=!1,T=!1,k=0,P=0,N=l.NumberShape.ASCII;if(!((0,a.stringStartsWith)(r,e.decimalSeparator,n)||n<r.length&&e.isNumeral((0,s.stringCodePointAt)(r,n))))return;const A=()=>{if((d||u&&r.indexOf("%",C)>=0)&&(R-=2,void 0!==h)){const e=t.div(h,t.fromNumber(100));(0,o.assertTrue)("calc.lang.parseNumberLiteral",(0,c.isNumberOper)(e)),h=e,F=l.KnownFormat.Pct}if((0,i.fastAbs)(R)>=309)return{value:void 0,i:C,consumedThousands:E,consumedDecimal:T,numDigDec:k,numShape:N,format:F};let n=t.parse(e,!0,R,b);if(void 0!==h){const e=t.add(n,h);(0,o.assertTrue)("calc.lang.parseNumberLiteral",(0,c.isNumberOper)(e)),n=e}return{value:n,i:C,consumedThousands:E,consumedDecimal:T,numDigDec:k,numShape:N,format:F}};for(;C<r.length;){const t=(0,s.stringCodePointAt)(r,C);if(!e.isNumeral(t))break;if(0!==e.getOrdinal(t))break;(y=e.getNumberShape(t))!==l.NumberShape.ASCII&&(N=y),C+=(0,s.numCodeUnits)(t)}if(m){const n=v(e,t,r,C);if(!1!==n){const[e,t,r]=n;return C=r,!1===e?{value:void 0,i:C,consumedThousands:E,consumedDecimal:T,numDigDec:k,numShape:N,format:F}:(F=t>=10?l.KnownFormat.FractBond:l.KnownFormat.Fract,h=e,A())}}let I=C;for(;C<r.length;){const t=(0,s.stringCodePointAt)(r,C);if(e.isNumeral(t))R+=1,(y=e.getNumberShape(t))!==l.NumberShape.ASCII&&(N=y),C+=(0,s.numCodeUnits)(t);else{if(!(u&&R>0&&(0,a.stringStartsWith)(r,e.thousandsSeparator,C)))break;E=!0,C+=e.thousandsSeparator.length}}if(b+=r.substring(I,C),E){const t=function(e,t,r){let n=r,i="";for(let r=0;r<t.length;){const o=(0,s.stringCodePointAt)(t,r);if(e.isNumeral(o)){const e=(0,s.numCodeUnits)(o);i+=t.substring(r,r+e),r+=e,n-=1}else{if(0===n||!e.isThousandsPosition(n))return;r+=e.thousandsSeparator.length}}return i}(e,b,R);if(void 0===t)return;b=t}if(n<C&&C<r.length&&f(r.charCodeAt(C))){const n=v(e,t,r,C+1);if(!1!==n){const[e,t,r]=n;return C=r,!1===e?{value:void 0,i:C,consumedThousands:E,consumedDecimal:T,numDigDec:k,numShape:N,format:F}:(F=t>=10?l.KnownFormat.FractBond:l.KnownFormat.Fract,h=e,A())}}let O=!1;if((0,a.stringStartsWith)(r,e.decimalSeparator,C)&&(O=C===n,T=!0,C+=e.decimalSeparator.length),0===R)for(;C<r.length;){const t=(0,s.stringCodePointAt)(r,C);if(!e.isNumeral(t))break;if(0!==e.getOrdinal(t))break;R-=1,(y=e.getNumberShape(t))!==l.NumberShape.ASCII&&(N=y),P+=1,C+=(0,s.numCodeUnits)(t)}for(I=C;C<r.length;){const t=(0,s.stringCodePointAt)(r,C);if(!e.isNumeral(t))break;(y=e.getNumberShape(t))!==l.NumberShape.ASCII&&(N=y),k+=1,C+=(0,s.numCodeUnits)(t)}if(b+=r.substring(I,C),k>0&&(k+=P),O&&C<=n+e.decimalSeparator.length)return;const _=function(e,t,r){let n=r;if(n<t.length&&0===e.stringCompareCI("E",t.substring(n,n+1)))n+=1;else{if(!(0,a.stringStartsWith)(t,"**",n))return[0,r];n+=2}let i=!1;if(n<t.length){const e=(0,s.stringCodePointAt)(t,n);((i=e===g)||e===p)&&(n+=(0,s.numCodeUnits)(e))}if(n>=t.length||!e.isNumeral((0,s.stringCodePointAt)(t,n)))return!1;const[o,l]=S(e,10,t,n);return l!==n&&!(o>2147483647)&&[i?-o:o,l]}(e,r,C);if(!1!==_){const[e,t]=_;R+=e,t!==C&&(F=l.KnownFormat.Exp),C=t}return!1===_?{value:void 0,i:C,consumedThousands:E,consumedDecimal:T,numDigDec:k,numShape:N,format:F}:A()}t.isSpace=f,t.isLineBreak=function(e){return e===m},t.parseUint=S,t.parseNumberLiteral=y,t.parseSignedLiteral=function(e,t,r,n,i){let o=n,a=!1;if(o<r.length){const e=r.charCodeAt(o);if((e===p||e===g)&&(a=e===g,o+=1,i))for(;o<r.length&&f(r.charCodeAt(o));)o+=1}const s=y(e,t,r,o,!1,!1,!1);return void 0===(null==s?void 0:s.value)?[t.zero,n]:(o=s.i,[a?t.neg(s.value):s.value,o])}},20797:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridCell=t.isSheetGridRange=t.isGridCell=t.isSheetIndex=t.userDefinedFuncLoc=t.nameLoc=t.nameScope=t.documentScope=t.originCell=t.sheetGridCell=t.sheetGridRange=t.sheetGridCube=t.gridCell=t.gridRange=t.unsafeGridRange=t.sheetRangeIndexes=t.allSheetsRange=t.sheetIndex=t.sheetRange=t.structRefColumnLoc=t.documentLoc=t.sheetCols=t.sheetRows=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceRange=t.lexicalSourceCell=t.NameSource=t.LexicalKind=void 0;const n=r(57777);var i,o,a=n.assertions.assertIndex,s=n.assertions.assertPositiveLength,l=n.assertions.assertFalse;function u(e){return{kind:i.Cell,range:e}}function c(e){return{kind:i.Range,range:e}}function d(e,t,r){return{document:e,index:t,index2:r}}function m(e,t){return d(e,t,t)}function g(e,t,r,n){return{row:e,col:t,rows:r,cols:n}}function p(e,t){return{sheet:e,range:t}}function h(e){return{document:e,index:void 0}}function f(e){return e.index===e.index2}function S(e){return 1===e.rows&&1===e.cols}function v(e){return S(e.range)}!function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation",e[e.Indirect=6]="Indirect",e[e.WSF=7]="WSF",e[e.UDF=8]="UDF",e[e.Other=9]="Other"}(i||(t.LexicalKind=i={})),function(e){e.AppHead="AppHead",e.Plain="Plain",e.StructRef="StructRef",e.Indirect="Indirect"}(o||(t.NameSource=o={})),t.lexicalSourceCell=u,t.lexicalSourceRange=c,t.lexicalSourceGrid=function(e,t){switch(e){case i.Cell:return v(t)?u(t):l("calc.lang.lexicalSourceGrid: expected cell");case i.Range:return c(t)}},t.lexicalSourceName=function(e){return{kind:i.NameManager,name:e}},t.lexicalSourceWSF=function(e){return{kind:i.WSF,id:e}},t.lexicalSourceUDF=function(e){return{kind:i.UDF,udf:e}},t.sheetRows=1<<20,t.sheetCols=16384,t.documentLoc=function(e,t){return{path:e,name:t}},t.structRefColumnLoc=function(e,t,r,n){return{name:e,range:t,hasHeadersRow:r,hasTotalsRow:n}},t.sheetRange=d,t.sheetIndex=m,t.allSheetsRange=function(e){return{document:e,index:void 0,index2:void 0}},t.sheetRangeIndexes=function(e,t){return{sheets:e,position:t}},t.unsafeGridRange=g,t.gridRange=function(e,r,n,i){return a("calc.lang.gridRange",e,t.sheetRows),a("calc.lang.gridRange",r,t.sheetCols),s("calc.lang.gridRange",n,t.sheetRows-e),s("calc.lang.gridRange",i,t.sheetCols-r),g(e,r,n,i)},t.gridCell=function(e,r){return a("calc.lang.gridCell",e,t.sheetRows),a("calc.lang.gridCell",r,t.sheetCols),g(e,r,1,1)},t.sheetGridCube=p,t.sheetGridRange=p,t.sheetGridCell=p,t.originCell=p,t.documentScope=h,t.nameScope=function(e,t){return void 0===t?h(e):m(e,t)},t.nameLoc=function(e,t){return{scope:e,name:t}},t.userDefinedFuncLoc=function(e,t){return{document:e,id:t}},t.isSheetIndex=f,t.isGridCell=S,t.isSheetGridRange=function(e){return f(e.sheet)},t.isSheetGridCell=v},537:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatScientificLeft=t.numberComponents=void 0;const n=r(80873);t.numberComponents=(0,n.typedInstanceCreator)()(((e,t,r)=>({sign:e,mantissa:t,exponent:r}))),t.formatScientificLeft=function(e,t){if(t<=1)return t;const r=e%t;return 0===r?t:r<0?r+t:r}},55393:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ieeeMathpack=void 0;const n=r(19181),i=r(15833),o=r(80873),a=r(537),s=n.__importStar(r(75253)),l=r(78666),u=r(83387),c=r(36745),d=r(14687),{codePointDigitZero:m}=s;function g(e){return{kind:c.OperKind.Number,_valueIEEE:e}}const p=g(0),h=g(1),f=g(Math.PI);function S(e){return isFinite(e)?g(e):i.numErrorOper}function v(e,t){const{_valueIEEE:r}=e,{_valueIEEE:n}=t;return r<n?-1:r>n?1:0}function y(e,t){const r=void 0===t?e.toExponential():e.toExponential(t),n=r.indexOf("e"),i=!(0,l.stringStartsWith)(r,"-"),o=r.substring(i?0:1,n).replace(".",""),a=parseInt(r.substring(n+1),10)+1;return function(e){for(let t=0;t<e.length;t+=1)if(e.charCodeAt(t)!==m)return!1;return!0}(o)?{sign:i,mantissa:"",exponent:0}:{sign:i,mantissa:o,exponent:a}}const F=["0","1","2","3","4","5","6","7","8","9"];function C(e){const{_valueIEEE:t}=e;return g(t<0?Math.ceil(t):Math.floor(t))}function R(e){const{_valueIEEE:t}=e;return g(Math.floor(t))}function b(e){return e.substring(0,1)+"."+e.substring(1)}t.ieeeMathpack={zero:p,one:h,pi:f,add:(e,t)=>S(e._valueIEEE+t._valueIEEE),sub:(e,t)=>S(e._valueIEEE-t._valueIEEE),mul:(e,t)=>S(e._valueIEEE*t._valueIEEE),div:function(e,t){const{_valueIEEE:r}=e,{_valueIEEE:n}=t;return 0===n?i.div0ErrorOper:S(r/n)},power:function(e,t){const{_valueIEEE:r}=e,{_valueIEEE:n}=t,o=Math.pow(r,n);return isFinite(o)?g(o):isNaN(o)?i.div0ErrorOper:i.numErrorOper},percent:e=>g(e._valueIEEE/100),neg:e=>g(-e._valueIEEE),compare:v,formatGeneral:function({decimalSeparator:e},t,r){const{_valueIEEE:n}=t;let i=String(n).replace("e","E");return"."!==e&&(i=i.replace(".",e)),i},formatFixed:function(e,t,r){const{_valueIEEE:n}=e;let{sign:i,mantissa:o,exponent:s}=y(n),l=r+(s+t);if(0===l){const e=parseFloat("5e"+String(s-1));if(Math.abs(n)>=e)return(0,a.numberComponents)(i,"1",s+t+1)}if(l<1)return(0,a.numberComponents)(!0,"",0);l<=21&&(({sign:i,mantissa:o,exponent:s}=y(n,l-1)),l=r+(s+t));const u=o.substring(0,l);return(0,a.numberComponents)(i,u,0===u.length?0:s+t)},formatScientific:function(e,t,r){const{_valueIEEE:n}=e;let{sign:i,mantissa:o,exponent:s}=y(n),l=(0,a.formatScientificLeft)(s,t),c=l+r;if((0,u.assertTrue)("calc.lang.ieeeFormatScientific",c>0),0===c){const e=parseFloat("5e"+String(s-1));if(Math.abs(n)>=e)return(0,a.numberComponents)(i,"",s+1)}if(c<1)return(0,a.numberComponents)(!0,"",0);c<=21&&(({sign:i,mantissa:o,exponent:s}=y(n,c-1)),l=(0,a.formatScientificLeft)(s,t),c=l+r);const d=o.substring(0,c);return(0,a.numberComponents)(i,d,0===d.length?0:s)},parse:function(e,t,r,n){return g(Number((t?"":"-")+"0."+function({getOrdinal:e},t){let r="";for(const n of(0,d.codePointIterator)(t))r+=F[e(n)];return r}(e,n)+"E"+String(r)))},trunc:C,ceil:function(e){const{_valueIEEE:t}=e;return g(Math.ceil(t))},floor:R,abs:e=>g(Math.abs(e._valueIEEE)),cond:e=>v(e,p),cond2:v,fromNumber:g,toNumber:e=>e._valueIEEE,sqrt:e=>S(Math.sqrt(e._valueIEEE)),exp:e=>S(Math.exp(e._valueIEEE)),ln:e=>S(Math.log(e._valueIEEE)),log:e=>S(Math.log(e._valueIEEE)/Math.LN10),sin:e=>g(Math.sin(e._valueIEEE)),cos:e=>g(Math.cos(e._valueIEEE)),tan:e=>g(Math.tan(e._valueIEEE)),asin:e=>S(Math.asin(e._valueIEEE)),acos:e=>S(Math.acos(e._valueIEEE)),atan:e=>S(Math.atan(e._valueIEEE)),atan2:(e,t)=>g(Math.atan2(t._valueIEEE,e._valueIEEE)),mod:(e,t)=>g(e._valueIEEE%t._valueIEEE),round:function(e,t){const{_valueIEEE:r}=e;if(0===r)return p;const{exponent:n}=y(r),i=C(t)._valueIEEE+n;if(0===i){const e=parseFloat("5e"+String(n-1));if(Math.abs(r)>=e)return S((r<0?-1:1)*parseFloat("10e"+String(n-1)))}return i<1?p:i>21?e:S(parseFloat(r.toExponential(i-1)))},roundUp:function(e,t){const{_valueIEEE:r}=e;if(0===r)return p;const{sign:n,mantissa:i,exponent:o}=y(r),a=C(t)._valueIEEE+o;return a<1?S(parseFloat((n?"":"-")+"10e"+String(o-1-a))):a>21?e:S(parseFloat((n?"":"-")+function(e,t){if(e.length<=t)return b(e);const r=e.substring(0,t);let n=0;for(let e=r.length-1;e>=0&&r.charCodeAt(e)-m==9;e-=1)n+=1;return n===r.length?"10":b(r.substring(0,r.length-n-1)+String.fromCharCode(r.charCodeAt(r.length-n-1)+1))}(i,a)+"e"+String(o-1)))},roundDown:function(e,t){const{_valueIEEE:r}=e;if(0===r)return p;const{sign:n,mantissa:i,exponent:o}=y(r),a=C(t)._valueIEEE+o;if(a<1)return p;if(a>21)return e;const s=i.substring(0,a);return S(parseFloat((n?"":"-")+b(s)+"e"+String(o-1)))},tenTo:function(e){return(0,u.assertInteger)("calc.lang.ieeeTenTo",e),S(Math.pow(10,e))},checkAlmostCancellation:(e,t)=>t,fix:function(e){const{_valueIEEE:t}=e,r=Math.abs(t);return r>=4294967296?4294967295:Math.floor(r)},lfix:function(e){const t=C(e)._valueIEEE;return t<-2147483648||t>2147483647?-2147483648:t},sfix:function(e){const t=R(e)._valueIEEE;return t<-2147483648?-2147483648:t>2147483647?2147483647:t},viewRound:o.identity}},84357:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlMathpack=void 0;const n=r(55843),i=r(15833),o=r(83387),a=r(36745),s=r(80873);function l(e){return{kind:a.OperKind.Number,_valueXL:e}}const u=l(n.mathpack.zero()),c=l(n.mathpack.one()),d=l(n.mathpack.pi());function m(e){return 0!=(e.num&n.mathpack.MathErrorNum.DivBy0)?i.div0ErrorOper:i.numErrorOper}function g(e){return t=>(0,o.assertFalse)(`calc.lang.${e}: error ${JSON.stringify(t)}`)}function p(e,t,r){return n=>{const i=e(n._valueXL);return"number"==typeof i?t(i):r(i)}}function h(e,t,r){return(n,i)=>{const o=e(n._valueXL,i._valueXL);return"number"==typeof o?t(o):r(o)}}const f=h(((e,t)=>n.mathpack.equal(t,2)?n.mathpack.mul(e,e):n.mathpack.power(e,t)),l,m),S=p((e=>n.mathpack.div(e,100)),l,g("xlPercent")),v=p(n.mathpack.ceil,l,g("xlCeil")),y=p(n.mathpack.floor,l,g("xlFloor")),F=p(n.mathpack.cond,s.identity,g(`xlCond, isSupported = ${(0,n.isSupported)()}`)),C=h(n.mathpack.cond2,s.identity,g("xlCond2")),R=p(n.mathpack.sfix,s.identity,g("xlSfix")),b=p(n.mathpack.viewRound,l,g("xlViewRound"));t.xlMathpack={zero:u,one:c,pi:d,add:h(n.mathpack.add,l,m),sub:h(n.mathpack.sub,l,m),mul:h(n.mathpack.mul,l,m),div:h(n.mathpack.div,l,m),power:f,percent:S,neg:function(e){return 0!==F(e)?l(n.mathpack.neg(e._valueXL)):e},compare:(e,t)=>n.mathpack.compare(e._valueXL,t._valueXL),formatGeneral:function(e,t,r){const{_valueXL:i}=t,a=n.mathpack.formatGeneral(e,i,r);return"string"!=typeof a?(0,o.assertFalse)(`calc.lang.xlFormatGeneral: error ${JSON.stringify(a)}`):a},formatFixed:function(e,t,r){const{_valueXL:i}=e,a=n.mathpack.formatFixed(i,t,r);return"object"!=typeof a?(0,o.assertFalse)(`calc.lang.xlFormatFixed: error ${JSON.stringify(a)}`):a},formatScientific:function(e,t,r){const{_valueXL:i}=e,a=n.mathpack.formatScientific(i,t,r);return"object"!=typeof a?(0,o.assertFalse)(`calc.lang.xlFormatScientific: error ${JSON.stringify(a)}`):a},parse:function(e,t,r,i){const a=n.mathpack.pack(e,t,r,i);return"number"!=typeof a?(0,o.assertFalse)(`calc.lang.xlParse: error ${JSON.stringify(a)}`):l(a)},trunc:e=>l(n.mathpack.trunc(e._valueXL)),ceil:v,floor:y,abs:e=>l(n.mathpack.abs(e._valueXL)),cond:F,cond2:C,fromNumber:function(e){return(0,o.assertTrue)("calc.lang.xlFromNumber",isFinite(e)),l(e)},toNumber:function(e){const{_valueXL:t}=e;return(0,o.assertTrue)("calc.lang.xlToNumber",isFinite(t)),t},sqrt:p(n.mathpack.sqrt,l,m),exp:p(n.mathpack.exp,l,m),ln:p(n.mathpack.ln,l,m),log:p(n.mathpack.log,l,m),sin:p(n.mathpack.sin,l,m),cos:p(n.mathpack.cos,l,m),tan:p(n.mathpack.tan,l,m),asin:p(n.mathpack.asin,l,m),acos:p(n.mathpack.acos,l,m),atan:p(n.mathpack.atan,l,m),atan2:h(n.mathpack.atan2,l,m),mod:h(n.mathpack.mod,l,m),round:h(n.mathpack.round,l,m),roundUp:h(n.mathpack.roundUp,l,m),roundDown:h(n.mathpack.roundDown,l,m),tenTo:function(e){(0,o.assertInteger)("calc.lang.xlTenTo",e);const t=n.mathpack.tenTo(e);return"number"==typeof t?l(t):m(t)},checkAlmostCancellation:function(e,t){const{_valueXL:r}=e,{_valueXL:i}=t;return n.mathpack.exp32(r)-n.mathpack.exp32(i)>=52428800?u:t},fix:e=>n.mathpack.fix(e._valueXL),lfix:e=>n.mathpack.lfix(e._valueXL),sfix:R,viewRound:b}},20653:function(e,t){"use strict";var r,n,i,o,a;Object.defineProperty(t,"__esModule",{value:!0}),t.KnownFormat=t.Calendar=t.NumberShape=t.DateOrder=t.CurrencyFormat=void 0,function(e){e.Paren="Paren",e.Lead="Lead",e.Intern="Intern",e.Trail="Trail"}(r||(t.CurrencyFormat=r={})),function(e){e.MDY="MDY",e.DMY="DMY",e.YMD="YMD",e.MYD="MYD",e.DYM="DYM",e.YDM="YDM"}(n||(t.DateOrder=n={})),function(e){e.ASCII="ASCII",e.ArabicIndic="ArabicIndic",e.ExtendedArabicIndic="ExtendedArabicIndic",e.Devanagari="Devanagari",e.Bengali="Bengali",e.Gurmukhi="Gurmukhi",e.Gujarati="Gujarati",e.Oriya="Oriya",e.Tamil="Tamil",e.Telugu="Telugu",e.Kannada="Kannada",e.Malayalam="Malayalam",e.Thai="Thai",e.Lao="Lao",e.Tibetan="Tibetan",e.Myanmar="Myanmar",e.Ethiopic="Ethiopic",e.Khmer="Khmer",e.Mongolian="Mongolian",e.ChineseTrad1="ChineseTrad1",e.ChineseTrad2="ChineseTrad2",e.ChineseTrad3="ChineseTrad3",e.ChineseSimp1="ChineseSimp1",e.ChineseSimp2="ChineseSimp2",e.ChineseSimp3="ChineseSimp3",e.Japanese1="Japanese1",e.Japanese2="Japanese2",e.Japanese3="Japanese3",e.Korean1="Korean1",e.Korean2="Korean2",e.Korean3="Korean3",e.Korean4="Korean4"}(i||(t.NumberShape=i={})),function(e){e.Gregorian="Gregorian",e.GregorianUS="GregorianUS",e.Japan="Japan",e.Taiwan="Taiwan",e.Korea="Korea",e.Hijri="Hijri",e.Thai="Thai",e.Hebrew="Hebrew",e.GregorianMEFrench="GregorianMEFrench",e.GregorianArabic="GregorianArabic",e.GregorianXlitEnglish="GregorianXlitEnglish",e.GregorianXlitFrench="GregorianXlitFrench",e.Persian="Persian",e.UmAlQura="UmAlQura"}(o||(t.Calendar=o={})),function(e){e[e.General=0]="General",e[e.NoComFixed0=-1]="NoComFixed0",e[e.NoComFixed=-2]="NoComFixed",e[e.Fixed0=-3]="Fixed0",e[e.Fixed=-4]="Fixed",e[e.Currency=-9]="Currency",e[e.CoCurrency=-10]="CoCurrency",e[e.CurrencyDec=-11]="CurrencyDec",e[e.CoCurrencyDec=-12]="CoCurrencyDec",e[e.Pct0=-13]="Pct0",e[e.Pct=-14]="Pct",e[e.Exp=-15]="Exp",e[e.Fract=-17]="Fract",e[e.FractBond=-18]="FractBond",e[e.MMDDYY=-19]="MMDDYY",e[e.DDMMMYY=-20]="DDMMMYY",e[e.DDMMM=-21]="DDMMM",e[e.MMMYY=-22]="MMMYY",e[e.HHMMAP=-23]="HHMMAP",e[e.HHMMSSAP=-24]="HHMMSSAP",e[e.HHMM=-25]="HHMM",e[e.HHMMSS=-26]="HHMMSS",e[e.MDYHMS=-27]="MDYHMS",e[e.Currency2=-5]="Currency2",e[e.CoCurrency2=-6]="CoCurrency2",e[e.CurrencyDec2=-7]="CurrencyDec2",e[e.CoCurrencyDec2=-8]="CoCurrencyDec2",e[e.Acct=-33]="Acct",e[e.AcctCur=-32]="AcctCur",e[e.AcctDec=-35]="AcctDec",e[e.AcctDecCur=-34]="AcctDecCur",e[e.MMSS=-28]="MMSS",e[e.AbsHMMSS=-31]="AbsHMMSS",e[e.SS0=-29]="SS0",e[e.Eng=-16]="Eng",e[e.Text=-30]="Text",e[e.USCoCurrency=-1037]="USCoCurrency",e[e.USCoCurrencyDec=-1039]="USCoCurrencyDec",e[e.NoComFixed0_Tha=-2036]="NoComFixed0_Tha",e[e.NoComFixed_Tha=-2037]="NoComFixed_Tha",e[e.Fixed0_Tha=-2038]="Fixed0_Tha",e[e.Fixed_Tha=-2039]="Fixed_Tha",e[e.CoCurrency_Tha=-2041]="CoCurrency_Tha",e[e.CoCurrencyDec_Tha=-2043]="CoCurrencyDec_Tha",e[e.Pct0_Tha=-2044]="Pct0_Tha",e[e.Pct_Tha=-2045]="Pct_Tha",e[e.MMDDYY_Tha=-2048]="MMDDYY_Tha",e[e.DDMMMYY_Tha=-2049]="DDMMMYY_Tha",e[e.DDMMM_Tha=-2050]="DDMMM_Tha",e[e.MMMYY_Tha=-2051]="MMMYY_Tha",e[e.HHMM_Tha=-2052]="HHMM_Tha",e[e.HHMMSS_Tha=-2053]="HHMMSS_Tha",e[e.MDYHMS_Tha=-2054]="MDYHMS_Tha",e[e.AbsHMMSS_Tha=-2055]="AbsHMMSS_Tha",e[e.MMSS_Tha=-2056]="MMSS_Tha",e[e.SS0_Tha=-2057]="SS0_Tha",e[e.DMBB_Tha=-2058]="DMBB_Tha"}(a||(t.KnownFormat=a={}))},96892:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPrinter=t.anonymizeFormula=void 0;const n=r(1194),i=r(15833),o=r(47098),a=r(83387),s=r(9230),l=r(20797),u=r(98064),c=r(48398),d=r(96945),m=r(78666),g=r(62376),p=r(28733),h=r(93387),f=r(64198),S=r(36745),v=r(21068),y=r(82955),F=r(14687),C=/'/g,R=/"/g,b=(0,l.sheetGridCell)((0,l.sheetIndex)((0,l.documentLoc)(void 0,"Book1"),0),(0,l.gridCell)(0,0));function E(e){if(!(0,h.isSuccess)(e)&&e.reason.kind!==g.ResolveReasonKind.NoOriginSheet&&e.reason.kind!==g.ResolveReasonKind.InvalidQualifier&&e.reason.kind!==g.ResolveReasonKind.InvalidCellRef&&e.reason.kind!==g.ResolveReasonKind.InvalidStructRef&&e.reason.kind!==g.ResolveReasonKind.EmptyIntersection)throw new K(e.reason)}var T;function k(e){const t=[],r=[];for(const n of e)n.length>0&&(0,F.numCodeUnits)((0,F.stringCodePointAt)(n,0))===n.length?t[(0,F.stringCodePointAt)(n,0)]=!0:r.push(n);return(e,n)=>{const i=(0,F.stringCodePointAt)(e,n);if(!0===t[i])return!0;for(const t of r)if((0,m.stringStartsWith)(e,t,n))return!0;return!1}}function P(e,t){let r="";for(let n=0;n<e.length;){t(e,n)&&(r+="'");const i=(0,F.stringCodePointAt)(e,n);r+=(0,F.stringFromCodePoint)(i),n+=(0,F.numCodeUnits)(i)}return r}!function(e){e[e.Original=0]="Original",e[e.Bracketed=1]="Bracketed",e[e.Unbracketed=2]="Unbracketed"}(T||(T={}));class N{constructor(e){this.str=e,this.append=I,this.length=e.length}}class A{constructor(e,t){this.lhs=e,this.rhs=t,this.append=I,this.length=e.length+t.length}}function I(e){return new A(this,"string"==typeof e?new N(e):e)}function O(e,t){return 0===e.length?new N(""):e.reduce(((e,r)=>e.append(t).append(r)))}const _={pre:"",preComments:void 0},M={pre:" ",preComments:void 0},D={post:"",postComments:void 0},w={literalNode:(e,t,r)=>r,arrayNode:(e,t,r)=>r,appNode:(e,t,r,n)=>n,letNode:(e,t,r,n,i,o)=>o,lambdaNode:(e,t,r,n,i,o)=>o,parenNode:(e,t,r)=>r,nameNode:(e,t,r)=>r,cellRefNode:(e,t,r)=>r,fieldRefNode:(e,t,r)=>r,structRefNode:(e,t,r)=>r,missingNode:(e,t)=>t,badSequenceNode:(e,t,r)=>r,badCharsNode:(e,t,r)=>r,operatorNode:(e,t)=>t,wsfNode:(e,t,r)=>r},L=Object.assign(Object.assign({},(0,f.constVisitor)(void 0)),{operatorNode:e=>e});class x{print(){const e=new f.ComposeVisitor(new f.ZipVisitor({str:this,label:w,op:L}),(e=>(this.record(e.label,e.str),e))),t=(0,f.reduceBottomUp)(e,this.root),r=new N("=").append(this.recordPrePost(t.label,this.pre(t.label,_),t.str,this.postIfComments(t.label)));return this.printRope(r)}pre(e,t){var r;return this.anonymize?t:null!==(r=this.spans[e])&&void 0!==r?r:t}post(e,t){var r;return this.anonymize?t:null!==(r=this.spans[e])&&void 0!==r?r:t}preIfComments(e){if(this.anonymize)return _;const t=this.spans[e];return null!=(null==t?void 0:t.preComments)&&t.preComments.length>0?t:_}postIfComments(e){if(this.anonymize)return D;const t=this.spans[e];return null!=(null==t?void 0:t.postComments)&&t.postComments.length>0?t:D}printRef(e,t){let r=new N("");switch(e.kind){case n.StructRefKind.SpecialRef:{(t===T.Original&&e.isBracketed||t===T.Bracketed)&&(r=r.append(this.localeInfo.leftBracket));const n=this.localeInfo.specialRefNames[e.id];if(null==n)throw new K((0,s.internal)("No locale data for specialRefName"));r=r.append(n),(t===T.Original&&e.isBracketed&&e.isClosed||t===T.Bracketed)&&(r=r.append(this.localeInfo.rightBracket));break}case n.StructRefKind.ColumnRef:{const n=0===e.name.length||(0,m.stringStartsWith)(e.name," ")||(0,m.stringEndsWith)(e.name," ");(t===T.Original&&e.isBracketed||t===T.Bracketed||t===T.Unbracketed&&n)&&(r=r.append(this.localeInfo.leftBracket));const i=P(e.name,this.isStructRefEscapable);r=r.append(this.anon(i)),(t===T.Original&&e.isBracketed&&e.isClosed||t===T.Bracketed||t===T.Unbracketed&&n)&&(r=r.append(this.localeInfo.rightBracket));break}case n.StructRefKind.RangeOpRef:r=r.append(this.printRef(e.lhs,t===T.Original?t:T.Bracketed)).append(":").append(this.printRef(e.rhs,t===T.Original?t:T.Bracketed));break;case n.StructRefKind.MissingRef:break;case n.StructRefKind.BadRef:e.isBracketed&&(r=r.append(this.localeInfo.leftBracket)),r=r.append(this.anon(e.chars)),e.isBracketed&&e.isClosed&&(r=r.append(this.localeInfo.rightBracket))}return this.record(e.label,r)}printThisRowOpRef(e,t){let r=new N("@");return e&&(r=e.kind===n.StructRefKind.ColumnRef?r.append(this.printRef(e,e.isClosed?function(e,t){for(let r=0;r<e.length;){if(t(e,r))return!0;r+=(0,F.numCodeUnits)((0,F.stringCodePointAt)(e,r))}return!1}(e.name,this.isStructRefBracketedThisRef)?T.Bracketed:T.Unbracketed:T.Original)):r.append(this.printRef(e,(0,s.isRangeOpClosed)(e)&&(0,s.isRangeOpNoMissing)(e)?T.Bracketed:T.Original))),this.record(t,r)}printApplication(e,t,r,n){const i=t.map(((e,t,r)=>this.recordPrePost(e.label,this.pre(e.label,0===t||0===e.str.length?_:M),e.str,t===r.length-1?this.post(e.label,D):this.postIfComments(e.label))));return e.str.append("(").append(O(i,this.localeInfo.listSeparator)).append(r?")":"")}printCellRef({ref:e,qualifier:t}){return(void 0!==t?this.recordPrePost(t.label,_,(0,f.visitQualifier)(this,t).str,this.postIfComments(t.label)):new N("")).append((0,f.visitCellRef)(this,e).str)}printName({qualifier:e,parts:t},r){const i=void 0!==e?this.recordPrePost(e.label,_,(0,f.visitQualifier)(this,e).str,this.postIfComments(e.label)):new N("");let o=new N("");for(const e of(0,n.flattenNameParts)(t).parts){let t;if(e.kind===n.NamePartKind.FieldRefNamePart){const r=e.rhs.field;t=this.record(e.rhs.label,new N(".").append(this.record(r.label,this.anon(r.kind===n.NodeKind.Ident?r.whole:r.chars))))}else t=e.kind===n.NamePartKind.CellRefNamePart&&r===g.ResolvedKind.ResolvedCellRef?this.printCellRef((0,n.cellRefNode)(e.ref,void 0,e.label)):new N(this.anon(e.asWhole));o=this.record(e.label,o.append(t)),this.recordQualified(e.qualifiedLabel,i,o)}return i.append(o)}printUnrecordedDocQual(e){if(void 0===e)return e;const{path:t,document:r}=e;return this.anon((null!=t?t:"")+this.localeInfo.leftBracket+r+this.localeInfo.rightBracket)}printParamNameIdent(e){return e.kind===n.NodeKind.Ident?this.record(e.label,this.anon((0,s.getBoundName)(this.localeInfo,e.whole))):this.recordPrePost(e.label,this.pre(e.label,_),this.anon(e.chars),this.post(e.label,D))}printParamName(e){return this.record(e.label,new N(e.isBracketed?this.localeInfo.leftBracket:"").append(this.printParamNameIdent(e.name)).append(e.isBracketed&&e.isClosed?this.localeInfo.rightBracket:""))}record(e,t){const r="string"==typeof t?new N(t):t;return this.labelToRope[e]={ropeStart:r,ropeEnd:r,startOffset:0,endOffset:0,pre:"",post:"",preComments:void 0,postComments:void 0},r}recordQualified(e,t,r){this.labelToRope[e]={ropeStart:t,ropeEnd:r,startOffset:0,endOffset:0,pre:"",post:"",preComments:void 0,postComments:void 0}}recordPrePost(e,{pre:t,preComments:r},n,{post:i,postComments:o}){const a="string"==typeof n?new N(n):n,s=new N(t),l=new N(i);return this.labelToRope[e]={ropeStart:a,ropeEnd:a,startOffset:0,endOffset:0,pre:t,post:i,preComments:r,postComments:o},r&&this.recordComments(r,s,this.spans[e].start-t.length),o&&this.recordComments(o,l,this.spans[e].end),s.append(a).append(l)}recordComments(e,t,r){for(const n of e){const e=this.spans[n.label];if(null==e)return;this.labelToRope[n.label]={ropeStart:t,ropeEnd:t,startOffset:e.start-r,endOffset:e.end-r-t.length,pre:"",post:"",preComments:void 0,postComments:void 0}}}printRope(e){const{str:t,ropeToSpan:r}=function(e){const t=new Map,r=[];let n=0;const i=[e];for(;i.length>0;){const e=i.pop();t.set(e,{start:n,end:n+e.length}),e instanceof A?i.push(e.rhs,e.lhs):(r.push(e.str),n+=e.str.length)}return{str:r.join(""),ropeToSpan:t}}(e),i=[];for(const e of Object.keys(this.labelToRope).map(Number)){const{ropeStart:t,ropeEnd:o,startOffset:a,endOffset:s,pre:l,post:u,preComments:c,postComments:d}=this.labelToRope[e],{start:m}=r.get(t),{end:g}=r.get(o);i[e]=(0,n.formulaSpan)(m+a,g+s,l,u,c,d)}return{formula:t,spans:i}}literalNode(e,t,r){switch(e.kind){case S.OperKind.String:return new N('"'+this.anon(e.value).replace(R,'""')+'"');case S.OperKind.Boolean:return new N(e.value?this.localeInfo.trueName:this.localeInfo.falseName);case S.OperKind.Number:const t=21;return new N(this.anon(this.mathpack.formatGeneral(this.localeInfo,e,t)));case S.OperKind.Missing:return new N("");case S.OperKind.Error:const r=this.localeInfo.errorNames[e.type];if(null==r)throw new K((0,s.internal)(`No locale data for error type ${e.type}`));return new N(r);default:return(0,a.assertNever)("calc.lang.printFormula",e)}}missingNode(e,t){return new N(this.anon(e))}arrayNode(e,t,r){return new N(this.localeInfo.leftBrace).append(O(e.map((e=>O(e.map((e=>this.recordPrePost(e.label,this.preIfComments(e.label),e.str,this.postIfComments(e.label)))),this.localeInfo.columnSeparator))),this.localeInfo.rowSeparator)).append(t?this.localeInfo.rightBrace:"")}appNode(e,t,r,n){if(void 0!==e.op){if(1===t.length){const r=t[0];switch(e.op){case o.OperatorId.Percent:return r.str.append(this.recordPrePost(e.label,this.pre(e.label,_),e.str,D));case o.OperatorId.Pound:return r.str.append(this.recordPrePost(e.label,this.preIfComments(e.label),e.str,D));default:return this.recordPrePost(e.label,_,e.str,this.post(e.label,D)).append(r.str)}}if(2===t.length){const[r,n]=t;let i=" ",a=" ";switch(e.op){case o.OperatorId.Range:i=a="";break;case o.OperatorId.Isect:a="";break;case o.OperatorId.Union:i=""}return r.str.append(this.recordPrePost(e.label,this.pre(e.label,{pre:i}),e.str,this.post(e.label,{post:a}))).append(n.str)}return(0,a.assertFalse)("calc.lang.printFormula: invalid number of operator args")}return this.printApplication(e,t,r,n)}letNode(e,t,r,i,o,a){const l=t.map((({name:e,binder:t})=>(0,n.letVar)((0,n.indexedArg)({str:this.record(e.arg.label,this.record(e.arg.name.label,this.anon((0,s.getBoundName)(this.localeInfo,e.arg.wholeName)))),label:e.arg.label,op:void 0},e.index),t)));return this.printApplication(e,(0,n.flattenLetArgs)(l,r,i),o,a)}lambdaNode(e,t,r,i,o,a){const s=t.map((({name:e})=>{const t=this.printParamName(e.arg.name),r=void 0===e.arg.def?new N(""):this.recordPrePost(e.arg.def.label,this.pre(e.arg.def.label,M),new N(":=").append(this.recordPrePost(e.arg.def.rhs.label,this.pre(e.arg.def.rhs.label,0===e.arg.def.rhs.str.length?_:M),e.arg.def.rhs.str,D)),D);return(0,n.lambdaParam)((0,n.indexedArg)({str:t.append(r),label:e.arg.label,op:void 0},e.index))}));return this.printApplication(e,(0,n.flattenLambdaArgs)(s,r,i),o,a)}parenNode(e,t,r){return new N("(").append(this.recordPrePost(e.label,this.pre(e.label,_),e.str,this.post(e.label,D))).append(t?")":"")}nameNode(e,t,r){const{headResolved:i,node:o}=this.resolver.resolveDottedName(this.locals,(0,n.nameNode)(e,t,r),this.annotations);return E(i.resolution),this.printName(o,i.kind)}cellRefNode(e,t,r){const{node:i,resolution:o}=this.resolver.resolveCellRef(this.locals,(0,n.cellRefNode)(e,t,r));return E(o),this.printCellRef(i)}fieldRefNode(e,t,r){const i=t.shouldBeBracketed,o=t.isBracketed||i?this.localeInfo.leftBracket:"",a=t.isBracketed&&t.isClosed||i?this.localeInfo.rightBracket:"",s=this.record(t.field.label,this.anon(t.field.kind===n.NodeKind.Ident?P(t.field.whole,this.isFieldRefEscapable):t.field.chars)),l=t.field.kind!==n.NodeKind.Ident?this.pre(t.label,_):this.preIfComments(t.label);return e.str.append(this.recordPrePost(t.label,l,new N("."+o).append(s).append(a),this.post(t.label,D)))}structRefNode(e,t,r){var i;const{node:o,table:a,resolution:l}=this.resolver.resolveStructRef(this.locals,(0,n.structRefNode)(e,t,r));E(l);const u=o.rhs.innerRef;let c=void 0===o.lhs?void 0:this.record(o.lhs.label,this.printName(o.lhs,g.ResolvedKind.ResolvedName));if(void 0!==c||void 0===a||!o.rhs.isClosed||(null==u?void 0:u.kind)===n.StructRefKind.ColumnRef||(null==u?void 0:u.kind)===n.StructRefKind.ThisRowOpRef&&(null===(i=u.ref)||void 0===i?void 0:i.kind)===n.StructRefKind.ColumnRef||(c=new N(a.name)),void 0===u&&o.rhs.isClosed&&void 0!==c)return c;let d=new N(this.localeInfo.leftBracket);switch(null==u?void 0:u.kind){case n.StructRefKind.ColumnRef:case n.StructRefKind.SpecialRef:if(u.kind===n.StructRefKind.SpecialRef&&u.id===n.SpecialRefId.ThisRow&&u.isClosed){d=d.append(this.printThisRowOpRef(void 0,u.label));break}d=d.append(this.printRef(u,u.isClosed?T.Unbracketed:T.Original));break;case n.StructRefKind.RangeOpRef:{const e=(0,s.isRangeOpClosed)(u)&&(0,s.isRangeOpNoMissing)(u)?T.Bracketed:T.Original;d=d.append(this.printRef(u,e));break}case n.StructRefKind.CommaOpRef:{const e=(0,s.isCommaOpRefWellFormed)(u)&&(0,s.isCommaOpClosed)(u)&&(0,s.isCommaOpNoBadOrMissing)(u);if(e&&u.specialRefs[n.SpecialRefId.ThisRow]){d=d.append(this.printThisRowOpRef(0===u.columnRefs.length?void 0:u.columnRefs[0],u.label));break}const t=e?(0,s.normalizeCommaOpRef)(u):u.refs,r=e?1===t.length?T.Unbracketed:T.Bracketed:T.Original;d=d.append(this.record(u.label,O(t.map((e=>this.printRef(e,r))),this.localeInfo.listSeparator)));break}case n.StructRefKind.ThisRowOpRef:d=d.append(this.printThisRowOpRef(u.ref,u.label));break;case n.StructRefKind.BadRef:d=d.append(this.printRef(u,T.Original))}return o.rhs.isClosed&&(d=d.append(this.localeInfo.rightBracket)),(null!=c?c:new N("")).append(this.record(o.rhs.label,d))}badSequenceNode(e,t,r){return O(t.map((e=>this.recordPrePost(e.label,this.pre(e.label,_),e.str,this.post(e.label,D)))),"")}badCharsNode(e,t,r){return new N(this.anon(t))}operatorNode(e,t){const r=(0,u.operatorIdToName)(this.localeInfo,e,"");if(void 0===r)throw new K((0,s.internal)("Invalid operator"));return new N(r)}wsfNode(e,t,r){return new N(this.localeInfo.getWorksheetFuncName(e))}cellRefError(e){const t=this.localeInfo.errorNames[i.ErrorType.REF];if(null==t)throw new K((0,s.internal)("No locale data for #REF"));return{str:this.record(e,t),label:e}}cellRefSingle(e,t,r,n){const i=(0,d.formatCellPos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e,t,this.locals.wrapCellReferences);return void 0!==i?{str:this.record(n,this.anon(i)),label:n}:this.cellRefError(n)}cellRefRange(e,t,r){const n=(0,d.formatRangePos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e.row,e.col,t.row,t.col,this.locals.wrapCellReferences);return void 0!==n?{str:this.record(r,this.anon(n)),label:r}:this.cellRefError(r)}cellRefRow(e,t,r,n){const i=(0,d.formatRowRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.row,e,t,this.locals.wrapCellReferences);return void 0!==i?{str:this.record(n,this.anon(i)),label:n}:this.cellRefError(n)}cellRefCol(e,t,r,n){const i=(0,d.formatColRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.col,e,t,this.locals.wrapCellReferences);return void 0!==i?{str:this.record(n,this.anon(i)),label:n}:this.cellRefError(n)}cellRefBad(e,t,r){return{str:this.record(r,this.anon(e)),label:r}}errorQualifier(e){const t=this.localeInfo.errorNames[i.ErrorType.REF];if(null==t)throw new K((0,s.internal)("No locale data for #REF"));return{str:this.record(e,t),label:e}}relativeQualifier(e){return{str:this.record(e,"!"),label:e}}documentQualifier(e,t,r,i){return{str:this.record(i,(0,d.quoteQualifier)(this.printUnrecordedDocQual((0,n.documentQualifier)(e,t)))+"!"),label:i}}sheetQualifier(e,t,r,n){let i=this.printUnrecordedDocQual(t),o=this.anon(e);const a=(0,d.shouldQuoteQualifier)(this.localeInfo,this.refStyle,(null!=i?i:"")+o);return a&&(i=null==i?void 0:i.replace(C,"''"),o=o.replace(C,"''")),{str:this.record(n,new N(a?"'":"").append(void 0===i?new N(""):this.record(t.label,i)).append(o).append(a?"'":"").append("!")),label:n}}identQualifier(e,t,r){return{str:this.record(r,(0,d.formatQualifier)(this.localeInfo,this.refStyle,this.anon(e))+"!"),label:r}}sheetRangeQualifier(e,t,r,n,i){let o=this.printUnrecordedDocQual(r),a=this.anon(e),s=this.anon(t);const l=(0,d.shouldQuoteQualifier)(this.localeInfo,this.refStyle,(null!=o?o:"")+a)||(0,d.shouldQuoteQualifier)(this.localeInfo,this.refStyle,s);return l&&(o=null==o?void 0:o.replace(C,"''"),a=a.replace(C,"''"),s=s.replace(C,"''")),{str:this.record(i,new N(l?"'":"").append(void 0===o?new N(""):this.record(r.label,o)).append(a).append(":").append(s).append(l?"'":"").append("!")),label:i}}badQualifier(e,t,r,n,i){return{str:this.record(i,this.anon(e)),label:i}}constructor(e,t,r,n){var i,o,a,s;this.root=r,this.anonymize=n,this.labelToRope=[],this.anon=e=>this.anonymize?(0,c.anonymizeFormulaString)(e):e,this.locals=t,this.localeInfo=null!==(o=null===(i=t.config)||void 0===i?void 0:i.localeInfo)&&void 0!==o?o:e.config.localeInfo,this.mathpack=e.config.mathpack,this.refStyle=null!==(s=null===(a=t.config)||void 0===a?void 0:a.refStyle)&&void 0!==s?s:e.config.refStyle,this.resolver=(0,p.createResolver)(e),this.spans=r.spans,this.annotations=r.annotations;const l=["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket,"#","@"],u=[...l,"\t","\n","\r"," ","!",'"',"$","%","&","(",")","*","+",this.localeInfo.listSeparator,"-",".","/",":",";","<","=",">","?","\\","^","_","`","{","}","~"];this.isStructRefEscapable=k(l),this.isStructRefBracketedThisRef=k(u),this.isFieldRefEscapable=k(["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket])}}const K=(0,s.createFailureErrorClass)("PrintFormulaError"),U=(0,s.createFailureErrorClass)("PrintRangeError");function B(e,t,r,n=!1){try{return(0,h.success)(new x(e,t,r,n).print())}catch(e){return e instanceof K?(0,h.failure)(e.reason):(0,h.failure)((0,h.javaScriptError)(e))}}function G(e,t){return void 0===e?(0,n.pos)(n.PosKind.Abs,t):(0,n.pos)(n.PosKind.Rel,t-e)}function W(e,t,r){return(0,n.cellRefSingle)(G(e,r.row),G(t,r.col))}function V(e){return(0,h.isSuccess)(e)?((0,a.assertTrue)("calc.lang.printRangeStructRef: NameLoc can't be no-table",null!=e.value),(0,h.success)(e.value)):e.reason.kind===g.ResolveReasonKind.InvalidStructRef?(0,a.assertFalse)("calc.lang.printRangeStructRef: NameLoc can't be InvalidStructRef"):(0,h.failure)(e.reason)}function j(e,t,r,i=(0,v.makeEmptyTable)()){var o,a;try{const u=t.originSheet.value;if(!(0,s.isDocumentLocEqual)(u.document,r.sheet.document))throw new U((0,s.notImplemented)(["printRange cross-document"]));return(0,h.success)(null!==(a=null!==(o=function(e,t,r,i){const o=t.originSheet.value,a=e.getNamedRanges(r);if(!(0,h.isSuccess)(a))throw new U(a.reason);if(0===a.value.length)return;const u=e=>void 0!==e.index&&(void 0===o.index||!(0,s.isSheetIndexEqual)(e,o)),c=a.value.filter((({scope:e})=>void 0===e.index?(0,s.isDocumentLocEqual)(e.document,r.sheet.document):(0,s.isSheetIndexEqual)(e,r.sheet))).filter((({scope:t,name:r})=>{if(void 0!==t.index||void 0===o.index)return!0;const n=o,i=e.getNameLoc(n,r,l.NameSource.Plain);if(!(0,h.isSuccess)(i))throw new U(i.reason);return null==i.value})).filter((({scope:e,name:t})=>u(e)||!i.contains(t)));if(0===c.length)return;const d=1===c.length?c[0]:[...c].sort(((t,r)=>e.config.localeInfo.stringCompareCI(t.name,r.name)))[0];let m;if(u(d.scope)){const t=e.getSheetName(d.scope.document,d.scope.index);if(!(0,h.isSuccess)(t))throw new U(t.reason);m=(0,n.sheetQualifier)(t.value)}return(0,n.nameNode)((0,n.identNamePart)(d.name),m)}(e,t,r,i))&&void 0!==o?o:function(e,t,{sheet:r,range:i}){const o=e.getContainingTable((0,l.sheetGridCell)(r,(0,s.gridRangeAnchor)(i)));if(!(0,h.isSuccess)(o))throw new U(o.reason);if(null==o.value)return;const a=o.value,u=V(e.getStructRefSpecialRef(a,n.SpecialRefId.All));if(!(0,h.isSuccess)(u))throw new U(u.reason);const c=u.value.range,d=u.value.sheet,m=(0,s.gridRangeCompare)(c,i);if(void 0===m||m<0)return;const g=V(e.getStructRefSpecialRef(a,n.SpecialRefId.Data));if(!(0,h.isSuccess)(g))throw new U(g.reason);const p=g.value.range,f=t.originGridCell.value,S=t.originSheet.value,v=void 0!==S.index&&(0,s.isSheetIndexEqual)(S,d)&&(0,s.gridRangeIsects)(c,f)?void 0:(0,n.nameNode)((0,n.identNamePart)(a.name)),y=null!=v?v:(0,n.nameNode)((0,n.identNamePart)(a.name)),F=p.cols>1&&i.col===p.col&&i.cols===p.cols,C=()=>{const t=V(e.getStructRefColumn(a,i.col));if(!(0,h.isSuccess)(t))throw new U(t.reason);if(1===i.cols)return(0,n.columnRef)(t.value.name);const r=V(e.getStructRefColumn(a,i.col+i.cols-1));if(!(0,h.isSuccess)(r))throw new U(r.reason);return(0,n.rangeOpRef)((0,n.columnRef)(t.value.name),(0,n.columnRef)(r.value.name))};if(i.row===c.row&&i.rows===c.rows)return(0,n.structRefNode)(y,(0,n.structRef)(F?(0,n.specialRef)(n.SpecialRefId.All):(0,n.commaOpRef)([(0,n.specialRef)(n.SpecialRefId.All,!0),C()])));if(1===i.rows&&i.row===f.row&&i.row>=p.row&&i.row<p.row+p.rows)return(0,n.structRefNode)(1===i.cols?v:y,(0,n.structRef)((0,n.thisRowOpRef)(F?void 0:C())));if(i.row===p.row&&i.rows===p.rows)return F?(0,n.structRefNode)(y,(0,n.structRef)(void 0)):(0,n.structRefNode)(1===i.cols?v:y,(0,n.structRef)(C()));const R=i.row===c.row&&i.row+i.rows===p.row,b=i.row===p.row+p.rows&&i.row+i.rows===c.row+c.rows;if(R||b){const e=(0,n.specialRef)(R?n.SpecialRefId.Headers:n.SpecialRefId.Totals,!F);return(0,n.structRefNode)(y,(0,n.structRef)(F?e:(0,n.commaOpRef)([e,C()])))}const E=i.row===c.row&&c.row<p.row&&i.row+i.rows===p.row+p.rows,T=i.row===p.row&&c.row+c.rows>p.row+p.rows&&i.row+i.rows===c.row+c.rows;if(E||T){const e=(0,n.specialRef)(E?n.SpecialRefId.Headers:n.SpecialRefId.Data,!0),t=(0,n.specialRef)(E?n.SpecialRefId.Data:n.SpecialRefId.Totals,!0);return(0,n.structRefNode)(y,(0,n.structRef)(F?(0,n.commaOpRef)([e,t]):(0,n.commaOpRef)([e,t,C()])))}}(e,t,r))&&void 0!==a?a:function(e,t,r){const i=t.originSheet.value,o=function(e,t,r){if(0===r.col&&r.cols===l.sheetCols)return function(e,t,r){return(0,n.cellRefRow)(G(e,t),G(e,t+r-1))}(e,r.row,r.rows);if(0===r.row&&r.rows===l.sheetRows)return function(e,t,r){return(0,n.cellRefCol)(G(e,t),G(e,t+r-1))}(t,r.col,r.cols);const i=W(e,t,(0,s.gridRangeAnchor)(r));if((0,s.isGridCell)(r))return i;const o=W(e,t,(0,l.gridCell)(r.row+r.rows-1,r.col+r.cols-1));return(0,n.cellRefRange)(i,o)}(t.printRowsAsAbsoluteReferences?void 0:t.originGridCell.value.row,t.printColsAsAbsoluteReferences?void 0:t.originGridCell.value.col,r.range);let a;if(void 0===i.index||!(0,s.isSheetIndexEqual)(i,r.sheet)){const t=e.getSheetName(r.sheet.document,r.sheet.index);if(!(0,h.isSuccess)(t))throw new U(t.reason);a=(0,n.sheetQualifier)(t.value)}return(0,n.cellRefNode)(o,a)}(e,t,r))}catch(e){return e instanceof U?(0,h.failure)(e.reason):(0,h.failure)((0,h.javaScriptError)(e))}}t.anonymizeFormula=function(e,t,r){try{const i=r.kind===l.LexicalKind.Cell||r.kind===l.LexicalKind.Range?(0,y.printLocalsGrid)(r,(0,s.sheetGridRangeAnchor)(r.range)):r.kind===l.LexicalKind.NameManager?(0,y.printLocalsName)(r,b):(0,a.assertNever)("calc.lang.anonymizeFormula",r),o=B((0,y.createSimplePrintGlobals)((0,u.calcConfig)((0,u.getEnglishLocaleInfo)(),n.RefStyle.A1,e.mathpack)),i,t,!0);if(o.kind===h.ResultKind.Success)return o.value.formula;if(o.reason.kind===h.ReasonKind.JavaScriptError)throw o.reason.error}catch(e){const t="calc.lang.anonymizeFormula: Format failed: "+(0,m.messageFromError)(e);a.ulsLogger.ULS.traceTag(507381981,u.LogCategory.msoulscat_ES_EWAJS,u.TraceLevel.Warning,t)}return(0,c.anonymize)(t)};const q={getNamedRanges:()=>(0,a.assertFalse)("calc.lang.prettyPrinter: default getNamedRanges")};t.createPrinter=function(e){const t=function(e){var t,r,n;return{config:e.config,getDocumentLoc:e.getDocumentLoc.bind(e),getSheetIndex:e.getSheetIndex.bind(e),getSheetName:e.getSheetName.bind(e),getNameLoc:e.getNameLoc.bind(e),getUserDefinedFuncLoc:e.getUserDefinedFuncLoc.bind(e),getSheetRangeIndexes:e.getSheetRangeIndexes.bind(e),getContainingTable:e.getContainingTable.bind(e),getStructRefColumn:e.getStructRefColumn.bind(e),getStructRefSpecialRef:null===(t=e.getStructRefSpecialRef)||void 0===t?void 0:t.bind(e),getNamedRanges:null!==(n=null===(r=e.getNamedRanges)||void 0===r?void 0:r.bind(e))&&void 0!==n?n:q.getNamedRanges}}(e);return{printFormula:(t,r)=>{const n=B(e,t,r);return(0,h.isSuccess)(n)?(0,h.success)(n.value.formula):n},printFormulaEx:(t,r)=>B(e,t,r),printRange:(e,r,n)=>j(t,e,r,n)}}},82955:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printLocalsName=t.printLocalsGrid=t.createSimplePrintGlobals=void 0;const n=r(20797),i=r(93387),o=r(9230);class a{getDocumentLoc(e,t){return(0,i.success)((0,n.documentLoc)(e,t))}getSheetIndex(e,t){return(0,i.success)(t)}getSheetName(e,t){return(0,i.success)(t)}getNameLoc(e,t){return(0,i.success)(t.indexOf(".")>=0?void 0:(0,n.nameLoc)(e,t))}getUserDefinedFuncLoc(e,t){return(0,i.success)([])}getSheetRangeIndexes(e){if(void 0===e.index)return(0,i.failure)((0,o.notImplemented)(["simplePrintGlobals.getSheetRangeIndexes"]));const t=[e.index];return e.index2!==e.index&&t.push(e.index2),(0,i.success)((0,n.sheetRangeIndexes)(t,0))}getContainingTable(e){return i.successUndefined}getStructRefColumn(e,t){return i.successUndefined}getStructRefSpecialRef(e,t){return i.successUndefined}getNamedRanges(e){return(0,i.success)([])}constructor(e){this.config=e}}t.createSimplePrintGlobals=function(e){return new a(e)},t.printLocalsGrid=function(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:(0,i.success)(t.range),originSheet:(0,i.success)(t.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1,printRowsAsAbsoluteReferences:!1,printColsAsAbsoluteReferences:!1}},t.printLocalsName=function(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:(0,i.success)(t.range),originSheet:(0,i.success)(t.sheet),allowUnqualifiedCell:!1,wrapCellReferences:!0,printRowsAsAbsoluteReferences:!0,printColsAsAbsoluteReferences:!0}}},2917:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.relabelFormula=void 0;const n=r(1194),i=r(64198);t.relabelFormula=function(e,t=function(){let e=1;return()=>e++}()){const{spans:r,annotations:o,depthUpperBound:a}=e,s=[],l=[],u=[],c=[];function d(e){const n=t(),i=r[e];null!=i&&(s[n]=i);const a=o[e];return null!=a&&(l[n]=a),u[e]=n,c[n]=e,n}function m(e){return Object.assign(Object.assign({},e),{label:d(e.label)})}function g(e){if(e.kind===n.CellRefKind.Range){const t=e;return(0,n.cellRefRange)(g(t.ref1),g(t.ref2),d(e.label))}return Object.assign(Object.assign({},e),{label:d(e.label)})}function p(e){return null!=e?(0,n.documentQualifier)(e.document,e.path,e.isQuoted,d(e.label)):void 0}function h(e){return(0,n.fieldRef)(function(e){switch(e.kind){case n.NodeKind.Ident:return v(e);case n.NodeKind.Missing:return(0,n.missingNode)(e.chars,d(e.label));case n.NodeKind.BadChars:return(0,n.badCharsNode)(e.type,e.chars,d(e.label))}}(e.field),e.isBracketed,e.isClosed,e.shouldBeBracketed,d(e.label))}function f(e){switch(null==e?void 0:e.kind){case void 0:return;case n.StructRefKind.SpecialRef:return(0,n.specialRef)(e.id,e.isBracketed,e.isClosed,d(e.label));case n.StructRefKind.ColumnRef:return(0,n.columnRef)(e.name,e.isBracketed,e.isClosed,d(e.label));case n.StructRefKind.RangeOpRef:return(0,n.rangeOpRef)(f(e.lhs),f(e.rhs),d(e.label));case n.StructRefKind.CommaOpRef:return(0,n.commaOpRef)(e.refs.map(f),d(e.label));case n.StructRefKind.ThisRowOpRef:return(0,n.thisRowOpRef)(void 0!==e.ref?f(e.ref):void 0,d(e.label));case n.StructRefKind.MissingRef:return(0,n.missingRef)(d(e.label));case n.StructRefKind.BadRef:return(0,n.badRef)(e.chars,e.isBracketed,e.isClosed,d(e.label))}}function S(e,t,r){return(0,n.nameNode)(function(e){const t=(0,n.flattenNameParts)(e),r=(e,{rhs:t,canDenoteNamedObject:r,label:i,qualifiedLabel:o})=>(0,n.fieldRefNamePart)(e,h(t),r,d(i),d(o));if(t.kind===n.NamePartKind.IdentNamePart){const[e,...i]=t.parts,o=(0,n.identNamePart)(e.asWhole,e.canDenoteNamedObject,d(e.label),d(e.qualifiedLabel));return i.reduce(r,o)}const[i,o,...a]=t.parts,s=(0,n.cellRefNamePart)(g(i.ref),i.asWhole,d(i.label),d(i.qualifiedLabel));return a.reduce(r,r(s,o))}(e),function(e){if(null!=e)return e.kind===n.QualifierKind.Sheet||e.kind===n.QualifierKind.SheetRange?Object.assign(Object.assign({},e),{document:p(e.document),label:d(e.label)}):Object.assign(Object.assign({},e),{label:d(e.label)})}(t),d(r))}function v({whole:e,label:t}){return(0,n.identNode)(e,d(t))}const y={literalNode:(e,t,r)=>(0,n.literalNode)(e,t,d(r)),arrayNode:(e,t,r)=>(0,n.arrayNode)(e,t,d(r)),appNode:(e,t,r,i)=>(0,n.appNode)(e,t,r,d(i)),letNode:(e,t,r,i,o,a)=>(0,n.letNode)(e,t.map((({name:e,binder:t})=>(0,n.letVar)((0,n.indexedArg)(function({name:e,label:t}){return(0,n.varNode)(v(e),d(t))}(e.arg),e.index),t))),r,i,o,d(a)),lambdaNode:(e,t,r,i,o,a)=>(0,n.lambdaNode)(e,t.map((({name:e})=>(0,n.lambdaParam)((0,n.indexedArg)(function(e){const t=(0,n.paramName)(function(e){switch(e.kind){case n.NodeKind.Ident:return v(e);case n.NodeKind.Missing:return(0,n.missingNode)(e.chars,d(e.label));case n.NodeKind.BadChars:return(0,n.badCharsNode)(e.type,e.chars,d(e.label))}}(e.name.name),e.name.isBracketed,e.name.isClosed,d(e.name.label)),r=void 0===e.def?void 0:(0,n.paramDefault)(e.def.rhs,d(e.def.label));return(0,n.paramNode)(t,r,d(e.label))}(e.arg),e.index)))),r,i,o,d(a)),parenNode:(e,t,r)=>(0,n.parenNode)(e,t,d(r)),nameNode:(e,t,r)=>S(e,t,r),cellRefNode:(e,t,r)=>(0,n.cellRefNode)(g(e),function(e){if(null!=e)return e.kind===n.QualifierKind.Sheet||e.kind===n.QualifierKind.SheetRange?Object.assign(Object.assign({},e),{document:p(e.document),label:d(e.label)}):Object.assign(Object.assign({},e),{label:d(e.label)})}(t),d(r)),fieldRefNode:(e,t,r)=>(0,n.fieldRefNode)(e,h(t),d(r)),structRefNode(e,t,r){return(0,n.structRefNode)(void 0===e?void 0:function({parts:e,qualifier:t,label:r}){return S(e,t,r)}(e),(i=t,(0,n.structRef)(f(i.innerRef),i.isClosed,d(i.label))),d(r));var i},missingNode:(e,t)=>(0,n.missingNode)(e,d(t)),badSequenceNode:(e,t,r)=>(0,n.badSequenceNode)(e,t,d(r)),badCharsNode:(e,t,r)=>(0,n.badCharsNode)(e,t,d(r)),operatorNode:(e,t)=>(0,n.operatorNode)(e,d(t)),wsfNode:(e,t,r)=>(0,n.wsfNode)(e,t,d(r))},F=(0,n.formula)((0,i.reduceBottomUp)(y,e),s,l,a);for(const e of Object.keys(l)){const t=Number(e),r=l[t];switch(null==r?void 0:r.kind){case n.AnnotationKind.LocalNameUse:l[t]=(0,n.localNameUseAnnotation)(r.name,r.whole,u[r.label]);break;case n.AnnotationKind.LocalNameDecl:l[t]=(0,n.localNameDeclAnnotation)(r.name,r.whole,r.uses.map((({label:e})=>({label:u[e]}))))}}for(const e of Object.keys(s).map(Number)){const t=s[e],r=null==t?void 0:t.preComments,n=null==t?void 0:t.postComments;(r||n)&&(s[e]=Object.assign(Object.assign({},t),{preComments:r?r.map(m):void 0,postComments:n?n.map(m):void 0}))}return{formula:F,oldToNewLabel:u,newToOldLabel:c}}},28733:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createResolver=t.resolveGridRef=t.canDenoteCellRef=t.canDenoteUserDefinedFunc=t.canDenoteLocalName=void 0;const n=r(80873),i=r(80873),o=r(83387),a=r(96945),s=r(1194),l=r(9230),u=r(9230),c=r(20797),d=r(20797),m=r(93387),g=r(62376),p=r(62376),h=r(88658);function f(e){return(0,m.isSuccess)(e)&&(0,i.isNone)(e.value)?m.successUndefined:e}function S(e){return!(0,m.isSuccess)(e)||void 0===e.value}const v=e=>e.rhs.field.kind===s.NodeKind.Ident,y=e=>e.rhs.field.whole,F=(e,t)=>(0,s.fieldRefNamePart)(e,t.rhs,t.canDenoteNamedObject,t.label,t.qualifiedLabel);function C(e,t){const[r,...n]=t;return r.kind===s.NamePartKind.IdentNamePart&&null==e&&n.every(v)}function R(e,t,r){return r.canDenoteNamedObject&&e&&(void 0===t||t.kind===s.QualifierKind.Document||t.kind===s.QualifierKind.Ident)}function b(e,t,r){const[n,...i]=r;return n.kind===s.NamePartKind.CellRefNamePart&&(null==t&&e.allowUnqualifiedCell||null!=t&&t.kind!==s.QualifierKind.Document)&&i.every(v)}function E(e,t,r,n,i){return r.kind===s.PosKind.Abs?(0,m.success)(r.index):(0,m.isSuccess)(e)?(0,m.success)((0,a.resolvePosition)(t(e.value),r,n,i)):e}t.canDenoteLocalName=C,t.canDenoteUserDefinedFunc=R,t.canDenoteCellRef=b;const T=({row:e})=>e,k=({col:e})=>e;function P(e,t,r){const n=E(e,T,t.row,d.sheetRows,r),i=E(e,k,t.col,d.sheetCols,r);return(0,m.isSuccess)(n)?(0,m.isSuccess)(i)?void 0===n.value||void 0===i.value?m.successUndefined:(0,m.success)((0,d.gridCell)(n.value,i.value)):i:n}function N(e,t){if(t.kind===s.CellRefKind.Error)return m.successUndefined;const r=e.originGridCell,n=e.wrapCellReferences;switch(t.kind){case s.CellRefKind.Single:return P(r,t,n);case s.CellRefKind.Range:{const e=P(r,t.ref1,n),i=P(r,t.ref2,n);return(0,m.isSuccess)(e)?(0,m.isSuccess)(i)?void 0===e.value||void 0===i.value?m.successUndefined:(0,m.success)((0,u.gridCellRange)(e.value,i.value)):i:e}case s.CellRefKind.Row:{const e=E(r,T,t.row1,d.sheetRows,n),i=E(r,T,t.row2,d.sheetRows,n);return(0,m.isSuccess)(e)?(0,m.isSuccess)(i)?void 0===e.value||void 0===i.value?m.successUndefined:(0,m.success)((0,u.gridCellRange)((0,d.gridCell)(e.value,0),(0,d.gridCell)(i.value,d.sheetCols-1))):i:e}case s.CellRefKind.Col:{const e=E(r,k,t.col1,d.sheetCols,n),i=E(r,k,t.col2,d.sheetCols,n);return(0,m.isSuccess)(e)?(0,m.isSuccess)(i)?void 0===e.value||void 0===i.value?m.successUndefined:(0,m.success)((0,u.gridCellRange)((0,d.gridCell)(0,e.value),(0,d.gridCell)(d.sheetRows-1,i.value))):i:e}case s.CellRefKind.Bad:return(0,m.failure)((0,p.invalidCellRef)(p.InvalidCellRefReason.BadCellRef));default:return(0,o.assertNever)("calc.lang.Resolver.resolveGridRef",t)}}t.resolveGridRef=N,t.createResolver=function(e){function t(t,r){if(void 0===r){const e=t.originSheet;return(0,m.isSuccess)(e)?[r,(0,m.success)(e.value.document)]:[r,e]}const n=e.getDocumentLoc(r.path,r.document);if(!(0,m.isSuccess)(n))return[r,n];if((0,i.isNone)(n.value))return[r,(0,m.failure)((0,p.invalidQualifier)(p.InvalidQualifierReason.UndefinedDocument))];const o=null==r.path?void 0:n.value.path,a=n.value.name;return[(0,s.documentQualifier)(a,o,r.isQuoted,r.label),(0,m.success)(n.value)]}function r(t,r){if(S(r))return[t,r];const n=f(e.getSheetIndex(r.value,t));if(!(0,m.isSuccess)(n))return[t,n];if((0,i.isNone)(n.value))return[t,(0,m.failure)((0,p.invalidQualifier)(p.InvalidQualifierReason.UndefinedSheetName))];const o=e.getSheetName(r.value,n.value);return(0,m.isSuccess)(o)?[o.value,(0,m.success)((0,d.sheetIndex)(r.value,n.value))]:[t,o]}function a(e,n){const[i,o]=t(e,n.document),[a,l]=r(n.sheet,o);return[(0,s.sheetQualifier)(a,i,n.isQuoted,n.label),l]}function v(n,i){const{qualifier:l,ref:c}=i,g=N(n,c);let h,f,v;if(void 0===l||l.kind===s.QualifierKind.Relative){h=l;const e=n.originSheet;if((0,m.isSuccess)(e)){const t=e.value;f=void 0===t.index?(0,m.failure)((0,p.noOriginSheet)(t)):(0,m.success)(t)}else f=e}else[h,f]=function(n,i){switch(i.kind){case s.QualifierKind.Error:return[i,m.successUndefined];case s.QualifierKind.Sheet:return a(n,i);case s.QualifierKind.SheetRange:return function(n,i){const[o,a]=t(n,i.document),[l,c]=r(i.sheet1,a),[g,p]=r(i.sheet2,a);let h,f=l,v=g;if(S(a))h=a;else if(S(c))h=c;else if(S(p))h=p;else{if((0,u.isSheetIndexEqual)(c.value,p.value))return[(0,s.sheetQualifier)(f,o,i.isQuoted,i.label),(0,m.success)((0,d.sheetIndex)(a.value,c.value.index))];{const t=e.getSheetRangeIndexes(c.value),r=e.getSheetRangeIndexes(p.value);(0,m.isSuccess)(t)?(0,m.isSuccess)(r)?r.value.position<t.value.position&&(f=g,v=l):h=r:h=t,h=(0,m.success)((0,d.sheetRange)(a.value,c.value.index,p.value.index))}}return[(0,s.sheetRangeQualifier)(f,v,o,i.isQuoted,i.label),h]}(n,i);case s.QualifierKind.Document:return[i,(0,m.failure)((0,p.invalidQualifier)(p.InvalidQualifierReason.SheetRangeName))];case s.QualifierKind.Bad:return[i,(0,m.failure)((0,p.invalidQualifier)(p.InvalidQualifierReason.BadQualifier))];default:return(0,o.assertNever)("calc.lang.Resolver.resolveCellRefQualifier",i)}}(n,l);return v=S(g)?g:S(f)?f:(0,m.success)((0,d.sheetGridCube)(f.value,g.value)),(0,p.resolvedCellRef)((0,s.cellRefNode)(c,h,i.label),v)}function E(r,n,i){var l,u;const{qualifier:g,parts:h}=n;let v,y,F;const C=[];if(void 0===g||g.kind===s.QualifierKind.Relative){const e=r.originSheet;if(!(0,m.isSuccess)(e))return(0,p.resolvedName)(n,e,null===(l=n.qualifier)||void 0===l?void 0:l.kind,C);const t=e.value;if(i!==d.NameSource.StructRef&&void 0===t.index)return(0,p.resolvedName)(n,(0,m.failure)((0,p.noOriginSheet)(t)),null===(u=n.qualifier)||void 0===u?void 0:u.kind,C);v=g,F=null==g?void 0:g.kind,y=(0,m.success)(t)}else[v,F,y]=function(e,r){switch(r.kind){case s.QualifierKind.Document:{const[n,i]=t(e,r);return[n,n.kind,S(i)?i:(0,m.success)((0,d.documentScope)(i.value))]}case s.QualifierKind.Sheet:{const[t,n]=a(e,r);return[t,t.kind,n]}case s.QualifierKind.SheetRange:return[r,r.kind,(0,m.failure)((0,p.invalidQualifier)(p.InvalidQualifierReason.SheetRangeName))];case s.QualifierKind.Ident:{const n=(0,s.sheetQualifier)(r.name,void 0,r.isQuoted,r.label),[i,o]=a(e,n);if(!(0,m.isSuccess)(o)&&o.reason.kind!==p.ResolveReasonKind.InvalidQualifier)return[r,r.kind,o];if((0,m.isSuccess)(o)&&void 0!==o.value)return[(0,s.identQualifier)(i.sheet,i.isQuoted,i.label),i.kind,o];const l=(0,s.documentQualifier)(r.name,void 0,r.isQuoted,r.label),[u,c]=t(e,l);return S(c)?[r,r.kind,c]:[(0,s.identQualifier)(u.document,u.isQuoted,u.label),u.kind,(0,m.success)((0,d.documentScope)(c.value))]}case s.QualifierKind.Bad:return[r,r.kind,(0,m.failure)((0,p.invalidQualifier)(p.InvalidQualifierReason.BadQualifier))];default:return(0,o.assertNever)("calc.lang.Resolver.resolveNameQualifier",r)}}(r,g);i===d.NameSource.StructRef&&(0,m.isSuccess)(y)&&void 0!==y.value.index&&(y=(0,m.success)((0,d.documentScope)(y.value.document)));let R,b=h;return S(y)?R=y:(C.push((0,c.nameLoc)(y.value,h.asWhole)),R=f(e.getNameLoc(y.value,h.asWhole,i)),(0,m.isSuccess)(R)&&void 0===R.value&&void 0!==y.value.index&&(y=(0,m.success)((0,d.documentScope)(y.value.document)),C.push((0,c.nameLoc)(y.value,h.asWhole)),R=f(e.getNameLoc(y.value,h.asWhole,i))),S(R)||(b=(0,s.identNamePart)(R.value.name,h.canDenoteNamedObject,h.label,h.qualifiedLabel))),(0,p.resolvedName)((0,s.nameNode)(b,v,n.label),R,F,C)}function T(t,r,n=!1){const o=e.getStructRefColumn(t,r.name);if(!(0,m.isSuccess)(o))return{kind:s.StructRefKind.ColumnRef,innerRef:r,resolution:o};const a=o.value;if((0,i.isNone)(a))return{kind:s.StructRefKind.ColumnRef,innerRef:r,resolution:(0,m.failure)((0,p.invalidStructRef)(p.InvalidStructRefReason.UndefinedColumnName))};let l=a.range.range;return n&&(l=(0,d.gridRange)(l.row-(a.hasHeadersRow?1:0),l.col,l.rows+(a.hasHeadersRow?1:0)+(a.hasTotalsRow?1:0),l.cols)),{kind:s.StructRefKind.ColumnRef,innerRef:(0,s.columnRef)(a.name,r.isBracketed,r.isClosed,r.label),resolution:(0,m.success)((0,d.sheetGridRange)(a.range.sheet,l))}}function k(t,r,n){if(n===s.SpecialRefId.ThisRow){if(!(0,m.isSuccess)(t.originGridCell))return t.originGridCell;const e=k(t,r,s.SpecialRefId.Data);if(S(e))return e;const n=e.value.range,i=t.originGridCell.value.row;return i<n.row||i>=n.row+n.rows?(0,m.failure)(p.emptyIntersection):(0,m.success)((0,d.sheetGridRange)(e.value.sheet,(0,d.gridRange)(i,n.col,1,n.cols)))}return f(e.getStructRefSpecialRef(r,n))}function P(e,t,r){switch(t.kind){case s.StructRefKind.ColumnRef:return T(e,t,r);case s.StructRefKind.MissingRef:return{kind:s.StructRefKind.MissingRef,innerRef:t,resolution:m.successUndefined}}}function A(e,t,r=!1){var n;const{innerRef:i,resolution:o}=P(e,t.lhs,r),{innerRef:a,resolution:l}=P(e,t.rhs,r),c=(0,s.rangeOpRef)(i,a,t.label);if(!(0,m.isSuccess)(o)&&o.reason.kind!==p.ResolveReasonKind.InvalidStructRef)return{kind:s.StructRefKind.RangeOpRef,innerRef:c,resolution:o};if(!(0,m.isSuccess)(l)&&l.reason.kind!==p.ResolveReasonKind.InvalidStructRef)return{kind:s.StructRefKind.RangeOpRef,innerRef:c,resolution:l};if(!(0,m.isSuccess)(o))return{kind:s.StructRefKind.RangeOpRef,innerRef:c,resolution:o};if(!(0,m.isSuccess)(l))return{kind:s.StructRefKind.RangeOpRef,innerRef:c,resolution:l};let g,h;if(void 0!==o.value)g=o.value.sheet,h=(0,u.gridRangeJoinOpt)(o.value.range,null===(n=l.value)||void 0===n?void 0:n.range);else{if(void 0===l.value)return{kind:s.StructRefKind.RangeOpRef,innerRef:c,resolution:(0,m.failure)((0,p.invalidStructRef)(p.InvalidStructRefReason.InvalidOp))};g=l.value.sheet,h=l.value.range}return{kind:s.StructRefKind.RangeOpRef,innerRef:c,resolution:(0,m.success)((0,d.sheetGridRange)(g,h))}}function I(r,n){var i,a;const{qualifier:u,parts:d}=n,g=null!==(a=null===(i=r.config)||void 0===i?void 0:i.localeInfo)&&void 0!==a?a:e.config.localeInfo;let h,f,v,y;if(void 0===u){const e=r.originSheet;if(!(0,m.isSuccess)(e))return(0,p.resolvedUserDefinedFunc)(n,e,[],d.asWhole);h=u,f=(0,m.success)(e.value.document)}else[h,f]=function(e,r){switch(r.kind){case s.QualifierKind.Document:return t(e,r);case s.QualifierKind.Ident:{const n=(0,s.documentQualifier)(r.name,void 0,r.isQuoted,r.label),[i,o]=t(e,n);return[(0,s.identQualifier)(i.document,i.isQuoted,i.label),o]}default:return(0,o.assertNever)("calc.lang.Resolver.resolveUserDefinedFuncQualifier",r)}}(r,u);let F=d.asWhole;if(S(f))y=f,v=[];else{F=(0,l.getUserDefinedFuncName)(g,d.asWhole);const t=e.getUserDefinedFuncLoc(f.value,F);v=[(0,c.userDefinedFuncLoc)(f.value,F)],y=(0,m.isSuccess)(t)?0!==t.value.length?t:m.successUndefined:t}return(0,p.resolvedUserDefinedFunc)((0,s.nameNode)((0,s.identNamePart)(F,d.canDenoteNamedObject,d.label,d.qualifiedLabel),h,n.label),y,v,F)}return{resolveGridRef:N,resolveCellRef:v,resolveName:E,resolveStructRef:function(t,r){const{lhs:n,rhs:o}=r;let a,l,c=n;if(void 0!==n){const{node:e,resolution:o,precedents:s}=E(t,n,d.NameSource.StructRef),u=o;if(!(0,m.isSuccess)(u))return(0,p.resolvedStructRef)(r,void 0,u,s);if((0,i.isNone)(u.value))return(0,p.resolvedStructRef)(r,void 0,(0,m.failure)((0,p.invalidStructRef)(p.InvalidStructRefReason.UndefinedTableName)),s);c=e,a=u.value,l=s}else{const{originGridCell:n,originSheet:o}=t;if(!(0,m.isSuccess)(n))return(0,p.resolvedStructRef)(r,void 0,n,[]);if(!(0,m.isSuccess)(o))return(0,p.resolvedStructRef)(r,void 0,o,[]);if(void 0===o.value.index)return(0,p.resolvedStructRef)(r,void 0,(0,m.failure)((0,p.invalidStructRef)(p.InvalidStructRefReason.InvalidOriginSheet)),[]);const s=e.getContainingTable((0,d.sheetGridCell)(o.value,n.value));if(!(0,m.isSuccess)(s))return(0,p.resolvedStructRef)(r,void 0,s,[]);if((0,i.isNone)(s.value))return(0,p.resolvedStructRef)(r,void 0,(0,m.failure)((0,p.invalidStructRef)(p.InvalidStructRefReason.MissingTableName)),[]);a=s.value,l=[a]}const{structRef:g,resolution:h}=function(e,t,r){var n;switch(null===(n=r.innerRef)||void 0===n?void 0:n.kind){case s.StructRefKind.ColumnRef:{const{innerRef:e,resolution:n}=T(t,r.innerRef);return{structRef:(0,s.structRef)(e,r.isClosed,r.label),resolution:n}}case s.StructRefKind.RangeOpRef:{const{innerRef:e,resolution:n}=A(t,r.innerRef);return{structRef:(0,s.structRef)(e,r.isClosed,r.label),resolution:n}}case void 0:return{structRef:r,resolution:k(e,t,s.SpecialRefId.Data)};case s.StructRefKind.SpecialRef:return{structRef:r,resolution:k(e,t,r.innerRef.id)};case s.StructRefKind.CommaOpRef:{const{commaOpRef:n,resolution:i}=function(e,t,r){var n,i;const o=r.refs.map((r=>function(e,t,r){switch(r.kind){case s.StructRefKind.ColumnRef:return T(t,r,!0);case s.StructRefKind.SpecialRef:return{kind:s.StructRefKind.SpecialRef,innerRef:r,resolution:k(e,t,r.id)};case s.StructRefKind.RangeOpRef:return A(t,r,!0);case s.StructRefKind.MissingRef:return{kind:s.StructRefKind.MissingRef,innerRef:r,resolution:m.successUndefined};case s.StructRefKind.BadRef:return{kind:s.StructRefKind.BadRef,innerRef:r,resolution:(0,m.failure)((0,p.invalidStructRef)(p.InvalidStructRefReason.InvalidOp))}}}(e,t,r))),a=(0,s.commaOpRef)(o.map((e=>e.innerRef)),r.label);for(const{resolution:e}of o)if(!(0,m.isSuccess)(e)&&e.reason.kind!==p.ResolveReasonKind.InvalidStructRef)return{commaOpRef:a,resolution:e};const l=[];for(const e of o){if(!(0,m.isSuccess)(e.resolution)||e.kind===s.StructRefKind.BadRef)return{commaOpRef:a,resolution:e.resolution};l.push((e.kind===s.StructRefKind.SpecialRef||(e.kind,s.StructRefKind.MissingRef),{kind:e.kind,resolution:e.resolution}))}if(!(0,u.isCommaOpRefWellFormed)(r))return{commaOpRef:a,resolution:(0,m.failure)((0,p.invalidStructRef)(p.InvalidStructRefReason.InvalidOp))};let c,g;for(const e of l)e.kind===s.StructRefKind.SpecialRef&&(c=(0,u.gridRangeJoinOpt)(c,null===(n=e.resolution.value)||void 0===n?void 0:n.range),void 0===g&&(g=null===(i=e.resolution.value)||void 0===i?void 0:i.sheet));if(void 0===c||void 0===g)return{commaOpRef:a,resolution:m.successUndefined};for(const e of l)if(e.kind!==s.StructRefKind.SpecialRef&&e.kind!==s.StructRefKind.MissingRef&&(c=(0,u.gridRangeIsect)(c,e.resolution.value.range),void 0===c))return{commaOpRef:a,resolution:(0,m.failure)((0,p.invalidStructRef)(p.InvalidStructRefReason.InvalidOp))};return{commaOpRef:a,resolution:(0,m.success)((0,d.sheetGridRange)(g,c))}}(e,t,r.innerRef);return{structRef:(0,s.structRef)(n,r.isClosed,r.label),resolution:i}}case s.StructRefKind.ThisRowOpRef:{const n=k(e,t,s.SpecialRefId.ThisRow);if(S(n)||void 0===r.innerRef.ref)return{structRef:r,resolution:n};const{innerRef:i,resolution:o}=r.innerRef.ref.kind===s.StructRefKind.ColumnRef?T(t,r.innerRef.ref):A(t,r.innerRef.ref),a=(0,s.thisRowOpRef)(i,i.label);if(S(o))return{structRef:(0,s.structRef)(a,r.isClosed,r.label),resolution:o};const l=(0,u.gridRangeIsect)(n.value.range,o.value.range);return l?{structRef:(0,s.structRef)(a,r.isClosed,r.label),resolution:(0,m.success)((0,d.sheetGridRange)(n.value.sheet,l))}:{structRef:r,resolution:(0,m.failure)((0,p.invalidStructRef)(p.InvalidStructRefReason.InvalidOp))}}case s.StructRefKind.BadRef:return{structRef:r,resolution:(0,m.failure)((0,p.invalidStructRef)(p.InvalidStructRefReason.InvalidOp))}}}(t,a,o);return(0,p.resolvedStructRef)(h.kind===m.ResultKind.Failure&&h.reason.kind!==p.ResolveReasonKind.EmptyIntersection?r:(0,s.structRefNode)(c,g,r.label),a,h,l)},resolveUserDefinedFunc:I,resolveDottedName:function(t,r,i){const a=r.parts,u=r.qualifier,c={names:new Array,udfs:new Array},f=i[r.label],S=(null==f?void 0:f.kind)===s.AnnotationKind.AppHeadName,T=(0,s.flattenNameParts)(a).parts,k=(0,s.nameNode)((0,s.identNamePart)(a.asWhole,a.canDenoteNamedObject,a.label,a.qualifiedLabel),u,r.label);if(C(u,T)){const[e,...t]=T,n=function(e,t){var r;const n=t[e.label],i=(null==n?void 0:n.kind)===s.AnnotationKind.LocalNameUse?n:void 0;return(0,p.resolvedLocalName)((0,s.nameNode)((0,s.identNamePart)(null!==(r=null==i?void 0:i.name)&&void 0!==r?r:e.asWhole,e.canDenoteNamedObject,e.label,e.qualifiedLabel),void 0,e.qualifiedLabel),(0,m.success)(i))}(e,i);if(void 0!==n.resolution.value)return(0,p.resolvedDottedName)((0,s.nameNode)(t.reduce(F,n.node.parts),u,r.label),n,t.map(y),c)}let P;const N=()=>{if(!P)return!1;const e=P.headResolved.resolution;return e.kind!==m.ResultKind.Success&&e.reason.kind!==p.ResolveReasonKind.InvalidQualifier||e.kind===m.ResultKind.Success&&void 0!==e.value};if(a.canDenoteNamedObject){const e=E(t,k,S?d.NameSource.AppHead:d.NameSource.Plain);if((0,n.safePush)(c.names,e.precedents),P=(0,p.resolvedDottedName)(e.node,e,[],c),N())return P}if(R(S,u,a)){const e=I(t,k);if((0,n.safePush)(c.udfs,e.precedents),P=(0,p.resolvedDottedName)(e.node,e,[],c),N())return P}if(b(t,u,T)){const[e,...n]=T,i=null!=u&&u.kind===s.QualifierKind.Ident?(0,s.sheetQualifier)(u.name,void 0,u.isQuoted,u.label):u,l=v(t,(0,s.cellRefNode)(e.ref,i,e.qualifiedLabel)),d=l.node.qualifier;return(0,o.assertTrue)("calc.lang.Resolver.resolveDottedName: resolveCellRef doesn't generate ErrorQualifier",(null==d?void 0:d.kind)!==s.QualifierKind.Error),(0,o.assertTrue)("calc.lang.Resolver.resolveDottedName: resolveCellRef doesn't touch ref",l.node.ref===e.ref),P=(0,p.resolvedDottedName)((0,s.nameNode)(a,d,r.label),l,n.map(y),c),P}if((0,l.isUnqualifiedNameNode)(r)&&(0,h.getTypedFeatureGate)("Microsoft.Office.Excel.CalcEtaLambda")&&(0,h.getTypedFeatureGate)("Microsoft.Office.Excel.EtaReducedLambdas")){const n=function(t,r){var n,i;const o=null!==(i=null===(n=t.config)||void 0===n?void 0:n.localeInfo)&&void 0!==i?i:e.config.localeInfo,a=(0,l.getEtaFuncId)(o,r.whole),u=r.parts;return(0,g.resolvedWorksheetFunc)((0,s.nameNode)((0,s.identNamePart)(void 0!==a?o.getWorksheetFuncName(a):u.asWhole,u.canDenoteNamedObject,u.label,u.qualifiedLabel),void 0,u.qualifiedLabel),(0,m.success)(a))}(t,r);if(void 0!==n.resolution.value)return(0,p.resolvedDottedName)(n.node,n,[],c)}return void 0!==P?P:(0,p.resolvedDottedName)(r,(0,p.resolvedNever)(k),[],c)}}}},62376:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedDottedName=t.resolvedNever=t.resolvedStructRef=t.resolvedLocalName=t.resolvedWorksheetFunc=t.resolvedUserDefinedFunc=t.resolvedCellRef=t.resolvedName=t.ResolvedKind=t.emptyIntersection=t.invalidStructRef=t.InvalidStructRefReason=t.invalidCellRef=t.InvalidCellRefReason=t.invalidQualifier=t.InvalidQualifierReason=t.noOriginSheet=t.ResolveReasonKind=t.resolveLocalsGrid=void 0;const n=r(93387),i=r(80873);var o,a,s,l,u;t.resolveLocalsGrid=function(e){return{originGridCell:(0,n.success)(e.range),originSheet:(0,n.success)(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}},function(e){e.NoOriginSheet="NoOriginSheet",e.InvalidQualifier="InvalidQualifier",e.InvalidCellRef="InvalidCellRef",e.InvalidStructRef="InvalidStructRef",e.EmptyIntersection="EmptyIntersection"}(o||(t.ResolveReasonKind=o={})),t.noOriginSheet=function(e){return{kind:o.NoOriginSheet,origin:e}},function(e){e.UndefinedDocument="UndefinedDocument",e.UndefinedSheetName="UndefinedSheetName",e.SheetRangeName="SheetRangeName",e.DocumentCellRef="DocumentCellRef",e.BadQualifier="BadQualifier"}(a||(t.InvalidQualifierReason=a={})),t.invalidQualifier=function(e){return{kind:o.InvalidQualifier,reason:e}},function(e){e.BadCellRef="BadCellRef"}(s||(t.InvalidCellRefReason=s={})),t.invalidCellRef=function(e){return{kind:o.InvalidCellRef,reason:e}},function(e){e.UndefinedColumnName="UndefinedColumnName",e.UndefinedTableName="UndefinedTableName",e.InvalidOriginSheet="InvalidOriginSheet",e.InvalidOp="InvalidOp",e.MissingTableName="MissingTableName",e.NamedObjectNotTable="NamedObjectNotTable"}(l||(t.InvalidStructRefReason=l={})),t.invalidStructRef=function(e){return{kind:o.InvalidStructRef,reason:e}},t.emptyIntersection={kind:o.EmptyIntersection},function(e){e.ResolvedName="ResolvedName",e.ResolvedCellRef="ResolvedCellRef",e.ResolvedUserDefinedFunc="ResolvedUserDefinedFunc",e.ResolvedWorksheetFunc="ResolvedWorksheetFunc",e.ResolvedLocalName="ResolvedLocalName",e.ResolvedStructRef="ResolvedStructRef",e.ResolvedNever="ResolvedNever",e.ResolvedDottedName="ResolvedDottedName"}(u||(t.ResolvedKind=u={})),t.resolvedName=(0,i.typedInstanceCreator)()(((e,t,r,n)=>({kind:u.ResolvedName,node:e,resolution:t,qualifierResolution:r,precedents:n}))),t.resolvedCellRef=(0,i.typedInstanceCreator)()(((e,t)=>({kind:u.ResolvedCellRef,node:e,resolution:t}))),t.resolvedUserDefinedFunc=(0,i.typedInstanceCreator)()(((e,t,r,n)=>({kind:u.ResolvedUserDefinedFunc,node:e,resolution:t,precedents:r,name:n}))),t.resolvedWorksheetFunc=(0,i.typedInstanceCreator)()(((e,t)=>({kind:u.ResolvedWorksheetFunc,node:e,resolution:t}))),t.resolvedLocalName=(0,i.typedInstanceCreator)()(((e,t)=>({kind:u.ResolvedLocalName,node:e,resolution:t}))),t.resolvedStructRef=(0,i.typedInstanceCreator)()(((e,t,r,n)=>({kind:u.ResolvedStructRef,node:e,table:t,resolution:r,precedents:n}))),t.resolvedNever=(0,i.typedInstanceCreator)()((e=>({kind:u.ResolvedNever,node:e,resolution:n.successUndefined}))),t.resolvedDottedName=(0,i.typedInstanceCreator)()(((e,t,r,n)=>({kind:u.ResolvedDottedName,node:e,headResolved:t,fieldsResolved:r,precedents:n})))},47098:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isVolatileFunc=t.getWorksheetFuncEnglishName=t.getWorksheetFuncType=t.getOperatorType=t.operatorStrings=t.OperatorId=t.higherOrderFunctionType=t.unknownFunctionType=t.WorksheetFuncId=void 0;const n=r(36745),i=r(50175);Object.defineProperty(t,"WorksheetFuncId",{enumerable:!0,get:function(){return i.WorksheetFuncId}});const o=r(88658);var a;t.unknownFunctionType=(0,n.functionType)(0,254,[],[n.SignatureType.All],[],n.SignatureType.All,n.SpecialPrecs.All,n.FunctionFlags.AllowLStrs),t.higherOrderFunctionType=function(){const e=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Rich|n.OperKind.Error|n.OperKind.Blank|((0,o.isFeatureEnabled)(o.FeatureName.CalcLambdaCellValues)?0:n.OperKind.Range)|((0,o.isFeatureEnabled)(o.FeatureName.CalcLambdaArrayLifting)?0:n.OperKind.Array),t=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Rich|n.OperKind.Error|n.OperKind.Blank|n.OperKind.Missing|n.OperKind.Array|n.OperKind.Range;return(0,n.functionType)(1,255,[e],[t],[],n.SignatureType.All,n.SpecialPrecs.None,n.FunctionFlags.Allow3dRef|n.FunctionFlags.AllowLStrs)},function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.At=24]="At",e[e.Pound=25]="Pound"}(a||(t.OperatorId=a={})),t.operatorStrings=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,"@","#"];const s=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Blank,l=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Blank,u=(0,n.functionType)(2,2,[n.OperKind.Number,n.OperKind.Number],[],[],n.OperKind.Number,n.SpecialPrecs.None,n.FunctionFlags.None),c=(0,n.functionType)(1,1,[n.OperKind.Number],[],[],n.OperKind.Number,n.SpecialPrecs.None,n.FunctionFlags.None),d=(0,n.functionType)(1,1,[s],[],[],s,n.SpecialPrecs.None,n.FunctionFlags.AllowLStrs),m=(0,n.functionType)(2,2,[n.OperKind.String,n.OperKind.String],[],[],n.OperKind.String,n.SpecialPrecs.None,n.FunctionFlags.AllowLStrs),g=(0,n.functionType)(2,2,[l,l],[],[],n.OperKind.Boolean,n.SpecialPrecs.None,n.FunctionFlags.AllowLStrs),p=(0,n.functionType)(2,2,[n.OperKind.Range,n.OperKind.Range],[],[],n.OperKind.Range,n.SpecialPrecs.AllCells,n.FunctionFlags.None),h=(0,n.functionType)(2,2,[n.OperKind.Range,n.OperKind.Range],[],[],n.OperKind.Range,n.SpecialPrecs.None,n.FunctionFlags.None),f=(0,n.functionType)(2,2,[n.OperKind.Boolean,n.OperKind.Boolean],[],[],n.OperKind.Boolean,n.SpecialPrecs.None,n.FunctionFlags.None),S=[];function v(e){const r=i.worksheetFuncTypes[e];return null!=r?r:t.unknownFunctionType}function y(e,t){const r=i.worksheetFuncTypes[e];null!=r&&(r.staticPrecs=t)}S[a.Add]=u,S[a.Sub]=u,S[a.Mul]=u,S[a.Div]=u,S[a.Pow]=u,S[a.Percent]=c,S[a.Neg]=c,S[a.At]=i.worksheetFuncTypes[i.WorksheetFuncId.SINGLE],S[a.Pound]=i.worksheetFuncTypes[i.WorksheetFuncId.ANCHORARRAY],S[a.Pos]=d,S[a.Concat]=m,S[a.Eq]=g,S[a.Ne]=g,S[a.Lt]=g,S[a.Le]=g,S[a.Gt]=g,S[a.Ge]=g,S[a.Range]=p,S[a.Isect]=h,S[a.Union]=h,S[a.And]=f,S[a.Or]=f,S[a.Xor]=f,S[a.Min]=u,S[a.Max]=u,t.getOperatorType=function(e){const r=S[e];return null!=r?r:t.unknownFunctionType},t.getWorksheetFuncType=v,t.getWorksheetFuncEnglishName=function(e){return i.worksheetFuncEnglishNames[e]},t.isVolatileFunc=function(e){return 0!=(v(e).staticPrecs&(n.SpecialPrecs.Time|n.SpecialPrecs.Calc))},y(i.WorksheetFuncId.ROW,n.SpecialPrecs.OwnRow),y(i.WorksheetFuncId.COLUMN,n.SpecialPrecs.OwnCol),y(i.WorksheetFuncId.SHEET,n.SpecialPrecs.OwnDocSheets),y(i.WorksheetFuncId.SHEETS,n.SpecialPrecs.OwnDocSheets),y(i.WorksheetFuncId.OFFSET,n.SpecialPrecs.AllCells),y(i.WorksheetFuncId.INDIRECT,n.SpecialPrecs.AllCells),y(i.WorksheetFuncId.SUMIF,n.SpecialPrecs.AllCells),y(i.WorksheetFuncId.AVERAGEIF,n.SpecialPrecs.AllCells),y(i.WorksheetFuncId.LOOKUP,n.SpecialPrecs.AllCells),y(i.WorksheetFuncId.ADDRESS,n.SpecialPrecs.RefStyle),y(i.WorksheetFuncId.FORMULATEXT,n.SpecialPrecs.RefStyle),y(i.WorksheetFuncId.NOW,n.SpecialPrecs.Time),y(i.WorksheetFuncId.TODAY,n.SpecialPrecs.Time),y(i.WorksheetFuncId.RAND,n.SpecialPrecs.Calc),y(i.WorksheetFuncId.RANDBETWEEN,n.SpecialPrecs.Calc),y(i.WorksheetFuncId.RANDARRAY,n.SpecialPrecs.Calc),y(i.WorksheetFuncId.SUBTOTAL,n.SpecialPrecs.CellProps),y(i.WorksheetFuncId.CELL,n.SpecialPrecs.CellProps|n.SpecialPrecs.AllCells),y(i.WorksheetFuncId.INFO,n.SpecialPrecs.None)},31232:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VerticalAlignment=t.HorizontalAlignment=t.BorderLineType=t.PatternType=t.FillKind=t.FontVerticalAlignment=t.FontUnderline=void 0;const n=r(80873);var i,o,a,s,l,u,c;!function(e){e.None="None",e.Single="Single",e.Double="Double",e.SingleAccounting="SingleAccounting",e.DoubleAccounting="DoubleAccounting"}(i||(t.FontUnderline=i={})),(0,n.staticAssertSame)(),function(e){e.None="None",e.Subscript="Subscript",e.Superscript="Superscript"}(o||(t.FontVerticalAlignment=o={})),(0,n.staticAssertSame)(),function(e){e.Pattern="Pattern",e.Gradient="Gradient"}(a||(t.FillKind=a={})),function(e){e.None="None",e.Solid="Solid",e.MediumGray="MediumGray",e.DarkGray="DarkGray",e.LightGray="LightGray",e.DarkHorizontal="DarkHorizontal",e.DarkVertical="DarkVertical",e.DarkDown="DarkDown",e.DarkUp="DarkUp",e.DarkGrid="DarkGrid",e.DarkTrellis="DarkTrellis",e.LightHorizontal="LightHorizontal",e.LightVertical="LightVertical",e.LightDown="LightDown",e.LightUp="LightUp",e.LightGrid="LightGrid",e.LightTrellis="LightTrellis",e.Gray125="Gray125",e.Gray0625="Gray0625"}(s||(t.PatternType=s={})),function(e){e.None="None",e.Thin="Thin",e.Medium="Medium",e.Dashed="Dashed",e.Dotted="Dotted",e.Thick="Thick",e.Double="Double",e.Hair="Hair",e.MediumDashed="MediumDashed",e.DashDot="DashDot",e.MediumDashDot="MediumDashDot",e.DashDotDot="DashDotDot",e.MediumDashDotDot="MediumDashDotDot",e.SlantDashDot="SlantDashDot"}(l||(t.BorderLineType=l={})),(0,n.staticAssertSame)(),function(e){e.Automatic="Automatic",e.Left="Left",e.Center="Center",e.Right="Right",e.Fill="Fill",e.Justify="Justify",e.CenterAcrossSelection="CenterAcrossSelection",e.Distributed="Distributed",e.JustifyDistributed="JustifyDistributed"}(u||(t.HorizontalAlignment=u={})),(0,n.staticAssertSame)(),function(e){e.Top="Top",e.Center="Center",e.Bottom="Bottom",e.Justify="Justify",e.Distributed="Distributed"}(c||(t.VerticalAlignment=c={})),(0,n.staticAssertSame)()},18702:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fieldRef=t.fieldRefNamePart=t.nameNode=t.lambdaNode=t.letNode=t.poundNode=t.atNode=t.maxNode=t.minNode=t.xorNode=t.orNode=t.andNode=t.unionNode=t.isectNode=t.rangeNode=t.geNode=t.gtNode=t.leNode=t.ltNode=t.neNode=t.eqNode=t.concatNode=t.posNode=t.negNode=t.percentNode=t.powNode=t.divNode=t.mulNode=t.subNode=t.addNode=t.badBracketNode=t.badQualNode=t.badCellRefNode=t.badParamNameNode=t.badFieldNameNode=t.badErrorLiteralNode=t.badStringLiteralNode=t.badNumberLiteralNode=t.badUnexpCharsNode=t.badFieldRefNode=t.badStructRefNode=t.badUnexpSeqNode=t.absPos=t.relPos=t.expectTrue=t.isNameLocEqual=t.createSingleRange=t.sheet1=t.sheet1Name=t.document1=void 0;const n=r(20797),i=r(9230),o=r(1194),a=r(47098);function s(e,t=0){return(0,o.badSequenceNode)(o.BadType.Unexpected,e,t)}function l(e,t=0){return(0,o.badCharsNode)(o.BadType.Unexpected,e,t)}function u(e){return function(t=0){return(0,o.operatorNode)(e,t)}}function c(e,t,r,n,i){return(0,o.fieldRef)("string"==typeof e?(0,o.identNode)(e):e,t,r,n,i)}t.document1=(0,n.documentLoc)(void 0,"Book1"),t.sheet1Name="Sheet1",t.sheet1=(0,n.sheetIndex)(t.document1,0),t.createSingleRange=function(e,r){const i=(0,n.gridCell)(e,r);return(0,n.sheetGridCell)(t.sheet1,i)},t.isNameLocEqual=function(e,t,r){return(0,i.isNameScopeEqual)(t.scope,r.scope)&&0===e.stringCompareCI(t.name,r.name)},t.expectTrue=function(e){expect(e).toBeTruthy()},t.relPos=function(e){return(0,o.pos)(o.PosKind.Rel,e)},t.absPos=function(e){return(0,o.pos)(o.PosKind.Abs,e)},t.badUnexpSeqNode=s,t.badStructRefNode=function(e,t=0){return(0,o.badSequenceNode)(o.BadType.StructRef,e,t)},t.badFieldRefNode=function(e,t=0){return(0,o.badSequenceNode)(o.BadType.FieldRef,e,t)},t.badUnexpCharsNode=l,t.badNumberLiteralNode=function(e,t=0){return(0,o.badCharsNode)(o.BadType.NumberLiteral,e,t)},t.badStringLiteralNode=function(e,t=0){return(0,o.badCharsNode)(o.BadType.StringLiteral,e,t)},t.badErrorLiteralNode=function(e,t=0){return(0,o.badCharsNode)(o.BadType.ErrorLiteral,e,t)},t.badFieldNameNode=function(e,t=0){return(0,o.badCharsNode)(o.BadType.FieldName,e,t)},t.badParamNameNode=function(e,t=0){return(0,o.badCharsNode)(o.BadType.ParamName,e,t)},t.badCellRefNode=function(e,t=e.indexOf("[")>=0,r=0,n=0){return(0,o.cellRefNode)((0,o.cellRefBad)(e,t,r),void 0,n)},t.badQualNode=function(e,t=0){return(0,o.badCharsNode)(o.BadType.Qualifier,e,t)},t.badBracketNode=function(e,t=!0){const r=[l("["),e];return t&&r.push(l("]")),s(r)},t.addNode=u(a.OperatorId.Add),t.subNode=u(a.OperatorId.Sub),t.mulNode=u(a.OperatorId.Mul),t.divNode=u(a.OperatorId.Div),t.powNode=u(a.OperatorId.Pow),t.percentNode=u(a.OperatorId.Percent),t.negNode=u(a.OperatorId.Neg),t.posNode=u(a.OperatorId.Pos),t.concatNode=u(a.OperatorId.Concat),t.eqNode=u(a.OperatorId.Eq),t.neNode=u(a.OperatorId.Ne),t.ltNode=u(a.OperatorId.Lt),t.leNode=u(a.OperatorId.Le),t.gtNode=u(a.OperatorId.Gt),t.geNode=u(a.OperatorId.Ge),t.rangeNode=u(a.OperatorId.Range),t.isectNode=u(a.OperatorId.Isect),t.unionNode=u(a.OperatorId.Union),t.andNode=u(a.OperatorId.And),t.orNode=u(a.OperatorId.Or),t.xorNode=u(a.OperatorId.Xor),t.minNode=u(a.OperatorId.Min),t.maxNode=u(a.OperatorId.Max),t.atNode=u(a.OperatorId.At),t.poundNode=u(a.OperatorId.Pound),t.letNode=function(e,t,r,n=[],i,a){const s=t.map((e=>{return t=e,Array.isArray(t)?[e[0].kind===o.NodeKind.Ident?(0,o.varNode)(e[0]):e[0],e[1]]:e;var t}));return(0,o.letNode)(e,s,r,n,i,a)},t.lambdaNode=function(e,t,r,n=[],i,a){const s=t.map((e=>void 0===e.kind||e.kind===o.NodeKind.Param?e:(0,o.paramNode)((0,o.paramName)(e,!1),void 0)));return(0,o.lambdaNode)(e,s,r,n,i,a)},t.nameNode=function(e,t,r){const n="string"==typeof e?(0,o.identNamePart)(e,!0):e;return(0,o.nameNode)(n,t,r)},t.fieldRefNamePart=function(e,t,r,n,i){const a="string"==typeof t?c(t,!1,!0,!1):t;return(0,o.fieldRefNamePart)(e,a,r,n,i)},t.fieldRef=c},36745:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.FunctionFlags=t.SpecialPrecs=t.SignatureType=t.OperKind=void 0;const n=r(57777);var i,o,a,s,l=n.assertions.assertNatural,u=n.assertions.assertFalse,c=n.assertions.assertIndex;!function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"}(i||(t.OperKind=i={})),function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"}(o||(t.SignatureType=o={})),function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.InFilterMode=4096]="InFilterMode",e[e.RefStyle=8192]="RefStyle",e[e.All=16383]="All"}(a||(t.SpecialPrecs=a={})),function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro",e[e.Chart=4]="Chart",e[e.OnlyParsedDuringLoad=8]="OnlyParsedDuringLoad",e[e.Internal=16]="Internal",e[e.Allow3dRef=32]="Allow3dRef",e[e.AllowLStrs=64]="AllowLStrs",e[e.HiddenFromUI=128]="HiddenFromUI"}(s||(t.FunctionFlags=s={})),t.functionType=function(e,t,r,n,i,o,a,s){if(l("calc.lang.functionType",t),c("calc.lang.functionType",e,t+1),0===n.length?0!==i.length:i.length>=n.length){const e=JSON.stringify(i);u(`calc.lang.functionType: expected tailTypes.length < restTypes.length; given ${e}`)}if(0===n.length&&r.length+i.length<t){const e=JSON.stringify(r);u(`calc.lang.functionType: expected headTypes.length + tailTypes.length >= ${t}; given ${e}`)}return{minArgs:e,maxArgs:t,headTypes:r,restTypes:n,tailTypes:i,returnType:o,staticPrecs:a,flags:s}}},9230:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReadOperEqual=t.isWriteOper=t.isPrimitiveOper=t.isRichOper=t.isBlankOper=t.isMissingOper=t.isArrayOper=t.isRangeOper=t.isErrorOper=t.isBooleanOper=t.isStringOper=t.isNumberOper=t.shouldFieldRefBeBracketed=t.isValidArgsLength=t.getArgType=t.isBooleanLiteralNode=t.isNumberLiteralNode=t.isMissingLiteralNode=t.isMissingNode=t.isUnqualifiedNameNode=t.isWSFNode=t.isOperatorNode=t.getArguments=t.gridCellRange=t.sheetGridRangeAnchor=t.gridRangeAnchor=t.isSheetGridRangeEqual=t.isSheetGridCellEqual=t.isGridRangeEqual=t.isGridCellEqual=t.isNameScopeEqual=t.sheetRangeToSheetIndex=t.isSheetIndexEqual=t.isDocumentLocEqual=t.gridRangeSize=t.gridRangeExcept=t.gridRangeCompare=t.gridCellImplicitIsect=t.gridRangeIsects=t.gridRangeIsect=t.gridRangesJoin=t.gridRangeJoinOpt=t.gridRangeJoin=t.forEachTileInRange=t.forEachCellInRange=t.isWellFormed=t.isSheetGridRange=t.isSheetIndex=t.isSheetGridCell=t.isGridCell=void 0,t.applyComparison=t.normalizeCommaOpRef=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isCommaOpRefWellFormed=t.getBoundName=t.getEtaFuncId=t.getUserDefinedFuncName=t.getWorksheetFuncId=t.createFailureErrorClass=t.internal=t.unavailable=t.notImplemented=t.ReasonKind=t.LangReasonKind=void 0;const n=r(83387),i=r(20797);Object.defineProperty(t,"isGridCell",{enumerable:!0,get:function(){return i.isGridCell}}),Object.defineProperty(t,"isSheetGridCell",{enumerable:!0,get:function(){return i.isSheetGridCell}});const o=r(1194),a=r(36745),s=r(93387),l=r(80873),u=r(9103),c=r(47098);var d=r(20797);function m(e,t){const{row:r,col:n,rows:o,cols:a}=e,{row:s,col:u,rows:c,cols:d}=t,m=(0,l.fastMin)(r,s),g=(0,l.fastMin)(n,u),p=(0,l.fastMax)(r+o,s+c)-m,h=(0,l.fastMax)(n+a,u+d)-g;return(0,i.unsafeGridRange)(m,g,p,h)}function g(e,t){return e===t||e.name===t.name&&e.path===t.path}function p(e,t){return g(e.document,t.document)&&e.index===t.index}function h(e,t){return e.row===t.row&&e.col===t.col}function f(e,t){return e.row===t.row&&e.col===t.col&&e.rows===t.rows&&e.cols===t.cols}function S(e){return(0,i.isGridCell)(e)?e:(0,i.unsafeGridRange)(e.row,e.col,1,1)}Object.defineProperty(t,"isSheetIndex",{enumerable:!0,get:function(){return d.isSheetIndex}}),Object.defineProperty(t,"isSheetGridRange",{enumerable:!0,get:function(){return d.isSheetGridRange}}),t.isWellFormed=function(e){return e.isWellFormed},t.forEachCellInRange=function(e,t){if((0,i.isGridCell)(e))return t(e,0,0);const{row:r,rows:n,col:o,cols:a}=e;for(let e=0;e<n;e+=1)for(let n=0;n<a;n+=1)if(!t((0,i.gridCell)(r+e,o+n),e,n))return!1;return!0},t.forEachTileInRange=function(e,t,r){const{row:o,rows:a,col:s,cols:u}=e;(0,n.assertPositiveInteger)("calc.lang.forEachTileInRange",t),(0,n.assertIndex)("calc.lang.forEachTileInRange",o,i.sheetRows),(0,n.assertIndex)("calc.lang.forEachTileInRange",s,i.sheetCols),(0,n.assertPositiveLength)("calc.lang.forEachTileInRange",a,i.sheetRows-o),(0,n.assertPositiveLength)("calc.lang.forEachTileInRange",u,i.sheetCols-s);for(let e=o;e<o+a;e+=t)for(let n=s;n<s+u;n+=t)if(!r((0,i.unsafeGridRange)(e,n,(0,l.fastMin)(t,a+o-e),(0,l.fastMin)(t,u+s-n))))return!1;return!0},t.gridRangeJoin=m,t.gridRangeJoinOpt=function(e,t){return e?t?m(e,t):e:t},t.gridRangesJoin=function(e){return 0===e.length&&(0,n.assertFalse)("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(m)},t.gridRangeIsect=function(e,t){const{row:r,col:n,rows:o,cols:a}=e,{row:s,col:u,rows:c,cols:d}=t,m=(0,l.fastMax)(r,s),g=(0,l.fastMax)(n,u),p=(0,l.fastMin)(r+o,s+c)-m,h=(0,l.fastMin)(n+a,u+d)-g;if(!(p<=0||h<=0))return(0,i.unsafeGridRange)(m,g,p,h)},t.gridRangeIsects=function(e,t){const{row:r,col:n,rows:i,cols:o}=e,{row:a,col:s,rows:u,cols:c}=t;return(0,l.fastMax)(r,a)<(0,l.fastMin)(r+i,a+u)&&(0,l.fastMax)(n,s)<(0,l.fastMin)(n+o,s+c)},t.gridCellImplicitIsect=function(e,t){const{row:r,col:n}=e,{row:o,col:a,rows:s,cols:l}=t,u=o<=r&&r<o+s,c=a<=n&&n<a+l;return u&&c?(0,i.gridCell)(r,n):u&&1===l?(0,i.gridCell)(r,a):c&&1===s?(0,i.gridCell)(o,n):1===l&&1===s?(0,i.gridCell)(o,a):void 0},t.gridRangeCompare=function(e,t){const{row:r,col:n,rows:i,cols:o}=e,{row:a,col:s,rows:l,cols:u}=t,c=r+i,d=a+l,m=n+o,g=s+u;return r===a&&c===d&&n===s&&m===g?0:r<=a&&c>=d&&n<=s&&m>=g?1:r>=a&&c<=d&&n>=s&&m<=g?-1:void 0},t.gridRangeExcept=function(e,t){const r=[e.row,e.row+e.rows],n=[e.col,e.col+e.cols],o=[t.row,t.row+t.rows],a=[t.col,t.col+t.cols],s=(0,u.ivlCompare)(r,o),l=(0,u.ivlCompare)(n,a);if(void 0!==s&&s<=0){const t=(0,u.ivlExcept)(n,a);if(void 0!==t)return(0,i.gridRange)(e.row,t[0],e.rows,t[1]-t[0])}if(void 0!==l&&l<=0){const t=(0,u.ivlExcept)(r,o);if(void 0!==t)return(0,i.gridRange)(t[0],e.col,t[1]-t[0],e.cols)}},t.gridRangeSize=function(e){return e.rows*e.cols},t.isDocumentLocEqual=g,t.isSheetIndexEqual=p,t.sheetRangeToSheetIndex=function(e){if(e.index===e.index2)return Object.assign(Object.assign({},e),{__isRange:!1})},t.isNameScopeEqual=function(e,t){return g(e.document,t.document)&&e.index===t.index},t.isGridCellEqual=h,t.isGridRangeEqual=f,t.isSheetGridCellEqual=function(e,t){return p(e.sheet,t.sheet)&&h(e.range,t.range)},t.isSheetGridRangeEqual=function(e,t){return p(e.sheet,t.sheet)&&f(e.range,t.range)},t.gridRangeAnchor=S,t.sheetGridRangeAnchor=function(e){return(0,i.isSheetGridCell)(e)?e:(0,i.sheetGridCell)(e.sheet,S(e.range))},t.gridCellRange=function(e,t){const{row:r,col:n}=e,{row:o,col:a}=t;return(0,i.unsafeGridRange)((0,l.fastMin)(r,o),(0,l.fastMin)(n,a),Math.abs(o-r)+1,Math.abs(a-n)+1)};const v=[];function y(e){return e.kind===o.NodeKind.Literal&&b(e.oper)}function F(e){return e.kind===o.NodeKind.Literal&&R(e.oper)}function C(e){return e.kind===a.OperKind.Number}function R(e){return e.kind===a.OperKind.Boolean}function b(e){return e.kind===a.OperKind.Missing}t.getArguments=function(e){return 0===function(e){return 1===e.length&&y(e[0])?0:e.length}(e)?v:e},t.isOperatorNode=function(e){return e.kind===o.NodeKind.Operator},t.isWSFNode=function(e){return e.kind===o.NodeKind.WSF},t.isUnqualifiedNameNode=function(e){return e.kind===o.NodeKind.Name&&void 0===e.qualifier},t.isMissingNode=function(e){return e.kind===o.NodeKind.Missing},t.isMissingLiteralNode=y,t.isNumberLiteralNode=function(e){return e.kind===o.NodeKind.Literal&&C(e.oper)},t.isBooleanLiteralNode=F,t.getArgType=function({maxArgs:e,headTypes:t,restTypes:r,tailTypes:i},o,s){if((0,n.assertPositiveInteger)("calc.runtime.getArgType: n",s),(0,n.assertIndex)("calc.runtime.getArgType: i",o,s),o>=e)return a.SignatureType.None;if(o<t.length)return t[o];if(0===r.length)return a.SignatureType.None;if(o<t.length+r.length)return r[o-t.length];const l=(s-t.length)%r.length;return l>i.length?a.SignatureType.None:o>=s-l?i[o-(s-l)]:r[(o-t.length)%r.length]},t.isValidArgsLength=function({minArgs:e,maxArgs:t,headTypes:r,restTypes:n,tailTypes:i},o){return!(o<e||o>t)&&(o<=r.length+n.length||0!==n.length&&(o-r.length)%n.length<=i.length)},t.shouldFieldRefBeBracketed=function(e,t,r){if(0===r.length)return!1;if(t.field.kind!==o.NodeKind.Ident)return!1;let n=e;for(;n.kind===o.NodeKind.App&&n.head.kind===o.NodeKind.Operator;){const e=n.head.id;if(e!==c.OperatorId.Range&&e!==c.OperatorId.Isect||2!==n.args.length)break;n=n.args[1]}return F(n)||n.kind===o.NodeKind.Name||n.kind===o.NodeKind.CellRef},t.isNumberOper=C,t.isStringOper=function(e){return e.kind===a.OperKind.String},t.isBooleanOper=R,t.isErrorOper=function(e){return e.kind===a.OperKind.Error},t.isRangeOper=function(e){return e.kind===a.OperKind.Range},t.isArrayOper=function(e){return e.kind===a.OperKind.Array},t.isMissingOper=b,t.isBlankOper=function(e){return e.kind===a.OperKind.Blank},t.isRichOper=function(e){return e.kind===a.OperKind.Rich};const E=a.OperKind.Number|a.OperKind.String|a.OperKind.Boolean;t.isPrimitiveOper=function(e){return 0!=(e.kind&E)};const T=E|a.OperKind.Error|a.OperKind.Array|a.OperKind.Rich;var k;t.isWriteOper=function(e){return 0!=(e.kind&T)},t.isReadOperEqual=function e(t,r,i,o){if(i.kind!==r.kind)return!1;switch(i.kind){case a.OperKind.Boolean:case a.OperKind.String:return i.value===r.value;case a.OperKind.Number:return 0===t.cond2(i,r);case a.OperKind.Error:return i.type===r.type;case a.OperKind.Rich:return o;case a.OperKind.Array:const s=r;if(i.cols!==s.cols||i.rows!==s.rows)return!1;for(let r=0;r<i.rows;r+=1){const n=i.opers[r],a=s.opers[r];for(let r=0;r<i.cols;r+=1)if(!e(t,a[r],n[r],o))return!1}return!0;case a.OperKind.Blank:return!0;default:return(0,n.assertNever)("calc.lang.readOperEq",i)}},function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable",e.Internal="Internal"}(k||(t.LangReasonKind=k={})),t.ReasonKind=Object.assign(Object.assign({},s.ReasonKind),k),t.notImplemented=function(e){return{kind:t.ReasonKind.NotImplemented,features:e}},t.unavailable=function(e,...r){return 0===e.length&&(0,n.assertFalse)("calc.lang.unavailable: expected nonempty array"),{kind:t.ReasonKind.Unavailable,objects:e}},t.internal=function(e){return{kind:t.ReasonKind.Internal,message:e}},t.createFailureErrorClass=function(e){const t=function(t){this.reason=t,this.name=e,this.stack=e,this.message=t.kind};return(t.prototype=Object.create(Error.prototype)).constructor=t,t};t.getWorksheetFuncId=function(e,t){let r=t;return r.length>6&&0===e.stringCompareCI(r.substring(0,6),"_xlfn.")&&(r=r.substring(6),r.length>6&&0===e.stringCompareCI(r.substring(0,6),"_xlws.")&&(r=r.substring(6))),e.getWorksheetFuncId(r)};t.getUserDefinedFuncName=function(e,t){let r=t;return r.length>7&&0===e.stringCompareCI(r.substring(0,7),"_xludf.")&&(r=r.substring(7)),r};t.getEtaFuncId=function(e,t){let r=t;return r.length>7&&0===e.stringCompareCI(r.substring(0,7),"_xleta.")&&(r=r.substring(7)),e.getWorksheetFuncId(r)};function P(e){return e.kind!==o.StructRefKind.SpecialRef&&e.kind!==o.StructRefKind.BadRef||e.isBracketed}function N(e){return e.kind===o.StructRefKind.MissingRef||e.kind===o.StructRefKind.BadRef}function A(e){switch(e.kind){case o.StructRefKind.SpecialRef:case o.StructRefKind.ColumnRef:return e.isClosed;case o.StructRefKind.RangeOpRef:return A(e.lhs)&&A(e.rhs);case o.StructRefKind.MissingRef:return!0;case o.StructRefKind.BadRef:return e.isClosed}}t.getBoundName=function(e,t){let r=t;return r.length>6&&0===e.stringCompareCI(r.substring(0,6),"_xlpm.")&&(r=r.substring(6)),r},t.isCommaOpRefWellFormed=function(e){return e.columnRefs.length<=1&&e.refs.every(P)&&function({specialRefs:e}){const t=Object.keys(e).reduce(((t,r)=>t+(e[Number(r)]?1:0)),0);return 1===t||2===t&&e[o.SpecialRefId.Data]&&(e[o.SpecialRefId.Headers]||e[o.SpecialRefId.Totals])}(e)},t.isCommaOpClosed=function(e){return e.refs.every(A)},t.isCommaOpNoBadOrMissing=function(e){return!e.refs.some(N)},t.isRangeOpClosed=function(e){return A(e.lhs)&&A(e.rhs)},t.isRangeOpNoMissing=function(e){return!N(e.lhs)&&!N(e.rhs)};const I={[o.SpecialRefId.All]:1,[o.SpecialRefId.Headers]:2,[o.SpecialRefId.Data]:3,[o.SpecialRefId.Totals]:4,[o.SpecialRefId.ThisRow]:5},O=e=>e.kind===o.StructRefKind.MissingRef?7:e.kind!==o.StructRefKind.SpecialRef?6:I[e.id];function _(e,t){return O(e)-O(t)}t.normalizeCommaOpRef=function(e){const t={},r=[];for(const n of e.refs)n.kind!==o.StructRefKind.SpecialRef?r.push(n):void 0===t[n.id]&&(t[n.id]=!0,r.push(n));return r.sort(_),r},t.applyComparison=function(e,t){switch(e){case c.OperatorId.Eq:return 0===t;case c.OperatorId.Ne:return 0!==t;case c.OperatorId.Lt:return t<0;case c.OperatorId.Gt:return t>0;case c.OperatorId.Le:return t<=0;case c.OperatorId.Ge:return t>=0}}},15833:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.falseOper=t.trueOper=t.blankOper=t.missingOper=t.range3DOper=t.rangeSeqOper=t.arrayOper=t.externalErrorOper=t.busyErrorOper=t.calcErrorOper=t.fieldErrorOper=t.unknownErrorOper=t.blockedErrorOper=t.connectErrorOper=t.spillErrorOper=t.gettingDataErrorOper=t.naErrorOper=t.numErrorOper=t.nameErrorOper=t.refErrorOper=t.valueErrorOper=t.div0ErrorOper=t.nullErrorOper=t.errorOper=t.stringOper=t.booleanOper=t.precedents=t.ErrorType=t.cellStringLimit=t.PrecsBound=void 0;const n=r(57777);var i=n.assertions.assertNatural,o=n.assertions.assertPositiveInteger,a=n.assertions.assertFalse,s=n.util.partialArray;const l=r(36745);var u,c;function d(e){return{kind:l.OperKind.Error,type:e}}!function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Upper=1]="Upper"}(u||(t.PrecsBound=u={})),t.cellStringLimit=32767,function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.SPILL=9]="SPILL",e[e.CONNECT=10]="CONNECT",e[e.BLOCKED=11]="BLOCKED",e[e.UNKNOWN=12]="UNKNOWN",e[e.FIELD=13]="FIELD",e[e.CALC=14]="CALC",e[e.BUSY=16]="BUSY",e[e.EXTERNAL=19]="EXTERNAL",e[e.TIMEOUT=20]="TIMEOUT"}(c||(t.ErrorType=c={})),t.precedents=function(e,t,r,n,i){return{cells:e,names:t,udfs:r,special:n,bound:i}},t.booleanOper=function(e){return e?t.trueOper:t.falseOper},t.stringOper=function(e){return{kind:l.OperKind.String,value:e}},t.errorOper=function(e){const t=m[e];return void 0!==t?t:d(e)},t.nullErrorOper=d(c.NULL),t.div0ErrorOper=d(c.DIV0),t.valueErrorOper=d(c.VALUE),t.refErrorOper=d(c.REF),t.nameErrorOper=d(c.NAME),t.numErrorOper=d(c.NUM),t.naErrorOper=d(c.NA),t.gettingDataErrorOper=d(c.GETTING_DATA),t.spillErrorOper=d(c.SPILL),t.connectErrorOper=d(c.CONNECT),t.blockedErrorOper=d(c.BLOCKED),t.unknownErrorOper=d(c.UNKNOWN),t.fieldErrorOper=d(c.FIELD),t.calcErrorOper=d(c.CALC),t.busyErrorOper=d(c.BUSY),t.externalErrorOper=d(c.EXTERNAL);const m=s({[c.NULL]:t.nullErrorOper,[c.DIV0]:t.div0ErrorOper,[c.VALUE]:t.valueErrorOper,[c.REF]:t.refErrorOper,[c.NAME]:t.nameErrorOper,[c.NUM]:t.numErrorOper,[c.NA]:t.naErrorOper,[c.GETTING_DATA]:t.gettingDataErrorOper,[c.SPILL]:t.spillErrorOper,[c.CONNECT]:t.connectErrorOper,[c.BLOCKED]:t.blockedErrorOper,[c.UNKNOWN]:t.unknownErrorOper,[c.FIELD]:t.fieldErrorOper,[c.CALC]:t.calcErrorOper,[c.BUSY]:t.busyErrorOper,[c.EXTERNAL]:t.externalErrorOper});t.arrayOper=function(e,t,r){return i("calc.lang.arrayOper",e),i("calc.lang.arrayOper",t),r.length!==e?a("calc.lang.arrayOper: Inconsistent row number"):{kind:l.OperKind.Array,rows:e,cols:t,opers:r}},t.rangeSeqOper=function(e,t){return o("calc.lang.rangeSeqOper",t.length),{kind:l.OperKind.Range,sheets:e,ranges:t}},t.range3DOper=function(e,t){return{kind:l.OperKind.Range,sheets:e,ranges:[t]}},t.missingOper={kind:l.OperKind.Missing},t.blankOper={kind:l.OperKind.Blank},t.trueOper={kind:l.OperKind.Boolean,value:!0},t.falseOper={kind:l.OperKind.Boolean,value:!1}},64198:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reducePledge=t.reduceTopDown_Pledge=t.reduceBottomUp=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_Pledge=t.PledgeReducer=t.reduceBottomUp_CPS=t.reduceBottomUp_Recursive=t.zipVisitor=t.ZipVisitor=t.depthVisitor=t.composeVisitor=t.ComposeVisitor=t.binaryVisitor=t.BinaryVisitor=t.DelegatingVisitor=t.voidVisitor=t.constVisitor=t.ConstVisitor=t.identityVisitor=t.IdentityVisitor=t.bindVisitor=t.visitCellRef=t.visitQualifier=t.visitAppHeadNode=t.visitWSFNode=t.visitOperatorNode=t.visitFormulaNode=void 0;const n=r(83387),i=r(80873),o=r(31174),a=r(1194),s=r(1194);function l(e,t){switch(t.kind){case s.NodeKind.Literal:{const{oper:r,isClosed:n,label:i}=t;return e.literalNode(r,n,i)}case s.NodeKind.Array:{const{nodes:r,isClosed:n,label:i}=t;return e.arrayNode(r,n,i)}case s.NodeKind.App:{const{head:r,args:n,isClosed:i,label:o}=t;return e.appNode(r,n,i,o)}case s.NodeKind.Let:{const{head:r,vars:n,body:i,badArgs:o,isClosed:a,label:s}=t;return e.letNode(r,n,i,o,a,s)}case s.NodeKind.Lambda:{const{head:r,params:n,body:i,badArgs:o,isClosed:a,label:s}=t;return e.lambdaNode(r,n,i,o,a,s)}case s.NodeKind.Paren:{const{node:r,isClosed:n,label:i}=t;return e.parenNode(r,n,i)}case s.NodeKind.Name:{const{parts:r,qualifier:n,label:i}=t;return e.nameNode(r,n,i)}case s.NodeKind.CellRef:{const{ref:r,qualifier:n,label:i}=t;return e.cellRefNode(r,n,i)}case s.NodeKind.FieldRef:{const{lhs:r,rhs:n,label:i}=t;return e.fieldRefNode(r,n,i)}case s.NodeKind.StructRef:{const{lhs:r,rhs:n,label:i}=t;return e.structRefNode(r,n,i)}case s.NodeKind.Missing:{const{chars:r,label:n}=t;return e.missingNode(r,n)}case s.NodeKind.BadChars:{const{type:r,chars:n,label:i}=t;return e.badCharsNode(r,n,i)}case s.NodeKind.BadSequence:{const{type:r,contents:n,label:i}=t;return e.badSequenceNode(r,n,i)}default:return(0,n.assertNever)("calc.lang.visitFormulaNode",t)}}function u(e,t){const{id:r,label:n}=t;return e.operatorNode(r,n)}function c(e,t){const{id:r,whole:n,label:i}=t;return e.wsfNode(r,n,i)}function d(e,t){switch(t.kind){case s.NodeKind.Operator:return u(e,t);case s.NodeKind.WSF:return c(e,t);default:return l(e,t)}}function m(e){return{literalNode:e.literalNode.bind(e),arrayNode:e.arrayNode.bind(e),appNode:e.appNode.bind(e),letNode:e.letNode.bind(e),lambdaNode:e.lambdaNode.bind(e),parenNode:e.parenNode.bind(e),nameNode:e.nameNode.bind(e),cellRefNode:e.cellRefNode.bind(e),fieldRefNode:e.fieldRefNode.bind(e),structRefNode:e.structRefNode.bind(e),missingNode:e.missingNode.bind(e),badSequenceNode:e.badSequenceNode.bind(e),badCharsNode:e.badCharsNode.bind(e),operatorNode:e.operatorNode.bind(e),wsfNode:e.wsfNode.bind(e)}}t.visitFormulaNode=l,t.visitOperatorNode=u,t.visitWSFNode=c,t.visitAppHeadNode=d,t.visitQualifier=function(e,t){switch(t.kind){case s.QualifierKind.Error:{const{label:r}=t;return e.errorQualifier(r)}case s.QualifierKind.Relative:{const{label:r}=t;return e.relativeQualifier(r)}case s.QualifierKind.Document:{const{document:r,path:n,isQuoted:i,label:o}=t;return e.documentQualifier(r,n,i,o)}case s.QualifierKind.Sheet:{const{sheet:r,document:n,isQuoted:i,label:o}=t;return e.sheetQualifier(r,n,i,o)}case s.QualifierKind.Ident:{const{name:r,isQuoted:n,label:i}=t;return e.identQualifier(r,n,i)}case s.QualifierKind.SheetRange:{const{sheet1:r,sheet2:n,document:i,isQuoted:o,label:a}=t;return e.sheetRangeQualifier(r,n,i,o,a)}case s.QualifierKind.Bad:{const{chars:r,isQuoted:n,isClosed:i,isTerminated:o,label:a}=t;return e.badQualifier(r,n,i,o,a)}default:return(0,n.assertNever)("calc.lang.visitQualifier",t)}},t.visitCellRef=function(e,t){switch(t.kind){case s.CellRefKind.Error:{const{label:r}=t;return e.cellRefError(r)}case s.CellRefKind.Single:{const{row:r,col:n,isBracketed:i,label:o}=t;return e.cellRefSingle(r,n,i,o)}case s.CellRefKind.Range:{const{ref1:r,ref2:n,label:i}=t;return e.cellRefRange(r,n,i)}case s.CellRefKind.Row:{const{row1:r,row2:n,isBracketed:i,label:o}=t;return e.cellRefRow(r,n,i,o)}case s.CellRefKind.Col:{const{col1:r,col2:n,isBracketed:i,label:o}=t;return e.cellRefCol(r,n,i,o)}case s.CellRefKind.Bad:{const{chars:r,isBracketed:n,label:i}=t;return e.cellRefBad(r,n,i)}default:return(0,n.assertNever)("calc.lang.visitCellRef",t)}},t.bindVisitor=m;class g{literalNode(e,t,r){return(0,s.literalNode)(e,t,r)}arrayNode(e,t,r){return(0,s.arrayNode)(e,t,r)}appNode(e,t,r,n){return(0,s.appNode)(e,t,r,n)}letNode(e,t,r,n,i,o){return(0,s.letNode)(e,t,r,n,i,o)}lambdaNode(e,t,r,n,i,o){return(0,s.lambdaNode)(e,t,r,n,i,o)}parenNode(e,t,r){return(0,s.parenNode)(e,t,r)}nameNode(e,t,r){return(0,s.nameNode)(e,t,r)}cellRefNode(e,t,r){return(0,s.cellRefNode)(e,t,r)}fieldRefNode(e,t,r){return(0,s.fieldRefNode)(e,t,r)}structRefNode(e,t,r){return(0,s.structRefNode)(e,t,r)}missingNode(e,t){return(0,s.missingNode)(e,t)}badSequenceNode(e,t,r){return(0,a.badSequenceNode)(e,t,r)}badCharsNode(e,t,r){return(0,a.badCharsNode)(e,t,r)}operatorNode(e,t){return(0,s.operatorNode)(e,t)}wsfNode(e,t,r){return(0,s.wsfNode)(e,t,r)}}t.IdentityVisitor=g,t.identityVisitor=m(new g);class p{literalNode(e,t,r){return this.value}arrayNode(e,t,r){return this.value}appNode(e,t,r,n){return this.value}letNode(e,t,r,n,i,o){return this.value}lambdaNode(e,t,r,n,i,o){return this.value}parenNode(e,t,r){return this.value}nameNode(e,t,r){return this.value}cellRefNode(e,t,r){return this.value}fieldRefNode(e,t,r){return this.value}structRefNode(e,t,r){return this.value}missingNode(e,t){return this.value}badSequenceNode(e,t,r){return this.value}badCharsNode(e,t,r){return this.value}operatorNode(e,t){return this.value}wsfNode(e,t,r){return this.value}constructor(e){this.value=e}}function h(e){return m(new p(e))}t.ConstVisitor=p,t.constVisitor=h,t.voidVisitor=h(void 0);class f{literalNode(e,t,r){return this.visitor.literalNode(e,t,r)}arrayNode(e,t,r){return this.visitor.arrayNode(e,t,r)}appNode(e,t,r,n){return this.visitor.appNode(e,t,r,n)}letNode(e,t,r,n,i,o){return this.visitor.letNode(e,t,r,n,i,o)}lambdaNode(e,t,r,n,i,o){return this.visitor.lambdaNode(e,t,r,n,i,o)}parenNode(e,t,r){return this.visitor.parenNode(e,t,r)}nameNode(e,t,r){return this.visitor.nameNode(e,t,r)}cellRefNode(e,t,r){return this.visitor.cellRefNode(e,t,r)}fieldRefNode(e,t,r){return this.visitor.fieldRefNode(e,t,r)}structRefNode(e,t,r){return this.visitor.structRefNode(e,t,r)}missingNode(e,t){return this.visitor.missingNode(e,t)}badSequenceNode(e,t,r){return this.visitor.badSequenceNode(e,t,r)}badCharsNode(e,t,r){return this.visitor.badCharsNode(e,t,r)}operatorNode(e,t){return this.visitor.operatorNode(e,t)}wsfNode(e,t,r){return this.visitor.wsfNode(e,t,r)}constructor(e){this.visitor=e}}t.DelegatingVisitor=f;class S extends f{arrayNode(e,t,r){return(0,n.assertTrue)("calc.lang.binaryVisitor: non-empty array",e.length>0&&e[0].length>0),e.map((e=>e.reduce(this.reducer))).reduce(this.reducer)}appNode(e,t,r,n){return t.reduce(this.reducer,e)}letNode(e,t,r,n,i,o){return[...t.map((({binder:e})=>e.arg)),...void 0===r?[]:[r.arg],...n.map((e=>e.arg))].reduce(this.reducer,e)}lambdaNode(e,t,r,n,o,a){return[...t.map((({name:e})=>{var t;return null===(t=e.arg.def)||void 0===t?void 0:t.rhs})).filter(i.isDefined),...void 0===r?[]:[r.arg],...n.map((e=>e.arg))].reduce(this.reducer,e)}parenNode(e,t,r){return e}fieldRefNode(e,t,r){return e}badSequenceNode(e,t,r){return(0,n.assertTrue)("calc.lang.binaryVisitor: non-empty bad-sequence",t.length>0),t.reduce(this.reducer)}constructor(e,t){super(e),this.reducer=(e,r)=>t(e,r)}}function v(e,t){return m(new S(e,t))}t.BinaryVisitor=S,t.binaryVisitor=v;class y{literalNode(e,t,r){return this.b(this.a.literalNode(e,t,r))}arrayNode(e,t,r){return this.b(this.a.arrayNode(e,t,r))}appNode(e,t,r,n){return this.b(this.a.appNode(e,t,r,n))}letNode(e,t,r,n,i,o){return this.b(this.a.letNode(e,t,r,n,i,o))}lambdaNode(e,t,r,n,i,o){return this.b(this.a.lambdaNode(e,t,r,n,i,o))}parenNode(e,t,r){return this.b(this.a.parenNode(e,t,r))}nameNode(e,t,r){return this.b(this.a.nameNode(e,t,r))}cellRefNode(e,t,r){return this.b(this.a.cellRefNode(e,t,r))}fieldRefNode(e,t,r){return this.b(this.a.fieldRefNode(e,t,r))}structRefNode(e,t,r){return this.b(this.a.structRefNode(e,t,r))}missingNode(e,t){return this.b(this.a.missingNode(e,t))}badSequenceNode(e,t,r){return this.b(this.a.badSequenceNode(e,t,r))}badCharsNode(e,t,r){return this.b(this.a.badCharsNode(e,t,r))}operatorNode(e,t){return this.b(this.a.operatorNode(e,t))}wsfNode(e,t,r){return this.b(this.a.wsfNode(e,t,r))}constructor(e,t){this.a=e,this.b=t}}function F(e,t){return m(new y(e,t))}t.ComposeVisitor=y,t.composeVisitor=F,t.depthVisitor=F(v(h(0),i.fastMax),(e=>e+1));class C{literalNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].literalNode(e,t,r);return n}arrayNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].arrayNode(e,t,r);return n}appNode(e,t,r,n){const i={};for(const o of this.keys)i[o]=this.visitors[o].appNode(e,t,r,n);return i}letNode(e,t,r,n,i,o){const a={};for(const s of this.keys)a[s]=this.visitors[s].letNode(e,t,r,n,i,o);return a}lambdaNode(e,t,r,n,i,o){const a={};for(const s of this.keys)a[s]=this.visitors[s].lambdaNode(e,t,r,n,i,o);return a}parenNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].parenNode(e,t,r);return n}nameNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].nameNode(e,t,r);return n}cellRefNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].cellRefNode(e,t,r);return n}fieldRefNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].fieldRefNode(e,t,r);return n}structRefNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].structRefNode(e,t,r);return n}missingNode(e,t){const r={};for(const n of this.keys)r[n]=this.visitors[n].missingNode(e,t);return r}badSequenceNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].badSequenceNode(e,t,r);return n}badCharsNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].badCharsNode(e,t,r);return n}operatorNode(e,t){const r={};for(const n of this.keys)r[n]=this.visitors[n].operatorNode(e,t);return r}wsfNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].wsfNode(e,t,r);return n}constructor(e){this.visitors=e,this.keys=Object.keys(e)}}function R(e,t){const r=t=>{switch(t.kind){case s.NodeKind.Literal:{const{oper:r,isClosed:n,label:i}=t;return e.literalNode(r,n,i)}case s.NodeKind.Array:{const{nodes:n,isClosed:i,label:o}=t;return e.arrayNode(n.map((e=>e.map(r))),i,o)}case s.NodeKind.App:{const{head:n,args:i,isClosed:o,label:a}=t;return e.appNode((t=>{switch(t.kind){case s.NodeKind.Operator:return u(e,t);case s.NodeKind.WSF:return c(e,t);default:return r(t)}})(n),i.map(r),o,a)}case s.NodeKind.Let:{const{head:n,vars:i,body:o,badArgs:a,isClosed:l,label:u}=t;return e.letNode(c(e,n),i.map((({name:e,binder:t})=>(0,s.letVar)(e,(0,s.indexedArg)(r(t.arg),t.index)))),void 0===o?void 0:(0,s.indexedArg)(r(o.arg),o.index),a.map((e=>(0,s.indexedArg)(r(e.arg),e.index))),l,u)}case s.NodeKind.Lambda:{const{head:n,params:i,body:o,badArgs:a,isClosed:l,label:u}=t;return e.lambdaNode(c(e,n),i.map((({name:e})=>void 0===e.arg.def?(0,s.lambdaParam)(e):(0,s.lambdaParam)((0,s.indexedArg)((0,s.paramNode)(e.arg.name,(0,s.paramDefault)(r(e.arg.def.rhs),e.arg.def.label),e.arg.label),e.index)))),void 0===o?void 0:(0,s.indexedArg)(r(o.arg),o.index),a.map((e=>(0,s.indexedArg)(r(e.arg),e.index))),l,u)}case s.NodeKind.Paren:{const{node:n,isClosed:i,label:o}=t;return e.parenNode(r(n),i,o)}case s.NodeKind.Name:{const{parts:r,qualifier:n,label:i}=t;return e.nameNode(r,n,i)}case s.NodeKind.CellRef:{const{ref:r,qualifier:n,label:i}=t;return e.cellRefNode(r,n,i)}case s.NodeKind.FieldRef:{const{lhs:n,rhs:i,label:o}=t;return e.fieldRefNode(r(n),i,o)}case s.NodeKind.StructRef:{const{lhs:r,rhs:n,label:i}=t;return e.structRefNode(r,n,i)}case s.NodeKind.Missing:{const{chars:r,label:n}=t;return e.missingNode(r,n)}case s.NodeKind.BadChars:{const{type:r,chars:n,label:i}=t;return e.badCharsNode(r,n,i)}case s.NodeKind.BadSequence:{const{type:n,contents:i,label:o}=t;return e.badSequenceNode(n,i.map(r),o)}default:return(0,n.assertNever)("calc.lang.reduceBottomUp_Recursive",t)}};return r(t)}function b(e,t,r,n){const i=[],o=e=>(i.push(e),a),a=()=>i.length<t.length?r(e,t[i.length],o):n(i);return a}function E(e,t,r){return b(e,t,I,r)}function T(e,t,r,n){return()=>void 0!==t?r(e,t,n):n(void 0)}function k(e,t,r){const{id:n,whole:i,label:o}=t;return()=>r(e.wsfNode(n,i,o))}function P(e,{name:t,binder:r},n){return I(e,r.arg,(e=>n((0,s.letVar)(t,(0,s.indexedArg)(e,r.index)))))}function N(e,{name:t},r){const n=t.arg;return void 0===n.def?()=>r((0,s.lambdaParam)(t)):I(e,n.def.rhs,(e=>r((0,s.lambdaParam)((0,s.indexedArg)((0,s.paramNode)(n.name,(0,s.paramDefault)(e,n.def.label),n.label),t.index)))))}function A(e,{arg:t,index:r},n){return I(e,t,(e=>n((0,s.indexedArg)(e,r))))}function I(e,t,r){switch(t.kind){case s.NodeKind.Literal:{const{oper:n,isClosed:i,label:o}=t;return()=>r(e.literalNode(n,i,o))}case s.NodeKind.Array:{const{nodes:n,isClosed:i,label:o}=t;return b(e,n,E,(t=>r(e.arrayNode(t,i,o))))}case s.NodeKind.App:{const{head:n,args:i,isClosed:o,label:a}=t;return()=>function(e,t,r){switch(t.kind){case s.NodeKind.Operator:{const{id:n,label:i}=t;return()=>r(e.operatorNode(n,i))}case s.NodeKind.WSF:return k(e,t,r);default:return I(e,t,r)}}(e,n,(t=>E(e,i,(n=>r(e.appNode(t,n,o,a))))))}case s.NodeKind.Let:{const{head:n,vars:i,body:o,badArgs:a,isClosed:s,label:l}=t;return()=>k(e,n,(t=>b(e,i,P,(n=>T(e,o,A,(i=>b(e,a,A,(o=>r(e.letNode(t,n,i,o,s,l))))))))))}case s.NodeKind.Lambda:{const{head:n,params:i,body:o,badArgs:a,isClosed:s,label:l}=t;return()=>k(e,n,(t=>()=>b(e,i,N,(n=>T(e,o,A,(i=>b(e,a,A,(o=>r(e.lambdaNode(t,n,i,o,s,l))))))))))}case s.NodeKind.Paren:{const{node:n,isClosed:i,label:o}=t;return()=>I(e,n,(t=>()=>r(e.parenNode(t,i,o))))}case s.NodeKind.Name:{const{parts:n,qualifier:i,label:o}=t;return()=>r(e.nameNode(n,i,o))}case s.NodeKind.CellRef:{const{ref:n,qualifier:i,label:o}=t;return()=>r(e.cellRefNode(n,i,o))}case s.NodeKind.FieldRef:{const{lhs:n,rhs:i,label:o}=t;return()=>I(e,n,(t=>()=>r(e.fieldRefNode(t,i,o))))}case s.NodeKind.StructRef:{const{lhs:n,rhs:i,label:o}=t;return()=>r(e.structRefNode(n,i,o))}case s.NodeKind.Missing:{const{chars:n,label:i}=t;return()=>r(e.missingNode(n,i))}case s.NodeKind.BadChars:{const{type:n,chars:i,label:o}=t;return()=>r(e.badCharsNode(n,i,o))}case s.NodeKind.BadSequence:{const{type:n,contents:i,label:o}=t;return E(e,i,(t=>r(e.badSequenceNode(n,t,o))))}default:return(0,n.assertNever)("calc.lang.reduceBottomUp_CPS",t)}}function O(e,t){let r;return function(e){let t=e;for(;null!=t;)t=t()}(I(e,t,(e=>{r=e}))),r}t.ZipVisitor=C,t.zipVisitor=function(e){return m(new C(e))},t.reduceBottomUp_Recursive=R,t.reduceBottomUp_CPS=O;class _{literalNode(e,t,r){return o.Pledge.try((()=>this.visitor.literalNode(e,t,r)))}arrayNode(e,t,r){return o.Pledge.all(e.map((e=>o.Pledge.all(e.map(this.lazyVisitFormulaNode))))).bind((e=>this.visitor.arrayNode(e,t,r)))}appNode(e,t,r,n){return this.lazyVisitAppHeadNode(e).bind((e=>o.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((t=>this.visitor.appNode(e,t,r,n)))))}letNode(e,t,r,n,i,a){return this.lazyVisitWSFNode(e).bind((e=>o.Pledge.all(t.map(this.lazyVisitVar)).bind((t=>(void 0===r?o.Pledge.resolve(void 0):this.lazyVisitIndexedArg(r)).bind((r=>o.Pledge.all(n.map(this.lazyVisitIndexedArg)).bind((n=>this.visitor.letNode(e,t,r,n,i,a)))))))))}lambdaNode(e,t,r,n,i,a){return this.lazyVisitWSFNode(e).bind((e=>o.Pledge.all(t.map(this.lazyVisitParam)).bind((t=>(void 0===r?o.Pledge.resolve(void 0):this.lazyVisitIndexedArg(r)).bind((r=>o.Pledge.all(n.map(this.lazyVisitIndexedArg)).bind((n=>this.visitor.lambdaNode(e,t,r,n,i,a)))))))))}parenNode(e,t,r){return this.lazyVisitFormulaNode(e).bind((e=>this.visitor.parenNode(e,t,r)))}nameNode(e,t,r){return o.Pledge.try((()=>this.visitor.nameNode(e,t,r)))}cellRefNode(e,t,r){return o.Pledge.try((()=>this.visitor.cellRefNode(e,t,r)))}fieldRefNode(e,t,r){return this.lazyVisitFormulaNode(e).bind((e=>this.visitor.fieldRefNode(e,t,r)))}structRefNode(e,t,r){return o.Pledge.try((()=>this.visitor.structRefNode(e,t,r)))}missingNode(e,t){return o.Pledge.try((()=>this.visitor.missingNode(e,t)))}badSequenceNode(e,t,r){return o.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((t=>this.visitor.badSequenceNode(e,t,r)))}badCharsNode(e,t,r){return o.Pledge.try((()=>this.visitor.badCharsNode(e,t,r)))}operatorNode(e,t){return o.Pledge.try((()=>this.visitor.operatorNode(e,t)))}wsfNode(e,t,r){return o.Pledge.try((()=>this.visitor.wsfNode(e,t,r)))}constructor(e){this.visitor=e,this.visitFormulaNode=e=>l(this,e),this.lazyVisitFormulaNode=e=>o.Pledge.resolve(e).bind(this.visitFormulaNode),this.visitAppHeadNode=e=>d(this,e),this.lazyVisitAppHeadNode=e=>o.Pledge.resolve(e).bind(this.visitAppHeadNode),this.visitWSFNode=e=>c(this,e),this.lazyVisitWSFNode=e=>o.Pledge.resolve(e).bind(this.visitWSFNode),this.lazyVisitVar=({name:e,binder:t})=>this.lazyVisitFormulaNode(t.arg).bind((r=>(0,s.letVar)(e,(0,s.indexedArg)(r,t.index)))),this.lazyVisitParam=({name:e})=>{const t=e.arg;return void 0===t.def?o.Pledge.resolve((0,s.lambdaParam)(e)):this.lazyVisitFormulaNode(t.def.rhs).bind((r=>(0,s.lambdaParam)((0,s.indexedArg)((0,s.paramNode)(t.name,(0,s.paramDefault)(r,t.def.label),t.label),e.index))))},this.lazyVisitIndexedArg=({arg:e,index:t})=>this.lazyVisitFormulaNode(e).bind((e=>(0,s.indexedArg)(e,t)))}}t.PledgeReducer=_,t.reduceBottomUp_Pledge=function(e,t){return D(new _(e),t)};function M(e,t,r){return r<=50?R(e,t):O(e,t)}function D(e,t){return o.Pledge.settleOrThrow(o.Pledge.resolve(l(e,t)))}t.reduceBottomUp_MaxDepth=M,t.reduceBottomUp=function(e,t){return M(e,t.node,t.depthUpperBound)},t.reduceTopDown_Pledge=D,t.reducePledge=function(e,t){return D(e,t.node)}},19105:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;const n=r(57777);t.anonymize=n.anonymizer.anonymize,t.anonymizeFormulaString=n.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=n.anonymizer.anonymizeMagnitude,t.kindAnonymizers=n.anonymizer.kindAnonymizers},63224:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;const n=r(57777);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},8600:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointExclamationMark=t.codePointEuroSign=t.codePointEqualsSign=t.codePointDoubleQuote=t.codePointDollarSign=t.codePointDigitZero=t.codePointDigitTwo=t.codePointDigitThree=t.codePointDigitSix=t.codePointDigitSeven=t.codePointDigitOne=t.codePointDigitNine=t.codePointDigitFour=t.codePointDigitFive=t.codePointDigitEight=t.codePointComma=t.codePointColon=t.codePointCircumflexAccent=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointCR=t.codePointBacktick=t.codePointBackslash=t.codePointAtSign=t.codePointAsterisk=t.codePointAmpersand=void 0,t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointSlash=t.codePointSingleQuote=t.codePointSemicolon=t.codePointRightSquareBracket=t.codePointRightParen=t.codePointRightCurlyBracket=t.codePointQuestionMark=t.codePointPlusSign=t.codePointPipe=t.codePointPercentSign=t.codePointMinusSign=t.codePointLessThanSign=t.codePointLeftSquareBracket=t.codePointLeftParen=t.codePointLeftCurlyBracket=t.codePointLF=t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointHash=t.codePointGreaterThanSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitZero=t.codePointFullwidthDigitNine=t.codePointFullStop=void 0,t.codePointUnderscore=t.codePointTilde=t.codePointThaiDigitZero=t.codePointThaiDigitNine=t.codePointTab=t.codePointSpace=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=void 0;const n=r(57777);t.codePointAmpersand=n.codePoint.codePointAmpersand,t.codePointAsterisk=n.codePoint.codePointAsterisk,t.codePointAtSign=n.codePoint.codePointAtSign,t.codePointBackslash=n.codePoint.codePointBackslash,t.codePointBacktick=n.codePoint.codePointBacktick,t.codePointCR=n.codePoint.codePointCR,t.codePointCapitalA=n.codePoint.codePointCapitalA,t.codePointCapitalB=n.codePoint.codePointCapitalB,t.codePointCapitalC=n.codePoint.codePointCapitalC,t.codePointCapitalD=n.codePoint.codePointCapitalD,t.codePointCapitalE=n.codePoint.codePointCapitalE,t.codePointCapitalF=n.codePoint.codePointCapitalF,t.codePointCapitalG=n.codePoint.codePointCapitalG,t.codePointCapitalH=n.codePoint.codePointCapitalH,t.codePointCapitalI=n.codePoint.codePointCapitalI,t.codePointCapitalJ=n.codePoint.codePointCapitalJ,t.codePointCapitalK=n.codePoint.codePointCapitalK,t.codePointCapitalL=n.codePoint.codePointCapitalL,t.codePointCapitalM=n.codePoint.codePointCapitalM,t.codePointCapitalN=n.codePoint.codePointCapitalN,t.codePointCapitalO=n.codePoint.codePointCapitalO,t.codePointCapitalP=n.codePoint.codePointCapitalP,t.codePointCapitalQ=n.codePoint.codePointCapitalQ,t.codePointCapitalR=n.codePoint.codePointCapitalR,t.codePointCapitalS=n.codePoint.codePointCapitalS,t.codePointCapitalT=n.codePoint.codePointCapitalT,t.codePointCapitalU=n.codePoint.codePointCapitalU,t.codePointCapitalV=n.codePoint.codePointCapitalV,t.codePointCapitalW=n.codePoint.codePointCapitalW,t.codePointCapitalX=n.codePoint.codePointCapitalX,t.codePointCapitalY=n.codePoint.codePointCapitalY,t.codePointCapitalZ=n.codePoint.codePointCapitalZ,t.codePointCircumflexAccent=n.codePoint.codePointCircumflexAccent,t.codePointColon=n.codePoint.codePointColon,t.codePointComma=n.codePoint.codePointComma,t.codePointDigitEight=n.codePoint.codePointDigitEight,t.codePointDigitFive=n.codePoint.codePointDigitFive,t.codePointDigitFour=n.codePoint.codePointDigitFour,t.codePointDigitNine=n.codePoint.codePointDigitNine,t.codePointDigitOne=n.codePoint.codePointDigitOne,t.codePointDigitSeven=n.codePoint.codePointDigitSeven,t.codePointDigitSix=n.codePoint.codePointDigitSix,t.codePointDigitThree=n.codePoint.codePointDigitThree,t.codePointDigitTwo=n.codePoint.codePointDigitTwo,t.codePointDigitZero=n.codePoint.codePointDigitZero,t.codePointDollarSign=n.codePoint.codePointDollarSign,t.codePointDoubleQuote=n.codePoint.codePointDoubleQuote,t.codePointEqualsSign=n.codePoint.codePointEqualsSign,t.codePointEuroSign=n.codePoint.codePointEuroSign,t.codePointExclamationMark=n.codePoint.codePointExclamationMark,t.codePointFullStop=n.codePoint.codePointFullStop,t.codePointFullwidthDigitNine=n.codePoint.codePointFullwidthDigitNine,t.codePointFullwidthDigitZero=n.codePoint.codePointFullwidthDigitZero,t.codePointFullwidthLatinCapitalA=n.codePoint.codePointFullwidthLatinCapitalA,t.codePointFullwidthLatinCapitalZ=n.codePoint.codePointFullwidthLatinCapitalZ,t.codePointFullwidthLatinSmallA=n.codePoint.codePointFullwidthLatinSmallA,t.codePointFullwidthLatinSmallZ=n.codePoint.codePointFullwidthLatinSmallZ,t.codePointGreaterThanSign=n.codePoint.codePointGreaterThanSign,t.codePointHash=n.codePoint.codePointHash,t.codePointInvertedExclamationMark=n.codePoint.codePointInvertedExclamationMark,t.codePointInvertedQuestionMark=n.codePoint.codePointInvertedQuestionMark,t.codePointLF=n.codePoint.codePointLF,t.codePointLeftCurlyBracket=n.codePoint.codePointLeftCurlyBracket,t.codePointLeftParen=n.codePoint.codePointLeftParen,t.codePointLeftSquareBracket=n.codePoint.codePointLeftSquareBracket,t.codePointLessThanSign=n.codePoint.codePointLessThanSign,t.codePointMinusSign=n.codePoint.codePointMinusSign,t.codePointPercentSign=n.codePoint.codePointPercentSign,t.codePointPipe=n.codePoint.codePointPipe,t.codePointPlusSign=n.codePoint.codePointPlusSign,t.codePointQuestionMark=n.codePoint.codePointQuestionMark,t.codePointRightCurlyBracket=n.codePoint.codePointRightCurlyBracket,t.codePointRightParen=n.codePoint.codePointRightParen,t.codePointRightSquareBracket=n.codePoint.codePointRightSquareBracket,t.codePointSemicolon=n.codePoint.codePointSemicolon,t.codePointSingleQuote=n.codePoint.codePointSingleQuote,t.codePointSlash=n.codePoint.codePointSlash,t.codePointSmallA=n.codePoint.codePointSmallA,t.codePointSmallB=n.codePoint.codePointSmallB,t.codePointSmallC=n.codePoint.codePointSmallC,t.codePointSmallD=n.codePoint.codePointSmallD,t.codePointSmallE=n.codePoint.codePointSmallE,t.codePointSmallF=n.codePoint.codePointSmallF,t.codePointSmallG=n.codePoint.codePointSmallG,t.codePointSmallH=n.codePoint.codePointSmallH,t.codePointSmallI=n.codePoint.codePointSmallI,t.codePointSmallJ=n.codePoint.codePointSmallJ,t.codePointSmallK=n.codePoint.codePointSmallK,t.codePointSmallL=n.codePoint.codePointSmallL,t.codePointSmallM=n.codePoint.codePointSmallM,t.codePointSmallN=n.codePoint.codePointSmallN,t.codePointSmallO=n.codePoint.codePointSmallO,t.codePointSmallP=n.codePoint.codePointSmallP,t.codePointSmallQ=n.codePoint.codePointSmallQ,t.codePointSmallR=n.codePoint.codePointSmallR,t.codePointSmallS=n.codePoint.codePointSmallS,t.codePointSmallT=n.codePoint.codePointSmallT,t.codePointSmallU=n.codePoint.codePointSmallU,t.codePointSmallV=n.codePoint.codePointSmallV,t.codePointSmallW=n.codePoint.codePointSmallW,t.codePointSmallX=n.codePoint.codePointSmallX,t.codePointSmallY=n.codePoint.codePointSmallY,t.codePointSmallZ=n.codePoint.codePointSmallZ,t.codePointSpace=n.codePoint.codePointSpace,t.codePointTab=n.codePoint.codePointTab,t.codePointThaiDigitNine=n.codePoint.codePointThaiDigitNine,t.codePointThaiDigitZero=n.codePoint.codePointThaiDigitZero,t.codePointTilde=n.codePoint.codePointTilde,t.codePointUnderscore=n.codePoint.codePointUnderscore},4810:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;const n=r(57777);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},84516:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;const n=r(57777);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},38429:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;const n=r(57777);t.Pledge=n.pledge.Pledge},16322:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.surrogatePairToCodePoint=t.stringFromCodePoint=t.stringCodePointAt=t.scanCodePointsBack=t.scanCodePoints=t.numCodeUnits=t.isLowSurrogate=t.isHighSurrogate=t.isAnySurrogate=t.countCodePoints=t.codePointIterator=void 0;const n=r(57777);t.codePointIterator=n.unicode.codePointIterator,t.countCodePoints=n.unicode.countCodePoints,t.isAnySurrogate=n.unicode.isAnySurrogate,t.isHighSurrogate=n.unicode.isHighSurrogate,t.isLowSurrogate=n.unicode.isLowSurrogate,t.numCodeUnits=n.unicode.numCodeUnits,t.scanCodePoints=n.unicode.scanCodePoints,t.scanCodePointsBack=n.unicode.scanCodePointsBack,t.stringCodePointAt=n.unicode.stringCodePointAt,t.stringFromCodePoint=n.unicode.stringFromCodePoint,t.surrogatePairToCodePoint=n.unicode.surrogatePairToCodePoint},78421:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;const n=r(57777);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},35759:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldInstallFormat=t.parseEdit=void 0;const n=r(78421),i=r(33957),o=r(56331),a=r(58049),s=r(11620),l=r(84516);function u(e){const t=(0,n.stringStartsWith)(e,"'"),r=t?e.substring(1):e;return r.length>i.cellStringLimit?(0,l.failure)((0,o.notValueString)("cell text too long")):(0,l.success)((0,o.stringEdit)((0,i.stringOper)(r),t))}function c(e,t,r){return(0,s.parseDateInternal)((0,s.initParseDateGlobals)(e),t,r,o.GetTimeKind.ValueCell)}function d(e,t,r){const{localeInfo:n,mathpack:i}=e.config,s=n.isEastAsia&&r.valueType===o.FormatValueType.Percentage&&!0;let l=!1;switch(r.valueType){case o.FormatValueType.Number:case o.FormatValueType.Currency:case o.FormatValueType.Percentage:case o.FormatValueType.Fraction:case o.FormatValueType.Scientific:case o.FormatValueType.Accounting:l=!0}return(0,a.parseConstInternal)(n,i,t,s,!0,l)}t.parseEdit=function(e,t,r){try{if(r.valueType===o.FormatValueType.Text)return u(t);if(""===t)return(0,l.success)((0,o.otherEdit)(i.blankOper));if(t.length>1&&(0,n.stringStartsWith)(t,"="))return(0,l.success)((0,o.formulaEdit)(t));if(!(0,n.stringStartsWith)(t,"'")){const n=function(e,t,r){const n=function(e,t){if(0===e.stringCompareCI(t,e.trueName))return i.trueOper;if(0===e.stringCompareCI(t,e.falseName))return i.falseOper;for(let r=1;r<e.errorNames.length;r+=1){const n=e.errorNames[r];if(null!=n&&0===e.stringCompareCI(n,t))return(0,i.errorOper)(r)}}(e.config.localeInfo,t);if(void 0!==n)return(0,l.success)((0,o.otherEdit)(n));const a=r.valueType===o.FormatValueType.Date||r.valueType===o.FormatValueType.Time?[c,d]:[d,c];for(const n of a){const i=n(e,t,r);if(!(0,l.isSuccess)(i))return i;if(void 0!==i.value){const{value:e,format:t}=i.value;return(0,l.success)((0,o.numberEdit)(e,t))}}return(0,l.success)(void 0)}(e,t,r);if(!(0,l.isSuccess)(n))return n;if(void 0!==n.value)return(0,l.success)(n.value)}return t.length>1&&function(e){const t=e.charAt(0);return"="===t||"+"===t||"-"===t||"@"===t}(t)?(0,l.success)((0,o.formulaEdit)(t)):u(t)}catch(e){return(0,l.failure)((0,l.javaScriptError)(e))}},t.shouldInstallFormat=function(e,t){return e!==t&&t.source===o.NumberFormatSource.Builtin&&(t.valueType===o.FormatValueType.General||function(e,t){return(null==e?void 0:e.valueType)!==o.FormatValueType.Number&&t.valueType!==o.FormatValueType.Number&&(null==e?void 0:e.valueType)!==t.valueType}(e,t))}},21893:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.evalFormat=t.evalFormatImpl=void 0;const n=r(63224),i=r(50026),o=r(88510),a=r(56331),s=r(69572),l=r(60545),u=r(3342),c=r(82949),d=r(4810),m=r(96705),g=r(84516),p=r(89946),h=r(38429),f=(0,d.typedInstanceCreator)()(((e,t,r,n)=>({strong:e,format:t,valueType:r,decimals:n}))),S={},v=(0,i.createFailureErrorClass)("InferenceError"),y={getDocumentLoc:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getDocumentLoc"),getSheetIndex:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getSheetIndex"),getSheetName:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getSheetName"),getNameLoc:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getNameLoc"),getUserDefinedFuncLoc:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getUserDefinedFuncLoc"),getSheetRangeIndexes:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getSheetRangeIndexes"),getCellFormat:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getCellFormat"),getKnownFormat:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getKnownFormat"),getIformat:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getIformat"),getFormatString:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getFormatString"),getContainingTable:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getContainingTable"),getStructRefColumn:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getStructRefColumn"),getStructRefSpecialRef:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getStructRefSpecialRef")};function F(e,t){var r,n;const i=function(e){var t,r,n,i,o,a,s,l,u,c,d,m,g,p,h,f,S,v,F,C,R,b,E,T,k,P;return{config:e.config,getDocumentLoc:null!==(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:y.getDocumentLoc,getSheetIndex:null!==(i=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e))&&void 0!==i?i:y.getSheetIndex,getSheetName:null!==(a=null===(o=e.getSheetName)||void 0===o?void 0:o.bind(e))&&void 0!==a?a:y.getSheetName,getNameLoc:null!==(l=null===(s=e.getNameLoc)||void 0===s?void 0:s.bind(e))&&void 0!==l?l:y.getNameLoc,getUserDefinedFuncLoc:null!==(c=null===(u=e.getUserDefinedFuncLoc)||void 0===u?void 0:u.bind(e))&&void 0!==c?c:y.getUserDefinedFuncLoc,getSheetRangeIndexes:null!==(m=null===(d=e.getSheetRangeIndexes)||void 0===d?void 0:d.bind(e))&&void 0!==m?m:y.getSheetRangeIndexes,getCellFormat:null!==(p=null===(g=e.getCellFormat)||void 0===g?void 0:g.bind(e))&&void 0!==p?p:y.getCellFormat,getKnownFormat:null!==(f=null===(h=e.getKnownFormat)||void 0===h?void 0:h.bind(e))&&void 0!==f?f:y.getKnownFormat,getIformat:null!==(v=null===(S=e.getIformat)||void 0===S?void 0:S.bind(e))&&void 0!==v?v:y.getIformat,getFormatString:null!==(C=null===(F=e.getFormatString)||void 0===F?void 0:F.bind(e))&&void 0!==C?C:y.getFormatString,getContainingTable:null!==(b=null===(R=e.getContainingTable)||void 0===R?void 0:R.bind(e))&&void 0!==b?b:y.getContainingTable,getStructRefColumn:null!==(T=null===(E=e.getStructRefColumn)||void 0===E?void 0:E.bind(e))&&void 0!==T?T:y.getStructRefColumn,getStructRefSpecialRef:null!==(P=null===(k=e.getStructRefSpecialRef)||void 0===k?void 0:k.bind(e))&&void 0!==P?P:y.getStructRefSpecialRef}}(e);return{globals:i,locals:t,config:e.config,localeInfo:null!==(n=null===(r=t.config)||void 0===r?void 0:r.localeInfo)&&void 0!==n?n:e.config.localeInfo,mathpack:e.config.mathpack,get document(){const e=t.originSheet;if(!(0,g.isSuccess)(e))throw new v(e);return e.value.document},get defaultFormat(){const e=P(this,m.KnownFormat.General);return f(!1,e,e.valueType,e.decimals)},get unitlessFormat(){const e=P(this,m.KnownFormat.General);return f(!0,e,e.valueType,e.decimals)},resolver:(0,l.createResolver)(i),multOrDivTainted:!1}}const C={[a.FormatValueType.General]:0,[a.FormatValueType.Number]:1,[a.FormatValueType.Currency]:2,[a.FormatValueType.Accounting]:2,[a.FormatValueType.Percentage]:3,[a.FormatValueType.Date]:4,[a.FormatValueType.Time]:5,[a.FormatValueType.Fraction]:6,[a.FormatValueType.Scientific]:7,[a.FormatValueType.Text]:8,[a.FormatValueType.Custom]:9};var R;!function(e){e[e.Propagate=-2147483648]="Propagate",e[e.Ignore=-2147483647]="Ignore"}(R||(R={}));const b={[u.WorksheetFuncId.INT]:R.Propagate,[u.WorksheetFuncId.MOD]:R.Propagate,[u.WorksheetFuncId.ROUND]:R.Propagate,[u.WorksheetFuncId.SUM]:R.Propagate,[u.WorksheetFuncId.TRUNC]:R.Propagate,[u.WorksheetFuncId.AVERAGE]:R.Propagate,[u.WorksheetFuncId.MAX]:R.Propagate,[u.WorksheetFuncId.MEDIAN]:R.Propagate,[u.WorksheetFuncId.MIN]:R.Propagate,[u.WorksheetFuncId.ROUNDUP]:R.Propagate,[u.WorksheetFuncId.ROUNDDOWN]:R.Propagate,[u.WorksheetFuncId.NPV]:m.KnownFormat.CoCurrencyDec,[u.WorksheetFuncId.PV]:m.KnownFormat.CoCurrencyDec,[u.WorksheetFuncId.FV]:m.KnownFormat.CoCurrencyDec,[u.WorksheetFuncId.PMT]:m.KnownFormat.CoCurrencyDec,[u.WorksheetFuncId.RATE]:m.KnownFormat.Pct0,[u.WorksheetFuncId.MIRR]:m.KnownFormat.Pct0,[u.WorksheetFuncId.IRR]:m.KnownFormat.Pct0,[u.WorksheetFuncId.DATE]:m.KnownFormat.MMDDYY,[u.WorksheetFuncId.TIME]:m.KnownFormat.HHMMAP,[u.WorksheetFuncId.NOW]:m.KnownFormat.MDYHMS,[u.WorksheetFuncId.SLN]:m.KnownFormat.CoCurrencyDec,[u.WorksheetFuncId.SYD]:m.KnownFormat.CoCurrencyDec,[u.WorksheetFuncId.DDB]:m.KnownFormat.CoCurrencyDec,[u.WorksheetFuncId.IPMT]:m.KnownFormat.CoCurrencyDec,[u.WorksheetFuncId.PPMT]:m.KnownFormat.CoCurrencyDec,[u.WorksheetFuncId.TODAY]:m.KnownFormat.MMDDYY,[u.WorksheetFuncId.VDB]:m.KnownFormat.CoCurrencyDec,[u.WorksheetFuncId.DB]:m.KnownFormat.CoCurrencyDec},E=[[a.FormatValueType.General,a.FormatValueType.Number,a.FormatValueType.Currency,a.FormatValueType.Percentage,a.FormatValueType.Date,a.FormatValueType.Time,a.FormatValueType.Fraction,a.FormatValueType.Scientific,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.Number,a.FormatValueType.Currency,a.FormatValueType.Percentage,a.FormatValueType.Date,a.FormatValueType.Time,a.FormatValueType.Number,a.FormatValueType.Scientific,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Currency,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Currency,a.FormatValueType.Currency,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Percentage,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Percentage,a.FormatValueType.Percentage,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Date,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Time,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Fraction,a.FormatValueType.Scientific,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Scientific,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Custom]],T=[[a.FormatValueType.General,a.FormatValueType.Number,a.FormatValueType.Currency,a.FormatValueType.General,a.FormatValueType.Date,a.FormatValueType.Time,a.FormatValueType.Fraction,a.FormatValueType.Scientific,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.Number,a.FormatValueType.Currency,a.FormatValueType.Number,a.FormatValueType.Date,a.FormatValueType.Time,a.FormatValueType.Fraction,a.FormatValueType.Scientific,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Currency,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Currency,a.FormatValueType.Currency,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Percentage,a.FormatValueType.Date,a.FormatValueType.Time,a.FormatValueType.Percentage,a.FormatValueType.Scientific,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Date,a.FormatValueType.Date,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Time,a.FormatValueType.Time,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Fraction,a.FormatValueType.Scientific,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Scientific,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Custom]];function k(e,t){if("number"!=typeof t)return t;const r=e.globals.getIformat(e.document,t);if(!(0,g.isSuccess)(r))throw new v(r.reason);return r.value}function P(e,t){const r=e.globals.getKnownFormat(e.document,t);if(!(0,g.isSuccess)(r))throw new v(r.reason);return r.value}function N(e,t){if("number"==typeof t)return t;const r=e.globals.getFormatString(e.document,t.formatString);if(!(0,g.isSuccess)(r))throw new v(r.reason);return void 0!==r.value?r.value:t}function A(e,t,r){(0,n.assertTrue)("calc.numfmt.evalFormula: well-formed bin op",2===t.length);const[i,o]=t;return r(e,i,o)}function I(e,t,[r],[n]){const i=C[r.valueType],o=C[n.valueType],a=i<=o?t[i][o]:t[o][i],s=C[a],l=n.decimals>r.decimals?n.decimals:r.decimals;switch(s){case i:return f(!0,r.format,r.valueType,l);case o:return f(!0,n.format,n.valueType,l);default:return e.unitlessFormat}}function O(e,t,r){return I(e,T,t,r)}function _(e,t,r){const[n]=t,[i]=r;if(n.format===i.format&&n.valueType===i.valueType&&n.valueType===a.FormatValueType.Time)return f(!0,n.format,n.valueType,n.decimals);if(n.valueType===a.FormatValueType.Date&&i.valueType===a.FormatValueType.Time||n.valueType===a.FormatValueType.Time&&i.valueType===a.FormatValueType.Date){const t=P(e,m.KnownFormat.MDYHMS),{valueType:r,decimals:n}=t;return f(!0,t,r,n)}return I(e,E,t,r)}const M=e=>e.unitlessFormat;function D(e,[t],[r]){return t.format===r.format?f(!0,t.format,t.valueType,t.decimals):e.unitlessFormat}function w(e){return C[e]===C[a.FormatValueType.General]}class L{literalNode(e){switch(e.kind){case c.OperKind.String:case c.OperKind.Boolean:case c.OperKind.Error:case c.OperKind.Missing:return h.Pledge.resolve(this.context.defaultFormat);case c.OperKind.Number:const t=21,r=this.context.mathpack.formatGeneral(this.context.localeInfo,this.context.mathpack.abs(e),t),i=r.indexOf(this.context.localeInfo.decimalSeparator),o=i>=0?r.length-i-1:0,a=P(this.context,m.KnownFormat.General);return h.Pledge.resolve(f(!1,a,a.valueType,o));default:return(0,n.assertNever)("calc.numfmt.evalFormat: unexpected literal oper",e)}}arrayNode(e){return h.Pledge.resolve(this.context.defaultFormat)}appNode(e,t){if((0,i.isOperatorNode)(e))return h.Pledge.all(t.map((e=>this.lazyVisitFormulaNode(e).bind((t=>[t,e]))))).bind((t=>function(e,t,r){switch(t){case u.OperatorId.Mul:case u.OperatorId.Div:return e.multOrDivTainted=!0,A(e,r,O);case u.OperatorId.Pow:return A(e,r,O);case u.OperatorId.Add:case u.OperatorId.Sub:return A(e,r,_);case u.OperatorId.Percent:{(0,n.assertTrue)("calc.numfmt.evalFormat: well-formed unary op",1===r.length);const[t,o]=r[0];if(!(0,i.isNumberLiteralNode)(o))return e.defaultFormat;const{strong:a,decimals:s}=t,l=P(e,m.KnownFormat.Pct);return f(a,l,l.valueType,s)}case u.OperatorId.Pound:case u.OperatorId.At:return e.defaultFormat;case u.OperatorId.Neg:case u.OperatorId.Pos:{(0,n.assertTrue)("calc.numfmt.evalFormat: well-formed unary op",1===r.length);const[e]=r[0];return e}case u.OperatorId.Lt:case u.OperatorId.Le:case u.OperatorId.Eq:case u.OperatorId.Ge:case u.OperatorId.Gt:case u.OperatorId.Ne:return A(e,r,M);case u.OperatorId.Isect:case u.OperatorId.Union:case u.OperatorId.Range:case u.OperatorId.Concat:return A(e,r,D);case u.OperatorId.And:case u.OperatorId.Or:case u.OperatorId.Xor:case u.OperatorId.Min:case u.OperatorId.Max:throw new v((0,i.notImplemented)(["evalFormat for Yellow ops"]));default:return(0,n.assertNever)("calc.numfmt.evalFormat: unexpected operator id",t)}}(this.context,e.id,t)));if((0,i.isWSFNode)(e)){const o=e.id,a=null!==(r=b[o])&&void 0!==r?r:R.Ignore,s=(0,u.getWorksheetFuncType)(o),l=(0,i.getArguments)(t);if((0,n.assertTrue)("calc.numfmt.evalFormula: well-formed WSF args",(0,i.isValidArgsLength)(s,l.length)),a===R.Ignore)return h.Pledge.resolve(this.context.defaultFormat);if(a===R.Propagate)return 0===l.length?h.Pledge.resolve(this.context.defaultFormat):h.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((e=>{const t=e[0];let r=t.format,n=t.valueType,i=t.decimals;const o=!w(n);if(!t.strong&&o)return this.context.unitlessFormat;let a=o;for(let t=1;t<e.length;t+=1){const o=e[t],s=!w(o.valueType);if(!o.strong&&s)return this.context.unitlessFormat;a||(r=o.format,n=o.valueType,i=o.decimals,a=s)}return f(!0,r,n,i)}));const c=P(this.context,a),{valueType:d,decimals:m}=c;return h.Pledge.resolve(f(!0,c,d,m))}var r;return this.lazyVisitFormulaNode(e)}letNode(e,t,r,n){return h.Pledge.resolve(this.context.defaultFormat)}lambdaNode(e,t,r,n){return h.Pledge.resolve(this.context.defaultFormat)}parenNode(e){return this.lazyVisitFormulaNode(e)}nameNode(e,t){return h.Pledge.resolve(this.context.defaultFormat)}cellRefNode(e,t){const{resolution:r}=this.context.resolver.resolveCellRef(this.context.locals,(0,o.cellRefNode)(e,t));if(!(0,g.isSuccess)(r))throw(0,n.assertTrue)("calc.numfmt.evalFormat: NoOriginSheet",r.reason.kind!==s.ResolveReasonKind.NoOriginSheet),new v(r.reason);const a=r.value;if(void 0===a)throw S;return(0,i.isSheetGridRange)(a)?h.Pledge.resolve(K(this.context,a)):h.Pledge.resolve(this.context.unitlessFormat)}fieldRefNode(e,t){return this.lazyVisitFormulaNode(e).bind((e=>this.context.defaultFormat))}structRefNode(e,t){const r=(0,o.structRefNode)(e,t),{resolution:i}=this.context.resolver.resolveStructRef(this.context.locals,r);if(!(0,g.isSuccess)(i)){if((0,n.assertTrue)("calc.numfmt.evalFormat: NoOriginSheet",i.reason.kind!==s.ResolveReasonKind.NoOriginSheet),i.reason.kind===s.ResolveReasonKind.EmptyIntersection)throw S;throw new v(i.reason)}const a=i.value;if(void 0===a)throw S;return h.Pledge.resolve(K(this.context,a))}missingNode(e){return(0,n.assertFalse)("calc.numfmt.evalFormat: unexpected missing node")}badSequenceNode(e,t){return(0,n.assertFalse)("calc.numfmt.evalFormat: unexpected bad node")}badCharsNode(e,t){return(0,n.assertFalse)("calc.numfmt.evalFormat: unexpected bad node")}operatorNode(e,t){return h.Pledge.resolve((0,o.operatorNode)(e,t))}wsfNode(e,t,r){return h.Pledge.resolve((0,o.wsfNode)(e,t,r))}constructor(e){this.context=e,this.visitFormulaNode=e=>(0,p.visitFormulaNode)(this,e),this.lazyVisitFormulaNode=e=>h.Pledge.resolve(e).bind(this.visitFormulaNode)}}function x(e,t){return(0,p.reducePledge)(new L(e),t)}function K(e,t){const r=(0,i.sheetGridRangeAnchor)(t),n=e.globals.getCellFormat(r);if(!(0,g.isSuccess)(n))throw new v(n.reason);const o=n.value,s=k(e,o);if(!(0,i.isDocumentLocEqual)(r.sheet.document,e.document)&&("number"!=typeof o||s.source!==a.NumberFormatSource.Builtin))return e.defaultFormat;const{valueType:l,decimals:u}=s;return f(!0,o,l,u)}t.evalFormatImpl=function(e,t,r){try{const n=F(e,t),i=x(n,r);return(0,g.success)(Object.assign(Object.assign({},i),{format:N(n,i.format),mulOrDivTainted:n.multOrDivTainted}))}catch(e){return e instanceof v?(0,g.failure)(e.reason):e===S?g.successUndefined:(0,g.failure)((0,g.javaScriptError)(e))}},t.evalFormat=function(e,t,r){try{const n=F(e,t),i=x(n,r);return(0,g.success)(function(e,{strong:t,format:r,valueType:n,decimals:i}){if(n!==a.FormatValueType.Number||!e.multOrDivTainted){if(i>0&&t&&(n===a.FormatValueType.Number||n===a.FormatValueType.Currency||n===a.FormatValueType.Accounting||n===a.FormatValueType.Percentage)){const t=k(e,r);i!==t.decimals&&(r=t.synthesizeDecimals(i))}if(n!==a.FormatValueType.General&&t)return N(e,r)}}(n,i))}catch(e){return e instanceof v?(0,g.failure)(e.reason):e===S?g.successUndefined:(0,g.failure)((0,g.javaScriptError)(e))}}},89765:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNumberFormatter=void 0;const n=r(56331),i=r(22637),o=r(35759),a=r(46627),s=r(21893),l=r(51956),u=r(33520);t.createNumberFormatter=function(e){return{createFormat:(t,r)=>(0,i.createFormat)(e,t,"boolean"!=typeof r?r:r?n.NumberFormatSource.Builtin:n.NumberFormatSource.CustomString),applyFormat:(t,r,n)=>(0,i.applyFormat)(e,t,r,n),changeFormatDecimals:i.changeFormatDecimals,renderValue:(t,r)=>(0,a.renderValue)(e.config.mathpack,t,r),renderHashesValue:(e,t)=>(0,a.renderHashesValue)(e,t),renderFormulaBar(t,r,n,i){return(0,l.renderFormulaBar)(this,e,t,r,n,i)},parseGeneral:(t,r,n,i)=>(0,u.parseGeneral)(e,t,r,n,i),parseDate:(t,r)=>(0,u.parseDate)(e,t,r),parseEdit:(t,r)=>(0,o.parseEdit)(e,t,r),evalFormat:(t,r)=>(0,s.evalFormat)(e,t,r)}}},51956:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderFormulaBar=void 0;const n=r(56331),i=r(50026),o=r(71571),a=r(63224),s=r(91895),l=r(96705),u=r(82949),c=r(84516);t.renderFormulaBar=function(e,t,r,d,m,g){try{const{localeInfo:p}=t.config;switch(d.kind){case u.OperKind.Number:return function(e,t,r,u,d){if(d.isDate||d.isTime){const m=function(e,t,r,u,d){const{mathpack:m,localeInfo:g}=t.config;if(m.cond(u)<0)return(0,c.success)(void 0);let p="";const h=0!==m.fix(u)||d.isDate;let f=u;if(h){const l=m.trunc(u),d=(0,s.getFormatString)(e,t,r,(0,o.buildMMDDYYFormat)(g,!0),n.NumberFormatSource.CustomString);if(!(0,c.isSuccess)(d))return d;const h=(0,s.renderFormat)(e,d.value,l);if(!(0,c.isSuccess)(h))return h;if("string"!=typeof h.value)return(0,c.success)(void 0);p+=h.value;const S=m.sub(u,l);(0,a.assertTrue)("calc.numfmt.renderFormulaBar: sub error",!(0,i.isErrorOper)(S)),f=S}if(m.cond(f)>0||d.isTime){h&&(p+="  ");const n=t.getKnownFormat(r,g.clock24Hour?l.KnownFormat.HHMMSS:l.KnownFormat.HHMMSSAP);if(!(0,c.isSuccess)(n))return n;const i=(0,s.renderFormat)(e,n.value,f);if(!(0,c.isSuccess)(i))return i;if("string"!=typeof i.value)return(0,c.success)(void 0);p+=i.value}return(0,c.success)(p)}(e,(0,s.initUtilGlobals)(t),r,u,d);if(!(0,c.isSuccess)(m))return m;if(void 0!==m.value)return m.value,m}const{mathpack:m,localeInfo:g}=t.config;if(d.isPercent){const e=m.mul(u,m.fromNumber(100));return(0,i.isErrorOper)(e)?(0,c.failure)((0,i.notImplemented)(["renderFormulaBar % overflow"])):(0,c.success)(m.formatGeneral(g,e,21)+"%")}return(0,c.success)(m.formatGeneral(g,u,21))}(e,t,r,d,m);case u.OperKind.String:return(0,c.success)(g?"'"+d.value:d.value);case u.OperKind.Boolean:return(0,c.success)(d.value?p.trueName:p.falseName);case u.OperKind.Error:const h=p.errorNames[d.type];return null==h?(0,c.failure)((0,i.internal)(`No locale data for error type ${d.type}`)):(0,c.success)(h);case u.OperKind.Array:return(0,c.failure)((0,i.notImplemented)(["Array renderFormulaBar"]));case u.OperKind.Rich:return(0,c.failure)((0,i.notImplemented)(["Rich renderFormulaBar"]));case u.OperKind.Blank:return(0,c.success)("");default:return(0,a.assertNever)("calc.numfmt.renderFormulaBar: never value",d)}}catch(e){return(0,c.failure)((0,c.javaScriptError)(e))}}},22637:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.changeFormatDecimals=t.applyFormat=t.createFormat=t.NumberFormatImpl=t.pictureCalendar=t.pictureNumberShape=void 0;const n=r(19181),i=r(31748),o=r(63224),a=r(50026),s=r(56331),l=r(16322),u=r(33957),c=r(3342),d=r(11632),m=r(78421),g=r(38333),p=r(4810),h=r(50026),f=r(43260),S=n.__importStar(r(8600)),v=r(96705),y=r(41539),F=r(46627),C=r(82949),R=r(84516),b=r(19105),E=r(45105),{codePointMinusSign:T,codePointPlusSign:k,codePointDigitZero:P,codePointHash:N,codePointFullStop:A,codePointDigitOne:I,codePointDigitTwo:O,codePointLeftParen:_,codePointRightParen:M,codePointSmallT:D,codePointBackslash:w}=S;var L;!function(e){e[e.WantPic=0]="WantPic",e[e.WantClose=1]="WantClose",e[e.Done=2]="Done"}(L||(L={}));const x={decimalSeparator:"NOTUSED"};function K(e,t,r,n){const{mantissa:i,exponent:a}=e.formatFixed(t,0,0);return(0,o.assertTrue)("calc.numfmt.dtrInteger: mantissa len <= exponent",i.length<=a),(0,o.assertTrue)("calc.numfmt.dtrInteger: mantissa || !exponent",0!==i.length||0===a),(0,f.convertDigitsShape)(a<r?(0,m.repeat)("0",r-a):"",n)+(0,f.convertNumberShape)(x,i+(0,m.repeat)("0",a-i.length),n)}function U(e,t,r,n,i){const{mantissa:a,exponent:s}=e.formatFixed(t,0,0);(0,o.assertTrue)("calc.numfmt.dtrFracSeconds: mantissa len <= exponent",a.length<=s),(0,o.assertTrue)("calc.numfmt.dtrFracSeconds: mantissa || !exponent",0!==a.length||0===s);const l=((s<r?(0,m.repeat)("0",r-s):"")+a+(0,m.repeat)("0",s-a.length)).substring(0,n);return(0,f.convertDigitsShape)(l,i)}function B(e,t){const{mantissa:r,exponent:n}=e.formatFixed(t,0,0);return(0,o.assertTrue)("calc.numfmt.formatInt: mantissa len <= exponent",r.length<=n),(0,o.assertTrue)("calc.numfmt.formatInt: mantissa || !exponent",0!==r.length||0===n),""===r?"0":r.length<n?r+(0,m.repeat)("0",n-r.length):r}function G(e){const t=[];for(let r=0;r<e.length;r+=1){const n=e[r];switch(n.kind){case s.FormattedUnitKind.Blank:case s.FormattedUnitKind.String:{let i=n.str;for(;r+1<e.length;){const t=e[r+1];if(t.kind!==n.kind)break;i+=t.str,r+=1}t.push({kind:n.kind,str:i});break}case s.FormattedUnitKind.Flexible:case s.FormattedUnitKind.General:t.push(n)}}return t}const W=e=>e.kind===s.FormattedUnitKind.Flexible,V={1:v.NumberShape.ChineseTrad1,2:v.NumberShape.ChineseTrad2,3:v.NumberShape.ChineseTrad3},j={1:v.NumberShape.ChineseSimp1,2:v.NumberShape.ChineseSimp2,3:v.NumberShape.ChineseSimp3},q={1:v.NumberShape.Japanese1,2:v.NumberShape.Japanese2,3:v.NumberShape.Japanese3},H={1:v.NumberShape.Korean1,2:v.NumberShape.Korean2,3:v.NumberShape.Korean3,4:v.NumberShape.Korean4};function z(e){return e+1}var $;!function(e){e[e.Ne=0]="Ne",e[e.Le=1]="Le",e[e.Ge=2]="Ge",e[e.Eq=3]="Eq",e[e.Lt=4]="Lt",e[e.Gt=5]="Gt"}($||($={}));const Q=(0,m.partialArray)({[$.Ne]:"<>",[$.Le]:"<=",[$.Ge]:">=",[$.Eq]:"=",[$.Lt]:"<",[$.Gt]:">"}),Y={[$.Ne]:c.OperatorId.Ne,[$.Le]:c.OperatorId.Le,[$.Ge]:c.OperatorId.Ge,[$.Eq]:c.OperatorId.Eq,[$.Lt]:c.OperatorId.Lt,[$.Gt]:c.OperatorId.Gt},J={[c.OperatorId.Ne]:$.Ne,[c.OperatorId.Le]:$.Le,[c.OperatorId.Ge]:$.Ge,[c.OperatorId.Eq]:$.Eq,[c.OperatorId.Lt]:$.Lt,[c.OperatorId.Gt]:$.Gt};var X;function Z(e,t,r,n){for(let i=0;i<t.length;i+=1){const o=t[i];if(null==o)continue;if(n+o.length>r.length)continue;const a=r.substring(n,n+o.length);if(0===e.stringCompareCI(o,a))return Number(i)}}function ee(e,t,r,n){for(let e=0;e<t.length;e+=1){const i=t[e];if(null!=i&&(0,m.stringStartsWith)(r,i,n))return Number(e)}return Z(e,t,r,n)}function te(e,t){var r;return null!==(r=e[t])&&void 0!==r?r:""}function re(e,t,r,n){const i=r.substring(n,n+(0,l.numCodeUnits)((0,l.stringCodePointAt)(r,n)));for(let r=0;r<t.length;r+=1){const n=t[r];if(null==n)continue;if(0===n.length)continue;const o=n.substring(0,(0,l.numCodeUnits)((0,l.stringCodePointAt)(n,0)));if(0===e.stringCompareCI(i,o))return!0}return!1}function ne(e,t){let r=t.indexOf(te(e.pictureSingle,i.PictureSingle.APDelim));return r<0&&(r=t.length>>1),[t.substring(0,r),t.substring(r+1)]}!function(e){e[e.AMPM=100]="AMPM",e[e.AMPMFE=101]="AMPMFE",e[e.General=102]="General",e[e.Currency=103]="Currency",e[e.Color=200]="Color",e[e.Dbnum=201]="Dbnum",e[e.Cond=202]="Cond",e[e.CurrCode=203]="CurrCode",e[e.Char=300]="Char",e[e.StrLit=301]="StrLit",e[e.Numeral=302]="Numeral",e[e.PrefixDigTh=303]="PrefixDigTh",e[e.LatinDate=304]="LatinDate",e[e.BidiDate=305]="BidiDate",e[e.Exp=306]="Exp"}(X||(X={}));const ie=/^[0-9A-F]{1,8}$/i,oe=/^(?:([a-z]{2,}(?:-[A-Z0-9](?:[A-Z0-9]+|(?=,)|$)(?:_[A-Z0-9]+)?)*)(?:-x-([a-z]+))?|x-([a-z0-9]+))?(?:,([0-9A-F]{1,4}))?$/i;t.pictureNumberShape=(0,m.partialArray)({1:v.NumberShape.ASCII,2:v.NumberShape.ArabicIndic,3:v.NumberShape.ExtendedArabicIndic,4:v.NumberShape.Devanagari,5:v.NumberShape.Bengali,6:v.NumberShape.Gurmukhi,7:v.NumberShape.Gujarati,8:v.NumberShape.Oriya,9:v.NumberShape.Tamil,10:v.NumberShape.Telugu,11:v.NumberShape.Kannada,12:v.NumberShape.Malayalam,13:v.NumberShape.Thai,14:v.NumberShape.Lao,15:v.NumberShape.Tibetan,16:v.NumberShape.Myanmar,17:v.NumberShape.Ethiopic,18:v.NumberShape.Khmer,19:v.NumberShape.Mongolian,27:v.NumberShape.Japanese1,28:v.NumberShape.Japanese2,29:v.NumberShape.Japanese3,30:v.NumberShape.ChineseSimp1,31:v.NumberShape.ChineseSimp2,32:v.NumberShape.ChineseSimp3,33:v.NumberShape.ChineseTrad1,34:v.NumberShape.ChineseTrad2,35:v.NumberShape.ChineseTrad3,36:v.NumberShape.Korean1,37:v.NumberShape.Korean2,38:v.NumberShape.Korean3,39:v.NumberShape.Korean4}),t.pictureCalendar=(0,m.partialArray)({1:v.Calendar.Gregorian,2:v.Calendar.GregorianUS,3:v.Calendar.Japan,4:v.Calendar.Taiwan,5:v.Calendar.Korea,6:v.Calendar.Hijri,7:v.Calendar.Thai,8:v.Calendar.Hebrew,9:v.Calendar.GregorianMEFrench,10:v.Calendar.GregorianArabic,11:v.Calendar.GregorianXlitEnglish,12:v.Calendar.GregorianXlitFrench,22:v.Calendar.Persian,23:v.Calendar.UmAlQura});const ae=Object.keys(s.CultureTag).reduce(((e,t)=>{const r=s.CultureTag[t];return e[String(r)]=r,e}),Object.create(null));function se(e){return e.toString(16).toUpperCase()}function le(e){return Number("0x"+e)}const ue={culture:"en-US",tag:void 0},ce={culture:"fr-FR",tag:void 0},de={culture:"ar-IQ",tag:void 0},me={culture:"ar-SA",tag:void 0},ge={culture:"ar-DZ",tag:void 0},pe={culture:"th-TH",tag:void 0},he={[i.PictureSingle.Hour]:y.TimeDivision.Hour,[i.PictureSingle.HourTh]:y.TimeDivision.Hour,[i.PictureSingle.Minute]:y.TimeDivision.Minute,[i.PictureSingle.MinuteTh]:y.TimeDivision.Minute,[i.PictureSingle.Second]:y.TimeDivision.Second,[i.PictureSingle.SecondTh]:y.TimeDivision.Second};function fe(e){return e.kind===Se.Char?e.formattedStr:void 0}var Se;!function(e){e[e.Char=400]="Char",e[e.Fraction=401]="Fraction",e[e.Exp=402]="Exp",e[e.Num=403]="Num",e[e.FracSeconds=404]="FracSeconds",e[e.DateSep=405]="DateSep",e[e.TimeSep=406]="TimeSep",e[e.SysFormat=407]="SysFormat"}(Se||(Se={}));const ve={kind:X.General};function ye(e){return 1===e.length&&e[0].kind===X.General}var Fe,Ce,Re;!function(e){e[e.Num=0]="Num",e[e.Date=1]="Date",e[e.Fraction=2]="Fraction",e[e.Percent=3]="Percent",e[e.Exp=4]="Exp",e[e.Text=5]="Text",e[e.General=6]="General",e[e.Other=7]="Other"}(Fe||(Fe={})),function(e){e[e.Pos=0]="Pos",e[e.Neg=1]="Neg",e[e.Zero=2]="Zero",e[e.Text=3]="Text"}(Ce||(Ce={})),function(e){e[e.Unknown=0]="Unknown",e[e.Either=1]="Either",e[e.Number=2]="Number",e[e.Text=3]="Text"}(Re||(Re={}));const be={code:[ve],color:void 0,dbnum:void 0,dtrRounding:y.Rounding.RoundSec};function Ee(e){return void 0===e.color&&void 0===e.dbnum&&ye(e.code)}const Te={},ke=(0,a.createFailureErrorClass)("ApplyHashesError"),Pe=(0,a.createFailureErrorClass)("ApplyError"),Ne=(0,a.createFailureErrorClass)("InitError");class Ae{get isPercent(){return this.hasPercent}get isDate(){return this.hasDate}get isTime(){return this.hasTime}get isTextOnly(){return!this.posBeforeText}get isInputDependent(){return this.isInputDependentFormat()}get culture(){return this.thisCurrCode}get currencySymbol(){return this.thisCurrencySymbol}apply(e,t,r,n){try{return(0,R.success)(this.applyImpl(e,t,r,n))}catch(e){return e instanceof Pe?(0,R.failure)(e.reason):(0,R.failure)((0,R.javaScriptError)((0,m.prependErrorMessage)(e,`(while applying format ${this.logFormatString})`)))}}isInputDependentFormat(){for(const e of this.parts)for(const t of e.code)switch(t.kind){case X.General:case X.AMPM:case X.AMPMFE:case i.PictureSingle.Hash:case i.PictureSingle.Zero:case i.PictureSingle.Text:case i.PictureSingle.Year:case i.PictureSingle.YearTh:case i.PictureSingle.EngYearTh:case i.PictureSingle.ThYear:case i.PictureSingle.Month:case i.PictureSingle.MonthTh:case i.PictureSingle.Day:case i.PictureSingle.DayTh:case i.PictureSingle.LocDay:case i.PictureSingle.Hour:case i.PictureSingle.HourTh:case i.PictureSingle.Minute:case i.PictureSingle.MinuteTh:case i.PictureSingle.Second:case i.PictureSingle.SecondTh:case i.PictureSingle.Era:case i.PictureSingle.EraYear:case Se.Fraction:case Se.Exp:case Se.Num:case Se.SysFormat:case Se.FracSeconds:case i.PictureSingle.Question:return!0;case Se.DateSep:case Se.TimeSep:case Se.Char:case X.LatinDate:case i.PictureSingle.Decimal:case i.PictureSingle.Percent:case X.BidiDate:case X.Currency:case X.CurrCode:case X.StrLit:case X.Numeral:case X.PrefixDigTh:case X.Exp:case i.PictureSingle.Slash:case i.PictureSingle.Star:case i.PictureSingle.Underscore:}return!1}applyImpl(e,t,r,n){const{mathpack:l,localeInfo:u}=this.config;if(this.valueType===s.FormatValueType.General){const i=void 0;if((0,a.isStringOper)(e))return(0,s.formattedValue)([(0,s.formattedUnitString)(e.value)],i,t,r);if(!n&&0===l.cond(e))return(0,s.formattedValue)([],i,t,r);const o=(0,s.formattedUnitGeneral)(l.toNumber(e),u.decimalSeparator,!0,v.NumberShape.ASCII,v.NumberShape.ASCII,!0);return(0,s.formattedValue)([o],i,t,r)}let c=!1;for(;;){let u;try{let o,g=!1;const p=[];if((0,a.isStringOper)(e))o=Ce.Text;else{const t=l.cond(e);void 0!==this.condPos||void 0!==this.condNeg?({partKind:o,forceNeg:g}=this.getPart(e)):o=t<0?Ce.Neg:t>0?Ce.Pos:Ce.Zero,t<0&&(this.onlyOneNumberPart||g)&&p.push((0,s.formattedUnitString)("-"))}u=this.parts[o];const{color:h,dbnum:f,code:S,dtrRounding:v}=u;if(!n&&o===Ce.Zero&&u===this.parts[Ce.Pos]&&!c)return(0,s.formattedValue)([],h,t,r);const y=this.getNumShape(f);this.applyPart({dtrRounding:v,dbnum:f,forceNeg:g,units:p,numShape:y,bidiDate:void 0},S,e,void 0);const F=r|(o!==Ce.Text||Ee(u)||(m=void 0,void 0===(d=u).color&&void 0===d.dbnum&&1===(m=d.code).length&&m[0].kind===i.PictureSingle.Text)?s.Clip.None:s.Clip.MaxChars),C=p.some(W)?s.Alignment.Left:t;return(0,s.formattedValue)(G(p),h,C,F)}catch(t){if(t===Te){(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyImpl restart",!(0,a.isStringOper)(e)&&0!==l.cond(e)),e=l.zero,c=!0;continue}if(t instanceof ke)return(0,s.hashesValue)(t.reason,null==u?void 0:u.color);throw t}}var d,m}applyPart(e,t,r,n){var u,c;const{mathpack:d,datepack:h,localeInfo:S}=this.config,y=null!==(c=null===(u=this.applyCurrCode)||void 0===u?void 0:u.calendar)&&void 0!==c?c:v.Calendar.Gregorian;let C;const R=()=>{if(void 0!==C)return C;(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart getDtr value",!(0,a.isStringOper)(r));const{date1904:t,dateCompatibility:n}=this.config;if(!n&&d.cond(r)<0)throw new ke(s.dateOverflow);if(n&&d.cond(r)<0){if(t)throw new Pe((0,a.notImplemented)(["negative date 1904"]));throw new ke(s.dateOverflow)}const i=h.fromNum(this.config,d.abs(r),e.dtrRounding);if(!1===i)throw new ke(s.dateOverflow);switch(y){case v.Calendar.Gregorian:case v.Calendar.GregorianUS:case v.Calendar.GregorianMEFrench:case v.Calendar.GregorianArabic:case v.Calendar.GregorianXlitEnglish:case v.Calendar.GregorianXlitFrench:break;case v.Calendar.Thai:i.yr+=543;break;default:throw new Pe((0,a.notImplemented)(["calendar: "+y]))}return(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: components within range",i.yr>=0&&i.mon>=1&&i.mon<=12&&i.dom>=0&&i.dom<=31&&i.hour>=0&&i.hour<=23&&i.min>=0&&i.min<=59&&i.sec>=0&&i.sec<=59&&i.fracSec>=0&&i.wdy>=1&&i.wdy<=7),C=i},b=()=>{if(void 0!==C)throw new Pe((0,a.notImplemented)(["use of value after date component"]));return r};let E=!1,T=e.numShape;const k=e.units;for(let u=0;u<t.length;u+=1){const c=t[u];switch(c.kind){case X.General:{E=!0;const t=b();if((0,a.isStringOper)(t))k.push((0,s.formattedUnitString)(t.value));else{const r=d.abs(t);if(d.cond(t)<0&&"0"===d.formatGeneral(S,r,1))throw new Pe((0,a.notImplemented)(["potential LRestart in interval (-0.5,0)"]));const n=(0,s.formattedUnitGeneral)(d.toNumber(r),S.decimalSeparator,!1,T,this.getNumShape(void 0),this.valueType===s.FormatValueType.General);if(void 0!==e.dbnum){const e=(0,F.renderGeneral)(d,n,255);(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart General renderRes",!1!==e),k.push((0,s.formattedUnitString)(e));break}k.push(n)}break}case i.PictureSingle.Text:{const e=b();(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Text value",(0,a.isStringOper)(e)),k.push((0,s.formattedUnitString)(e.value));break}case X.Exp:case i.PictureSingle.Slash:case Se.Char:k.push((0,s.formattedUnitString)(c.formattedStr));break;case i.PictureSingle.Star:k.push((0,s.formattedUnitFlexible)(c.escaped));break;case i.PictureSingle.Underscore:k.push((0,s.formattedUnitBlank)(c.escaped));break;case X.StrLit:k.push((0,s.formattedUnitString)(c.escaped));break;case i.PictureSingle.Percent:case X.Numeral:k.push((0,s.formattedUnitString)(c.formattedStr));break;case X.Currency:k.push((0,s.formattedUnitString)(S.currencySymbol));break;case X.CurrCode:{const{currencySymbol:e,currCode:t}=c;(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart system tag",!(0,s.isSystemCultureTag)(null==t?void 0:t.tag)),void 0!==e&&k.push((0,s.formattedUnitString)(e));break}case Se.DateSep:k.push((0,s.formattedUnitString)(S.dateSeparator));break;case Se.TimeSep:c.printAsTimeSep?k.push((0,s.formattedUnitString)(S.timeSeparator)):k.push((0,s.formattedUnitString)(c.formattedStr));break;case Se.Num:{const t=b();(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num value",!(0,a.isStringOper)(t)),(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num numState",void 0===n);const{numDigLeft:r,numDigDec:i,numPercent:s,numThousands:l}=c,u=2*s-3*l,{mantissa:m,exponent:g}=d.formatFixed(t,u,i);if((0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num mantissa || !exponent",0!==m.length||0===g),(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num mantissa len",m.length<=g+i),d.cond(t)<0&&(this.onlyOneNumberPart||e.forceNeg)&&0===m.length)throw Te;this.applyPart(e,c.codeBefore,d.zero,void 0),this.applyPart(e,c.code,d.zero,{comma:c.comma,fractionDenom:!1,decimal:!1,digits:m,digitsExp:g,numDigLeft:r});break}case Se.Exp:{const t=b();(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp value",!(0,a.isStringOper)(t)),(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp numState",void 0===n);const{numMantDigLeft:r,numMantDigDec:i}=c,l=0===r&&0===i,{mantissa:u,exponent:m}=d.formatScientific(t,r,i);(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa || !exponent",0!==u.length||0===m||l);const p=(0,g.formatScientificLeft)(m,r);(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa len",u.length<=p+i),this.applyPart(e,c.codeMant,d.zero,{comma:c.commaMant,fractionDenom:!1,decimal:!1,digits:u,digitsExp:p,numDigLeft:c.numMantDigLeft}),this.applyPart(e,c.codeBetween,d.zero,void 0);const h=""!==u||l?m-p:0;h<0?k.push((0,s.formattedUnitString)("-")):c.isNeg||k.push((0,s.formattedUnitString)("+"));const f=B(d,d.fromNumber(h));this.applyPart(e,c.codeExp,d.zero,{comma:c.commaMant,fractionDenom:!1,decimal:!1,digits:f,digitsExp:f.length,numDigLeft:c.numExpDigLeft});break}case Se.Fraction:{const t=b();(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction value",!(0,a.isStringOper)(t)),(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction numState",void 0===n);const{numPercent:r,numThousands:l,numIntDigLeft:u,numNumerDig:m,numDenomDig:g,commaInt:p,denomValue:h}=c,f=2*r-3*l,S=d.tenTo(f),v=(0,a.isErrorOper)(S)?S:d.mul(d.abs(t),S);if((0,a.isErrorOper)(v))throw new Pe((0,a.notImplemented)(["overflow on fraction exp adjust"]));const y=e=>{for(let t=e;t<k.length;t+=1){const e=k[t];e.kind===s.FormattedUnitKind.String&&(k[t]=(0,s.formattedUnitBlank)(e.str))}};let F,C,R,E=c.anyZeroNumer;if(void 0!==c.codeInt){let t=d.trunc(v);const r=d.sub(v,t);if((0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart fracPart sub",(0,a.isNumberOper)(r)),({numer:F,denom:C}=this.formFraction(r,h,g)),(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart numer <= denom",d.cond2(F,C)<=0),0===d.cond2(F,C)){F=d.zero;const e=d.add(t,d.one);(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart bumped error",(0,a.isNumberOper)(e)),t=e}0!==d.cond(F)&&(E=!0);const n=B(d,t),s={comma:p,fractionDenom:!1,decimal:!1,digits:n,digitsExp:n.length,numDigLeft:u},l=k.length;this.applyPart(e,c.codeInt,d.zero,s),R=k.length,(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction lastDigInt",void 0!==c.lastDigInt),0===d.cond(t)&&E&&c.lastDigInt!==i.PictureSingle.Zero?(c.lastDigInt!==i.PictureSingle.Question&&(k.length=l),this.applyPart(e,c.codeBetween1,d.zero,void 0),y(l),c.firstDigNumer!==i.PictureSingle.Question&&(k.length=l)):this.applyPart(e,c.codeBetween1,d.zero,void 0)}else{if(({numer:F,denom:C}=this.formFraction(v,h,g)),d.cond(t)<0&&(this.onlyOneNumberPart||e.forceNeg)&&0===d.cond(F))throw Te;E=!0,R=k.length}const T=B(d,F),P={comma:!1,fractionDenom:!1,decimal:!1,digits:T,digitsExp:T.length,numDigLeft:m};this.applyPart(e,c.codeNumer,d.zero,P),this.applyPart(e,c.codeBetween2,d.zero,void 0);const N=B(d,C),A={comma:!1,fractionDenom:!0,decimal:P.decimal,digits:N,digitsExp:N.length,numDigLeft:g};this.applyPart(e,c.codeDenom,d.zero,A),E||(c.anyQuestionNumer||c.firstDigDenom===i.PictureSingle.Question?y(R):k.length=R);break}case i.PictureSingle.Decimal:(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Decimal numState",void 0!==n),n.digitsExp>0&&(n.numDigLeft=n.digitsExp,this.dumpDigLeft(e,n,n.digitsExp)),n.decimal=!0,k.push((0,s.formattedUnitString)(S.decimalSeparator));break;case i.PictureSingle.Hash:case i.PictureSingle.Zero:case i.PictureSingle.Question:{(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart H/Z/Q numState",void 0!==n);let r=c.count;if(n.decimal||n.fractionDenom&&c.kind===i.PictureSingle.Question){if(n.fractionDenom&&u!==t.length-1)throw new Pe((0,a.notImplemented)(["left-align bug in denominator"]));if(n.digitsExp<0){const e=(0,p.fastMin)(r,-n.digitsExp),t=(0,f.convertDigitsShape)((0,m.repeat)("0",e),T);k.push((0,s.formattedUnitString)(t)),n.digitsExp+=e,r-=e}{const e=(0,p.fastMin)(r,n.digits.length),t=(0,f.convertDigitsShape)(n.digits.substring(0,e),T);k.push((0,s.formattedUnitString)(t)),n.digits=n.digits.substring(e),r-=e}if(c.kind!==i.PictureSingle.Hash&&r>0){const e=(0,f.convertDigitsShape)((0,m.repeat)("0",r),T);k.push(c.kind===i.PictureSingle.Question?(0,s.formattedUnitBlank)(e):(0,s.formattedUnitString)(e))}break}if(n.numDigLeft>n.digitsExp){const e=(0,p.fastMin)(r,n.numDigLeft-n.digitsExp);if(c.kind!==i.PictureSingle.Hash){let t=(0,f.convertDigitsShape)((0,m.repeat)("0",e),T);n.comma&&(t=(0,f.insertCommas)(S,t,n.numDigLeft-e)),k.push(c.kind===i.PictureSingle.Question?(0,s.formattedUnitBlank)(t):(0,s.formattedUnitString)(t))}r-=e,n.numDigLeft-=e}else r+=n.digitsExp-n.numDigLeft,n.numDigLeft=n.digitsExp;this.dumpDigLeft(e,n,r);break}case X.PrefixDigTh:S.isThai&&(T=e.numShape=v.NumberShape.Thai);break;case X.LatinDate:this.hasTokenCurrCode||(e.bidiDate=s.BidiDate.English);break;case X.BidiDate:throw new Pe((0,a.notImplemented)(["TokenKind.BidiDate"]));case i.PictureSingle.HourTh:case i.PictureSingle.MinuteTh:case i.PictureSingle.SecondTh:case i.PictureSingle.Hour:case i.PictureSingle.Minute:case i.PictureSingle.Second:{const t=c.kind===i.PictureSingle.HourTh||c.kind===i.PictureSingle.MinuteTh||c.kind===i.PictureSingle.SecondTh,r=t&&!this.hasTokenCurrCode?v.NumberShape.Thai:T;if(c.isAbs){const n=b();if((0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart H/M/S value",!(0,a.isStringOper)(n)),t&&this.hasTokenCurrCode)throw new Pe((0,a.notImplemented)(["fcAbsHourTh && fIntlNum bug"]));const i=h.toTime(this.config,d.abs(n),he[c.kind],e.dtrRounding);if(!1===i)throw new Pe((0,a.notImplemented)(["absolute time overflow"]));k.push((0,s.formattedUnitString)(K(d,d.fromNumber(i),c.count,r)))}else{const e=R();let t;if(c.kind===i.PictureSingle.Minute||c.kind===i.PictureSingle.MinuteTh)t=e.min;else if(c.kind===i.PictureSingle.Second||c.kind===i.PictureSingle.SecondTh)t=e.sec;else if(t=e.hour,c.isAMPM){if(c.kind===i.PictureSingle.HourTh)throw new Pe((0,a.notImplemented)(["fc12HourTh/fc12Hour2Th forgotten"]));t>12&&(t-=12),0===t&&(t=12)}k.push((0,s.formattedUnitString)(K(d,d.fromNumber(t),c.count,r)))}break}case X.AMPM:case X.AMPMFE:{let e;if(e=!!(0,a.isStringOper)(r)||R().hour<12,(!this.hasTokenCurrCode||c.kind===X.AMPMFE)&&(c.kind===X.AMPMFE||S.isEastAsia||c.pictureKind===i.PictureSpecial.AP2)){const t=ne(S,c.tokenStr);k.push((0,s.formattedUnitString)(t[e?0:1]));break}const t=this.getBundledLocaleInfo("localised AM/PM string",v.Calendar.Gregorian,this.applyCurrCode);k.push((0,s.formattedUnitString)(t.ampmSymbols[e?0:1]));break}case Se.FracSeconds:{const e=R();(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart FracSeconds rounding",e.rounding>=c.rounding);const t=U(d,d.fromNumber(e.fracSec),e.rounding,c.rounding,T);k.push((0,s.formattedUnitString)(S.decimalSeparator+t));break}case i.PictureSingle.Era:throw new Pe((0,a.notImplemented)(["PictureSingle.Era"]));case i.PictureSingle.EraYear:throw new Pe((0,a.notImplemented)(["PictureSingle.EraYear"]));case i.PictureSingle.YearTh:case i.PictureSingle.EngYearTh:case i.PictureSingle.ThYear:case i.PictureSingle.Year:{const e=c.kind!==i.PictureSingle.YearTh&&c.kind!==i.PictureSingle.ThYear||this.hasTokenCurrCode?T:v.NumberShape.Thai,t=(c.kind===i.PictureSingle.YearTh||c.kind===i.PictureSingle.EngYearTh)&&!this.hasTokenCurrCode,r=R().yr+(t?543:0),n=c.count>2?r:r%100;k.push((0,s.formattedUnitString)(K(d,d.fromNumber(n),c.count,e)));break}case i.PictureSingle.Month:case i.PictureSingle.MonthTh:{const t=R().mon;switch(c.count){case 1:case 2:{const e=c.kind!==i.PictureSingle.MonthTh||this.hasTokenCurrCode?T:v.NumberShape.Thai;k.push((0,s.formattedUnitString)(K(d,d.fromNumber(t),c.count,e)));break}case 3:case 4:case 5:{let r;if(r=e.bidiDate===s.BidiDate.English?(0,i.getEnglishLocaleInfo)():this.getBundledLocaleInfo("localised month string",y,c.kind!==i.PictureSingle.MonthTh||this.hasTokenCurrCode?this.applyCurrCode:pe),3===c.count)k.push((0,s.formattedUnitString)(r.monthNameShort[t-1]));else if(4===c.count||e.bidiDate===s.BidiDate.English)k.push((0,s.formattedUnitString)(r.monthNameLong[t-1]));else{const e=r.monthNameLong[t-1];k.push((0,s.formattedUnitString)(e.substring(0,(0,l.numCodeUnits)((0,l.stringCodePointAt)(e,0)))))}break}}break}case i.PictureSingle.Day:case i.PictureSingle.DayTh:case i.PictureSingle.LocDay:{const t=c.kind===i.PictureSingle.DayTh;if(c.count<3){const e=t&&!this.hasTokenCurrCode?v.NumberShape.Thai:T,r=R().dom;k.push((0,s.formattedUnitString)(K(d,d.fromNumber(r),c.count,e)))}else{const r=R().wdy;let n;if(n=e.bidiDate===s.BidiDate.English||!this.hasTokenCurrCode&&S.isEastAsia&&c.kind===i.PictureSingle.Day?(0,i.getEnglishLocaleInfo)():this.getBundledLocaleInfo("localised day string",y,t&&!this.hasTokenCurrCode?pe:this.applyCurrCode),t&&this.hasTokenCurrCode&&3===c.count)throw new Pe((0,a.notImplemented)(["fcDay3Th && fIntlNum bug"]));const o=3===c.count?n.dayNameShort[r-1]:n.dayNameLong[r-1];k.push((0,s.formattedUnitString)(o))}break}case Se.SysFormat:(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart SysFormat numState",void 0===n),this.applyPart(e,c.codeSysFormat,r,n);break;default:return(0,o.assertNever)("calc.numfmt.NumberFormatImpl: applyPart code",c)}}E&&b()}dumpDigLeft(e,t,r){const{localeInfo:n}=this.config,{units:i,numShape:o}=e;let a=r;{const e=(0,p.fastMin)(a,t.digits.length);let r=(0,f.convertDigitsShape)(t.digits.substring(0,e),o);t.comma&&(r=(0,f.insertCommas)(n,r,t.numDigLeft-e)),i.push((0,s.formattedUnitString)(r)),t.digits=t.digits.substring(e),a-=e,t.digitsExp-=e,t.numDigLeft-=e}if(a>0){let e=(0,f.convertDigitsShape)((0,m.repeat)("0",a),o);t.comma&&(e=(0,f.insertCommas)(n,e,t.numDigLeft-a)),i.push((0,s.formattedUnitString)(e)),t.digitsExp-=a,t.numDigLeft-=a}}getPart(e){const{mathpack:t}=this.config;for(let r=Ce.Pos;r<Ce.Zero;r+=1){const n=r;let i;if(r===Ce.Pos){if(i=this.condPos,void 0===i&&t.cond(e)>0)return{partKind:n,forceNeg:!1}}else{if(this.parts[n]===this.parts[Ce.Pos])throw new ke(s.noFormatPart);if(0===this.parts[Ce.Pos].code.length)throw new Pe((0,a.notImplemented)(['emulation of ";[COND]foo" bug']));if(i=this.condNeg,void 0===i){if(this.parts[Ce.Zero]===this.parts[Ce.Pos])return(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: getPart condPos",void 0!==this.condPos),{partKind:n,forceNeg:t.cond(this.condPos.operand)>0||this.condPos.operator===c.OperatorId.Eq};if(t.cond(e)<0)return{partKind:n,forceNeg:!1}}}if(void 0===i)continue;const{operator:l,operand:u}=i,d=t.sub(e,u);if((0,a.isErrorOper)(d))throw new Pe((0,a.notImplemented)(["overflow in condition check"]));if((0,h.applyComparison)(l,t.cond2(e,u)))switch(l){case c.OperatorId.Eq:return{partKind:n,forceNeg:!1};case c.OperatorId.Ne:case c.OperatorId.Gt:case c.OperatorId.Ge:return{partKind:n,forceNeg:!0};case c.OperatorId.Lt:return{partKind:n,forceNeg:t.cond(u)>0};case c.OperatorId.Le:return{partKind:n,forceNeg:t.cond(u)>=0}}}const r=Ce.Zero;if(this.parts[r]===this.parts[Ce.Pos])throw new ke(s.noFormatPart);return{partKind:r,forceNeg:!0}}getNumShape(e){const t=this.applyCurrCode;let r=null==t?void 0:t.numberShape;if(void 0!==r)return r;if(void 0===e)return v.NumberShape.ASCII;const n=this.getBundledLocaleInfo("localised DBNUM culture",v.Calendar.Gregorian,t);return n.isEastAsia&&(n.isKorea?r=H[e]:n.isJapan?r=q[e]:n.isChinaT?r=V[e]:n.isChinaS&&(r=j[e])),null!=r?r:v.NumberShape.ASCII}formFraction(e,t,r){const{mathpack:n}=this.config;if(void 0!==t){const r=n.fromNumber(137438953472);if((0,a.isErrorOper)(n.sub(e,r)))throw new Pe((0,a.notImplemented)(["overflow in fraction threshold check"]));if(n.cond2(e,r)<0){const t=n.mul(e,n.fromNumber(1.0000000000000002));(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: formFraction nudged error",(0,a.isNumberOper)(t)),e=t}const i=t,l=n.toNumber(i)<<1,u=n.mul(e,n.fromNumber(l));if(!(0,a.isNumberOper)(u))throw new Pe((0,a.notImplemented)(["overflow in fraction denom mul"]));const c=n.lfix(u);if(c<0||c>=65535)throw new ke(s.fractionOverflow);return{numer:n.fromNumber(c+1>>1),denom:i}}let i;switch(r){case 1:i=10;break;case 2:i=100;break;case 3:i=1e3;break;case 4:i=1e4;break;case 5:i=1e5;break;case 6:i=1e6;break;default:i=1e7}let l=n.fix(e);if(l>=2147483647)throw new ke(s.fractionOverflow);let u=e,c=1,d=1,m=0,g=0;for(;;){const e=c*l;g+=e;const t=m*l;if(d+=t,e>2147483647||t>2147483647||d>=i){1===m&&2===l&&0===n.cond2(u,n.trunc(u))&&(c+=1);break}[c,g]=[g,c],[m,d]=[d,m];const r=n.sub(u,n.trunc(u));if((0,o.assertTrue)("calc.numfmt.NumberFormatImpl: formFraction frac sub",(0,a.isNumberOper)(r)),0===n.cond(r))break;const s=n.div(n.one,r);if((0,a.isErrorOper)(s))throw new Pe((0,a.notImplemented)(["overflow in fraction inversion"]));if(u=s,(l=n.fix(u))>2147483647)break}return 0===m&&(m=c=1),{numer:n.fromNumber(c),denom:n.fromNumber(m)}}synthesizeDecimals(e){const t=(0,p.fastMax)(0,(0,p.fastMin)(e,127)),r=[];for(let e=Ce.Pos;e<=Ce.Text;e+=1){const n=this.parts[e];if((e===Ce.Neg||e===Ce.Zero)&&n===this.parts[Ce.Pos]){r.push(r[Ce.Pos]);continue}if(e===Ce.Text){r.push(n===this.parts[Ce.Pos]?r[Ce.Pos]:n);continue}const{code:i,color:o,dbnum:a,dtrRounding:s}=n,l={code:i.map((r=>{if(r.kind===Se.Num){const{numDigLeft:n,numPercent:i,numThousands:o,comma:a,codeBefore:s}=r;return{kind:Se.Num,numDigLeft:n,numDigDec:t,numPercent:i,numThousands:o,comma:a,code:this.adjustDecimals(e,r.numDigDec,r.code,t),codeBefore:s}}if(r.kind===Se.Exp){const{isNeg:n,numMantDigLeft:i,numExpDigLeft:o,commaMant:a,codeBetween:s,codeExp:l}=r;return{kind:Se.Exp,isNeg:n,numMantDigLeft:i,numMantDigDec:t,numExpDigLeft:o,commaMant:a,codeMant:this.adjustDecimals(e,r.numMantDigDec,r.codeMant,t),codeBetween:s,codeExp:l}}return r})),color:o,dbnum:a,dtrRounding:s};r.push(l)}try{const e=new Ae(this.config,{old:this,logFormatString:`synthesizeDecimals(dec=${t} on ${this.logFormatString})`,synth:r});if(e.formatString.length>255)throw new Ne(this.notFormatString("format string too long: max length"));return e}catch(e){if(e instanceof Ne)return this;throw e}}adjustDecimals(e,t,r,n){var a;if(n===t)return r;let s,l,u,c=!1;for(let e=0;e<r.length;e+=1){const t=r[e];switch(t.kind){case i.PictureSingle.Decimal:void 0===u&&(u=e);break;case i.PictureSingle.Hash:case i.PictureSingle.Question:case i.PictureSingle.Zero:void 0!==u?l=e:(s=e,t.kind===i.PictureSingle.Question&&(c=!0))}}const d=e=>e===i.PictureSingle.Percent||e===X.Currency||e===X.CurrCode||e===i.PictureSingle.Star;if(0===n){if(void 0===u)return r;let e=0,t=0;void 0===s?void 0!==l&&(e=u+1,t=l+1):(e=u,t=(null!=l?l:u)+1);const n=r.slice(0,e);for(let i=e;i<t;i+=1)d(r[i].kind)&&n.push(r[i]);return(0,p.safePush)(n,r.slice(t)),n}if(t>n){let e;(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: adjustDecimals dec",void 0!==u),function(e){e[e.AfterDigs=0]="AfterDigs",e[e.Dropping=1]="Dropping",e[e.Keeping=2]="Keeping"}(e||(e={}));let a=e.AfterDigs;const s=[];let l=t-n;for(let t=r.length-1;t>=0;t-=1){t<=u&&(a=e.Keeping);const n=r[t];if(a===e.AfterDigs&&(n.kind!==i.PictureSingle.Hash&&n.kind!==i.PictureSingle.Question&&n.kind!==i.PictureSingle.Zero||(a=e.Dropping)),a===e.Keeping||a===e.AfterDigs||d(n.kind))s.push(n);else if(n.kind===i.PictureSingle.Hash||n.kind===i.PictureSingle.Question||n.kind===i.PictureSingle.Zero){const t=(0,p.fastMin)(l,n.count);t<n.count&&s.push({kind:n.kind,count:n.count-t}),l-=t,0===l&&(a=e.Keeping)}}return s.reverse(),s}if(e===Ce.Zero&&c&&void 0===l)return r;const m=n-t;if(void 0!==l){const e=r.slice(),t=e[l];return e[l]={kind:t.kind,count:t.count+m},e}const g=r.slice(),h=null!==(a=null!=u?u:s)&&void 0!==a?a:g.length-1,f=[];return void 0===u&&f.push({kind:i.PictureSingle.Decimal}),f.push({kind:i.PictureSingle.Zero,count:m}),g.splice(h+1,0,...f),g}parseString(e){if(this.source!==s.NumberFormatSource.CustomBytecode&&e.length>255)throw new Ne(this.notFormatString("format string too long: max length"));let t=!1,r=!1,n=0,i=!1;for(let c=Ce.Pos;c<=Ce.Text&&!i;c+=1){const d=this.tokenize(e.substring(n)),{cond:m,currencySymbol:g,hasTokenCurrCode:p}=d,h=this.convertTokToSun(d),{currCode:f,hasPercent:S,hasDate:v,hasTime:y}=h,F=this.classifySunPartKind(h,c===Ce.Text?Re.Text:Re.Unknown),{part:C,applyCurrCode:R}=this.convertSunToCode(h);if(n+=d.consumed,i=d.eos,S&&(this.hasPercent=!0),v&&(this.hasDate=!0),y&&(this.hasTime=!0),p){if(!(c===Ce.Pos||this.hasTokenCurrCode&&(l=this.thisCurrCode,u=f,l===u||void 0!==l&&void 0!==u&&(0,s.isFormatCultureEqual)(l,u))))throw new Ne((0,a.notImplemented)(["inconsistent CurrCode in number parts"]));this.hasTokenCurrCode||(this.hasTokenCurrCode=!0,this.thisCurrCode=f)}if(void 0!==R&&void 0===this.applyCurrCode&&(this.applyCurrCode=R),void 0!==g&&void 0===this.thisCurrencySymbol&&(this.thisCurrencySymbol=g),this.source===s.NumberFormatSource.System&&((0,o.assertTrue)("calc.numfmt.NumberFormatImpl.parseString: system ipart",c===Ce.Pos),!i||F===Re.Text))throw new Ne(this.notFormatString("system format with more than one part"));if((F===Re.Text||c===Ce.Pos&&F===Re.Either)&&(t=!0,this.parts[Ce.Text]=C,F===Re.Text)){if(void 0!==m)throw new Ne(this.notFormatString("condition in text part"));if(void 0!==f)throw new Ne((0,a.notImplemented)(["CurrCode in text part"]));break}if(r=!0,this.parts[c]=C,this.onlyOneNumberPart=c===Ce.Pos,c===Ce.Pos)this.parts[Ce.Neg]=C,this.parts[Ce.Zero]=C,this.condPos=m;else if(c===Ce.Neg)this.condNeg=m;else if(void 0!==m)throw new Ne(this.notFormatString("condition in zero part"))}var l,u;if(!i)throw new Ne(this.notFormatString("too many parts"));r||(this.parts[Ce.Pos]=be,this.parts[Ce.Neg]=be,this.parts[Ce.Zero]=be,this.posBeforeText=!1),t||(this.parts[Ce.Text]=be),r&&!t&&this.onlyOneNumberPart&&void 0!==this.condPos&&!ye(this.parts[Ce.Pos].code)&&(this.parts[Ce.Neg]=be,this.onlyOneNumberPart=!1),(0,o.assertTrue)("calc.numfmt.NumberFormatImpl.parseString: every part set",this.parts.every((e=>void 0!==e))),this.checkBytecode()}tokenize(e){const{localeInfo:t}=this.config,r={color:void 0,dbnum:void 0,dbnumForbidden:!1,cond:void 0,hasTokenCurrCode:!1,currCode:void 0,currencySymbol:void 0,tokens:[],consumed:0,eos:!0};let n,o,l;for(;r.consumed<e.length&&r.eos;){const t=this.readToken(r,e,r.consumed),s=n;switch(n=t,r.consumed+=t.tokenStr.length,t.kind){case i.PictureSingle.Sep:r.eos=!1;continue;case X.Color:if(void 0!==r.color)throw new Ne(this.notFormatString("more than one color"));if(0!==r.tokens.length)throw new Ne((0,a.notImplemented)(["colour in middle of format"]));r.color=t.color;continue;case X.Dbnum:if(void 0!==r.dbnum)throw new Ne(this.notFormatString("more than one DBNUM"));if(r.dbnumForbidden)throw new Ne(this.notFormatString("DBNUM after token which forbids it (% or E)"));if(0!==r.tokens.length)throw new Ne((0,a.notImplemented)(["DBNUM in middle of format"]));r.dbnum=t.dbnum;continue;case X.Cond:if(void 0!==r.cond)throw new Ne(this.notFormatString("more than one condition"));if(0!==r.tokens.length)throw new Ne((0,a.notImplemented)(["condition in middle of format"]));r.cond=t.cond;continue;case X.CurrCode:if(void 0!==o)throw new Ne(this.notFormatString("more than one currency code in section"));o=t;break;case X.Currency:l=t;break;case X.AMPM:case X.AMPMFE:case i.PictureSingle.Colon:case i.PictureSingle.DateSep:case X.LatinDate:case X.BidiDate:case i.PictureSingle.Year:case i.PictureSingle.Month:case i.PictureSingle.Day:case i.PictureSingle.Hour:case i.PictureSingle.Minute:case i.PictureSingle.Second:case i.PictureSingle.Reign:case i.PictureSingle.LocDay:case i.PictureSingle.Era:case i.PictureSingle.EraYear:case i.PictureSingle.EngYearTh:case i.PictureSingle.DayTh:case i.PictureSingle.MonthTh:case i.PictureSingle.YearTh:case i.PictureSingle.ThYear:case i.PictureSingle.HourTh:case i.PictureSingle.MinuteTh:case i.PictureSingle.SecondTh:if((null==s?void 0:s.kind)===t.kind){s.count+=t.count;continue}}r.tokens.push(t)}return void 0!==o?(r.hasTokenCurrCode=!0,r.currCode=o.currCode,r.currencySymbol=o.currencySymbol):void 0!==l&&void 0===r.currencySymbol&&(r.currencySymbol=s.FormatCurrency.LocaleInfo),4!==r.dbnum||t.isKorea||void 0===r.currCode&&!t.isThai||(r.dbnum=void 0),r}readToken(e,t,r){const{mathpack:n,localeInfo:s}=this.config,u=Z(s,s.pictureSpecial,t,r);if(void 0!==u){let e=u;const n=te(s.pictureSpecial,e);s.isJapan&&e===i.PictureSpecial.GeneralOldMAC&&(e=i.PictureSpecial.General);const o=t.substring(r,r+n.length);switch(e){case i.PictureSpecial.AP1:case i.PictureSpecial.AP2:return{kind:X.AMPM,tokenStr:o,count:1,pictureKind:e};case i.PictureSpecial.AP3:return{kind:X.AMPMFE,tokenStr:o,count:1};case i.PictureSpecial.General:return{kind:X.General,tokenStr:o};case i.PictureSpecial.Currency:return{kind:X.Currency,tokenStr:o}}}const c=(0,l.stringCodePointAt)(t,r),g=(0,l.numCodeUnits)(c),p=t.substring(r,r+g),h=ee(s,s.pictureSingle,t,r);if(void 0!==h){let u=h;if((s.isJapan||s.isChinaT)&&(u===i.PictureSingle.E||u===i.PictureSingle.EraYear)){let e,n;u=!(r+g+1<t.length)||(e=t.charCodeAt(r+g))!==T&&e!==k||(n=t.charCodeAt(r+g+1))!==P&&n!==N&&n!==A?i.PictureSingle.EraYear:i.PictureSingle.E}if(u===i.PictureSingle.BidiDate||u===i.PictureSingle.EngYearTh){let e;if(r+g<t.length&&((e=t.charCodeAt(r+g))===I||e===O))return{kind:e===I?X.LatinDate:X.BidiDate,tokenStr:t.substring(r,r+g+1),count:1};u=i.PictureSingle.EngYearTh}if(u===i.PictureSingle.BidiNum)throw new Ne(this.notFormatString("bidi num not allowed"));switch(u){case i.PictureSingle.Star:case i.PictureSingle.Underscore:{if(r+g>=t.length)throw new Ne(this.notFormatString("unterminated "+p));const e=(0,l.stringCodePointAt)(t,r+g),n=(0,l.numCodeUnits)(e),i=(0,l.stringFromCodePoint)(e);return{kind:u,tokenStr:t.substring(r,r+g+n),escaped:i}}case i.PictureSingle.Backslash:return this.readToken_Backslash(t,r,g);case i.PictureSingle.Quote:{const e=t.indexOf(p,r+g);if(e<0)throw new Ne(this.notFormatString("unterminated quoted string"));const n=t.substring(r+g,e),o=t.substring(r,e+g),a=Z(s,s.pictureSpecial,n,0);return void 0!==a&&a===i.PictureSpecial.Currency&&te(s.pictureSpecial,a).length===n.length?{kind:X.Currency,tokenStr:o}:{kind:X.StrLit,tokenStr:o,escaped:n}}case i.PictureSingle.E:{if(s.isEastAsia){if(void 0!==e.dbnum)throw new Ne(this.notFormatString("invalid DBNUM with exp"));if(e.dbnumForbidden)throw new Ne((0,a.notImplemented)(["multiple DBNUM-forbidden tokens (% or E)"]));e.dbnumForbidden=!0}if(r+g>=t.length)throw new Ne(this.notFormatString("unterminated exp"));const n=t.charCodeAt(r+g);if(n!==k&&n!==T)throw new Ne(this.notFormatString("exp not followed by sign"));const i=t.substring(r,r+g+1);return{kind:X.Exp,tokenStr:i,eStr:p,isNeg:n===T}}case i.PictureSingle.Hash:case i.PictureSingle.Year:case i.PictureSingle.Month:case i.PictureSingle.Day:case i.PictureSingle.Hour:case i.PictureSingle.Minute:case i.PictureSingle.Second:case i.PictureSingle.YearTh:case i.PictureSingle.MonthTh:case i.PictureSingle.DayTh:case i.PictureSingle.HourTh:case i.PictureSingle.MinuteTh:case i.PictureSingle.SecondTh:case i.PictureSingle.EngYearTh:case i.PictureSingle.ThYear:case i.PictureSingle.Question:case i.PictureSingle.Comma:case i.PictureSingle.Reign:case i.PictureSingle.LocDay:case i.PictureSingle.Era:case i.PictureSingle.EraYear:{if(u===i.PictureSingle.Reign&&!s.isJapan&&!s.isChinaT)break;let e=g,n=1;for(;(0,m.stringStartsWith)(t,p,r+e)&&void 0===Z(s,s.pictureSpecial,t,r+e);)e+=g,n+=1;if(u===i.PictureSingle.LocDay&&n<3)break;return{kind:u,tokenStr:t.substring(r,r+e),count:n}}case i.PictureSingle.Sep:case i.PictureSingle.Text:case i.PictureSingle.Decimal:case i.PictureSingle.Slash:case i.PictureSingle.Minus:case i.PictureSingle.Plus:return{kind:u,tokenStr:p};case i.PictureSingle.Space:return{kind:X.Char,tokenStr:p,escaped:p};case i.PictureSingle.Colon:return{kind:u,tokenStr:p,count:1};case i.PictureSingle.Percent:if(s.isEastAsia){if(void 0!==e.dbnum)throw new Ne(this.notFormatString("invalid DBNUM with pct"));if(e.dbnumForbidden)throw new Ne((0,a.notImplemented)(["multiple DBNUM-forbidden tokens (% or E)"]));e.dbnumForbidden=!0}return{kind:i.PictureSingle.Percent,tokenStr:p};case i.PictureSingle.DateSep:return p===te(s.pictureSingle,i.PictureSingle.Slash)?{kind:i.PictureSingle.Slash,tokenStr:p}:p===te(s.pictureSingle,i.PictureSingle.Minus)?{kind:i.PictureSingle.Minus,tokenStr:p}:{kind:i.PictureSingle.DateSep,tokenStr:p,count:1};case i.PictureSingle.ColorStart:{const e=te(s.pictureSingle,i.PictureSingle.ColorEnd),o=t.indexOf(e,r+g);if(o<0)throw new Ne(this.notFormatString("unterminated ["));const l=t.substring(r+g,o),c=t.substring(r,o+e.length),h=Z(s,Q,l,0);if(void 0!==h){let e=te(Q,h).length;for(;e<l.length&&(0,d.isSpace)(l.charCodeAt(e));)e+=1;const t=(0,d.parseSignedLiteral)(s,n,l,e,!1);if(t[1]===e)throw new Ne((0,a.notImplemented)(["invalid number in condition"]));if(t[1]!==l.length)throw new Ne((0,a.notImplemented)(["trailing junk after condition"]));return{kind:X.Cond,tokenStr:c,cond:{operator:Y[h],operand:t[0]}}}const S=Z(s,s.pictureColor,l,0);if(void 0!==S){const e=te(s.pictureColor,S);if(S!==i.PictureColor.Color){if(e.length!==l.length)throw new Ne((0,a.notImplemented)(["trailing junk after named color"]));return{kind:X.Color,tokenStr:c,color:(f=S,i.PictureColor[f])}}if(S===i.PictureColor.Color){let t=e.length;for(;t<l.length&&(0,d.isSpace)(l.charCodeAt(t));)t+=1;const[r,n]=(0,d.parseUint)(s,4,l,t);if(n===t)throw new Ne(this.notFormatString("missing number for numbered color"));if(n!==l.length)throw new Ne((0,a.notImplemented)(["trailing junk after numbered color"]));if(r<1||r>56)throw new Ne(this.notFormatString("out-of-range numbered color"));return{kind:X.Color,tokenStr:c,color:r+8}}}const v=Z(s,s.pictureDbnum,l,0);if(void 0!==v){if(te(s.pictureDbnum,v).length!==l.length)throw new Ne((0,a.notImplemented)(["trailing junk after DBNUM"]));return{kind:X.Dbnum,tokenStr:c,dbnum:z(v)}}return(0,m.stringStartsWith)(l,"$")?Object.assign({kind:X.CurrCode,tokenStr:c},this.parseCurrCode(l.substring(1))):{kind:u,tokenStr:p}}case i.PictureSingle.ColorEnd:return{kind:u,tokenStr:p};case i.PictureSingle.OpenParen:case i.PictureSingle.CloseParen:return{kind:u,tokenStr:p,escaped:p};case i.PictureSingle.Extra:case i.PictureSingle.APDelim:case i.PictureSingle.Nen1:case i.PictureSingle.Gatsu1:case i.PictureSingle.Nichi1:case i.PictureSingle.Nen2:case i.PictureSingle.Gatsu2:case i.PictureSingle.Nichi2:case i.PictureSingle.Zero:case i.PictureSingle.ZeroTh:break;default:return(0,o.assertNever)("calc.numfmt.NumberFormatImpl: readToken single picKind",u)}}var f;if(s.isNumeral(c)){if(s.getNumberShape(c)!==v.NumberShape.ASCII)throw new Ne((0,a.notImplemented)(["non-ASCII digits"]));const e=s.getOrdinal(c);if(0===e){let e=g,n=1;for(;(0,m.stringStartsWith)(t,p,r+e);)e+=g,n+=1;const o=t.substring(r,r+e);return{kind:i.PictureSingle.Zero,tokenStr:o,count:n}}return{kind:X.Numeral,tokenStr:p,ordinal:e}}switch(c){case _:return{kind:i.PictureSingle.OpenParen,tokenStr:p,escaped:p};case M:return{kind:i.PictureSingle.CloseParen,tokenStr:p,escaped:p};case w:return this.readToken_Backslash(t,r,g);case D:if(s.isThai)return{kind:X.PrefixDigTh,tokenStr:p}}return{kind:X.Char,tokenStr:p,escaped:p}}readToken_Backslash(e,t,r){if(t+r>=e.length)throw new Ne(this.notFormatString("unterminated backslash"));const n=(0,l.stringCodePointAt)(e,t+r),o=(0,l.numCodeUnits)(n),a=(0,l.stringFromCodePoint)(n),s=e.substring(t,t+r+o);return n===_||n===M?{kind:n===_?i.PictureSingle.OpenParen:i.PictureSingle.CloseParen,tokenStr:s,escaped:a}:{kind:X.Char,tokenStr:s,escaped:a}}convertTokToSun({color:e,dbnum:t,cond:r,currCode:n,tokens:s}){var l;const{localeInfo:u}=this.config,c={suns:[],dtrRounding:y.Rounding.RoundSec,color:e,dbnum:t,currCode:n,hasPercent:!1,hasDate:!1,hasTime:!1,get isEmpty(){return 0===this.suns.length&&void 0===r&&void 0===e&&void 0===t&&void 0===n}},d=0===u.stringCompareCI(te(u.pictureSingle,i.PictureSingle.Month),te(u.pictureSingle,i.PictureSingle.Minute));let m,g,h,f,S,v=!1,F=0,C=0,R=!1,b=!1,E=!1,T=!1,k=0;const P=(e,t)=>{const r=he[e];if(t){if(b)throw new Ne(this.notFormatString("more than one absolute time"));if(void 0!==m&&r>=m)throw new Ne(this.notFormatString("absolute time must be largest division"));b=!0}else if(b&&r<=m)throw new Ne((0,a.notImplemented)(["larger time division after absolute time"]));(void 0===m||r<m)&&(m=r)};function N(e,t,r){const n=m;if(P(e,t),e===i.PictureSingle.Hour||e===i.PictureSingle.HourTh)E=!0,f=r,S=void 0;else if(e===i.PictureSingle.Second||e===i.PictureSingle.SecondTh)if(void 0===S||b)void 0===n&&(E=!0);else{const e=S.code[0];(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: onTime ambigCode",e.kind===i.PictureSingle.Month);const t=i.PictureSingle.Minute,r=e.count;(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: onTime ambigCount",1===r||2===r);const n=!1;P(t,n),F-=1,C+=1,S.code=[{kind:t,count:r,isAbs:n}],S=void 0}else E=!1}function A(e){const t=te(u.pictureSingle,e.kind);return{kind:Se.TimeSep,printAsTimeSep:F>0||C>0,formattedStr:t}}function I(e){const t=te(u.pictureSingle,e.kind);return t===te(u.pictureSingle,i.PictureSingle.DateSep)?{kind:Se.DateSep}:t===te(u.pictureSingle,i.PictureSingle.Colon)?A(e):{kind:Se.Char,formattedStr:t}}for(let e=0;e<s.length;e+=1){const t=s[e];switch(t.kind){case X.AMPM:case X.AMPMFE:case i.PictureSingle.Colon:case i.PictureSingle.DateSep:case i.PictureSingle.Year:case i.PictureSingle.Month:case i.PictureSingle.Day:case i.PictureSingle.Hour:case i.PictureSingle.Minute:case i.PictureSingle.Second:case i.PictureSingle.Reign:case i.PictureSingle.LocDay:case i.PictureSingle.Era:case i.PictureSingle.EraYear:case i.PictureSingle.EngYearTh:case X.LatinDate:case X.BidiDate:case i.PictureSingle.DayTh:case i.PictureSingle.MonthTh:case i.PictureSingle.YearTh:case i.PictureSingle.ThYear:case i.PictureSingle.HourTh:case i.PictureSingle.MinuteTh:case i.PictureSingle.SecondTh:{const r={kind:Fe.Date,code:[]};switch(c.suns.push(r),R=!0,t.kind){case X.LatinDate:case X.BidiDate:if(0!==e&&(1!==e||s[0].kind!==X.CurrCode))throw new Ne(this.notFormatString("bidi date must be first"));r.code.push(t);break;case i.PictureSingle.DateSep:r.code.push({kind:Se.DateSep});break;case i.PictureSingle.Colon:r.code.push(A(t));break;case i.PictureSingle.Reign:F+=1,u.isJapan&&t.count>=2&&r.code.push({kind:i.PictureSingle.Era,count:3}),r.code.push({kind:i.PictureSingle.EraYear,count:u.isChinaT?1:2});break;case i.PictureSingle.Era:F+=1,r.code.push({kind:i.PictureSingle.Era,count:(0,p.fastMin)(3,t.count)});break;case i.PictureSingle.EraYear:F+=1,r.code.push({kind:i.PictureSingle.EraYear,count:(0,p.fastMin)(2,t.count)});break;case i.PictureSingle.Year:case i.PictureSingle.YearTh:case i.PictureSingle.EngYearTh:case i.PictureSingle.ThYear:S=void 0,F+=1,r.code.push({kind:t.kind,count:t.count<=2?2:4});break;case i.PictureSingle.Month:if(d&&t.count<=2){if(E){const e=i.PictureSingle.Minute,n=!1;N(e,n,r),C+=1,r.code.push({kind:e,count:t.count,isAbs:n}),E=!1;break}S=r}else S=void 0;F+=1,r.code.push({kind:t.kind,count:(0,p.fastMin)(5,t.count)});break;case i.PictureSingle.MonthTh:F+=1,r.code.push({kind:t.kind,count:(0,p.fastMin)(4,t.count)});break;case i.PictureSingle.Day:case i.PictureSingle.DayTh:S=void 0,F+=1,r.code.push({kind:t.kind,count:(0,p.fastMin)(4,t.count)});break;case i.PictureSingle.LocDay:S=void 0,F+=1,r.code.push({kind:i.PictureSingle.LocDay,count:3===t.count?3:4});break;case i.PictureSingle.Hour:case i.PictureSingle.HourTh:case i.PictureSingle.Minute:case i.PictureSingle.MinuteTh:case i.PictureSingle.Second:case i.PictureSingle.SecondTh:{const e=!1;N(t.kind,e,r),C+=1;const n=(0,p.fastMin)(2,t.count);t.kind===i.PictureSingle.Hour||t.kind===i.PictureSingle.HourTh?r.code.push({kind:t.kind,count:n,isAbs:e,isAMPM:!1}):r.code.push({kind:t.kind,count:n,isAbs:e});break}case X.AMPM:case X.AMPMFE:if(b)throw new Ne(this.notFormatString("AM/PM after absolute time"));if(t.count>1)throw new Ne((0,a.notImplemented)(["multiple AM/PM symbols"]));void 0!==f&&(f.code[0].isAMPM=!0,f=void 0),T=!0,r.code.push(t);break;default:return(0,o.assertNever)("calc.numfmt.NumberFormatImpl: convertTokToSun tok as date",t)}break}case i.PictureSingle.Decimal:case X.Numeral:case i.PictureSingle.Hash:case i.PictureSingle.Zero:case i.PictureSingle.Question:case i.PictureSingle.Comma:{if(R){if(t.kind!==i.PictureSingle.Decimal&&t.kind!==i.PictureSingle.Comma)throw new Ne(this.notFormatString("number picture in date/time format"));const r={kind:Fe.Date,code:[]};c.suns.push(r);const n=s[e+1];if(t.kind===i.PictureSingle.Decimal&&(null==n?void 0:n.kind)===i.PictureSingle.Zero){const t=n.count;if(t>3)throw new Ne(this.notFormatString("invalid number of fractional seconds"));e+=1,N(i.PictureSingle.Second,!1,r),C+=1,r.code.push({kind:Se.FracSeconds,rounding:t}),c.dtrRounding=(0,p.fastMax)(c.dtrRounding,t)}else r.code.push(I(t));break}if(t.kind===i.PictureSingle.Comma){const e=te(u.pictureSingle,t.kind),r={kind:Fe.Other,code:[{kind:Se.Char,formattedStr:e}]};c.suns.push(r);break}const r=e=>e===X.Numeral||e===i.PictureSingle.Hash||e===i.PictureSingle.Zero||e===i.PictureSingle.Question,n={kind:Fe.Num,code:[],numDigLeft:0,numDigDec:0,numPercent:0,numThousands:0,comma:!1,decimal:!1,numVal:!1,nonZero:!1,get digitTokens(){return this.anyHash||this.anyQuestion},get reallyNum(){return this.anyHash||this.anyQuestion||this.anyZero},lastDig:void 0,firstDig:void 0,anyHash:!1,anyQuestion:!1,anyZero:!1};let o;for(c.suns.push(n),void 0===g&&(g=n),h=n,e-=1;e+1<s.length;e+=1){const t=s[e+1];let a=!0;switch(t.kind){case i.PictureSingle.Decimal:v=n.decimal=!0,n.code.push(t),o=void 0;break;case X.Numeral:n.code.push({kind:t.kind,formattedStr:t.tokenStr,ordinal:t.ordinal}),n.numVal=n.nonZero=!0,o=void 0;break;case i.PictureSingle.Hash:case i.PictureSingle.Zero:case i.PictureSingle.Question:if(n.decimal?n.numDigDec+=t.count:n.numDigLeft+=t.count,void 0===n.firstDig&&(n.firstDig=t.kind),n.lastDig=t.kind,t.kind===i.PictureSingle.Hash?n.anyHash=!0:t.kind===i.PictureSingle.Question?n.anyQuestion=!0:(n.anyZero=!0,n.numVal=!0),void 0!==o&&o.kind===t.kind)o.count+=t.count;else{const e={kind:t.kind,count:t.count};n.code.push(e),o=e}break;case i.PictureSingle.Comma:const c=null===(l=s[e+2])||void 0===l?void 0:l.kind;if(r(c))v||(n.comma=!0);else{let e=t.count;const r=te(u.pictureSingle,i.PictureSingle.Space);r===te(u.pictureSingle,i.PictureSingle.Comma)&&(!u.isCurrencySymbolLead&&u.isCurrencySepBySpace&&c===X.Currency||u.isPercentSepBySpace&&c===i.PictureSingle.Percent)&&(n.code.push({kind:Se.Char,formattedStr:r}),e-=1),e>0&&(n.numThousands+=e)}break;default:a=!1}if(!a)break}break}case i.PictureSingle.Percent:{k+=1;const e={kind:Fe.Percent,code:[{kind:i.PictureSingle.Percent,formattedStr:t.tokenStr}]};c.suns.push(e),c.hasPercent=!0;break}case X.Exp:{const e={kind:Fe.Exp,code:[{kind:X.Exp,formattedStr:t.eStr,isNeg:t.isNeg}],isNeg:t.isNeg};c.suns.push(e);break}case X.General:{const e={kind:Fe.General,code:[t]};c.suns.push(e);break}case i.PictureSingle.Text:{const e={kind:Fe.Text,code:[t]};c.suns.push(e);break}case i.PictureSingle.Slash:{if(R){const e={kind:Fe.Date,code:[I(t)]};c.suns.push(e);break}const e={kind:Fe.Fraction,code:[{kind:i.PictureSingle.Slash,formattedStr:t.tokenStr}]};c.suns.push(e);break}case i.PictureSingle.Star:case X.PrefixDigTh:case i.PictureSingle.Underscore:case X.Currency:case X.CurrCode:case X.StrLit:{const e={kind:Fe.Other,code:[t]};c.suns.push(e);break}case i.PictureSingle.ColorEnd:case i.PictureSingle.Plus:{const e={kind:Fe.Other,code:[{kind:Se.Char,formattedStr:t.tokenStr}]};c.suns.push(e);break}case i.PictureSingle.OpenParen:case i.PictureSingle.CloseParen:case X.Char:{const e={kind:Fe.Other,code:[{kind:Se.Char,formattedStr:t.escaped}]};c.suns.push(e);break}case i.PictureSingle.Minus:{if(R){const e={kind:Fe.Date,code:[I(t)]};c.suns.push(e);break}const e=te(u.pictureSingle,t.kind),r={kind:Fe.Other,code:[{kind:Se.Char,formattedStr:e}]};c.suns.push(r);break}case i.PictureSingle.ColorStart:{let t=L.WantPic;const r={kind:Fe.Date,code:[]};for(;e+1<s.length&&t!==L.Done;e+=1){const n=s[e+1];switch(n.kind){case i.PictureSingle.ColorEnd:if(t!==L.WantClose)throw new Ne(this.notFormatString("unexpected closing ]"));t=L.Done;continue;case i.PictureSingle.Hour:case i.PictureSingle.HourTh:case i.PictureSingle.Month:case i.PictureSingle.Minute:case i.PictureSingle.Second:{if(n.kind===i.PictureSingle.Month&&!d)break;const e=n.kind===i.PictureSingle.Month?i.PictureSingle.Minute:n.kind,o=!0;N(e,o,r),C+=1;const a=(0,p.fastMin)(2,n.count);e===i.PictureSingle.Hour||e===i.PictureSingle.HourTh?r.code.push({kind:e,count:a,isAbs:o,isAMPM:!1}):r.code.push({kind:e,count:a,isAbs:o}),R=!0,t=L.WantClose;continue}case X.Char:if(n.tokenStr===te(u.pictureSingle,i.PictureSingle.Space))continue}throw new Ne(this.notFormatString("unexpected token after ["))}if(t!==L.Done)throw new Ne((0,a.notImplemented)(["semicolon inside [ ]"]));c.suns.push(r);break}default:return(0,o.assertNever)("calc.numfmt.NumberFormatImpl: convertTokToSun tok",t)}if(c.suns.length>=2){const e=c.suns[c.suns.length-2],t=c.suns[c.suns.length-1];if(e.kind===Fe.Other&&t.kind===Fe.Other){const r=e.code;(0,p.safePush)(r,t.code),c.suns.pop()}}}if(void 0!==g&&(g.numThousands=h.numThousands,g.numPercent=k),T&&void 0!==f&&(f.code[0].isAMPM=!0),b)for(const e of c.suns)if(e.kind===Fe.Date)for(const t of e.code)switch(t.kind){case i.PictureSingle.Hour:case i.PictureSingle.HourTh:case i.PictureSingle.Minute:case i.PictureSingle.MinuteTh:case i.PictureSingle.Second:case i.PictureSingle.SecondTh:t.isAbs=he[t.kind]===m}if(c.suns.length>32)throw new Ne(this.notFormatString("format string too long: SUNs limit"));return c.hasDate=F>0,c.hasTime=C>0,c}classifySunPartKind({suns:e,isEmpty:t,hasDate:r,hasTime:n},i){let a=i===Re.Number,s=i===Re.Text,l=!a&&!s;for(const t of e){switch(t.kind){case Fe.Num:case Fe.Fraction:case Fe.Percent:case Fe.Exp:a=!0;break;case Fe.Text:s=!0;break;case Fe.General:continue;case Fe.Other:case Fe.Date:break;default:return(0,o.assertNever)("calc.numfmt.NumberFormatImpl: classifySunPartKind sun",t)}l=!1}if((a?1:0)+(r||n?1:0)+(s?1:0)>1)throw new Ne(this.notFormatString("cannot mix number/date/text"));return a||r||n?Re.Number:s?Re.Text:l&&!t?Re.Either:i}convertSunToCode({suns:e,isEmpty:t,dtrRounding:r,color:n,dbnum:i,currCode:a}){const{localeInfo:l}=this.config,u=[];function c(t){for(let r=t-1;r>=0;r-=1){const t=e[r];if(t.kind===Fe.Num)return[r,t]}}function d(t){for(let r=t+1;r<e.length;r+=1){const t=e[r];if(t.kind===Fe.Num)return[r,t]}}let m,g=!1,h=0;for(let t=0;t<e.length;t+=1){const r=e[t];switch(r.kind){case Fe.Text:if(m===Fe.Text)break;if(void 0!==m)throw new Ne(this.notFormatString("@ after other control"));m=Fe.Text;break;case Fe.General:if(void 0!==m)throw new Ne(this.notFormatString("General after other control"));if(g)throw new Ne(this.notFormatString("General after number"));m=Fe.General;break;case Fe.Num:if(g=!0,m===Fe.General)throw new Ne(this.notFormatString("number after General"));break;case Fe.Fraction:if(void 0!==m)throw new Ne(this.notFormatString("/ after other control"));if(l.isEastAsia&&void 0!==i)throw new Ne(this.notFormatString("/ not allowed with DBNUM"));m=Fe.Fraction;const n=c(t);if(void 0===n)throw new Ne(this.notFormatString("no number before /"));const[a,s,f]=this.mergeNumSuns(e,h,n[0]),S=d(t);if(void 0===S)throw new Ne(this.notFormatString("no number after /"));const v=e.slice(n[0]+1,S[0]),y=void 0!==d(S[0]);(0,p.safePush)(u,this.flattenSuns(a)),(0,p.safePush)(u,this.buildFractCode(s,f,n[1],v,S[1],y)),h=S[0]+1;break;case Fe.Exp:if(void 0!==m)throw new Ne(this.notFormatString("E after other control"));m=Fe.Exp;const[F,C,R]=this.mergeNumSuns(e,h,t);if(void 0===C)throw new Ne(this.notFormatString("no number before E"));const[b,E,T]=this.mergeNumSuns(e,t+1,e.length);if(void 0===E)throw new Ne(this.notFormatString("no number after E"));(0,p.safePush)(u,this.flattenSuns(F)),(0,p.safePush)(u,this.buildExpCode(r.isNeg,C,[...R,e[t],...b],E)),(0,p.safePush)(u,this.flattenSuns(T)),h=e.length;break;case Fe.Percent:case Fe.Other:case Fe.Date:break;default:return(0,o.assertNever)("calc.numfmt.NumberFormatImpl: convertSunToCode sun",r)}}if(void 0===m){const[t,r,n]=this.mergeNumSuns(e,h,e.length);void 0!==r?(0,p.safePush)(u,this.buildNumberCode(t,r)):(0,p.safePush)(u,this.flattenSuns(t)),(0,p.safePush)(u,this.flattenSuns(n)),h=e.length}(0,p.safePush)(u,this.flattenSuns(e.slice(h))),0!==e.length||t||u.push(ve);const f=null==a?void 0:a.tag;if((0,s.isSystemCultureTag)(f)){const e=f===s.CultureTag.SysDate?l.sysDateFormat:l.sysTimeFormat,t=new Ae(this.config,{old:void 0,formatString:e,source:s.NumberFormatSource.System}),r=t.parts[Ce.Pos];return{part:{code:[{kind:Se.SysFormat,codeSysFormat:r.code,codeThisFormat:u}],color:r.color,dbnum:r.dbnum,dtrRounding:r.dtrRounding},applyCurrCode:t.thisCurrCode}}return{part:{code:u,color:n,dbnum:i,dtrRounding:r},applyCurrCode:a}}flattenSuns(e){return(0,p.safeConcat)([],e.map((e=>e.code)))}buildExpCode(e,t,r,n){if(n.comma)throw new Ne(this.notFormatString("comma following E"));const i=t.numDigDec;if(i>127)throw new Ne(this.notFormatString("too many decimal digits"));const{code:o,comma:a,numDigLeft:s}=this.bumpDigitsForComma(t);return[{kind:Se.Exp,isNeg:e,numMantDigLeft:s,numMantDigDec:i,numExpDigLeft:n.numDigLeft,commaMant:a,codeMant:o,codeBetween:this.flattenSuns(r),codeExp:this.flattenSuns([n])}]}buildNumberCode(e,t){const{numDigDec:r}=t;if(r>127)throw new Ne(this.notFormatString("too many decimal digits"));const{code:n,comma:i,numDigLeft:o}=this.bumpDigitsForComma(t);return[{kind:Se.Num,numDigLeft:o,numDigDec:r,numPercent:t.numPercent,numThousands:t.numThousands,comma:i,codeBefore:this.flattenSuns(e),code:n}]}buildFractCode(e,t,r,n,s,l){var u,c;const{mathpack:d}=this.config;if(r.comma)throw new Ne(this.notFormatString("comma in numerator"));if(r.decimal)throw new Ne((0,a.notImplemented)(["decimals in numerator"]));if(s.comma)throw new Ne(this.notFormatString("comma in denominator"));if(s.decimal)throw new Ne(this.notFormatString("decimals in denominator"));if(0!==r.numDigDec)throw new Ne(this.notFormatString("decimals in numerator"));if((m=s).numVal&&m.nonZero&&m.digitTokens)throw new Ne(this.notFormatString("literal and placeholder digits mixed in denominator"));var m;if(l)throw new Ne((0,a.notImplemented)(["fraction number formats with trailing numbers"]));let g,p=!1,h=0;if(void 0!==e){if(!e.reallyNum)throw new Ne((0,a.notImplemented)(["fixed numerals in fraction integer part"]));if(e.decimal)throw new Ne((0,a.notImplemented)(["decimal in fraction integer part"]));if(0!==e.numDigDec)throw new Ne(this.notFormatString("decimals in fraction integer part"));if(e.numVal&&e.nonZero)throw new Ne((0,a.notImplemented)(["numerals in fraction integer part"]));({code:g,comma:p,numDigLeft:h}=this.bumpDigitsForComma(e))}const f=null!==(u=null==e?void 0:e.numPercent)&&void 0!==u?u:r.numPercent,S=null!==(c=null==e?void 0:e.numThousands)&&void 0!==c?c:r.numThousands;if(S>0)throw new Ne((0,a.notImplemented)(["fraction number formats with thousands"]));let v,{code:y,numDigLeft:F,firstDig:C}=s;if(s.numVal&&s.nonZero){if(l)throw new Ne((0,a.notImplemented)(["fraction number formats with specified denominator and trailing numbers"]));if(s.code.length>5)throw new Ne((0,a.notImplemented)(["too many digits in denominator"]));let e=0;for(let t=0;t<s.code.length;t+=1){const r=s.code[t];switch(r.kind){case X.Numeral:e=10*e+r.ordinal;break;case i.PictureSingle.Zero:if(0===t)throw new Ne((0,a.notImplemented)(["leading zero in denominator"]));e*=10;break;default:return(0,o.assertFalse)("calc.numfmt.NumberFormatImpl: buildFractCode denomCode")}}if(e>32767)throw new Ne((0,a.notImplemented)(["overflow in denominator not emulated"]));y=[{kind:i.PictureSingle.Hash,count:1}],F=1,C=void 0,v=d.fromNumber(e)}return[{kind:Se.Fraction,numIntDigLeft:h,numPercent:f,numThousands:S,numNumerDig:r.numDigLeft,numDenomDig:F,commaInt:p,codeInt:g,codeBetween1:this.flattenSuns(t),codeNumer:r.code,codeBetween2:this.flattenSuns(n),codeDenom:y,denomValue:v,lastDigInt:void 0!==e?e.lastDig:void 0,firstDigNumer:r.firstDig,firstDigDenom:C,anyZeroNumer:r.anyZero,anyQuestionNumer:r.anyQuestion}]}mergeNumSuns(e,t,r){const n=[],i=[];let o;for(let a=t;a<e.length&&a<r;a+=1){const t=e[a];void 0!==o?t.kind===Fe.Num?(o.decimal?o.numDigDec+=t.numDigLeft+t.numDigDec:(o.numDigLeft+=t.numDigLeft,o.numDigDec+=t.numDigDec),o.comma=o.comma||t.comma,o.decimal=o.decimal||t.decimal,o.numVal=o.numVal||t.numVal,o.nonZero=o.nonZero||t.nonZero,void 0!==t.lastDig&&(o.lastDig=t.lastDig),void 0===o.firstDig&&(o.firstDig=t.firstDig),o.anyHash=o.anyHash||t.anyHash,o.anyQuestion=o.anyQuestion||t.anyQuestion,o.anyZero=o.anyZero||t.anyZero,(0,p.safePush)(o.code,this.flattenSuns(i)),i.length=0,(0,p.safePush)(o.code,t.code)):i.push(t):t.kind===Fe.Num?o=t:n.push(t)}return[n,o,i]}bumpDigitsForComma(e){if(!e.comma)return e;if(this.anyLegalCommaPosition(e))return e;const t=e.numDigLeft%3,r=(0===t?0===e.numDigLeft?3:e.numDigLeft:e.numDigLeft+3-t)+1;for(let t=0;t<e.code.length;t+=1){const n=e.code[t];switch(n.kind){case i.PictureSingle.Hash:{const i=e.code.slice();return i[t]=Object.assign(Object.assign({},n),{count:n.count+(r-e.numDigLeft)}),{code:i,comma:!0,numDigLeft:r}}case i.PictureSingle.Zero:case i.PictureSingle.Question:case i.PictureSingle.Decimal:{const n=e.code.slice();return n.splice(t,0,{kind:i.PictureSingle.Hash,count:r-e.numDigLeft}),{code:n,comma:!0,numDigLeft:r}}}}throw new Ne((0,a.notImplemented)(["comma with pure number literal"]))}anyLegalCommaPosition(e){if(e.numDigLeft<4)return!1;const t=e=>{const t=null==e?void 0:e.kind;return t===i.PictureSingle.Hash||t===i.PictureSingle.Zero||t===i.PictureSingle.Question};let r=e.numDigLeft;for(let n=0;n<e.code.length;n+=1){const o=e.code[n];if(o.kind===i.PictureSingle.Decimal)return!1;if(t(o))for(let i=0;i<o.count;i+=1)if(r-=1,r>0&&r%3==0&&(i+1<o.count||t(e.code[n+1])))return!0}return!1}parseCurrCode(e){const{localeInfo:t}=this.config;let r,n,i;{const n=e.indexOf("-");if(0!==e.length&&0!==n){if(r=n<0?e:e.substring(0,n),r.length>61)throw new Ne(this.notFormatString("currencySymbol too long"));for(const e of(0,l.codePointIterator)(r))if(t.isNumeral(e)&&t.getNumberShape(e)!==v.NumberShape.ASCII)throw new Ne((0,a.notImplemented)(["non-ASCII digits in currencySymbol"]))}n>=0&&(i=e.substring(n+1))}if(void 0!==i&&(n=this.parseFormatCulture(i),void 0===n))throw new Ne((0,a.notImplemented)(["unhandled CurrCode: "+(0,b.anonymizeFormulaString)(e)]));if((0,s.isSystemCultureTag)(null==n?void 0:n.tag)){if(void 0!==r)throw new Ne(this.notFormatString("currencySymbol with sysdate/systime"));if(this.source===s.NumberFormatSource.System)throw new Ne(this.notFormatString("system format referenced circularly within system format"))}return{currencySymbol:r,currCode:n}}parseFormatCulture(e){var r,n;const o={culture:"",numberShape:void 0,nationalNumberInput:!1,calendar:void 0,localCalendarInput:!1,tag:void 0},l=r=>{const n=(32512&r)>>8;if(0!==n&&(o.numberShape=t.pictureNumberShape[n],void 0===o.numberShape))throw new Ne((0,a.notImplemented)([`unknown number shape ${n} in culture: ${(0,b.anonymizeFormulaString)(e)}`]));o.nationalNumberInput=0!=(32768&r);const i=127&r;if(0!==i&&(o.calendar=t.pictureCalendar[i],void 0===o.calendar))throw new Ne((0,a.notImplemented)([`unknown calendar ${i} in culture: ${(0,b.anonymizeFormulaString)(e)}`]));o.localCalendarInput=0!=(128&r)},u=e.match(oe);if(null!=u){o.culture=null!==(r=u[1])&&void 0!==r?r:"";const t=null!==(n=u[2])&&void 0!==n?n:u[3];if(null!=t){if(o.tag=ae[t.toLowerCase()],void 0===o.tag)throw new Ne((0,a.notImplemented)(["unknown CurrCode tag: "+(0,b.anonymizeFormulaString)(e)]));switch(o.tag){case s.CultureTag.SysDate:case s.CultureTag.SysTime:case s.CultureTag.Euro1:case s.CultureTag.Euro2:case s.CultureTag.Bitcoin1:case s.CultureTag.Bitcoin2:if(""!==o.culture)throw new Ne(this.notFormatString(`CultureTag ${String(o.tag)} cannot have culture`));break;case s.CultureTag.GenLower:case s.CultureTag.GenUpper:case s.CultureTag.NomLower:case s.CultureTag.Gannen:if(""===o.culture)throw new Ne(this.notFormatString(`CultureTag ${String(o.tag)} must have culture`))}}const i=u[4];return null!=i&&l(le(i)),o}if(ie.test(e)){const t=le(e);let r=65535&t;switch(r){case i.LCID.SystemLongDate:o.tag=s.CultureTag.SysDate;break;case i.LCID.SystemTime:o.tag=s.CultureTag.SysTime;break;case i.LCID.EuroTrailing:o.tag=s.CultureTag.Euro1;break;case i.LCID.EuroLeading:o.tag=s.CultureTag.Euro2;break;default:64512==(64512&r)&&(o.tag=s.CultureTag.GenLower),63488==(64512&r)&&(o.tag=s.CultureTag.GenUpper),62464==(64512&r)&&(o.tag=s.CultureTag.NomLower),void 0!==o.tag&&(r&=-63489),o.culture=(0,E.convertKnownLCID)(r)}return l(t>>16),o}}determineValueType(){const{localeInfo:e}=this.config,t={accountFill:!1,fvt:void 0};for(const e of this.parts){t.accountFill=!1;const r=this.determineValueTypeCodes(t,e.code);if(void 0!==r)return r;if(t.accountFill&&(t.fvt===s.FormatValueType.Number||t.fvt===s.FormatValueType.Currency))return s.FormatValueType.Accounting;if(void 0!==t.fvt)return t.fvt}return void 0!==t.fvt?t.fvt:this.formatString===te(e.pictureSpecial,i.PictureSpecial.General)?s.FormatValueType.General:s.FormatValueType.Custom}determineValueTypeCodes(e,t){const{localeInfo:r}=this.config;for(let n=0;n<t.length;n+=1){const a=t[n];switch(a.kind){case X.General:break;case i.PictureSingle.Text:return s.FormatValueType.Text;case i.PictureSingle.Star:e.accountFill=!0;break;case Se.Char:case X.Exp:case i.PictureSingle.Slash:case X.StrLit:case i.PictureSingle.Percent:case i.PictureSingle.Underscore:case X.Numeral:case Se.DateSep:case Se.TimeSep:break;case X.Currency:e.fvt=s.FormatValueType.Currency;break;case X.CurrCode:void 0!==a.currencySymbol&&(e.fvt=s.FormatValueType.Currency);break;case Se.Num:{e.fvt=1===a.numPercent&&0===a.numThousands?s.FormatValueType.Percentage:s.FormatValueType.Number;const t=a.codeBefore;let n,i=0;if(r.isEastAsia){if(i<t.length&&"("===fe(t[i])&&(i+=1),i<t.length&&"US$"===fe(t[i]))return s.FormatValueType.Currency;if(r.isChinaT){if(i<t.length&&"NT$"===fe(t[i]))return s.FormatValueType.Currency}else if(i<t.length&&"$"===fe(t[i]))return s.FormatValueType.Currency}if(void 0!==(n=this.determineValueTypeCodes(e,a.codeBefore.slice(i))))return n;if(void 0!==(n=this.determineValueTypeCodes(e,a.code)))return n;break}case Se.Exp:{let t;if(e.fvt=s.FormatValueType.Scientific,void 0!==(t=this.determineValueTypeCodes(e,a.codeMant)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,a.codeBetween)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,a.codeExp)))return t;break}case Se.Fraction:{let t;if(e.fvt=s.FormatValueType.Fraction,void 0!==a.codeInt&&void 0!==(t=this.determineValueTypeCodes(e,a.codeInt)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,a.codeBetween1)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,a.codeNumer)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,a.codeBetween2)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,a.codeDenom)))return t;break}case i.PictureSingle.Decimal:case i.PictureSingle.Hash:case i.PictureSingle.Zero:case i.PictureSingle.Question:case X.PrefixDigTh:case X.LatinDate:case X.BidiDate:break;case i.PictureSingle.HourTh:case i.PictureSingle.MinuteTh:case i.PictureSingle.SecondTh:case i.PictureSingle.Hour:case i.PictureSingle.Minute:case i.PictureSingle.Second:case Se.FracSeconds:return s.FormatValueType.Time;case X.AMPM:case X.AMPMFE:break;case i.PictureSingle.Era:case i.PictureSingle.EraYear:case i.PictureSingle.YearTh:case i.PictureSingle.EngYearTh:case i.PictureSingle.ThYear:case i.PictureSingle.MonthTh:case i.PictureSingle.DayTh:case i.PictureSingle.Year:case i.PictureSingle.Month:case i.PictureSingle.Day:case i.PictureSingle.LocDay:return s.FormatValueType.Date;case Se.SysFormat:return this.determineValueTypeCodes(e,a.codeThisFormat);default:return(0,o.assertNever)("calc.numfmt.NumberFormatImpl: determineValueTypeCodes code",a)}}}determineDecimals(){const e=this.parts[Ce.Pos];for(const t of e.code)switch(t.kind){case Se.Num:return t.numDigDec;case Se.Exp:return t.numMantDigDec}return 0}determineBidiDate(){const e=te(this.config.localeInfo.pictureSingle,i.PictureSingle.BidiDate);return(0,m.stringStartsWith)(this.formatString,e+"1")?s.BidiDate.English:(0,m.stringStartsWith)(this.formatString,e+"2")?s.BidiDate.Lunar:void 0}printFormatString(){const{localeInfo:e}=this.config,[t,r,n,o]=this.parts,a=!(Ee(o)||o===t),s=this.posBeforeText||!a;let l="";return s&&(l+=this.printPart(t,this.condPos),r!==t&&(l+=te(e.pictureSingle,i.PictureSingle.Sep),l+=this.printPart(r,this.condNeg),n!==t&&(l+=te(e.pictureSingle,i.PictureSingle.Sep),l+=this.printPart(n,void 0)))),a&&(s&&(l+=te(e.pictureSingle,i.PictureSingle.Sep)),l+=this.printPart(o,void 0)),l}printPart(e,t){const{mathpack:r,localeInfo:n}=this.config;let o="";var a;if(void 0!==e.color&&(o+=te(n.pictureSingle,i.PictureSingle.ColorStart)+("number"==typeof e.color?te(n.pictureColor,i.PictureColor.Color)+String(e.color-8):te(n.pictureColor,(a=e.color,i.PictureColor[a])))+te(n.pictureSingle,i.PictureSingle.ColorEnd)),void 0!==t){const e=21;o+=te(n.pictureSingle,i.PictureSingle.ColorStart)+te(Q,J[t.operator])+r.formatGeneral(n,t.operand,e)+te(n.pictureSingle,i.PictureSingle.ColorEnd)}return void 0!==e.dbnum&&(o+=te(n.pictureSingle,i.PictureSingle.ColorStart)+te(n.pictureDbnum,e.dbnum-1)+te(n.pictureSingle,i.PictureSingle.ColorEnd)),o+=this.printCodes({seenDig:!1,wasPrevDig:!1},e.code,void 0),o}printCodes(e,r,n){const{mathpack:a,localeInfo:u}=this.config;let c,d="";if(void 0!==n&&n.numThousands>0){for(let e=0;e<r.length;e+=1){const t=r[e].kind;t!==i.PictureSingle.Zero&&t!==i.PictureSingle.Hash&&t!==i.PictureSingle.Question&&t!==i.PictureSingle.Decimal&&t!==X.Numeral||(c=e)}(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: printCodes thousandsAfter",void 0!==c)}for(let g=0;g<r.length;g+=1){const p=r[g],h=e.wasPrevDig;switch(e.wasPrevDig=!1,p.kind){case X.General:d+=te(u.pictureSpecial,i.PictureSpecial.General);break;case i.PictureSingle.Decimal:void 0!==n&&(n.decimal=!0),e.wasPrevDig=!0,d+=te(u.pictureSingle,i.PictureSingle.Decimal);break;case i.PictureSingle.Hash:case i.PictureSingle.Zero:case i.PictureSingle.Question:{e.seenDig=!0,e.wasPrevDig=!0;const t=p.kind===i.PictureSingle.Zero?"0":te(u.pictureSingle,p.kind),o=(0,m.repeat)(t,p.count);if(void 0===n||n.decimal){d+=o;break}if(n.comma){const e=n.numDigLeft-p.count;d+=(0,f.insertCommas)({isThousandsPosition:t=>{var n,o;return t>0&&t%3==0&&(t>e||(o=null===(n=r[g+1])||void 0===n?void 0:n.kind)===i.PictureSingle.Hash||o===i.PictureSingle.Zero||o===i.PictureSingle.Question)},thousandsSeparator:te(u.pictureSingle,i.PictureSingle.Comma)},o,e)}else d+=o;n.numDigLeft-=p.count;break}case X.Numeral:e.wasPrevDig=!0,d+=p.formattedStr;break;case Se.Exp:d+=this.printCodes(e,p.codeMant,{comma:p.commaMant,numThousands:0,decimal:!1,numDigLeft:p.numMantDigLeft})+this.printCodes(e,p.codeBetween,void 0)+this.printCodes(e,p.codeExp,{comma:!1,numThousands:0,decimal:!1,numDigLeft:p.numExpDigLeft});break;case Se.Num:d+=this.printCodes(e,p.codeBefore,void 0)+this.printCodes(e,p.code,{comma:p.comma,numThousands:p.numThousands,decimal:!1,numDigLeft:p.numDigLeft});break;case Se.Fraction:{const t=void 0===p.codeInt?"":this.printCodes(e,p.codeInt,{comma:p.commaInt,numThousands:0,decimal:!1,numDigLeft:p.numIntDigLeft}),r=this.printCodes(e,p.codeBetween1,void 0),n=this.printCodes(e,p.codeNumer,{comma:!1,numThousands:0,decimal:!1,numDigLeft:p.numNumerDig}),i=this.printCodes(e,p.codeBetween2,void 0),o=this.printCodes(e,p.codeDenom,{comma:!1,numThousands:p.numThousands,decimal:!1,numDigLeft:p.numDenomDig});d+=t+r+n+i+(void 0!==p.denomValue?B(a,p.denomValue):o);break}case Se.Char:{const t=te(u.pictureSingle,i.PictureSingle.Backslash),n=ee(u,u.pictureSingle,p.formattedStr,0),o=re(u,u.pictureSpecial,p.formattedStr,0);if(void 0!==n&&n!==i.PictureSingle.Extra&&n!==i.PictureSingle.Zero)switch(n){case i.PictureSingle.Comma:const n=r[g+1];if(h){const e=te(u.pictureSingle,i.PictureSingle.Space);if(p.formattedStr!==e||void 0===n||(u.isCurrencySymbolLead||!u.isCurrencySepBySpace||n.kind!==X.Currency)&&(!u.isPercentSepBySpace||n.kind!==i.PictureSingle.Percent)){d+=t;break}}if((null==n?void 0:n.kind)===Se.Char&&(null==n?void 0:n.formattedStr)===p.formattedStr){d+=t;break}break;case i.PictureSingle.Decimal:d+=t;break;case i.PictureSingle.Slash:e.seenDig&&(d+=t);break;case i.PictureSingle.Space:case i.PictureSingle.Minus:case i.PictureSingle.Plus:case i.PictureSingle.OpenParen:case i.PictureSingle.CloseParen:break;case i.PictureSingle.DateSep:te(u.pictureSingle,i.PictureSingle.DateSep)!==te(u.pictureSingle,i.PictureSingle.Minus)&&(d+=t);break;default:d+=t}else(o||u.isNumeral((0,l.stringCodePointAt)(p.formattedStr,0)))&&(d+=t);d+=p.formattedStr;break}case X.Exp:d+=p.formattedStr+(p.isNeg?"-":"+");break;case X.StrLit:{const e=te(u.pictureSingle,i.PictureSingle.Quote);(0,o.assertTrue)("calc.numfmt.NumberFormatImpl: printCodes StrLit",p.escaped.indexOf(e)<0),d+=e+p.escaped+e;break}case i.PictureSingle.Slash:d+=te(u.pictureSingle,i.PictureSingle.Slash);break;case i.PictureSingle.Percent:d+=te(u.pictureSingle,i.PictureSingle.Percent);break;case i.PictureSingle.Star:d+=te(u.pictureSingle,i.PictureSingle.Star)+p.escaped;break;case i.PictureSingle.Underscore:d+=te(u.pictureSingle,i.PictureSingle.Underscore)+p.escaped;break;case X.PrefixDigTh:d+="t";break;case X.Currency:d+=te(u.pictureSpecial,i.PictureSpecial.Currency);break;case X.CurrCode:if(d+=te(u.pictureSingle,i.PictureSingle.ColorStart),d+="$",void 0!==p.currencySymbol&&(d+=p.currencySymbol),void 0!==p.currCode){const{culture:e,numberShape:r,nationalNumberInput:n,calendar:i,localCalendarInput:a,tag:l}=p.currCode;d+="-";let u=0;switch(void 0!==r&&(u|=t.pictureNumberShape.indexOf(r)<<8),n&&(u|=32768),void 0!==i&&(u|=t.pictureCalendar.indexOf(i)),a&&(u|=128),typeof e){case"number":{let t=e;switch(l){case void 0:break;case s.CultureTag.GenLower:t|=64512;break;case s.CultureTag.GenUpper:t|=63488;break;case s.CultureTag.NomLower:t|=62464;break;default:(0,o.assertFalse)("calc.numfmt.NumberFormatImpl: printCodes lcid2")}let r=se(u<<16|t);/^[a-f]{1,7}$/i.test(r)&&(r="0"+r),d+=r;break}case"string":d+=e,void 0!==l&&(""!==e&&(d+="-"),d+="x-",d+=String(l)),0!==u&&(d+=",",d+=se(u))}}d+=te(u.pictureSingle,i.PictureSingle.ColorEnd);break;case i.PictureSingle.Text:d+=te(u.pictureSingle,i.PictureSingle.Text);break;case X.LatinDate:d+=te(u.pictureSingle,i.PictureSingle.BidiDate)+"1";break;case X.BidiDate:d+=te(u.pictureSingle,i.PictureSingle.BidiDate)+"2";break;case Se.FracSeconds:d+=te(u.pictureSingle,i.PictureSingle.Decimal)+(0,m.repeat)("0",p.rounding);break;case Se.DateSep:d+=te(u.pictureSingle,i.PictureSingle.DateSep);break;case Se.TimeSep:d+=te(u.pictureSingle,i.PictureSingle.Colon);break;case i.PictureSingle.Era:case i.PictureSingle.EraYear:case i.PictureSingle.Year:case i.PictureSingle.YearTh:case i.PictureSingle.EngYearTh:case i.PictureSingle.ThYear:case i.PictureSingle.Month:case i.PictureSingle.MonthTh:case i.PictureSingle.Day:case i.PictureSingle.DayTh:case i.PictureSingle.LocDay:d+=(0,m.repeat)(te(u.pictureSingle,p.kind),p.count);break;case i.PictureSingle.Hour:case i.PictureSingle.HourTh:case i.PictureSingle.Minute:case i.PictureSingle.MinuteTh:case i.PictureSingle.Second:case i.PictureSingle.SecondTh:if(p.isAbs){d+=te(u.pictureSingle,i.PictureSingle.ColorStart)+(0,m.repeat)(te(u.pictureSingle,p.kind),p.count)+te(u.pictureSingle,i.PictureSingle.ColorEnd);break}d+=(0,m.repeat)(te(u.pictureSingle,p.kind),p.count);break;case X.AMPM:case X.AMPMFE:p.kind===X.AMPMFE||u.isEastAsia||p.pictureKind===i.PictureSpecial.AP2?d+=p.tokenStr:d+=te(u.pictureSpecial,p.pictureKind);break;case Se.SysFormat:d+=this.printCodes(e,p.codeThisFormat,void 0);break;default:return(0,o.assertNever)("calc.numfmt.NumberFormatImpl: printCodes code",p)}g===c&&(d+=(0,m.repeat)(te(u.pictureSingle,i.PictureSingle.Comma),n.numThousands))}return d}countBytecodeBuffer(e){var t,r;const{mathpack:n,localeInfo:a}=this.config;let s=0;for(let l=0;l<e.length;l+=1){const u=e[l];let c=1;switch(u.kind){case i.PictureSingle.Percent:case X.Numeral:case Se.Char:case i.PictureSingle.Star:case i.PictureSingle.Underscore:c+=2;break;case X.StrLit:c+=1+2*u.escaped.length;break;case Se.FracSeconds:case i.PictureSingle.Hash:case i.PictureSingle.Zero:case i.PictureSingle.Question:case X.Exp:c+=1;break;case i.PictureSingle.Hour:case i.PictureSingle.HourTh:case i.PictureSingle.Minute:case i.PictureSingle.MinuteTh:case i.PictureSingle.Second:case i.PictureSingle.SecondTh:u.isAbs&&(c+=1);break;case Se.Fraction:c+=5,void 0!==u.codeInt&&(c+=this.countBytecodeBuffer(u.codeInt)),c+=this.countBytecodeBuffer(u.codeBetween1),c+=this.countBytecodeBuffer(u.codeNumer),c+=this.countBytecodeBuffer(u.codeBetween2),c+=this.countBytecodeBuffer(u.codeDenom),void 0!==u.denomValue&&(c-=2,c+=2+2*B(n,u.denomValue).length),u.commaInt&&(c+=1);break;case Se.Exp:c+=3,c+=this.countBytecodeBuffer(u.codeMant),c+=this.countBytecodeBuffer(u.codeBetween),c+=this.countBytecodeBuffer(u.codeExp),u.commaMant&&(c+=1);break;case Se.Num:c+=3,c+=this.countBytecodeBuffer(u.codeBefore),c+=this.countBytecodeBuffer(u.code),u.comma&&(c+=1);break;case Se.SysFormat:c=0,c+=this.countBytecodeBuffer(u.codeThisFormat);break;case X.CurrCode:c+=2*((null!==(r=null===(t=u.currencySymbol)||void 0===t?void 0:t.length)&&void 0!==r?r:0)+1),c+=8;break;case X.AMPM:{const e=a.isEastAsia||u.pictureKind===i.PictureSpecial.AP2?ne(a,u.tokenStr):a.ampmSymbols;c+=2+2*(e[0].length+e[1].length)}break;case X.AMPMFE:case X.General:case i.PictureSingle.Decimal:case i.PictureSingle.Slash:case X.PrefixDigTh:case X.Currency:case i.PictureSingle.Text:case X.LatinDate:case X.BidiDate:case Se.DateSep:case Se.TimeSep:case i.PictureSingle.Era:case i.PictureSingle.EraYear:case i.PictureSingle.Year:case i.PictureSingle.YearTh:case i.PictureSingle.EngYearTh:case i.PictureSingle.ThYear:case i.PictureSingle.Month:case i.PictureSingle.MonthTh:case i.PictureSingle.Day:case i.PictureSingle.DayTh:case i.PictureSingle.LocDay:break;default:return(0,o.assertNever)("calc.numfmt.NumberFormatImpl: printCodes code",u)}s+=c}return s}countBytecodePart({code:e,color:t,dbnum:r,dtrRounding:n}){let i=0;return void 0!==t&&(i+=2),void 0!==r&&(i+=2),0!==n&&(i+=2),i+=this.countBytecodeBuffer(e),i}countBytecode(){let e=0;for(let t=Ce.Pos;t<=Ce.Text;t+=1){(t===Ce.Pos&&void 0!==this.condPos||t===Ce.Neg&&void 0!==this.condNeg)&&(e+=10);const r=this.parts[t];let n=!1;for(let e=Ce.Pos;e<t;e+=1)if(this.parts[e]===r){n=!0;break}n||(e+=this.countBytecodePart(r))}return e}checkBytecode(){if(this.countBytecode()>255)throw new Ne(this.notFormatString("format string too long: bytecode limit"));if(this.countBytecode()>247)throw new Ne((0,a.notImplemented)(["format string too long: close to bytecode limit"]))}getBundledLocaleInfo(e,t,r){let n=r;switch(t){case v.Calendar.GregorianUS:n=ue;break;case v.Calendar.GregorianMEFrench:n=ce;break;case v.Calendar.GregorianArabic:n=de;break;case v.Calendar.GregorianXlitEnglish:n=me;break;case v.Calendar.GregorianXlitFrench:n=ge;break;case v.Calendar.UmAlQura:case v.Calendar.Hijri:break;case v.Calendar.Thai:n=pe}if(void 0!==(null==n?void 0:n.culture)&&""!==n.culture){const t=(0,E.getBundledLocaleInfo)(n);if(void 0===t)throw new Pe(this.notImplementedCulture(e,n.culture));return t}return this.config.localeInfo}notFormatString(e){return(0,s.notFormatString)(`${e} (source=${String(this.source)}): ${this.logFormatString}`)}notImplementedCulture(e,t){const r="number"==typeof t?`lcid:${se(t)}`:`lang:${t}`;return(0,a.notImplemented)([`${e}: culture = ${r}`])}constructor(e,t){this.config=e,this.hasPercent=!1,this.hasDate=!1,this.hasTime=!1,this.posBeforeText=!0,this.onlyOneNumberPart=!0,this.parts=[void 0,void 0,void 0,void 0],this.hasTokenCurrCode=!1,void 0===t.old?(this.logFormatString=(0,b.anonymizeFormulaString)(t.formatString),this.source=t.source,this.parseString(t.formatString)):(this.hasPercent=t.old.hasPercent,this.hasDate=t.old.hasDate,this.hasTime=t.old.hasTime,this.posBeforeText=t.old.posBeforeText,this.onlyOneNumberPart=t.old.onlyOneNumberPart,this.parts=t.synth,this.hasTokenCurrCode=t.old.hasTokenCurrCode,this.thisCurrCode=t.old.thisCurrCode,this.thisCurrencySymbol=t.old.thisCurrencySymbol,this.applyCurrCode=t.old.applyCurrCode,this.condPos=t.old.condPos,this.condNeg=t.old.condNeg,this.logFormatString=t.logFormatString,this.source=s.NumberFormatSource.CustomString,this.checkBytecode()),this.formatString=this.printFormatString(),this.valueType=this.determineValueType(),this.decimals=this.determineDecimals(),this.bidiDate=this.determineBidiDate()}}t.NumberFormatImpl=Ae,t.createFormat=function(e,t,r){try{return(0,R.success)(new Ae(e.config,{old:void 0,formatString:t,source:r}))}catch(e){return e instanceof Ne?(0,R.failure)(e.reason):(0,R.failure)((0,R.javaScriptError)(e))}},t.applyFormat=function(e,t,r,n){try{let i,o,c;const{localeInfo:d}=e.config;switch(r.kind){case C.OperKind.String:i=function(e){if(0===e.length)return!1;const t=(0,l.stringCodePointAt)(e,0);return t>=1424&&t<=1535||8207===t||t>=64285&&t<=64335||t>=1536&&t<=1791||t>=1872&&t<=1919||t>=2208&&t<=2303||t>=64336&&t<=65023||t>=65136&&t<=65279}(r.value)?s.Alignment.Right:s.Alignment.Left,o=s.Clip.None,c=r;break;case C.OperKind.Number:i=t.isTextOnly?s.Alignment.Left:s.Alignment.Right,o=s.Clip.All,c=r;break;case C.OperKind.Boolean:i=s.Alignment.Center,o=s.Clip.All,c=(0,u.stringOper)(r.value?d.trueName:d.falseName);break;case C.OperKind.Blank:return(0,R.success)((0,s.formattedValue)([],void 0,s.Alignment.Left,s.Clip.All));case C.OperKind.Error:const e=d.errorNames[r.type];return null==e?(0,R.failure)((0,a.internal)(`No locale data for error type ${r.type}`)):(0,R.success)((0,s.formattedValue)([(0,s.formattedUnitString)(e)],void 0,s.Alignment.Center,s.Clip.All));case C.OperKind.Array:return(0,R.failure)((0,a.notImplemented)(["Array applyFormat"]));case C.OperKind.Rich:return(0,R.failure)((0,a.notImplemented)(["Rich applyFormat"]))}return t.apply(c,i,o,n)}catch(e){return(0,R.failure)((0,R.javaScriptError)(e))}},t.changeFormatDecimals=function(e,t){try{switch(e.valueType){case s.FormatValueType.General:return(0,R.failure)((0,a.notImplemented)(["changeDecimals General"]));case s.FormatValueType.Number:case s.FormatValueType.Currency:case s.FormatValueType.Accounting:case s.FormatValueType.Percentage:case s.FormatValueType.Scientific:if(0===e.decimals&&t<0)return R.successUndefined;const r=(0,p.fastMax)(0,e.decimals+t),n=e.synthesizeDecimals(r);return n.formatString===e.formatString?R.successUndefined:(0,R.success)(n);default:return R.successUndefined}}catch(e){return(0,R.failure)((0,R.javaScriptError)(e))}}},40535:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.util=t.unicode=t.testData=t.serviceTypes=t.ribbonFormat=t.render=t.parsedate=t.parseconst=t.parse=t.localeData=t.knownFormat=t.impl=t.formulaBar=t.formatService=t.eval=t.edit=t.PackageName=void 0;const n=r(19181);t.PackageName="excel-online-calc-numfmt",t.edit=n.__importStar(r(35759)),t.eval=n.__importStar(r(21893)),t.formatService=n.__importStar(r(89765)),t.formulaBar=n.__importStar(r(51956)),t.impl=n.__importStar(r(22637)),t.knownFormat=n.__importStar(r(71571)),t.localeData=n.__importStar(r(45105)),t.parse=n.__importStar(r(33520)),t.parseconst=n.__importStar(r(58049)),t.parsedate=n.__importStar(r(11620)),t.render=n.__importStar(r(46627)),t.ribbonFormat=n.__importStar(r(244)),t.serviceTypes=n.__importStar(r(56331)),t.testData=n.__importStar(r(89831)),t.unicode=n.__importStar(r(43260)),t.util=n.__importStar(r(91895))},71571:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.englishXLSXKnownFormat=t.isKnownFormatDefined=t.getKnownFormat=t.buildNumShapeDateTimeFormat=t.buildNumShapeConstFormat=t.buildMMDDYYFormat=t.buildSingle=t.buildCurrencyFormat=t.buildFractionFormat=t.buildQuoted=t.buildScientificFormat=t.buildPercentFormat=t.buildNumberFormat=t.getColor=t.getSingle=t.getSpecial=void 0;const n=r(96705),i=r(96705),o=r(31748),a=r(31748),s=r(43260),l=r(63224),u=r(78421),c=r(22637),d=r(4810);function m(e,t){var r;const n=null!==(r=e.pictureSpecial[t])&&void 0!==r?r:o.englishPictureSpecial[t];return(0,l.assertTrue)("calc.numfmt.knownFormat: getSpecial",void 0!==n),n}function g(e,t){var r;const n=null!==(r=e.pictureSingle[t])&&void 0!==r?r:o.englishPictureSingle[t];return(0,l.assertTrue)("calc.numfmt.knownFormat: getSingle",void 0!==n),n}function p(e,t){var r;const n=null!==(r=e.pictureColor[t])&&void 0!==r?r:o.englishPictureColor[t];return(0,l.assertTrue)("calc.numfmt.knownFormat: getColor",void 0!==n),n}function h(e,t,r,n){let i="";if(r>1){const n=(0,u.repeat)(g(e,o.PictureSingle.Hash),r-1);i+=t?(0,s.insertCommas)({isThousandsPosition:e=>e>0&&e%3==0,thousandsSeparator:g(e,o.PictureSingle.Comma)},n,1):n}return i+="0",n>0&&(i+=g(e,o.PictureSingle.Decimal),i+=(0,u.repeat)("0",n)),i}function f(e,t){let r="";return r+="0",t>0&&(r+=g(e,o.PictureSingle.Decimal),r+=(0,u.repeat)("0",t)),e.isPercentSepBySpace&&(r+=g(e,o.PictureSingle.Space)),r+=g(e,o.PictureSingle.Percent),r}function S(e,t,r,n){let i="";return i+=h(e,!1,t,r),e.isExpSepBySpace&&(i+=g(e,o.PictureSingle.Space)),i+=g(e,o.PictureSingle.E),i+="+",i+=(0,u.repeat)("0",n),i}function v(e,t){const r=g(e,o.PictureSingle.Quote);return r+t+r}function y(e,t){let r="";r+=g(e,o.PictureSingle.Hash);const n=e.fractionSeparator;return n===g(e,o.PictureSingle.Comma)?r+=v(e,n):r+=" "===n?g(e,o.PictureSingle.Space):v(e,n),r+=(0,u.repeat)(g(e,o.PictureSingle.Question),t),r+=g(e,o.PictureSingle.Slash),r+=(0,u.repeat)(g(e,o.PictureSingle.Question),t),r}var F,C;function R(e,t){let r="";return r+=v(e,"-"),t>0&&(r+=(0,u.repeat)(g(e,o.PictureSingle.Question),t)),r}function b(e,t,r,n,a,s,l=!1){const{isCurrencySymbolLead:u,currencyFormat:c,isCurrencySepBySpace:d}=e,f=l?F.Pos:a?F.Text:F.Neg,S=h(e,!0,4,r);let v="";for(let l=F.Pos;l<=f;l+=1){l!==F.Pos&&(v+=g(e,o.PictureSingle.Sep)),l===F.Neg&&t&&(v+=g(e,o.PictureSingle.ColorStart)+p(e,o.PictureColor.Red)+g(e,o.PictureSingle.ColorEnd));const h=()=>l===F.Zero?R(e,r):l===F.Text?g(e,o.PictureSingle.Text):S,f=()=>l!==F.Text?E(e,o.PictureSingle.Star,o.PictureSingle.Space):"",y=()=>{let t="";if(u)switch(c){case i.CurrencyFormat.Paren:t+=E(e,o.PictureSingle.Underscore,o.PictureSingle.OpenParen);break;case i.CurrencyFormat.Trail:t+=E(e,o.PictureSingle.Underscore,o.PictureSingle.Minus);break;case i.CurrencyFormat.Intern:t+=E(e,o.PictureSingle.Underscore,o.PictureSingle.Space)}else{switch(c){case i.CurrencyFormat.Trail:t+=E(e,o.PictureSingle.Underscore,o.PictureSingle.Minus);break;case i.CurrencyFormat.Paren:case i.CurrencyFormat.Intern:t+=E(e,o.PictureSingle.Underscore,o.PictureSingle.Space)}c!==i.CurrencyFormat.Lead&&(t+=f())}return t},C=()=>{if(u)switch(c){case i.CurrencyFormat.Lead:return E(e,o.PictureSingle.Underscore,o.PictureSingle.Minus);case i.CurrencyFormat.Intern:return E(e,o.PictureSingle.Underscore,o.PictureSingle.Space)}else switch(c){case i.CurrencyFormat.Lead:return E(e,o.PictureSingle.Underscore,o.PictureSingle.Minus);case i.CurrencyFormat.Paren:case i.CurrencyFormat.Intern:return E(e,o.PictureSingle.Underscore,o.PictureSingle.Space)}return""},b=()=>l===F.Neg?g(e,o.PictureSingle.OpenParen):"",T=()=>l!==F.Text||u?l===F.Neg?g(e,o.PictureSingle.CloseParen):E(e,o.PictureSingle.Underscore,o.PictureSingle.CloseParen):"",k=()=>{let t="";if(l!==F.Neg)switch(c){case i.CurrencyFormat.Intern:u||l===F.Text||(t+=E(e,o.PictureSingle.Underscore,o.PictureSingle.Minus));break;case i.CurrencyFormat.Lead:case i.CurrencyFormat.Trail:if(c===i.CurrencyFormat.Lead&&!a)break;t+=E(e,o.PictureSingle.Underscore,o.PictureSingle.Minus)}else t+=g(e,o.PictureSingle.Minus);return a&&!u&&c===i.CurrencyFormat.Lead&&(t+=f()),t},P=()=>{let t="";return n&&!u&&d&&(t+=g(e,o.PictureSingle.Space)),n&&(t+=null!=s?s:m(e,o.PictureSpecial.Currency)),u&&d&&(t+=g(e,o.PictureSingle.Space)),t},N=()=>{let e="";return l!==F.Text&&(u?(n&&(e+=P()),a&&(e+=f())):e+=P()),e};if(a&&(v+=y()),u)switch(c){case i.CurrencyFormat.Paren:a||(v+=b()),v+=N(),a&&(v+=b()),v+=h(),v+=T();break;case i.CurrencyFormat.Lead:v+=k(),v+=N(),v+=h();break;case i.CurrencyFormat.Intern:v+=N(),v+=k(),v+=h();break;case i.CurrencyFormat.Trail:v+=N(),v+=h(),v+=k()}else switch(c){case i.CurrencyFormat.Paren:v+=b(),v+=h(),a&&(v+=T()),v+=N(),a||(v+=T());break;case i.CurrencyFormat.Lead:v+=k(),v+=h(),v+=N();break;case i.CurrencyFormat.Intern:v+=h(),v+=k(),v+=N();break;case i.CurrencyFormat.Trail:v+=h(),v+=N(),v+=k()}a&&(v+=C())}return v}function E(e,...t){return t.map((t=>"string"==typeof t?t:g(e,t))).join("")}t.getSpecial=m,t.getSingle=g,t.getColor=p,t.buildNumberFormat=h,t.buildPercentFormat=f,t.buildScientificFormat=S,t.buildQuoted=v,t.buildFractionFormat=y,function(e){e[e.Pos=0]="Pos",e[e.Neg=1]="Neg",e[e.Zero=2]="Zero",e[e.Text=3]="Text"}(F||(F={})),t.buildCurrencyFormat=b,t.buildSingle=E,function(e){e[e.Day=0]="Day",e[e.Month=1]="Month",e[e.Year=2]="Year"}(C||(C={}));const T={[i.DateOrder.MDY]:[C.Month,C.Day,C.Year],[i.DateOrder.DMY]:[C.Day,C.Month,C.Year],[i.DateOrder.YMD]:[C.Year,C.Month,C.Day],[i.DateOrder.MYD]:[C.Month,C.Year,C.Day],[i.DateOrder.DYM]:[C.Day,C.Year,C.Month],[i.DateOrder.YDM]:[C.Year,C.Day,C.Month]};function k(e,t){return E(e,(t?e.hour2Digits&&!e.clock24Hour:e.hour2Digits)?o.PictureSingle.Hour:"",o.PictureSingle.Hour,o.PictureSingle.Colon,o.PictureSingle.Minute,o.PictureSingle.Minute)}function P(e,t){return k(e,t)+E(e,o.PictureSingle.Colon,o.PictureSingle.Second,o.PictureSingle.Second)}function N(e){let t="";return e.isAMPMSepBySpace&&(t+=g(e,o.PictureSingle.Space)),t+=m(e,o.PictureSpecial.AP1),t}function A(e,t,r,n,i=e.year4Digits){const{month2Digits:a,day2Digits:s}=e,l=[(0,u.repeat)(t,s?2:1),(0,u.repeat)(r,a?2:1),(0,u.repeat)(n,i?4:2)],c=T[e.dateOrder];let d="";for(let t=0;t<3;t+=1)d+=l[c[t]],t<2&&(d+=g(e,o.PictureSingle.DateSep));return d}function I(e,t){const r=g(e,o.PictureSingle.Year),n=g(e,o.PictureSingle.Month);return A(e,g(e,o.PictureSingle.Day),n,r,t)}function O(e,t,r,n=o.PictureSingle.Day,i=o.PictureSingle.Month,a=o.PictureSingle.Year){const{day2Digits:s}=e,l=e.country===o.Country.GER,u="/"===e.dateSeparator&&" "!==e.dateAltSeparator;let c="";return t&&(c+=E(e,s?n:"",n),u?c+=e.dateAltSeparator:(c+=g(e,o.PictureSingle.DateSep),l&&(c+=g(e,o.PictureSingle.Space)))),c+=E(e,i,i,i),r&&(c+=u?e.dateAltSeparator:g(e,l?o.PictureSingle.Space:o.PictureSingle.DateSep),c+=E(e,a,a)),c}function _(e){return E(e,e.hour2Digits?o.PictureSingle.HourTh:"",o.PictureSingle.HourTh,o.PictureSingle.Colon,o.PictureSingle.MinuteTh,o.PictureSingle.MinuteTh)}function M(e){return A(e,g(e,o.PictureSingle.DayTh),g(e,o.PictureSingle.MonthTh),g(e,o.PictureSingle.YearTh))}function D(e,t,r){return O(e,t,r,o.PictureSingle.DayTh,o.PictureSingle.MonthTh,o.PictureSingle.YearTh)}function w(e,t){switch(t){case i.KnownFormat.General:return m(e,o.PictureSpecial.General);case i.KnownFormat.NoComFixed0:return h(e,!1,1,0);case i.KnownFormat.NoComFixed:return h(e,!1,1,2);case i.KnownFormat.Fixed0:return h(e,!0,4,0);case i.KnownFormat.Fixed:return h(e,!0,4,2);case i.KnownFormat.Currency:return b(e,!1,0,!0,!1);case i.KnownFormat.CoCurrency:return b(e,!0,0,!0,!1);case i.KnownFormat.CurrencyDec:return b(e,!1,2,!0,!1);case i.KnownFormat.CoCurrencyDec:return b(e,!0,2,!0,!1);case i.KnownFormat.Pct0:return f(e,0);case i.KnownFormat.Pct:return f(e,2);case i.KnownFormat.Exp:return S(e,1,2,2);case i.KnownFormat.Fract:return y(e,1);case i.KnownFormat.FractBond:return y(e,2);case i.KnownFormat.MMDDYY:return I(e);case i.KnownFormat.DDMMMYY:return O(e,!0,!0);case i.KnownFormat.DDMMM:return O(e,!0,!1);case i.KnownFormat.MMMYY:return O(e,!1,!0);case i.KnownFormat.HHMMAP:return k(e,!0)+N(e);case i.KnownFormat.HHMMSSAP:return P(e,!0)+N(e);case i.KnownFormat.HHMM:return k(e,!1);case i.KnownFormat.HHMMSS:return P(e,!1);case i.KnownFormat.MDYHMS:return E(e,I(e),o.PictureSingle.Space,k(e,!1));case i.KnownFormat.USCoCurrency:case i.KnownFormat.USCoCurrencyDec:return b(Object.assign(Object.assign({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:i.CurrencyFormat.Paren}),!0,t===i.KnownFormat.USCoCurrencyDec?2:0,!0,!1,e.isChinaT?v(e,"US$"):"$");case i.KnownFormat.Currency2:return b(e,!1,0,!1,!1);case i.KnownFormat.CoCurrency2:return b(e,!0,0,!1,!1);case i.KnownFormat.CurrencyDec2:return b(e,!1,2,!1,!1);case i.KnownFormat.CoCurrencyDec2:return b(e,!0,2,!1,!1);case i.KnownFormat.Acct:return b(e,!1,0,!1,!0);case i.KnownFormat.AcctDec:return b(e,!1,2,!1,!0);case i.KnownFormat.AcctCur:return b(e,!1,0,!0,!0);case i.KnownFormat.AcctDecCur:return b(e,!1,2,!0,!0);case i.KnownFormat.MMSS:return E(e,o.PictureSingle.Minute,o.PictureSingle.Minute,o.PictureSingle.Colon,o.PictureSingle.Second,o.PictureSingle.Second);case i.KnownFormat.AbsHMMSS:return E(e,o.PictureSingle.ColorStart,o.PictureSingle.Hour,o.PictureSingle.ColorEnd,o.PictureSingle.Colon,o.PictureSingle.Minute,o.PictureSingle.Minute,o.PictureSingle.Colon,o.PictureSingle.Second,o.PictureSingle.Second);case i.KnownFormat.SS0:return E(e,o.PictureSingle.Minute,o.PictureSingle.Minute,o.PictureSingle.Colon,o.PictureSingle.Second,o.PictureSingle.Second,o.PictureSingle.Decimal,"0");case i.KnownFormat.Eng:return S(e,3,1,1);case i.KnownFormat.Text:return g(e,o.PictureSingle.Text);case i.KnownFormat.NoComFixed0_Tha:return"t"+h(e,!1,1,0);case i.KnownFormat.NoComFixed_Tha:return"t"+h(e,!1,1,2);case i.KnownFormat.Fixed0_Tha:return"t"+h(e,!0,4,0);case i.KnownFormat.Fixed_Tha:return"t"+h(e,!0,4,2);case i.KnownFormat.CoCurrency_Tha:case i.KnownFormat.CoCurrencyDec_Tha:return b(Object.assign(Object.assign({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:i.CurrencyFormat.Paren}),!0,t===i.KnownFormat.CoCurrencyDec_Tha?2:0,!0,!1,"t"+m(e,o.PictureSpecial.Currency));case i.KnownFormat.Pct0_Tha:return"t"+f(e,0);case i.KnownFormat.Pct_Tha:return"t"+f(e,2);case i.KnownFormat.MMDDYY_Tha:return M(e);case i.KnownFormat.DDMMMYY_Tha:return D(e,!0,!0);case i.KnownFormat.DDMMM_Tha:return D(e,!0,!1);case i.KnownFormat.MMMYY_Tha:return D(e,!1,!0);case i.KnownFormat.HHMM_Tha:return _(e);case i.KnownFormat.HHMMSS_Tha:return function(e){return _(e)+E(e,o.PictureSingle.Colon,o.PictureSingle.SecondTh,o.PictureSingle.SecondTh)}(e);case i.KnownFormat.MDYHMS_Tha:return E(e,M(e),o.PictureSingle.Space,_(e));case i.KnownFormat.AbsHMMSS_Tha:return E(e,o.PictureSingle.ColorStart,o.PictureSingle.HourTh,o.PictureSingle.ColorEnd,o.PictureSingle.Colon,o.PictureSingle.MinuteTh,o.PictureSingle.MinuteTh,o.PictureSingle.Colon,o.PictureSingle.SecondTh,o.PictureSingle.SecondTh);case i.KnownFormat.MMSS_Tha:return E(e,o.PictureSingle.MinuteTh,o.PictureSingle.MinuteTh,o.PictureSingle.Colon,o.PictureSingle.SecondTh,o.PictureSingle.SecondTh);case i.KnownFormat.SS0_Tha:return E(e,o.PictureSingle.MinuteTh,o.PictureSingle.MinuteTh,o.PictureSingle.Colon,o.PictureSingle.SecondTh,o.PictureSingle.SecondTh,o.PictureSingle.Decimal,"0");case i.KnownFormat.DMBB_Tha:return A(e,g(e,o.PictureSingle.Day),g(e,o.PictureSingle.Month),g(e,o.PictureSingle.EngYearTh),!1);default:return(0,l.assertNever)("calc.numfmt.getKnownFormat",t)}}t.buildMMDDYYFormat=I,t.buildNumShapeConstFormat=function(e,t,r,s,m,p,S,v){const y=c.pictureNumberShape.indexOf(r)<<24|function(e){switch(e){case n.NumberShape.ArabicIndic:case n.NumberShape.ExtendedArabicIndic:return a.LCID.Arabic;case n.NumberShape.Devanagari:return a.LCID.Hindi;case n.NumberShape.Bengali:return 1093;case n.NumberShape.Gurmukhi:return 1094;case n.NumberShape.Gujarati:return 1095;case n.NumberShape.Oriya:return 1096;case n.NumberShape.Tamil:return a.LCID.Tamil;case n.NumberShape.Telugu:return 1098;case n.NumberShape.Kannada:return 1099;case n.NumberShape.Malayalam:return 1100;case n.NumberShape.Thai:return a.LCID.Thailand;case n.NumberShape.Lao:return 1108;case n.NumberShape.Tibetan:return 1105;case n.NumberShape.Myanmar:return 1109;case n.NumberShape.Ethiopic:return 1118;case n.NumberShape.Khmer:return 1107;case n.NumberShape.Mongolian:return 1104;case n.NumberShape.ASCII:case n.NumberShape.ChineseTrad1:case n.NumberShape.ChineseTrad2:case n.NumberShape.ChineseTrad3:case n.NumberShape.ChineseSimp1:case n.NumberShape.ChineseSimp2:case n.NumberShape.ChineseSimp3:case n.NumberShape.Japanese1:case n.NumberShape.Japanese2:case n.NumberShape.Japanese3:case n.NumberShape.Korean1:case n.NumberShape.Korean2:case n.NumberShape.Korean3:case n.NumberShape.Korean4:return 0;default:return(0,l.assertNever)("calc.numfmt.lcidFromNumShape",e)}}(r);let F=S;if((s||m)&&(F=2),F=(0,d.fastMin)(F,14),s){const t=E(e,o.PictureSingle.ColorStart,"$"+e.currencySymbol+"-"+y.toString(16).toUpperCase(),o.PictureSingle.ColorEnd);return b(Object.assign(Object.assign({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:i.CurrencyFormat.Paren}),!0,2,!0,!1,t).replace(t,(()=>t+g(e,o.PictureSingle.Space)))}const C=E(e,o.PictureSingle.ColorStart,"$-"+y.toString(16).toUpperCase(),o.PictureSingle.ColorEnd);if(m)return C+f(Object.assign(Object.assign({},e),{isPercentSepBySpace:!1}),2);if(p)return C+h(e,!0,4,F);const R=t.formatGeneral(e,v,11),T=R.indexOf("E");if(T>=0){const t=R.substring(0,T),r=t.indexOf(e.decimalSeparator)>=0,n=t.replace(e.decimalSeparator,"").length,i=R.substring(T+2).length;return C+E(e,"0",F>0&&!r?"":o.PictureSingle.Decimal,(0,u.repeat)(g(e,o.PictureSingle.Hash),n-1),o.PictureSingle.E,F>0?"-":"+",(0,u.repeat)("0",i))}return C+E(e,"0",F>0?o.PictureSingle.Decimal:"",(0,u.repeat)(g(e,o.PictureSingle.Hash),F))},t.buildNumShapeDateTimeFormat=function(e,t,r){return E(e,o.PictureSingle.ColorStart,"$-"+(c.pictureNumberShape.indexOf(t)<<24).toString(16).toUpperCase(),o.PictureSingle.ColorEnd)+w(e,r)},t.getKnownFormat=w,t.isKnownFormatDefined=function(e,t){return e<=i.KnownFormat.General&&e>=i.KnownFormat.AcctDec||(e<=-1e3&&e>=-1099?t.isEastAsia:e<=-1100&&e>=-1199?t.isJapan:e<=-1200&&e>=-1299?t.isKorea:e<=-1300&&e>=-1399?t.isChinaT:e<=-1400&&e>=-1499?t.isChinaS:e<=-2e3&&e>=-2099?t.isThai:(0,l.assertFalse)("calc.numfmt.isKnownFormatDefined"))},t.englishXLSXKnownFormat={0:i.KnownFormat.General,1:i.KnownFormat.NoComFixed0,2:i.KnownFormat.NoComFixed,3:i.KnownFormat.Fixed0,4:i.KnownFormat.Fixed,5:i.KnownFormat.Currency,6:i.KnownFormat.CoCurrency,7:i.KnownFormat.CurrencyDec,8:i.KnownFormat.CoCurrencyDec,9:i.KnownFormat.Pct0,10:i.KnownFormat.Pct,11:i.KnownFormat.Exp,12:i.KnownFormat.Fract,13:i.KnownFormat.FractBond,14:i.KnownFormat.MMDDYY,15:i.KnownFormat.DDMMMYY,16:i.KnownFormat.DDMMM,17:i.KnownFormat.MMMYY,18:i.KnownFormat.HHMMAP,19:i.KnownFormat.HHMMSSAP,20:i.KnownFormat.HHMM,21:i.KnownFormat.HHMMSS,22:i.KnownFormat.MDYHMS,37:i.KnownFormat.Currency2,38:i.KnownFormat.CoCurrency2,39:i.KnownFormat.CurrencyDec2,40:i.KnownFormat.CoCurrencyDec2,41:i.KnownFormat.Acct,42:i.KnownFormat.AcctCur,43:i.KnownFormat.AcctDec,44:i.KnownFormat.AcctDecCur,45:i.KnownFormat.MMSS,46:i.KnownFormat.AbsHMMSS,47:i.KnownFormat.SS0,48:i.KnownFormat.Eng,49:i.KnownFormat.Text}},31748:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ulsLogger=t.operatorIdToName=t.localeInfo=t.isNumeral=t.getOrdinal=t.getNumberShape=t.getEnglishWorksheetFuncIdToName=t.getEnglishLocaleInfo=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishSpecialRefNames=t.englishPictureSpecial=t.englishPictureSingle=t.englishPictureDbnum=t.englishPictureColor=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishErrorNames=t.createWorksheetFuncNameCallbacks=t.calcConfig=t.TraceLevel=t.PictureSpecial=t.PictureSingle=t.PictureDbnum=t.PictureColor=t.NulLogger=t.LogCategory=t.LCID=t.Country=void 0;const n=r(81836);t.Country=n.config.Country,t.LCID=n.config.LCID,t.LogCategory=n.config.LogCategory,t.NulLogger=n.config.NulLogger,t.PictureColor=n.config.PictureColor,t.PictureDbnum=n.config.PictureDbnum,t.PictureSingle=n.config.PictureSingle,t.PictureSpecial=n.config.PictureSpecial,t.TraceLevel=n.config.TraceLevel,t.calcConfig=n.config.calcConfig,t.createWorksheetFuncNameCallbacks=n.config.createWorksheetFuncNameCallbacks,t.englishErrorNames=n.config.englishErrorNames,t.englishErrorTypeToName=n.config.englishErrorTypeToName,t.englishOperatorIdToName=n.config.englishOperatorIdToName,t.englishPictureColor=n.config.englishPictureColor,t.englishPictureDbnum=n.config.englishPictureDbnum,t.englishPictureSingle=n.config.englishPictureSingle,t.englishPictureSpecial=n.config.englishPictureSpecial,t.englishSpecialRefNames=n.config.englishSpecialRefNames,t.englishSysDateFormat=n.config.englishSysDateFormat,t.englishSysTimeFormat=n.config.englishSysTimeFormat,t.englishWorksheetFuncIdToName=n.config.englishWorksheetFuncIdToName,t.getEnglishLocaleInfo=n.config.getEnglishLocaleInfo,t.getEnglishWorksheetFuncIdToName=n.config.getEnglishWorksheetFuncIdToName,t.getNumberShape=n.config.getNumberShape,t.getOrdinal=n.config.getOrdinal,t.isNumeral=n.config.isNumeral,t.localeInfo=n.config.localeInfo,t.operatorIdToName=n.config.operatorIdToName,t.ulsLogger=n.config.ulsLogger},41539:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.tzUTC=t.tzData=t.dateTime=t.TimeGranularity=t.TimeDivision=t.Rounding=void 0;const n=r(81836);t.Rounding=n.datepack.Rounding,t.TimeDivision=n.datepack.TimeDivision,t.TimeGranularity=n.datepack.TimeGranularity,t.dateTime=n.datepack.dateTime,t.tzData=n.datepack.tzData,t.tzUTC=n.datepack.tzUTC,t.xlDatepack=n.datepack.xlDatepack},88510:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.operatorNode=t.nameNode=t.missingRef=t.localNameUseAnnotation=t.localNameDeclAnnotation=t.literalNode=t.letVar=t.letNode=t.lambdaParam=t.lambdaNode=t.indexedArg=t.identQualifier=t.identNamePart=t.headNamePart=t.formulaSpan=t.formulaRootAnnotation=t.formula=t.flattenNameParts=t.flattenLetArgs=t.flattenLambdaArgs=t.fieldRefNode=t.fieldRefNamePart=t.fieldRef=t.errorQualifier=t.documentQualifier=t.commaOpRef=t.columnRef=t.cellRefSingle=t.cellRefRow=t.cellRefRange=t.cellRefNode=t.cellRefNamePart=t.cellRefError=t.cellRefCol=t.cellRefBad=t.badRef=t.badQualifier=t.arrayNode=t.appNode=t.appHeadNameAnnotation=t.StructRefKind=t.SpecialRefId=t.RefStyle=t.QualifierKind=t.PosKind=t.NodeKind=t.NamePartKind=t.CellRefKind=t.BadType=t.AnnotationKind=void 0,t.getDepthUpperBound=t.wsfNode=t.thisRowOpRef=t.structRefNode=t.structRef=t.specialRef=t.sheetRangeQualifier=t.sheetQualifier=t.relativeQualifier=t.rangeOpRef=t.pos=t.parenNode=t.paramNode=t.paramName=t.paramDefault=void 0;const n=r(81836);t.AnnotationKind=n.formulaModule.AnnotationKind,t.BadType=n.formulaModule.BadType,t.CellRefKind=n.formulaModule.CellRefKind,t.NamePartKind=n.formulaModule.NamePartKind,t.NodeKind=n.formulaModule.NodeKind,t.PosKind=n.formulaModule.PosKind,t.QualifierKind=n.formulaModule.QualifierKind,t.RefStyle=n.formulaModule.RefStyle,t.SpecialRefId=n.formulaModule.SpecialRefId,t.StructRefKind=n.formulaModule.StructRefKind,t.appHeadNameAnnotation=n.formulaModule.appHeadNameAnnotation,t.appNode=n.formulaModule.appNode,t.arrayNode=n.formulaModule.arrayNode,t.badQualifier=n.formulaModule.badQualifier,t.badRef=n.formulaModule.badRef,t.cellRefBad=n.formulaModule.cellRefBad,t.cellRefCol=n.formulaModule.cellRefCol,t.cellRefError=n.formulaModule.cellRefError,t.cellRefNamePart=n.formulaModule.cellRefNamePart,t.cellRefNode=n.formulaModule.cellRefNode,t.cellRefRange=n.formulaModule.cellRefRange,t.cellRefRow=n.formulaModule.cellRefRow,t.cellRefSingle=n.formulaModule.cellRefSingle,t.columnRef=n.formulaModule.columnRef,t.commaOpRef=n.formulaModule.commaOpRef,t.documentQualifier=n.formulaModule.documentQualifier,t.errorQualifier=n.formulaModule.errorQualifier,t.fieldRef=n.formulaModule.fieldRef,t.fieldRefNamePart=n.formulaModule.fieldRefNamePart,t.fieldRefNode=n.formulaModule.fieldRefNode,t.flattenLambdaArgs=n.formulaModule.flattenLambdaArgs,t.flattenLetArgs=n.formulaModule.flattenLetArgs,t.flattenNameParts=n.formulaModule.flattenNameParts,t.formula=n.formulaModule.formula,t.formulaRootAnnotation=n.formulaModule.formulaRootAnnotation,t.formulaSpan=n.formulaModule.formulaSpan,t.headNamePart=n.formulaModule.headNamePart,t.identNamePart=n.formulaModule.identNamePart,t.identQualifier=n.formulaModule.identQualifier,t.indexedArg=n.formulaModule.indexedArg,t.lambdaNode=n.formulaModule.lambdaNode,t.lambdaParam=n.formulaModule.lambdaParam,t.letNode=n.formulaModule.letNode,t.letVar=n.formulaModule.letVar,t.literalNode=n.formulaModule.literalNode,t.localNameDeclAnnotation=n.formulaModule.localNameDeclAnnotation,t.localNameUseAnnotation=n.formulaModule.localNameUseAnnotation,t.missingRef=n.formulaModule.missingRef,t.nameNode=n.formulaModule.nameNode,t.operatorNode=n.formulaModule.operatorNode,t.paramDefault=n.formulaModule.paramDefault,t.paramName=n.formulaModule.paramName,t.paramNode=n.formulaModule.paramNode,t.parenNode=n.formulaModule.parenNode,t.pos=n.formulaModule.pos,t.rangeOpRef=n.formulaModule.rangeOpRef,t.relativeQualifier=n.formulaModule.relativeQualifier,t.sheetQualifier=n.formulaModule.sheetQualifier,t.sheetRangeQualifier=n.formulaModule.sheetRangeQualifier,t.specialRef=n.formulaModule.specialRef,t.structRef=n.formulaModule.structRef,t.structRefNode=n.formulaModule.structRefNode,t.thisRowOpRef=n.formulaModule.thisRowOpRef,t.wsfNode=n.formulaModule.wsfNode,t.getDepthUpperBound=n.formulaModule.getDepthUpperBound},11632:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseUint=t.parseSignedLiteral=t.parseNumberLiteral=t.isSpace=void 0;const n=r(81836);t.isSpace=n.literalParse.isSpace,t.parseNumberLiteral=n.literalParse.parseNumberLiteral,t.parseSignedLiteral=n.literalParse.parseSignedLiteral,t.parseUint=n.literalParse.parseUint},38333:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.numberComponents=t.formatScientificLeft=void 0;const n=r(81836);t.formatScientificLeft=n.mathpack.formatScientificLeft,t.numberComponents=n.mathpack.numberComponents},96705:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumberShape=t.KnownFormat=t.DateOrder=t.CurrencyFormat=t.Calendar=void 0;const n=r(81836);t.Calendar=n.numfmt.Calendar,t.CurrencyFormat=n.numfmt.CurrencyFormat,t.DateOrder=n.numfmt.DateOrder,t.KnownFormat=n.numfmt.KnownFormat,t.NumberShape=n.numfmt.NumberShape},60545:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveGridRef=t.createResolver=void 0;const n=r(81836);t.createResolver=n.resolveService.createResolver,t.resolveGridRef=n.resolveService.resolveGridRef},69572:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedUserDefinedFunc=t.resolvedStructRef=t.resolvedNever=t.resolvedName=t.resolvedLocalName=t.resolvedDottedName=t.resolvedCellRef=t.resolveLocalsGrid=t.noOriginSheet=t.invalidStructRef=t.invalidQualifier=t.invalidCellRef=t.emptyIntersection=t.ResolvedKind=t.ResolveReasonKind=t.InvalidStructRefReason=t.InvalidQualifierReason=t.InvalidCellRefReason=void 0;const n=r(81836);t.InvalidCellRefReason=n.resolveServiceTypes.InvalidCellRefReason,t.InvalidQualifierReason=n.resolveServiceTypes.InvalidQualifierReason,t.InvalidStructRefReason=n.resolveServiceTypes.InvalidStructRefReason,t.ResolveReasonKind=n.resolveServiceTypes.ResolveReasonKind,t.ResolvedKind=n.resolveServiceTypes.ResolvedKind,t.emptyIntersection=n.resolveServiceTypes.emptyIntersection,t.invalidCellRef=n.resolveServiceTypes.invalidCellRef,t.invalidQualifier=n.resolveServiceTypes.invalidQualifier,t.invalidStructRef=n.resolveServiceTypes.invalidStructRef,t.noOriginSheet=n.resolveServiceTypes.noOriginSheet,t.resolveLocalsGrid=n.resolveServiceTypes.resolveLocalsGrid,t.resolvedCellRef=n.resolveServiceTypes.resolvedCellRef,t.resolvedDottedName=n.resolveServiceTypes.resolvedDottedName,t.resolvedLocalName=n.resolveServiceTypes.resolvedLocalName,t.resolvedName=n.resolveServiceTypes.resolvedName,t.resolvedNever=n.resolveServiceTypes.resolvedNever,t.resolvedStructRef=n.resolveServiceTypes.resolvedStructRef,t.resolvedUserDefinedFunc=n.resolveServiceTypes.resolvedUserDefinedFunc},3342:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unknownFunctionType=t.operatorStrings=t.higherOrderFunctionType=t.getWorksheetFuncType=t.getWorksheetFuncEnglishName=t.getOperatorType=t.WorksheetFuncId=t.OperatorId=void 0;const n=r(81836);t.OperatorId=n.signature.OperatorId,t.WorksheetFuncId=n.signature.WorksheetFuncId,t.getOperatorType=n.signature.getOperatorType,t.getWorksheetFuncEnglishName=n.signature.getWorksheetFuncEnglishName,t.getWorksheetFuncType=n.signature.getWorksheetFuncType,t.higherOrderFunctionType=n.signature.higherOrderFunctionType,t.operatorStrings=n.signature.operatorStrings,t.unknownFunctionType=n.signature.unknownFunctionType},82949:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.SpecialPrecs=t.SignatureType=t.OperKind=t.FunctionFlags=void 0;const n=r(81836);t.FunctionFlags=n.types.FunctionFlags,t.OperKind=n.types.OperKind,t.SignatureType=n.types.SignatureType,t.SpecialPrecs=n.types.SpecialPrecs,t.functionType=n.types.functionType},50026:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridRangeEqual=t.isSheetGridRange=t.isSheetGridCellEqual=t.isSheetGridCell=t.isRichOper=t.isReadOperEqual=t.isRangeOper=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isPrimitiveOper=t.isOperatorNode=t.isNumberOper=t.isNumberLiteralNode=t.isNameScopeEqual=t.isMissingOper=t.isMissingNode=t.isGridRangeEqual=t.isGridCellEqual=t.isGridCell=t.isErrorOper=t.isDocumentLocEqual=t.isCommaOpRefWellFormed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isBooleanOper=t.isBooleanLiteralNode=t.isBlankOper=t.isArrayOper=t.internal=t.gridRangesJoin=t.gridRangeSize=t.gridRangeJoinOpt=t.gridRangeJoin=t.gridRangeIsects=t.gridRangeIsect=t.gridRangeExcept=t.gridRangeCompare=t.gridRangeAnchor=t.gridCellRange=t.gridCellImplicitIsect=t.getWorksheetFuncId=t.getUserDefinedFuncName=t.getBoundName=t.getArguments=t.getArgType=t.forEachTileInRange=t.forEachCellInRange=t.createFailureErrorClass=t.ReasonKind=t.LangReasonKind=void 0,t.applyComparison=t.unavailable=t.shouldFieldRefBeBracketed=t.sheetGridRangeAnchor=t.notImplemented=t.normalizeCommaOpRef=t.isWriteOper=t.isWellFormed=t.isWSFNode=t.isValidArgsLength=t.isUnqualifiedNameNode=t.isStringOper=t.isSheetIndexEqual=t.isSheetIndex=void 0;const n=r(81836);t.LangReasonKind=n.util.LangReasonKind,t.ReasonKind=n.util.ReasonKind,t.createFailureErrorClass=n.util.createFailureErrorClass,t.forEachCellInRange=n.util.forEachCellInRange,t.forEachTileInRange=n.util.forEachTileInRange,t.getArgType=n.util.getArgType,t.getArguments=n.util.getArguments,t.getBoundName=n.util.getBoundName,t.getUserDefinedFuncName=n.util.getUserDefinedFuncName,t.getWorksheetFuncId=n.util.getWorksheetFuncId,t.gridCellImplicitIsect=n.util.gridCellImplicitIsect,t.gridCellRange=n.util.gridCellRange,t.gridRangeAnchor=n.util.gridRangeAnchor,t.gridRangeCompare=n.util.gridRangeCompare,t.gridRangeExcept=n.util.gridRangeExcept,t.gridRangeIsect=n.util.gridRangeIsect,t.gridRangeIsects=n.util.gridRangeIsects,t.gridRangeJoin=n.util.gridRangeJoin,t.gridRangeJoinOpt=n.util.gridRangeJoinOpt,t.gridRangeSize=n.util.gridRangeSize,t.gridRangesJoin=n.util.gridRangesJoin,t.internal=n.util.internal,t.isArrayOper=n.util.isArrayOper,t.isBlankOper=n.util.isBlankOper,t.isBooleanLiteralNode=n.util.isBooleanLiteralNode,t.isBooleanOper=n.util.isBooleanOper,t.isCommaOpClosed=n.util.isCommaOpClosed,t.isCommaOpNoBadOrMissing=n.util.isCommaOpNoBadOrMissing,t.isCommaOpRefWellFormed=n.util.isCommaOpRefWellFormed,t.isDocumentLocEqual=n.util.isDocumentLocEqual,t.isErrorOper=n.util.isErrorOper,t.isGridCell=n.util.isGridCell,t.isGridCellEqual=n.util.isGridCellEqual,t.isGridRangeEqual=n.util.isGridRangeEqual,t.isMissingNode=n.util.isMissingNode,t.isMissingOper=n.util.isMissingOper,t.isNameScopeEqual=n.util.isNameScopeEqual,t.isNumberLiteralNode=n.util.isNumberLiteralNode,t.isNumberOper=n.util.isNumberOper,t.isOperatorNode=n.util.isOperatorNode,t.isPrimitiveOper=n.util.isPrimitiveOper,t.isRangeOpClosed=n.util.isRangeOpClosed,t.isRangeOpNoMissing=n.util.isRangeOpNoMissing,t.isRangeOper=n.util.isRangeOper,t.isReadOperEqual=n.util.isReadOperEqual,t.isRichOper=n.util.isRichOper,t.isSheetGridCell=n.util.isSheetGridCell,t.isSheetGridCellEqual=n.util.isSheetGridCellEqual,t.isSheetGridRange=n.util.isSheetGridRange,t.isSheetGridRangeEqual=n.util.isSheetGridRangeEqual,t.isSheetIndex=n.util.isSheetIndex,t.isSheetIndexEqual=n.util.isSheetIndexEqual,t.isStringOper=n.util.isStringOper,t.isUnqualifiedNameNode=n.util.isUnqualifiedNameNode,t.isValidArgsLength=n.util.isValidArgsLength,t.isWSFNode=n.util.isWSFNode,t.isWellFormed=n.util.isWellFormed,t.isWriteOper=n.util.isWriteOper,t.normalizeCommaOpRef=n.util.normalizeCommaOpRef,t.notImplemented=n.util.notImplemented,t.sheetGridRangeAnchor=n.util.sheetGridRangeAnchor,t.shouldFieldRefBeBracketed=n.util.shouldFieldRefBeBracketed,t.unavailable=n.util.unavailable,t.applyComparison=n.util.applyComparison},33957:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valueErrorOper=t.trueOper=t.stringOper=t.refErrorOper=t.rangeSeqOper=t.range3DOper=t.precedents=t.numErrorOper=t.nullErrorOper=t.nameErrorOper=t.naErrorOper=t.missingOper=t.gettingDataErrorOper=t.spillErrorOper=t.fieldErrorOper=t.falseOper=t.errorOper=t.div0ErrorOper=t.cellStringLimit=t.booleanOper=t.blankOper=t.arrayOper=t.PrecsBound=t.ErrorType=void 0;const n=r(81836);t.ErrorType=n.value.ErrorType,t.PrecsBound=n.value.PrecsBound,t.arrayOper=n.value.arrayOper,t.blankOper=n.value.blankOper,t.booleanOper=n.value.booleanOper,t.cellStringLimit=n.value.cellStringLimit,t.div0ErrorOper=n.value.div0ErrorOper,t.errorOper=n.value.errorOper,t.falseOper=n.value.falseOper,t.fieldErrorOper=n.value.fieldErrorOper,t.spillErrorOper=n.value.spillErrorOper,t.gettingDataErrorOper=n.value.gettingDataErrorOper,t.missingOper=n.value.missingOper,t.naErrorOper=n.value.naErrorOper,t.nameErrorOper=n.value.nameErrorOper,t.nullErrorOper=n.value.nullErrorOper,t.numErrorOper=n.value.numErrorOper,t.precedents=n.value.precedents,t.range3DOper=n.value.range3DOper,t.rangeSeqOper=n.value.rangeSeqOper,t.refErrorOper=n.value.refErrorOper,t.stringOper=n.value.stringOper,t.trueOper=n.value.trueOper,t.valueErrorOper=n.value.valueErrorOper},89946:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zipVisitor=t.voidVisitor=t.visitWSFNode=t.visitQualifier=t.visitOperatorNode=t.visitFormulaNode=t.visitCellRef=t.visitAppHeadNode=t.reduceTopDown_Pledge=t.reducePledge=t.reduceBottomUp_Recursive=t.reduceBottomUp_Pledge=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_CPS=t.reduceBottomUp=t.identityVisitor=t.depthVisitor=t.constVisitor=t.composeVisitor=t.bindVisitor=t.binaryVisitor=t.ZipVisitor=t.PledgeReducer=t.IdentityVisitor=t.DelegatingVisitor=t.ConstVisitor=t.ComposeVisitor=t.BinaryVisitor=void 0;const n=r(81836);t.BinaryVisitor=n.visitor.BinaryVisitor,t.ComposeVisitor=n.visitor.ComposeVisitor,t.ConstVisitor=n.visitor.ConstVisitor,t.DelegatingVisitor=n.visitor.DelegatingVisitor,t.IdentityVisitor=n.visitor.IdentityVisitor,t.PledgeReducer=n.visitor.PledgeReducer,t.ZipVisitor=n.visitor.ZipVisitor,t.binaryVisitor=n.visitor.binaryVisitor,t.bindVisitor=n.visitor.bindVisitor,t.composeVisitor=n.visitor.composeVisitor,t.constVisitor=n.visitor.constVisitor,t.depthVisitor=n.visitor.depthVisitor,t.identityVisitor=n.visitor.identityVisitor,t.reduceBottomUp=n.visitor.reduceBottomUp,t.reduceBottomUp_CPS=n.visitor.reduceBottomUp_CPS,t.reduceBottomUp_MaxDepth=n.visitor.reduceBottomUp_MaxDepth,t.reduceBottomUp_Pledge=n.visitor.reduceBottomUp_Pledge,t.reduceBottomUp_Recursive=n.visitor.reduceBottomUp_Recursive,t.reducePledge=n.visitor.reducePledge,t.reduceTopDown_Pledge=n.visitor.reduceTopDown_Pledge,t.visitAppHeadNode=n.visitor.visitAppHeadNode,t.visitCellRef=n.visitor.visitCellRef,t.visitFormulaNode=n.visitor.visitFormulaNode,t.visitOperatorNode=n.visitor.visitOperatorNode,t.visitQualifier=n.visitor.visitQualifier,t.visitWSFNode=n.visitor.visitWSFNode,t.voidVisitor=n.visitor.voidVisitor,t.zipVisitor=n.visitor.zipVisitor},45105:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertKnownLCID=t.getBundledLocaleInfo=void 0;const n=r(31748),i=r(63224),o={ar:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],["",""],"z"],en:[["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["AM","PM"],"z"],es:[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","set","oct.","nov.","dic."],["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],["do.","lu.","ma.","mi.","ju.","vi.","s."],["domingo","lunes","martes","mircoles","jueves","viernes","sbado"],["a. m.","p. m."],"z"],fr:[["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."],["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],"en","z"],zh:[["1","2","3","4","5","6","7","8","9","10","11","12"],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],["",""],"s"],de:[["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],["So","Mo","Di","Mi","Do","Fr","Sa"],["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],"en","z"],hr:[["sij","vlj","ou","tra","svi","lip","srp","kol","ruj","lis","stu","pro"],["sijeanj","veljaa","oujak","travanj","svibanj","lipanj","srpanj","kolovoz","rujan","listopad","studeni","prosinac"],["ned","pon","uto","sri","et","pet","sub"],["nedjelja","ponedjeljak","utorak","srijeda","etvrtak","petak","subota"],"en","z"],nl:[["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"],["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],["zo","ma","di","wo","do","vr","za"],["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],"en","z"],sv:[["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],["sn","mn","tis","ons","tor","fre","lr"],["sndag","mndag","tisdag","onsdag","torsdag","fredag","lrdag"],"en","z"],it:[["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],["dom","lun","mar","mer","gio","ven","sab"],["domenica","luned","marted","mercoled","gioved","venerd","sabato"],"en","z"],ro:[["ian.","feb.","mar.","apr.","mai","iun.","iul.","aug.","sept.","oct.","nov.","dec."],["ianuarie","februarie","martie","aprilie","mai","iunie","iulie","august","septembrie","octombrie","noiembrie","decembrie"],["dum.","lun.","mar.","mie.","joi","vin.","sm."],["duminic","luni","mari","miercuri","joi","vineri","smbt"],["a.m.","p.m."],"z"],ru:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],"en","z"],sr:[["jan","feb","mar","apr","maj","jun","jul","avg","sep","okt","nov","dec"],["januar","februar","mart","april","maj","jun","jul","avgust","septembar","oktobar","novembar","decembar"],["ned","pon","uto","sre","et","pet","sub"],["nedelja","ponedeljak","utorak","sreda","etvrtak","petak","subota"],["pre podne","po podne"],"z"],uk:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","'",""],"en","z"],bg:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],"en","z"],cs:[["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"],["leden","nor","bezen","duben","kvten","erven","ervenec","srpen","z","jen","listopad","prosinec"],["ne","po","t","st","t","p","so"],["nedle","pondl","ter","steda","tvrtek","ptek","sobota"],["dop.","odp."],"z"],da:["sv",["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"],["s","ma","ti","on","to","fr","l"],["sndag","mandag","tirsdag","onsdag","torsdag","fredag","lrdag"],"sv","z"],el:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],["",""],"z"],et:[["jaan","veebr","mrts","apr","mai","juuni","juuli","aug","sept","okt","nov","dets"],["jaanuar","veebruar","mrts","aprill","mai","juuni","juuli","august","september","oktoober","november","detsember"],["P","E","T","K","N","R","L"],["phapev","esmaspev","teisipev","kolmapev","neljapev","reede","laupev"],"en","z"],fi:[["tammi","helmi","maalis","huhti","touko","kes","hein","elo","syys","loka","marras","joulu"],["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","keskuu","heinkuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],["su","ma","ti","ke","to","pe","la"],["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai"],["ap.","ip."],"z"],he:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],"en","z"],hu:[["jan.","febr.","mrc.","pr.","mj.","jn.","jl.","aug.","szept.","okt.","nov.","dec."],["janur","februr","mrcius","prilis","mjus","jnius","jlius","augusztus","szeptember","oktber","november","december"],["V","H","K","Sze","Cs","P","Szo"],["vasrnap","htf","kedd","szerda","cstrtk","pntek","szombat"],["de.","du."],"z"],id:[["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],["Mgg","Sen","Sel","Rab","Kam","Jum","Sab"],["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],"en","z"],ja:[["1","2","3","4","5","6","7","8","9","10","11","12"],["1","2","3","4","5","6","7","8","9","10","11","12"],["","","","","","",""],["","","","","","",""],["",""],"j"],ko:["ja",["1","2","3","4","5","6","7","8","9","10","11","12"],["","","","","","",""],["","","","","","",""],["",""],"k"],lt:[["saus.","vas.","kov.","bal.","geg.","bir.","liep.","rugp.","rugs.","spal.","lapkr.","gruod."],["sausis","vasaris","kovas","balandis","gegu","birelis","liepa","rugpjtis","rugsjis","spalis","lapkritis","gruodis"],["sk","pr","an","tr","kt","pn","t"],["sekmadienis","pirmadienis","antradienis","treiadienis","ketvirtadienis","penktadienis","etadienis"],["priepiet","popiet"],"z"],lv:[["janv.","febr.","marts","apr.","maijs","jn.","jl.","aug.","sept.","okt.","nov.","dec."],["janvris","februris","marts","aprlis","maijs","jnijs","jlijs","augusts","septembris","oktobris","novembris","decembris"],["svtd.","pirmd.","otrd.","tred.","ceturtd.","piektd.","sestd."],["svtdiena","pirmdiena","otrdiena","trediena","ceturtdiena","piektdiena","sestdiena"],["priekp.","pcp."],"z"],nb:[["jan","feb","mar","apr","mai","jun","jul","aug","sep","okt","nov","des"],["januar","februar","mars","april","mai","juni","juli","august","september","oktober","november","desember"],["sn","man","tir","ons","tor","fre","lr"],"da","ro","z"],pl:[["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","pa","lis","gru"],["stycze","luty","marzec","kwiecie","maj","czerwiec","lipiec","sierpie","wrzesie","padziernik","listopad","grudzie"],["niedz.","pon.","wt.","r.","czw.","pt.","sob."],["niedziela","poniedziaek","wtorek","roda","czwartek","pitek","sobota"],"en","z"],pt:[["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],["dom","seg","ter","qua","qui","sex","sb"],["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"],"en","z"],sk:["ja",["janur","februr","marec","aprl","mj","jn","jl","august","september","oktber","november","december"],["ne","po","ut","st","t","pi","so"],["nedea","pondelok","utorok","streda","tvrtok","piatok","sobota"],"en","z"],sl:[["jan.","feb.","mar.","apr.","maj","jun.","jul.","avg.","sep.","okt.","nov.","dec."],["januar","februar","marec","april","maj","junij","julij","avgust","september","oktober","november","december"],["ned.","pon.","tor.","sre.","et.","pet.","sob."],["nedelja","ponedeljek","torek","sreda","etrtek","petek","sobota"],["dop.","pop."],"z"],th:[["..","..","..","..","..","..","..","..","..","..","..",".."],["","","","","","","","","","","",""],[".",".",".",".",".",".","."],["","","","","","",""],"en","z"],tr:[["Oca","ub","Mar","Nis","May","Haz","Tem","Au","Eyl","Eki","Kas","Ara"],["Ocak","ubat","Mart","Nisan","Mays","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"],["Paz","Pzt","Sal","ar","Per","Cum","Cmt"],["Pazar","Pazartesi","Sal","aramba","Perembe","Cuma","Cumartesi"],["","S"],"z"],vi:[["Thg1","Thg2","Thg3","Thg4","Thg5","Thg6","Thg7","Thg8","Thg9","Thg10","Thg11","Thg12"],["Thang Ging","Thang Hai","Thang Ba","Thang T","Thang Nm","Thang Sau","Thang Bay","Thang Tam","Thang Chin","Thang Mi","Thang Mi Mt","Thang Mi Hai"],["CN","T2","T3","T4","T5","T6","T7"],["Chu Nht","Th Hai","Th Ba","Th T","Th Nm","Th Sau","Th Bay"],["SA","CH"],"z"],ta:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],["",""],"z"],syr:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],[".","."],"z"],eu:[["urt.","ots.","mar.","api.","mai.","eka.","uzt.","abu.","ira.","urr.","aza.","abe."],["urtarrila","otsaila","martxoa","apirila","maiatza","ekaina","uztaila","abuztua","iraila","urria","azaroa","abendua"],["ig.","al.","ar.","az.","og.","or.","lr."],["igandea","astelehena","asteartea","asteazkena","osteguna","ostirala","larunbata"],"en","z"],be:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],"en","z"],dv:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],["",""],"z"],hi:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],[".",".",".",".",".",".","."],["","","","","","",""],["",""],"z"],fil:[["Ene","Peb","Mar","Abr","May","Hun","Hul","Ago","Set","Okt","Nob","Dis"],["Enero","Pebrero","Marso","Abril","Mayo","Hunyo","Hulyo","Agosto","Setyembre","Oktubre","Nobyembre","Disyembre"],["Lin","Lun","Mar","Miy","Huw","Biy","Sab"],["Linggo","Lunes","Martes","Miyerkules","Huwebes","Biyernes","Sabado"],"en","z"],ms:[["Jan","Feb","Mac","Apr","Mei","Jun","Jul","Ogo","Sep","Okt","Nov","Dis"],["Januari","Februari","Mac","April","Mei","Jun","Julai","Ogos","September","Oktober","November","Disember"],["Ahd","Isn","Sel","Rab","Kha","Jum","Sab"],["Ahad","Isnin","Selasa","Rabu","Khamis","Jumaat","Sabtu"],["PG","PTG"],"z"],"ar-SA":"ar","ar-IQ":[["","","","","","","","","","","",""],["","","","","","","","","","","",""],"ar","ar","ar","z"],"ar-DZ":"ar","ar-EG":"ar","en-US":"en","en-AU":"en","en-BZ":"en","en-CA":"en","en-029":"en","en-HK":"en","en-IN":"en","en-ID":"en","en-IE":"en","en-JM":"en","en-MY":"en","en-NZ":"en","en-PH":"en","en-SG":"en","en-ZA":"en","en-TT":"en","en-GB":"en","en-ZW":"en","en-AS":"en","en-KE":"en","en-KW":"en","en-NL":"en","en-CH":"en","en-001":"en","en-VU":"en","en-MX":"en","en-IO":"en","en-IL":"en","en-PK":"en","en-NG":"en","en-UK":"en","es-ES":[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sep.","oct.","nov.","dic."],"es","es","es","en","z"],"es-AR":["es-ES","es",["dom.","lun.","mar.","mi.","jue.","vie.","sb."],"es",["a.m.","p.m."],"z"],"es-BO":["es-ES","es","es-AR","es","es-AR","z"],"es-CL":[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],"es","es-AR","es","es-AR","z"],"es-CO":["es-ES","es","es-AR","es","es-AR","z"],"es-CR":["es-ES","es","es-AR","es","es-AR","z"],"es-DO":["es-ES","es","es-AR","es","es-AR","z"],"es-EC":["es-ES","es","es-AR","es","es-AR","z"],"es-SV":["es-ES","es","es-AR","es","es-AR","z"],"es-GT":["es-ES","es","es-AR","es","es-AR","z"],"es-HN":["es-ES","es","es-AR","es","es-AR","z"],"es-419":["es-ES","es","es-AR","es","ro","z"],"es-MX":["es-ES","es","es-AR","es","es","z"],"es-NI":["es-ES","es","es-AR","es","es-AR","z"],"es-PA":["es-ES","es","es-AR","es","es-AR","z"],"es-PY":["es-CL","es","es-AR","es","es-CL","z"],"es-PE":[["Ene.","Feb.","Mar.","Abr.","May.","Jun.","Jul.","Ago.","Set.","Oct.","Nov.","Dic."],["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Setiembre","Octubre","Noviembre","Diciembre"],"es-AR","es","es-AR","z"],"es-PR":["es-ES","es","es-AR","es","es-AR","z"],"es-ES_tradnl":["es-ES","es","es","es","es-ES","z"],"es-US":[["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],"es",["dom","lun","mar","mi","jue","vie","sb"],"es","en","z"],"es-UY":["es","es-PE","es-AR","es","es-AR","z"],"es-VE":["es-CL","es","es-AR","es","es-CL","z"],"es-CU":["es-ES","es","es-AR","es","ro","z"],"fr-FR":"fr","fr-BE":"fr","fr-CM":["fr","fr","fr","fr",["mat.","soir"],"z"],"fr-CA":"fr","fr-029":"fr","fr-CD":"fr","fr-CI":"fr","fr-HT":"fr","fr-LU":"fr","fr-ML":"fr","fr-MC":"fr","fr-MA":[["jan.","fv.","mar.","avr.","mai","jui.","juil.","aot","sept.","oct.","nov.","dc."],"fr","fr","fr","en","z"],"fr-RE":"fr","fr-SN":"fr","fr-CH":"fr","zh-CN":["zh","zh",["","","","","","",""],"zh","zh","s"],"zh-SG":[["","","","","","","","","","","",""],"zh","zh-CN","zh","zh","s"],"zh-HK":["zh-SG","zh","zh","zh","zh-SG","t"],"zh-MO":["zh-SG","zh","zh","zh","zh-SG","t"],"zh-TW":["zh-SG","zh","zh","zh","zh-SG","t"],"de-DE":"de","de-AT":[["Jn","Feb","Mr","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["Jnner","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],"de","en","z"],"de-LI":[["Jan","Feb","Mr","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],"de","de-AT","de","en","z"],"de-LU":["de-LI","de","de-AT","de","de-LI","z"],"de-CH":["de-LI","de","de-AT","de","de-LI","z"],"hr-HR":"hr","hr-BA":[["sij","velj","ou","tra","svi","lip","srp","kol","ruj","lis","stu","pro"],"hr","hr","hr","en","z"],"nl-NL":"nl","nl-BE":"nl","sv-SE":"sv","sv-FI":[["jan.","feb.","mars","apr.","maj","juni","juli","aug.","sep.","okt.","nov.","dec."],"sv","sv","sv",["fm","em"],"z"],"it-IT":"it","it-CH":"it","ro-RO":"ro","ro-MD":["ro","ro",["Du","Lu","Mar","Mie","Jo","Vi","S"],"ro","ro","z"],"ru-RU":"ru","ru-MD-x-genlower":[[".",".","",".","","","",".",".",".",".","."],["","","","","","","","","","","",""],"ru","ru","en","z"],"sr-Latn-RS":"sr","sr-Latn-BA":[["jan","feb","mart","apr","maj","jun","jul","avg","sept","okt","nov","dec"],"sr","hr","hr",["prije podne","po podne"],"z"],"sr-Latn-CS":[["jan.","feb.","mart","apr.","maj","jun","jul","avg.","sept.","okt.","nov.","dec."],"sr",["ned.","pon.","uto.","sre.","et.","pet.","sub."],"sr","en","z"],"uk-UA-x-genlower":["uk",["","","","","","","","","","","",""],"uk","uk","uk","z"],"uk-UA":"uk","bg-BG":"bg","cs-CZ":"cs","da-DK":["sv","da","da","da","sv","z"],"el-GR":"el","et-EE":"et","fi-FI":"fi","he-IL":"he","hu-HU":"hu","id-ID":"id","ja-JP":"ja","ko-KR":["ja","ko","ko","ko","ko","k"],"lt-LT":"lt","lv-LV":"lv","nb-NO":["nb","nb","nb","da","nb","z"],"pl-PL":"pl","pt-BR":"pt","pt-PT":"pt","sk-SK":["ja","sk","sk","sk","en","z"],"sl-SI":"sl","th-TH":"th","tr-TR":"tr","vi-VN":"vi","ta-IN":"ta","syr-SY":"syr","eu-ES":"eu","be-BY-x-genlower":["be",["","","","","","","","","","","",""],"be","be","be","z"],"be-BY":"be","dv-MV":"dv","hi-IN":"hi","fil-PH":"fil","ms-MY":"ms"};let a;t.getBundledLocaleInfo=function({culture:e,tag:t}){if("number"==typeof e)return;let r=e;return void 0!==t&&(""!==e&&(r+="-"),r+="x-"+String(t)),void 0===a&&(a=function(){const e={},t=["monthNameShort","monthNameLong","dayNameShort","dayNameLong","ampmSymbols"];for(const r of Object.keys(o)){const n=o[r];if("string"==typeof n){const t=e[n];(0,i.assertTrue)("calc.numfmt.buildBundledLocaleData: ref prior culture",void 0!==t),e[r]=t;continue}const[a,s,l,u,c]=n.slice(0,5).map(((r,n)=>{if("string"==typeof r){const o=e[r];return(0,i.assertTrue)("calc.numfmt.buildBundledLocaleData: ref prior culture 2",void 0!==o),o[t[n]]}return r})),d=n[5],m="k"===d,g="j"===d,p="t"===d,h="s"===d,f=m||g||p||h;e[r]={monthNameShort:a,monthNameLong:s,dayNameShort:l,dayNameLong:u,ampmSymbols:c,isEastAsia:f,isKorea:m,isJapan:g,isChinaT:p,isChinaS:h}}return e}()),a[r]};const s={[n.LCID.USA]:"en-US",[n.LCID.Greek]:"el-GR",[n.LCID.Hungarian]:"hu-HU",[n.LCID.Turkish]:"tr-TR",[n.LCID.Thailand]:"th-TH",[n.LCID.Vietnam]:"vi-VN",[n.LCID.Arabic]:"ar-SA",[n.LCID.Hebrew]:"he-IL",[n.LCID.Tamil]:"ta-IN",[n.LCID.Syriac]:"syr-SY",[n.LCID.Iraq]:"ar-IQ",[n.LCID.Algerian]:"ar-DZ",[n.LCID.Basque]:"eu-ES",[n.LCID.PortBrazil]:"pt-BR",[n.LCID.Croatian]:"hr-HR",[n.LCID.Czech]:"cs-CZ",[n.LCID.Danish]:"da-DK",[n.LCID.Dutch]:"nl-NL",[n.LCID.Australian]:"en-AU",[n.LCID.CanadianEnglish]:"en-CA",[n.LCID.British]:"en-GB",[n.LCID.Finnish]:"fi-FI",[n.LCID.French]:"fr-FR",[n.LCID.FrenchCanadian]:"fr-CA",[n.LCID.Italian]:"it-IT",[n.LCID.NorskBokmal]:"nb-NO",[n.LCID.NorskNynorsk]:"nn-NO",[n.LCID.Polish]:"pl-PL",[n.LCID.PortIberian]:"pt-PT",[n.LCID.Romanian]:"ro-RO",[n.LCID.Russian]:"ru-RU",[n.LCID.Ukrainian]:"uk-UA",[n.LCID.Belarusian]:"be-BY",[n.LCID.SerbianCyrillic]:"sr-Cyrl-CS",[n.LCID.SerbianLatin]:"sr-Latn-CS",[n.LCID.Slovak]:"sk-SK",[n.LCID.Slovenian]:"sl-SI",[n.LCID.SpanishModern]:"es-ES",[n.LCID.Swedish]:"sv-SE",[n.LCID.HongKong]:"zh-HK",[n.LCID.ChinaT]:"zh-TW",[n.LCID.Korea]:"ko-KR",[n.LCID.Japan]:"ja-JP",[n.LCID.China]:"zh-CN",[n.LCID.Devihi]:"dv-MV",[n.LCID.Hindi]:"hi-IN",[n.LCID.German]:"de-DE",[n.LCID.Swiss]:"fr-CH",[n.LCID.Indonesia]:"id-ID",[n.LCID.EnglishIndonesia]:"en-ID",[n.LCID.EnglishIndia]:"en-IN",[n.LCID.Singapore]:"zh-SG",[n.LCID.EnglishSingapore]:"en-SG",[n.LCID.Serbia]:"sr-RS",[n.LCID.Mexico]:"es-MX",[n.LCID.Ireland]:"en-IE",[n.LCID.EnglishZimbabwe]:"en-ZW",[n.LCID.Belgium]:"nl-BE"};t.convertKnownLCID=function(e){var t;return"string"==typeof e?e:null!==(t=s[e])&&void 0!==t?t:e}},33520:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseDate=t.parseGeneral=void 0;const n=r(58049),i=r(11620),o=r(84516);t.parseGeneral=function(e,t,r,a,s){try{const{localeInfo:l,mathpack:u}=e.config,c=(0,n.parseConstInternal)(l,u,t,r,a,!1);return(0,o.isSuccess)(c)?void 0!==c.value?c:(0,i.parseDateInternal)((0,i.initParseDateGlobals)(e),t,void 0,s):c}catch(e){return(0,o.failure)((0,o.javaScriptError)(e))}},t.parseDate=function(e,t,r){try{return(0,i.parseDateInternal)((0,i.initParseDateGlobals)(e),t,void 0,r)}catch(e){return(0,o.failure)((0,o.javaScriptError)(e))}}},58049:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseConstInternal=void 0;const n=r(19181),i=r(11632),o=r(96705),a=r(71571),s=n.__importStar(r(8600)),l=r(84516),{codePointDollarSign:u,codePointBackslash:c,codePointPercentSign:d,codePointSpace:m,codePointLeftParen:g,codePointMinusSign:p,codePointPlusSign:h,codePointRightParen:f}=s;var S,v;function y(e,t,r,n){if(" "===t||""===t)return;const i="$"===t;if(e.isEastAsia){if(n<r.length&&r.charCodeAt(n)===u&&!i)return{currency:S.DollarUS,i:n+1};if(n+2<r.length&&0===e.stringCompareCI(r.substring(n,n+3),"US$"))return{currency:e.isChinaT?S.DollarUS:S.DollarExtra,i:n+3};if((""===t&&e.isJapan||""===t&&e.isKorea)&&n<r.length&&r.charCodeAt(n)===c)return{currency:S.Default,i:n+1};if(e.isChinaT&&n+2<r.length&&0===e.stringCompareCI(r.substring(n,n+3),"NT$"))return{currency:S.DollarExtra,i:n+3}}return n+t.length<=r.length&&0===e.stringCompareCI(r.substring(n,n+t.length),t)?{currency:S.Default,i:n+t.length}:void 0}function F(e,t,r,n,s,u){let c,F=0,C=!1,R=!1,b=!1,{isCurrencySymbolLead:E,currencySymbol:T}=e;s!==v.None&&(E=s===v.Lead,T="");let k=0;for(;k<r.length;){if(void 0===c&&E){const t=y(e,T,r,k);if(void 0!==t){({currency:c,i:k}=t);continue}}const t=r.charCodeAt(k);switch(t){case d:k+=1,F+=1;continue;case m:k+=1;continue;case g:case p:case h:if(k+=1,R)return(0,l.success)(void 0);R=!0,t===g&&(C=!0),b=t!==h;continue}break}const P=(0,i.parseNumberLiteral)(e,t,r,k,!0,F>0||n,u);if(void 0===P||void 0===P.value)return(0,l.success)(void 0);k=P.i;const N=b?t.neg(P.value):P.value;for(;k<r.length;){if(void 0===c&&!E){const t=y(e,T,r,k);if(void 0!==t){({currency:c,i:k}=t);continue}}switch(r.charCodeAt(k)){case d:k+=1,F+=1;continue;case m:k+=1;continue;case f:if(k+=1,!C)return(0,l.success)(void 0);C=!1;continue}break}if(k!==r.length||C||F>1||void 0!==c&&F>0)return(0,l.success)(void 0);let A,I=P.numDigDec;if(P.consumedDecimal&&I<e.numberDecimals&&(P.consumedThousands||F>0?I=e.numberDecimals:void 0!==c&&(I=e.currencyDecimals)),void 0!==P.format)A=P.format;else if(c===S.DollarUS)A=P.consumedDecimal?o.KnownFormat.USCoCurrencyDec:o.KnownFormat.USCoCurrency;else if(c===S.DollarExtra)A=(0,a.buildCurrencyFormat)(Object.assign(Object.assign({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:o.CurrencyFormat.Paren}),!1,P.consumedDecimal?2:0,!0,!1,e.isChinaT?(0,a.buildQuoted)(e,"NT$"):(0,a.buildQuoted)(e,"US$"));else if(P.numShape===o.NumberShape.Thai&&e.isThai)A=void 0!==c?P.consumedDecimal?o.KnownFormat.CoCurrencyDec_Tha:o.KnownFormat.CoCurrency_Tha:F>0?P.consumedDecimal?o.KnownFormat.Pct_Tha:o.KnownFormat.Pct0_Tha:P.consumedThousands?P.consumedDecimal?o.KnownFormat.Fixed_Tha:o.KnownFormat.Fixed0_Tha:P.consumedDecimal?o.KnownFormat.NoComFixed_Tha:o.KnownFormat.NoComFixed0_Tha;else if(P.numShape!==o.NumberShape.ASCII)A=(0,a.buildNumShapeConstFormat)(e,t,P.numShape,void 0!==c,F>0,P.consumedThousands,I,N);else if(void 0!==c)switch(s){case v.None:A=P.consumedDecimal?o.KnownFormat.CoCurrencyDec:o.KnownFormat.CoCurrency;break;case v.Lead:A=(0,a.buildCurrencyFormat)(Object.assign(Object.assign({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!0,currencyFormat:o.CurrencyFormat.Lead}),!0,P.consumedDecimal?2:0,!0,!1,"[$-x-euro2]");break;case v.Trail:A=(0,a.buildCurrencyFormat)(Object.assign(Object.assign({},e),{isCurrencySymbolLead:!1,isCurrencySepBySpace:!0,currencyFormat:o.CurrencyFormat.Lead}),!0,P.consumedDecimal?2:0,!0,!1,"[$-x-euro1]")}else A=F>0?P.consumedDecimal?o.KnownFormat.Pct:o.KnownFormat.Pct0:P.consumedThousands?P.consumedDecimal?o.KnownFormat.Fixed:o.KnownFormat.Fixed0:o.KnownFormat.General;return(0,l.success)({value:N,format:A})}!function(e){e[e.Default=0]="Default",e[e.DollarUS=1]="DollarUS",e[e.DollarExtra=2]="DollarExtra"}(S||(S={})),function(e){e[e.None=0]="None",e[e.Lead=1]="Lead",e[e.Trail=2]="Trail"}(v||(v={})),t.parseConstInternal=function(e,t,r,n,i,o){if(!i)return F(e,t,r,n,v.None,o);for(let i=v.None;i<=v.Trail;i+=1){const a=F(e,t,r,n,i,o);if(!(0,l.isSuccess)(a))return a;if(void 0!==a.value)return a;if(i===v.None&&r.indexOf("")<0)break}return(0,l.success)(void 0)}},11620:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseDateInternal=t.initParseDateGlobals=void 0;const n=r(19181),i=r(31748),o=r(56331),a=r(4810),s=r(50026),l=r(16322),u=n.__importStar(r(8600)),c=r(11632),d=r(63224),m=r(96705),g=r(41539),p=r(78421),h=r(84516),f=r(71571),{codePointSlash:S,codePointSpace:v,codePointMinusSign:y,codePointColon:F}=u,C={getTime:()=>(0,d.assertFalse)("calc.numfmt.parseDateInternal: default getTime")};var R;function b(e,t){return(0,d.assertTrue)("calc.numfmt.monthToken",B(e,1,12)),{kind:R.Month,value:e,bidiDate:t}}t.initParseDateGlobals=function(e){var t,r;return{config:e.config,getTime:null!==(r=null===(t=e.getTime)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:C.getTime}},function(e){e[e.Month=0]="Month",e[e.AMPM=1]="AMPM",e[e.Number=2]="Number"}(R||(R={}));const E=[...new Array(12)].map(((e,t)=>b(t+1))),T=e=>E[e],k=e=>b(e+1,o.BidiDate.English),P=e=>b(e+1,o.BidiDate.Lunar),[N,A]=[!0,!1].map((e=>({kind:R.AMPM,am:e}))),I=e=>0===e?N:A;function O(e,t,r){return(0,d.assertTrue)("calc.numfmt.numberToken",(0,p.isInteger)(e)&&B(e,-9999,9999)&&B(t,1,4)),{kind:R.Number,value:e,digits:t,numShape:r}}var _;!function(e){e[e.Nil=0]="Nil",e[e.Space=1]="Space",e[e.Date=2]="Date",e[e.Time=3]="Time",e[e.TimeAlt=4]="TimeAlt",e[e.FracSec=5]="FracSec",e[e.Intl1St3=6]="Intl1St3"}(_||(_={}));const M=e=>e===_.Time||e===_.TimeAlt,D=(e,t)=>e.lcid===i.LCID.Hungarian&&t===_.Date,w=e=>e<=_.Space,L=e=>e<=_.Date,x=["",""],K={[i.Country.FRN]:[["Jun",b(6)],["Jul",b(7)]],[i.Country.DUT]:[["Mrt",b(3)]],[i.Country.GER]:[["Mrz",b(3)]]},U=["",""," "," "," "," ","","","",""," "," "];function B(e,t,r){return e>=t&&e<=r}function G(e,t){const r=e.getTime(g.TimeGranularity.Year,t);if(!(0,h.isSuccess)(r))return r;const n=e.config,i=n.datepack.fromNum(n,r.value,g.Rounding.RoundSec);return(0,d.assertTrue)("calc.numfmt.parseDateInternal: current year fromNum",!1!==i),(0,h.success)(i.yr)}function W(e,t,r,n){return n+t.length<=r.length&&0===e.stringCompareCI(t,r.substring(n,n+t.length))}function V(e,t,r,n,i,o){const s=t.indexOf(" ",r);for(let l=0;l<n.length;l+=1){const u=n[l],c=(0,a.fastMin)(i,u.length);if(s>=0&&u.indexOf(" ")<0&&s-r>=c&&s-r<=u.length){const n=u.substring(0,s-r);if(W(e,n,t,r))return[o(l),r+n.length]}let d;for(let n=c;n<=u.length;n+=1){const i=u.substring(0,n);if(!W(e,i,t,r))break;d=r+i.length}if(void 0!==d)return[o(l),d]}}function j(e,t,r,n,i){for(let o=0;o<n.length;o+=1){const a=n[o];if(W(e,a,t,r))return[i(o),r+a.length]}}function q(e,t,r){const n=K[e.country];if(void 0!==n)for(const[i,o]of n)if(W(e,i,t,r))return[o,r+i.length];let o;if(e.isEastAsia){if(o=V(e,t,r,(0,i.getEnglishLocaleInfo)().monthNameLong,3,T),void 0!==o)return o}else if(e.isComplexScript){if(o=j(e,t,r,e.monthNameLong,T),void 0!==o)return o;if(o=j(e,t,r,e.monthNameShort,T),void 0!==o)return o;if(o=j(e,t,r,(0,i.getEnglishLocaleInfo)().monthNameLong,k),void 0!==o)return o;if(o=j(e,t,r,(0,i.getEnglishLocaleInfo)().monthNameShort,k),void 0!==o)return o}else if(o=V(e,t,r,e.monthNameLong,3,T),void 0!==o)return o;return(e.lcid&i.LCID.LANG)==(i.LCID.Arabic&i.LCID.LANG)&&(o=j(e,t,r,U,P),void 0!==o)?o:(o=V(e,t,r,e.ampmSymbols,1,I),void 0!==o?o:(o=V(e,t,r,(0,i.getEnglishLocaleInfo)().ampmSymbols,1,I),void 0!==o||(e.isChinaS||e.isChinaT)&&(o=V(e,t,r,x,1,I),void 0!==o)?o:[void 0,r]))}function H(e,t,r,n){let i=r;const o=t.charCodeAt(i)===y;let a,s,u;if(o&&(i+=1),n===_.FracSec){if([a,s]=(0,c.parseUint)(e,4,i+4<t.length?t.substring(0,i+4):t,i),u=s-i,(0,d.assertTrue)("calc.numfmt.parseDateInternal: 0 < digits <= 4",B(u,1,4)),4===u){let r;for(;s<t.length&&e.isNumeral(r=(0,l.stringCodePointAt)(t,s));)s+=(0,l.numCodeUnits)(r);a=Math.round(a/10),u=3}}else if([a,s]=(0,c.parseUint)(e,4,t,i),u=s-i,u>4||u>2&&a<100)return[void 0,r];if(0===u)return[void 0,r];const g=function(e,t){let r=m.NumberShape.ASCII;for(const n of(0,l.codePointIterator)(t)){const t=e.getNumberShape(n);t!==m.NumberShape.ASCII&&(r=t)}return r}(e,t.substring(i,s));return i=s,[O(o?-a:a,u,g),i]}function z(e,t,r,n){let i=_.Nil,o=r;if(t.charCodeAt(o)===v)for(i=_.Space;t.charCodeAt(o)===v;)o+=1;return null!=e.timeAltSeparator&&e.timeAltSeparator!==e.timeSeparator&&n===_.Time&&(0,p.stringStartsWith)(t,e.timeAltSeparator,o)?(i=_.TimeAlt,o+=e.timeAltSeparator.length):(0,p.stringStartsWith)(t,e.dateSeparator,o)?(i=_.Date,o+=e.dateSeparator.length):(0,p.stringStartsWith)(t,e.timeSeparator,o)?(i=_.Time,o+=e.timeSeparator.length):(0,p.stringStartsWith)(t,e.decimalSeparator,o)&&n===_.Time?(i=_.FracSec,o+=e.decimalSeparator.length):t.charCodeAt(o)===S||t.charCodeAt(o)===y?(i=_.Date,o+=1):t.charCodeAt(o)===F?(i=_.Time,o+=1):(0,p.stringStartsWith)(t,", ",o)&&(i=_.Intl1St3,o+=2),i===_.Space&&(" "===e.dateSeparator?i=_.Date:" "===e.timeSeparator?i=_.Time:" "===e.decimalSeparator&&n===_.Time&&(i=_.FracSec)),[i,o]}function $(e,t,r,n){return t===m.NumberShape.ASCII?r:t!==m.NumberShape.Lao&&t!==m.NumberShape.Thai||!e.isThai?(0,f.buildNumShapeDateTimeFormat)(e,t,r):n}t.parseDateInternal=function(e,t,r,n){const{config:i}=e,{localeInfo:a}=i;if(!a.isEastAsia&&!function(e,t){for(const r of(0,l.codePointIterator)(t))if(e.isNumeral(r))return!0;return!1}(a,t))return(0,h.success)(void 0);if(a.isEastAsia)return(0,h.failure)((0,s.notImplemented)(["parse East Asia date"]));if(a.isThai){let e=t.indexOf("b");if(e<0&&(e=t.indexOf("B")),e>=0&&e+1<t.length&&a.isNumeral((0,l.stringCodePointAt)(t,e+1)))return(0,h.failure)((0,s.notImplemented)(["parse Thai Buddhist date"]))}const u=function(e,t,r){const{localeInfo:n,dateCompatibility:i}=e,o=[];let a=null==r?void 0:r.bidiDate,u=m.NumberShape.ASCII;const c=null==r?void 0:r.culture;let g,p=!1,f=!1;for(let e=0;e<t.length;){if(o.length>=9)return(0,h.success)(void 0);let r;if(n.isNumeral((0,l.stringCodePointAt)(t,e))||!i&&e+1<t.length&&t.charCodeAt(e)===y&&n.isNumeral((0,l.stringCodePointAt)(t,e+1))){const[i,o]=H(n,t,e,g);if(void 0===i)return(0,h.success)(void 0);e=o,i.numShape!==m.NumberShape.ASCII&&(u=i.numShape),r=i}else{if(t.charCodeAt(e)===v)return(0,h.failure)((0,s.notImplemented)(["absurd date/time string with leading space"]));{const[i,s]=q(n,t,e);if(void 0===i)return(0,h.success)(void 0);if(e=s,i.kind===R.Month){if(p)return(0,h.success)(void 0);p=!0,void 0!==i.bidiDate&&(a=i.bidiDate)}if(i.kind===R.AMPM){if(f)return(0,h.success)(void 0);if(f=!0,0===o.length||o[o.length-1].sep!==_.Space)return(0,h.success)(void 0);g=o[o.length-1].sep=_.Time}r=i}}const[c,d]=z(n,t,e,g);for(e=d;e<t.length&&t.charCodeAt(e)===v;)e+=1;o.push({tok:r,sep:c}),g=c}return(0,d.assertTrue)("calc.numfmt.parseDateInternal: > 0 tokens",0!==o.length),(0,h.success)({tokens:o,bidiDate:a,numShape:u,culture:c})}(i,t,r);if(!(0,h.isSuccess)(u)||void 0===u.value)return u;const{tokens:c,bidiDate:p,numShape:f,culture:S}=u.value;if(p===o.BidiDate.Lunar)return(0,h.failure)((0,s.notImplemented)(["Lunar calendar"]));if(void 0!==S&&(S.localCalendarInput||S.tag===o.CultureTag.Gannen))return(0,h.failure)((0,s.notImplemented)(["parse date: possible local calendar"]));const F=function(e,t){const{localeInfo:r}=e;let n,i,o,a,l,u,c;for(let e=0;e<t.length;e+=1)if(M(t[e].sep)){n={start:e,end:e+1};break}if(void 0!==n){if(0!==n.start&&t[n.start-1].sep!==_.Space&&!D(r,t[n.start-1].sep))return(0,h.success)(void 0);for(;n.end<t.length&&M(t[n.end-1].sep);)n.end+=1;if(n.end<t.length&&t[n.end-1].sep===_.FracSec){n.end+=1;const e=t[n.end-1];if(e.tok.kind!==R.Number)return(0,h.success)(void 0);if(e.tok,u=e,n.end<t.length&&M(t[n.end-1].sep)){n.end+=1;const e=t[n.end-1];if(e.tok.kind!==R.AMPM)return(0,h.failure)((0,s.notImplemented)(["non-AM/PM after FracSec"]));e.tok,c=e}}else{const e=t[n.end-1];e.tok.kind===R.AMPM&&(e.tok,c=e)}const e=n.end-n.start-(void 0!==u?1:0)-(void 0!==c?1:0);for(let r=0;r<e;r+=1)if(t[n.start+r].tok.kind!==R.Number)return(0,h.failure)((0,s.notImplemented)(["non-number in H/M/S component"]));switch(e){case 0:return(0,d.assertFalse)("calc.numfmt.parseDateInternal: 0 time");case 1:(0,d.assertTrue)("calc.numfmt.parseDateInternal: 1 time => !fracSec",void 0===u),o=t[n.start];break;case 2:void 0===u?(o=t[n.start],a=t[n.start+1]):(a=t[n.start],l=t[n.start+1]);break;case 3:o=t[n.start],a=t[n.start+1],l=t[n.start+2];break;default:return(0,h.success)(void 0)}for(let e=n.end;e<t.length;e+=1)if(M(t[e].sep))return(0,h.success)(void 0);if(n.end===t.length){const e=t[n.end-1].sep;if(!(w(e)||void 0!==c&&e===_.FracSec))return(0,h.failure)((0,s.notImplemented)(["trailing sep after time"]))}else{const e=t[n.end-1].sep;if(!w(e)&&e!==_.Intl1St3)return(0,h.failure)((0,s.notImplemented)(["unexpected sep between time and date"]))}if(0===n.start)n.end!==t.length&&(i={start:n.end,end:t.length});else{if(n.end!==t.length)return(0,h.failure)((0,s.notImplemented)(["date part split around time part"]));i={start:0,end:n.start}}}else i={start:0,end:t.length};return(0,h.success)({time:n,date:i,hour:o,min:a,sec:l,fracSec:u,ampm:c})}(i,c);if(!(0,h.isSuccess)(F)||void 0===F.value)return F;const{time:C,date:b,hour:E,min:T,sec:k,fracSec:P,ampm:N}=F.value,A=function(e,t,r,n){const{config:i}=e,{localeInfo:o,dateCompatibility:a,datepack:l}=i;let u,c,g,p=!1;if(void 0!==n){const e=n.end-n.start;if(e<2||e>3)return(0,h.success)(void 0);const{tok:t,sep:i}=r[n.start],{tok:l,sep:f}=r[n.start+1],{tok:S,sep:v}=r[n.end-1];if((0,d.assertTrue)("calc.numfmt.parseDateInternal: all not AM/PM",t.kind!==R.AMPM&&l.kind!==R.AMPM&&S.kind!==R.AMPM),!w(v)&&!D(o,v))return(0,h.success)(void 0);const y=void 0!==function(e,t){for(let r=t.start;r<t.end;r+=1)if(e[r].tok.kind===R.Month)return r}(r,n);if(p=y,y)if(L(i)&&L(f))if(t.kind===R.Month){if(e>2)return(0,h.success)(void 0);c=t,(0,d.assertTrue)("calc.numfmt.parseDateInternal: yr not Month",S.kind!==R.Month),u=S}else{if(l.kind!==R.Month)return(0,h.success)(void 0);g=t,c=l,3===e&&((0,d.assertTrue)("calc.numfmt.parseDateInternal: yr not Month",S.kind!==R.Month),u=S)}else{if(3!==e)return(0,h.success)(void 0);if(w(f))return(0,h.success)(void 0);const r=o.longDateFormat?t:l,n=o.longDateFormat?l:t;if(r.kind!==R.Month)return(0,h.success)(void 0);(0,d.assertTrue)("calc.numfmt.parseDateInternal: Int1 dom & yr not Month",n.kind!==R.Month&&S.kind!==R.Month),g=n,c=r,u=S}else if((0,d.assertTrue)("calc.numfmt.parseDateInternal: all not Month",t.kind!==R.Month&&l.kind!==R.Month&&S.kind!==R.Month),2===e&&i===_.Date)switch(p=!0,o.dateOrder){case m.DateOrder.MDY:c=t,u=S;break;case m.DateOrder.YMD:B(t.value,1,12)?(c=t,g=S):(u=t,c=S);break;case m.DateOrder.DMY:B(S.value,1,12)?(g=t,c=S):(c=t,u=S);break;default:return(0,h.failure)((0,s.notImplemented)(["date parse date order"]))}else{if(e<3||i!==_.Date||f!==_.Date)return(0,h.success)(void 0);switch(t.value>999||!a&&t.value>99?m.DateOrder.YMD:o.dateOrder){case m.DateOrder.MDY:c=t,g=l,u=S;break;case m.DateOrder.YMD:u=t,c=l,g=S;break;case m.DateOrder.DMY:g=t,c=l,u=S;break;default:return(0,h.failure)((0,s.notImplemented)(["date parse date order"]))}}}let f=!1;if(o.dateOrder!==m.DateOrder.DMY&&void 0===g&&void 0!==c&&B(c.value,1,12)&&void 0!==u&&B(u.value,1,31)){const r=G(e,t);if(!(0,h.isSuccess)(r))return r;u.value<=l.daysPerMonth(c.value,r.value,a)&&(g=u,u=O(r.value,4,m.NumberShape.ASCII),f=!0)}return(0,h.success)({yr:u,mon:c,dom:g,useMonthName:p,usingCurrentYear:f})}(e,n,c,b);if(!(0,h.isSuccess)(A)||void 0===A.value)return A;const{yr:I,mon:x,dom:K,useMonthName:U,usingCurrentYear:W}=A.value,V=function(e,t,r,n,i,o,a,l,u,c){var m;const{config:p}=e,{mathpack:f,datepack:S,dateCompatibility:v}=p;let y,F,C;if(void 0!==n||void 0!==i||void 0!==r){if((0,d.assertTrue)("calc.numfmt.parseDateInternal: dom || yr",void 0!==i||void 0!==r),(0,d.assertTrue)("calc.numfmt.parseDateInternal: mon",void 0!==n),F=n.value,!B(F,1,12))return(0,h.success)(void 0);if(void 0===r){const r=G(e,t);if(!(0,h.isSuccess)(r))return r;y=r.value}else y=B(r.value,0,99)?function(e){return 1900+(e<30?100:0)+e}(r.value):r.value;if(!B(y,1900,9999))return(0,h.success)(void 0);if(C=null!==(m=null==i?void 0:i.value)&&void 0!==m?m:1,!B(C,1,S.daysPerMonth(F,y,v)))return(0,h.success)(void 0)}else{const e=S.fromNum(p,f.zero,g.Rounding.RoundSec);(0,d.assertTrue)("calc.numfmt.parseDateInternal: zeroDtr fromNum",!1!==e),({yr:y,mon:F,dom:C}=e)}let R,b=0,E=0,T=0,k=0,P=g.Rounding.RoundSec,N=0;if(void 0!==o){if(o.value<0)return(0,h.failure)((0,s.notImplemented)(["negative hour"]));if(o.value>23){if(void 0!==R)return(0,h.success)(void 0);N=o.value,R=g.TimeDivision.Hour}else b=o.value}if(void 0!==a){if(a.value<0)return(0,h.failure)((0,s.notImplemented)(["negative minute"]));if(a.value>59){if(void 0!==R)return(0,h.success)(void 0);N=a.value,R=g.TimeDivision.Minute}else E=a.value}if(void 0!==l){if(l.value<0)return(0,h.failure)((0,s.notImplemented)(["negative second"]));if(l.value>59){if(void 0!==R)return(0,h.success)(void 0);N=l.value,R=g.TimeDivision.Second}else T=l.value}if(void 0!==u){if(u.value<0)return(0,h.failure)((0,s.notImplemented)(["negative fractional second"]));(0,d.assertTrue)("calc.numfmt.parseDateInternal: fracSec.digits",u.digits>=1&&u.digits<=3),P=u.digits,(0,d.assertTrue)("calc.numfmt.parseDateInternal: fracSec.value",u.value<(3===P?1001:2===P?100:10)),k=u.value}if(void 0!==c){if(void 0!==R||b>12)return(0,h.success)(void 0);c.am?12===b&&(b=0):b<12&&(b+=12)}const A=(0,g.dateTime)(y,F,C,b,E,T,1,k,P),I=void 0!==R?S.toNumWithDuration(p,A,R,N):S.toNum(p,A);return(0,s.isErrorOper)(I)?(0,h.success)(void 0):(0,h.success)({value:I,duration:R})}(e,n,I,x,K,null==E?void 0:E.tok,null==T?void 0:T.tok,null==k?void 0:k.tok,null==P?void 0:P.tok,null==N?void 0:N.tok);if(!(0,h.isSuccess)(V)||void 0===V.value)return V;const{value:j,duration:Q}=V.value,Y=function(e,t,r,n,i,o,a,l,u,c,p,f,S){if(l)return(null==u?void 0:u.sep)===_.TimeAlt?(0,h.success)(e.sysTimeFormat):void 0!==p?(0,h.success)($(e,t,m.KnownFormat.SS0,m.KnownFormat.SS0_Tha)):void 0!==S?S!==g.TimeDivision.Hour||void 0!==f||r?(0,h.success)(m.KnownFormat.General):(0,h.success)($(e,t,m.KnownFormat.AbsHMMSS,m.KnownFormat.AbsHMMSS_Tha)):r?(0,h.success)($(e,t,m.KnownFormat.MDYHMS,m.KnownFormat.MDYHMS_Tha)):void 0!==f?(0,h.success)($(e,t,void 0!==c?m.KnownFormat.HHMMSSAP:m.KnownFormat.HHMMAP,void 0!==c?m.KnownFormat.HHMMSS_Tha:m.KnownFormat.HHMM_Tha)):(0,h.success)($(e,t,void 0!==c?m.KnownFormat.HHMMSS:m.KnownFormat.HHMM,void 0!==c?m.KnownFormat.HHMMSS_Tha:m.KnownFormat.HHMM_Tha));if((0,d.assertTrue)("calc.numfmt.parseDateInternal: !haveTime => haveDate",r),!o)return(0,h.success)($(e,t,m.KnownFormat.MMDDYY,m.KnownFormat.MMDDYY_Tha));const v=void 0!==n&&!a,y=$(e,t,void 0===i?m.KnownFormat.MMMYY:v?m.KnownFormat.DDMMMYY:m.KnownFormat.DDMMM,void 0===i?m.KnownFormat.MMMYY_Tha:v?m.KnownFormat.DDMMMYY_Tha:m.KnownFormat.DDMMM_Tha);return e.isEastAsia&&y===m.KnownFormat.DDMMM&&r?(0,h.failure)((0,s.notImplemented)(["parseDateInternal ifmt for East Asian DDMMM"])):(0,h.success)(y)}(a,f,void 0!==b,I,K,U,W,void 0!==C,T,k,P,N,Q);return(0,h.isSuccess)(Y)?(0,h.success)({value:j,format:Y.value}):Y}},46627:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderHashesValue=t.renderValue=t.renderGeneral=void 0;const n=r(56331),i=r(50026),o=r(63224),a=r(4810),s=r(43260),l=r(78421),u=r(84516),c=e=>e.kind!==n.FormattedUnitKind.General,d=e=>e.kind!==n.FormattedUnitKind.Flexible,m=255;function g(e,t,r){return 0!=(t&n.Clip.MaxChars)&&r.length>m?n.Clip.MaxChars:0!=(t&n.Clip.CellWidth)&&e.renderWidth<1/0&&e.getTextWidth(r)>e.renderWidth?n.Clip.CellWidth:void 0}function p(e,t,r,n,i,s,l){const u=(0,a.fastMax)(0,m-r.length-n.length);let c=0===i.length?u:Math.floor(u/i.length);if(e.renderWidth!==1/0){const t=e.getTextWidth(i);t>0&&(c=(0,a.fastMin)(c,(0,a.fastMax)(Math.floor((e.renderWidth-e.getTextWidth(r+n))/t),0)))}const d=l(c);if(e.bestFit&&s&&(!1===d||d.indexOf("E")>=0)){let e=1,t=d;for(;(!1===t||t.indexOf("E")>=0)&&c+e<=f;)t=l(c+e),e++;if(!1!==t)return t}let p;if(!1===d||void 0===(p=g(e,t,r+d+n))){let i=d;for(let o=c+1;o<c+50;o+=1){const a=l(o);if(!1===a)continue;if(a===i)break;const s=g(e,t,r+a+n);if(void 0!==s){!1===i&&(i=s);break}i=a}return(0,o.assertTrue)("calc.numfmt.renderValue: false after upwards search",!1!==i),i}let h=p;for(let i=c-1;i>=0;i-=1){const o=l(i);if(!1===o)break;const a=g(e,t,r+o+n);if(void 0===a)return o;h=a}return h}const h=(0,i.createFailureErrorClass)("RenderHashesError"),f=11;function S(e,t,r){const n=e.fromNumber(t.num),i=t.includeSign&&e.cond(n)<0?"-":"";let a=i+e.formatGeneral(t,e.abs(n),r-i.length);if("-0"===a&&(a="0"),a.length>r)return!1;const l=a.indexOf("E");if(l>=0){const e=(0,s.convertNumberShape)(t,a.substring(0,l),t.expNumberShape),r=a.substring(l,l+2),n=(0,s.convertDigitsShape)(a.substring(l+2),t.expNumberShape);return(0,o.assertTrue)("calc.numfmt.render: formatGeneral ePart","E-"===r||"E+"===r),e+r+n}return(0,s.convertNumberShape)(t,a,t.numberShape)}t.renderGeneral=S,t.renderValue=function(e,t,r){try{return(0,n.isHashesValue)(t)?(0,u.success)((0,n.hashesValue)(t.units,t.color)):(0,u.success)(function(e,{units:t,color:r,alignment:i,clip:s},u){const m=(0,n.memoizedRenderCallback)(u);let v,y;if(t.every(c))v=t;else if(m.renderWidth===1/0)v=t.map((t=>{if(t.kind!==n.FormattedUnitKind.General)return t;const r=S(e,t,f);return(0,o.assertTrue)("calc.numfmt.renderValue: false after format at defaultGenPrecision",!1!==r),(0,n.formattedUnitString)(r)}));else{let r,i,l="",u="";for(let e=0;e<t.length;e+=1){const a=t[e];switch(a.kind){case n.FormattedUnitKind.String:case n.FormattedUnitKind.Blank:void 0!==r?u+=a.str:l+=a.str;break;case n.FormattedUnitKind.General:(0,o.assertTrue)("calc.numfmt.renderValue: expected a single General unit",void 0===r),r=e,i=a;case n.FormattedUnitKind.Flexible:}}(0,o.assertTrue)("calc.numfmt.renderValue: genUnit",void 0!==r&&void 0!==i);const c=i,d=p(m,s,l,u,"0",c.builtin,(t=>S(e,c,(0,a.fastMin)(t,f))));if("number"==typeof d)throw new h((0,n.tooWide)(d));v=t.map((e=>e.kind===n.FormattedUnitKind.General?(0,n.formattedUnitString)(d):e))}if(v.every(d))y=v;else if(m.renderWidth===1/0||m.bestFit)y=v.filter(d);else{let e,t,r="",i="";for(let o=0;o<v.length;o+=1){const a=v[o];switch(a.kind){case n.FormattedUnitKind.String:case n.FormattedUnitKind.Blank:void 0!==e?i+=a.str:r+=a.str;break;case n.FormattedUnitKind.Flexible:e=o,t=a}}(0,o.assertTrue)("calc.numfmt.renderValue: lastFlexUnit",void 0!==e&&void 0!==t);const u=t;let c=p(m,n.Clip.All,r,i,t.str,!1,(e=>(0,l.repeat)(u.str,e)));if("number"==typeof c){if(0!=(c&s))throw new h((0,n.tooWide)(c));c=""}let d=c.length/u.str.length;d=(0,a.fastMax)(d-1,0);const g=(0,l.repeat)(u.str,d);y=v.map(((t,r)=>t.kind!==n.FormattedUnitKind.Flexible?t:(0,n.formattedUnitString)(r===e?g:"")))}if(s!==n.Clip.None){let e="";for(let t=0;t<y.length;t+=1)e+=y[t].str;const t=g(m,s,e);if(m.bestFit&&t===n.Clip.CellWidth)return(0,n.renderedValue)(y,r,i,s);if(void 0!==t)throw new h((0,n.tooWide)(t))}return(0,n.renderedValue)(y,r,i,s)}(e,t,r))}catch(e){return e instanceof h?(0,u.success)((0,n.hashesValue)(e.reason,t.color)):(0,u.failure)((0,u.javaScriptError)(e))}},t.renderHashesValue=function(e,t){try{let r=p((0,n.memoizedRenderCallback)(t),e.clip,"","","#",!1,(e=>(0,l.repeat)("#",e)));if("number"==typeof r)switch(r){case n.Clip.MaxChars:r=(0,l.repeat)("#",m);break;case n.Clip.CellWidth:r="";break;default:return(0,o.assertNever)("calc.numFmt.renderHashesValue",r)}const i=(0,n.formattedUnitString)(r);return(0,u.success)((0,n.renderedValue)([i],e.color,e.alignment,e.clip))}catch(e){return(0,u.failure)((0,u.javaScriptError)(e))}}},244:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRibbonFormat=t.RibbonFormat=void 0;const n=r(31748),i=r(96705),o=r(71571);var a;function s(e,t){return(0,o.buildSingle)(e,n.PictureSingle.ColorStart,"$-",t,n.PictureSingle.ColorEnd)}!function(e){e.GalleryGeneral="GalleryGeneral",e.GalleryNumber="GalleryNumber",e.GalleryCurrency="GalleryCurrency",e.GalleryAccounting="GalleryAccounting",e.GalleryShortDate="GalleryShortDate",e.GalleryLongDate="GalleryLongDate",e.GalleryTime="GalleryTime",e.GalleryPercentage="GalleryPercentage",e.GalleryFraction="GalleryFraction",e.GalleryScientific="GalleryScientific",e.GalleryText="GalleryText",e.ButtonComma="ButtonComma",e.ButtonPercentage="ButtonPercentage",e.ButtonAccounting="ButtonAccounting",e.KeyboardGeneral="KeyboardGeneral",e.KeyboardNumber="KeyboardNumber",e.KeyboardCurrency="KeyboardCurrency",e.KeyboardDate="KeyboardDate",e.KeyboardTime="KeyboardTime",e.KeyboardPercentage="KeyboardPercentage",e.KeyboardScientific="KeyboardScientific"}(a||(t.RibbonFormat=a={})),t.getRibbonFormat=function(e,t,r){var l,u;const c=(null!==(u=null===(l=null==r?void 0:r.culture)||void 0===l?void 0:l.calendar)&&void 0!==u?u:i.Calendar.Gregorian)===i.Calendar.Gregorian;switch(t){case a.GalleryGeneral:case a.KeyboardGeneral:return(0,o.getKnownFormat)(e,i.KnownFormat.General);case a.GalleryNumber:return(0,o.buildNumberFormat)(e,!1,1,e.currencyDecimals);case a.KeyboardNumber:return(0,o.buildNumberFormat)(e,!0,4,e.currencyDecimals);case a.GalleryCurrency:{const t=Object.assign(Object.assign({},e),{currencyFormat:e.currencyFormat===i.CurrencyFormat.Paren?i.CurrencyFormat.Lead:e.currencyFormat});return(0,o.buildCurrencyFormat)(t,!1,e.currencyDecimals,!0,!1,void 0,!0)}case a.KeyboardCurrency:return(0,o.buildCurrencyFormat)(e,!0,e.currencyDecimals,!0,!1);case a.GalleryAccounting:case a.ButtonAccounting:return(0,o.buildCurrencyFormat)(e,!1,e.currencyDecimals,!0,!0);case a.GalleryShortDate:return c?(0,o.getKnownFormat)(e,i.KnownFormat.MMDDYY):(0,o.buildSingle)(e,n.PictureSingle.Month,n.PictureSingle.DateSep,n.PictureSingle.Day,n.PictureSingle.Sep,n.PictureSingle.Text);case a.GalleryLongDate:return c?s(e,"x-sysdate")+(0,o.buildSingle)(e,n.PictureSingle.Day,n.PictureSingle.Day,n.PictureSingle.Day,n.PictureSingle.Day,", ",n.PictureSingle.Month,n.PictureSingle.Month,n.PictureSingle.Month,n.PictureSingle.Month," ",n.PictureSingle.Day,n.PictureSingle.Day,", ",n.PictureSingle.Year,n.PictureSingle.Year,n.PictureSingle.Year,n.PictureSingle.Year):(0,o.buildSingle)(e,n.PictureSingle.Month,n.PictureSingle.DateSep,n.PictureSingle.Day,n.PictureSingle.DateSep,n.PictureSingle.Year,n.PictureSingle.Year,n.PictureSingle.Sep,n.PictureSingle.Text);case a.GalleryTime:return s(e,"x-systime")+(0,o.buildSingle)(e,n.PictureSingle.Hour,n.PictureSingle.Colon,n.PictureSingle.Minute,n.PictureSingle.Minute,n.PictureSingle.Colon,n.PictureSingle.Second,n.PictureSingle.Second," ")+(0,o.getSpecial)(e,n.PictureSpecial.AP1);case a.KeyboardDate:return s(e,"en-US")+(0,o.buildSingle)(e,n.PictureSingle.Day,"-",n.PictureSingle.Month,n.PictureSingle.Month,n.PictureSingle.Month,"-",n.PictureSingle.Year,n.PictureSingle.Year,n.PictureSingle.Sep,n.PictureSingle.Text);case a.KeyboardTime:return s(e,"en-US")+(0,o.buildSingle)(e,n.PictureSingle.Hour,n.PictureSingle.Colon,n.PictureSingle.Minute,n.PictureSingle.Minute," ",(0,o.getSpecial)(e,n.PictureSpecial.AP1),n.PictureSingle.Sep,n.PictureSingle.Text);case a.GalleryPercentage:return(0,o.buildPercentFormat)(e,e.currencyDecimals);case a.ButtonPercentage:case a.KeyboardPercentage:return(0,o.getKnownFormat)(e,i.KnownFormat.Pct0);case a.GalleryFraction:return(0,o.getKnownFormat)(e,i.KnownFormat.Fract);case a.GalleryScientific:case a.KeyboardScientific:return(0,o.buildScientificFormat)(e,1,e.currencyDecimals,2);case a.GalleryText:return(0,o.getKnownFormat)(e,i.KnownFormat.Text);case a.ButtonComma:return(0,o.buildCurrencyFormat)(e,!1,e.currencyDecimals,!1,!0)}}},56331:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.evalFormatLocalsGrid=t.createFormatGlobals=t.NumberFormatSource=t.otherEdit=t.numberEdit=t.stringEdit=t.formulaEdit=t.EditKind=t.renderedValueToString=t.renderInfiniteWidth=t.memoizedRenderCallback=t.renderCallback=t.isHashesValue=t.renderedValue=t.formattedValue=t.hashesValue=t.formattedUnitFlexible=t.formattedUnitBlank=t.formattedUnitString=t.formattedUnitGeneral=t.FormattedUnitKind=t.Clip=t.GetTimeKind=t.Alignment=t.NamedColor=t.FormatCurrency=t.isFormatCultureEqual=t.isSystemCultureTag=t.CultureTag=t.BidiDate=t.FormatValueType=t.formatLocIFormat=t.formatLocKnownFormat=t.FormatLocKind=t.previousFormatFailure=t.aggregationError=t.fractionOverflow=t.dateOverflow=t.tooWide=t.noFormatPart=t.notFormatString=t.notValueString=t.ReasonKind=t.FormatReasonKind=void 0;const n=r(50026),i=r(4810),o=r(84516);var a,s,l,u,c,d,m,g,p,h,f,S,v;function y(e,t,r,n){return{units:e,color:t,alignment:r,clip:n}}function F(e,t,r){return{renderWidth:e,bestFit:r,getTextWidth:t}}!function(e){e.NotValueString="NotValueString",e.NotFormatString="NotFormatString",e.NoFormatPart="NoFormatPart",e.TooWide="TooWide",e.DateOverflow="DateOverflow",e.FractionOverflow="FractionOverflow",e.AggregationError="AggregationError",e.PreviousFormatFailure="PreviousFormatFailure"}(a||(t.FormatReasonKind=a={})),t.ReasonKind=Object.assign(Object.assign({},n.LangReasonKind),a),t.notValueString=function(e){return{kind:t.ReasonKind.NotValueString,message:e}},t.notFormatString=function(e){return{kind:t.ReasonKind.NotFormatString,message:e}},t.noFormatPart={kind:t.ReasonKind.NoFormatPart},t.tooWide=function(e){return{kind:t.ReasonKind.TooWide,clip:e}},t.dateOverflow={kind:t.ReasonKind.DateOverflow},t.fractionOverflow={kind:t.ReasonKind.FractionOverflow},t.aggregationError={kind:t.ReasonKind.AggregationError},t.previousFormatFailure=function(e){return{kind:t.ReasonKind.PreviousFormatFailure,format:e}},function(e){e.FormatString="FormatString",e.KnownFormat="KnownFormat",e.IFormat="IFormat"}(s||(t.FormatLocKind=s={})),t.formatLocKnownFormat=function(e,t){return{kind:s.KnownFormat,document:e,knownFormat:t}},t.formatLocIFormat=function(e,t){return{kind:s.IFormat,document:e,iformat:t}},function(e){e.General="General",e.Number="Number",e.Currency="Currency",e.Accounting="Accounting",e.Date="Date",e.Time="Time",e.Percentage="Percentage",e.Fraction="Fraction",e.Scientific="Scientific",e.Text="Text",e.Custom="Custom"}(l||(t.FormatValueType=l={})),function(e){e.English="English",e.Lunar="Lunar"}(u||(t.BidiDate=u={})),function(e){e.SysDate="sysdate",e.SysTime="systime",e.Euro1="euro1",e.Euro2="euro2",e.GenLower="genlower",e.GenUpper="genupper",e.NomLower="nomlower",e.Bitcoin1="xbt1",e.Bitcoin2="xbt2",e.Gannen="gannen"}(c||(t.CultureTag=c={})),t.isSystemCultureTag=function(e){return e===c.SysDate||e===c.SysTime},t.isFormatCultureEqual=function(e,t){return e.culture===t.culture&&e.numberShape===t.numberShape&&e.nationalNumberInput===t.nationalNumberInput&&e.calendar===t.calendar&&e.localCalendarInput===t.localCalendarInput&&e.tag===t.tag},function(e){e[e.LocaleInfo=0]="LocaleInfo"}(d||(t.FormatCurrency=d={})),function(e){e.Black="Black",e.White="White",e.Red="Red",e.Green="Green",e.Blue="Blue",e.Yellow="Yellow",e.Magenta="Magenta",e.Cyan="Cyan"}(m||(t.NamedColor=m={})),function(e){e.Left="Left",e.Center="Center",e.Right="Right"}(g||(t.Alignment=g={})),function(e){e.ValueCell="ValueCell",e.Volatile="Volatile",e.NonVolatile="NonVolatile"}(p||(t.GetTimeKind=p={})),function(e){e[e.MaxChars=2]="MaxChars",e[e.CellWidth=4]="CellWidth",e[e.None=0]="None",e[e.All=6]="All"}(h||(t.Clip=h={})),function(e){e.String="String",e.Blank="Blank",e.General="General",e.Flexible="Flexible"}(f||(t.FormattedUnitKind=f={})),t.formattedUnitGeneral=function(e,t,r,n,i,o){return{kind:f.General,num:e,decimalSeparator:t,includeSign:r,numberShape:n,expNumberShape:i,builtin:o}},t.formattedUnitString=function(e){return{kind:f.String,str:e}},t.formattedUnitBlank=function(e){return{kind:f.Blank,str:e}},t.formattedUnitFlexible=function(e){return{kind:f.Flexible,str:e}},t.hashesValue=function(e,t){return y(e,t,g.Center,h.All)},t.formattedValue=y,t.renderedValue=y,t.isHashesValue=function(e){return!Array.isArray(e.units)},t.renderCallback=F,t.memoizedRenderCallback=function(e){const t=(0,i.makeStringMap)();return F(e.renderWidth,(r=>{if(null!=t[r])return t[r];const n=e.getTextWidth(r);return t[r]=n,n}),e.bestFit)},t.renderInfiniteWidth={renderWidth:1/0,bestFit:!1,getTextWidth:e=>e.length},t.renderedValueToString=function(e){let t="";for(const r of e.units)switch(r.kind){case f.String:t+=r.str;break;case f.Blank:for(let e=0;e<r.str.length;e+=1)t+=" "}return t},function(e){e.Formula="Formula",e.String="String",e.Number="Number",e.Other="Other"}(S||(t.EditKind=S={})),t.formulaEdit=function(e){return{kind:S.Formula,fmla:e}},t.stringEdit=function(e,t){return{kind:S.String,value:e,tick:t}},t.numberEdit=function(e,t){return{kind:S.Number,value:e,format:t}},t.otherEdit=function(e){return{kind:S.Other,value:e}},function(e){e.Builtin="Builtin",e.CustomString="CustomString",e.CustomBytecode="CustomBytecode",e.System="System"}(v||(t.NumberFormatSource=v={})),t.createFormatGlobals=function(e,t){return{config:e,getTime:t}},t.evalFormatLocalsGrid=function(e,t){const r=(0,n.sheetGridRangeAnchor)(e.range);return{config:null!=t?t:void 0,lexicalSource:e,originGridCell:(0,o.success)(r.range),originSheet:(0,o.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}}},89831:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.commonFormats=void 0,t.commonFormats=["#","##","###","########\\ \\ \\ \\ \\ \\ \\ \\ ","###,###","###\\ ###","###\\-##\\-####","##,###.##\\ \\ \\ ","#,###","#,###.#","#,###.##","#,###_)","#,###_)_ ","#.##","#.##%","#.#%","#;\\(\\ \\ @\\ \\ \\ \\)",'#"\\""\\""\\""\\"\\ ??/??',"#\\ ###",";;",";;;","@\\ ","\\ #######\\ \\ \\ \\ ","\\ \\ @","\\(###\\)\\ ###\\-####","\\(\\ ###\\ \\)\\ ###\\-####","\\:","__@","[$$]#,##0_);\\([$$]#,##0\\);[$$]#,##0_);@_)","[$$]#,##0.0_);\\([$$]#,##0.0\\);[$$]#,##0.0_);@_)","[$$-1009]#,##0.00","[$$-1009]#,##0;[Red]\\-[$$-1009]#,##0","[$$-409]#,##0","[$$-409]#,##0.00","[$$-409]#,##0.00_);\\([$$-409]#,##0.00\\)",'_([$$-409]* #,##0.00_);_([$$-409]* \\(#,##0.00\\);_([$$-409]* "-"??_);_(@_)',"[$$-409]#,##0.0000","[$$-409]#,##0.0000_);\\([$$-409]#,##0.0000\\)","[$$-409]#,##0.00_);[Red]\\([$$-409]#,##0.00\\)","[$$-409]#,##0;[Red][$$-409]#,##0","[$$-409]#,##0_);[Red]\\([$$-409]#,##0\\)","[$$-C09]#,##0.00","[$$-C09]#,##0.000","[$$-C09]#,##0.0000","[$$-C09]#,##0.00000","[$-809]#,##0","[$-809]#,##0.00","[$-809]#,##0.00;[Red]\\-[$-809]#,##0.00","[$-809]#,##0;[Red][$-809]#,##0","[$-411]#,##0","[$-2]\\ #,##0.00","[$-2]\\ #,##0.00_);[Red]\\([$-2]\\ #,##0.00\\)","[$-2]\\ #,##0_);[Red]\\([$-2]\\ #,##0\\)",'"$"#,##0','"$"#,##0;\\("$"#,##0\\)','"$"#,##0;\\-"$"#,##0','"$"#,##0_);\\("$"#,##0\\)','"$"#,##0_);\\("$"#,##0\\);"-"??_)','"$"#,##0_);\\("$"#,##0\\);\\ \\-\\ ','"$"\\ #,##0;\\("$"\\ #,##0\\)',"\\$#,##0_);\\(\\$#,##0\\)",'_ "$"\\ * #,##0_ ;_ "$"\\ * \\-#,##0_ ;_ "$"\\ * "-"??_ ;_ @_ ','_ "$"\\ * #,##0_ ;_ "$"\\ * \\-#,##0_ ;_ "$"\\ * "-"_ ;_ @_ ','_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"??_);_(@_)','_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)','_("$"\\ * #,##0_);_("$"\\ * \\(#,##0\\);_("$"\\ * "-"_);_(@_)','_-"$"* #,##0_-;\\-"$"* #,##0_-;_-"$"* "-"_-;_-@_-','"$"#,##0_%_);\\("$"#,##0\\)_%;"$"#,##0_%_);@_%_)','"$"#,##0.0','"$"#.00','"$"0.0','"$"#,##0.0,_);\\("$"#,##0.0,\\)','"$"#,##0.0;\\("$"#,##0.0\\);','"$"#,##0.0_);\\("$"#,##0.0\\)','"$"\\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','_ "$"\\ * #,##0.0_ ;_ "$"\\ * \\-#,##0.0_ ;_ "$"\\ * "-"??_ ;_ @_ ','_("$"* #,##0.0_);_("$"* \\(#,##0.0\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.0_);_("$"* \\(#,##0.0\\);_("$"* "-"?_);_(@_)','_("$"* #,##0.0_);_("$"* \\(#,##0.0\\);_("$"* "-"_);_(@_)','_-"$"* #,##0.0_-;\\-"$"* #,##0.0_-;_-"$"* "-"_-;_-@_-','"$"#,##0.0_%_);\\("$"#,##0.0\\)_%;"$"#,##0.0_%_);@_%_)','"$"#,##0.00','"$"#.000','"$"\\ #,##0.00','"$"#,##0.00,_);\\("$"#,##0.00,\\)','"$"#,##0.00;\\("$"#,##0.00\\)','"$"#,##0.00;\\-"$"#,##0.00','"$"#,##0.00_);\\("$"#,##0.00\\)','"$"\\ \\ \\ #,##0.00_);\\("$"\\ \\ \\ #,##0.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','_ "$"\\ * #,##0.00_ ;_ "$"\\ * \\-#,##0.00_ ;_ "$"\\ * "-"??_ ;_ @_ ','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"????_);_(@_)','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"???_);_(@_)','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"_);_(@_)','_("$"\\ * #,##0.00_);_("$"\\ * \\(#,##0.00\\);_("$"\\ * "-"??_);_(@_)','_-"$"* #,##0.00_-;\\-"$"* #,##0.00_-;_-"$"* "-"??_-;_-@_-','"$"#,##0.00_%_);\\("$"#,##0.00\\)_%;"$"#,##0.00_%_);@_%_)','"$"#,##0.000','"$"0.000','"$"0000','"$"#,##0.000_);\\("$"#,##0.0\\)','"$"#,##0.000_);\\("$"#,##0.00\\)','"$"#,##0.000_);\\("$"#,##0.000\\)','_("$"* #,##0.000_);_("$"* \\(#,##0.000\\);_("$"* "-"???_);_(@_)','_("$"* #,##0.000_);_("$"* \\(#,##0.000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.000_);_("$"* \\(#,##0.000\\);_("$"* "-"_);_(@_)','"$"#,##0.0000','"$"0.0000','"$"#,##0.0000_);\\("$"#,##0.00\\)','"$"#,##0.0000_);\\("$"#,##0.0000\\)','_("$"* #,##0.0000_);_("$"* \\(#,##0.0000\\);_("$"* "-"????_);_(@_)','_("$"* #,##0.0000_);_("$"* \\(#,##0.0000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.0000_);_("$"* \\(#,##0.0000\\);_("$"* "-"_);_(@_)','"$"#,##0.00000','"$"#,##0.00000_);\\("$"#,##0.000\\)','"$"#,##0.00000_);\\("$"#,##0.00000\\)','_("$"* #,##0.00000_);_("$"* \\(#,##0.00000\\);_("$"* "-"?????_);_(@_)','_("$"* #,##0.00000_);_("$"* \\(#,##0.00000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.00000_);_("$"* \\(#,##0.00000\\);_("$"* "-"_);_(@_)','"$"#,##0.000000','"$"#,##0.000000_);\\("$"#,##0.000000\\)','_("$"* #,##0.000000_);_("$"* \\(#,##0.000000\\);_("$"* "-"??????_);_(@_)','_("$"* #,##0.000000_);_("$"* \\(#,##0.000000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.000000_);_("$"* \\(#,##0.000000\\);_("$"* "-"_);_(@_)','"$"#,##0.0000000','"$"#,##0.0000000_);\\("$"#,##0.0000000\\)','_("$"* #,##0.0000000_);_("$"* \\(#,##0.0000000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.0000000_);_("$"* \\(#,##0.0000000\\);_("$"* "-"_);_(@_)','"$"#,##0.00000000','"$"#,##0.00000000_);\\("$"#,##0.00000000\\)','_("$"* #,##0.00000000_);_("$"* \\(#,##0.00000000\\);_("$"* "-"??_);_(@_)','"$"#,##0.000000000_);\\("$"#,##0.000000000\\)','_("$"* #,##0.000000000_);_("$"* \\(#,##0.000000000\\);_("$"* "-"??_);_(@_)','"$"#,##0.0000000000_);\\("$"#,##0.0000000000\\)','"$"#,##0.0000000;[Red]\\-"$"#,##0.0000000','"$"#,##0.0000000_);[Red]\\("$"#,##0.0000000\\)','"$"#,##0.000000_);[Red]\\("$"#,##0.000000\\)','"$"#,##0.000000_);[Red]\\("$"#,##0.000000\\);"- "_)','"$"#,##0.00000;[Red]\\-"$"#,##0.00000','"$"#,##0.00000_);[Red]\\("$"#,##0.00000\\)','"$"#,##0.0000;[Red]\\-"$"#,##0.0000','"$"#,##0.0000_);[Red]\\("$"#,##0.0000\\)','"$"#,##0.0000_);[Red]\\("$"#,##0.0000\\);"- "_)','"$"#,##0.000" /GJ"','"$"#,##0.000_);[Red]\\("$"#,##0.000\\)','"$"#,##0.00" /GJ"','"$"#,##0.00" /mmbtu"','"$"#,##0.00" /MWh"','"$"#,##0.00;[Red]"$"#,##0.00','"$"#,##0.00;[Red]\\-"$"#,##0.00','"$"#,##0.00_);[Red]\\("$"#,##0.00\\)','"$"#,##0.00_);[Red]\\("$"#,##0.00\\);','"$"#,##0.00_);[Red]\\("$"#,##0.00\\);"- "_)','"$"#,##0.00_);[Red]\\("$"#,##0.00\\);"-"','"$"* #,##0.00;[Red]\\ \\("$"* #,##0.00\\)','"$"\\ #,##0.00;[Red]"$"\\ \\-#,##0.00','"$"\\ #,##0.00_);[Red]\\("$"\\ #,##0.00\\)','"$"\\ \\ #,##0.00_);[Red]\\("$"\\ \\ #,##0.00\\)',"\\$#,##0.00;[Red]\\$\\(#,##0.00\\);\\-",'"$"0.0"MM"','"$"#,##0.0;[Red]\\("$"#,##0.0\\)','"$"#,##0.0;[Red]\\-"$"#,##0.0','"$"#,##0.0_);[Red]\\("$"#,##0.0\\)','"$"#,##0.0_);[Red]\\("$"#,##0.0\\);','"$"#,##0.0_);[Red]\\("$"#,##0.0\\);"- "_)','"$"\\ \\ #,##0.0_);[Red]\\("$"\\ \\ #,##0.0\\)','"$"0" / kW"','"$"0"MM"','"$"#,##0\\ "/MW"','"$"#,##0\\ "/MWh"','"$"#,##0\\ "/MWH"','"$"#,##0;[Red]"$"#,##0','"$"#,##0;[Red]\\-"$"#,##0','"$"#,##0_);[Red]\\("$"#,##0\\)','"$"#,##0_);[Red]\\("$"#,##0\\);"- "_)','"$"#,##0_);[Red]\\<"$"#,##0\\>','"$"\\ #,##0;[Red]\\-"$"\\ #,##0','"$"\\ #,##0_);[Red]\\("$"\\ #,##0\\)','"$"\\ \\ #,##0_);[Red]\\("$"\\ \\ #,##0\\)','"$"\\ \\ \\ #,##0_);[Red]"$"\\ \\ \\ \\(#,##0\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ #,##0_);[Red]"$"\\ \\ \\ \\(#,##0\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','_("$"* #,##0_);[Red]_("$"* \\(#,##0\\);_("$"* "-"??_);_(@_)','_("$"* #,##0_);[Red]_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',"[$CAD]\\ #,##0.000","[$CAD]\\ #,##0.000_);\\([$CAD]\\ #,##0.000\\)","[$R$ -416]#,##0_);\\([$R$ -416]#,##0\\)","[$R$ -416]#,##0.00_);\\([$R$ -416]#,##0.00\\)","[$R$-416]#,##0.0000_);[Red]\\([$R$-416]#,##0.0000\\)","[$R$-416]#,##0.000_);[Red]\\([$R$-416]#,##0.000\\)","[$R$-416]#,##0.00_);[Red]\\([$R$-416]#,##0.00\\)","[$R$-416]#,##0_);[Red]\\([$R$-416]#,##0\\)",'""#,##0','""#,##0;\\-""#,##0',"\\#,##0_);\\(\\#,##0\\)",'_ ""* #,##0_ ;_ ""* \\-#,##0_ ;_ ""* "-"_ ;_ @_ ','_(""* #,##0_);_(""* \\(#,##0\\);_(""* "-"_);_(@_)','_-""* #,##0_-;\\-""* #,##0_-;_-""* "-"_-;_-@_-','""#,##0.0',"\\#,##0.0_);\\(\\#,##0.0\\)",'""#,##0.00','""#,##0.00;\\-""#,##0.00',"\\#,##0.00_);\\(\\#,##0.00\\)",'_ ""* #,##0.00_ ;_ ""* \\-#,##0.00_ ;_ ""* "-"??_ ;_ @_ ','_(""* #,##0.00_);_(""* \\(#,##0.00\\);_(""* "-"??_);_(@_)','_-""* #,##0.00_-;\\-""* #,##0.00_-;_-""* "-"??_-;_-@_-',"\\#,##0.000_);\\(\\#,##0.000\\)","\\#,##0.0000_);\\(\\#,##0.0000\\)",'_-""* #,##0.0000_-;\\-""* #,##0.0000_-;_-""* "-"??_-;_-@_-','""#,##0.00;[Red]\\-""#,##0.00','""#,##0.00_);[Red]\\(""#,##0.00\\)',"\\#,##0.00_);[Red]\\(\\#,##0.00\\)","\\#,##0.0_);[Red]\\(\\#,##0.0\\)",'""#,##0;[Red]\\-""#,##0','""#,##0_);[Red]\\(""#,##0\\)',"\\#,##0_);[Red]\\(\\#,##0\\)","###\\ ###\\ ###\\ ###.0","###0","#,###.0#","#,###_);\\(#,##0\\);\\ \\-_ ","#,###___);\\(#,##0\\);\\ \\-\\ __","#,##0.##","#,##0.####","#,##0_)","#.0%","#0",'"#"\\ 0',"\\(0\\)",'0%;_("-"\\)',"0%\\ \\ ","0.",'0"  "',"0_)","0_;",'0" $/MWh"','#,##0""_);\\(#,##0""\\)','_ * #,##0_)""_ ;_ * \\(#,##0\\)""_ ;_ * "-"_)""_ ;_ @_ ','_ * #,##0_)__ ;_ * \\(#,##0\\)__ ;_ * "-"_)__ ;_ @_ ','#,##0""_);[Red]\\(#,##0""\\)',"#,###.00###","#,###.00###\\ \\ \\ ","#,##0.;\\-#,##0.","#,##0.0","#,##0.0___;","#,##0;\\(#,##0\\)","#,##0;\\(#,##0\\);\\-\\-","#,##0;\\-#,##0",'#,##0;\\-#,##0;"-"',"#,##0\\ ;\\(#,##0\\)","#,##0_ ;\\-#,##0\\ ","#,##0_ \\ ;\\(#,##0\\ \\ \\)","#,##0_);\\(#,##0\\);",'#,##0_);\\(#,##0\\);\\ "  -"',"#,##0_);\\(#,##0\\);\\ \\-\\ ","#,##0_);\\(#,##0\\);\\ \\-\\ \\ ","#,##0_);\\(#,##0\\);\\ \\-\\ \\ \\ \\ ","#,##0_);\\(#,##0\\);\\-","#,##0_);\\(#,##0\\);\\-\\ \\ ","#,##0_);\\(#,##0\\);\\-_)","#,##0_);\\(#,##0\\);\\-_)_ _ ","#,##0_);\\(#,##0\\);_ \\-\\ \\ ","#,##0_);\\(#,##0\\)\\ ;\\-_)_ _ ","#,##0_);\\(#,##0\\)\\-","#,##0_)_ ;\\(#,##0\\)\\ ;\\ \\-_ _)","#,##0_)_ ;\\(#,##0\\)\\ ;\\-_)_ _ ","#,##0___);\\(#,##0\\);\\ \\-\\ __","#,##0___);\\(#,##0\\);\\ \\-__\\ \\ ","#,##0___);\\(#,##0\\);___-\\ \\ ","#,##0___);\\(#,##0\\)_;\\ \\-__\\ \\ ","#,##0___);\\(#,##0\\)___;\\ \\-__\\ \\ ","#,##0_____);\\(#,##0\\);_____-\\ \\ ","#,##0_________);\\(#,##0\\);_________-\\ \\ ","#,#00",".00",'"**"_(* #,##0_);_(* \\(#,##0\\);_(* "-"??_);_(@_)','"*"_(* #,##0_);_(* \\(#,##0\\);_(* "-"??_);_(@_)','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;\\-"\\"#,##0',"\\(#,##0_)\\);\\(#,##0\\)",'_ * #,##0_ ;_ * "\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * \\-#,##0_ ;_ * "-"??_ ;_ @_ ','_ * #,##0_ ;_ * \\-#,##0_ ;_ * "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* \\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ',"_##,##0_);\\(#,##0\\);\\-_)_ _ ","_##,##0_);\\(#,##0\\)\\ ;\\-_)_ _ ","_(##0_);\\(##0\\)_ ;\\-_)_ _ ",'_(#,##0_);\\(#,##0\\);"-    "','_(* #,##0_);_(* \\(#,##0\\);_(* "-"???_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* "-"??_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* "-"?_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* ""??_);_(@_)','_-* #,##0_-;\\-* #,##0_-;_-* "-"??_-;_-@_-','_-* #,##0_-;\\-* #,##0_-;_-* "-"_-;_-@_-','_-* #,##0_-;_-* #,##0\\-;_-* "-"??_-;_-@_-','_-"\\"* #,##0_-;\\-"\\"* #,##0_-;_-"\\"* "-"_-;_-@_-',"0%\\-0%","0.0","0.0%",'0.0%;_(* "-"_)','0.0%;_("-"\\)','0.0%;_("-"_)','0.0%;_(\\ "-"_)',"0.0%\\ \\)",'0.0%\\-;_("-"_)','0.0"  "','0.0"%"','0.0_ "  "',"0.0_)","0.0_;","0.0____","0;\\-0;","0;\\-0;;","0;\\-0;;@\\ ","0_ ;\\-0\\ ","0_);\\(0\\)","00","###0_%_);\\(#,##0\\)_%;#,##0_%_);@_%_)","#,###.0_);\\(#,##0.0\\);\\ \\-\\ _ ","#,##0.00#","#,##0.00###","#,##0.00__;","#,##0_%_);\\(#,##0\\)_%;#,##0_%_);@_%_)","#,##0_);\\(#,##0\\);#,##0_);@_)",'"@ "\\&0.00%','"@ "0.00%','_(* #,##0_);_(* \\(#,##0\\);_(* "0"??_);_(@_)',"0%_);\\(0%\\);0%_);@_%_)","0.00#%",'0.00%;_(* "-"_)','0.00%;_("-"\\)',"0.00;;",'0.00"  "',"0.00_)","0_%_);\\(0\\)_%;0_%_);@_%_)","000","000#",'#,##0.00" $";\\-#,##0.00" $"',"#,##0.00\\ [$DM-407]","#,##0.00\\ [$EUR-407]",'#,##0.00" $";[Red]\\-#,##0.00" $"','#,##0.00""_);\\(#,##0.00""\\)','_ * #,##0.00_)""_ ;_ * \\(#,##0.00\\)""_ ;_ * "-"??_)""_ ;_ @_ ','_ * #,##0.00_)__ ;_ * \\(#,##0.00\\)__ ;_ * "-"??_)__ ;_ @_ ','#,##0.00""_);[Red]\\(#,##0.00""\\)',"##0.000","#,##0.0%_);\\(#,##0.0%\\);","#,##0.0_);\\(#,##0.0\\)","#,##0.0_);\\(#,##0.0\\);\\ \\-\\ \\ ","#,##0.0_);\\(#,##0.0\\);_ \\ \\-","#,##0.0____\\);\\(#,##0.0\\);___ \\-\\ \\ ","#,##0.0_______);\\(#,##0.0\\);______\\ \\-\\ \\ ","#,##0.0________\\);\\(#,##0.0\\);_______ \\-\\ \\ ","#,##0.0________\\);\\(#,##0.0\\);________\\ \\-\\ \\ ","#,##0.0_________);\\(#,##0.0\\);\\ \\-\\ \\ ","#,##0.0_________);\\(#,##0.0\\);________\\ \\-\\ \\ ","#,##0.000","#,##0.000___;",".0000",".0000%",'_(* #,##0.0_);_(* \\(#,##0.0\\);_(* "-"??_);_(@_)','_(* #,##0.0_);_(* \\(#,##0.0\\);_(* "-"?_);_(@_)','_(* #,##0.0_);_(* \\(#,##0.0\\);_(* "-"_);_(@_)','_-* #,##0.0_-;\\-* #,##0.0_-;_-* "-"??_-;_-@_-','_-* #,##0.0_-;\\-* #,##0.0_-;_-* "-"_-;_-@_-',"0.0%;\\(0.0\\)%;\\ \\-\\ \\ ",'0.0%;\\-0.0%;\\ "-"_%;@_%',"0.0%\\ ;\\(0.0\\)%\\ ;\\-\\ \\ \\ ","0.0%\\);\\(0.0\\)%;\\ \\-","0.0%_);\\(0.0%\\)","0.0%_);\\(0.0\\)%;\\ \\-","0.0%_;\\(0.0\\)%;\\ \\-\\ \\ \\ ","0.0_%;\\(0.0\\)%;\\ \\-\\ \\ \\ ","0.0_);\\(0.0\\)","0.000","0.000%",'0.000%;_("-"\\)',"0.000_)","0.000_;","0000","##0.000\\ \\","#,##0.00_);\\(#,##0.0\\)","#,##0.0000","#,##0.0000___;","0.0000","0.0000%",'0.0000%;_(* "-"_)','0.0000%;_("-"\\)','0.0000"  "',"0.0000\\ %","0.0000_)","00\\-000","00\\-000_)","00000","###0.00_);\\(#,##0.00\\)","#,##0.0%_);\\(#,##0.0%\\);0.0%_);@_%_)","#,##0.0_%_);\\(#,##0.0\\)_%;#,##0.0_%_);@_%_)","#,##0.0_);\\(#,##0.0\\);#,##0.0_);@_)","#,##0.00%_);\\(#,##0.00%\\)","#,##0.00;#,##0.00;","#,##0.00;\\(#,##0.00\\)","#,##0.00;\\(#,##0.00\\);\\-\\-","#,##0.00_);\\(#,##0.00\\);\\ \\-\\ ","#,##0.00_);\\(#,##0.00\\);\\-","#,##0.00_);\\(#,##0.00\\);\\-\\ \\ ","#,##0.00_);\\(#,##0.00\\);_ \\ \\-","#,##0.00_);\\(#,##0.00\\);_ \\-\\ \\ ","#,##0.00__\\);\\(#,##0.00\\);__\\ \\ \\-","#,##0.00___);\\(#,##0.00\\);___ \\ \\-","#,##0.00___);\\(#,##0.00_);\\ \\-\\ \\ \\ ","#,##0.00000","#,##0.00000___;",'"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\"\\-#,##0.00','"\\"#,##0.00;\\-"\\"#,##0.00','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * \\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* \\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"????_);_(@_)','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"?_);_(@_)','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"_);_(@_)','_-* #,##0.00_-;\\-* #,##0.00_-;_-* "-"??_-;_-@_-','_-* #,##0.00_-;\\-* #,##0.00_-;_-* "-"_-;_-@_-','_-* #,##0.00_-;_-* #,##0.00\\-;_-* "-"??_-;_-@_-','_-"\\"* #,##0.00_-;\\-"\\"* #,##0.00_-;_-"\\"* "-"??_-;_-@_-',"0.0%_);\\(0.0%\\);0.0%_);@_%_)","0.0\\%_);\\(0.0\\%\\);0.0\\%_);@_%_)","0.00%_);\\(0.00%\\)","0.00;\\-0.00;","0.00_);\\(0.00\\)","0.00000","0.00000%",'0.00000"  "',"0.00000_)","000000","#,###.000_);\\(#,##0.000\\);\\ \\-\\ _ ","#,##0.000000","0.000000","0.000000%","0.000000_)","#,##0.000;\\(#,##0.000\\)","#,##0.000;\\(#,##0.000\\);\\-\\-","#,##0.000_);\\(#,##0.000\\)","#,##0.000_);\\(#,##0.000\\);\\ \\-\\ \\ ","#,##0.000_);\\(#,##0.000\\);\\-","#,##0.000_);\\(#,##0.000\\);_ \\-\\ \\ ","#,##0.0000000",'_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"???_);_(@_)','_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"??_);_(@_)','_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"?_);_(@_)','_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"_);_(@_)','_-* #,##0.000_-;\\-* #,##0.000_-;_-* "-"??_-;_-@_-',"_00000000","0.000_);\\(0.000\\)","0.0000000","0.0000000%","0.0000000_)","0000\\ \\-\\ 0000","00000000","#,###.0000_);\\(#,##0.0000\\);\\ \\-\\ _ ","#,##0.00_%_);\\(#,##0.00\\)_%;#,##0.00_%_);@_%_)","#,##0.00000000","0.00%_);\\(0.00%\\);0.00%_);@_%_)","0.00000000","0.00000000%","0.00000000_)","000\\-00\\-0000","000000000","#,##0.0000;\\(#,##0.0000\\)","#,##0.0000;\\-#,##0.0000","#,##0.0000_);\\(#,##0.0000\\)","#,##0.0000_);\\(#,##0.0000\\);_ \\-\\ \\ ","#,##0.0000_);\\(#,##0.0000_)","#,##0.0000___);\\(#,##0.0000_);\\ \\-\\ \\ \\ ","#,##0.000000000","\\(000\\)000\\-0000",'_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"????_);_(@_)','_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"??_);_(@_)','_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"?_);_(@_)','_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"_);_(@_)','_-* #,##0.0000_-;\\-* #,##0.0000_-;_-* "-"??_-;_-@_-',"0.0000_);\\(0.0000\\)","0.000000000","0.000000000%","0.000000000_)","0000000000","#,###.00000_);\\(#,##0.00000\\);\\ \\-\\ _ ","#,##0.0000000000","0.0000000000","0.0000000000_)","#,##0.00000_);\\(#,##0.00000\\)","#,##0.00000000000",'_(* #,##0.00000_);_(* \\(#,##0.00000\\);_(* "-"?????_);_(@_)','_(* #,##0.00000_);_(* \\(#,##0.00000\\);_(* "-"??_);_(@_)','_(* #,##0.00000_);_(* \\(#,##0.00000\\);_(* "-"_);_(@_)','_-* #,##0.00000_-;\\-* #,##0.00000_-;_-* "-"??_-;_-@_-',"0.00000_);\\(0.00000\\)","0.00000000000","0.00000000000_)","#,###.000000_);\\(#,##0.000000\\);\\ \\-\\ _ ","0.000000000000","#,##0.000000_);\\(#,##0.000000\\)",'_(* #,##0.000000_);_(* \\(#,##0.000000\\);_(* "-"??_);_(@_)','0.000000%;\\-0.000000%;\\ "-"_%;@_%',"0.0000000000000","0.0000000000000_)","0.00000000000000%","#,##0.0000000_);\\(#,##0.0000000\\)",'_(* #,##0.0000000_);_(* \\(#,##0.0000000\\);_(* "-"??_);_(@_)',"0.0000000_);\\(0.0000000\\)","0.000000000000000%","0.0000000000000000","#,##0.00000000_);\\(#,##0.00000000\\)",'_(* #,##0.00000000_);_(* \\(#,##0.00000000\\);_(* "-"??_);_(@_)',"0.00000000000000000","0.00000000000000000%","0.000000000000000000","0.000000000000000000%","#,##0.000000000_);\\(#,##0.000000000\\)",'_(* #,##0.000000000_);_(* \\(#,##0.000000000\\);_(* "-"??_);_(@_)',"#,##0.00000000000000000000","#,##0.0000000000_);\\(#,##0.0000000000\\)",'_(* #,##0.0000000000_);_(* \\(#,##0.0000000000\\);_(* "-"_);_(@_)',"0.0000000000000000000000","0.0000000000000000000000%",'_(* #,##0.000000000000_);_(* \\(#,##0.000000000000\\);_(* "-"_);_(@_)',"0.0000000000000000000000000","0.00000000000000000000000000",'_(* #,##0.0000000000000_);_(* \\(#,##0.0000000000000\\);_(* "-"_);_(@_)',"0.000000000000000000000000000","0.0000000000000000000000000000",'_(* #,##0.00000000000000_);_(* \\(#,##0.00000000000000\\);_(* "-"??_);_(@_)','_(* #,##0.00000000000000_);_(* \\(#,##0.00000000000000\\);_(* "-"_);_(@_)',"0.000000000000000000000000000000","0.00000000000000000000000000000000","#,##0.0000000000000000_);\\(#,##0.0000000000000000\\)","0.000000000000000000000000000000000","0.0000000000000000000000000000000000","0.00000000000000000000000000000000000","#,##0.00000000000000000000_);[Red]\\(#,##0.00000000000000000000\\)","#,##0.0000000000000_);[Red]\\(#,##0.0000000000000\\)","#,##0.000000000000_);[Red]\\(#,##0.000000000000\\)","#,##0.00000000000_);[Red]\\(#,##0.00000000000\\)","#,##0.0000000000_);[Red]\\(#,##0.0000000000\\)","#,##0.00000000_);[Red]\\(#,##0.00000000\\)","#,##0.0000000_);[Red]\\(#,##0.0000000\\)","#,##0.000000_);[Red]\\(#,##0.000000\\)","0.000000\\x_);\\(0.000000\\x\\)","0.00000E+00","#,##0.00000_);[Red]\\(#,##0.00000\\)","0.00000_);[Red]\\(0.00000\\)","0.0000E+00","###0.0000_);[Red]\\(###0.0000\\)","#,##0.0000\\ ;[Red]\\(#,##0.0000\\)","#,##0.0000_ ;[Red]\\-#,##0.0000\\ ","#,##0.0000_);[Red]\\(#,##0.0000\\)","0.0000%;[Red]\\-0.0000%","0.0000%\\ ;[Red]\\(0.0000%\\)","0.0000;[Red]0.0000","0.0000_ ;[Red]\\-0.0000\\ ","0.0000_);[Red]\\(0.0000\\)","0.0000\\x_);\\(0.0000\\x\\)","0.000E+00","0.000E+00_)",'0.000" MWh/GJ"',"###0.000_);[Red]\\(###0.000\\)","#,##0.000;[Red]\\(#,##0.000\\)","#,##0.000;[Red]\\(#,##0.000\\);\\-","#,##0.000\\ ;[Red]\\(#,##0.000\\)","#,##0.000_);[Red]\\(#,##0.000\\)","0.000;[Red]0.000","0.000_);[Red]\\(0.000\\)","0.000_);[Red]\\-0.000_)","#,##0.0_%_);\\(#,##0.0\\)_%;[White]#,##0.0_%_);@_%_)",'0.00%" Capitalization Rate"','0.00%" Discount Rate"','_-* #,##0.00\\ "DM"_-;\\-* #,##0.00\\ "DM"_-;_-* "-"??\\ "DM"_-;_-@_-','_-* #,##0.00\\ _D_M_-;\\-* #,##0.00\\ _D_M_-;_-* "-"??\\ _D_M_-;_-@_-','#,##0.00" F"_);\\(#,##0.00" F"\\)','_-* #,##0.00\\ "F"_-;\\-* #,##0.00\\ "F"_-;_-* "-"??\\ "F"_-;_-@_-','_-* #,##0.00\\ _F_-;\\-* #,##0.00\\ _F_-;_-* "-"??\\ _F_-;_-@_-','0.00" GJ//MWh"','0.00" GJ/MWh"','0.00\\ "MW"','0.00%" of Avg LTD"','0.00%" of Sales"','0.00%" perpetual annual growth"','_-* #,##0.00\\ "Pts"_-;\\-* #,##0.00\\ "Pts"_-;_-* "-"??\\ "Pts"_-;_-@_-','_-* #,##0.00\\ _P_t_s_-;\\-* #,##0.00\\ _P_t_s_-;_-* "-"??\\ _P_t_s_-;_-@_-',"###0.00_);[Red]\\(###0.00\\)","#,##0.00%_);[Red]\\(#,##0.00%\\)","#,##0.00;[Red]#,##0.00",'#,##0.00;[Red]"-"#,##0.00',"#,##0.00;[Red]\\(#,##0.00\\)","#,##0.00;[Red]\\(#,##0.00\\);\\-","#,##0.00\\ ;[Red]\\(#,##0.00\\)","#,##0.00\\ \\);[Red]\\(#,##0.00\\)","#,##0.00_ ;[Red]\\-#,##0.00\\ ",'#,##0.00_);[Red]\\(#,##0.00\\);"-"','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\"\\-#,##0.00','"\\"#,##0.00;[Red]\\-"\\"#,##0.00','_(* #,##0.00_);[Red]_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',"0.00%;[Red]\\(0.00%\\)","0.00%\\ ;[Red]\\(0.00%\\)","0.00%\\ ;[Red]\\(0.00%\\);\\-","0.00;[Red]0.00","0.00_ ;[Red]\\-0.00\\ ","0.00_);[Red]\\(0.00\\)","0.00_);[Red]\\(0.00\\);;","#,##0.00_);[Red]\\(#,##0.00\\)*1000","0.00\\x",'_(* #,##0.00\\x\\ \\ ;_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',"0.00\\x_);\\(0.00\\x\\)","_(##0_);\\(##0\\)_1;\\-_)_ _ ",'""0.0%" --\x3e 61.5% of Sales 1st 5 yrs.; steady state thereafter"','00\\ "Coal Upgrade"',"0.0E+00",'0.0" GJ/MWh"','00\\ "Hydro"','00\\ "Incremental"','0.0" mmbtu//MWh"','0.0%" of beg. Net PPE + Intgble Amort."','0.0%" of Sales"','0.0%" of Total Assets"',"#,##0.0_);[Red]\\(#,##0\\)","###0.0_);[Red]\\(###0.0\\)","#,##0.0;[Red]\\(#,##0.0\\)","#,##0.0;[Red]\\(#,##0.0\\);\\-","#,##0.0;[Red]\\-#,##0.0","#,##0.0\\ ;[Red]\\(#,##0.0\\)","#,##0.0_ ;[Red]\\-#,##0.0\\ ","#,##0.0_);[Red]\\(#,##0.0\\)","#,##0.0_);[Red]\\(#,##0.0\\);","#,##0.0_);[Red]\\(#,##0.0\\);\\-","0.0%;[Red]\\(0.0%\\)","0.0%\\ ;[Red]\\(0.0%\\)","0.0%_);[Red]\\(0.0%\\)","0.0_);[Red]\\(0.0\\)","0.0_);[Red]\\-0.0_)","#,##0.0_);[Red]\\(#,##0.0\\)*1000",'0.0"x"','0.0\\ "x"',"0.0\\x","#,##0.0\\x_);\\(#,##0.0\\x\\)","#,##0.0\\x_);\\(#,##0.0\\x\\);",'0.0\\x_)_);"NM"_x_)_);0.0\\x_)_);@_%_)',"#,##0.0\\x_);[Red]\\(#,##0.0\\x\\);",'0%\\ "Beg. Net PPE + Intangibles"','0" Days"','_-* #,##0\\ "DM"_-;\\-* #,##0\\ "DM"_-;_-* "-"\\ "DM"_-;_-@_-','_-* #,##0\\ _D_M_-;\\-* #,##0\\ _D_M_-;_-* "-"\\ _D_M_-;_-@_-',"#,##0_e","0.E+00","0E+00","0\\ \\f",'_-* #,##0\\ "F"_-;\\-* #,##0\\ "F"_-;_-* "-"\\ "F"_-;_-@_-','_-* #,##0\\ _F_-;\\-* #,##0\\ _F_-;_-* "-"\\ _F_-;_-@_-','#,##0" GJ/D"','0\\ "Hydro"','0" / kW"','0\\ "Last Year"','#,##0" MMBTUs";\\-#,##0" MMBTUs"','0" months"','0\\ "mos"','0" MW"','#,##0" MWh";\\-#,##0" MWh"','#,##0" MWh/D"','#,##0_)"MWH";[Red]\\("$"#,##0\\);"- "_)','#,##0_)"mW";[Red]\\("$"#,##0\\);"- "_)','0\\ " of"','0%" of Sales"','_-* #,##0\\ "Pts"_-;\\-* #,##0\\ "Pts"_-;_-* "-"\\ "Pts"_-;_-@_-','_-* #,##0\\ _P_t_s_-;\\-* #,##0\\ _P_t_s_-;_-* "-"\\ _P_t_s_-;_-@_-',"#,##0_r_)",'#,##0"r"_)',"###0_);[Red]\\(#,##0\\)","##,##0;[Red]\\(##,##0\\)","#,##0;[Red]#,##0",'#,##0;[Red]"-"#,##0',"#,##0;[Red]\\(#,##0\\)","#,##0;[Red]\\(#,##0\\);\\-","#,##0;[Red]\\-#,##0","#,##0;[Red]\\-#,##0;\\-","#,##0\\ ;[Red]\\(#,##0\\)","#,##0_ ;[Red]\\-#,##0\\ ","#,##0_);[Red]\\(#,##0\\);","#,##0_);[Red]\\(#,##0\\);;",'#,##0_);[Red]\\(#,##0\\);"-   "','#,##0_);[Red]\\(#,##0\\);"- "_)','#,##0_);[Red]\\(#,##0\\);"-"',"#,##0_);[Red]\\(#,##0\\);\\-","#,##0_);[Red]\\<#,##0\\>","#.0,,;[Red]\\(#.0,,\\)",'"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\"\\-#,##0','"\\"#,##0;[Red]\\-"\\"#,##0','_(* #,##0_);[Red]* \\(#,##0\\);_(* "-"_);_(@_)','_(* #,##0_);[Red]\\(* \\(#,##0\\);_(* "-"_);_(@_)',"0%\\ ;[Red]\\(0%\\)",'0%\\ ;[Red]\\(0%\\)\\ ;"-  "',"0%\\);[Red]\\(0%\\)","0%_);[Red]\\(0%\\)","0;[Red]0","0_);[Red]\\(0\\)","0_);[Red]\\(0\\);;","0_);[Red]\\-0_)","#,##0_);[Red]\\(#,##0,\\)*1000",'0%" Tax Rate"','0\\ "Wind"','0\\ "WTG"','0" Year"','0" years"',"0\\ \\y\\e\\a\\r\\s",'0"  Years"',"\\10000000","#?/12","#\\ ?/32","#\\ ?/32;[Red]\\(#?/32\\)","#\\ ?/32;[Red]\\(#\\ ?/32\\)","#\\ ?/4","#\\ ?/64","[<=9999999]###\\-####;\\(###\\)\\ ###\\-####",'"and"\\ 0\\ "--\x3e6-year average"','"As of "\\ mm/dd/yy','"As of "mmmm\\ dd\\,\\ yyyy','"As of"\\ mmmm\\ dd\\,\\ yyyy','"As of "mmmm\\ d\\,\\ yyyy','"Ave. Debt Bal. * "0.00%" cost * (1-t)"','#\\ "BP"','_(\\C"$"* #,##0.00000_);_(\\C"$"* \\(#,##0.00000\\);_(\\C"$"* "0"_);_(@_)','\\C"$"#,##0_);\\(\\C"$"#,##0\\)','_(\\C"$"* #,##0_);_(\\C"$"* \\(#,##0\\);_(\\C"$"* "0"_);_(@_)','\\C"$"\\ #,##0\\);[Red]\\(\\C"$"\\ #,##0\\)','"Canada Cash Desk Economics (CDN$) for"\\ mmm\\-yy\\ "as of:"','"Change since "mmmm\\ dd\\,\\ yyyy','"Changes Since "mmmm\\ dd\\,\\ yyyy','_ "CHF"\\ * #,##0.00_ ;_ "CHF"\\ * \\-#,##0.00_ ;_ "CHF"\\ * "-"??_ ;_ @_ ','"Converted at "_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"??_);_(@_)','"Cr$"\\ #,##0_);\\("Cr$"\\ #,##0\\)','"Current Day ("mm/dd/yy") Theoretical Sensitivities"\\ ','"Curves Loaded for"\\ \\ mm/dd/yy','"DATE:"\\ dd\\-mmm\\-yy','"DATE="mm/dd/yy','#\\ "Day"',"dd","ddd","dddd","ddd\\ \\-\\ dd","ddd\\-dd","dddd\\ d\\ mmmm\\ yyyy","ddd\\-dd\\-mmm\\-yy","ddd\\ dd\\ mmm\\ yyyy\\ hh:mm","dd\\-ddd\\-yy","dddd\\ mmmm\\ dd\\ ","dddd\\,\\ mmmm\\ dd\\,\\ yyyy","dddd\\,\\ mmmm\\ d\\,\\ yyyy","dddd\\,\\ mmmm\\,\\ d\\,\\ yyyy","dddd\\,mmmm\\,d\\,yyyy","ddd\\,\\ mmm\\ d","ddd\\-mmm\\-dd","ddd\\ yy/mm/dd","dd\\-mmm_)","dd\\-mmm\\-yy","dd\\-mmm\\-yy_)","dd\\-mmm\\-yy_);[Red]dd\\-mmm\\-yy_)","dd\\ mmm\\ yyyy","dd\\-mmm\\-yyyy","ddmmyy",'"Detail of New Transactions By Originator - "mmmm\\,\\ yyyy','"Discount Rate of"\\ 0.00%',"d\\-mmm\\,ddd",'d\\-mmm\\-yy\\ "Cycle 6"',"d/mmm/yyyy","d\\-mmm\\-yyyy",'d\\-mmm\\-yyyy\\ "Cycle 6"',"d/m/yy\\ h:mm","d\\.m\\.yy\\ h:mm",'"down"\\ 0.0','"DR="0.00%','"Effective Date: "\\ dd\\-mmm\\-yyyy','"EQUITY CASH FLOW PV AT "#0.00"%"','"First Period Days =  "\\ 0','"Fuel Cost:"\\ 0.00',"General\\ ","General_)","General;[Red]\\-General","General_);[Red]\\-General_)","h","hh:mm","hh:mm\\ AM/PM","hh:mm\\ AM/PM_)","hh:mm:ss","[h]:mm",'h:mm:ss"\\""\\""\\""\\"\\ AM/PM','"Include";;"Exclude"','" K-"#','_ "kr"\\ * #,##0.00_ ;_ "kr"\\ * \\-#,##0.00_ ;_ "kr"\\ * "-"??_ ;_ @_ ','_ "kr"\\ * #,##0_ ;_ "kr"\\ * \\-#,##0_ ;_ "kr"\\ * "-"_ ;_ @_ ','"LTD Through "mmmm\\ dd\\,\\ yyyy','##"m"',"m","m/d","m/dd/yyyy","m/d/yy","m/d/yy_%_)","m\\-d\\-yy","m/d/yy\\ h:mm","m/d/yy\\ h:mm\\ AM/PM","m\\/d\\/yyyy","m/d/yyyy\\ h:mm:ss","mm","mm/dd","mmdd","mm/dd/ddd","mm/dd/yy","mm/dd/yy_)","mm\\-dd\\-yy","mmddyy","mm/dd/yy\\ hh:mm","mm\\-dd\\-yy\\ hmm\\ AM/PM","mm/dd/yyyy",'mm"/"dd"/"yyyy',"mm\\-dd\\-yyyy","mm\\-dd\\-yyyy\\ ","mm\\/dd\\/yyyy","mm/dd/yyyy\\ hh:mm\\ AM/PM","mm/dd/yyyy\\ hh:mmAM/PM","mm\\-dd\\-yyyy\\ \\ hh:mm:ss\\ AM/PM\\ \\ ","mm\\-dd\\-yyyy\\ hh:mm:ss\\ AM/PM","mmm","mmm\\ d","mmm\\-dd","mmm\\-dd\\ \\ \\ h:mm\\ AM/PM","mmm\\ dd\\ yy_;","mmm\\-dd\\-yy","mmm\\-dd\\-yy\\ h:mm\\ AM/PM","mmm\\ dd\\ yyyy;","mmmddyyyy","mmm\\ dd\\ yyyy\\ hh:mm\\ AM/PM","mmm\\-d\\-yy","mmm\\-d\\-yy\\ ","mmm\\ d\\,\\ yyyy","mmmm","mmmm\\ d",'mmmm\\ dd","\\ yyyy',"mmmm\\ dd\\,\\ yyyy","mmmm\\ dd\\,\\ yyyy\\ \\ h:mm\\ AM/PM","\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ mmmm\\ d\\,\\ yyyy","mmmm\\ d\\,\\ yyyy","mmmmm","mm\\-mmm\\-yy","mmmm\\-yy","mmmm\\ yyyy","mmmm\\-yyyy","mmm\\ yy","mmm\\-yy_)","mmm\\.yy","mmm\\ yyyy","mmm\\,\\ yyyy","mmm\\-yyyy","mmm\\-yyyy_)","mm/yy","mm\\-yy","mm/yyyy","mm\\-yyyy",'"MTD Through "mmmm\\ dd\\,\\ yyyy',"m/yy","m\\/yy","m/yyyy","\\n\\o\\t\\ \\Q0",'"On";;"Off"','_("P"* #,##0.00_);_("P"* \\(#,##0.00\\);_("P"* "-"??_);_(@_)','_("P"\\ * #,##0.00_);_("P"\\ * \\(#,##0.00\\);_("P"\\ * "-"??_);_(@_)','_("P"* #,##0_);_("P"* \\(#,##0\\);_("P"* "-"_);_(@_)','_("P"\\ * #,##0_);_("P"\\ * \\(#,##0\\);_("P"\\ * "-"_);_(@_)','"Pmts per Year = "0',"\\P\\P\\ #,##0.00000_);\\(\\P\\P\\ #,##0.00000_)",'_("Ps. "* #,##0.00_);_("Ps. "* \\(#,##0.00\\);_("Ps. "* "-"??_);_(@_)','"Ps. "#,##0.00_);[Red]\\("Ps. "#,##0.00\\)','_("Ps. "* #,##0_);_("Ps. "* \\(#,##0\\);_("Ps. "* "-"_);_(@_)',"\\Q\\ 0","\\Q0",'_("R$"* #,##0.00_);_("R$"* \\(#,##0.00\\);_("R$"* "-"??_);_(@_)','_("R$"* #,##0_);_("R$"* \\(#,##0\\);_("R$"* "-"_);_(@_)',"[Red]#,##0;\\-#,##0","[Red]#,##0.0;[Blue]\\<#,##0.0\\>",'_-"Rs."* #,##0.00_-;\\-"Rs."* #,##0.00_-;_-"Rs."* "-"??_-;_-@_-','_-"Rs."* #,##0_-;\\-"Rs."* #,##0_-;_-"Rs."* "-"_-;_-@_-','_-"S/."\\ * #,##0.00_-;\\-"S/."\\ * #,##0.00_-;_-"S/."\\ * "-"??_-;_-@_-','_-"S/."\\ * #,##0_-;\\-"S/."\\ * #,##0_-;_-"S/."\\ * "-"_-;_-@_-','"Sales growth declines from "0.0%" to 10% in yr 5"','"Sensitivity Change from Prior Day ("mm/dd/yy")"','_ "SFr."* #,##0.00_ ;_ "SFr."* \\-#,##0.00_ ;_ "SFr."* "-"??_ ;_ @_ ','"SFr."#,##0;[Red]"SFr."\\-#,##0','"SFr."#,##0;"SFr."\\-#,##0','_ "SFr."* #,##0_ ;_ "SFr."* \\-#,##0_ ;_ "SFr."* "-"_ ;_ @_ ','"Stmt Date "m/d/yy','"Through "mmmm\\ dd\\,\\ yyyy','_(\\U"$"* #,##0_);_(\\U"$"* \\(#,##0\\);_(\\U"$"* "0"_);_(@_)','"up"\\ 0.0','"VS"\\ mmm\\-yy',"\\W#,##0","\\W#,##0.0",'"Wire Date "m/d/yy','"with "0%" tax"',"#\\x","\\X",'"Yes";;"No"','"Yes"_%_);;"No"_%_)','"YTD Through "mmmm\\ dd\\,\\ yyyy',"yyddmm","yy/m","yy/mm","yy\\-mm\\-dd","yymmdd",'yy"\\""\\""\\"\\-mm"\\""\\""\\"\\-dd"\\""\\""\\""\\"\\ h:mm',"yy\\ mmm","yy\\ mmm\\ dd","yyyy","yyyyddmm","yyyy/mm","yyyy\\.mm\\.dd","yyyy\\-mm\\-dd\\ hh:mm","yyyy/mm/dd\\ hh:mm:ss:ss","yyyy\\-mm\\-dd\\ hh:mm:ss\\.ss","yyyy\\ \\-\\ mmm","yyyy\\-mmm","yyyy\\-mmm\\-dd","yyyymmmdd","yyyy\\ mmmm"]},43260:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertCommas=t.convertNumberShape=t.convertDigitsShape=void 0;const n=r(19181),i=r(63224),o=r(16322),a=n.__importStar(r(8600)),s=r(96705),{codePointDigitZero:l,codePointDigitNine:u,codePointDigitOne:c}=a,d={[s.NumberShape.ArabicIndic]:{zero:1632,one:1633},[s.NumberShape.ExtendedArabicIndic]:{zero:1776,one:1777},[s.NumberShape.Devanagari]:{zero:2406,one:2407},[s.NumberShape.Bengali]:{zero:2534,one:2535},[s.NumberShape.Gurmukhi]:{zero:2662,one:2663},[s.NumberShape.Gujarati]:{zero:2790,one:2791},[s.NumberShape.Oriya]:{zero:2918,one:2919},[s.NumberShape.Tamil]:{zero:48,one:3047},[s.NumberShape.Telugu]:{zero:3174,one:3175},[s.NumberShape.Kannada]:{zero:3302,one:3303},[s.NumberShape.Malayalam]:{zero:3430,one:3431},[s.NumberShape.Thai]:{zero:3664,one:3665},[s.NumberShape.Lao]:{zero:3792,one:3793},[s.NumberShape.Tibetan]:{zero:3872,one:3873},[s.NumberShape.Myanmar]:{zero:4160,one:4161},[s.NumberShape.Ethiopic]:{zero:48,one:4969},[s.NumberShape.Khmer]:{zero:6112,one:6113},[s.NumberShape.Mongolian]:{zero:6160,one:6161}},m={[s.NumberShape.Japanese1]:{digits:[12295,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806,langId:"Japanese",dbnum:1},[s.NumberShape.Japanese2]:{digits:[12295,22769,24336,21442,22235,20237,20845,19971,20843,20061],ten:25342,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"Japanese",dbnum:2},[s.NumberShape.Japanese3]:{digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806,langId:"Japanese",dbnum:3},[s.NumberShape.Korean1]:{digits:[65296,19968,20108,19977,22235,20116,63953,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806,langId:"Korean",dbnum:1},[s.NumberShape.Korean2]:{digits:[63922,22777,36019,63851,22235,20237,63953,19971,20843,20061],ten:63859,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"Korean",dbnum:2},[s.NumberShape.Korean3]:{digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806,langId:"Korean",dbnum:3},[s.NumberShape.Korean4]:{digits:[50689,51068,51060,49340,49324,50724,50977,52832,54036,44396],ten:49901,hundred:48177,thousand:52380,tenThousand:47564,hundredMillion:50613,trillion:51312,langId:"Korean",dbnum:4},[s.NumberShape.ChineseSimp1]:{digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806,langId:"ChineseSimp",dbnum:1},[s.NumberShape.ChineseSimp2]:{digits:[38646,22777,36144,21441,32902,20237,38470,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:19975,hundredMillion:20159,trillion:20806,langId:"ChineseSimp",dbnum:2},[s.NumberShape.ChineseSimp3]:{digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806,langId:"ChineseSimp",dbnum:3},[s.NumberShape.ChineseTrad1]:{digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"ChineseTrad",dbnum:1},[s.NumberShape.ChineseTrad2]:{digits:[38646,22777,36019,21443,32902,20237,38520,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"ChineseTrad",dbnum:2},[s.NumberShape.ChineseTrad3]:{digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"ChineseTrad",dbnum:3}};function g(e,t){if(t===s.NumberShape.ASCII)return e;switch(t){case s.NumberShape.ArabicIndic:case s.NumberShape.ExtendedArabicIndic:case s.NumberShape.Devanagari:case s.NumberShape.Bengali:case s.NumberShape.Gurmukhi:case s.NumberShape.Gujarati:case s.NumberShape.Oriya:case s.NumberShape.Tamil:case s.NumberShape.Telugu:case s.NumberShape.Kannada:case s.NumberShape.Malayalam:case s.NumberShape.Thai:case s.NumberShape.Lao:case s.NumberShape.Tibetan:case s.NumberShape.Myanmar:case s.NumberShape.Ethiopic:case s.NumberShape.Khmer:case s.NumberShape.Mongolian:{let r="";const n=d[t];for(let t=0;t<e.length;t+=1){const a=e.charCodeAt(t);(0,i.assertTrue)("calc.numfmt.convertDigitsShape",l<=a&&a<=u),r+=a===l?(0,o.stringFromCodePoint)(n.zero):(0,o.stringFromCodePoint)(n.one+(a-c))}return r}case s.NumberShape.ChineseTrad1:case s.NumberShape.ChineseTrad2:case s.NumberShape.ChineseTrad3:case s.NumberShape.ChineseSimp1:case s.NumberShape.ChineseSimp2:case s.NumberShape.ChineseSimp3:case s.NumberShape.Japanese1:case s.NumberShape.Japanese2:case s.NumberShape.Japanese3:case s.NumberShape.Korean1:case s.NumberShape.Korean2:case s.NumberShape.Korean3:case s.NumberShape.Korean4:{let r="";const n=m[t];for(let t=0;t<e.length;t+=1)r+=p(n,e.charCodeAt(t));return r}}}function p(e,t){return(0,i.assertTrue)("calc.numfmt.ideographicDigit",l<=t&&t<=u),(0,o.stringFromCodePoint)(e.digits[t-l])}var h;function f(e,t){switch(t){case h.Ten:return(0,o.stringFromCodePoint)(e.ten);case h.Hundred:return(0,o.stringFromCodePoint)(e.hundred);case h.Thousand:return(0,o.stringFromCodePoint)(e.thousand);case h.TenThousand:return(0,o.stringFromCodePoint)(e.tenThousand);case h.HundredMillion:return(0,o.stringFromCodePoint)(e.hundredMillion);case h.Trillion:return(0,o.stringFromCodePoint)(e.trillion);default:return(0,i.assertFalse)("calc.numfmt.ideographicRank")}}t.convertDigitsShape=g,function(e){e[e.Ten=10]="Ten",e[e.Hundred=11]="Hundred",e[e.Thousand=12]="Thousand",e[e.TenThousand=13]="TenThousand",e[e.HundredMillion=14]="HundredMillion",e[e.Trillion=15]="Trillion"}(h||(h={})),t.convertNumberShape=function({decimalSeparator:e},t,r){if(r===s.NumberShape.ASCII)return t;switch(r){case s.NumberShape.ArabicIndic:case s.NumberShape.ExtendedArabicIndic:case s.NumberShape.Devanagari:case s.NumberShape.Bengali:case s.NumberShape.Gurmukhi:case s.NumberShape.Gujarati:case s.NumberShape.Oriya:case s.NumberShape.Tamil:case s.NumberShape.Telugu:case s.NumberShape.Kannada:case s.NumberShape.Malayalam:case s.NumberShape.Thai:case s.NumberShape.Lao:case s.NumberShape.Tibetan:case s.NumberShape.Myanmar:case s.NumberShape.Ethiopic:case s.NumberShape.Khmer:case s.NumberShape.Mongolian:{const n=t.indexOf(e);return g(t.substring(0,n<0?void 0:n),r)+(n<0?"":e)+(n<0?"":g(t.substring(n+e.length),r))}case s.NumberShape.ChineseTrad1:case s.NumberShape.ChineseTrad2:case s.NumberShape.ChineseTrad3:case s.NumberShape.ChineseSimp1:case s.NumberShape.ChineseSimp2:case s.NumberShape.ChineseSimp3:case s.NumberShape.Japanese1:case s.NumberShape.Japanese2:case s.NumberShape.Japanese3:case s.NumberShape.Korean1:case s.NumberShape.Korean2:case s.NumberShape.Korean3:case s.NumberShape.Korean4:{const n=m[r],o="ChineseSimp"===n.langId||"ChineseTrad"===n.langId,a=2===n.dbnum||"Korean"===n.langId&&(1===n.dbnum||4===n.dbnum),s=t.indexOf(e);let u=0,d=s<0?t.length:s,g="";if(d>12){if(d>16)for(;12<d;d--,u++)g+=p(n,t.charCodeAt(u));else{let e=16,r=h.Thousand,i=!1;do{if(e>d){e--,r--;continue}const s=t.charCodeAt(u);s!==l?((o||a||s>c||e%4==1)&&(o&&i&&(g+=p(n,l),i=!1),g+=p(n,s)),r>=h.Ten&&(g+=f(n,r))):i=!0,e--,r--,d--,u++}while(e>12)}g+=f(n,h.Trillion)}{let e=12;do{let r=h.Thousand,i=!1,s=!1;do{if(e>d){e--,r--;continue}const m=t.charCodeAt(u);m!==l||0===g.length?((o||a||m>c||e%4==1)&&(o&&s&&(g+=p(n,l),s=!1),g+=p(n,m)),r>=h.Ten&&(g+=f(n,r)),i=!0):s=!0,e--,r--,d--,u++}while(e%4);i&&d/4!=0&&(8===d?g+=f(n,h.HundredMillion):4===d&&(g+=f(n,h.TenThousand)))}while(d>0)}if(u!==t.length)for((0,i.assertTrue)("calc.numfmt.convertNumberShape",s>=0&&u===s),g+=e,u=s+e.length;u<t.length;u++)g+=p(n,t.charCodeAt(u));return g}default:return(0,i.assertNever)("calc.numfmt.convertNumberShape",r)}},t.insertCommas=function(e,t,r){if(""===t)return"";const n=(0,o.countCodePoints)(t,0,t.length);let i="";for(let a=0,s=0;a<t.length;){const l=(0,o.stringCodePointAt)(t,a),u=(0,o.numCodeUnits)(l);i+=t.substring(a,a+u),a+=u,s+=1,e.isThousandsPosition(r+(n-s))&&(i+=e.thousandsSeparator)}return i}},91895:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toXLNumber=t.applyValueEdit=t.getValueEditOperKind=t.renderFormat=t.getFormatString=t.initUtilGlobals=void 0;const n=r(50026),i=r(56331),o=r(96705),a=r(84516),s=r(63224),l=r(35759),u=r(71571),c={getKnownFormat:()=>(0,s.assertFalse)("calc.numfmt: default getKnownFormat"),getIformat:()=>(0,s.assertFalse)("calc.numfmt: default getIformat"),getFormatString:()=>(0,s.assertFalse)("calc.numfmt: default getFormatString")};t.initUtilGlobals=function(e){var t,r,n,i,o,a;return{config:e.config,getKnownFormat:null!==(r=null===(t=e.getKnownFormat)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:c.getKnownFormat,getIformat:null!==(i=null===(n=e.getIformat)||void 0===n?void 0:n.bind(e))&&void 0!==i?i:c.getIformat,getFormatString:null!==(a=null===(o=e.getFormatString)||void 0===o?void 0:o.bind(e))&&void 0!==a?a:c.getFormatString}},t.getFormatString=function(e,t,r,n,i){const o=t.getFormatString(r,n);return(0,a.isSuccess)(o)?void 0!==o.value?t.getIformat(r,o.value):e.createFormat(n,i):o},t.renderFormat=function(e,t,r){const o=(0,n.isStringOper)(r)?i.Clip.None:i.Clip.All,s=t.apply(r,i.Alignment.Right,o,!0);if(!(0,a.isSuccess)(s))return s;const l=e.renderValue(s.value,i.renderInfiniteWidth);return(0,a.isSuccess)(l)?(0,i.isHashesValue)(l.value)?(0,a.success)(l.value.units):(0,a.success)((0,i.renderedValueToString)(l.value)):l},t.getValueEditOperKind=function(e){return e.value.kind},t.applyValueEdit=function(e,t,r,n){let s=r;if(n.kind===i.EditKind.Number&&n.format!==o.KnownFormat.General){const i=n.format,o="string"==typeof i?i:(0,u.getKnownFormat)(t,i),c="string"!=typeof i,d=e.createFormat(o,c);if(!(0,a.isSuccess)(d))return d;const m=d.value;(0,l.shouldInstallFormat)(m,r)&&(s=m)}return e.applyFormat(s,n.value,!0)},t.toXLNumber=function(e,t,r){const n=t.parseGeneral(r,!1,!0,i.GetTimeKind.NonVolatile);return(0,a.isSuccess)(n)?null==n.value?(0,a.failure)(null):(0,a.success)(e.toNumber(n.value.value)):n}},98448:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PackageName=void 0,t.PackageName="excel-online-calc-recalc"},23406:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAnalyzer=void 0;const n=r(37883);t.createAnalyzer=n.analyzeService.createAnalyzer},76125:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.summarizeFormulaDiagnostics=t.diagnostics=t.createAnalyzeGlobals=t.analyzeLocalsName=t.analyzeLocalsGrid=void 0;const n=r(37883);t.analyzeLocalsGrid=n.analyzeServiceTypes.analyzeLocalsGrid,t.analyzeLocalsName=n.analyzeServiceTypes.analyzeLocalsName,t.createAnalyzeGlobals=n.analyzeServiceTypes.createAnalyzeGlobals,t.diagnostics=n.analyzeServiceTypes.diagnostics,t.summarizeFormulaDiagnostics=n.analyzeServiceTypes.summarizeFormulaDiagnostics},37616:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;const n=r(57777);t.anonymize=n.anonymizer.anonymize,t.anonymizeFormulaString=n.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=n.anonymizer.anonymizeMagnitude,t.kindAnonymizers=n.anonymizer.kindAnonymizers},64250:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transposeSparseArray2D=t.transposeArray2D=t.sparseArray2DTo1D=t.singletonArray2D=t.rowArray2D=t.jaggedArray=t.constantArray2D=t.constantArray=t.colArray2D=t.broadcastArray2D=t.broadcastArray=t.array2DToJaggedArray=t.array2DForall2=t.array2DForall=t.StrictSparseArray2D=t.StrictArray2D=t.NonstrictSparseArray2D=t.NonstrictArray2D=void 0;const n=r(57777);t.NonstrictArray2D=n.arrayUtils.NonstrictArray2D,t.NonstrictSparseArray2D=n.arrayUtils.NonstrictSparseArray2D,t.StrictArray2D=n.arrayUtils.StrictArray2D,t.StrictSparseArray2D=n.arrayUtils.StrictSparseArray2D,t.array2DForall=n.arrayUtils.array2DForall,t.array2DForall2=n.arrayUtils.array2DForall2,t.array2DToJaggedArray=n.arrayUtils.array2DToJaggedArray,t.broadcastArray=n.arrayUtils.broadcastArray,t.broadcastArray2D=n.arrayUtils.broadcastArray2D,t.colArray2D=n.arrayUtils.colArray2D,t.constantArray=n.arrayUtils.constantArray,t.constantArray2D=n.arrayUtils.constantArray2D,t.jaggedArray=n.arrayUtils.jaggedArray,t.rowArray2D=n.arrayUtils.rowArray2D,t.singletonArray2D=n.arrayUtils.singletonArray2D,t.sparseArray2DTo1D=n.arrayUtils.sparseArray2DTo1D,t.transposeArray2D=n.arrayUtils.transposeArray2D,t.transposeSparseArray2D=n.arrayUtils.transposeSparseArray2D},88065:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;const n=r(57777);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},34791:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointExclamationMark=t.codePointEuroSign=t.codePointEqualsSign=t.codePointDoubleQuote=t.codePointDollarSign=t.codePointDigitZero=t.codePointDigitTwo=t.codePointDigitThree=t.codePointDigitSix=t.codePointDigitSeven=t.codePointDigitOne=t.codePointDigitNine=t.codePointDigitFour=t.codePointDigitFive=t.codePointDigitEight=t.codePointComma=t.codePointColon=t.codePointCircumflexAccent=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointCR=t.codePointBacktick=t.codePointBackslash=t.codePointAtSign=t.codePointAsterisk=t.codePointAmpersand=void 0,t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointSlash=t.codePointSingleQuote=t.codePointSemicolon=t.codePointRightSquareBracket=t.codePointRightParen=t.codePointRightCurlyBracket=t.codePointQuestionMark=t.codePointPlusSign=t.codePointPipe=t.codePointPercentSign=t.codePointMinusSign=t.codePointLessThanSign=t.codePointLeftSquareBracket=t.codePointLeftParen=t.codePointLeftCurlyBracket=t.codePointLF=t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointHash=t.codePointGreaterThanSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitZero=t.codePointFullwidthDigitNine=t.codePointFullStop=void 0,t.codePointUnderscore=t.codePointTilde=t.codePointThaiDigitZero=t.codePointThaiDigitNine=t.codePointTab=t.codePointSpace=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=void 0;const n=r(57777);t.codePointAmpersand=n.codePoint.codePointAmpersand,t.codePointAsterisk=n.codePoint.codePointAsterisk,t.codePointAtSign=n.codePoint.codePointAtSign,t.codePointBackslash=n.codePoint.codePointBackslash,t.codePointBacktick=n.codePoint.codePointBacktick,t.codePointCR=n.codePoint.codePointCR,t.codePointCapitalA=n.codePoint.codePointCapitalA,t.codePointCapitalB=n.codePoint.codePointCapitalB,t.codePointCapitalC=n.codePoint.codePointCapitalC,t.codePointCapitalD=n.codePoint.codePointCapitalD,t.codePointCapitalE=n.codePoint.codePointCapitalE,t.codePointCapitalF=n.codePoint.codePointCapitalF,t.codePointCapitalG=n.codePoint.codePointCapitalG,t.codePointCapitalH=n.codePoint.codePointCapitalH,t.codePointCapitalI=n.codePoint.codePointCapitalI,t.codePointCapitalJ=n.codePoint.codePointCapitalJ,t.codePointCapitalK=n.codePoint.codePointCapitalK,t.codePointCapitalL=n.codePoint.codePointCapitalL,t.codePointCapitalM=n.codePoint.codePointCapitalM,t.codePointCapitalN=n.codePoint.codePointCapitalN,t.codePointCapitalO=n.codePoint.codePointCapitalO,t.codePointCapitalP=n.codePoint.codePointCapitalP,t.codePointCapitalQ=n.codePoint.codePointCapitalQ,t.codePointCapitalR=n.codePoint.codePointCapitalR,t.codePointCapitalS=n.codePoint.codePointCapitalS,t.codePointCapitalT=n.codePoint.codePointCapitalT,t.codePointCapitalU=n.codePoint.codePointCapitalU,t.codePointCapitalV=n.codePoint.codePointCapitalV,t.codePointCapitalW=n.codePoint.codePointCapitalW,t.codePointCapitalX=n.codePoint.codePointCapitalX,t.codePointCapitalY=n.codePoint.codePointCapitalY,t.codePointCapitalZ=n.codePoint.codePointCapitalZ,t.codePointCircumflexAccent=n.codePoint.codePointCircumflexAccent,t.codePointColon=n.codePoint.codePointColon,t.codePointComma=n.codePoint.codePointComma,t.codePointDigitEight=n.codePoint.codePointDigitEight,t.codePointDigitFive=n.codePoint.codePointDigitFive,t.codePointDigitFour=n.codePoint.codePointDigitFour,t.codePointDigitNine=n.codePoint.codePointDigitNine,t.codePointDigitOne=n.codePoint.codePointDigitOne,t.codePointDigitSeven=n.codePoint.codePointDigitSeven,t.codePointDigitSix=n.codePoint.codePointDigitSix,t.codePointDigitThree=n.codePoint.codePointDigitThree,t.codePointDigitTwo=n.codePoint.codePointDigitTwo,t.codePointDigitZero=n.codePoint.codePointDigitZero,t.codePointDollarSign=n.codePoint.codePointDollarSign,t.codePointDoubleQuote=n.codePoint.codePointDoubleQuote,t.codePointEqualsSign=n.codePoint.codePointEqualsSign,t.codePointEuroSign=n.codePoint.codePointEuroSign,t.codePointExclamationMark=n.codePoint.codePointExclamationMark,t.codePointFullStop=n.codePoint.codePointFullStop,t.codePointFullwidthDigitNine=n.codePoint.codePointFullwidthDigitNine,t.codePointFullwidthDigitZero=n.codePoint.codePointFullwidthDigitZero,t.codePointFullwidthLatinCapitalA=n.codePoint.codePointFullwidthLatinCapitalA,t.codePointFullwidthLatinCapitalZ=n.codePoint.codePointFullwidthLatinCapitalZ,t.codePointFullwidthLatinSmallA=n.codePoint.codePointFullwidthLatinSmallA,t.codePointFullwidthLatinSmallZ=n.codePoint.codePointFullwidthLatinSmallZ,t.codePointGreaterThanSign=n.codePoint.codePointGreaterThanSign,t.codePointHash=n.codePoint.codePointHash,t.codePointInvertedExclamationMark=n.codePoint.codePointInvertedExclamationMark,t.codePointInvertedQuestionMark=n.codePoint.codePointInvertedQuestionMark,t.codePointLF=n.codePoint.codePointLF,t.codePointLeftCurlyBracket=n.codePoint.codePointLeftCurlyBracket,t.codePointLeftParen=n.codePoint.codePointLeftParen,t.codePointLeftSquareBracket=n.codePoint.codePointLeftSquareBracket,t.codePointLessThanSign=n.codePoint.codePointLessThanSign,t.codePointMinusSign=n.codePoint.codePointMinusSign,t.codePointPercentSign=n.codePoint.codePointPercentSign,t.codePointPipe=n.codePoint.codePointPipe,t.codePointPlusSign=n.codePoint.codePointPlusSign,t.codePointQuestionMark=n.codePoint.codePointQuestionMark,t.codePointRightCurlyBracket=n.codePoint.codePointRightCurlyBracket,t.codePointRightParen=n.codePoint.codePointRightParen,t.codePointRightSquareBracket=n.codePoint.codePointRightSquareBracket,t.codePointSemicolon=n.codePoint.codePointSemicolon,t.codePointSingleQuote=n.codePoint.codePointSingleQuote,t.codePointSlash=n.codePoint.codePointSlash,t.codePointSmallA=n.codePoint.codePointSmallA,t.codePointSmallB=n.codePoint.codePointSmallB,t.codePointSmallC=n.codePoint.codePointSmallC,t.codePointSmallD=n.codePoint.codePointSmallD,t.codePointSmallE=n.codePoint.codePointSmallE,t.codePointSmallF=n.codePoint.codePointSmallF,t.codePointSmallG=n.codePoint.codePointSmallG,t.codePointSmallH=n.codePoint.codePointSmallH,t.codePointSmallI=n.codePoint.codePointSmallI,t.codePointSmallJ=n.codePoint.codePointSmallJ,t.codePointSmallK=n.codePoint.codePointSmallK,t.codePointSmallL=n.codePoint.codePointSmallL,t.codePointSmallM=n.codePoint.codePointSmallM,t.codePointSmallN=n.codePoint.codePointSmallN,t.codePointSmallO=n.codePoint.codePointSmallO,t.codePointSmallP=n.codePoint.codePointSmallP,t.codePointSmallQ=n.codePoint.codePointSmallQ,t.codePointSmallR=n.codePoint.codePointSmallR,t.codePointSmallS=n.codePoint.codePointSmallS,t.codePointSmallT=n.codePoint.codePointSmallT,t.codePointSmallU=n.codePoint.codePointSmallU,t.codePointSmallV=n.codePoint.codePointSmallV,t.codePointSmallW=n.codePoint.codePointSmallW,t.codePointSmallX=n.codePoint.codePointSmallX,t.codePointSmallY=n.codePoint.codePointSmallY,t.codePointSmallZ=n.codePoint.codePointSmallZ,t.codePointSpace=n.codePoint.codePointSpace,t.codePointTab=n.codePoint.codePointTab,t.codePointThaiDigitNine=n.codePoint.codePointThaiDigitNine,t.codePointThaiDigitZero=n.codePoint.codePointThaiDigitZero,t.codePointTilde=n.codePoint.codePointTilde,t.codePointUnderscore=n.codePoint.codePointUnderscore},61582:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.maxRetriesForLoadingScript=t.isCalcInit=t.initCalcThread=t.initCalcInThread=t.initCalcCalled=t.initCalc=t.getCalcAbsUrlOrThrow=t.getCalcAbsUrl=void 0;const n=r(57777);t.getCalcAbsUrl=n.config.getCalcAbsUrl,t.getCalcAbsUrlOrThrow=n.config.getCalcAbsUrlOrThrow,t.initCalc=n.config.initCalc,t.initCalcCalled=n.config.initCalcCalled,t.initCalcInThread=n.config.initCalcInThread,t.initCalcThread=n.config.initCalcThread,t.isCalcInit=n.config.isCalcInit,t.maxRetriesForLoadingScript=n.config.maxRetriesForLoadingScript},69547:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;const n=r(57777);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},82220:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RTree=t.RTKind=t.copyExcept=void 0;const n=r(57777);t.copyExcept=n.rTree.copyExcept,t.RTKind=n.rTree.RTKind,t.RTree=n.rTree.RTree},49156:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;const n=r(57777);t.RedBlackMapTree=n.rbMapTree.RedBlackMapTree},16824:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;const n=r(57777);t.FeatureName=n.featureConfiguration.FeatureName,t.initFeatureConfiguration=n.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=n.featureConfiguration.isFeatureEnabled,t.getFeatures=n.featureConfiguration.getFeatures,t.getTypedFeatureGate=n.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=n.featureConfiguration.isTypedChangeGateEnabled;var i=r(12367);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return i.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return i.setFeatureGateDictionaryGetter}})},737:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;const n=r(57777);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},27800:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.breakTransition=t.nextTransition=t.nextOnSuccessReceiver=t.callMachineTransition=t.TransitionKind=t.MachineRuntime=t.MachineCycle=t.VoidMachine=t.AllMachine=void 0;const n=r(57777);t.AllMachine=n.machine.AllMachine,t.VoidMachine=n.machine.VoidMachine,t.MachineCycle=n.machine.MachineCycle,t.MachineRuntime=n.machine.MachineRuntime,t.TransitionKind=n.machine.TransitionKind,t.callMachineTransition=n.machine.callMachineTransition,t.nextOnSuccessReceiver=n.machine.nextOnSuccessReceiver,t.nextTransition=n.machine.nextTransition,t.breakTransition=n.machine.breakTransition},55284:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;const n=r(57777);t.Pledge=n.pledge.Pledge},65580:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomElement=t.randomShuffled=t.randomIndex=t.randomFloat=void 0;const n=r(57777);t.randomFloat=n.testUtil.randomFloat,t.randomIndex=n.testUtil.randomIndex,t.randomShuffled=n.testUtil.randomShuffled,t.randomElement=n.testUtil.randomElement},51589:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.surrogatePairToCodePoint=t.stringFromCodePoint=t.stringCodePointAt=t.scanCodePointsBack=t.scanCodePoints=t.numCodeUnits=t.isLowSurrogate=t.isHighSurrogate=t.isAnySurrogate=t.countCodePoints=t.codePointIterator=void 0;const n=r(57777);t.codePointIterator=n.unicode.codePointIterator,t.countCodePoints=n.unicode.countCodePoints,t.isAnySurrogate=n.unicode.isAnySurrogate,t.isHighSurrogate=n.unicode.isHighSurrogate,t.isLowSurrogate=n.unicode.isLowSurrogate,t.numCodeUnits=n.unicode.numCodeUnits,t.scanCodePoints=n.unicode.scanCodePoints,t.scanCodePointsBack=n.unicode.scanCodePointsBack,t.stringCodePointAt=n.unicode.stringCodePointAt,t.stringFromCodePoint=n.unicode.stringFromCodePoint,t.surrogatePairToCodePoint=n.unicode.surrogatePairToCodePoint},43560:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;const n=r(57777);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},70157:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.geomean=t.devsq=t.avedev=t.rank_avg=t.rank=t.aggregate=t.subtotal=t.mode_mult=t.mode=t.varpa=t.vara=t.varp=t.var_=t.stdevpa=t.stdeva=t.stdevp=t.stdev=t.trimmean=t.median=t.quartile_exc=t.quartile=t.percentile_exc=t.percentile=t.small=t.large=t.xor=t.or=t.and=t.minifs=t.maxifs=t.mina=t.maxa=t.min=t.max=t.countifs=t.countif=t.counta=t.countblank=t.count=t.textjoin=t.concat=t.averagea=t.averageifs=t.averageif=t.average=t.product=t.sumifs=t.sumif=t.sumsq=t.sum=void 0,t.sumproduct=t.harmean=void 0;const n=r(88065),i=r(51286),o=r(57263),a=r(92843),s=r(98224),l=r(83009),u=r(69547),c=r(75929),d=r(94534),m=r(53964),g=r(22501),p=r(72006),h=r(737),f=r(77353),S=r(1386);function v(e,t){const r=(0,o.isRichOper)(t)?t.getFallback():t;switch(r.kind){case p.OperKind.Number:return r;case p.OperKind.Boolean:case p.OperKind.String:return;case p.OperKind.Error:return r;case p.OperKind.Missing:case p.OperKind.Blank:return;default:return(0,n.assertNever)("calc.funcs.arithmeticOperationCoerce",r)}}function y(e,t){const r=(0,o.isRichOper)(t)?t.getFallback():t;switch(r.kind){case p.OperKind.Boolean:return r.value?e.mathpack.one:e.mathpack.zero;case p.OperKind.Number:return r;case p.OperKind.String:return e.mathpack.zero;case p.OperKind.Error:return r;case p.OperKind.Missing:case p.OperKind.Blank:return;default:return(0,n.assertNever)("calc.funcs.arithmeticAOperationCoerce",r)}}function F(e){return function(t,r,i){if(void 0!==t&&(0,o.isErrorOper)(t))return t;if((0,n.assertTrue)("calc.funcs.numberReducer",void 0===t||(0,o.isNumberOper)(t)),(0,o.isErrorOper)(r))return r;let a,s;(0,n.assertTrue)("calc.funcs.numberReducer",(0,o.isNumberOper)(r)),void 0===t?(a=r,s=i-1):(a=t,s=i);for(let t=0;t<s;t+=1){const t=e(a,r);if((0,o.isErrorOper)(t))return t;a=t}return a}}function C(e){return(t,r,n)=>(e.count+=n,r)}function R(e,t,r){if(!(0,o.isNumberOper)(r))return r;const n=function(e){for(let t=e.length-1;t>=0;t-=1){const r=e[t];if(void 0!==r&&(0,a.isRangeValues)(r))for(let e=r.arrays.length-1;e>=0;e-=1){const t=r.arrays[e];if(t.rows>t.denseRows||t.cols>t.denseCols){const e=t.getSparse();if((null==e?void 0:e.kind)===p.OperKind.Number)return e}for(let e=t.denseRows-1;e>=0;e-=1)for(let r=t.denseCols-1;r>=0;r-=1){const n=t.get(e,r);if((null==n?void 0:n.kind)===p.OperKind.Number)return n}}}}(t);return(null==n?void 0:n.kind)!==p.OperKind.Number?r:e.mathpack.checkAlmostCancellation(n,r)}function b(e,t,r){let n=(0,d.reduceDerefOpers)(t,F(t.mathpack.add),v,r);return null==n?t.mathpack.zero:(e&&(n=R(t,r,n)),n)}const E=b.bind(void 0,!1),T=b.bind(void 0,!0);function k(e){return(0,o.isRangeOper)(e)&&1!==e.ranges.length}function P(e,t,r){if(k(t))return(0,h.failure)(i.valueErrorOper);if(void 0===r){const r=e.dereferenceAllOpers([t])[0];return(0,h.success)({values:r,valuesToFilter:r})}if(k(r))return(0,h.failure)(i.valueErrorOper);const{actualEvalRange:n,actualFilterRange:o}=function(e,t){const r=e.ranges[0],n=t.ranges[0],o=(0,u.fastMin)(r.cols,s.sheetCols-n.col),a=(0,u.fastMin)(r.rows,s.sheetRows-n.row),l=(0,s.gridRange)(r.row,r.col,a,o),c=(0,i.range3DOper)(e.sheets,l),d=(0,s.gridRange)(n.row,n.col,a,o);return{actualEvalRange:c,actualFilterRange:(0,i.range3DOper)(t.sheets,d)}}(t,r),a=n.ranges[0],l=o.ranges[0],c=e.dereferenceAllOpers([n])[0];if(a.col===l.col&&a.row===l.row)return(0,h.success)({values:c,valuesToFilter:c});const d=e.dereferenceAllOpers([o])[0];return(0,h.success)({values:c,valuesToFilter:d})}function N(e,[t,r,n]){const i=P(e,t,n);if(!(0,h.isSuccess)(i))return i.reason;const{values:o,valuesToFilter:s}=i.value,u=[(0,a.rangeValues)([(0,l.applyCriteria)(e,o.arrays[0],r,s.arrays[0])])];return E(e,u)}function A(e,t,r=!1,n=!1){const o=t[0];if(k(o))return(0,h.failure)(i.valueErrorOper);let s,u;if(r){const r=t[1],[n]=e.dereferenceAllOpers([o]);s=(0,l.applyCriteria)(e,n.arrays[0],r),u=2}else{const[t]=e.dereferenceAllOpers([o]);s=t.arrays[0],u=1}for(let r=u;r<t.length;r+=2){const n=t[r],a=t[r+1];if(k(n))return(0,h.failure)(i.valueErrorOper);if(n.ranges[0].cols!==o.ranges[0].cols||n.ranges[0].rows!==o.ranges[0].rows)return(0,h.failure)(i.valueErrorOper);const[u]=e.dereferenceAllOpers([n]);s=(0,l.applyCriteria)(e,u.arrays[0],a,s)}return n&&(s=s.strict()),(0,h.success)((0,a.rangeValues)([s]))}function I(e,t){const r=(0,d.reduceDerefOpers)(e,F(e.mathpack.mul),v,t);return null==r?e.mathpack.zero:r}function O(e,t,r,i,a,s){let l=(0,d.reduceDerefOpers)(a,F(a.mathpack.add),e,s,t);if(null==l)return i;if(r&&(l=R(a,s,l)),(0,o.isErrorOper)(l))return l;const u={count:0},c=(0,d.reduceDerefOpers)(a,C(u),e,s,t);(0,n.assertTrue)("calc.funcs.averageCoerceInner",(0,o.isNumberOper)(l)&&(null==c?void 0:c.kind)===p.OperKind.Number&&u.count>0);const m=a.mathpack.div(l,a.mathpack.fromNumber(u.count));return(0,o.isErrorOper)(m)?m:[m,u.count]}function _(e,t,r,n,o){const a=O(e,t,r,i.div0ErrorOper,n,o);return Array.isArray(a)?a[0]:a}t.sum=function(e,t){const r=e.dereferenceAllOpers(t);return T(e,r)},t.sumsq=function(e,t){const r=e.dereferenceAllOpers(t),n=ge(v),i=(0,d.reduceDerefOpers)(e,F(e.mathpack.add),n,r);return null==i?e.mathpack.zero:i},t.sumif=N,t.sumifs=function(e,t){if(3===t.length)return N(e,[t[1],t[2],t[0]]);const r=A(e,t);return(0,h.isSuccess)(r)?E(e,[r.value]):r.reason},t.product=function(e,t){const r=e.dereferenceAllOpers(t);return I(e,r)};const M=_.bind(void 0,v,void 0,!1),D=_.bind(void 0,v,void 0,!0),w=_.bind(void 0,y,(function(e,t){const r=(0,o.isRichOper)(t)?t.getFallback():t;return(0,o.isStringOper)(r)?e.mathpack.zero:v(0,r)}),!0);function L(e,[t,r,n]){const i=P(e,t,n);if(!(0,h.isSuccess)(i))return i.reason;const{values:o,valuesToFilter:s}=i.value,u=[(0,a.rangeValues)([(0,l.applyCriteria)(e,o.arrays[0],r,s.arrays[0]).strict()])];return M(e,u)}function x(e,t,r,a,s){let l,u=0,c="";const m=(e,t)=>e.coerceOper(t,p.OperKind.String),g=(e,a,s)=>{if(void 0!==e&&(0,o.isErrorOper)(e))return e;for(let e=0;e<s;e+=1){if(void 0!==l&&t.length>0&&(!r||l.value.length>0)){const e=t[u];if(u=(u+1)%t.length,c.length+e.value.length>i.cellStringLimit)return i.valueErrorOper;c+=e.value}if((0,o.isErrorOper)(a))return a;if((0,n.assertTrue)("calc.funcs.concatInner: expected string in reducer",(0,o.isStringOper)(a)),c.length+a.value.length>i.cellStringLimit)return i.valueErrorOper;if(c+=a.value,l=a,""===a.value&&(0===t.length||r))break}return a};for(let t=0;t<s.length;t+=1){const r=a[t];if((0,o.isRangeOper)(r)&&r.ranges.length>1)return i.valueErrorOper;const l=(0,d.reduceDerefOpers)(e,g,m,s.slice(t,t+1));if(void 0!==l&&(0,o.isErrorOper)(l))return l;(0,n.assertTrue)("calc.funcs.concatInner: expected string from reduce",void 0!==l&&(0,o.isStringOper)(l))}if(r&&void 0!==l&&""===l.value&&t.length>0&&c.length>0){const e=t[(u+t.length-1)%t.length];c=c.substring(0,c.length-e.value.length)}return(0,i.stringOper)(c)}function K(e,t,r){const n={count:0};return(0,d.reduceDerefOpers)(t,C(n),e,r),t.mathpack.fromNumber(n.count)}t.average=function(e,t){const r=e.dereferenceAllOpers(t);return D(e,r)},t.averageif=L,t.averageifs=function(e,t){if(3===t.length)return L(e,[t[1],t[2],t[0]]);const r=A(e,t,void 0,!0);return(0,h.isSuccess)(r)?M(e,[r.value]):r.reason},t.averagea=function(e,t){const r=e.dereferenceAllOpers(t);return w(e,r)},t.concat=function(e,t){const r=e.dereferenceAllOpers(t);return x(e,[],!0,t,r)},t.textjoin=function(e,t){const[r,a,...s]=t,l=[];if(!(0,o.isMissingOper)(r)){if((0,o.isRangeOper)(r)&&r.ranges.length>1)return i.valueErrorOper;const t=(e,t)=>e.coerceOper(t,p.OperKind.String),a=(0,d.reduceDerefOpers)(e,re(l,m.assertString),t,e.dereferenceAllOpers([r]));if(void 0!==a&&(0,o.isErrorOper)(a))return a;(0,n.assertTrue)("calc.funcs.textjoin: expected string from reduce",void 0!==a&&(0,o.isStringOper)(a))}return x(e,l,(0,o.isMissingOper)(a)||a.value,s,e.dereferenceAllOpers(s))};const U=K.bind(void 0,(function(e,t){const r=(0,o.isRichOper)(t)?t.getFallback():t;return(0,o.isNumberOper)(r)?r:void 0}));t.count=function(e,t){const r=e.dereferenceAllOpers(t);return U(e,r)};const B=K.bind(void 0,(function(e,t){const r=(0,o.isRichOper)(t)?t.getFallback():t;return(0,o.isBlankOper)(r)||(0,g.isEmptyStringOper)(r)?r:void 0}));t.countblank=function(e,t){const r=t[0];if(!(0,o.isSheetIndex)(r.sheets)||1!==r.ranges.length)return i.valueErrorOper;const n=e.dereferenceAllOpers(t);return B(e,n)};const G=K.bind(void 0,(function(e,t){const r=(0,o.isRichOper)(t)?t.getFallback():t;return(0,o.isPrimitiveOper)(r)||(0,o.isErrorOper)(r)?r:void 0}));t.counta=function(e,t){const r=e.dereferenceAllOpers(t);return G(e,r)};const W=K.bind(void 0,((e,t)=>t));function V(e,[t,r]){if(k(t))return i.valueErrorOper;const[n]=e.dereferenceAllOpers([t]),o=[(0,a.rangeValues)([(0,l.applyCriteria)(e,n.arrays[0],r)])];return W(e,o)}t.countif=V,t.countifs=function(e,t){if(2===t.length)return V(e,t);const r=A(e,t,!0);return(0,h.isSuccess)(r)?W(e,[r.value]):r.reason};const j=(e,t,r)=>e.mathpack.cond2(t,r)>0,q=(e,t,r)=>e.mathpack.cond2(t,r)<0;function H(e,t,r,i,a){const s=(0,d.reduceDerefOpers)(i,((t,r,a)=>void 0===t?r:(0,o.isErrorOper)(t)?t:((0,n.assertTrue)("calc.funcs.minMaxCoerceInner",(0,o.isNumberOper)(t)),(0,o.isErrorOper)(r)?r:((0,n.assertTrue)("calc.funcs.minMaxCoerceInner",(0,o.isNumberOper)(r)),e(i,t,r)?t:r))),t,a,r);return null==s?i.mathpack.zero:s}const z=H.bind(void 0,j,v,void 0),$=H.bind(void 0,q,v,void 0),Q=H.bind(void 0,j,y,v),Y=H.bind(void 0,q,y,v);function J(e,t){const r=(0,o.isRichOper)(t)?t.getFallback():t;switch(r.kind){case p.OperKind.Boolean:return r;case p.OperKind.Number:return(0,i.booleanOper)(0!==e.mathpack.cond(r));case p.OperKind.String:return;case p.OperKind.Error:return r;case p.OperKind.Missing:case p.OperKind.Blank:return;default:return(0,n.assertNever)("calc.funcs.aggregationFuncs: booleanOperationCoerce",r)}}function X(e,t,r){const a=(0,d.reduceDerefOpers)(t,((t,r,a)=>void 0!==t&&(0,o.isErrorOper)(t)?t:(0,o.isErrorOper)(r)?r:((0,n.assertTrue)("calc.funcs.booleanInner",(void 0===t||(0,o.isBooleanOper)(t))&&(0,o.isBooleanOper)(r)),(0,i.booleanOper)(e(null==t?void 0:t.value,r.value,a)))),J,r);return null==a?i.valueErrorOper:a}t.max=function(e,t){const r=e.dereferenceAllOpers(t);return z(e,r)},t.min=function(e,t){const r=e.dereferenceAllOpers(t);return $(e,r)},t.maxa=function(e,t){const r=e.dereferenceAllOpers(t);return Q(e,r)},t.mina=function(e,t){const r=e.dereferenceAllOpers(t);return Y(e,r)},t.maxifs=function(e,t){const r=A(e,t);return(0,h.isSuccess)(r)?z(e,[r.value]):r.reason},t.minifs=function(e,t){const r=A(e,t);return(0,h.isSuccess)(r)?$(e,[r.value]):r.reason};const Z=X.bind(void 0,((e,t)=>!1!==e&&t)),ee=X.bind(void 0,((e,t)=>!0===e||t)),te=X.bind(void 0,((e,t,r)=>t?((!0===e?1:0)+r)%2==1:!0===e));function re(e,t){return(r,n,i)=>{if(void 0!==r&&(0,o.isErrorOper)(r))return r;if(!(0,o.isErrorOper)(n)){const r=t(n);for(let t=0;t<i;t+=1)e.push(r)}return n}}function ne(e,t,r,n){const a=[],s=(0,d.reduceDerefOpers)(t,re(a,m.assertNumber),v,[r]);if(null==s)return i.numErrorOper;if((0,o.isErrorOper)(s))return s;const l=t.mathpack;if(l.cond2(n,l.one)<0)return i.numErrorOper;if(l.cond2(n,l.fromNumber(a.length))>0)return i.numErrorOper;const u=a.sort(l.cond2);if(e){const e=(0,m.assertNumber)(l.add((0,m.assertNumber)(l.sub(l.fromNumber(a.length),n)),l.one));return u[l.lfix(e)-1]}return u[l.lfix(n)-1]}t.and=function(e,t){const r=e.dereferenceAllOpers(t);return Z(e,r)},t.or=function(e,t){const r=e.dereferenceAllOpers(t);return ee(e,r)},t.xor=function(e,t){const r=e.dereferenceAllOpers(t);return te(e,r)};const ie=ne.bind(void 0,!0),oe=ne.bind(void 0,!1);function ae(e,t,r,n){const a=e.mathpack,s=[],l=(0,d.reduceDerefOpers)(e,re(s,m.assertNumber),v,t);if(null==l)return i.numErrorOper;if((0,o.isErrorOper)(l))return l;if((0,o.isErrorOper)(r))return r;if(a.cond(r)<0)return i.numErrorOper;if(a.cond2(r,a.one)>0)return i.numErrorOper;const u=s.sort(a.cond2),c=(0,m.assertNumber)(a.sub(a.fromNumber(u.length),a.one)),g=(0,m.assertNumber)(a.add(a.fromNumber(u.length),a.one)),p=n?(0,m.assertNumber)(a.mul(c,r)):(0,m.assertNumber)(a.sub((0,m.assertNumber)(a.mul(g,r)),a.one));if(a.cond(p)<0||a.cond2(p,c)>0)return i.numErrorOper;const h=a.lfix(p),f=(0,m.assertNumber)(a.sub(p,a.fromNumber(h)));if(0===a.cond(f))return u[h];const S=a.sub(u[h+1],u[h]);return(0,o.isErrorOper)(S)?S:a.add(u[h],(0,m.assertNumber)(a.mul(S,f)))}t.large=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return ie(e,r,n)},t.small=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return oe(e,r,n)};const se=(e,t,r)=>ae(e,[t],r,!0);t.percentile=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return se(e,r,n)};const le=(e,t,r)=>ae(e,[t],r,!1);function ue(e,t){const r=e.mathpack;if(r.cond(t)<0)return i.numErrorOper;if(r.cond2(t,r.fromNumber(5))>=0)return i.numErrorOper;const n=r.lfix(t);return r.div(r.fromNumber(n),r.fromNumber(4))}t.percentile_exc=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return le(e,r,n)};const ce=(e,t,r)=>ae(e,[t],ue(e,r),!0);t.quartile=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return ce(e,r,n)};const de=(e,t,r)=>ae(e,[t],ue(e,r),!1);function me(e,t){return ae(e,t,e.mathpack.fromNumber(.5),!0)}function ge(e){return function(t,r){const n=e(t,r);return void 0!==n&&(0,o.isNumberOper)(n)?t.mathpack.mul(n,n):n}}function pe(e,t){return function(r,n){const i=e(r,n);if((null==i?void 0:i.kind)!==p.OperKind.Number)return i;const a=r.mathpack,s=a.sub(i,t);return(0,o.isErrorOper)(s)?s:a.mul(s,s)}}function he(e,t,r,a){const s={count:0};if(null==(0,d.reduceDerefOpers)(r,C(s),e,a,t))return i.div0ErrorOper;(0,n.assertTrue)("calc.funcs.varFirstPass: unexpected count type",s.count>=1);const l=F(r.mathpack.add),u=(0,d.reduceDerefOpers)(r,l,e,a,t),c=(0,d.reduceDerefOpers)(r,l,ge(e),a,void 0===t?void 0:ge(t));if((0,n.assertTrue)("calc.funcs.varFirstPass: expected sum",null!=u),(0,n.assertTrue)("calc.funcs.varFirstPass: expected sumSq",null!=c),(0,o.isErrorOper)(u))return u;if((0,o.isErrorOper)(c))return c;(0,n.assertTrue)("calc.funcs.varFirstPass: unexpected oper type",(0,o.isNumberOper)(u)&&(0,o.isNumberOper)(c));const m=r.mathpack,g=m.div(u,m.fromNumber(s.count));return(0,o.isErrorOper)(g)?g:[s.count,u,c,g]}function fe(e,t,r,i,o){const a=F(r.mathpack.add),s=(0,d.reduceDerefOpers)(r,a,pe(e,o),i,void 0===t?void 0:pe(t,o));return(0,n.assertTrue)("calc.funcs.varSecondPass: unexpected error",(null==s?void 0:s.kind)===p.OperKind.Number),s}function Se(e,t,r,n){const a=he(e,t,r,n);if(!Array.isArray(a))return a;const s=r.mathpack,[l,u,c,d]=a;if(l<2)return i.div0ErrorOper;const g=s.mul(u,u);if((0,o.isErrorOper)(g))return g;const p=(0,m.assertNumber)(s.div(g,s.fromNumber(l))),h=(0,m.assertNumber)(s.sub(c,p));if(0===s.cond(d))return s.cond(h)<0?s.zero:s.div(h,s.fromNumber(l-1));if(s.cond(h)>=0){const e=(0,m.assertNumber)(s.div(h,s.fromNumber(l-1))),t=21219957905e-324;if(s.cond2(e,s.fromNumber(t))>0){const t=s.div(p,c),r=(0,o.isErrorOper)(t)?t:s.sub(t,s.one);if(!(0,o.isErrorOper)(r)&&s.cond2(s.abs(r),s.fromNumber(.01))>0){const t=s.div(d,e),r=(0,o.isErrorOper)(t)?t:s.sub(s.abs(t),s.fromNumber(1e3));if(!(0,o.isErrorOper)(r)&&s.cond(r)<0)return e}}}const f=fe(e,t,r,n,d);return s.cond(f)<0?s.zero:s.div(f,s.fromNumber(l-1))}function ve(e,t,r,n){const a=he(e,t,r,n);if(!Array.isArray(a))return a;const s=r.mathpack,[l,u,c,d]=a;if(l<1)return i.div0ErrorOper;const g=s.mul(u,u);if((0,o.isErrorOper)(g))return g;const p=s.mul(c,s.fromNumber(l));if((0,o.isErrorOper)(p))return p;const h=(0,m.assertNumber)(s.sub(p,g));if(0===s.cond(d))return s.cond(h)<0?s.zero:s.div(h,s.fromNumber(l*l));if(s.cond(h)>=0){const e=(0,m.assertNumber)(s.div(h,s.fromNumber(l*l))),t=21219957905e-324;if(s.cond2(e,s.fromNumber(t))>0){const t=s.div((0,m.assertNumber)(s.div(g,s.fromNumber(l))),c),r=(0,o.isErrorOper)(t)?t:s.sub(t,s.one);if(!(0,o.isErrorOper)(r)&&s.cond2(s.abs(r),s.fromNumber(.01))>0){const t=s.div(d,e),r=(0,o.isErrorOper)(t)?t:s.sub(s.abs(t),s.fromNumber(1e3));if(!(0,o.isErrorOper)(r)&&s.cond(r)<0)return e}}}const f=fe(e,t,r,n,d);return s.cond(f)<0?s.zero:s.div(f,s.fromNumber(l))}t.quartile_exc=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return de(e,r,n)},t.median=function(e,t){const r=e.dereferenceAllOpers(t);return me(e,r)},t.trimmean=function(e,t){const[r,a]=e.dereferenceAllOpers(t);let s=[];const l=(0,d.reduceDerefOpers)(e,re(s,m.assertNumber),v,[r]);if(null==l)return i.numErrorOper;if((0,o.isErrorOper)(l))return l;const u=e.mathpack;if(u.cond(a)<0)return i.numErrorOper;if(u.cond2(a,u.one)>=0)return i.numErrorOper;s=s.sort(u.cond2);const c=u.lfix((0,m.assertNumber)(u.div((0,m.assertNumber)(u.mul(u.fromNumber(s.length),a)),u.fromNumber(2))));(0,n.assertTrue)("calc.funcs.trimmean",c+c<s.length);const g=s[c],p=s[s.length-1-c];let h=0,f=0;const S=(0,d.reduceDerefOpers)(e,F(e.mathpack.add),((e,t)=>{const r=v(0,t);if(void 0===r)return r;(0,n.assertTrue)("calc.funcs.trimmean: unexpected error",(0,o.isNumberOper)(r));const i=e.mathpack;if(i.cond2(r,g)<0)h+=1;else{if(!(i.cond2(r,p)>0))return r;f+=1}}),[r]);(0,n.assertTrue)("calc.funcs.trimmean: found no elements",void 0!==S&&(0,o.isNumberOper)(S)),(0,n.assertTrue)("calc.funcs.trimmean: trimmed too many",h<=c&&f<=c);let y=S;for(;h<c;h+=1){const e=u.sub(y,g);if((0,o.isErrorOper)(e))return e;y=e}for(;f<c;f+=1){const e=u.sub(y,p);if((0,o.isErrorOper)(e))return e;y=e}return u.div(y,u.fromNumber(s.length-c-c))};const ye=Se.bind(void 0,v,void 0),Fe=ve.bind(void 0,v,void 0),Ce=Se.bind(void 0,y,v),Re=ve.bind(void 0,y,v);function be(e){return function(t,r){const n=e(t,r);return(0,o.isNumberOper)(n)?t.mathpack.sqrt(n):n}}const Ee=be(ye),Te=be(Fe),ke=be(Ce),Pe=be(Re);t.stdev=function(e,t){const r=e.dereferenceAllOpers(t);return Ee(e,r)},t.stdevp=function(e,t){const r=e.dereferenceAllOpers(t);return Te(e,r)},t.stdeva=function(e,t){const r=e.dereferenceAllOpers(t);return ke(e,r)},t.stdevpa=function(e,t){const r=e.dereferenceAllOpers(t);return Pe(e,r)},t.var_=function(e,t){const r=e.dereferenceAllOpers(t);return ye(e,r)},t.varp=function(e,t){const r=e.dereferenceAllOpers(t);return Fe(e,r)},t.vara=function(e,t){const r=e.dereferenceAllOpers(t);return Ce(e,r)},t.varpa=function(e,t){const r=e.dereferenceAllOpers(t);return Re(e,r)};const Ne=[D,U,G,z,$,I,Ee,Te,T,ye,Fe];function Ae(e,t){const r=[],a=(0,d.reduceDerefOpers)(e,(s=r,(e,t,r)=>{if(void 0!==e&&(0,o.isErrorOper)(e))return e;if((0,o.isNumberOper)(t))for(let e=0;e<r;e+=1)s.push({value:t,index:s.length});return t}),v,t);var s;if(null==a)return i.naErrorOper;if((0,o.isErrorOper)(a))return a;const l=e.mathpack,u=r.sort(((e,t)=>l.cond2(e.value,t.value)));let c=1,m=0,g=1/0;const p=[];function h(e){c=1,g=e.index}const f=e=>{const{value:t}=e;c>m?(m=c,p.length=0,p.push({value:t,index:g})):c===m&&p.push({value:t,index:g})};h(u[0]);for(let e=1;e<u.length;e+=1)y=u[e-1],F=u[e],0===l.cond2(y.value,F.value)?((S=u[e]).index<g&&(g=S.index),c+=1):(f(u[e-1]),h(u[e]));var S,y,F;return f(u[u.length-1]),m<2?i.naErrorOper:((0,n.assertTrue)("calc.funcs.modeInner: unexpected error",0!==p.length),p.sort(((e,t)=>e.index-t.index)))}function Ie(e,t){const r=Ae(e,t);return Array.isArray(r)?r[0].value:r}t.mode=function(e,t){return Ie(e,t)},t.mode_mult=function(e,t){const r=Ae(e,t);return Array.isArray(r)?(0,i.arrayOper)(r.length,1,r.map((e=>[e.value]))):r};const Oe=(0,f.binaryVisitor)(Object.assign(Object.assign({},(0,f.constVisitor)(!1)),{wsfNode:e=>e===c.WorksheetFuncId.SUBTOTAL||e===c.WorksheetFuncId.AGGREGATE}),((e,t)=>e||t));function _e(e){if(!(0,a.isRangeValues)(e))return e;const t=e.arrays.map((e=>e.map((([e,t])=>{return void 0!==t&&(r=t.formula,(0,f.reduceBottomUp)(Oe,r))?void 0:e;var r}))));return(0,a.rangeValues)(t)}t.subtotal=function(e,[t,...r]){const n=e.mathpack.sfix(t),o=Ne.length;if(!(n>=1&&n<=o||n>=101&&n<=o+100))return i.valueErrorOper;const a=n>100||e.isInFilterMode(r),s=e.dereferenceAllOpersAndFormulae(r,a).map(_e);return(0,Ne[n%100-1])(e,s)};const Me=[...Ne,me,Ie],De=[ie,oe,se,ce,le,de];function we(e,[t,r,n=i.falseOper],a){const s=n.value?1:-1;let l=0,u=0;const c=e.mathpack,g=(0,d.reduceDerefOpers)(e,((e,r,n)=>{if(void 0!==e)return e;if((0,o.isErrorOper)(r))return r;const i=c.cond2(t,(0,m.assertNumber)(r));0===i?l+=n:i===s&&(u+=n)}),v,e.dereferenceAllOpers([r]));if(void 0!==g)return g;if(0===l)return i.naErrorOper;const p=c.fromNumber(u+1);if(a){const e=c.div(c.fromNumber(l-1),c.fromNumber(2));return c.add(p,(0,m.assertNumber)(e))}return p}function Le(e){return function(t,r){const n=e(t,r);return(null==n?void 0:n.kind)===p.OperKind.Number?t.mathpack.abs(n):n}}function xe(e,t,r){const a=O(v,void 0,!0,i.numErrorOper,t,r);if(!Array.isArray(a))return a;const[s,l]=a,u=(0,d.reduceDerefOpers)(t,F(t.mathpack.add),e(function(e,t){return function(r,n){const i=e(r,n);return(null==i?void 0:i.kind)===p.OperKind.Number?r.mathpack.sub(i,t):i}}(v,s)),r);return(0,n.assertTrue)("calc.funcs.sumDevAndCount",void 0!==u),(0,o.isErrorOper)(u)?u:[(0,m.assertNumber)(u),l]}t.aggregate=function(e,t){const[r,l,u,c,...m]=t,g=e.mathpack,h=g.sfix(r),f=g.sfix(l);if(!(h>=1&&h<=Me.length+De.length&&f>=0&&f<=7))return i.valueErrorOper;const v=1==(1&f),y=2==(2&f),F=!(4==(4&f));function C(t){let r=F?e.dereferenceAllOpersAndFormulae(t,v).map(_e):e.dereferenceAllOpers(t,v);return y&&(r=r.map((e=>{if((0,d.isPrimitiveCoercedOper)(e))return e;if((0,a.isRangeValues)(e)){const t=e.arrays.map((e=>e.map((e=>void 0===e||(0,o.isErrorOper)(e)?void 0:e))));return(0,a.rangeValues)(t)}if((0,d.isCoercedArrayOper)(e)){const t=e.opers.map((e=>e.map((e=>void 0===e||(0,o.isErrorOper)(e)?void 0:e))));return(0,d.coercedArrayOper)(e.rows,e.cols,t)}return e}))),r}if(h>Me.length){if(void 0===c||m.length>0)return i.valueErrorOper;const t=p.OperKind.Number;!(0,o.isRangeOper)(c)||(0,o.isSheetIndex)(c.sheets)&&1===c.ranges.length&&(0,s.isGridCell)(c.ranges[0])||(0,S.throwEvaluationError)((0,o.notImplemented)(["AGGREGATE multi-cell array param"]));const r=e.coerceOper(e.dereferenceOper(c,t),t);if((0,o.isErrorOper)(r))return i.valueErrorOper;if((0,o.isRangeOper)(u)&&!(0,o.isSheetIndex)(u.sheets))return i.valueErrorOper;const[n]=C([u]);return(0,De[h-Me.length-1])(e,n,r)}for(let e=2;e<t.length;e+=1){const r=t[e];if(!r||!(0,o.isRangeOper)(r)||!(0,o.isSheetIndex)(r.sheets))return i.valueErrorOper}const R=C(t.slice(2));return(0,n.assertTrue)("calc.funcs.aggregate: requested non-array function with unexpected number",h>=1&&h<=Me.length),(0,Me[h-1])(e,R)},t.rank=function(e,t){return we(e,t,!1)},t.rank_avg=function(e,t){return we(e,t,!0)},t.avedev=function(e,t){const r=e.dereferenceAllOpers(t),n=xe(Le,e,r);if(!Array.isArray(n))return n;const[i,o]=n;return e.mathpack.div(i,e.mathpack.fromNumber(o))},t.devsq=function(e,t){const r=e.dereferenceAllOpers(t),n=xe(ge,e,r);if(!Array.isArray(n))return n;const[i]=n;return i};const Ke=new Float64Array(1),Ue=new Int32Array(Ke.buffer);function Be(e,t){Ke[0]=e.toNumber(t);const r=((2146435072&Ue[1])>>>20)-1023;return Ue[1]=-2146435073&Ue[1]|1072693248,[e.fromNumber(Ke[0]),r]}function Ge(e,t,r){Ke[0]=e.toNumber(t);const n=((2146435072&Ue[1])>>>20)-1023;return Ue[1]=-2146435073&Ue[1]|n+r+1023<<20&2146435072,e.fromNumber(Ke[0])}t.geomean=function(e,t){const r=e.mathpack,a=e.dereferenceAllOpers(t),s={count:0,prodExp:0};let l=(0,d.reduceDerefOpers)(e,function(e,t){const r=e.mathpack;return function(e,a,s){if(void 0!==e&&(0,o.isErrorOper)(e))return e;if((0,n.assertTrue)("calc.funcs.geometricReducer",void 0===e||(0,o.isNumberOper)(e)),(0,o.isErrorOper)(a))return a;if((0,n.assertTrue)("calc.funcs.geometricReducer",(0,o.isNumberOper)(a)),r.cond(a)<=0)return i.numErrorOper;const[l,u]=Be(r,a);let c=null!=e?e:r.one;for(let e=0;e<s;e+=1){if(t.count%512==511){const[e,n]=Be(r,c);if(t.prodExp+=n,c=e,t.prodExp>2130706431||t.prodExp<-2130706431)return i.numErrorOper}t.count+=1,t.prodExp+=u,c=r.mul(c,l),(0,n.assertTrue)("calc.funcs.geometricReducer",!(0,o.isErrorOper)(c))}return c}}(e,s),v,a);if(null==l)return i.numErrorOper;if((0,o.isErrorOper)(l))return l;if((0,n.assertTrue)("calc.funcs.geomean",s.count>0&&(0,o.isNumberOper)(l)),1===s.count)return Ge(r,l,s.prodExp);{const[e,t]=Be(r,l);s.prodExp+=t,l=e}const u=s.prodExp/s.count|0,c=s.prodExp%s.count,m=r.div(r.one,r.fromNumber(s.count));if((0,n.assertTrue)("calc.funcs.geomean",!(0,o.isErrorOper)(m)),c<=1e3){const e=Ge(r,l,c),t=r.power(e,m);return(0,n.assertTrue)("calc.funcs.geomean",!(0,o.isErrorOper)(t)),Ge(r,t,u)}const g=c-1e3,p=Ge(r,l,c-g),h=r.power(p,m);(0,n.assertTrue)("calc.funcs.geomean",!(0,o.isErrorOper)(h));const f=Ge(r,h,u),S=r.mul(r.fromNumber(s.count),r.fromNumber(1.4426950408889636));(0,n.assertTrue)("calc.funcs.geomean",!(0,o.isErrorOper)(S));const y=r.div(r.fromNumber(g),S);(0,n.assertTrue)("calc.funcs.geomean",!(0,o.isErrorOper)(y));const F=r.exp(y);return(0,o.isErrorOper)(F)?F:r.mul(f,F)},t.harmean=function(e,t){const r=e.dereferenceAllOpers(t),a=(s=v,function(e,t){const r=s(e,t);if(void 0===r||!(0,o.isNumberOper)(r))return r;const n=e.mathpack;return n.cond(r)<=0?i.numErrorOper:n.div(n.one,r)});var s;const l=(0,d.reduceDerefOpers)(e,F(e.mathpack.add),a,r);if(null==l)return i.naErrorOper;if((0,o.isErrorOper)(l))return l;const u={count:0},c=(0,d.reduceDerefOpers)(e,C(u),a,r);(0,n.assertTrue)("calc.funcs.harmean",(0,o.isNumberOper)(l)&&(null==c?void 0:c.kind)===p.OperKind.Number&&u.count>0);const m=e.mathpack.div(l,e.mathpack.fromNumber(u.count));return(0,o.isErrorOper)(m)?m:e.mathpack.div(e.mathpack.one,m)};const We=e=>(0,o.isRichOper)(e)?e.getFallback():e;t.sumproduct=(e,t)=>{const r=t.map((e=>(0,i.arrayOper)(e.rows,e.cols,e.opers.map((e=>e.map(We)))))),n=e.mathpack;for(const e of r)for(const t of e.opers)for(const e of t)if((0,o.isErrorOper)(e))return e;const a=r[0].rows,s=r[0].cols;if(!r.every((e=>e.rows===a&&e.cols===s)))return i.valueErrorOper;let l=n.zero;for(let e=0;e<a;++e)e:for(let t=0;t<s;++t){const i=r[0].opers[e][t];if(!(0,o.isNumberOper)(i))continue e;let a=i;for(let i=1;i<r.length;++i){const s=r[i].opers[e][t];if(!(0,o.isNumberOper)(s))continue e;if(a=n.mul(a,s),(0,o.isErrorOper)(a))return a}if(l=n.add(a,l),(0,o.isErrorOper)(l))return l}return l}},33532:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unique=t.sortby=t.sort=t.filter=void 0;const n=r(64250),i=r(88065),o=r(49156),a=r(43560),s=r(72006),l=r(57263),u=r(51286),c=r(51286),d=r(92843),m=r(85520),g=r(53964);function p(e){return(0,l.isBlankOper)(e)?(0,c.arrayOper)(1,1,[[e]]):e}function h(e,t=u.missingOper,r,n){const i=e.mathpack,o=(0,l.isMissingOper)(t)?(0,c.arrayOper)(1,1,[[i.one]]):t;if(!(1===o.rows&&o.cols>=1||1===o.cols&&o.rows>=1))return c.valueErrorOper;if(o.rows*o.cols>r)return c.valueErrorOper;const a=[];for(let t=0;t<o.rows;++t)for(let r=0;r<o.cols;++r){const u=e.coerceOper(o.opers[t][r],s.OperKind.Number);if(!(0,l.isNumberOper)(u))return(0,g.assertError)(u);const c=n(i.sfix(u));if("number"!=typeof c)return c;a.push(c)}return a}function f(e,t){return t?new n.NonstrictArray2D(e.cols,e.rows,((t,r)=>e.opers[r][t])):new n.StrictArray2D(e.rows,e.cols,e.opers)}function S(e,t,r,i){const{rows:o,cols:a}=t,s=e.config,l=[];for(let e=0;e<o;++e)l.push(e);l.sort(((e,t)=>{for(let r=0;r<i.length;++r){const[n,o]=i[r],a=(0,m.sortOpers)(s,n(e),n(t),o,!1);if(0!==a)return a}return e-t}));const u=new n.NonstrictArray2D(o,a,((e,r)=>t.get(l[e],r))),d=r?(0,n.transposeArray2D)(u):u;return(0,c.arrayOper)(d.rows,d.cols,(0,n.array2DToJaggedArray)(d))}t.filter=function(e,t){const[r,i,o]=t,a=(0,g.rangeOrArrayToVal)(r,c.refErrorOper);if((0,l.isErrorOper)(a))return a;const u=(0,g.rangeOrArrayToVal)(i,c.refErrorOper);if((0,l.isErrorOper)(u))return u;const{rows:m,cols:p}=(0,g.makeSlicer)(a),{rows:h,cols:f}=(0,g.makeSlicer)(u);if(!(1===h&&f>=1||1===f&&h>=1))return c.valueErrorOper;const S=1===h&&1===f?1===m:h>1;if(S?h!==m:f!==p)return c.valueErrorOper;const[v]=e.dereferenceAllOpers([u]),y=(0,n.sparseArray2DTo1D)((0,d.isRangeValues)(v)?v.arrays[0]:new n.StrictSparseArray2D(v.rows,v.cols,v.rows,v.cols,v.opers,c.blankOper),!S),F=[];for(let t=0;t<y.length;++t){const r=e.coerceOper(y.get(t),s.OperKind.Boolean);if(!(0,l.isBooleanOper)(r))return r;if(r.value)F.push(t);else if(t>=y.denseLength)break}if(S?(0,g.validateArraySize)(F.length,p):(0,g.validateArraySize)(m,F.length),0===F.length)return void 0===o||(0,l.isMissingOper)(o)?c.calcErrorOper:o;const[C]=e.dereferenceAllOpers([a]),R=(0,d.isRangeValues)(C)?C.arrays[0]:new n.StrictArray2D(C.rows,C.cols,C.opers),b=e=>new n.NonstrictArray2D(F.length,e.cols,((t,r)=>e.get(F[t],r))),E=S?b(R):(0,n.transposeArray2D)(b((0,n.transposeArray2D)(R)));return(0,c.arrayOper)(E.rows,E.cols,(0,n.array2DToJaggedArray)(E))},t.sort=function(e,t){const[r,n,i,o]=t,s=p(r),l=!!o&&o.value,u=f(s,l),d=u.cols,m=h(e,n,d,(e=>e>=1&&e<=d?e-1:c.valueErrorOper));if(!Array.isArray(m))return m;const g=h(e,i,m.length,(e=>1===e||-1===e?e:c.valueErrorOper));if(!Array.isArray(g))return g;if(1===g.length)g.length=m.length,(0,a.arrayFill)(g,g[0]);else if(g.length!==m.length)return c.valueErrorOper;const v=m.map(((e,t)=>[t=>u.get(t,e),g[t]]));return 1===u.rows?s:S(e,u,l,v)},t.sortby=function(e,t){var r;const[n,...o]=t,a=p(n);(0,i.assertTrue)("calc.funcs.sortby",o.every(((e,t)=>t%2==0?(0,l.isArrayOper)(e)||(0,l.isBlankOper)(e):(0,l.isNumberOper)(e)||(0,l.isMissingOper)(e))));const s=[];for(let e=0;e<o.length;e+=2)s.push([p(o[e]),null!==(r=o[e+1])&&void 0!==r?r:u.missingOper]);const d=s[0][0].cols>=s[0][0].rows&&s[0][0].cols===a.cols,m=f(a,d),g=[];for(const[t,r]of s){if(1!==t.rows&&1!==t.cols)return c.valueErrorOper;if(!(d?t.cols===a.cols:t.rows===a.rows))return c.valueErrorOper;const n=t.opers,i=e.mathpack.sfix((0,l.isNumberOper)(r)?r:e.mathpack.one);if(1!==i&&-1!==i)return c.valueErrorOper;g.push([d?e=>n[0][e]:e=>n[e][0],i])}return 1===m.rows?a:S(e,m,d,g)},t.unique=function(e,t){var r,i;const[a,s,l]=t,u=p(a),d=null!==(r=null==s?void 0:s.value)&&void 0!==r&&r,g=null!==(i=null==l?void 0:l.value)&&void 0!==i&&i,h=f(u,d);if(1===h.rows)return u;const S=e.config,v=[];let y=o.RedBlackMapTree.create(((e,t)=>{for(let r=0;r<h.cols;++r){const n=(0,m.sortOpers)(S,h.get(e,r),h.get(t,r),1,!0);if(0!==n)return n}return 0}));for(let e=0;e<h.rows;++e){let t;[y,t]=y.getOrSetValue(e,(()=>({firstRow:e,count:0}))),t.count+=1,v.push(t)}const F=g?v.filter((e=>1===e.count)):v.filter(((e,t)=>e.firstRow===t));if(0===F.length)return c.calcErrorOper;const C=new n.NonstrictArray2D(F.length,h.cols,((e,t)=>h.get(F[e].firstRow,t))),R=d?(0,n.transposeArray2D)(C):C;return(0,c.arrayOper)(R.rows,R.cols,(0,n.array2DToJaggedArray)(R))}},83009:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyCriteria=t.compileCriteria=t.parseCriteria=void 0;const n=r(51286),i=r(75929),o=r(64250),a=r(69547),s=r(81388),l=r(57263),u=r(88065),c=r(54218),d=r(22501),m=r(72006),g={"=":i.OperatorId.Eq,"<":i.OperatorId.Lt,">":i.OperatorId.Gt},p={"<>":i.OperatorId.Ne,"<=":i.OperatorId.Le,">=":i.OperatorId.Ge};function h(e,t){if(!(0,l.isStringOper)(t))return t;const[r,i]=function(e){if(e.length>=2){const t=p[e.substring(0,2)];if(void 0!==t)return[t,e.substring(2)]}if(e.length>=1){const t=g[e.substring(0,1)];if(void 0!==t)return[t,e.substring(1)]}return[void 0,e]}(t.value),o=function(e,t){const{localeInfo:r}=e.config;if(0===r.stringCompareCI(t,r.trueName))return n.trueOper;if(0===r.stringCompareCI(t,r.falseName))return n.falseOper;for(let e=1;e<r.errorNames.length;e+=1){const i=r.errorNames[e];if(null!=i&&0===r.stringCompareCI(i,t))return(0,n.errorOper)(e)}const i=e.parseGeneral(t,!1);return void 0!==i?i:(0,n.stringOper)(t)}(e,i);return{kind:"FilterExpression",operator:r,operand:o}}function f(e,t){const r="FilterExpression"===t.kind?t:{kind:"FilterExpression",operator:i.OperatorId.Eq,operand:t},{mathpack:n,localeInfo:o}=e.config;if(r.operator===i.OperatorId.Ne&&(0,d.isEmptyStringOper)(r.operand))return e=>!(0,l.isBlankOper)(e);if(r.operator===i.OperatorId.Eq&&(0,d.isEmptyStringOper)(r.operand))return l.isBlankOper;if(void 0!==r.operator&&(0,d.isEmptyStringOper)(r.operand))return e=>!1;if(void 0===r.operator&&(0,d.isEmptyStringOper)(r.operand))return e=>(0,l.isBlankOper)(e)||(0,d.isEmptyStringOper)(e);const a=void 0===r.operator?i.OperatorId.Eq:r.operator;switch(r.operand.kind){case m.OperKind.Number:return g=a,p=r.operand,t=>{const r=(0,l.isRichOper)(t)?t.getFallback():t;if((0,l.isNumberOper)(r))return(0,s.cmpNum)(n,g,r,p);if((0,l.isStringOper)(r)&&g===i.OperatorId.Eq){const t=e.parseGeneral(r.value,!1);return void 0!==t&&(0,s.cmpNum)(n,g,t,p)}return g===i.OperatorId.Ne};case m.OperKind.Boolean:return function(e,t){return r=>{const n=(0,l.isRichOper)(r)?r.getFallback():r;return(0,l.isBooleanOper)(n)?(0,s.cmpBool)(e,n,t):e===i.OperatorId.Ne}}(a,r.operand);case m.OperKind.String:return function(e,t){switch(e){case i.OperatorId.Eq:case i.OperatorId.Ne:const r=new c.WildExp(o,t.value);return t=>{const n=(0,l.isRichOper)(t)?t.getFallback():t;return(0,l.isStringOper)(n)?r.test(n.value)===(e===i.OperatorId.Eq):e===i.OperatorId.Ne};case i.OperatorId.Lt:case i.OperatorId.Gt:case i.OperatorId.Le:case i.OperatorId.Ge:return r=>{const n=(0,l.isRichOper)(r)?r.getFallback():r;return!!(0,l.isStringOper)(n)&&(0,s.cmpStr)(o,e,n,t)}}}(a,r.operand);case m.OperKind.Error:return function(e,t){return r=>{const n=(0,l.isRichOper)(r)?r.getFallback():r;return(0,l.isErrorOper)(n)?(0,s.cmpInt)(e,n.type-t.type):e===i.OperatorId.Ne}}(a,r.operand);default:return(0,u.assertNever)("calc.funcs.criteria.compileCriteria",r.operand)}var g,p}t.parseCriteria=h,t.compileCriteria=f,t.applyCriteria=function(e,t,r,n){const i=f(e,h(e,r)),s=t,l=void 0===n?s:n;return new o.NonstrictSparseArray2D(l.rows,l.cols,(0,a.fastMax)(s.denseRows,l.denseRows),(0,a.fastMax)(s.denseCols,l.denseCols),((e,t)=>{const r=s.get(e,t);return i(r)?l.get(e,t):void 0}),(()=>{const e=s.getSparse();return i(e)?l.getSparse():void 0}))}},57762:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.yearFrac=t.networkdays=t.networkdays_intl=t.eomonth=t.edate=t.workday=t.workday_intl=t.days=t.datedif=t.days360=t.time=t.date=t.weeknum=t.isoweeknum=t.weekday=t.second=t.minute=t.hour=t.day=t.month=t.year=void 0;const n=r(51286),i=r(9186),o=r(53964),a=r(57263),s=r(737),l=r(72006),u=r(88065);function c(e,t,[r]){const{datepack:o,config:a}=t,s=o.fromNum(a,r,i.Rounding.RoundSec);return!1===s?n.numErrorOper:t.mathpack.fromNumber(e(s))}function d(e,[t,r],o=!1){const{config:a,mathpack:s,datepack:l}=e,u=l.fromNum(Object.assign(Object.assign({},a),{date1904:a.date1904&&!o}),t,i.Rounding.RoundSec);if(!1===u)return n.numErrorOper;let c;switch(void 0!==r?s.sfix(r):1){case 1:case 17:c=u.wdy;break;case 2:case 11:c=1===u.wdy?7:u.wdy-1;break;case 3:c=1===u.wdy?6:u.wdy-2;break;case 12:c=(u.wdy+4)%7+1;break;case 13:c=(u.wdy+3)%7+1;break;case 14:c=(u.wdy+2)%7+1;break;case 15:c=(u.wdy+1)%7+1;break;case 16:c=u.wdy%7+1;break;default:return n.numErrorOper}return s.fromNumber(c)}function m(e,t,r){if(!t){const t=e.lfix(r);if(0===t||1===t)return e.fromNumber(52)}return n.numErrorOper}function g(e,t,[r,s]){const l=(0,o.chkDateOper)(t,r);if((0,a.isErrorOper)(l))return l;const[c,g]=function(e,t,r){if(void 0===t||(0,a.isMissingOper)(t))return[r?2:1,r];const n=(0,o.chkNumOper)(e,t);if(!(0,a.isErrorOper)(n)){const t=e.mathpack.sfix(n);if(r){if(1===t||2===t)return[t,r]}else{if(1===t||2===t)return[t,r];if(t>=11&&t<=16)return[t-9,r];if(17===t)return[1,r];if(21===t)return[2,!0]}}return[void 0,r]}(t,s,e);if(void 0===c)return n.numErrorOper;const{mathpack:p,datepack:h,config:f}=t,S=Object.assign(Object.assign({},f),{date1904:!1}),v=h.fromNum(S,l,i.Rounding.RoundSec);if(!1===v)return m(p,S.dateCompatibility,l);const y=(0,i.dateTime)(v.yr,1,1,0,0,0,0,0,i.Rounding.RoundSec),F=h.toNum(S,y);if((0,a.isErrorOper)(F))return m(p,S.dateCompatibility,l);const C=d(t,[F],!0);if((0,a.isErrorOper)(C))return C;const R=(0,o.assertNumber)(p.add((0,o.assertNumber)(p.sub(C,p.fromNumber(c))),p.fromNumber(7))),b=(0,o.assertNumber)((0,o.numMod)(p,R,p.fromNumber(7))),E=(0,o.assertNumber)(p.add(p.floor((0,o.assertNumber)(p.div((0,o.assertNumber)(p.add((0,o.assertNumber)(p.sub(l,F)),b)),p.fromNumber(7)))),p.one));return g?function(e,t,r,n){const{mathpack:i,datepack:a,config:s}=e,l=Object.assign({},n),c=(t+6-l.wdy)%7;if(12===l.mon&&l.dom+c>=35)return i.one;l.dom=4,l.mon=1;let d=a.toDays(s,l);if((0,u.assertTrue)("calc.funcs.weeknumISOAmendments",!1!==d),d=(d-1)%7+1,(d-t+7)%7<3){const e=(0,o.assertNumber)(i.sub(r,i.one));if(0===i.cond(e)){const e=l.yr-1;return t===d||e%4==0&&(e%100!=0||e%400==0)&&(t-d+7)%7==6?i.fromNumber(53):i.fromNumber(52)}return e}return r}(t,c,E,v):E}t.year=c.bind(void 0,(e=>e.yr)),t.month=c.bind(void 0,(e=>e.mon)),t.day=c.bind(void 0,(e=>e.dom)),t.hour=c.bind(void 0,(e=>e.hour)),t.minute=c.bind(void 0,(e=>e.min)),t.second=c.bind(void 0,(e=>e.sec)),t.weekday=function(e,t){return d(e,t)},t.isoweeknum=g.bind(void 0,!0),t.weeknum=g.bind(void 0,!1);const p=-32768,h=32767,f=1900;function S(e,t){let r;if((0,a.isStringOper)(t)){const i=t.value.replace(/^\s+/,"");if(r=e.coerceOper((0,n.stringOper)(i),l.OperKind.Number),(0,a.isErrorOper)(r))return r}else r=t;return(0,o.chkDateOper)(e,r)}function v(e,t,r){return r?(0,o.assertNumber)(e.sub(t,e.fromNumber(o.atpm1904to1900Days))):t}function y(e,t){return 0!=(e>>t%7&1)}var F;function C(e){switch(e){case 1:return F.Saturday|F.Sunday;case 2:return F.Sunday|F.Monday;case 3:return F.Monday|F.Tuesday;case 4:return F.Tuesday|F.Wednesday;case 5:return F.Wednesday|F.Thursday;case 6:return F.Thursday|F.Friday;case 7:return F.Friday|F.Saturday;case 11:return F.Sunday;case 12:return F.Monday;case 13:return F.Tuesday;case 14:return F.Wednesday;case 15:return F.Thursday;case 16:return F.Friday;case 17:return F.Saturday;default:return!1}}function R(e){if(7!==e.length)return!1;let t=F.None;for(let r=0;r<e.length;r+=1)if("1"===e[r])t|=1<<(r+2)%7;else if("0"!==e[r])return!1;return t}function b(e,[t,r,i,u]){let c=F.Saturday|F.Sunday,d=(0,o.chkDateOper)(e,t);if((0,a.isErrorOper)(d))return d;let m=(0,o.chkNumOper)(e,r);if((0,a.isErrorOper)(m))return m;const{mathpack:g,config:p}=e;m=g.floor(m);const h=g.cond(m)>0?g.one:g.fromNumber(-1);let f=g.abs(m);const S=(0,o.assertNumber)(g.add(d,m));if(!(0,o.validDateRange)(e,S))return n.numErrorOper;if(0===g.cond(f))return v(g,d,p.date1904);let b=null;const E=[];if(i){if(!(0,a.isMissingOper)(i)){if((0,a.isNumberOper)(i)){const e=C(g.lfix(i));if(!1===e)return n.numErrorOper;c=e}else{if(!(0,a.isStringOper)(i))return n.numErrorOper;{const e=R(i.value);if(!1===e)return n.valueErrorOper;c=e}}if(127===c)return n.valueErrorOper}if(u&&!(0,a.isMissingOper)(u)){const t=(0,o.chkNumMultiOper)(e,u);if(!(0,s.isSuccess)(t))return t.reason;b=t.value}}const T=null==b?[]:function(e){const t=[],r=e.getSparse(),n=e.cols-e.denseCols;for(let i=0;i<e.denseRows;i+=1){for(let r=0;r<e.denseCols;r+=1){const n=e.get(i,r);void 0!==n&&t.push(n)}if(n>0&&void 0!==r)for(let e=0;e<n;e+=1)t.push(r)}const i=(e.rows-e.denseRows)*e.cols;if(i>0&&void 0!==r)for(let e=0;e<i;e+=1)t.push(r);return t}(b);for(let t=T.length-1;t>=0;t-=1){const r=T[t];switch(r.kind){case l.OperKind.Number:case l.OperKind.String:case l.OperKind.Blank:const i=(0,o.chkDateOper)(e,r);if((0,a.isErrorOper)(i))return i;E[t]=i;break;case l.OperKind.Error:return r;default:return n.valueErrorOper}}for(;g.cond(f)>0;){if(d=(0,o.assertNumber)(g.add(d,h)),y(c,g.lfix(d)))continue;let e=!0;for(let t=0;t<T.length;t+=1)if(0===g.cond2(E[t],d)){e=!1;break}e&&(f=(0,o.assertNumber)(g.sub(f,g.one)))}return d=v(g,d,p.date1904),(0,o.validDateRange)(e,d)?d:n.numErrorOper}t.date=function(e,[t,r,o]){const{mathpack:a,datepack:s,config:l}=e;let u=a.sfix(t);if(u>9999)return n.numErrorOper;const c=a.sfix(r);if(c>h||c<p)return n.numErrorOper;let d=a.sfix(o);(d>h||d<p)&&(d=h),l.dateCompatibility?u<f&&(u+=1900):u<f&&!(1899===u&&12===c&&d>=30)&&(u+=1900);const m=(0,i.dateTime)(u,c,d,0,0,0,0,0,i.Rounding.RoundSec);return s.toNum(l,m)},t.time=function(e,[t,r,o]){const{mathpack:s,datepack:l,config:u}=e,c=s.sfix(t);if(c>32767)return n.numErrorOper;const d=s.sfix(r);if(d>32767)return n.numErrorOper;const m=s.sfix(o);if(m>32767)return n.numErrorOper;let g,p,h;u.dateCompatibility?(g=u.date1904?1904:1900,p=1,h=u.date1904?1:0):(g=1899,p=12,h=30);const f=(0,i.dateTime)(g,p,h,c,d,m,0,0,i.Rounding.RoundSec),S=l.toNum(u,f);return(0,a.isErrorOper)(S)?S:s.cond(S)<0?n.numErrorOper:s.sub(S,s.trunc(S))},t.days360=function(e,[t,r,o]){var a;const{mathpack:s,datepack:l,config:u}=e,c=null!==(a=null==o?void 0:o.value)&&void 0!==a&&a,d=l.fromNum(u,t,i.Rounding.RoundSec);if(!1===d)return n.naErrorOper;const m=31===d.dom||!c&&2===d.mon&&d.dom===l.daysPerMonth(2,d.yr,u.dateCompatibility)?30:d.dom,g=s.fromNumber(360*(d.yr-f)+30*d.mon+m),p=l.fromNum(u,r,i.Rounding.RoundSec);if(!1===p)return n.naErrorOper;const h=31!==p.dom||!c&&30!==d.dom?p.dom:30,S=s.fromNumber(360*(p.yr-f)+30*p.mon+h);return s.sub(S,g)},t.datedif=function(e,[t,r,{value:o}]){if(o.length>2||0===o.length)return n.numErrorOper;const{mathpack:a,datepack:s,config:l}=e,u=a.lfix(t),c=s.fromNum(l,t,i.Rounding.RoundSec);if(!1===c)return n.numErrorOper;const d=e.mathpack.lfix(r),m=s.fromNum(l,r,i.Rounding.RoundSec);if(!1===m)return n.numErrorOper;if(u>d)return n.numErrorOper;let g=m.dom,p=m.mon,h=m.yr;c.dom>g&&(p-=1,0===p&&(p=12,h-=1),g+=s.daysPerMonth(p,h,l.dateCompatibility)),c.mon>p&&(p+=12,h-=1);const f=(e,t)=>0===l.localeInfo.stringCompareCI(e,t);if(f(o,"Y"))return a.fromNumber(h-c.yr);if(f(o,"M"))return a.fromNumber(12*(h-c.yr)+(p-c.mon));if(f(o,"D"))return a.fromNumber(d-u);if(f(o,"MD"))return a.fromNumber(g-c.dom);if(f(o,"YM"))return a.fromNumber(p-c.mon);if(f(o,"YD")){let e=0;for(let t=c.mon;t<p;t+=1)e+=s.daysPerMonth(t,c.yr,l.dateCompatibility);return a.fromNumber(e+(g-c.dom))}return n.numErrorOper},t.days=function(e,[t,r]){if((0,a.isStringOper)(t)&&t.value.length>255||(0,a.isStringOper)(r)&&r.value.length>255)return n.valueErrorOper;const i=S(e,t);if((0,a.isErrorOper)(i))return i;const o=S(e,r);return(0,a.isErrorOper)(o)?o:e.mathpack.sub(i,o)},function(e){e[e.None=0]="None",e[e.Saturday=1]="Saturday",e[e.Sunday=2]="Sunday",e[e.Monday=4]="Monday",e[e.Tuesday=8]="Tuesday",e[e.Wednesday=16]="Wednesday",e[e.Thursday=32]="Thursday",e[e.Friday=64]="Friday"}(F||(F={})),t.workday_intl=b,t.workday=function(e,[t,r,i]){return b(e,i?[t,r,n.missingOper,i]:[t,r])};const E=1900,T=-9999;function k(e,t,[r,s]){const l=(0,o.chkDateOper)(t,r);if((0,a.isErrorOper)(l))return l;let u=(0,o.chkNumOper)(t,s);if((0,a.isErrorOper)(u))return u;const{mathpack:c,config:d}=t;u=c.cond(u)>0?c.floor(u):c.ceil(u);const m=function(e,t,r,n){const{mathpack:s,datepack:l,config:u}=e,c=Object.assign(Object.assign({},u),{date1904:!1}),d=l.fromNum(c,t,i.Rounding.RoundSec);if(!1===d)return d;let m=s.fromNumber(d.dom),g=s.fromNumber(d.mon);const p=s.fromNumber(12);let h=s.fromNumber(d.yr);if(s.cond(r)>=0){h=(0,o.assertNumber)(s.add(s.floor((0,o.assertNumber)(s.div(r,p))),h));const e=(0,o.assertNumber)((0,o.numMod)(s,r,p)),t=(0,o.assertNumber)(s.add(e,g));1===s.cond2(t,p)&&(h=(0,o.assertNumber)(s.add(h,s.one))),g=(0,o.assertNumber)((0,o.numMod)(s,t,p))}else{const e=s.neg(r),t=s.floor((0,o.assertNumber)(s.div(e,p)));h=(0,o.assertNumber)(s.sub(h,t));const n=(0,o.assertNumber)((0,o.numMod)(s,e,p));if(s.cond2(n,g)>=0)h=(0,o.assertNumber)(s.sub(h,s.one)),g=(0,o.assertNumber)(s.add((0,o.assertNumber)(s.sub(g,n)),p));else{const e=(0,o.assertNumber)(s.sub(g,n));g=(0,o.assertNumber)((0,o.numMod)(s,e,p))}}0===s.cond(g)&&(g=p);const f=s.lfix(g);switch(f){case 4:case 6:case 9:case 11:const e=s.fromNumber(30);s.cond2(m,e)>0&&(m=e);break;case 2:s.cond2(m,s.fromNumber(28))>0&&(m=s.fromNumber(l.daysPerMonth(2,s.toNumber(h),!1)))}if(n&&(m=s.fromNumber(l.daysPerMonth(f,s.toNumber(h),!1))),s.lfix(h)<(c.dateCompatibility?E:T))return!1;const S=function(e,t,r,n,o,a){const s=e.lfix(n),l=e.lfix(o),u=e.lfix(a);return t.toNum(r,(0,i.dateTime)(u,l,s,0,0,0,0,0,i.Rounding.RoundSec))}(s,l,c,m,g,h);return!(0,a.isErrorOper)(S)&&S}(t,l,u,!e);return!1===m?n.numErrorOper:v(c,m,d.date1904)}function P(e,[t,r,i,s]){const u=e.mathpack;let c,d=F.Saturday|F.Sunday,m=5;function g(e){d=e,m=7;let t=d;for(;0!==t;)1==(1&t)&&(m-=1),t>>=1}if(void 0!==i&&!(0,a.isMissingOper)(i))if((0,a.isStringOper)(i)){const e=R(i.value);if(!1===e)return n.valueErrorOper;g(e)}else{const t=(0,o.chkNumOper)(e,i);if((0,a.isErrorOper)(t))return n.valueErrorOper;const r=C(u.lfix(t));if(!1===r)return n.numErrorOper;g(r)}const p=null!=s?s:n.missingOper,h=(0,o.chkDateOper)(e,t);if((0,a.isErrorOper)(h))return h;const f=(0,o.chkDateOper)(e,r);if((0,a.isErrorOper)(f))return f;let S,v=u.lfix(h),b=u.lfix(f);v>b?(S=v,v=b,b=S,c=-1):c=1,S=v%7,S=b%7;let E=0,T=v<b?v:b,k=v<b?b:v;for(;T%7!=0&&T!==k;)y(d,T)||(E+=1),T+=1;for(;k%7!=6&&T!==k;)y(d,k)||(E+=1),k-=1;if(k===T&&1!=(d>>T%7&1)&&(E+=1),v>b){const e=T;T=k,k=e}let P=u.fromNumber(m*Math.floor((k+1-T)/7)+E);switch(p.kind){case l.OperKind.Number:case l.OperKind.String:const t=(0,o.chkDateOper)(e,p);if((0,a.isErrorOper)(t))return t;S=u.lfix(t),S>=v&&S<=b&&S%7>=2&&(P=(0,o.assertNumber)(u.sub(P,u.one)));break;case l.OperKind.Range:case l.OperKind.Array:const r=function(e,t,r,i,s,u){let c;const d=e.mathpack;if(void 0===u||(0,a.isMissingOper)(u))c=F.Saturday|F.Sunday;else if((0,a.isStringOper)(u)){const e=R(u.value);if(!1===e)return n.valueErrorOper;c=e}else{const t=(0,o.chkNumOper)(e,u);if((0,a.isErrorOper)(t))return n.valueErrorOper;const r=C(d.lfix(t));if(!1===r)return n.numErrorOper;c=r}const m=d.fromNumber(r),g=d.fromNumber(i),p=e.dereferenceOper(s,l.OperKind.Array);if(!(0,a.isArrayOper)(p))return n.valueErrorOper;const h=[];function f(e){if(d.cond2(e,m)>=0&&d.cond2(e,g)<=0){const t=d.lfix(e);y(c,t)||h.push(e)}}for(let t=0;t<p.rows;t+=1)for(let r=0;r<p.cols;r+=1){const i=p.opers[t][r];switch(i.kind){case l.OperKind.Number:case l.OperKind.String:const t=(0,o.chkDateOper)(e,i);if((0,a.isErrorOper)(t))return t;f(t);break;case l.OperKind.Blank:break;case l.OperKind.Error:return i;default:return n.valueErrorOper}}let S=t;if(0!==h.length){const e=h.sort(((e,t)=>d.cond2(e,t)));let t=e[0];S=(0,o.assertNumber)(d.sub(S,d.one));for(let r=0;r<e.length;r+=1){const n=e[r];0!==d.cond2(n,t)&&(t=n,S=(0,o.assertNumber)(d.sub(S,d.one)))}}return S}(e,P,v,b,p,i);if((0,a.isErrorOper)(r))return r;P=r;break;case l.OperKind.Error:return p;case l.OperKind.Missing:break;default:return n.valueErrorOper}return u.mul(u.fromNumber(c),P)}function N(e,t,r,n,i,o,a){const{mathpack:s}=e,l=360*(r-t),u=30*(i-n);return s.fromNumber(a-o+u+l)}function A(e,t,r,n){const{datepack:i,config:o}=e;return t===i.daysPerMonth(r,n,o.dateCompatibility)}var I;t.edate=k.bind(void 0,!0),t.eomonth=k.bind(void 0,!1),t.networkdays_intl=P,t.networkdays=function(e,[t,r,i]){return P(e,i?[t,r,n.missingOper,i]:[t,r])},function(e){e[e.DefaultBasis=0]="DefaultBasis",e[e.Basis30360=0]="Basis30360",e[e.BasisActual=1]="BasisActual",e[e.BasisActual360=2]="BasisActual360",e[e.BasisActual365=3]="BasisActual365",e[e.BasisE30360=4]="BasisE30360"}(I||(I={})),t.yearFrac=function(e,[t,r,s]){let l=I.DefaultBasis;if(void 0!==s){const t=function(e,t){let r=I.DefaultBasis;if(void 0===t||(0,a.isMissingOper)(t))return r;const i=(0,o.chkNumOper)(e,t);if((0,a.isErrorOper)(i))return i;const s=e.mathpack;switch(r=s.lfix(s.floor(i)),r){case I.Basis30360:case I.BasisActual:case I.BasisActual360:case I.BasisActual365:case I.BasisE30360:return r;default:return n.numErrorOper}}(e,s);if("number"!=typeof t)return t;l=t}let u=(0,o.chkDateOper)(e,t);if((0,a.isErrorOper)(u))return u;let c=(0,o.chkDateOper)(e,r);if((0,a.isErrorOper)(c))return c;const d=e.mathpack;if(d.cond2(u,c)>0){const e=u;u=c,c=e}const m=function(e,t,r,n,a){const s=e.mathpack;switch(s.cond2(t,r)){case 1:break;case 0:return s.zero;case-1:switch(n){case I.Basis30360:return function(e,t,r,n,o){const{datepack:a,config:s}=e,l=a.fromNum(s,t,i.Rounding.RoundSec);if(!1===l)return!1;let u=l.dom;const c=l.mon,d=l.yr,m=a.fromNum(s,r,i.Rounding.RoundSec);if(!1===m)return!1;let g=m.dom;const p=m.mon,h=m.yr;return 2===g&&A(e,g,p,h)&&(2===u&&A(e,u,c,d)||3===n)&&(g=30),31===g&&(u>=30||3===n)&&(g=30),31===u&&(u=30),2===c&&A(e,u,c,d)&&(u=30),N(e,d,h,c,p,u,g)}(e,t,r,a);case I.BasisActual360:case I.BasisActual365:case I.BasisActual:return(0,o.assertNumber)(s.sub(r,t));case I.BasisE30360:return function(e,t,r){const{datepack:n,config:o}=e,a=n.fromNum(o,t,i.Rounding.RoundSec);if(!1===a)return!1;let s=a.dom;const l=a.mon,u=a.yr,c=n.fromNum(o,r,i.Rounding.RoundSec);if(!1===c)return!1;let d=c.dom;const m=c.mon;return 31===s&&(s=30),31===d&&(d=30),N(e,u,c.yr,l,m,s,d)}(e,t,r)}}return!1}(e,u,c,l,0);if(!1===m)return n.numErrorOper;const g=function(e,t,r,n){const{mathpack:s,datepack:l,config:u}=e,c=s.fromNumber(360),d=s.fromNumber(365),m=s.fromNumber(366);switch(t){case I.BasisActual:const e=l.fromNum(u,r,i.Rounding.RoundSec);if(!1===e)return!1;const t=e.dom,g=e.mon,p=e.yr,h=l.fromNum(u,n,i.Rounding.RoundSec);if(!1===h)return!1;const f=h.dom,S=h.mon,v=h.yr,y=v-1;if(p===v)return 29===l.daysPerMonth(2,p,u.dateCompatibility)?m:d;if(y===p&&(g>S||g===S&&t>=f)){if(29===l.daysPerMonth(2,p,u.dateCompatibility)){const e=l.toNum(u,(0,i.dateTime)(p,2,29,0,0,0,0,0,i.Rounding.RoundSec));return!(0,a.isErrorOper)(e)&&(s.cond2(e,r)>=0?m:d)}if(29===l.daysPerMonth(2,v,u.dateCompatibility)){const e=l.toNum(u,(0,i.dateTime)(p,2,29,0,0,0,0,0,i.Rounding.RoundSec));return!(0,a.isErrorOper)(e)&&(s.cond2(e,n)<=0?m:d)}return d}let F=0;for(let e=p;e<=v;e+=1)29===l.daysPerMonth(2,e,u.dateCompatibility)?F+=366:F+=365;const C=s.fromNumber(v-p+1);return(0,o.assertNumber)(s.div(s.fromNumber(F),C));case I.Basis30360:case I.BasisActual360:case I.BasisE30360:return c;case I.BasisActual365:return d;default:return c}}(e,l,u,c);return!1===g?n.numErrorOper:d.div(m,g)}},89678:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.gestep=t.delta=void 0;const n=r(53964),i=r(57263);function o(e,t){const[r,o]=t,a=void 0===o||(0,i.isMissingOper)(o)?e.mathpack.zero:(0,n.chkNumOper)(e,o);if((0,i.isErrorOper)(a))return a;const s=(0,n.chkNumOper)(e,r);return(0,i.isErrorOper)(s)?s:[s,a]}t.delta=function(e,t){const r=o(e,t);if(!Array.isArray(r))return r;const[n,i]=r,a=e.mathpack;return 0===a.cond2(n,i)?a.one:a.zero},t.gestep=function(e,t){const r=o(e,t);if(!Array.isArray(r))return r;const[n,i]=r,a=e.mathpack;return a.cond2(n,i)>=0?a.one:a.zero}},32402:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFunc=void 0;const n=r(19181),i=n.__importStar(r(70157)),o=n.__importStar(r(57762)),a=n.__importStar(r(89678)),s=n.__importStar(r(85125)),l=n.__importStar(r(30096)),u=n.__importStar(r(49958)),c=n.__importStar(r(82539)),d=n.__importStar(r(9955)),m=n.__importStar(r(71144)),g=n.__importStar(r(82692)),p=n.__importStar(r(96660)),h=n.__importStar(r(75262)),f=n.__importStar(r(49868)),S=n.__importStar(r(76250)),v=n.__importStar(r(80049)),y=n.__importStar(r(4457)),F=n.__importStar(r(33532)),C=r(16824),R=r(75929),b={};b[R.WorksheetFuncId.SUM]=i.sum,b[R.WorksheetFuncId.PRODUCT]=i.product,b[R.WorksheetFuncId.AVERAGE]=i.average,b[R.WorksheetFuncId.COUNTBLANK]=i.countblank,b[R.WorksheetFuncId.MAX]=i.max,b[R.WorksheetFuncId.MIN]=i.min,b[R.WorksheetFuncId.AND]=i.and,b[R.WorksheetFuncId.COUNTA]=i.counta,b[R.WorksheetFuncId.OR]=i.or,b[R.WorksheetFuncId.CONCAT]=i.concat,b[R.WorksheetFuncId.AVERAGEIF]=i.averageif,b[R.WorksheetFuncId.AVERAGEIFS]=i.averageifs,b[R.WorksheetFuncId.COUNT]=i.count,b[R.WorksheetFuncId.COUNTIF]=i.countif,b[R.WorksheetFuncId.COUNTIFS]=i.countifs,b[R.WorksheetFuncId.MEDIAN]=i.median,b[R.WorksheetFuncId.SUMSQ]=i.sumsq,b[R.WorksheetFuncId.SUMIF]=i.sumif,b[R.WorksheetFuncId.SUMIFS]=i.sumifs,b[R.WorksheetFuncId.LARGE]=i.large,b[R.WorksheetFuncId.SMALL]=i.small,b[R.WorksheetFuncId.RANK]=i.rank,b[R.WorksheetFuncId.RANK_EQ]=i.rank,b[R.WorksheetFuncId.RANK_AVG]=i.rank_avg,b[R.WorksheetFuncId.PERCENTILE]=i.percentile,b[R.WorksheetFuncId.PERCENTILE_INC]=i.percentile,b[R.WorksheetFuncId.PERCENTILE_EXC]=i.percentile_exc,b[R.WorksheetFuncId.QUARTILE]=i.quartile,b[R.WorksheetFuncId.QUARTILE_INC]=i.quartile,b[R.WorksheetFuncId.QUARTILE_EXC]=i.quartile_exc,b[R.WorksheetFuncId.TRIMMEAN]=i.trimmean,b[R.WorksheetFuncId.AVERAGEA]=i.averagea,b[R.WorksheetFuncId.MAXA]=i.maxa,b[R.WorksheetFuncId.MINA]=i.mina,b[R.WorksheetFuncId.MAXIFS]=i.maxifs,b[R.WorksheetFuncId.MINIFS]=i.minifs,b[R.WorksheetFuncId.XOR]=i.xor,b[R.WorksheetFuncId.AGGREGATE]=i.aggregate,b[R.WorksheetFuncId.SUBTOTAL]=i.subtotal,b[R.WorksheetFuncId.VAR]=i.var_,b[R.WorksheetFuncId.VAR_S]=i.var_,b[R.WorksheetFuncId.VARP]=i.varp,b[R.WorksheetFuncId.VAR_P]=i.varp,b[R.WorksheetFuncId.STDEV]=i.stdev,b[R.WorksheetFuncId.STDEV_S]=i.stdev,b[R.WorksheetFuncId.STDEVP]=i.stdevp,b[R.WorksheetFuncId.STDEV_P]=i.stdevp,b[R.WorksheetFuncId.VARA]=i.vara,b[R.WorksheetFuncId.VARPA]=i.varpa,b[R.WorksheetFuncId.STDEVA]=i.stdeva,b[R.WorksheetFuncId.STDEVPA]=i.stdevpa,b[R.WorksheetFuncId.AVEDEV]=i.avedev,b[R.WorksheetFuncId.DEVSQ]=i.devsq,b[R.WorksheetFuncId.MODE]=i.mode,b[R.WorksheetFuncId.MODE_SNGL]=i.mode,b[R.WorksheetFuncId.MODE_MULT]=i.mode_mult,b[R.WorksheetFuncId.TEXTJOIN]=i.textjoin,b[R.WorksheetFuncId.YEAR]=o.year,b[R.WorksheetFuncId.MONTH]=o.month,b[R.WorksheetFuncId.DAY]=o.day,b[R.WorksheetFuncId.HOUR]=o.hour,b[R.WorksheetFuncId.MINUTE]=o.minute,b[R.WorksheetFuncId.SECOND]=o.second,b[R.WorksheetFuncId.WEEKNUM]=o.weeknum,b[R.WorksheetFuncId.ISOWEEKNUM]=o.isoweeknum,b[R.WorksheetFuncId.WEEKDAY]=o.weekday,b[R.WorksheetFuncId.DATE]=o.date,b[R.WorksheetFuncId.TIME]=o.time,b[R.WorksheetFuncId.DAYS360]=o.days360,b[R.WorksheetFuncId.DAYS]=o.days,b[R.WorksheetFuncId.DATEDIF]=o.datedif,b[R.WorksheetFuncId.WORKDAY]=o.workday,b[R.WorksheetFuncId.WORKDAY_INTL]=o.workday_intl,b[R.WorksheetFuncId.EDATE]=o.edate,b[R.WorksheetFuncId.EOMONTH]=o.eomonth,b[R.WorksheetFuncId.NETWORKDAYS]=o.networkdays,b[R.WorksheetFuncId.NETWORKDAYS_INTL]=o.networkdays_intl,b[R.WorksheetFuncId.YEARFRAC]=o.yearFrac,b[R.WorksheetFuncId.DELTA]=a.delta,b[R.WorksheetFuncId.GESTEP]=a.gestep,b[R.WorksheetFuncId.NA]=s.na,b[R.WorksheetFuncId.T]=s.t_,b[R.WorksheetFuncId.N]=s.n_,b[R.WorksheetFuncId.TYPE]=s.type,b[R.WorksheetFuncId.ERROR_TYPE]=s.error_type,b[R.WorksheetFuncId.INFO]=s.info,b[R.WorksheetFuncId.IF]=u.if_,b[R.WorksheetFuncId.IFS]=u.ifs,b[R.WorksheetFuncId.SWITCH]=u.switch_,b[R.WorksheetFuncId.TRUE]=u.true_,b[R.WorksheetFuncId.FALSE]=u.false_,b[R.WorksheetFuncId.NOT]=u.not,b[R.WorksheetFuncId.CHOOSE]=u.choose,b[R.WorksheetFuncId.INDEX]=c.index,b[R.WorksheetFuncId.MATCH]=c.match,b[R.WorksheetFuncId.LOOKUP]=c.lookup,b[R.WorksheetFuncId.HLOOKUP]=c.hlookup,b[R.WorksheetFuncId.VLOOKUP]=c.vlookup,b[R.WorksheetFuncId.ABS]=d.abs,b[R.WorksheetFuncId.CEILING]=d.ceiling,b[R.WorksheetFuncId.ECMA_CEILING]=d.ceiling,b[R.WorksheetFuncId.DEGREES]=d.degrees,b[R.WorksheetFuncId.FLOOR]=d.floor,b[R.WorksheetFuncId.RADIANS]=d.radians,b[R.WorksheetFuncId.ROUND]=d.round,b[R.WorksheetFuncId.ROUNDUP]=d.roundup,b[R.WorksheetFuncId.ROUNDDOWN]=d.rounddown,b[R.WorksheetFuncId.EVEN]=d.even,b[R.WorksheetFuncId.SIGN]=d.sign,b[R.WorksheetFuncId.PI]=d.pi,b[R.WorksheetFuncId.SQRT]=d.sqrt,b[R.WorksheetFuncId.EXP]=d.exp,b[R.WorksheetFuncId.POWER]=d.power,b[R.WorksheetFuncId.LN]=d.ln,b[R.WorksheetFuncId.LOG10]=d.log10,b[R.WorksheetFuncId.LOG]=d.log,b[R.WorksheetFuncId.SIN]=d.sin,b[R.WorksheetFuncId.COS]=d.cos,b[R.WorksheetFuncId.TAN]=d.tan,b[R.WorksheetFuncId.ASIN]=d.asin,b[R.WorksheetFuncId.ACOS]=d.acos,b[R.WorksheetFuncId.ATAN]=d.atan,b[R.WorksheetFuncId.ATAN2]=d.atan2,b[R.WorksheetFuncId.FACT]=d.fact,b[R.WorksheetFuncId.SQRTPI]=d.sqrtpi,b[R.WorksheetFuncId.FACTDOUBLE]=d.factdouble,b[R.WorksheetFuncId.INT]=d.int,b[R.WorksheetFuncId.TRUNC]=d.trunc,b[R.WorksheetFuncId.ODD]=d.odd,b[R.WorksheetFuncId.MROUND]=d.mround,b[R.WorksheetFuncId.QUOTIENT]=d.quotient,b[R.WorksheetFuncId.FLOOR_MATH]=d.floor_math,b[R.WorksheetFuncId.FLOOR_PRECISE]=d.floor_precise,b[R.WorksheetFuncId.CEILING_MATH]=d.ceiling_math,b[R.WorksheetFuncId.CEILING_PRECISE]=d.ceiling_precise,b[R.WorksheetFuncId.ISO_CEILING]=d.ceiling_precise,b[R.WorksheetFuncId.TEXT]=m.text,b[R.WorksheetFuncId.FIXED]=m.fixed,b[R.WorksheetFuncId.DOLLAR]=m.dollar,b[R.WorksheetFuncId.VALUE]=m.value,b[R.WorksheetFuncId.DATEVALUE]=m.datevalue,b[R.WorksheetFuncId.TIMEVALUE]=m.timevalue,b[R.WorksheetFuncId.ISERROR]=g.iserror,b[R.WorksheetFuncId.ISERR]=g.iserr,b[R.WorksheetFuncId.ISBLANK]=g.isblank,b[R.WorksheetFuncId.ISLOGICAL]=g.islogical,b[R.WorksheetFuncId.ISNA]=g.isna,b[R.WorksheetFuncId.ISNONTEXT]=g.isnontext,b[R.WorksheetFuncId.ISTEXT]=g.istext,b[R.WorksheetFuncId.ISNUMBER]=g.isnumber,b[R.WorksheetFuncId.ISREF]=g.isref,b[R.WorksheetFuncId.ISEVEN]=g.iseven,b[R.WorksheetFuncId.ISODD]=g.isodd,b[R.WorksheetFuncId.ISFORMULA]=g.isformula,b[R.WorksheetFuncId.FORMULATEXT]=g.formulatext,b[R.WorksheetFuncId.ROWS]=p.rows,b[R.WorksheetFuncId.COLUMNS]=p.columns,b[R.WorksheetFuncId.AREAS]=p.areas,b[R.WorksheetFuncId.SHEETS]=p.sheets,b[R.WorksheetFuncId.ROW]=p.row,b[R.WorksheetFuncId.COLUMN]=p.column,b[R.WorksheetFuncId.SHEET]=p.sheet,b[R.WorksheetFuncId.OFFSET]=p.offset,b[R.WorksheetFuncId.TRANSPOSE]=p.transpose,b[R.WorksheetFuncId.SINGLE]=p.single,b[R.WorksheetFuncId.ADDRESS]=f.address,b[R.WorksheetFuncId.INDIRECT]=f.indirect,b[R.WorksheetFuncId.LEFT]=S.left,b[R.WorksheetFuncId.RIGHT]=S.right,b[R.WorksheetFuncId.MID]=S.mid,b[R.WorksheetFuncId.LEN]=S.len,b[R.WorksheetFuncId.CONCATENATE]=S.concatenate,b[R.WorksheetFuncId.EXACT]=S.exact,b[R.WorksheetFuncId.REPT]=S.rept,b[R.WorksheetFuncId.TRIM]=S.trim,b[R.WorksheetFuncId.CLEAN]=S.clean,b[R.WorksheetFuncId.CHAR]=S.char,b[R.WorksheetFuncId.UNICHAR]=S.unichar,b[R.WorksheetFuncId.CODE]=S.code,b[R.WorksheetFuncId.UNICODE]=S.unicode,b[R.WorksheetFuncId.LOWER]=S.lower,b[R.WorksheetFuncId.UPPER]=S.upper,b[R.WorksheetFuncId.PROPER]=S.proper,b[R.WorksheetFuncId.FIND]=S.find,b[R.WorksheetFuncId.REPLACE]=S.replace,b[R.WorksheetFuncId.SEARCH]=S.search,b[R.WorksheetFuncId.SUBSTITUTE]=S.substitute,b[R.WorksheetFuncId.RAND]=v.rand,b[R.WorksheetFuncId.RANDBETWEEN]=v.randbetween,b[R.WorksheetFuncId.NOW]=v.now,b[R.WorksheetFuncId.TODAY]=v.today,b[R.WorksheetFuncId.HYPERLINK]=y.hyperlink,b[R.WorksheetFuncId.FIELDVALUE]=h.fieldvalue,b[R.WorksheetFuncId._FV]=h.fieldvalue,b[R.WorksheetFuncId.MAKEARRAY]=l.makearray,b[R.WorksheetFuncId.ISOMITTED]=g.isomitted;let E=!1;t.getWorksheetFunc=function(e){return E||(E=!0,(0,C.isFeatureEnabled)(C.FeatureName.CalcRecordFunctions)&&(b[R.WorksheetFuncId.RECORD]=h.record),(0,C.isFeatureEnabled)(C.FeatureName.CalcNestedRecordFunction)&&(b[R.WorksheetFuncId.NESTEDRECORD]=h.record),(0,C.isFeatureEnabled)(C.FeatureName.CalcLambdaBasicFunctions)&&(b[R.WorksheetFuncId.APPLY]=l.apply,b[R.WorksheetFuncId.ISLAMBDA]=g.islambda),(0,C.isTypedChangeGateEnabled)("OfficeVSO:8501373_CalcTsFuncsFirstSlice")&&(b[R.WorksheetFuncId.TAKE]=f.take,b[R.WorksheetFuncId.DROP]=f.drop,b[R.WorksheetFuncId.SEQUENCE]=f.sequence,b[R.WorksheetFuncId.TEXTBEFORE]=S.textBefore,b[R.WorksheetFuncId.TEXTAFTER]=S.textAfter,b[R.WorksheetFuncId.TEXTSPLIT]=S.textSplit,b[R.WorksheetFuncId.HSTACK]=f.hstack,b[R.WorksheetFuncId.VSTACK]=f.vstack),(0,C.isTypedChangeGateEnabled)("OfficeVSO_8554430_CalcTsColRowSumProdFuncs")&&(b[R.WorksheetFuncId.CHOOSECOLS]=f.choosecols,b[R.WorksheetFuncId.CHOOSEROWS]=f.chooserows,b[R.WorksheetFuncId.TOCOL]=f.tocol,b[R.WorksheetFuncId.TOROW]=f.torow,b[R.WorksheetFuncId.SUMPRODUCT]=i.sumproduct),(0,C.getTypedFeatureGate)("Microsoft.Office.Excel.CalcTsDec2023Funcs")&&(b[R.WorksheetFuncId.GEOMEAN]=i.geomean,b[R.WorksheetFuncId.HARMEAN]=i.harmean,b[R.WorksheetFuncId.FILTER]=F.filter,b[R.WorksheetFuncId.SORT]=F.sort,b[R.WorksheetFuncId.SORTBY]=F.sortby,b[R.WorksheetFuncId.UNIQUE]=F.unique,b[R.WorksheetFuncId.MAP]=l.map,b[R.WorksheetFuncId.BYROW]=l.byrow,b[R.WorksheetFuncId.BYCOL]=l.bycol,b[R.WorksheetFuncId.REDUCE]=l.reduce,b[R.WorksheetFuncId.SCAN]=l.scan,b[R.WorksheetFuncId.XLOOKUP]=c.xlookup,b[R.WorksheetFuncId.XMATCH]=c.xmatch,b[R.WorksheetFuncId.MOD]=d.mod,b[R.WorksheetFuncId.NUMBERVALUE]=m.numbervalue,b[R.WorksheetFuncId.ARRAYTOTEXT]=m.arraytotext,b[R.WorksheetFuncId.VALUETOTEXT]=m.valuetotext,b[R.WorksheetFuncId.EXPAND]=f.expand,b[R.WorksheetFuncId.WRAPCOLS]=f.wrapcols,b[R.WorksheetFuncId.WRAPROWS]=f.wraprows,b[R.WorksheetFuncId.RANDARRAY]=v.randarray)),b[e]}},85125:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.info=t.error_type=t.type=t.n_=t.t_=t.na=void 0;const n=r(51286),i=r(76964),o=r(57263),a=r(88065),s=r(72006),l=r(22501),u=r(1386);function c(e,t){if((0,o.isRangeOper)(t)){if((0,o.isSheetIndex)(t.sheets)){const r=(0,n.rangeSeqOper)(t.sheets,[(0,o.gridRangeAnchor)(t.ranges[0])]);return e.dereferenceOper(r,i.readOperType)}return n.valueErrorOper}return t}t.na=function(e,t){return n.naErrorOper},t.t_=function(e,[t]){const r=c(e,t);return(0,o.isStringOper)(r)||(0,o.isErrorOper)(r)?r:l.emptyStringOper},t.n_=function(e,[t]){const r=c(e,t);if((0,o.isNumberOper)(r)||(0,o.isErrorOper)(r))return r;const n=e.mathpack;return(0,o.isBooleanOper)(r)&&r.value?n.one:n.zero},t.type=function(e,[t]){const r=e.mathpack;switch(t.kind){case s.OperKind.Number:return r.fromNumber(1);case s.OperKind.String:return r.fromNumber(2);case s.OperKind.Boolean:return r.fromNumber(4);case s.OperKind.Error:return r.fromNumber(16);case s.OperKind.Array:return r.fromNumber(64);case s.OperKind.Rich:return r.fromNumber(128);default:return(0,a.assertNever)("calc.funcs.type",t)}},t.error_type=function(e,[t]){return(0,o.isErrorOper)(t)?(t.type>n.ErrorType.CALC&&(0,u.throwEvaluationError)((0,o.notImplemented)(["ERROR.TYPE for "+String(t.type)])),e.mathpack.fromNumber(t.type)):n.naErrorOper},t.info=function(e,t){return n.valueErrorOper}},30096:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scan=t.reduce=t.bycol=t.byrow=t.map=t.makearray=t.apply=void 0;const n=r(51286),i=r(91700),o=r(76964),a=r(76964),s=r(1386),l=r(57263),u=r(75929),c=r(53964),d=r(72006),m=r(69547),g=r(88065),p=r(737),h=r(72933);function f(e,t,r){const o=function(e,t){return(0,l.isRangeOper)(t)&&(0,l.isSheetIndex)(t.sheets)&&1===t.ranges.length&&(0,l.isGridCell)(t.ranges[0])?e.dereferenceOper(t,d.SignatureType.All&~d.OperKind.Range):t}(e,t);return o instanceof i.LambdaOper&&o.checkArity(r)?o:n.valueErrorOper}function S(e,t){return r=>{let i=r;if((0,l.isRangeOper)(i)){if(!(0,l.isSheetIndex)(i.sheets)||1!==i.ranges.length||!(0,l.isGridCell)(i.ranges[0]))return(0,o.earlyReturn)((0,p.success)(n.calcErrorOper));i=t.dereferenceOper(i,d.SignatureType.All&~d.OperKind.Range),(0,g.assertTrue)("calc.funcs.coerceLambdaRvToArrayElt",!(0,l.isRangeOper)(i))}return(0,l.isArrayOper)(i)?1!==i.rows||1!==i.cols?(0,o.earlyReturn)((0,p.success)(n.calcErrorOper)):i.opers[0][0]:((0,l.isMissingOper)(i)&&(0,s.throwEvaluationError)((0,l.notImplemented)([`${(0,h.englishWorksheetFuncIdToName)(e)}: MissingOper in result`])),i)}}function v(e,t,r,i,o){const s=f(e,i,r.length);if((0,l.isErrorOper)(s))return s;const u=[];for(const e of r){if(!(0,l.isArrayOper)(e)&&!(0,l.isRangeOper)(e))return n.valueErrorOper;const t=(0,c.rangeOrArrayToVal)(e,n.valueErrorOper);if((0,l.isErrorOper)(t))return t;u.push(o((0,c.makeSlicer)(t)))}const d=u.map((e=>e.rows)).reduce(m.fastMin),g=u.map((e=>e.rows)).reduce(m.fastMax),p=u.map((e=>e.cols)).reduce(m.fastMin),h=u.map((e=>e.cols)).reduce(m.fastMax);return(0,c.validateArraySize)(g,h),(0,a.machineCall)(new a.ArrayMachine(e,g,h,((t,r)=>t>=d||r>=p?n.naErrorOper:e.applyLambda(s,u.map((e=>e.slice(t,1,r,1))))),S(t,e)))}function y(e,t,r,i,s){const d=(0,c.rangeOrArrayToVal)(i,n.valueErrorOper);if((0,l.isErrorOper)(d))return d;const m=(0,c.makeSlicer)(d),p=f(e,s,2);if((0,l.isErrorOper)(p))return p;const h=!(0,l.isMissingOper)(r);let v,y=h?r:void 0,F=!0;if(t===u.WorksheetFuncId.REDUCE)v=e=>(y=e,n.blankOper);else{const r=S(t,e);v=e=>{const t=r(e);return t.kind===o.EarlyReturnKind.EarlyReturn||(y=t),t}}const C=(0,a.machineCall)(new a.ArrayMachine(e,m.rows,m.cols,((t,r)=>{const n=F;return F=!1,n&&!h?m.slice(t,1,r,1):((0,g.assertTrue)("calc.funcs.scanReduce",void 0!==y),e.applyLambda(p,[y,m.slice(t,1,r,1)]))}),v));return t===u.WorksheetFuncId.REDUCE?(0,a.machineCall)(new a.ThenMachine(e,(()=>C),(()=>((0,g.assertTrue)("calc.funcs.scanReduce",void 0!==y),y)))):C}t.apply=function(e,[t,...r]){const n=f(e,t,r.length);return(0,l.isErrorOper)(n)?n:e.applyLambda(n,r)},t.makearray=function(e,[t,r,i]){const o=f(e,i,2);if((0,l.isErrorOper)(o))return o;const s=e.mathpack,d=(0,l.isMissingOper)(t)?1:s.fix(t),m=(0,l.isMissingOper)(r)?1:s.fix(r);return d<1||m<1?n.valueErrorOper:((0,c.validateArraySize)(d,m),(0,a.machineCall)(new a.ArrayMachine(e,d,m,((t,r)=>{const n=e.mathpack,i=[n.fromNumber(t+1),n.fromNumber(r+1)];return e.applyLambda(o,i)}),S(u.WorksheetFuncId.MAKEARRAY,e))))},t.map=function(e,t){const r=t.slice(0,t.length-1),n=t[t.length-1];return v(e,u.WorksheetFuncId.MAP,r,n,m.identity)},t.byrow=function(e,t){const r=[t[0]],i=t[1];return void 0===i?n.naErrorOper:v(e,u.WorksheetFuncId.BYROW,r,i,(e=>({rows:e.rows,cols:1,slice:(t,r,n,i)=>e.slice(t,r,0,e.cols)})))},t.bycol=function(e,t){const r=[t[0]],i=t[1];return void 0===i?n.naErrorOper:v(e,u.WorksheetFuncId.BYCOL,r,i,(e=>({rows:1,cols:e.cols,slice:(t,r,n,i)=>e.slice(0,e.rows,n,i)})))},t.reduce=function(e,t){const[r,n,i]=t;return y(e,u.WorksheetFuncId.REDUCE,r,n,i)},t.scan=function(e,t){const[r,n,i]=t;return y(e,u.WorksheetFuncId.SCAN,r,n,i)}},49958:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.not=t.false_=t.true_=t.switch_=t.ifs=t.choose=t.if_=void 0;const n=r(51286),i=r(88065),o=r(22501),a=r(75929),s=r(57263),l=r(1386),u=r(72006),c=(0,o.makeStrict)((0,a.getWorksheetFuncType)(a.WorksheetFuncId.IFS)),d=(0,o.makeStrict)((0,a.getWorksheetFuncType)(a.WorksheetFuncId.SWITCH));function m(e,t,r,n){const i=n.slice();return e.dereferenceOpers(i,t),(0,o.arrayLift)(e,t,(n=>{const i=[];for(let r=0;r<n.length;r+=1){const o=(0,s.getArgType)(t,r,n.length);i[r]=e.coerceOper(n[r],o)}return r(e,i)}),i)}t.if_=function(e,t){const r=t[0];(0,i.assertTrue)("calc.funcs.if: condition is not a boolean",(0,s.isBooleanOper)(r));const n=t[r.value?1:2];return(0,i.assertTrue)("calc.funcs.if: result is undefined",void 0!==n),n},t.choose=function(e,t){const r=t[0];(0,i.assertTrue)("calc.funcs.choose",(0,s.isNumberOper)(r));const o=e.mathpack.fix(r);return o<1||o>t.length-1?n.valueErrorOper:t[o]},t.ifs=function e(t,r){for(let n=0;n<r.length;n+=2){const o=r[n];if((0,s.isArrayOper)(o)){const i=r.slice(n);return m(t,c,e,i)}if((0,s.isErrorOper)(o))return o;if((0,i.assertTrue)("calc.funcs.ifs",(0,s.isBooleanOper)(o)),o.value)return r[n+1]}return n.naErrorOper},t.switch_=function e(t,r){const o=r[0];if((0,s.isArrayOper)(o))return m(t,d,e,r);if((0,s.isErrorOper)(o))return o;const a=function({mathpack:e,localeInfo:t},r){switch(r.kind){case u.OperKind.Number:return t=>(0,s.isRichOper)(t)?(0,l.throwEvaluationError)((0,s.notImplemented)(["SWITCH with a rich value case"])):(0,s.isNumberOper)(t)&&0===e.compare(r,t);case u.OperKind.String:return e=>(0,s.isRichOper)(e)?(0,l.throwEvaluationError)((0,s.notImplemented)(["SWITCH with a rich value case"])):(0,s.isStringOper)(e)&&0===t.stringCompareCI(r.value,e.value);case u.OperKind.Boolean:return e=>(0,s.isRichOper)(e)?(0,l.throwEvaluationError)((0,s.notImplemented)(["SWITCH with a rich value case"])):(0,s.isBooleanOper)(e)&&r.value===e.value;case u.OperKind.Rich:return(0,l.throwEvaluationError)((0,s.notImplemented)(["SWITCH with a rich value condition"]));default:return(0,i.assertNever)("calc.funcs.makeSwitchComparer",r)}}(t.config,o);for(let n=1;n<r.length-1;n+=2){const i=u.OperKind.Error|u.OperKind.Rich|u.OperKind.Number|u.OperKind.Boolean|u.OperKind.String|u.OperKind.Array,o=t.coerceOper(t.dereferenceOper(r[n],i),i);if((0,s.isArrayOper)(o))return m(t,d,e,r);if((0,s.isErrorOper)(o))return o;if(a(o))return r[n+1]}return r.length%2==0?r[r.length-1]:n.naErrorOper},t.true_=function(e,t){return n.trueOper},t.false_=function(e,t){return n.falseOper},t.not=function(e,[t]){return(0,n.booleanOper)(!t.value)}},82539:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xmatch=t.xlookup=t.makeWildcardComparer=t.vlookup=t.hlookup=t.lookup=t.match=t.linearSearch=t.binarySearch=t.makeLookupComparer=t.index=void 0;const n=r(75929),i=r(51286),o=r(92843),a=r(57263),s=r(88065),l=r(1386),u=r(54218),c=r(98224),d=r(64250),m=r(69547),g=r(72006),p=r(85520);function h(e,[t,r,n,o]){const l=e.mathpack,u=l.sfix(r);if(u<0)return i.valueErrorOper;const d=void 0===n?void 0:l.sfix(n);if(void 0!==d&&d<0)return i.valueErrorOper;const p=void 0===o?0:l.sfix(o)-1;if(p<0)return i.valueErrorOper;let h,f;switch(t.kind){case g.OperKind.Range:if(!(0,a.isSheetIndex)(t.sheets))return i.valueErrorOper;if(p>=t.ranges.length)return i.refErrorOper;const e=t.ranges[p];if(void 0===d)if(1===e.rows)h=0,f=u-1;else{if(1!==e.cols)return i.refErrorOper;h=u-1,f=-1}else h=u-1,f=d-1;if(h>=e.rows||f>=e.cols)return i.refErrorOper;const r=(0,c.gridRange)(e.row+(0,m.fastMax)(h,0),e.col+(0,m.fastMax)(f,0),-1===h?e.rows:1,-1===f?e.cols:1);return(0,i.rangeSeqOper)(t.sheets,[r]);case g.OperKind.Array:return p>0?i.refErrorOper:(void 0===d?1===t.rows?(h=0,f=u-1):(h=u-1,f=-1):(h=u-1,f=d-1),h>=t.rows||f>=t.cols?i.refErrorOper:-1===h&&-1===f?t:-1===h?(0,i.arrayOper)(t.rows,1,t.opers.map((e=>[e[f]]))):-1===f?(0,i.arrayOper)(1,t.cols,[t.opers[h]]):t.opers[h][f]);default:return(0,s.assertNever)("calc.funcs.lookupFuncs: INDEX",t)}}t.index=h;const f=e=>e<0?n.OperatorId.Lt:e>0?n.OperatorId.Gt:n.OperatorId.Eq,S=(e,t,r)=>f(e.cond2(t,r)),v=(e,t)=>f(e-t);function y(e,t,r=!1){const i=!0,{localeInfo:o,mathpack:c}=e.config;let d;switch(t.kind){case g.OperKind.Number:d=e=>({correctType:i,sgnT:S(c,e,t)});break;case g.OperKind.String:if(r){const e=new u.WildExp(o,t.value);d=t=>({correctType:i,sgnT:e.test(t.value)?n.OperatorId.Eq:n.OperatorId.Ne})}else d=e=>({correctType:i,sgnT:f(o.stringCompareCI(e.value,t.value))});break;case g.OperKind.Boolean:d=e=>({correctType:i,sgnT:v(e.value,t.value)});break;case g.OperKind.Rich:return(0,l.throwEvaluationError)((0,a.notImplemented)(["lookup with rich value condition"]));case g.OperKind.Blank:d=()=>({correctType:i,sgnT:n.OperatorId.Eq});break;default:return(0,s.assertNever)("calc.funcs.makeLookupComparer",t)}return e=>{const r=(0,a.isRichOper)(e)?e.getFallback():e;return t.kind!==r.kind?{correctType:!1,sgnT:n.OperatorId.Ne}:d(r)}}function F(e,t,r){let i=!1;const o=r.length-1;let a=Math.floor((0+o)/2),s=0,l=o;const u=y(e,t);for(;;){let e=u(r.get(a)).sgnT;if(e===n.OperatorId.Ne){if(a<l)for(let t=a+1;t<=l;t+=1)if(e=u(r.get(t)).sgnT,e!==n.OperatorId.Ne){a=t;break}e===n.OperatorId.Ne&&(a=Math.floor((s+l)/2),e=n.OperatorId.Gt)}if(e===n.OperatorId.Eq){if(a<o){a+=1,i=!0,s=a,l=a;continue}return a}if(e===n.OperatorId.Lt?s=a+1:l=a-1,!(s<=l)){if(i)a-=1;else if(e===n.OperatorId.Gt&&(a-=1,a>=0)){s=a,l=a;continue}return a}a=Math.floor((s+l)/2)}}function C(e,t,r,i){let o=-1;const a=y(e,t,i===n.OperatorId.Eq);for(let e=0;e<r.length;e+=1){const t=r.get(e),{correctType:s,sgnT:l}=a(t);if(s){if(l===n.OperatorId.Eq)return e;if(l!==n.OperatorId.Ne&&l===i)return o;o=e}e===r.denseLength&&(e=(0,m.fastMax)(e,r.length-2))}return i!==n.OperatorId.Eq?o:r.length}function R(e){switch(e.kind){case g.OperKind.Number:return i.naErrorOper;case g.OperKind.Range:return(0,a.isSheetIndex)(e.sheets)?e.ranges.length>1?i.naErrorOper:e:i.valueErrorOper;case g.OperKind.Array:return e}}function b(e,t){let r;switch(t.kind){case g.OperKind.Number:return t;case o.DerefOperKind.RangeValues:r=t.arrays[0].get(0,0);break;case g.OperKind.Array:r=t.opers[0][0];break;default:return(0,s.assertNever)("calc.funcs.lookupFuncs.getNumFromRef",t)}return r=e.coerceOper(r,g.OperKind.Number),(0,a.isErrorOper)(r)?i.refErrorOper:r}function E(e){switch(e.kind){case g.OperKind.Number:case g.OperKind.Rich:return i.naErrorOper;case g.OperKind.Range:if(!(0,a.isSheetIndex)(e.sheets))return i.valueErrorOper;if(e.ranges.length>1)return i.naErrorOper;const t=e.ranges[0];return 1!==t.rows&&1!==t.cols?i.naErrorOper:e;case g.OperKind.Array:return 1!==e.rows&&1!==e.cols?i.naErrorOper:e}}function T(e){switch(e.kind){case o.DerefOperKind.RangeValues:return e.arrays[0];case g.OperKind.Array:return new d.StrictSparseArray2D(e.rows,e.cols,e.rows,e.cols,e.opers,i.blankOper)}}function k(e,t){switch(t.kind){case g.OperKind.Range:const r=t.sheets,n=t.ranges[0];return new d.NonstrictSparseArray2D(n.rows,n.cols,n.rows,n.cols,((t,o)=>{const a=(0,c.gridCell)(n.row+t,n.col+o),[s]=e.dereferenceAllOpers([(0,i.rangeSeqOper)(r,[a])]);return s.arrays[0].get(0,0)}),(()=>(0,s.assertFalse)("calc.funcs.lookupFuncs: rangeOrArrayOperToLazyArray2D")));case g.OperKind.Array:return new d.StrictSparseArray2D(t.rows,t.cols,t.rows,t.cols,t.opers,i.blankOper)}}function P(e){if((0,a.isRangeOper)(e)){const t=e.ranges[0];return t.cols>t.rows}return e.cols>e.rows}function N(e,[t,r,o,s=i.trueOper],u){const c=R(r);if((0,a.isErrorOper)(c))return c;const m=A(c,u),[p]=e.dereferenceAllOpers([m]),h=(0,d.sparseArray2DTo1D)(T(p),u),f=s.value?F(e,t,h):C(e,t,h,n.OperatorId.Eq);if(f<0||f>=h.length)return i.naErrorOper;const S=function(e,t){switch(t.kind){case g.OperKind.Number:return t;case g.OperKind.Range:if(!(0,a.isSheetIndex)(t.sheets))return i.valueErrorOper;if(t.ranges.length>1)return i.refErrorOper;const r=t.ranges;return e.calcingArray?(0,l.throwEvaluationError)((0,a.notImplemented)(["HLOOKUP/VLOOKUP ref argument 3 in array formula"])):r[0].rows>1||r[0].cols>1?(0,l.throwEvaluationError)((0,a.notImplemented)(["HLOOKUP/VLOOKUP non-singleton ref argument 3"])):t;case g.OperKind.Array:return(0,l.throwEvaluationError)((0,a.notImplemented)(["HLOOKUP/VLOOKUP array argument 3"]))}}(e,o);if((0,a.isErrorOper)(S))return S;const[v]=e.dereferenceAllOpers([S]),y=b(e,v);if((0,a.isErrorOper)(y))return y;const E=e.mathpack.sfix(y)-1,P=k(e,c);return E<0?i.valueErrorOper:E>=(u?P.rows:P.cols)?i.refErrorOper:u?P.get(E,f):P.get(f,E)}function A(e,t){if((0,a.isRangeOper)(e)){const r=e.ranges[0],n=(0,c.gridRange)(r.row,r.col,t?1:r.rows,t?r.cols:1);return(0,i.rangeSeqOper)(e.sheets,[n])}return e}var I,O;function _(e){return e===O.DescendingBinary||e===O.AscendingBinary}function M(e,t,r=i.missingOper,n=i.missingOper){const o=(0,a.isMissingOper)(r)?I.Exact:e.mathpack.sfix(r);if(o<I.Lower||o>I.Wildcard)return i.valueErrorOper;const s=(0,a.isMissingOper)(n)?O.Linear:e.mathpack.sfix(n);if(s<O.DescendingBinary||s>O.AscendingBinary||0===s)return i.valueErrorOper;if(o===I.Wildcard&&_(s))return i.valueErrorOper;const l=R(t);if((0,a.isErrorOper)(l))return l;const[u]=e.dereferenceAllOpers([l]),c=T(u),{rows:m,cols:g}=c;let p;if(1===m)p=!0;else{if(1!==g)return i.valueErrorOper;p=!1}return{kind:void 0,lookupArray:(0,d.sparseArray2DTo1D)(c,p),matchMode:o,searchMode:s,isHorizontal:p}}function D(e,t,r,i,o){return r===n.OperatorId.Gt?t===I.Higher&&(void 0===o||f((0,p.sortOpers)(e,i,o,1,!1))===n.OperatorId.Lt):t===I.Lower&&(void 0===o||f((0,p.sortOpers)(e,i,o,1,!1))===n.OperatorId.Gt)}function w(e,t){const r=new u.WildExp(e.config.localeInfo,t.value);return e=>(0,a.isStringOper)(e)&&r.test(e.value)?n.OperatorId.Eq:n.OperatorId.Ne}function L(e,t,r){return _(t.searchMode)?function(e,{lookupArray:t,matchMode:r,searchMode:i},o){const a=e.config,l=i===O.DescendingBinary;let u,c=0,d=t.length-1;(0,s.assertTrue)("calc.funcs.xBinarySearch",r!==I.Wildcard);let m=!1;for(;d>=c;){const e=Math.floor((d+c)/2),i=(g=t.get(e),f((0,p.sortOpers)(a,g,o,1,!1)));if(i===n.OperatorId.Eq)m=!0,u=e;else if(!m){const t=r===I.Higher&&i===n.OperatorId.Gt,o=r===I.Lower&&i===n.OperatorId.Lt;(t||o)&&(u=e)}l!==(i===n.OperatorId.Lt)?c=e+1:d=e-1}var g;return u}(e,t,r):function(e,{lookupArray:t,matchMode:r,searchMode:i},o){const l=e.config;let u;const c=r===I.Lower||r===I.Higher,d=r===I.Wildcard&&(0,a.isStringOper)(o)?w(e,o):e=>f((0,p.sortOpers)(l,e,o,1,!1)),g=i===O.ReverseLinear?t.length-1:0,h=i===O.ReverseLinear?-1:1;for(let e=g;e>=0&&e<t.length;e+=h){const i=t.get(e),o=d(i);if(o===n.OperatorId.Eq){u=e;break}if(c&&((0,s.assertTrue)("calc.funcs.xLinearSearch",o!==n.OperatorId.Ne),D(l,r,o,i,void 0===u?void 0:t.get(u))&&(u=e)),e>=t.denseLength){const r=t.denseLength,n=t.length-1;e=h>0?(0,m.fastMax)(e,n-1):(0,m.fastMin)(e,r+1)}}return u}(e,t,r)}t.makeLookupComparer=y,t.binarySearch=F,t.linearSearch=C,t.match=function(e,[t,r,o=e.mathpack.one]){const s=e.mathpack,l=function(e){switch(e.kind){case g.OperKind.Number:return e;case g.OperKind.Range:if(!(0,a.isSheetIndex)(e.sheets))return i.valueErrorOper;if(e.ranges.length>1)return i.refErrorOper;const t=e.ranges[0];return 1!==t.rows||1!==t.cols?i.refErrorOper:e}}(o);if((0,a.isErrorOper)(l))return l;const[u]=e.dereferenceAllOpers([l]),c=b(e,u);if((0,a.isErrorOper)(c))return c;const m=E(r);if((0,a.isErrorOper)(m))return m;const[p]=e.dereferenceAllOpers([m]),h=T(p),f=1===h.rows,S=(0,d.sparseArray2DTo1D)(h,f);let v=-1;return v=s.cond(c)>0?F(e,t,S):0===s.cond(c)?C(e,t,S,n.OperatorId.Eq):C(e,t,S,n.OperatorId.Lt),v<0||v>=S.length?i.naErrorOper:e.mathpack.fromNumber(v+1)},t.lookup=function(e,[t,r,n]){const o=R(r);if((0,a.isErrorOper)(o))return o;const s=P(o),l=A(o,s),[u]=e.dereferenceAllOpers([l]),g=(0,d.sparseArray2DTo1D)(T(u),s),p=F(e,t,g);if(p<0)return i.naErrorOper;if(void 0!==n){const t=E(n);if((0,a.isErrorOper)(t))return t;const r=P(t),o=function(e,t,r){if((0,a.isRangeOper)(r)){const n=r.ranges[0],o=(0,c.gridRange)(n.row,n.col,(0,m.fastMin)(t?1:e,c.sheetRows-n.row),(0,m.fastMin)(t?e:1,c.sheetCols-n.col));return(0,i.range3DOper)(r.sheets,o)}return r}(g.length,r,t),s=(0,d.sparseArray2DTo1D)(k(e,o),r);return p>=s.length?(0,a.isArrayOper)(t)?i.naErrorOper:i.blankOper:s.get(p)}const h=k(e,o);return s?h.get(h.rows-1,p):h.get(p,h.cols-1)},t.hlookup=function(e,t){return N(e,t,!0)},t.vlookup=function(e,t){return N(e,t,!1)},function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Higher=1]="Higher",e[e.Wildcard=2]="Wildcard"}(I||(I={})),function(e){e[e.DescendingBinary=-2]="DescendingBinary",e[e.ReverseLinear=-1]="ReverseLinear",e[e.Linear=1]="Linear",e[e.AscendingBinary=2]="AscendingBinary"}(O||(O={})),t.makeWildcardComparer=w,t.xlookup=function(e,t){const[r,n,o,l=i.missingOper,u,c]=t,d=M(e,n,u,c);if(void 0!==d.kind)return d;const m=function(e){switch(e.kind){case g.OperKind.Range:return(0,s.assertTrue)("calc.funcs.xlookup",(0,a.isSheetIndex)(e.sheets)),e.ranges.length>1?i.naErrorOper:[e.ranges[0].rows,e.ranges[0].cols];case g.OperKind.Array:return[e.rows,e.cols]}}(o);if(!Array.isArray(m))return m;const[p,f]=m,S=d.lookupArray.length,v=S===p&&(1===p||!d.isHorizontal),y=S===f&&(1===f||d.isHorizontal);if(!v&&!y)return i.valueErrorOper;const F=L(e,d,r);if(void 0===F)return(0,a.isMissingOper)(l)?i.naErrorOper:l;const C=e.mathpack;return h(e,v?[o,C.fromNumber(F+1),1===f?C.one:C.zero]:[o,1===p?C.one:C.zero,C.fromNumber(F+1)])},t.xmatch=function(e,t){const[r,n,o,a]=t,s=M(e,n,o,a);if(void 0!==s.kind)return s;const l=L(e,s,r);return void 0===l?i.naErrorOper:e.mathpack.fromNumber(l+1)}},9955:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sqrtpi=t.factdouble=t.fact=t.quotient=t.mod=t.radians=t.degrees=t.sign=t.abs=t.odd=t.even=t.floor_precise=t.floor_math=t.floor=t.ceiling_precise=t.ceiling_math=t.ceiling=t.mround=t.rounddown=t.roundup=t.trunc=t.round=t.int=t.atan2=t.atan=t.acos=t.asin=t.tan=t.cos=t.sin=t.log=t.log10=t.ln=t.power=t.exp=t.sqrt=t.pi=void 0;const n=r(53964),i=r(51286),o=r(57263);function a(e,t,r){const n=e.cond(t),a=e.cond(r);if(n>0&&a<0)return i.numErrorOper;if(0===n||0===a)return e.zero;const s=e.div(t,r);return(0,o.isErrorOper)(s)?s:e.mul(e.ceil(e.viewRound(s)),r)}function s(e,t,r){const n=e.cond(t),a=e.cond(r);if(n>0&&a<0)return i.numErrorOper;if(0===n&&0===a)return t;const s=e.div(t,r);return(0,o.isErrorOper)(s)?s:e.mul(e.floor(e.viewRound(s)),r)}function l(e,t,[r]){const i=t.mathpack;if(i.cond(r)>=0){const t=i.ceil(r);return 0===i.cond2((0,n.assertNumber)((0,n.numMod)(i,t,i.fromNumber(2))),i.one)===e?i.add(t,i.one):t}const o=i.floor(r);return 0===i.cond2((0,n.assertNumber)((0,n.numMod)(i,o,i.fromNumber(2))),i.one)===e?i.sub(o,i.one):o}t.pi=function(e,t){return e.mathpack.pi},t.sqrt=(0,n.wrap1)((e=>e.mathpack.sqrt)),t.exp=(0,n.wrap1)((e=>e.mathpack.exp)),t.power=(0,n.wrap2)((e=>e.mathpack.power)),t.ln=(0,n.wrap1)((e=>e.mathpack.ln)),t.log10=(0,n.wrap1)((e=>e.mathpack.log)),t.log=function(e,[t,r]){const n=e.mathpack;if(void 0===r)return n.log(t);const i=n.ln(t);if((0,o.isErrorOper)(i))return i;const a=n.ln(r);return(0,o.isErrorOper)(a)?a:n.div(i,a)},t.sin=(0,n.wrap1)((e=>e.mathpack.sin)),t.cos=(0,n.wrap1)((e=>e.mathpack.cos)),t.tan=(0,n.wrap1)((e=>e.mathpack.tan)),t.asin=(0,n.wrap1)((e=>e.mathpack.asin)),t.acos=(0,n.wrap1)((e=>e.mathpack.acos)),t.atan=(0,n.wrap1)((e=>e.mathpack.atan)),t.atan2=(0,n.wrap2)((e=>e.mathpack.atan2)),t.int=function(e,t){let[r]=t;const n=e.mathpack;return n.cond2(n.abs(r),n.fromNumber(1e15))<0&&(r=n.viewRound(r)),n.floor(r)},t.round=(0,n.wrap2)((e=>e.mathpack.round)),t.trunc=function(e,[t,r=e.mathpack.zero]){return e.mathpack.roundDown(t,r)},t.roundup=(0,n.wrap2)((e=>e.mathpack.roundUp)),t.rounddown=(0,n.wrap2)((e=>e.mathpack.roundDown)),t.mround=function(e,[t,r]){const a=(0,n.chkNumOper)(e,t);if((0,o.isErrorOper)(a))return a;const s=(0,n.chkNumOper)(e,r);if((0,o.isErrorOper)(s))return s;const l=e.mathpack;if(0===l.cond(s))return l.zero;if(0!==l.cond(a)&&l.cond(a)<0!=l.cond(s)<0)return i.numErrorOper;const u=l.div(a,s);if((0,o.isErrorOper)(u))return i.numErrorOper;const c=l.floor(u),d=(0,n.assertNumber)(l.sub(u,c)),m=l.fromNumber(.5-5e-15);if(l.cond2(d,m)<0)return l.mul(c,s);const g=l.add(c,l.one);return(0,o.isErrorOper)(g)?g:l.mul(g,s)},t.ceiling=function(e,[t,r]){return a(e.mathpack,t,r)},t.ceiling_math=function(e,[t,r,n]){const i=e.mathpack;let s=void 0===r||(0,o.isMissingOper)(r)?i.one:i.abs(r);const l=void 0===n||(0,o.isMissingOper)(n)?i.zero:n;return 0!==i.cond(l)&&i.cond(t)<0&&(s=i.neg(s)),0===i.cond(s)?i.zero:a(i,t,s)},t.ceiling_precise=function(e,[t,r]){const n=e.mathpack,i=void 0===r||(0,o.isMissingOper)(r)?n.one:n.abs(r);return 0===n.cond(i)?n.zero:a(n,t,i)},t.floor=function(e,[t,r]){return s(e.mathpack,t,r)},t.floor_math=function(e,[t,r,n]){const i=e.mathpack;let a=void 0===r||(0,o.isMissingOper)(r)?i.one:i.abs(r);const l=void 0===n||(0,o.isMissingOper)(n)?i.zero:n;return 0!==i.cond(l)&&i.cond(t)<0&&(a=i.neg(a)),0===i.cond(a)?i.zero:s(i,t,a)},t.floor_precise=function(e,[t,r]){const n=e.mathpack,i=void 0===r||(0,o.isMissingOper)(r)?n.one:n.abs(r);return 0===n.cond(i)?n.zero:s(n,t,i)},t.even=l.bind(void 0,!0),t.odd=l.bind(void 0,!1),t.abs=(0,n.wrap1)((e=>e.mathpack.abs)),t.sign=function(e,[t]){const r=e.mathpack;return r.fromNumber(r.cond(t))},t.degrees=function(e,[t]){const r=e.mathpack,i=(0,n.assertNumber)(r.div(r.fromNumber(180),r.pi));return r.mul(t,i)},t.radians=function(e,[t]){const r=e.mathpack,i=(0,n.assertNumber)(r.div(r.pi,r.fromNumber(180)));return r.mul(t,i)},t.mod=(0,n.wrap2)((e=>e.mathpack.mod)),t.quotient=function(e,[t,r]){const a=(0,n.chkNumOper)(e,t);if((0,o.isErrorOper)(a))return a;const s=(0,n.chkNumOper)(e,r);if((0,o.isErrorOper)(s))return s;const l=e.mathpack;if(0===l.cond(s))return i.div0ErrorOper;const u=l.div(a,s);return(0,o.isErrorOper)(u)?i.numErrorOper:l.cond(u)>0?l.floor(u):l.ceil(u)},t.fact=function(e,[t]){const r=e.mathpack,n=r.sfix(t);if(r.cond(t)<0||n>170)return i.numErrorOper;let a=r.one;for(let e=n;e>0;e-=1){if((0,o.isErrorOper)(a))return a;a=r.mul(r.fromNumber(e),a)}return a},t.factdouble=function(e,[t]){const r=(0,n.chkNumOper)(e,t);if((0,o.isErrorOper)(r))return r;const a=e.mathpack,s=a.floor(r);if(a.cond2(s,a.fromNumber(-1))<0||a.cond2(s,a.fromNumber(300))>0)return i.numErrorOper;let l=a.one;for(let e=a.toNumber(s);e>1;e-=2){if((0,o.isErrorOper)(l))return l;l=a.mul(a.fromNumber(e),l)}return l},t.sqrtpi=function(e,[t]){const r=(0,n.chkNumOper)(e,t);if((0,o.isErrorOper)(r))return r;const a=e.mathpack;if(a.cond(r)<0)return i.numErrorOper;const s=a.mul(a.pi,r);return(0,o.isErrorOper)(s)?s:a.sqrt(s)}},89388:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hstack=t.vstack=t.filter=t.map=t.drop=t.take=t.rangeOrArrayToVal=t.choosecols=t.sequence=void 0;const n=r(72006),i=r(57263),o=r(51286),a=r(51286),s=r(76964),l=r(91700),u=r(44037),c=r(69547),d=r(88065),m=r(98224),g=r(53964);t.sequence=(e,t)=>{const[r,n,o,s]=t,l=e.mathpack,u=(0,i.isMissingOper)(r)?1:l.sfix(r),c=void 0===n||(0,i.isMissingOper)(n)?1:l.sfix(n);if(u<0||u>m.sheetRows||c<0||c>m.sheetRows)return a.valueErrorOper;if((0,g.validateArraySize)(u,c),0===u||0===c)return a.calcErrorOper;const d=void 0===o||(0,i.isMissingOper)(o)?l.fromNumber(1):o,p=void 0===s||(0,i.isMissingOper)(s)?l.fromNumber(1):s;let h=d;const f=[];for(let e=0;e<u;e++){const e=[];for(let t=0;t<c;t++){if(e.push(h),(0,i.isErrorOper)(h))continue;const t=l.add(h,p);h=(0,i.isErrorOper)(t)?t:l.checkAlmostCancellation(p,t)}f.push(e)}return(0,a.arrayOper)(u,c,f)},t.choosecols=(e,t)=>{const[r,...n]=t,o=e.mathpack,l=(0,s.refToVal)(e,r,!1);if(!(0,i.isArrayOper)(l))return l;const c=l.opers.map((e=>{const t=e.length,r=[];return n.forEach((n=>{(0,i.isNumberOper)(n)?r.push(e[(0,u.getAbsoluteIndex)(t,o.toNumber(n))]):function(e,t){const r=[];return t.opers.forEach((t=>{t.forEach((t=>{(0,i.isNumberOper)(t)&&r.push(e.toNumber(t))}))})),r}(o,n).forEach((n=>{r.push(e[(0,u.getAbsoluteIndex)(t,n)])}))})),r}));return 0===c.length||0===c[0].length?a.calcErrorOper:(0,a.arrayOper)(c.length,c[0].length,c)};class p{slice(e,t,r,n){const{row:i,col:a}=this.oper.ranges[0];return(0,o.range3DOper)(this.oper.sheets,(0,m.gridRange)(i+e,a+r,t,n))}constructor(e){this.oper=e;const{rows:t,cols:r}=e.ranges[0];this.rows=t,this.cols=r}}class h{slice(e,t,r,n){return(0,a.arrayOper)(t,n,this.oper.opers.slice(e,e+t).map((e=>e.slice(r,r+n))))}constructor(e){this.oper=e,this.rows=e.opers.length,this.cols=e.opers[0].length}}function f(e){return(0,i.isRangeOper)(e)?e.ranges.length>1?a.valueErrorOper:((0,d.assertTrue)("calc.funcs.rangeOrArrayToVal: not 3D ref",(0,i.isSheetIndex)(e.sheets)),e):e}function S(e,t){if((0,c.fastAbs)(e)<t){const r=(0,c.fastAbs)(e);return e<0?{start:t-r,count:r}:{start:0,count:r}}return{start:0,count:t}}function v(e,t){if((0,c.fastAbs)(e)<t){const r=t-(0,c.fastAbs)(e);return e<0?{start:0,count:r}:{start:e,count:r}}return{start:0,count:0}}t.rangeOrArrayToVal=f,t.take=(e,t)=>{const[r,n,o]=t,s=e.mathpack,l=f(r);if(!(0,i.isArrayOper)(l)&&!(0,i.isRangeOper)(l))return l;const u=(0,i.isRangeOper)(l)?new p(l):new h(l),c=(0,i.isMissingOper)(n)?u.rows:s.lfix(n),d=void 0===o||(0,i.isMissingOper)(o)?u.cols:s.lfix(o),{start:m,count:g}=S(c,u.rows),{start:v,count:y}=S(d,u.cols);return 0===g||0===y?a.calcErrorOper:u.slice(m,g,v,y)},t.drop=(e,t)=>{const[r,n,o]=t,s=e.mathpack,l=f(r);if(!(0,i.isArrayOper)(l)&&!(0,i.isRangeOper)(l))return l;const u=(0,i.isRangeOper)(l)?new p(l):new h(l),c=(0,i.isMissingOper)(n)?0:s.lfix(n),d=void 0===o||(0,i.isMissingOper)(o)?0:s.lfix(o),{start:m,count:g}=v(c,u.rows),{start:S,count:y}=v(d,u.cols);return 0===g||0===y?a.calcErrorOper:u.slice(m,g,S,y)},t.map=(e,t)=>{const r=(0,s.refToVal)(e,t[t.length-1],!0),n=t.slice(0,t.length-1).map((t=>(0,s.refToVal)(e,t,!1)));if(!n.every(i.isArrayOper))return(0,u.ni)("MAP: Non array input");if(!(r instanceof l.LambdaOper)||0===n.length)return(0,u.ni)("MAP: No lambda or array");const o=n[0],{rows:a,cols:c}=o;return n.every((e=>e.rows===a&&e.cols===c))?(0,s.machineCall)(new s.ArrayMachine(e,a,c,((t,i)=>e.applyLambda(r,n.map((e=>e.opers[t][i])))),(e=>(0,i.isRangeOper)(e)?(0,u.ni)("MAP: nested range"):(0,i.isArrayOper)(e)?(0,u.ni)("MAP: nested array"):(0,i.isMissingOper)(e)?(0,u.ni)("MAP: nested missing"):e))):(0,u.ni)("MAP: Bad dimensions")},t.filter=(e,t)=>{const[r,o,l]=t,c=(0,s.refToVal)(e,r,!1),d=(0,s.refToVal)(e,o,!1),m=void 0===l||(0,i.isMissingOper)(l)?a.calcErrorOper:l;return(0,i.isArrayOper)(c)&&(0,i.isArrayOper)(d)?1===d.rows&&d.cols===c.cols?function(e,t,r,o){const s=[];let l=0;for(let t=0;t<r.length;t++){const o=r[t],a=e.coerceOper(o,n.OperKind.Boolean);if(!(0,i.isBooleanOper)(a))return o;const u=a.value;u&&(s.push(u),l++)}return 0===l?o:(0,a.arrayOper)(t.length,l,t.map((e=>e.filter(((e,t)=>{var r;return null===(r=s[t])||void 0===r||r})))))}(e,c.opers,d.opers[0],m):1===d.cols&&d.cols===c.cols?function(e,t,r,o){const s=[];for(let o=0;o<r.length;o++){const a=r[o],l=e.coerceOper(a,n.OperKind.Boolean);if(!(0,i.isBooleanOper)(l))return a;l.value&&s.push(t[o])}return 0===s.length?o:(0,a.arrayOper)(s.length,s[0].length,s)}(e,c.opers,d.opers.map((e=>e[0])),m):a.valueErrorOper:(0,u.ni)("FILTER: non-array input")},t.vstack=(e,t)=>{const r=t.map((t=>(0,s.refToVal)(e,t,!1)));if(!r.every(i.isArrayOper))return(0,u.ni)("VSTACK: non array input");let n=0;for(const e of r)e.cols>n&&(n=e.cols);if(n<1)return(0,u.ni)("VSTACK: Empty array");const o=[];for(const e of r)for(const t of e.opers){const e=t.slice();for(;e.length<n;)e.push(a.naErrorOper);o.push(e)}return(0,a.arrayOper)(o.length,n,o)},t.hstack=(e,t)=>{var r,n;const o=t.map((t=>(0,s.refToVal)(e,t,!1)));if(!o.every(i.isArrayOper))return(0,u.ni)("HSTACK: non array input");let l=0;for(const e of o)e.rows>l&&(l=e.rows);if(l<1)return(0,u.ni)("HSTACK: Empty array");const d=[];for(let e=0;e<l;e++){const t=[];o.forEach((r=>(0,c.safePush)(t,e<r.rows?r.opers[e]:Array(r.cols).fill(a.naErrorOper)))),d.push(t)}return(0,a.arrayOper)(l,null!==(n=null===(r=d[0])||void 0===r?void 0:r.length)&&void 0!==n?n:0,d)}},50476:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nextFuncs=void 0;const n=r(75929),i=r(89388),o=r(91231),a=r(21126),s={[n.WorksheetFuncId.TEXTBEFORE]:a.textBefore,[n.WorksheetFuncId.TEXTAFTER]:a.textAfter,[n.WorksheetFuncId.TEXTSPLIT]:a.textSplit,[n.WorksheetFuncId.XMATCH]:o.xmatch,[n.WorksheetFuncId.XLOOKUP]:o.xlookup,[n.WorksheetFuncId.TAKE]:i.take,[n.WorksheetFuncId.DROP]:i.drop,[n.WorksheetFuncId.CHOOSECOLS]:i.choosecols,[n.WorksheetFuncId.SEQUENCE]:i.sequence,[n.WorksheetFuncId.MAP]:i.map,[n.WorksheetFuncId.FILTER]:i.filter,[n.WorksheetFuncId.VSTACK]:i.vstack,[n.WorksheetFuncId.HSTACK]:i.hstack};t.nextFuncs={v1:s}},91231:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlookup=t.xmatch=void 0;const n=r(75929),i=r(57263),o=r(51286),a=r(76964),s=r(82539),l=r(44037);t.xmatch=(e,t)=>{const[r,u,c,d]=t;if(void 0!==c&&!(0,i.isMissingOper)(c)||void 0!==d&&!(0,i.isMissingOper)(d))return(0,l.ni)("XMATCH: unsupported optional args");if((0,i.isRichOper)(r))return(0,l.ni)("XMATCH: unsupported rich lookup");const m=(0,a.refToVal)(e,u,!1),g=(0,s.makeLookupComparer)(e,r);if(!(0,i.isArrayOper)(m))return(0,i.isRangeOper)(m)?(0,l.ni)("XMATCH: range oper"):g(m).sgnT===n.OperatorId.Eq?e.mathpack.fromNumber(1):o.naErrorOper;let p;if(1===m.rows)p=m.opers[0];else{if(1!==m.cols)return(0,l.ni)("XMATCH: non-vector");p=m.opers.map((e=>e[0]))}for(let t=0;t<p.length;t++)if(g(p[t]).sgnT===n.OperatorId.Eq)return e.mathpack.fromNumber(t+1);return o.naErrorOper},t.xlookup=(e,t)=>(0,l.ni)("XLOOKUP: Not implemented")},21126:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textAfter=t.textBefore=t.textSplit=void 0;const n=r(88065),i=r(57263),o=r(51286),a=r(44037);function s(e){const t=[];if((0,i.isArrayOper)(e)){const{rows:r,cols:n,opers:o}=e;for(let e=0;e<r;e++)for(let r=0;r<n;r++){const n=o[e][r];if(!(0,i.isStringOper)(n))return(0,a.ni)("TEXTSPLIT array with non-text element");t.push(n.value)}}else t.push(e.value);return t}function l(e,t){const r=[],n=[];let i=0;for(;i<e.length;){let o=!1;for(let a=0;a<t.length;a++){const s=t[a];s.length>0&&e.startsWith(s,i)&&(r.push(i),n.push(s.length),i+=s.length,o=!0)}o||i++}return{matchStart:r,matchLength:n}}t.textSplit=(e,t)=>{const[r,l,u,c,d,m]=t,g=r.value;if((0,i.isMissingOper)(l)||void 0!==u&&!(0,i.isMissingOper)(u)||void 0!==d&&!(0,i.isMissingOper)(d)||void 0!==m&&!(0,i.isMissingOper)(m))return(0,a.ni)("TEXTSPLIT unsupported arguments");const p=s(l);if(p.some((e=>""===e)))return o.valueErrorOper;const h=void 0!==c&&!(0,i.isMissingOper)(c)&&c.value;let f=[],S=0,v=g;for(;S<v.length;){const e=v.length-S;let t=!1;for(let e=0;e<p.length;e++){const r=p[e];v.startsWith(r,S)&&(f.push(v.slice(0,S)),v=v.slice(S+r.length),S=0,t=!0)}t?(0,n.assertTrue)("calc.funcs.textsplit: Loop invariant",v.length-S<e):S++}return f.push(v),h&&(f=f.filter((e=>0!==e.length))),0===f.length?o.calcErrorOper:(0,o.arrayOper)(1,f.length,[f.map(o.stringOper)])},t.textBefore=(e,t)=>{const[r,n,u,c,d,m]=t;if(void 0!==c&&!(0,i.isMissingOper)(c)||void 0!==d&&!(0,i.isMissingOper)(d))return(0,a.ni)("TEXTBEFORE unsupported arguments");const g=r.value,p=s(n),h=void 0===u||(0,i.isMissingOper)(u)?1:Math.floor(e.mathpack.toNumber(u)),f=null!=m?m:o.naErrorOper,S=Math.abs(h);if(0===h||S>g.length||p.every((e=>g.length-e.length+1<S)))return o.valueErrorOper;if(p.some((e=>0===e.length)))return(0,o.stringOper)(h<0?g:"");const{matchStart:v}=l(g,p),y=v[(0,a.getAbsoluteIndexNoClamp)(v.length,h<0?h:h-1)];return void 0===y?f:(0,o.stringOper)(g.slice(0,y))},t.textAfter=(e,t)=>{const[r,n,u,c,d,m]=t;if(void 0!==c&&!(0,i.isMissingOper)(c)||void 0!==d&&!(0,i.isMissingOper)(d))return(0,a.ni)("TEXTAFTER unsupported arguments");const g=r.value,p=s(n),h=void 0===u||(0,i.isMissingOper)(u)?1:Math.floor(e.mathpack.toNumber(u)),f=null!=m?m:o.naErrorOper,S=Math.abs(h);if(0===h||S>g.length||p.every((e=>g.length-e.length+1<S)))return o.valueErrorOper;if(p.some((e=>0===e.length)))return(0,o.stringOper)(h<0?"":g);const{matchStart:v,matchLength:y}=l(g,p),F=(0,a.getAbsoluteIndexNoClamp)(v.length,h<0?h:h-1),C=v[F];return void 0===C?f:(0,o.stringOper)(g.slice(C+y[F]))}},44037:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAbsoluteIndexNoClamp=t.getAbsoluteIndex=t.ni=void 0;const n=r(57263),i=r(1386);t.ni=e=>{throw new i.EvaluationError((0,n.notImplemented)([e]))},t.getAbsoluteIndex=function(e,t){return t>=0?t:Math.max(e+t,0)},t.getAbsoluteIndexNoClamp=function(e,t){return t>=0?t:e+t}},71144:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valuetotext=t.arraytotext=t.numbervalue=t.isWhitespace=t.timevalue=t.datevalue=t.value=t.dollar=t.fixed=t.text=void 0;const n=r(19181),i=r(51286),o=r(88065),a=r(9955),s=r(58684),l=n.__importStar(r(34791)),u=r(57263),c=r(41424),d=r(72006),m=r(24946),g=r(1386),p=r(51589),h=r(43560),{codePointSpace:f,codePointTab:S,codePointLF:v,codePointCR:y}=l;function F(e,t,r,n){if(void 0===r||(0,u.isMissingOper)(r))return{formatValue:t,formatDecimals:null!=n?n:2};const s=e.config.mathpack;if(s.cond(r)<0){const n=0,i=(0,a.round)(e,[t,r]);return(0,o.assertTrue)("calc.funcs.fixedDollarRound",(0,u.isNumberOper)(i)||(0,u.isErrorOper)(i)),{formatValue:i,formatDecimals:n}}const l=s.sfix(r);return l<0||l>127?{formatValue:i.valueErrorOper,formatDecimals:0}:{formatValue:t,formatDecimals:l}}function C(e){let t=0;for(;t<e.length&&e.charCodeAt(t)===f;)t+=1;return e.substring(t)}function R(e,t){var r;return(0,u.isStringOper)(t)?t.value.length>255?i.valueErrorOper:null!==(r=e.parseDate(C(t.value)))&&void 0!==r?r:i.valueErrorOper:i.valueErrorOper}function b(e){return e===f||e===S||e===y||e===v}var E;function T(e,t,r){const n=void 0===r?E.Concise:e.mathpack.sfix(r);return n!==E.Concise&&n!==E.Strict?i.valueErrorOper:k(e,t,n)}function k(e,t,r){const n=[],a=e.config.localeInfo;switch(t.kind){case d.OperKind.Array:{for(let e=0;e<t.rows;++e)for(let r=0;r<t.cols;++r){const n=t.opers[e][r];if((0,u.isArrayOper)(n)||(0,u.isRangeOper)(n))return i.calcErrorOper}const o=r===E.Concise?a.listSeparator:a.rowSeparator,s=r===E.Concise?a.listSeparator:a.columnSeparator;r===E.Strict&&n.push(a.leftBrace);for(let i=0;i<t.rows;++i){0!==i&&(n.push(o),r===E.Concise&&n.push(" "));for(let o=0;o<t.cols;++o){0!==o&&(n.push(s),r===E.Concise&&n.push(" "));const a=k(e,t.opers[i][o],r);if((0,u.isErrorOper)(a))return a;n.push(a.value)}}r===E.Strict&&n.push(a.rightBrace);break}case d.OperKind.String:r===E.Strict?n.push('"'+t.value.replace(/"/g,'""')+'"'):n.push(t.value);break;case d.OperKind.Number:case d.OperKind.Boolean:{const r=e.coerceOper(t,d.OperKind.String);(0,o.assertTrue)("calc.funcs.operToText",(0,u.isStringOper)(r)),n.push(r.value);break}case d.OperKind.Blank:break;case d.OperKind.Error:{const e=a.errorNames[t.type];null==e&&(0,g.throwEvaluationError)((0,u.internal)(`No locale data for error type ${t.type}`)),n.push(e);break}case d.OperKind.Rich:(0,g.throwEvaluationError)((0,u.notImplemented)(["ARRAYTOTEXT/VALUETOTEXT rich argument"]));default:return(0,o.assertNever)("calc.funcs.operToText",t)}return n.reduce(((e,t)=>e+t.length),0)>i.cellStringLimit?i.calcErrorOper:(0,i.stringOper)(n.join(""))}t.text=function(e,[t,{value:r}]){const n=(0,u.isRichOper)(t)?t.getFallback():t;if((0,u.isStringOper)(n)&&n.value.length>255||r.length>255)return i.valueErrorOper;let a;switch(n.kind){case d.OperKind.String:{const t=e.coerceOper(n,d.OperKind.Number);a=(0,u.isNumberOper)(t)?t:n;break}case d.OperKind.Number:a=n;break;case d.OperKind.Boolean:{const t=e.coerceOper(n,d.OperKind.String);(0,o.assertTrue)("calc.funcs.text",(0,u.isStringOper)(t)),a=t;break}case d.OperKind.Error:return i.valueErrorOper}const s=e.applyFormat(e.originSheet.document,r,a,m.NumberFormatSource.CustomString);return void 0!==s?(0,i.stringOper)(s):i.valueErrorOper},t.fixed=function(e,[t,r,n]){var o;const{formatValue:a,formatDecimals:l}=F(e,t,r,void 0);if((0,u.isErrorOper)(a))return a;let d;d=null!==(o=null==n?void 0:n.value)&&void 0!==o&&o?0===l?s.KnownFormat.NoComFixed0:2===l?s.KnownFormat.NoComFixed:(0,c.buildNumberFormat)(e.config.localeInfo,!1,1,l):0===l?s.KnownFormat.Fixed0:2===l?s.KnownFormat.Fixed:(0,c.buildNumberFormat)(e.config.localeInfo,!0,4,l);const g=e.applyFormat(e.originSheet.document,d,a,m.NumberFormatSource.CustomBytecode);return void 0!==g?(0,i.stringOper)(g):i.valueErrorOper},t.dollar=function(e,[t,r]){const{localeInfo:n}=e.config,{formatValue:o,formatDecimals:a}=F(e,t,r,n.isEastAsia?n.currencyDecimals:void 0);if((0,u.isErrorOper)(o))return o;const l=0===a?s.KnownFormat.Currency:2===a?s.KnownFormat.CurrencyDec:(0,c.buildCurrencyFormat)(n,!1,a,!0,!1),d=e.applyFormat(e.originSheet.document,l,o,m.NumberFormatSource.CustomBytecode);return void 0!==d&&d.length>0&&d.charCodeAt(d.length-1)===f?(0,i.stringOper)(d.substring(0,d.length-1)):void 0!==d?(0,i.stringOper)(d):i.valueErrorOper},t.value=function(e,[t]){switch(t.kind){case d.OperKind.Boolean:return i.valueErrorOper;case d.OperKind.Number:return t;case d.OperKind.String:return t.value.length>255?i.valueErrorOper:e.coerceOper((0,i.stringOper)(C(t.value)),d.OperKind.Number)}},t.datevalue=function(e,[t]){const r=R(e,t);return(0,u.isErrorOper)(r)?r:e.mathpack.trunc(r)},t.timevalue=function(e,[t]){const r=R(e,t);return(0,u.isErrorOper)(r)?r:e.mathpack.sub(r,e.mathpack.trunc(r))},t.isWhitespace=b,t.numbervalue=function(e,t){const[r,n,a]=t,s=e.mathpack,l=e.config.localeInfo;if(void 0!==n&&(!(0,u.isStringOper)(n)||""===n.value)||void 0!==a&&(!(0,u.isStringOper)(a)||""===a.value))return i.valueErrorOper;const c=e=>(0,p.stringFromCodePoint)((0,p.stringCodePointAt)(e,0)),m=l.decimalSeparator,g=n?c(n.value):m;let f=a?c(a.value):l.thousandsSeparator;if(g===f){if(void 0!==a)return i.valueErrorOper;f=m}const S=r.value;if(""===S)return s.zero;let v=!1,y=0;const F=[];let C=0;const R=e=>(F.push(e),C+=e.length);for(;y<S.length&&C<255;)if(b(S.charCodeAt(y)))y+=1;else if(v||!(0,h.stringStartsWith)(S,f,y))if((0,h.stringStartsWith)(S,g,y))v=!0,R(m),y+=g.length;else{const e=(0,p.stringCodePointAt)(S,y);R((0,p.stringFromCodePoint)(e)),y+=(0,p.numCodeUnits)(e)}else y+=f.length;if(y!==S.length)return i.valueErrorOper;let E=0;for(;F.length>0&&"%"===F[F.length-1];)C-=F.pop().length,++E;if(0===F.length)return s.zero;const T=e.coerceOper((0,i.stringOper)(F.join("")),d.OperKind.Number);if(!(0,u.isNumberOper)(T))return i.valueErrorOper;let k=T;for(;E>0;)k=s.div(k,s.fromNumber(100)),(0,o.assertTrue)("calc.funcs.numberValue",(0,u.isNumberOper)(k)),--E;return k},function(e){e[e.Concise=0]="Concise",e[e.Strict=1]="Strict"}(E||(E={})),t.arraytotext=function(e,t){return T(e,t[0],t[1])},t.valuetotext=function(e,t){return T(e,t[0],t[1])}},82692:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formulatext=t.isformula=t.isodd=t.iseven=t.isomitted=t.islambda=t.isref=t.isnumber=t.istext=t.isnontext=t.isna=t.islogical=t.isblank=t.iserr=t.iserror=void 0;const n=r(51286),i=r(57263),o=r(98224),a=r(64250),s=r(91700),l=r(53964);function u(e,[t]){const r=(0,l.chkNumOper)(e,t);if((0,i.isErrorOper)(r))return r;const o=e.mathpack,a=(0,l.assertNumber)(o.add(o.abs(r),o.fromNumber(1.0000000000000003e-10))),s=(0,l.assertNumber)(o.div(o.floor(a),o.fromNumber(2)));return(0,n.booleanOper)(0===o.cond2(s,o.floor(s)))}function c(e,t,r){if(!(0,i.isSheetIndex)(t.sheets))return n.valueErrorOper;const s=t.ranges[0];if(e.calcingArray||!(0,i.isGridCell)(s)){const i=t.sheets;return(0,n.arrayOper)(s.rows,s.cols,(0,a.jaggedArray)(s.rows,s.cols,((t,n)=>{const a=(0,o.sheetGridCell)(i,(0,o.gridCell)(s.row+t,s.col+n));return r(e.getCellFormula(a),a)})))}const l=(0,i.sheetGridRangeAnchor)((0,o.sheetGridRange)(t.sheets,s));return r(e.getCellFormula(l),l)}t.iserror=function(e,[t]){return(0,n.booleanOper)((0,i.isErrorOper)(t))},t.iserr=function(e,[t]){return(0,n.booleanOper)((0,i.isErrorOper)(t)&&t.type!==n.ErrorType.NA)},t.isblank=function(e,[t]){return(0,n.booleanOper)((0,i.isBlankOper)(t))},t.islogical=function(e,[t]){return(0,n.booleanOper)((0,i.isBooleanOper)(t))},t.isna=function(e,[t]){return(0,n.booleanOper)((0,i.isErrorOper)(t)&&t.type===n.ErrorType.NA)},t.isnontext=function(e,[t]){return(0,n.booleanOper)(!(0,i.isStringOper)(t))},t.istext=function(e,[t]){return(0,n.booleanOper)((0,i.isStringOper)(t))},t.isnumber=function(e,[t]){return(0,n.booleanOper)((0,i.isNumberOper)(t))},t.isref=function(e,[t]){return(0,n.booleanOper)((0,i.isRangeOper)(t))},t.islambda=function(e,[t]){return(0,n.booleanOper)(t instanceof s.LambdaOper)},t.isomitted=function(e,[t]){return(0,n.booleanOper)((0,i.isMissingOper)(t))},t.iseven=u,t.isodd=function(e,t){const r=u(e,t);return(0,i.isBooleanOper)(r)?(0,n.booleanOper)(!r.value):r},t.isformula=function(e,[t]){return c(e,t,(e=>(0,n.booleanOper)(void 0!==e)))},t.formulatext=function(e,[t]){return c(e,t,((t,r)=>{if(void 0===t)return n.naErrorOper;const i=e.printFormula(t,r.range);return t.source.kind===o.LexicalKind.Cell?(0,n.stringOper)(i):(0,n.stringOper)("{"+i+"}")}))}},96660:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.single=t.transpose=t.offset=t.sheet=t.sheets=t.column=t.row=t.columns=t.rows=t.areas=void 0;const n=r(51286),i=r(57263),o=r(98224),a=r(69547),s=r(88065),l=r(64250);function u(e,t){if(!t)return[e.reflectionGridCell,!e.calcingArray];if(!(0,i.isSheetIndex)(t.sheets))return n.valueErrorOper;if(t.ranges.length>1)return n.refErrorOper;const r=t.ranges[0];return[r,(0,i.isGridCell)(r)]}t.areas=function(e,[t]){return(0,i.isSheetIndex)(t.sheets)?e.mathpack.fromNumber(t.ranges.length):n.valueErrorOper},t.rows=function(e,[t]){const r=e.mathpack;return(0,i.isArrayOper)(t)?r.fromNumber(t.rows):(0,i.isSheetIndex)(t.sheets)?t.ranges.length>1?n.refErrorOper:r.fromNumber(t.ranges[0].rows):n.valueErrorOper},t.columns=function(e,[t]){const r=e.mathpack;return(0,i.isArrayOper)(t)?r.fromNumber(t.cols):(0,i.isSheetIndex)(t.sheets)?t.ranges.length>1?n.refErrorOper:r.fromNumber(t.ranges[0].cols):n.valueErrorOper},t.row=function(e,[t]){const r=u(e,t);if(!Array.isArray(r))return r;const[i,o]=r,a=e.mathpack;return o?a.fromNumber(i.row+1):(0,n.arrayOper)(i.rows,1,(0,l.jaggedArray)(i.rows,1,(e=>a.fromNumber(i.row+e+1))))},t.column=function(e,[t]){const r=u(e,t);if(!Array.isArray(r))return r;const[i,o]=r,a=e.mathpack;return o?a.fromNumber(i.col+1):(0,n.arrayOper)(1,i.cols,(0,l.jaggedArray)(1,i.cols,((e,t)=>a.fromNumber(i.col+t+1))))},t.sheets=function(e,[t]){const r=e.mathpack;return t?(0,i.isArrayOper)(t)?n.naErrorOper:r.fromNumber(e.getSheetRangeIndexes(t.sheets).length):r.fromNumber(e.getSheetRangeIndexes((0,o.allSheetsRange)(e.reflectionSheet.document)).length)},t.sheet=function(e,[t]){const r=e.mathpack;if(!t){const t=e.reflectionSheet;return void 0===t.index?n.naErrorOper:r.fromNumber(e.getSheetRangePosition(t)+1)}if((0,i.isStringOper)(t)){const i=e.getSheetIndex(e.reflectionSheet.document,t.value);return void 0===i?n.naErrorOper:r.fromNumber(e.getSheetRangePosition(i)+1)}return(0,i.isRangeOper)(t)?r.fromNumber(e.getSheetRangePosition(t.sheets)+1):(0,i.isArrayOper)(t)?n.naErrorOper:(0,s.assertNever)("calc.funcs.sheet",t)},t.offset=function(e,[t,r,s,l,u]){if(!(0,i.isSheetIndex)(t.sheets))return n.valueErrorOper;if(1!==t.ranges.length)return n.valueErrorOper;const c=e.mathpack,{row:d,col:m,rows:g,cols:p}=t.ranges[0];let h=d;(0,i.isNumberOper)(r)&&(h+=c.lfix(r));let f=m;(0,i.isNumberOper)(s)&&(f+=c.lfix(s));let S=h+g-1;if(void 0!==l&&(0,i.isNumberOper)(l)){const e=c.cond(l);if(0===e)return n.refErrorOper;S=h+c.lfix(l)-(e>0?1:-1)}let v=f+p-1;if(void 0!==u&&(0,i.isNumberOper)(u)){const e=c.cond(u);if(0===e)return n.refErrorOper;v=f+c.lfix(u)-(e>0?1:-1)}const y=(0,a.fastMin)(h,S),F=(0,a.fastMin)(f,v),C=(0,a.fastMax)(h,S)-y+1,R=(0,a.fastMax)(f,v)-F+1;return y<0||F<0||y+C>o.sheetRows||F+R>o.sheetCols?n.refErrorOper:(0,n.rangeSeqOper)(t.sheets,[(0,o.gridRange)(y,F,C,R)])},t.transpose=function(e,[t]){return(0,i.isArrayOper)(t)?(0,n.arrayOper)(t.cols,t.rows,(0,l.jaggedArray)(t.cols,t.rows,((e,r)=>t.opers[r][e]))):t},t.single=function(e,[t]){if((0,i.isPrimitiveOper)(t)||(0,i.isMissingOper)(t)||(0,i.isBlankOper)(t)||(0,i.isRichOper)(t))return t;if((0,i.isArrayOper)(t))return t.opers[0][0];if(!(0,i.isSheetIndex)(t.sheets))return n.refErrorOper;if(1!==t.ranges.length)return n.valueErrorOper;const r=e.originGridCell,o=(0,i.gridCellImplicitIsect)(r,t.ranges[0]);return void 0===o?n.valueErrorOper:(0,n.rangeSeqOper)(t.sheets,[o])}},75262:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.record=t.fieldvalue=void 0;const n=r(51286),i=r(57263),o=r(49156),a=r(91700);t.fieldvalue=function(e,[t,{value:r}]){if((0,i.isRichOper)(t)){const e=t.getField(r);if(void 0!==e)return e}return n.fieldErrorOper},t.record=function(e,t){const r=t[0],n=e.config.localeInfo;let i=o.RedBlackMapTree.create(n.stringCompareCI);for(let e=1;e<t.length;e+=2){const{value:r}=t[e],n=t[e+1];i=i.setValue(r,n)}return new a.RecordOper(i,r)}},94534:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reduceDerefOpers=t.isPrimitiveCoercedOper=t.isCoercedArrayOper=t.coercedArrayOper=void 0;const n=r(92843),i=r(64250),o=r(88065),a=r(72006);t.coercedArrayOper=function(e,t,r){return(0,o.assertNatural)("calc.runtime.coercedArrayOper",e),(0,o.assertNatural)("calc.runtime.coercedArrayOper",t),r.length!==e?(0,o.assertFalse)("calc.runtime.coercedArrayOper: Inconsistent row number"):{kind:a.OperKind.Array,rows:e,cols:t,opers:r}},t.isCoercedArrayOper=function(e){return e.kind===a.OperKind.Array};const s=a.OperKind.Number|a.OperKind.String|a.OperKind.Boolean;t.isPrimitiveCoercedOper=function(e){const{kind:t}=e;return"number"==typeof t&&0!=(t&s)},t.reduceDerefOpers=function(e,t,r,o,s){const l=(n,o,l,c)=>{if((null==o?void 0:o.kind)===a.OperKind.Array){const e=new i.StrictArray2D(o.rows,o.cols,o.opers);let t=n;for(let r=0;r<l;r+=1)t=u(t,e);return t}const d=(c&&void 0!==s?s:r)(e,o);return null==d?n:t(n,d,l)};function u(e,t){let r=e;for(let e=0;e<t.rows;e+=1)for(let n=0;n<t.cols;n+=1){const i=t.get(e,n);void 0!==i&&(r=l(r,i,1,!0))}return r}function c(e,t){let r=e;const n=t.getSparse(),i=t.cols-t.denseCols;for(let e=0;e<t.denseRows;e+=1){for(let n=0;n<t.denseCols;n+=1){const i=t.get(e,n);void 0!==i&&(r=l(r,i,1,!1))}i>0&&void 0!==n&&(r=l(r,n,i,!1))}const o=(t.rows-t.denseRows)*t.cols;return o>0&&void 0!==n&&(r=l(r,n,o,!1)),r}return o.reduce(((e,t)=>(0,n.isRangeValues)(t)?t.arrays.reduce(c,e):l(e,t,1,!1)),void 0)}},49868:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wraprows=t.wrapcols=t.torow=t.tocol=t.chooserows=t.choosecols=t.vstack=t.hstack=t.expand=t.drop=t.take=t.sequence=t.indirect=t.address=void 0;const n=r(51286),i=r(51286),o=r(98224),a=r(95689),s=r(24200),l=r(57263),u=r(75929),c=r(75929),d=r(88065),m=r(43560),g=r(737),p=r(72006),h=r(1386),f=r(69547),S=r(64250),v=r(92843),y=r(53964);function F(e,t){if((0,f.fastAbs)(e)<t){const r=(0,f.fastAbs)(e);return e<0?{start:t-r,count:r}:{start:0,count:r}}return{start:0,count:t}}function C(e,t){if((0,f.fastAbs)(e)<t){const r=t-(0,f.fastAbs)(e);return e<0?{start:0,count:r}:{start:e,count:r}}return{start:0,count:0}}t.address=function(e,[t,r,n,u,c]){const m=e.mathpack,g=(null==n?void 0:n.kind)===p.OperKind.Number?m.sfix(n)-1:0;if(g<0||g>3)return i.valueErrorOper;const h=0!=(1&g),f=0!=(2&g),S=(null==u?void 0:u.kind)!==p.OperKind.Boolean||u.value?a.RefStyle.A1:a.RefStyle.R1C1,v=(e,t,r)=>S===a.RefStyle.R1C1&&e?-t<r&&r<t:1<=r&&r<=t,y=m.sfix(t);if(!v(f,o.sheetRows,y))return i.valueErrorOper;if(!(0,l.isNumberOper)(r))return i.valueErrorOper;const F=m.sfix(r);if(!v(h,o.sheetCols,F))return i.valueErrorOper;const C=(0,o.gridCell)(y<0?o.sheetRows-1:0,F<0?o.sheetCols-1:0),R=(0,a.pos)(f?a.PosKind.Rel:a.PosKind.Abs,S===a.RefStyle.R1C1&&f?y:y-1),b=(0,a.pos)(h?a.PosKind.Rel:a.PosKind.Abs,S===a.RefStyle.R1C1&&h?F:F-1),E=(0,s.formatCellPos)(e.config.localeInfo,S,C,R,b,!1);return(0,d.assertTrue)("calc.funcs.address: cell wrapped",void 0!==E),(null==c?void 0:c.kind)===p.OperKind.String?""===c.value?(0,i.stringOper)("!"+E):c.value.length>255?i.valueErrorOper:(0,i.stringOper)((0,s.formatQualifier)(e.config.localeInfo,e.config.refStyle,c.value)+"!"+E):(0,i.stringOper)(E)},t.indirect=function(e,[{value:t},r]){var n;const s=null===(n=null==r?void 0:r.value)||void 0===n||n?a.RefStyle.A1:a.RefStyle.R1C1;if(t.length>255||(0,m.stringStartsWith)(t," "))return i.valueErrorOper;let u=(0,o.originCell)(e.originSheet,e.originGridCell);const d={lexicalKind:o.LexicalKind.Indirect,originGridCell:(0,g.success)(u.range),originSheet:(0,g.success)(u.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!1,wrapCellReferences:!0,workbookLoad:!1},p=e.parseFormula(s,u.range,d,"="+t);if(!(0,g.isSuccess)(p))return i.refErrorOper;let f=p.value.node,S=!1,v=!1;for(;;){if(!S&&f.kind===a.NodeKind.App&&(0,l.isOperatorNode)(f.head)&&f.head.id===c.OperatorId.Pound&&1===f.args.length&&(S=!0,f=f.args[0]),v||f.kind!==a.NodeKind.Name){if(f.kind===a.NodeKind.CellRef){const t=e.getCellRef(f.qualifier,f.ref,u,!0);return void 0===t?i.refErrorOper:(0,l.isSheetIndex)(t.sheets)?S?(0,h.throwEvaluationError)((0,l.notImplemented)(["# operator in INDIRECT"])):t:i.refErrorOper}if(f.kind===a.NodeKind.StructRef){if(void 0===f.lhs)return i.refErrorOper;const t=e.getStructRef(f.lhs,f.rhs,u);return void 0===t||S?i.refErrorOper:t}return i.refErrorOper}{const t=e.getNameFormula(f.qualifier,f.whole,o.NameSource.Indirect);if(void 0===t)return i.refErrorOper;u=(0,o.originCell)(u.sheet,(0,o.gridCell)(0,0)),f=t[1],v=!0}}},t.sequence=(e,t)=>{const[r,n,a,s]=t,u=e.mathpack,c=(0,l.isMissingOper)(r)?1:u.sfix(r),d=void 0===n||(0,l.isMissingOper)(n)?1:u.sfix(n);if(c<0||c>o.sheetRows||d<0||d>o.sheetRows)return i.valueErrorOper;if((0,y.validateArraySize)(c,d),0===c||0===d)return i.calcErrorOper;const m=void 0===a||(0,l.isMissingOper)(a)?u.fromNumber(1):a,g=void 0===s||(0,l.isMissingOper)(s)?u.fromNumber(1):s;let p=m;const h=[];for(let e=0;e<c;e++){const e=[];for(let t=0;t<d;t++){if(e.push(p),(0,l.isErrorOper)(p))continue;const t=u.add(p,g);p=(0,l.isErrorOper)(t)?t:u.checkAlmostCancellation(g,t)}h.push(e)}return(0,i.arrayOper)(c,d,h)},t.take=(e,t)=>{const[r,n,o]=t,a=e.mathpack,s=(0,y.rangeOrArrayToVal)(r,i.valueErrorOper);if(!(0,l.isArrayOper)(s)&&!(0,l.isRangeOper)(s))return s;const u=(0,y.makeSlicer)(s),c=(0,l.isMissingOper)(n)?u.rows:a.lfix(n),d=void 0===o||(0,l.isMissingOper)(o)?u.cols:a.lfix(o),{start:m,count:g}=F(c,u.rows),{start:p,count:h}=F(d,u.cols);return 0===g||0===h?i.calcErrorOper:u.slice(m,g,p,h)},t.drop=(e,t)=>{const[r,n,o]=t,a=e.mathpack,s=(0,y.rangeOrArrayToVal)(r,i.valueErrorOper);if(!(0,l.isArrayOper)(s)&&!(0,l.isRangeOper)(s))return s;const u=(0,y.makeSlicer)(s),c=(0,l.isMissingOper)(n)?0:a.lfix(n),d=void 0===o||(0,l.isMissingOper)(o)?0:a.lfix(o),{start:m,count:g}=C(c,u.rows),{start:p,count:h}=C(d,u.cols);return 0===g||0===h?i.calcErrorOper:u.slice(m,g,p,h)},t.expand=function(e,t){const[r,a,s=n.missingOper,u=n.missingOper]=t,c=e.mathpack,d=(0,l.isMissingOper)(a)?r.rows:c.lfix(a),m=(0,l.isMissingOper)(s)?r.cols:c.lfix(s);if(d<r.rows||m<r.cols)return i.valueErrorOper;if(0===d||0===m)return i.calcErrorOper;if(m>o.sheetRows||d>o.sheetRows)return n.numErrorOper;(0,y.validateArraySize)(d,m);const g=(0,l.isMissingOper)(u)?n.naErrorOper:u;return(0,l.isArrayOper)(g)?i.valueErrorOper:(0,i.arrayOper)(d,m,(0,S.array2DToJaggedArray)(new S.StrictSparseArray2D(d,m,r.rows,r.cols,r.opers,g)))},t.hstack=(e,t)=>b(e,t,!0),t.vstack=(e,t)=>b(e,t,!1);const R=()=>n.naErrorOper;function b(e,t,r){const a=e.dereferenceAllOpers(t).map((e=>(0,v.isRangeValues)(e)?e.arrays:[new S.StrictArray2D(e.rows,e.cols,e.opers)])),s=(0,f.safeConcat)([],a).map((e=>r?(0,S.transposeArray2D)(e):e)),l=s.reduce(((e,t)=>(0,f.fastMax)(t.cols,e)),0),u=s.reduce(((e,t)=>e+t.rows),0);if(l>o.sheetRows||u>o.sheetRows)return n.numErrorOper;(0,y.validateArraySize)(u,l);const c=(0,f.safeConcat)([],s.map((e=>function(e,t,r){return e.cols>=t?e:new S.NonstrictSparseArray2D(e.rows,t,e.rows,e.cols,e.get.bind(e),r)}(e,l,R))).map(S.array2DToJaggedArray)),d=new S.StrictArray2D(c.length,c[0].length,c),m=r?(0,S.transposeArray2D)(d):d;return(0,i.arrayOper)(m.rows,m.cols,(0,S.array2DToJaggedArray)(m))}function E(e,t,r){const n=t.lfix(e),o=n>0?n:-n;return o>r||0===o?i.valueErrorOper:(0,y.getAbsoluteIndex)(r,n)}function T(e,t,r){if(e.rows>1&&e.cols>1)return i.valueErrorOper;const n=[];for(const o of e.opers)for(const e of o){if(!(0,l.isNumberOper)(e))return(0,l.isErrorOper)(e)?e:i.valueErrorOper;const o=E(e,t,r);if("number"!=typeof o)return o;n.push(o)}return n}const k=(e,t)=>{const r=[];for(const n of e){const e=t.opers[n];r.push(e)}return r},P=(e,t)=>t.opers.map((t=>{const r=[];for(const n of e)r.push(t[n]);return r})),N=(e,t,r,a)=>{const[s,...u]=t;if((0,l.isRangeOper)(s)){if(s.ranges.length>1)return i.refErrorOper;(0,d.assertTrue)("calc.funcs.ChooseColRow: not 3D ref",(0,l.isSheetIndex)(s.sheets))}const c=e.dereferenceOper(s,p.OperKind.Array);if(!(0,l.isArrayOper)(c))return c;const m=function(e,t,r){const n=[];for(const i of e)if((0,l.isArrayOper)(i)){const e=T(i,t,r);if(!Array.isArray(e))return e;(0,f.safePush)(n,e)}else{const e=E(i,t,r);if("number"!=typeof e)return e;n.push(e)}return n}(u,e.mathpack,a?c.rows:c.cols);if(!Array.isArray(m))return m;if(m.length>o.sheetRows||(a?c.cols:c.rows)>o.sheetRows)return n.numErrorOper;a?(0,y.validateArraySize)(m.length,c.cols):(0,y.validateArraySize)(c.rows,m.length);const g=r(m,c);return 0===g.length||0===g[0].length?i.calcErrorOper:(0,i.arrayOper)(g.length,g[0].length,g)};function A(e,t){return t?new S.NonstrictArray2D(1,e.length,((t,r)=>e[r])):new S.NonstrictArray2D(e.length,1,(t=>e[t]))}function I(e,t,r){const[a,s,c]=r,d=e.mathpack,[m]=e.dereferenceAllOpers([a]),g=(0,v.isRangeValues)(m)?m.arrays:[new S.StrictSparseArray2D(m.rows,m.cols,m.rows,m.cols,m.opers,n.blankOper)],p=void 0===s||(0,l.isMissingOper)(s)?0:d.lfix(s),h=void 0!==c&&!(0,l.isMissingOper)(c)&&c.value;if(p<0||p>3)return i.valueErrorOper;const f=1===p||3===p,F=2===p||3===p,C=[],R=[],b=(e,t)=>{f&&(0,l.isBlankOper)(e)||F&&(0,l.isErrorOper)(e)||(C.push(e),R.push(t))};for(const e of g){const t=h?(0,S.transposeSparseArray2D)(e):e,{rows:r,cols:n,denseRows:i,denseCols:o}=t;for(let e=0;e<i;++e){for(let r=0;r<o;++r)b(t.get(e,r),1);o<n&&b(t.getSparse(),n-o)}i<r&&n>0&&b(t.getSparse(),n*(r-i))}const E=R.reduce(((e,t)=>e+t),0);if(0===E)return i.calcErrorOper;if(E>o.sheetRows)return n.numErrorOper;t===u.WorksheetFuncId.TOROW?(0,y.validateArraySize)(1,E):(0,y.validateArraySize)(E,1);const T=[];for(let e=0;e<C.length;++e){const t=C[e],r=R[e];for(let e=0;e<r;++e)T.push(t)}const k=A(T,t===u.WorksheetFuncId.TOROW);return(0,i.arrayOper)(k.rows,k.cols,(0,S.array2DToJaggedArray)(k))}function O(e,t,r){const[o,a,s=n.missingOper]=r;if(!(1===o.rows&&o.cols>=1||1===o.cols&&o.rows>=1))return i.valueErrorOper;const c=e.mathpack.lfix(a);if(c<1)return n.numErrorOper;const d=1===o.rows?o.opers[0]:o.opers.map((e=>e[0])),m=d.length;if(c>=m){const e=A(d,t===u.WorksheetFuncId.WRAPROWS);return(0,i.arrayOper)(e.rows,e.cols,(0,S.array2DToJaggedArray)(e))}const g=Math.floor((m+c-1)/c);t===u.WorksheetFuncId.WRAPROWS?(0,y.validateArraySize)(g,c):(0,y.validateArraySize)(c,g);const p=(0,l.isMissingOper)(s)?n.naErrorOper:s,h=(e,t)=>{const r=e*c+t;return r>=d.length?p:d[r]},f=t===u.WorksheetFuncId.WRAPROWS?new S.NonstrictArray2D(g,c,((e,t)=>h(e,t))):new S.NonstrictArray2D(c,g,((e,t)=>h(t,e)));return(0,i.arrayOper)(f.rows,f.cols,(0,S.array2DToJaggedArray)(f))}t.choosecols=(e,t)=>N(e,t,P,!1),t.chooserows=(e,t)=>N(e,t,k,!0),t.tocol=function(e,t){return I(e,u.WorksheetFuncId.TOCOL,t)},t.torow=function(e,t){return I(e,u.WorksheetFuncId.TOROW,t)},t.wrapcols=function(e,t){return O(e,u.WorksheetFuncId.WRAPCOLS,t)},t.wraprows=function(e,t){return O(e,u.WorksheetFuncId.WRAPROWS,t)}},85520:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sortOpers=void 0;const n=r(69547),i=r(72006),o=r(57263),a=r(1386),s=e=>e<0?-1:e>0?1:0,l={[i.OperKind.Number]:1,[i.OperKind.String]:2,[i.OperKind.Boolean]:3,[i.OperKind.Array]:4,[i.OperKind.Error]:5};t.sortOpers=function e(t,r,u,c,d){if((0,o.isBlankOper)(r))return(0,o.isBlankOper)(u)?0:1;if((0,o.isBlankOper)(u))return-1;if((0,o.isRichOper)(r)||(0,o.isRichOper)(u))return(0,a.throwEvaluationError)((0,o.notImplemented)(["rich value sort"]));if(r.kind!==u.kind)return s(c*(l[r.kind]-l[u.kind]));switch(r.kind){case i.OperKind.Number:return s(c*t.mathpack.cond2(r,u));case i.OperKind.String:return s(c*t.localeInfo.stringCompareCI(r.value,u.value));case i.OperKind.Boolean:return s(c*(r.value-u.value));case i.OperKind.Array:{const i=r,o=u,a=(0,n.fastMin)(i.rows,o.rows),l=(0,n.fastMin)(i.cols,o.cols);for(let r=0;r<a;++r){for(let n=0;n<l;++n){const a=e(t,i.opers[r][n],o.opers[r][n],c,d);if(0!==a)return a}if(i.cols!==o.cols)return s(c*(i.cols-o.cols))}return i.rows!==o.rows?s(c*(i.rows-o.rows)):0}case i.OperKind.Error:return d?s(c*(r.type-u.type)):0}}},76250:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textAfter=t.textBefore=t.textSplit=t.substitute=t.search=t.replace=t.find=t.proper=t.upper=t.lower=t.unicode=t.code=t.unichar=t.char=t.clean=t.trim=t.rept=t.exact=t.concatenate=t.len=t.mid=t.left=t.right=void 0;const n=r(19181),i=r(57263),o=r(51286),a=r(1386),s=r(51589),l=r(54218),u=n.__importStar(r(34791)),c=r(43560),d=r(72006),m=r(22501),g=r(88065),p=r(69547),h=r(53964),{codePointSpace:f,codePointCapitalA:S,codePointCapitalZ:v,codePointSmallA:y,codePointSmallZ:F}=u,C=2147483647;function R(e,t){return void 0===t?1:e.cond(t)<0?o.valueErrorOper:e.sfix(t)}function b(e){return e>=S&&e<=v||e>=y&&e<=F}function E(e,t,r){return""===e?e:function(e){for(let t=0;t<e.length;t+=1)if(e.charCodeAt(t)>=128)return!1;return!0}(e)?r():(0,a.throwEvaluationError)((0,i.notImplemented)([t+" for non-ASCII input"]))}function T(e,t,r){if(void 0===t||(0,i.isMissingOper)(t))return[];if((0,i.isStringOper)(t))return r&&0===t.value.length?o.valueErrorOper:[t.value];const n=[];for(let a=0;a<t.rows;++a){const s=t.opers[a];for(let t=0;t<s.length;++t){const a=s[t],l=e.coerceOper(a,d.OperKind.String);if((0,i.isErrorOper)(l))return l;const u=(0,h.assertString)(l).value;if(r&&0===u.length)return o.valueErrorOper;n.push(u)}}return n.sort(((e,t)=>e.length-t.length)),n}function k(e,t,r){for(const n of r)if((0,c.stringStartsWith)(e,n,t))return n}function P(e,t,r,n,a,s,l,u){const c=function(e,t,r,n,a,s,l){const u=t.value,c=void 0===n||(0,i.isMissingOper)(n)?1:e.mathpack.sfix(n),d=T(e,r,!1);if(!Array.isArray(d))return d;const m=d.reduce(((e,t)=>t.length<e?t.length:e),d[0].length),g=-(u.length-m+1),p=u.length-m+1;if(void 0!==n&&!(0,i.isMissingOper)(n)){if(0!==m&&!(c>=g&&c<=p))return o.valueErrorOper;if(0===c)return o.valueErrorOper}let h,f;if(void 0===a||(0,i.isMissingOper)(a))h=!1;else{const t=e.mathpack.lfix(a);if(0!==t&&1!==t)return o.valueErrorOper;h=1===t}if(void 0===s||(0,i.isMissingOper)(s))f=!1;else{const t=e.mathpack.lfix(s);if(0!==t&&1!==t)return o.valueErrorOper;f=1===t}return function(e,t,r,n,i,o,a){let s=e,l=t;if(0===r)return n>0?[0,0]:[s.length,s.length];if(s.length-r<0)return a;i&&(s=s.toLowerCase(),l=l.map((e=>e.toLowerCase())));let u=n,c=0;const d=s.length;let m=1;for(n<0&&(m=-1,c=d);c<=d&&c>=0;){const e=k(s,c,l);if(void 0!==e){if(u-=m,0===u)return[c,e.length];c+=m*(e.length-1)}c+=m}return o&&n-m==0?1===m?[s.length,0]:[0,0]:a}(u,d,m,c,h,f,void 0===l||(0,i.isMissingOper)(l)?o.naErrorOper:l)}(t,r,n,a,s,l,u);if(Array.isArray(c)){const[t,n]=c;return e===N.TEXTBEFORE?(0,o.stringOper)(r.value.slice(0,t)):(0,o.stringOper)(r.value.slice(t+n))}return c}var N;t.right=function(e,[{value:t},r]){var n;if(void 0!==r&&(0,i.isErrorOper)(r))return r;const a=R(e.mathpack,r);if("number"!=typeof a&&(0,i.isErrorOper)(a))return o.valueErrorOper;const l=null!==(n=(0,s.scanCodePointsBack)(t,t.length,a))&&void 0!==n?n:0;return(0,o.stringOper)(t.substring(l))},t.left=function(e,[{value:t},r]){var n;if(void 0!==r&&(0,i.isErrorOper)(r))return r;const a=R(e.mathpack,r);if("number"!=typeof a&&(0,i.isErrorOper)(a))return o.valueErrorOper;const l=null!==(n=(0,s.scanCodePoints)(t,0,a))&&void 0!==n?n:t.length;return(0,o.stringOper)(t.substring(0,l))},t.mid=function(e,[{value:t},r,n]){var i,a;const l=e.mathpack,u=l.fix(r)-1,c=l.fix(n);if(l.cond(r)<0||u<0||l.cond(n)<0||c<0)return o.valueErrorOper;const d=null!==(i=(0,s.scanCodePoints)(t,0,u))&&void 0!==i?i:t.length,m=null!==(a=(0,s.scanCodePoints)(t,d,c))&&void 0!==a?a:t.length;return(0,o.stringOper)(t.substring(d,m))},t.len=function(e,[{value:t}]){return e.mathpack.fromNumber((0,s.countCodePoints)(t,0,t.length))},t.concatenate=function(e,t){let r="";for(let e=0;e<t.length;e+=1){const{value:n}=t[e];if(r.length+n.length>o.cellStringLimit){r+=n.substring(0,o.cellStringLimit-r.length);break}r+=n}return(0,o.stringOper)(r)},t.exact=function(e,[t,r]){return((0,i.isRichOper)(t)||(0,i.isRichOper)(r))&&(0,a.throwEvaluationError)((0,i.notImplemented)(["EXACT rich argument"])),(0,o.booleanOper)(t.value===r.value)},t.rept=function(e,[{value:t},r]){const n=e.mathpack,i=n.fix(r);return n.cond(r)<0||i>C?o.valueErrorOper:""===t?m.emptyStringOper:i*t.length>o.cellStringLimit?o.valueErrorOper:(0,o.stringOper)((0,c.repeat)(t,i))},t.trim=function(e,[{value:t}]){let r="";for(let e=0;e<t.length;){for(;e<t.length&&t.charCodeAt(e)===f;)e+=1;const n=e;for(;e<t.length;){const r=t.charCodeAt(e)===f;if(e+=1,r)break}r+=t.substring(n,e)}return r.length>0&&r.charCodeAt(r.length-1)===f&&(r=r.substring(0,r.length-1)),(0,o.stringOper)(r)},t.clean=function(e,[{value:t}]){let r="";for(let e=0;e<t.length;e+=1){const n=t.charCodeAt(e);(n>=256||(127&n)>=32)&&(r+=t.charAt(e))}return(0,o.stringOper)(r)},t.char=function(e,[t]){const r=e.mathpack.sfix(t);return r<1||r>255?o.valueErrorOper:(0,o.stringOper)(String.fromCharCode(r))},t.unichar=function(e,[t]){const r=e.mathpack,n=r.lfix(r.trunc(t));return r.cond2(t,r.one)<0||n>=1114112?o.valueErrorOper:n<=65535&&(0,s.isAnySurrogate)(n)||n>=64976&&n<=65007||(65535&n)>=65534?o.naErrorOper:(0,o.stringOper)((0,s.stringFromCodePoint)(n))},t.code=function(e,[{value:t}]){if(0===t.length)return o.valueErrorOper;const r=t.charCodeAt(0);return r>255?(0,a.throwEvaluationError)((0,i.notImplemented)(["CODE for codepoints > 255"])):e.mathpack.fromNumber(r)},t.unicode=function(e,[{value:t}]){if(0===t.length)return o.valueErrorOper;const r=t.charCodeAt(0),n=e.mathpack;if(!(0,s.isAnySurrogate)(r))return n.fromNumber(r);if(1===t.length)return o.valueErrorOper;const i=t.charCodeAt(1),a=(0,s.surrogatePairToCodePoint)(r,i);return void 0===a?o.valueErrorOper:n.fromNumber(a)},t.lower=function(e,[{value:t}]){return(0,o.stringOper)(E(t,"LOWER",t.toLowerCase.bind(t)))},t.upper=function(e,[{value:t}]){return(0,o.stringOper)(E(t,"UPPER",t.toUpperCase.bind(t)))},t.proper=function(e,[{value:t}]){return(0,o.stringOper)(E(t,"PROPER",(()=>{const e=t.toLowerCase();let r="",n=0;for(;;){const t=n;for(;n<e.length&&!b(e.charCodeAt(n));)n+=1;if(r+=e.substring(t,n),n===e.length)break;const i=n,o=(0,s.stringCodePointAt)(e,n);for(r+=(0,s.stringFromCodePoint)(o).toUpperCase(),n+=(0,s.numCodeUnits)(o);n<e.length&&b(e.charCodeAt(n));)n+=1;r+=e.substring(i+1,n)}return r})))},t.find=function(e,[{value:t},{value:r},n]){var i;const a=void 0!==n?e.mathpack.sfix(n)-1:0;if(a<0||a>=C)return o.valueErrorOper;const l=null!==(i=(0,s.scanCodePoints)(r,0,a))&&void 0!==i?i:r.length,u=r.indexOf(t,l);return u>=0?e.mathpack.fromNumber((0,s.countCodePoints)(r,0,u)+1):o.valueErrorOper},t.replace=function(e,[{value:t},r,n,{value:i}]){var a,l;const u=e.mathpack.sfix(r)-1;if(u<0||u>=o.cellStringLimit)return o.valueErrorOper;const c=e.mathpack.sfix(n);if(c<0||c>o.cellStringLimit)return o.valueErrorOper;const d=null!==(a=(0,s.scanCodePoints)(t,0,u))&&void 0!==a?a:t.length,m=null!==(l=(0,s.scanCodePoints)(t,d,c))&&void 0!==l?l:t.length,g=t.slice(0,d),p=t.slice(m);return g.length+i.length+p.length>o.cellStringLimit?o.valueErrorOper:(0,o.stringOper)(g+i+p)},t.search=function(e,[{value:t},{value:r},n]){var i;const a=void 0!==n?e.mathpack.sfix(n)-1:0;if(a<0||a>=C)return o.valueErrorOper;let u=null!==(i=(0,s.scanCodePoints)(r,0,a))&&void 0!==i?i:r.length;const c=new l.WildExp(e.config.localeInfo,t,!0);for(;u<r.length;u+=1)if(c.test(r.slice(u)))return e.mathpack.fromNumber((0,s.countCodePoints)(r,0,u)+1);return o.valueErrorOper},t.substitute=function(e,[t,{value:r},{value:n},a]){const{value:s}=t;let l=1/0;if(void 0!==a){const t=e.coerceOper(a,d.OperKind.Number);if((0,i.isErrorOper)(t))return t;if(l=e.mathpack.sfix(t),l<1||l>2147483646)return o.valueErrorOper}const u=r.length;if(u>0){let e="",t=0,i=0;for(;l>=0&&-1!==(i=s.indexOf(r,i));)if(l-=1,l===1/0||0===l){const r=s.slice(t,i);if(e.length+r.length+n.length>o.cellStringLimit)return o.valueErrorOper;e+=r,e+=n,i+=u,t=i}else i+=1;const a=s.slice(t);return e.length+a.length>o.cellStringLimit?o.valueErrorOper:(e+=a,(0,o.stringOper)(e))}return t},t.textSplit=(e,t)=>{const[r,n,a,s,l,u]=t,c=r.value;if(0===c.length)return o.valueErrorOper;let d=T(e,n,!0);if(!Array.isArray(d))return d;let m=T(e,a,!0);if(!Array.isArray(m))return m;const h=void 0!==s&&!(0,i.isMissingOper)(s)&&s.value;let f;if(void 0===l||(0,i.isMissingOper)(l))f=!1;else{const t=e.mathpack.lfix(l);if(0!==t&&1!==t)return o.valueErrorOper;f=1===t}const S=void 0===u||(0,i.isMissingOper)(u)?o.naErrorOper:u;if((0,i.isArrayOper)(S))return o.valueErrorOper;let v=c;if(f&&(v=c.toLowerCase(),d=d.map((e=>e.toLowerCase())),m=m.map((e=>e.toLowerCase()))),0===d.length&&0===m.length)return o.valueErrorOper;const y=function(e,t,r,n,i){var a;let s=0,l=0;const u=[];let c;for(;s<=t.length;){let d,m;if(l<t.length&&(d=k(t,l,r),m=void 0===d?k(t,l,n):void 0),(0,g.assertTrue)("calc.runtime.textsplit: current in bounds",l<=t.length),void 0!==d||void 0!==m||l===t.length){(l-s>0||!i)&&(void 0===c&&(c=[],u.push(c)),c.push((0,o.stringOper)(e.slice(s,l))),void 0!==m&&(c=void 0));const t=(null!==(a=null!=d?d:m)&&void 0!==a?a:"1").length;(0,g.assertTrue)("calc.runtime.textsplit: matchLength > 0",t>0),l+=t,s=l}else++l}return u}(c,v,d,m,h);if(!Array.isArray(y))return y;if(0===y.length)return o.calcErrorOper;const F=y.reduce(((e,t)=>(0,p.fastMax)(t.length,e)),0);return(0,g.assertTrue)("calc.runtime.textsplit: non-zero cols",F>0),(0,o.arrayOper)(y.length,F,y.map((e=>{for(;e.length<F;)e.push(S);return e})))},function(e){e[e.TEXTBEFORE=1]="TEXTBEFORE",e[e.TEXTAFTER=2]="TEXTAFTER"}(N||(N={})),t.textBefore=(e,t)=>{const[r,n,i,o,a,s]=t;return P(N.TEXTBEFORE,e,r,n,i,o,a,s)},t.textAfter=(e,t)=>{const[r,n,i,o,a,s]=t;return P(N.TEXTAFTER,e,r,n,i,o,a,s)}},92023:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FuncContextMock=void 0;const n=r(54166),i=r(1386),o=r(24946),a=r(737);t.FuncContextMock=class{get calcingArray(){throw new Error("Method not implemented.")}get originGridCell(){throw new Error("Method not implemented.")}get originSheet(){throw new Error("Method not implemented.")}get reflectionGridCell(){throw new Error("Method not implemented.")}get reflectionSheet(){throw new Error("Method not implemented.")}get followHyperlinks(){throw new Error("Method not implemented.")}applyFunction(e,t){throw new Error("Method not implemented.")}applyLambda(e,t){throw new Error("Method not implemented.")}handleEvaluationError(e){throw new Error("Method not implemented.")}coerceOper(e,t){throw new Error("Method not implemented.")}parseGeneral(e,t){var r;const n=this.formatter.parseGeneral(e,!1,t,o.GetTimeKind.NonVolatile);return(0,a.isSuccess)(n)||(0,i.throwEvaluationError)(n.reason),null===(r=n.value)||void 0===r?void 0:r.value}parseDate(e){var t;const r=this.formatter.parseDate(e,o.GetTimeKind.NonVolatile);return(0,a.isSuccess)(r)||(0,i.throwEvaluationError)(r.reason),null===(t=r.value)||void 0===t?void 0:t.value}getCellFormula(e){throw new Error("Method not implemented.")}getSheetIndex(e,t){throw new Error("Method not implemented.")}getSheetRangePosition(e){throw new Error("Method not implemented.")}getSheetRangeIndexes(e){throw new Error("Method not implemented.")}getNameFormula(e,t){throw new Error("Method not implemented.")}getCellRef(e,t,r,n){throw new Error("Method not implemented.")}getStructRef(e,t,r){throw new Error("Method not implemented.")}dereferenceAllOpers(){throw new Error("Method not implemented.")}dereferenceAllOpersAndFormulae(){throw new Error("Method not implemented.")}dereferenceOper(e,t){throw new Error("Method not implemented.")}dereferenceOpers(e,t){throw new Error("Method not implemented.")}isInFilterMode(){throw new Error("Method not implemented.")}printFormula(e,t){throw new Error("Method not implemented.")}getBinaryOperator(e){throw new Error("Method not implemented.")}getUnaryOperator(e){throw new Error("Method not implemented.")}parseFormula(e,t,r,n){throw new Error("Method not implemented.")}applyFormat(e,t,r){throw new Error("Method not implemented.")}getRandom(){throw new Error("Method not implemented.")}getTime(e){throw new Error("Method not implemented.")}constructor(e){this.config=e,this.formatter=(0,n.createNumberFormatter)({config:this.config}),this.mathpack=this.config.mathpack,this.datepack=this.config.datepack}}},53964:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAbsoluteIndex=t.rangeOrArrayToVal=t.makeSlicer=t.ArraySlicer=t.RangeSlicer=t.validateArraySize=t.numInt=t.numMod=t.validDateRange=t.chkNumMultiOper=t.chkDateOper=t.atpm1904to1900Days=t.chkNumOper=t.assertError=t.assertString=t.assertNumber=t.wrap2=t.wrap1=void 0;const n=r(51286),i=r(76964),o=r(88065),a=r(57263),s=r(64250),l=r(72006),u=r(737),c=r(1386),d=r(98224),m=r(43560);function g(e,t){const r=(0,i.refToVal)(e,t,!1),s=(0,a.isRichOper)(r)?r.getFallback():r;switch(s.kind){case l.OperKind.Number:return s;case l.OperKind.Boolean:return n.valueErrorOper;case l.OperKind.String:const t=e.coerceOper(s,l.OperKind.Number);return(0,a.isNumberOper)(t)?t:n.valueErrorOper;case l.OperKind.Error:return s;case l.OperKind.Array:return n.valueErrorOper;case l.OperKind.Missing:return n.naErrorOper;case l.OperKind.Blank:return e.mathpack.zero;default:return(0,o.assertNever)("calc.funcs.chkNumOper",s)}}t.wrap1=function(e){return(t,r)=>e(t)(r[0])},t.wrap2=function(e){return(t,r)=>e(t)(r[0],r[1])},t.assertNumber=e=>(0,a.isNumberOper)(e)?e:(0,o.assertFalse)("calc.funcs.assertNumber"),t.assertString=e=>(0,a.isStringOper)(e)?e:(0,o.assertFalse)("calc.funcs.assertString"),t.assertError=e=>(0,a.isErrorOper)(e)?e:(0,o.assertFalse)("calc.funcs.assertError"),t.chkNumOper=g,t.atpm1904to1900Days=1462,t.chkDateOper=function(e,r){let i=g(e,r);if((0,a.isErrorOper)(i))return i;const o=e.mathpack;return o.cond(i)<0?n.numErrorOper:(i=o.floor(i),v(e,i)?(e.config.date1904&&!(0,a.isStringOper)(r)&&(i=o.add(o.fromNumber(t.atpm1904to1900Days),i)),i):n.numErrorOper)},t.chkNumMultiOper=function e(t,r){switch(r.kind){case l.OperKind.Number:return(0,u.success)(new s.StrictSparseArray2D(1,1,1,1,[[r]],n.blankOper));case l.OperKind.String:const o=t.coerceOper(r,l.OperKind.Number);return(0,a.isErrorOper)(o)?(0,u.failure)(n.valueErrorOper):(0,u.success)(new s.StrictSparseArray2D(1,1,1,1,[[o]],n.blankOper));case l.OperKind.Blank:return(0,u.success)(new s.StrictSparseArray2D(1,1,1,1,[[t.mathpack.zero]],n.blankOper));case l.OperKind.Missing:return(0,u.failure)(n.naErrorOper);case l.OperKind.Error:return(0,u.failure)(r);case l.OperKind.Range:return e(t,(0,i.refToVal)(t,r,!1));case l.OperKind.Array:return(0,u.success)(new s.StrictSparseArray2D(r.rows,r.cols,r.rows,r.cols,r.opers,n.blankOper));default:return(0,u.failure)(n.valueErrorOper)}};const p=0,h=2958465,f=0,S=2957003;function v(e,t){let r,n;const i=e.mathpack.lfix(t);return e.config.date1904?(r=f,n=S):(r=p,n=h),i>=r&&i<=n}t.validDateRange=v,t.numMod=function(e,t,r){const n=e.div(t,r);if((0,a.isErrorOper)(n))return n;const i=e.mul(e.trunc(n),r);if((0,a.isErrorOper)(i))return i;const o=e.sub(t,i);return!(0,a.isErrorOper)(o)&&e.cond(t)<0?e.abs(o):o},t.numInt=function(e,t){const r=e.sub(e.trunc(t),t);return(0,a.isNumberOper)(r)&&0===e.cond(r)},t.validateArraySize=function(e,t){if(e*t>1048576)return(0,c.throwEvaluationError)((0,a.notImplemented)(["Very large array size"]))};class y{slice(e,t,r,i){const{row:o,col:a}=this.oper.ranges[0];return(0,n.range3DOper)(this.oper.sheets,(0,d.gridRange)(o+e,a+r,t,i))}constructor(e){this.oper=e;const{rows:t,cols:r}=e.ranges[0];this.rows=t,this.cols=r}}t.RangeSlicer=y;class F{slice(e,t,r,i){return(0,n.arrayOper)(t,i,this.oper.opers.slice(e,e+t).map((e=>e.slice(r,r+i))))}constructor(e){this.oper=e,this.rows=e.opers.length,this.cols=e.opers[0].length}}t.ArraySlicer=F,t.makeSlicer=function(e){return(0,a.isArrayOper)(e)?new F(e):new y(e)},t.rangeOrArrayToVal=function(e,t){return(0,a.isRangeOper)(e)?e.ranges.length>1?t:((0,o.assertTrue)("calc.funcs.rangeOrArrayToVal: not 3D ref",(0,a.isSheetIndex)(e.sheets)),e):e},t.getAbsoluteIndex=function(e,t){return(0,o.assertTrue)("calc.funcs.getAbsoluteIndex",(0,m.isInteger)(t)&&0!==t&&t<=e&&t>=-e),t>0?t-1:e+t}},80049:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.today=t.now=t.randarray=t.randbetween=t.rand=void 0;const n=r(51286),i=r(53964),o=r(57263),a=r(9186),s=r(98224),l=r(88065);function u(e,t,r){const n=e.mathpack,o=(0,i.assertNumber)(n.add(r,n.one));return n.floor(c(e,t,o))}function c(e,t,r){const n=e.mathpack,a=n.sub(r,t),s=e.getRandom();if((0,o.isErrorOper)(a)){const e=n.div(t,n.fromNumber(3)),a=n.div(r,n.fromNumber(3));(0,l.assertTrue)("calc.funcs.getRandomFloatBetween",!(0,o.isErrorOper)(e)&&!(0,o.isErrorOper)(a));const u=n.sub(a,e);return(0,l.assertTrue)("calc.funcs.getRandomFloatBetween",!(0,o.isErrorOper)(u)&&n.cond(u)>=0),(0,i.assertNumber)(n.mul(n.fromNumber(3),(0,i.assertNumber)(n.add(e,(0,i.assertNumber)(n.mul(s,u))))))}return(0,i.assertNumber)(n.add(t,(0,i.assertNumber)(n.mul(s,a))))}t.rand=function(e,t){return e.getRandom()},t.randbetween=function(e,[t,r]){const a=(0,i.chkNumOper)(e,t),s=(0,i.chkNumOper)(e,r);if((0,o.isErrorOper)(a))return a;if((0,o.isErrorOper)(s))return s;const l=e.mathpack;if(l.cond2(a,s)>0)return n.numErrorOper;const u=e.getRandom(),c=l.ceil(a),d=l.floor(s),m=l.sub(d,c);return(0,o.isErrorOper)(m)?m:l.add(l.floor((0,i.assertNumber)(l.mul((0,i.assertNumber)(l.add(m,l.one)),u))),c)},t.randarray=function(e,t){const[r=n.missingOper,a=n.missingOper,l=n.missingOper,d=n.missingOper,m=n.missingOper]=t,g=e.mathpack,p=(0,o.isMissingOper)(r)?1:g.sfix(r),h=(0,o.isMissingOper)(a)?1:g.sfix(a);if(p<0||p>s.sheetRows||h<0||h>s.sheetRows)return n.valueErrorOper;if((0,i.validateArraySize)(p,h),0===p||0===h)return n.calcErrorOper;const f=(0,o.isMissingOper)(l)?g.zero:l,S=(0,o.isMissingOper)(d)?g.one:d;if(g.cond2(f,S)>0)return n.valueErrorOper;const v=!(0,o.isMissingOper)(m)&&m.value;if(v&&(!(0,i.numInt)(g,f)||!(0,i.numInt)(g,S)))return n.valueErrorOper;const y=[];for(let t=0;t<p;t++){const t=[];for(let r=0;r<h;r++){const r=v?u(e,f,S):c(e,f,S);t.push(r)}y.push(t)}return(0,n.arrayOper)(p,h,y)},t.now=function(e,t){return e.getTime(a.TimeGranularity.Instant)},t.today=function(e,t){return e.getTime(a.TimeGranularity.Day)}},4457:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hyperlink=void 0,t.hyperlink=function(e,[t,r]){return e.followHyperlinks?t:null!=r?r:t}},54218:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WildExp=void 0;const n=r(19181).__importStar(r(34791)),i=r(51589);var o;!function(e){e[e.OP_DOT=-1]="OP_DOT",e[e.OP_DOTSTAR=-2]="OP_DOTSTAR"}(o||(o={}));const{codePointTilde:a,codePointQuestionMark:s,codePointAsterisk:l}=n;t.WildExp=class{pushBlock(e){if(""===e)return;const t=this.blocks.length;this.blocks.push(e),this.bytecode.push(t);for(let t=1;t<e.length;t+=1)this.bytecode.push(o.OP_DOT)}pushMeta(e){e===s?this.bytecode.push(o.OP_DOT):this.bytecode.push(o.OP_DOTSTAR)}test(e){if(void 0!==this.simplePattern)return this.testSimple(e,this.simplePattern);let t=Object.create(null);this.addState(t,0);for(let r=0;r<e.length;r+=1){const n=Object.keys(t);if(t=Object.create(null),0===n.length)return!1;for(let i=0;i<n.length;i+=1){const a=Number(n[i]);if(a===this.bytecode.length)continue;const s=this.bytecode[a];switch(s){case o.OP_DOT:this.addState(t,a+1);break;case o.OP_DOTSTAR:this.addState(t,a);break;default:const n=this.blocks[s];r+n.length<=e.length&&0===this.localeInfo.stringCompareCI(n,e.substring(r,r+n.length))&&this.addState(t,a+1)}}}return this.bytecode.length in t}addState(e,t){e[t]=!0;const r=this.bytecode;for(let n=t;n<r.length&&r[n]===o.OP_DOTSTAR;n+=1)e[n+1]=!0}testSimple(e,t){return t.length<=e.length&&(t.length===e.length||this.appendWildcard)&&0===this.localeInfo.stringCompareCI(t,e.substring(0,t.length))}constructor(e,t,r=!1){this.localeInfo=e,this.source=t,this.appendWildcard=r,this.bytecode=[],this.blocks=[];let n="";for(let e=0;e<t.length;e+=1){const r=t.charCodeAt(e);if(r===a&&e+1<t.length){const r=(0,i.stringCodePointAt)(t,e+1);n+=(0,i.stringFromCodePoint)(r),e+=(0,i.numCodeUnits)(r)}else r!==a&&(r!==s&&r!==l?n+=t.charAt(e):(this.pushBlock(n),n="",this.pushMeta(r)))}0===this.bytecode.length&&(this.simplePattern=n),this.pushBlock(n),r&&this.pushMeta(l)}}},53698:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nextFuncs=t.wildcard=t.webFuncs=t.volatileFuncs=t.funcsUtil=t.funcsTestUtils=t.stringFuncs=t.referenceFuncs=t.reduce=t.recordFuncs=t.rangeFuncs=t.predicateFuncs=t.numfmtFuncs=t.mathFuncs=t.lookupFuncs=t.logicalFuncs=t.lambdaFuncs=t.informationFuncs=t.getWorksheetFuncModule=t.engineeringFuncs=t.dateTimeFuncs=t.criteria=t.aggregationFuncs=t.visitedMap=t.value=t.util=t.testUtils=t.term=t.serviceTypes=t.rtree=t.machine=t.extensionTypes=t.evaluatorService=t.evalTypes=t.evalFormula=t.evalCell=t.evalRuntime=t.evalFunction=t.operatorsModule=t.dereferenceModule=t.compilerService=t.coerce=t.calcChain=t.PackageName=void 0;const n=r(19181);t.PackageName="excel-online-calc-runtime",t.calcChain=n.__importStar(r(18423)),t.coerce=n.__importStar(r(44e3)),t.compilerService=n.__importStar(r(91101)),t.dereferenceModule=n.__importStar(r(91649)),t.operatorsModule=n.__importStar(r(81388)),t.evalFunction=n.__importStar(r(66959)),t.evalRuntime=n.__importStar(r(75235)),t.evalCell=n.__importStar(r(70947)),t.evalFormula=n.__importStar(r(13845)),t.evalTypes=n.__importStar(r(1386)),t.evaluatorService=n.__importStar(r(44789)),t.extensionTypes=n.__importStar(r(92843)),t.machine=n.__importStar(r(76964)),t.rtree=n.__importStar(r(75)),t.serviceTypes=n.__importStar(r(86965)),t.term=n.__importStar(r(46619)),t.testUtils=n.__importStar(r(41488)),t.util=n.__importStar(r(22501)),t.value=n.__importStar(r(91700)),t.visitedMap=n.__importStar(r(78949)),t.aggregationFuncs=n.__importStar(r(70157)),t.criteria=n.__importStar(r(83009)),t.dateTimeFuncs=n.__importStar(r(57762)),t.engineeringFuncs=n.__importStar(r(89678)),t.getWorksheetFuncModule=n.__importStar(r(32402)),t.informationFuncs=n.__importStar(r(85125)),t.lambdaFuncs=n.__importStar(r(30096)),t.logicalFuncs=n.__importStar(r(49958)),t.lookupFuncs=n.__importStar(r(82539)),t.mathFuncs=n.__importStar(r(9955)),t.numfmtFuncs=n.__importStar(r(71144)),t.predicateFuncs=n.__importStar(r(82692)),t.rangeFuncs=n.__importStar(r(96660)),t.recordFuncs=n.__importStar(r(75262)),t.reduce=n.__importStar(r(94534)),t.referenceFuncs=n.__importStar(r(49868)),t.stringFuncs=n.__importStar(r(76250)),t.funcsTestUtils=n.__importStar(r(92023)),t.funcsUtil=n.__importStar(r(53964)),t.volatileFuncs=n.__importStar(r(80049)),t.webFuncs=n.__importStar(r(4457)),t.wildcard=n.__importStar(r(54218)),t.nextFuncs=n.__importStar(r(50476))},95288:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustFormulaOrigin=void 0;const n=r(81836);t.adjustFormulaOrigin=n.adjust.adjustFormulaOrigin},24200:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldQuoteQualifier=t.resolvePosition=t.quoteQualifier=t.formatRowRange=t.formatRow=t.formatRangePos=t.formatQualifier=t.formatGridRange=t.formatColRange=t.formatCol=t.formatCellPos=t.columnName=t.canonicaliseRowRange=t.canonicaliseRow=t.canonicaliseRangePos=t.canonicaliseColRange=t.canonicaliseCol=t.canonicaliseCellPos=t.canonicaliseBrackets=void 0;const n=r(81836);t.canonicaliseBrackets=n.cellFormat.canonicaliseBrackets,t.canonicaliseCellPos=n.cellFormat.canonicaliseCellPos,t.canonicaliseCol=n.cellFormat.canonicaliseCol,t.canonicaliseColRange=n.cellFormat.canonicaliseColRange,t.canonicaliseRangePos=n.cellFormat.canonicaliseRangePos,t.canonicaliseRow=n.cellFormat.canonicaliseRow,t.canonicaliseRowRange=n.cellFormat.canonicaliseRowRange,t.columnName=n.cellFormat.columnName,t.formatCellPos=n.cellFormat.formatCellPos,t.formatCol=n.cellFormat.formatCol,t.formatColRange=n.cellFormat.formatColRange,t.formatGridRange=n.cellFormat.formatGridRange,t.formatQualifier=n.cellFormat.formatQualifier,t.formatRangePos=n.cellFormat.formatRangePos,t.formatRow=n.cellFormat.formatRow,t.formatRowRange=n.cellFormat.formatRowRange,t.quoteQualifier=n.cellFormat.quoteQualifier,t.resolvePosition=n.cellFormat.resolvePosition,t.shouldQuoteQualifier=n.cellFormat.shouldQuoteQualifier},72933:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ulsLogger=t.operatorIdToName=t.localeInfo=t.isNumeral=t.getOrdinal=t.getNumberShape=t.getEnglishWorksheetFuncIdToName=t.getEnglishLocaleInfo=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishSpecialRefNames=t.englishPictureSpecial=t.englishPictureSingle=t.englishPictureDbnum=t.englishPictureColor=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishErrorNames=t.createWorksheetFuncNameCallbacks=t.calcConfig=t.TraceLevel=t.PictureSpecial=t.PictureSingle=t.PictureDbnum=t.PictureColor=t.NulLogger=t.LogCategory=t.LCID=t.Country=void 0;const n=r(81836);t.Country=n.config.Country,t.LCID=n.config.LCID,t.LogCategory=n.config.LogCategory,t.NulLogger=n.config.NulLogger,t.PictureColor=n.config.PictureColor,t.PictureDbnum=n.config.PictureDbnum,t.PictureSingle=n.config.PictureSingle,t.PictureSpecial=n.config.PictureSpecial,t.TraceLevel=n.config.TraceLevel,t.calcConfig=n.config.calcConfig,t.createWorksheetFuncNameCallbacks=n.config.createWorksheetFuncNameCallbacks,t.englishErrorNames=n.config.englishErrorNames,t.englishErrorTypeToName=n.config.englishErrorTypeToName,t.englishOperatorIdToName=n.config.englishOperatorIdToName,t.englishPictureColor=n.config.englishPictureColor,t.englishPictureDbnum=n.config.englishPictureDbnum,t.englishPictureSingle=n.config.englishPictureSingle,t.englishPictureSpecial=n.config.englishPictureSpecial,t.englishSpecialRefNames=n.config.englishSpecialRefNames,t.englishSysDateFormat=n.config.englishSysDateFormat,t.englishSysTimeFormat=n.config.englishSysTimeFormat,t.englishWorksheetFuncIdToName=n.config.englishWorksheetFuncIdToName,t.getEnglishLocaleInfo=n.config.getEnglishLocaleInfo,t.getEnglishWorksheetFuncIdToName=n.config.getEnglishWorksheetFuncIdToName,t.getNumberShape=n.config.getNumberShape,t.getOrdinal=n.config.getOrdinal,t.isNumeral=n.config.isNumeral,t.localeInfo=n.config.localeInfo,t.operatorIdToName=n.config.operatorIdToName,t.ulsLogger=n.config.ulsLogger},9186:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.tzUTC=t.tzData=t.dateTime=t.TimeGranularity=t.TimeDivision=t.Rounding=void 0;const n=r(81836);t.Rounding=n.datepack.Rounding,t.TimeDivision=n.datepack.TimeDivision,t.TimeGranularity=n.datepack.TimeGranularity,t.dateTime=n.datepack.dateTime,t.tzData=n.datepack.tzData,t.tzUTC=n.datepack.tzUTC,t.xlDatepack=n.datepack.xlDatepack},95689:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.operatorNode=t.nameNode=t.missingRef=t.localNameUseAnnotation=t.localNameDeclAnnotation=t.literalNode=t.letVar=t.letNode=t.lambdaParam=t.lambdaNode=t.indexedArg=t.identQualifier=t.identNamePart=t.headNamePart=t.formulaSpan=t.formulaRootAnnotation=t.formula=t.flattenNameParts=t.flattenLetArgs=t.flattenLambdaArgs=t.fieldRefNode=t.fieldRefNamePart=t.fieldRef=t.errorQualifier=t.documentQualifier=t.commaOpRef=t.columnRef=t.cellRefSingle=t.cellRefRow=t.cellRefRange=t.cellRefNode=t.cellRefNamePart=t.cellRefError=t.cellRefCol=t.cellRefBad=t.badRef=t.badQualifier=t.arrayNode=t.appNode=t.appHeadNameAnnotation=t.StructRefKind=t.SpecialRefId=t.RefStyle=t.QualifierKind=t.PosKind=t.NodeKind=t.NamePartKind=t.CellRefKind=t.BadType=t.AnnotationKind=void 0,t.missingNode=t.identNode=t.varNode=t.getDepthUpperBound=t.wsfNode=t.thisRowOpRef=t.structRefNode=t.structRef=t.specialRef=t.sheetRangeQualifier=t.sheetQualifier=t.relativeQualifier=t.rangeOpRef=t.pos=t.parenNode=t.paramNode=t.paramName=t.paramDefault=void 0;const n=r(81836);t.AnnotationKind=n.formulaModule.AnnotationKind,t.BadType=n.formulaModule.BadType,t.CellRefKind=n.formulaModule.CellRefKind,t.NamePartKind=n.formulaModule.NamePartKind,t.NodeKind=n.formulaModule.NodeKind,t.PosKind=n.formulaModule.PosKind,t.QualifierKind=n.formulaModule.QualifierKind,t.RefStyle=n.formulaModule.RefStyle,t.SpecialRefId=n.formulaModule.SpecialRefId,t.StructRefKind=n.formulaModule.StructRefKind,t.appHeadNameAnnotation=n.formulaModule.appHeadNameAnnotation,t.appNode=n.formulaModule.appNode,t.arrayNode=n.formulaModule.arrayNode,t.badQualifier=n.formulaModule.badQualifier,t.badRef=n.formulaModule.badRef,t.cellRefBad=n.formulaModule.cellRefBad,t.cellRefCol=n.formulaModule.cellRefCol,t.cellRefError=n.formulaModule.cellRefError,t.cellRefNamePart=n.formulaModule.cellRefNamePart,t.cellRefNode=n.formulaModule.cellRefNode,t.cellRefRange=n.formulaModule.cellRefRange,t.cellRefRow=n.formulaModule.cellRefRow,t.cellRefSingle=n.formulaModule.cellRefSingle,t.columnRef=n.formulaModule.columnRef,t.commaOpRef=n.formulaModule.commaOpRef,t.documentQualifier=n.formulaModule.documentQualifier,t.errorQualifier=n.formulaModule.errorQualifier,t.fieldRef=n.formulaModule.fieldRef,t.fieldRefNamePart=n.formulaModule.fieldRefNamePart,t.fieldRefNode=n.formulaModule.fieldRefNode,t.flattenLambdaArgs=n.formulaModule.flattenLambdaArgs,t.flattenLetArgs=n.formulaModule.flattenLetArgs,t.flattenNameParts=n.formulaModule.flattenNameParts,t.formula=n.formulaModule.formula,t.formulaRootAnnotation=n.formulaModule.formulaRootAnnotation,t.formulaSpan=n.formulaModule.formulaSpan,t.headNamePart=n.formulaModule.headNamePart,t.identNamePart=n.formulaModule.identNamePart,t.identQualifier=n.formulaModule.identQualifier,t.indexedArg=n.formulaModule.indexedArg,t.lambdaNode=n.formulaModule.lambdaNode,t.lambdaParam=n.formulaModule.lambdaParam,t.letNode=n.formulaModule.letNode,t.letVar=n.formulaModule.letVar,t.literalNode=n.formulaModule.literalNode,t.localNameDeclAnnotation=n.formulaModule.localNameDeclAnnotation,t.localNameUseAnnotation=n.formulaModule.localNameUseAnnotation,t.missingRef=n.formulaModule.missingRef,t.nameNode=n.formulaModule.nameNode,t.operatorNode=n.formulaModule.operatorNode,t.paramDefault=n.formulaModule.paramDefault,t.paramName=n.formulaModule.paramName,t.paramNode=n.formulaModule.paramNode,t.parenNode=n.formulaModule.parenNode,t.pos=n.formulaModule.pos,t.rangeOpRef=n.formulaModule.rangeOpRef,t.relativeQualifier=n.formulaModule.relativeQualifier,t.sheetQualifier=n.formulaModule.sheetQualifier,t.sheetRangeQualifier=n.formulaModule.sheetRangeQualifier,t.specialRef=n.formulaModule.specialRef,t.structRef=n.formulaModule.structRef,t.structRefNode=n.formulaModule.structRefNode,t.thisRowOpRef=n.formulaModule.thisRowOpRef,t.wsfNode=n.formulaModule.wsfNode,t.getDepthUpperBound=n.formulaModule.getDepthUpperBound,t.varNode=n.formulaModule.varNode,t.identNode=n.formulaModule.identNode,t.missingNode=n.formulaModule.missingNode},98224:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userDefinedFuncLoc=t.unsafeGridRange=t.structRefColumnLoc=t.sheetRows=t.sheetRangeIndexes=t.sheetRange=t.sheetIndex=t.sheetGridRange=t.sheetGridCube=t.sheetGridCell=t.sheetCols=t.originCell=t.nameScope=t.nameLoc=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceRange=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceCell=t.isSheetIndex=t.isSheetGridRange=t.isSheetGridCell=t.isGridCell=t.gridRange=t.gridCell=t.documentScope=t.documentLoc=t.allSheetsRange=t.NameSource=t.LexicalKind=void 0;const n=r(81836);t.LexicalKind=n.location.LexicalKind,t.NameSource=n.location.NameSource,t.allSheetsRange=n.location.allSheetsRange,t.documentLoc=n.location.documentLoc,t.documentScope=n.location.documentScope,t.gridCell=n.location.gridCell,t.gridRange=n.location.gridRange,t.isGridCell=n.location.isGridCell,t.isSheetGridCell=n.location.isSheetGridCell,t.isSheetGridRange=n.location.isSheetGridRange,t.isSheetIndex=n.location.isSheetIndex,t.lexicalSourceCell=n.location.lexicalSourceCell,t.lexicalSourceGrid=n.location.lexicalSourceGrid,t.lexicalSourceName=n.location.lexicalSourceName,t.lexicalSourceRange=n.location.lexicalSourceRange,t.lexicalSourceWSF=n.location.lexicalSourceWSF,t.lexicalSourceUDF=n.location.lexicalSourceUDF,t.nameLoc=n.location.nameLoc,t.nameScope=n.location.nameScope,t.originCell=n.location.originCell,t.sheetCols=n.location.sheetCols,t.sheetGridCell=n.location.sheetGridCell,t.sheetGridCube=n.location.sheetGridCube,t.sheetGridRange=n.location.sheetGridRange,t.sheetIndex=n.location.sheetIndex,t.sheetRange=n.location.sheetRange,t.sheetRangeIndexes=n.location.sheetRangeIndexes,t.sheetRows=n.location.sheetRows,t.structRefColumnLoc=n.location.structRefColumnLoc,t.unsafeGridRange=n.location.unsafeGridRange,t.userDefinedFuncLoc=n.location.userDefinedFuncLoc},58684:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumberShape=t.KnownFormat=t.DateOrder=t.CurrencyFormat=t.Calendar=void 0;const n=r(81836);t.Calendar=n.numfmt.Calendar,t.CurrencyFormat=n.numfmt.CurrencyFormat,t.DateOrder=n.numfmt.DateOrder,t.KnownFormat=n.numfmt.KnownFormat,t.NumberShape=n.numfmt.NumberShape},12569:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPrinter=t.anonymizeFormula=void 0;const n=r(81836);t.anonymizeFormula=n.printService.anonymizeFormula,t.createPrinter=n.printService.createPrinter},6780:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printLocalsName=t.printLocalsGrid=t.createSimplePrintGlobals=void 0;const n=r(81836);t.createSimplePrintGlobals=n.printServiceTypes.createSimplePrintGlobals,t.printLocalsGrid=n.printServiceTypes.printLocalsGrid,t.printLocalsName=n.printServiceTypes.printLocalsName},89128:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canDenoteCellRef=t.canDenoteUserDefinedFunc=t.canDenoteLocalName=t.resolveGridRef=t.createResolver=void 0;const n=r(81836);t.createResolver=n.resolveService.createResolver,t.resolveGridRef=n.resolveService.resolveGridRef,t.canDenoteLocalName=n.resolveService.canDenoteLocalName,t.canDenoteUserDefinedFunc=n.resolveService.canDenoteUserDefinedFunc,t.canDenoteCellRef=n.resolveService.canDenoteCellRef},7311:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedUserDefinedFunc=t.resolvedStructRef=t.resolvedNever=t.resolvedName=t.resolvedLocalName=t.resolvedDottedName=t.resolvedCellRef=t.resolveLocalsGrid=t.noOriginSheet=t.invalidStructRef=t.invalidQualifier=t.invalidCellRef=t.emptyIntersection=t.ResolvedKind=t.ResolveReasonKind=t.InvalidStructRefReason=t.InvalidQualifierReason=t.InvalidCellRefReason=void 0;const n=r(81836);t.InvalidCellRefReason=n.resolveServiceTypes.InvalidCellRefReason,t.InvalidQualifierReason=n.resolveServiceTypes.InvalidQualifierReason,t.InvalidStructRefReason=n.resolveServiceTypes.InvalidStructRefReason,t.ResolveReasonKind=n.resolveServiceTypes.ResolveReasonKind,t.ResolvedKind=n.resolveServiceTypes.ResolvedKind,t.emptyIntersection=n.resolveServiceTypes.emptyIntersection,t.invalidCellRef=n.resolveServiceTypes.invalidCellRef,t.invalidQualifier=n.resolveServiceTypes.invalidQualifier,t.invalidStructRef=n.resolveServiceTypes.invalidStructRef,t.noOriginSheet=n.resolveServiceTypes.noOriginSheet,t.resolveLocalsGrid=n.resolveServiceTypes.resolveLocalsGrid,t.resolvedCellRef=n.resolveServiceTypes.resolvedCellRef,t.resolvedDottedName=n.resolveServiceTypes.resolvedDottedName,t.resolvedLocalName=n.resolveServiceTypes.resolvedLocalName,t.resolvedName=n.resolveServiceTypes.resolvedName,t.resolvedNever=n.resolveServiceTypes.resolvedNever,t.resolvedStructRef=n.resolveServiceTypes.resolvedStructRef,t.resolvedUserDefinedFunc=n.resolveServiceTypes.resolvedUserDefinedFunc},75929:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unknownFunctionType=t.operatorStrings=t.higherOrderFunctionType=t.getWorksheetFuncType=t.getWorksheetFuncEnglishName=t.getOperatorType=t.WorksheetFuncId=t.OperatorId=void 0;const n=r(81836);t.OperatorId=n.signature.OperatorId,t.WorksheetFuncId=n.signature.WorksheetFuncId,t.getOperatorType=n.signature.getOperatorType,t.getWorksheetFuncEnglishName=n.signature.getWorksheetFuncEnglishName,t.getWorksheetFuncType=n.signature.getWorksheetFuncType,t.higherOrderFunctionType=n.signature.higherOrderFunctionType,t.operatorStrings=n.signature.operatorStrings,t.unknownFunctionType=n.signature.unknownFunctionType},16483:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fieldRef=t.fieldRefNamePart=t.lambdaNode=t.letNode=t.nameNode=t.xorNode=t.unionNode=t.subNode=t.sheet1Name=t.sheet1=t.relPos=t.rangeNode=t.powNode=t.poundNode=t.posNode=t.percentNode=t.orNode=t.negNode=t.neNode=t.mulNode=t.minNode=t.maxNode=t.ltNode=t.leNode=t.isectNode=t.isNameLocEqual=t.gtNode=t.geNode=t.expectTrue=t.eqNode=t.document1=t.divNode=t.createSingleRange=t.concatNode=t.badUnexpCharsNode=t.badStructRefNode=t.badStringLiteralNode=t.badUnexpSeqNode=t.badQualNode=t.badParamNameNode=t.badNumberLiteralNode=t.badFieldRefNode=t.badFieldNameNode=t.badErrorLiteralNode=t.badCellRefNode=t.badBracketNode=t.atNode=t.andNode=t.addNode=t.absPos=void 0;const n=r(81836);t.absPos=n.testUtil.absPos,t.addNode=n.testUtil.addNode,t.andNode=n.testUtil.andNode,t.atNode=n.testUtil.atNode,t.badBracketNode=n.testUtil.badBracketNode,t.badCellRefNode=n.testUtil.badCellRefNode,t.badErrorLiteralNode=n.testUtil.badErrorLiteralNode,t.badFieldNameNode=n.testUtil.badFieldNameNode,t.badFieldRefNode=n.testUtil.badFieldRefNode,t.badNumberLiteralNode=n.testUtil.badNumberLiteralNode,t.badParamNameNode=n.testUtil.badParamNameNode,t.badQualNode=n.testUtil.badQualNode,t.badUnexpSeqNode=n.testUtil.badUnexpSeqNode,t.badStringLiteralNode=n.testUtil.badStringLiteralNode,t.badStructRefNode=n.testUtil.badStructRefNode,t.badUnexpCharsNode=n.testUtil.badUnexpCharsNode,t.concatNode=n.testUtil.concatNode,t.createSingleRange=n.testUtil.createSingleRange,t.divNode=n.testUtil.divNode,t.document1=n.testUtil.document1,t.eqNode=n.testUtil.eqNode,t.expectTrue=n.testUtil.expectTrue,t.geNode=n.testUtil.geNode,t.gtNode=n.testUtil.gtNode,t.isNameLocEqual=n.testUtil.isNameLocEqual,t.isectNode=n.testUtil.isectNode,t.leNode=n.testUtil.leNode,t.ltNode=n.testUtil.ltNode,t.maxNode=n.testUtil.maxNode,t.minNode=n.testUtil.minNode,t.mulNode=n.testUtil.mulNode,t.neNode=n.testUtil.neNode,t.negNode=n.testUtil.negNode,t.orNode=n.testUtil.orNode,t.percentNode=n.testUtil.percentNode,t.posNode=n.testUtil.posNode,t.poundNode=n.testUtil.poundNode,t.powNode=n.testUtil.powNode,t.rangeNode=n.testUtil.rangeNode,t.relPos=n.testUtil.relPos,t.sheet1=n.testUtil.sheet1,t.sheet1Name=n.testUtil.sheet1Name,t.subNode=n.testUtil.subNode,t.unionNode=n.testUtil.unionNode,t.xorNode=n.testUtil.xorNode,t.nameNode=n.testUtil.nameNode,t.letNode=n.testUtil.letNode,t.lambdaNode=n.testUtil.lambdaNode,t.fieldRefNamePart=n.testUtil.fieldRefNamePart,t.fieldRef=n.testUtil.fieldRef},72006:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.SpecialPrecs=t.SignatureType=t.OperKind=t.FunctionFlags=void 0;const n=r(81836);t.FunctionFlags=n.types.FunctionFlags,t.OperKind=n.types.OperKind,t.SignatureType=n.types.SignatureType,t.SpecialPrecs=n.types.SpecialPrecs,t.functionType=n.types.functionType},57263:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridRange=t.isSheetGridCellEqual=t.isSheetGridCell=t.isRichOper=t.isReadOperEqual=t.isRangeOper=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isPrimitiveOper=t.isOperatorNode=t.isNumberOper=t.isNumberLiteralNode=t.isNameScopeEqual=t.isMissingOper=t.isMissingNode=t.isGridRangeEqual=t.isGridCellEqual=t.isGridCell=t.isErrorOper=t.isDocumentLocEqual=t.isCommaOpRefWellFormed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isBooleanOper=t.isBooleanLiteralNode=t.isBlankOper=t.isArrayOper=t.internal=t.gridRangesJoin=t.gridRangeSize=t.gridRangeJoinOpt=t.gridRangeJoin=t.gridRangeIsects=t.gridRangeIsect=t.gridRangeExcept=t.gridRangeCompare=t.gridRangeAnchor=t.gridCellRange=t.gridCellImplicitIsect=t.getEtaFuncId=t.getWorksheetFuncId=t.getUserDefinedFuncName=t.getBoundName=t.getArguments=t.getArgType=t.forEachTileInRange=t.forEachCellInRange=t.createFailureErrorClass=t.ReasonKind=t.LangReasonKind=void 0,t.applyComparison=t.unavailable=t.shouldFieldRefBeBracketed=t.sheetGridRangeAnchor=t.notImplemented=t.normalizeCommaOpRef=t.isWriteOper=t.isWellFormed=t.isWSFNode=t.isValidArgsLength=t.isUnqualifiedNameNode=t.isStringOper=t.isSheetIndexEqual=t.isSheetIndex=t.isSheetGridRangeEqual=void 0;const n=r(81836);t.LangReasonKind=n.util.LangReasonKind,t.ReasonKind=n.util.ReasonKind,t.createFailureErrorClass=n.util.createFailureErrorClass,t.forEachCellInRange=n.util.forEachCellInRange,t.forEachTileInRange=n.util.forEachTileInRange,t.getArgType=n.util.getArgType,t.getArguments=n.util.getArguments,t.getBoundName=n.util.getBoundName,t.getUserDefinedFuncName=n.util.getUserDefinedFuncName,t.getWorksheetFuncId=n.util.getWorksheetFuncId,t.getEtaFuncId=n.util.getEtaFuncId,t.gridCellImplicitIsect=n.util.gridCellImplicitIsect,t.gridCellRange=n.util.gridCellRange,t.gridRangeAnchor=n.util.gridRangeAnchor,t.gridRangeCompare=n.util.gridRangeCompare,t.gridRangeExcept=n.util.gridRangeExcept,t.gridRangeIsect=n.util.gridRangeIsect,t.gridRangeIsects=n.util.gridRangeIsects,t.gridRangeJoin=n.util.gridRangeJoin,t.gridRangeJoinOpt=n.util.gridRangeJoinOpt,t.gridRangeSize=n.util.gridRangeSize,t.gridRangesJoin=n.util.gridRangesJoin,t.internal=n.util.internal,t.isArrayOper=n.util.isArrayOper,t.isBlankOper=n.util.isBlankOper,t.isBooleanLiteralNode=n.util.isBooleanLiteralNode,t.isBooleanOper=n.util.isBooleanOper,t.isCommaOpClosed=n.util.isCommaOpClosed,t.isCommaOpNoBadOrMissing=n.util.isCommaOpNoBadOrMissing,t.isCommaOpRefWellFormed=n.util.isCommaOpRefWellFormed,t.isDocumentLocEqual=n.util.isDocumentLocEqual,t.isErrorOper=n.util.isErrorOper,t.isGridCell=n.util.isGridCell,t.isGridCellEqual=n.util.isGridCellEqual,t.isGridRangeEqual=n.util.isGridRangeEqual,t.isMissingNode=n.util.isMissingNode,t.isMissingOper=n.util.isMissingOper,t.isNameScopeEqual=n.util.isNameScopeEqual,t.isNumberLiteralNode=n.util.isNumberLiteralNode,t.isNumberOper=n.util.isNumberOper,t.isOperatorNode=n.util.isOperatorNode,t.isPrimitiveOper=n.util.isPrimitiveOper,t.isRangeOpClosed=n.util.isRangeOpClosed,t.isRangeOpNoMissing=n.util.isRangeOpNoMissing,t.isRangeOper=n.util.isRangeOper,t.isReadOperEqual=n.util.isReadOperEqual,t.isRichOper=n.util.isRichOper,t.isSheetGridCell=n.util.isSheetGridCell,t.isSheetGridCellEqual=n.util.isSheetGridCellEqual,t.isSheetGridRange=n.util.isSheetGridRange,t.isSheetGridRangeEqual=n.util.isSheetGridRangeEqual,t.isSheetIndex=n.util.isSheetIndex,t.isSheetIndexEqual=n.util.isSheetIndexEqual,t.isStringOper=n.util.isStringOper,t.isUnqualifiedNameNode=n.util.isUnqualifiedNameNode,t.isValidArgsLength=n.util.isValidArgsLength,t.isWSFNode=n.util.isWSFNode,t.isWellFormed=n.util.isWellFormed,t.isWriteOper=n.util.isWriteOper,t.normalizeCommaOpRef=n.util.normalizeCommaOpRef,t.notImplemented=n.util.notImplemented,t.sheetGridRangeAnchor=n.util.sheetGridRangeAnchor,t.shouldFieldRefBeBracketed=n.util.shouldFieldRefBeBracketed,t.unavailable=n.util.unavailable,t.applyComparison=n.util.applyComparison},51286:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calcErrorOper=t.valueErrorOper=t.trueOper=t.stringOper=t.refErrorOper=t.rangeSeqOper=t.range3DOper=t.precedents=t.numErrorOper=t.nullErrorOper=t.nameErrorOper=t.naErrorOper=t.missingOper=t.gettingDataErrorOper=t.fieldErrorOper=t.falseOper=t.errorOper=t.div0ErrorOper=t.cellStringLimit=t.booleanOper=t.blankOper=t.arrayOper=t.PrecsBound=t.ErrorType=void 0;const n=r(81836);t.ErrorType=n.value.ErrorType,t.PrecsBound=n.value.PrecsBound,t.arrayOper=n.value.arrayOper,t.blankOper=n.value.blankOper,t.booleanOper=n.value.booleanOper,t.cellStringLimit=n.value.cellStringLimit,t.div0ErrorOper=n.value.div0ErrorOper,t.errorOper=n.value.errorOper,t.falseOper=n.value.falseOper,t.fieldErrorOper=n.value.fieldErrorOper,t.gettingDataErrorOper=n.value.gettingDataErrorOper,t.missingOper=n.value.missingOper,t.naErrorOper=n.value.naErrorOper,t.nameErrorOper=n.value.nameErrorOper,t.nullErrorOper=n.value.nullErrorOper,t.numErrorOper=n.value.numErrorOper,t.precedents=n.value.precedents,t.range3DOper=n.value.range3DOper,t.rangeSeqOper=n.value.rangeSeqOper,t.refErrorOper=n.value.refErrorOper,t.stringOper=n.value.stringOper,t.trueOper=n.value.trueOper,t.valueErrorOper=n.value.valueErrorOper,t.calcErrorOper=n.value.calcErrorOper},77353:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zipVisitor=t.voidVisitor=t.visitWSFNode=t.visitQualifier=t.visitOperatorNode=t.visitFormulaNode=t.visitCellRef=t.visitAppHeadNode=t.reduceTopDown_Pledge=t.reducePledge=t.reduceBottomUp_Recursive=t.reduceBottomUp_Pledge=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_CPS=t.reduceBottomUp=t.identityVisitor=t.depthVisitor=t.constVisitor=t.composeVisitor=t.bindVisitor=t.binaryVisitor=t.ZipVisitor=t.PledgeReducer=t.IdentityVisitor=t.DelegatingVisitor=t.ConstVisitor=t.ComposeVisitor=t.BinaryVisitor=void 0;const n=r(81836);t.BinaryVisitor=n.visitor.BinaryVisitor,t.ComposeVisitor=n.visitor.ComposeVisitor,t.ConstVisitor=n.visitor.ConstVisitor,t.DelegatingVisitor=n.visitor.DelegatingVisitor,t.IdentityVisitor=n.visitor.IdentityVisitor,t.PledgeReducer=n.visitor.PledgeReducer,t.ZipVisitor=n.visitor.ZipVisitor,t.binaryVisitor=n.visitor.binaryVisitor,t.bindVisitor=n.visitor.bindVisitor,t.composeVisitor=n.visitor.composeVisitor,t.constVisitor=n.visitor.constVisitor,t.depthVisitor=n.visitor.depthVisitor,t.identityVisitor=n.visitor.identityVisitor,t.reduceBottomUp=n.visitor.reduceBottomUp,t.reduceBottomUp_CPS=n.visitor.reduceBottomUp_CPS,t.reduceBottomUp_MaxDepth=n.visitor.reduceBottomUp_MaxDepth,t.reduceBottomUp_Pledge=n.visitor.reduceBottomUp_Pledge,t.reduceBottomUp_Recursive=n.visitor.reduceBottomUp_Recursive,t.reducePledge=n.visitor.reducePledge,t.reduceTopDown_Pledge=n.visitor.reduceTopDown_Pledge,t.visitAppHeadNode=n.visitor.visitAppHeadNode,t.visitCellRef=n.visitor.visitCellRef,t.visitFormulaNode=n.visitor.visitFormulaNode,t.visitOperatorNode=n.visitor.visitOperatorNode,t.visitQualifier=n.visitor.visitQualifier,t.visitWSFNode=n.visitor.visitWSFNode,t.voidVisitor=n.visitor.voidVisitor,t.zipVisitor=n.visitor.zipVisitor},54166:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNumberFormatter=void 0;const n=r(40535);t.createNumberFormatter=n.formatService.createNumberFormatter},41424:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isKnownFormatDefined=t.getSpecial=t.getSingle=t.getKnownFormat=t.getColor=t.englishXLSXKnownFormat=t.buildSingle=t.buildScientificFormat=t.buildPercentFormat=t.buildNumberFormat=t.buildMMDDYYFormat=t.buildFractionFormat=t.buildCurrencyFormat=void 0;const n=r(40535);t.buildCurrencyFormat=n.knownFormat.buildCurrencyFormat,t.buildFractionFormat=n.knownFormat.buildFractionFormat,t.buildMMDDYYFormat=n.knownFormat.buildMMDDYYFormat,t.buildNumberFormat=n.knownFormat.buildNumberFormat,t.buildPercentFormat=n.knownFormat.buildPercentFormat,t.buildScientificFormat=n.knownFormat.buildScientificFormat,t.buildSingle=n.knownFormat.buildSingle,t.englishXLSXKnownFormat=n.knownFormat.englishXLSXKnownFormat,t.getColor=n.knownFormat.getColor,t.getKnownFormat=n.knownFormat.getKnownFormat,t.getSingle=n.knownFormat.getSingle,t.getSpecial=n.knownFormat.getSpecial,t.isKnownFormatDefined=n.knownFormat.isKnownFormatDefined},24946:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tooWide=t.stringEdit=t.renderedValueToString=t.renderedValue=t.renderInfiniteWidth=t.renderCallback=t.previousFormatFailure=t.otherEdit=t.numberEdit=t.notValueString=t.notFormatString=t.noFormatPart=t.memoizedRenderCallback=t.isSystemCultureTag=t.isHashesValue=t.isFormatCultureEqual=t.hashesValue=t.fractionOverflow=t.formulaEdit=t.formattedValue=t.formattedUnitString=t.formattedUnitGeneral=t.formattedUnitFlexible=t.formattedUnitBlank=t.evalFormatLocalsGrid=t.dateOverflow=t.createFormatGlobals=t.aggregationError=t.ReasonKind=t.NumberFormatSource=t.NamedColor=t.GetTimeKind=t.FormattedUnitKind=t.FormatValueType=t.FormatReasonKind=t.FormatCurrency=t.EditKind=t.CultureTag=t.Clip=t.BidiDate=t.Alignment=void 0;const n=r(40535);t.Alignment=n.serviceTypes.Alignment,t.BidiDate=n.serviceTypes.BidiDate,t.Clip=n.serviceTypes.Clip,t.CultureTag=n.serviceTypes.CultureTag,t.EditKind=n.serviceTypes.EditKind,t.FormatCurrency=n.serviceTypes.FormatCurrency,t.FormatReasonKind=n.serviceTypes.FormatReasonKind,t.FormatValueType=n.serviceTypes.FormatValueType,t.FormattedUnitKind=n.serviceTypes.FormattedUnitKind,t.GetTimeKind=n.serviceTypes.GetTimeKind,t.NamedColor=n.serviceTypes.NamedColor,t.NumberFormatSource=n.serviceTypes.NumberFormatSource,t.ReasonKind=n.serviceTypes.ReasonKind,t.aggregationError=n.serviceTypes.aggregationError,t.createFormatGlobals=n.serviceTypes.createFormatGlobals,t.dateOverflow=n.serviceTypes.dateOverflow,t.evalFormatLocalsGrid=n.serviceTypes.evalFormatLocalsGrid,t.formattedUnitBlank=n.serviceTypes.formattedUnitBlank,t.formattedUnitFlexible=n.serviceTypes.formattedUnitFlexible,t.formattedUnitGeneral=n.serviceTypes.formattedUnitGeneral,t.formattedUnitString=n.serviceTypes.formattedUnitString,t.formattedValue=n.serviceTypes.formattedValue,t.formulaEdit=n.serviceTypes.formulaEdit,t.fractionOverflow=n.serviceTypes.fractionOverflow,t.hashesValue=n.serviceTypes.hashesValue,t.isFormatCultureEqual=n.serviceTypes.isFormatCultureEqual,t.isHashesValue=n.serviceTypes.isHashesValue,t.isSystemCultureTag=n.serviceTypes.isSystemCultureTag,t.memoizedRenderCallback=n.serviceTypes.memoizedRenderCallback,t.noFormatPart=n.serviceTypes.noFormatPart,t.notFormatString=n.serviceTypes.notFormatString,t.notValueString=n.serviceTypes.notValueString,t.numberEdit=n.serviceTypes.numberEdit,t.otherEdit=n.serviceTypes.otherEdit,t.previousFormatFailure=n.serviceTypes.previousFormatFailure,t.renderCallback=n.serviceTypes.renderCallback,t.renderInfiniteWidth=n.serviceTypes.renderInfiniteWidth,t.renderedValue=n.serviceTypes.renderedValue,t.renderedValueToString=n.serviceTypes.renderedValueToString,t.stringEdit=n.serviceTypes.stringEdit,t.tooWide=n.serviceTypes.tooWide},87718:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toXLNumber=t.renderFormat=t.initUtilGlobals=t.getValueEditOperKind=t.getFormatString=t.applyValueEdit=void 0;const n=r(40535);t.applyValueEdit=n.util.applyValueEdit,t.getFormatString=n.util.getFormatString,t.getValueEditOperKind=n.util.getValueEditOperKind,t.initUtilGlobals=n.util.initUtilGlobals,t.renderFormat=n.util.renderFormat,t.toXLNumber=n.util.toXLNumber},71916:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createParser=void 0;const n=r(37883);t.createParser=n.parserService.createParser},13276:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseLocals=t.notFormulaString=t.createParseGlobals=t.ReasonKind=void 0;const n=r(37883);t.ReasonKind=n.parseServiceTypes.ReasonKind,t.createParseGlobals=n.parseServiceTypes.createParseGlobals,t.notFormulaString=n.parseServiceTypes.notFormulaString,t.parseLocals=n.parseServiceTypes.parseLocals},18423:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IterativeRecalcState=t.cellRead=t.cellWrite=t.rangeWrite=t.TransactionLogMessageKind=t.TransactionLog=t.WriteResultKind=void 0;const n=r(98224),i=r(75),o=r(69547),a=r(78949),s=r(22501),l=r(57263);var u,c;!function(e){e[e.Next=0]="Next",e[e.Done=1]="Done",e[e.CellWriteLimitReached=2]="CellWriteLimitReached",e[e.CellCycle=3]="CellCycle"}(u||(t.WriteResultKind=u={}));class d{forEachMeets(e,t){const r=this.state[e.sheet.index];void 0!==r&&r.forEachMeets(e.range,t)}setValue(e,t){var r;const n=null!==(r=this.state[e.sheet.index])&&void 0!==r?r:(0,i.makeGridRangeTable)();return new d(Object.assign(Object.assign({},this.state),{[e.sheet.index]:n.setValue(e.range,t)}))}constructor(e){this.state=e}}d.empty=()=>new d({});class m{extract(){return this.log}lookup(e){const t=[];return void 0!==this.current&&(this.current.previousVersions.forEachMeets(e,((e,r)=>(t.push(r),!0))),m.meets(e,this.current.range)&&t.push(this.current)),t}get current(){return this.log[this.log.length-1]}get size(){return this.log.length}insert(e,t){if(void 0===this.current)return void this.log.push({version:0,range:e,message:t,previousVersions:d.empty()});const r={version:this.current.version+1,range:e,message:t,previousVersions:this.current.previousVersions.setValue(this.current.range,this.current)};this.log.push(r)}rollBack(e){if(void 0===this.current)return!1;let t;return this.current.previousVersions.forEachMeets(e,((e,r)=>((void 0===t||r.version<t.version)&&(t=r),!0))),void 0===t?!!m.meets(e,this.current.range)&&(this.truncLog(this.log.length-1),!0):(this.truncLog(t.version),!0)}truncLog(e){this.log.length=(0,o.fastMax)(e,0)}static meets(e,t){return e.sheet.index===t.sheet.index&&(0,l.gridRangeIsects)(e.range,t.range)}constructor(){this.log=[]}}function g(e,t){return{kind:c.RangeWrite,range:e,opers:t}}function p(e,t){return{kind:c.CellWrite,cell:e,oper:t}}t.TransactionLog=m,function(e){e[e.RangeWrite=0]="RangeWrite",e[e.CellWrite=1]="CellWrite",e[e.CellRead=2]="CellRead"}(c||(t.TransactionLogMessageKind=c={})),t.rangeWrite=g,t.cellWrite=p,t.cellRead={kind:c.CellRead};const h={kind:u.CellWriteLimitReached};t.IterativeRecalcState=class{registerVisibleCells(e){for(const t of e)this.ensureNeedsVisit(t);return{kind:u.Next,address:this.address}}registerDynamicDependency(e){for(const t of e){const e={cell:t,previous:this.visitedCells.current,cycle:void 0},r=this.visitedCells.map.getValue(t);if(void 0!==r)return(0,a.recordCellCycle)(r,this.visitedCells.current),{kind:u.CellCycle,cycle:r.cycle};this.workStack.push([t,(0,a.appendVisitedCell)(this.visitedCells,e)]),this.ensureNeedsVisit(t)}return{kind:u.Next,address:this.address}}registerRead(){return 0===this.transactionLog.lookup(this.address).length&&this.transactionLog.insert(this.address,t.cellRead),this.next()}writeRange(e){const{sheet:t,range:{row:r,col:i}}=this.address,o=(0,n.sheetGridRange)(t,(0,n.gridRange)(r,i,e.length,e[0].length));return this.write(o,g(o,e))}writeCell(e){return this.write(this.address,p(this.address,e))}get address(){return this.workStack[this.workStack.length-1][0]}get visitedCells(){return this.workStack[this.workStack.length-1][1]}get grid(){return this.transactionLog}get remainingWork(){return this.workStack}incrementCellWriteCount(e){const t=this.ensureNeedsVisit(e);if(t[1]+=1,t[1]>10)return h}ensureNeedsVisit(e){var t;let r=this.anchorVisitCounts[e.sheet.index];return void 0===r&&(r=this.anchorVisitCounts[e.sheet.index]={}),r[(0,s.gridRangeAnchorHash)(e.range)]=null!==(t=r[(0,s.gridRangeAnchorHash)(e.range)])&&void 0!==t?t:[e,0]}write(e,t){if(this.transactionLog.rollBack(e))return{kind:u.Next,address:this.address};const r=this.incrementCellWriteCount(this.address);return void 0!==r?r:(this.transactionLog.insert(e,t),this.next())}next(){for(;this.workStack.length>1;)if(this.workStack.pop(),0===this.transactionLog.lookup(this.address).length)return{kind:u.Next,address:this.address};if(0===this.transactionLog.lookup(this.address).length)return{kind:u.Next,address:this.address};const e=this.unevaluatedVisibleRanges();if((0,o.safePush)(this.workStack,e),e.length>0)return{kind:u.Next,address:this.address};const t=[],r=[];for(const e of this.transactionLog.extract())switch(e.message.kind){case c.CellWrite:t.push([e.message.cell,e.message.oper]);break;case c.RangeWrite:r.push([e.range,e.message.opers])}return{kind:u.Done,cellWrites:t,rangeWrites:r}}unevaluatedVisibleRanges(){const e=[];for(const t in this.anchorVisitCounts)for(const r in this.anchorVisitCounts[t]){const[n]=this.anchorVisitCounts[t][r];0===this.transactionLog.lookup(n).length&&e.push([n,a.emptyVisitedCells])}return e}constructor(e){this.transactionLog=new m,this.anchorVisitCounts={},this.workStack=[[e,a.emptyVisitedCells]]}}},44e3:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coerceOper=void 0;const n=r(22501),i=r(1386),o=r(72006),a=r(51286),s=r(24946),l=r(57263),u=r(737),c=r(22501),d=r(88065),m=r(16824);function g(e,t){return 0!=(t&o.OperKind.Number)?e.zero:0!=(t&o.OperKind.String)?c.emptyStringOper:0!=(t&o.OperKind.Boolean)?a.falseOper:a.valueErrorOper}function p(e,t,r){const{localeInfo:n,mathpack:c}=e.globals.config;if(0!=(r&t.kind))return t;if((0,l.isNumberOper)(t)){if(0!=(r&o.OperKind.String)){const e=20;return(0,a.stringOper)(c.formatGeneral(n,t,e))}return 0!=(r&o.OperKind.Boolean)?(0,a.booleanOper)(0!==c.cond(t)):0!=(r&o.OperKind.Array)?(0,a.arrayOper)(1,1,[[t]]):a.valueErrorOper}if((0,l.isStringOper)(t)){if(0!=(r&o.OperKind.Number)){if(0===t.value.length)return a.valueErrorOper;if(t.value.length>255)return a.valueErrorOper;const r=e.numberFormatter.parseGeneral(t.value,!1,!0,s.GetTimeKind.NonVolatile);return(0,u.isSuccess)(r)||(0,i.throwEvaluationError)(r.reason),void 0!==r.value?r.value.value:a.valueErrorOper}if(0!=(r&o.OperKind.Boolean)){if(0===n.stringCompareCI(t.value,n.trueName))return a.trueOper;if(0===n.stringCompareCI(t.value,n.falseName))return a.falseOper}return 0!=(r&o.OperKind.Array)?(0,a.arrayOper)(1,1,[[t]]):a.valueErrorOper}if((0,l.isBooleanOper)(t))return 0!=(r&o.OperKind.Number)?t.value?c.one:c.zero:0!=(r&o.OperKind.String)?(0,a.stringOper)(t.value?n.trueName:n.falseName):0!=(r&o.OperKind.Array)?(0,a.arrayOper)(1,1,[[t]]):a.valueErrorOper;switch(t.kind){case o.OperKind.Error:return t;case o.OperKind.Missing:return 0!=(r&o.OperKind.Blank)?a.blankOper:g(c,r);case o.OperKind.Blank:return g(c,r);case o.OperKind.Rich:return(0,m.getTypedFeatureGate)("Microsoft.Office.Excel.CalcTsDec2023Funcs")&&0!=(r&o.OperKind.Array)?(0,a.arrayOper)(1,1,[[t]]):p(e,t.getFallback(),r);case o.OperKind.Range:case o.OperKind.Array:return a.valueErrorOper;default:return(0,d.assertNever)("calc.runtime.coerceOper",t)}}t.coerceOper=function(e,t,r){const i=p(e,t,r);return(0,l.isErrorOper)(i)&&!(0,l.isErrorOper)(t)&&(0,n.traceErrorOper)("calc.runtime.coerceOper",i.type,`kind = ${t.kind}`),i}},91101:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCompiler=t.compiledFormulaTerm=t.compiledFormula=void 0;const n=r(37616),i=r(88065),o=r(46619),a=r(86965),s=r(22501),l=r(95689),u=r(57263),c=r(75929),d=r(49156),m=r(51286),g=r(737),p=r(77353),h=r(69547),f=r(55284),S=r(98224),v=r(16824),y=r(89128),F=(0,u.createFailureErrorClass)("CompileError"),C=(0,s.makeStrict)((0,c.getWorksheetFuncType)(c.WorksheetFuncId.IF)),R=(0,s.makeStrict)((0,c.getWorksheetFuncType)(c.WorksheetFuncId.CHOOSE));function b(e){return(0,o.isOperTerm)(e)&&(0,u.isWriteOper)(e)}class E{literalNode(e,t,r){return f.Pledge.resolve(this.noopTerm(e,r))}arrayNode(e,t,r){return f.Pledge.all(e.map((e=>f.Pledge.all(e.map(this.lazyVisitFormulaNode))))).bind((e=>this.toArrayTerm(e,r)))}toArrayTerm(e,t){const r=e.length,n=void 0===e[0]?0:e[0].length,i=e.map((e=>e.map((e=>e.kind===o.TermKind.Noop?e.children:e))));return i.every((e=>e.every(b)))?this.noopTerm((0,m.arrayOper)(r,n,i),t):(0,o.arrayTerm)(r,n,e,t)}appNode(e,t,r,n){var a;const s=(null===(a=this.context.annotations[n])||void 0===a?void 0:a.kind)===l.AnnotationKind.FormulaRoot;if((0,u.isOperatorNode)(e)){const r=(0,c.getOperatorType)(e.id);return f.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((t=>(0,o.appTerm)((0,o.operatorIdToName)(e.id),r,s,void 0,t,n)))}const d=(0,u.getArguments)(t);if((0,u.isWSFNode)(e)){const{id:t}=e;switch(t){case c.WorksheetFuncId.IFERROR:case c.WorksheetFuncId.IFNA:{(0,i.assertTrue)("calc.runtime.toIfPredicateTerm: expected wff",2===d.length);const[e,r]=d,o=new E(Object.assign(Object.assign({},this.context),{numNames:this.context.numNames+1}));return f.Pledge.all([this.lazyVisitFormulaNode(e),f.Pledge.try((()=>(0,p.visitFormulaNode)(o,r)))]).bind((([e,r])=>this.toIfPredicateTerm(t===c.WorksheetFuncId.IFERROR?c.WorksheetFuncId.ISERROR:c.WorksheetFuncId.ISNA,e,r,n)))}case c.WorksheetFuncId._UDF:return(0,i.assertFalse)("calc.runtime.appNode: expected wff (not UDF)")}return f.Pledge.all(d.map(this.lazyVisitFormulaNode)).bind((e=>{switch(t){case c.WorksheetFuncId.IF:return this.toIfTerm(e,n);case c.WorksheetFuncId.CHOOSE:return this.toChooseTerm(e,n)}const r=(0,c.getWorksheetFuncType)(t);return(0,o.appTerm)((0,o.worksheetFunctionIdToName)(t),r,!1,void 0,e,n)}))}return this.lazyVisitFormulaNode(e).bind((e=>f.Pledge.all(d.map(this.lazyVisitFormulaNode)).bind((t=>this.toAppTerm(e,t,n)))))}toIfPredicateTerm(e,t,r,n){const i=(0,o.readStackTerm)(0,void 0),a=(0,o.conditionalTerm)((0,o.worksheetFunctionIdToName)(c.WorksheetFuncId.IF),C,!1,(0,o.appTerm)((0,o.worksheetFunctionIdToName)(e),(0,c.getWorksheetFuncType)(e),!1,void 0,[i],void 0),[r,i],void 0);return(0,o.letTerm)([t],!1,[void 0],a,n)}toIfTerm(e,t){switch(e.length){case 3:return(0,o.conditionalTerm)((0,o.worksheetFunctionIdToName)(c.WorksheetFuncId.IF),C,!1,e[0],[e[1],e[2]],t);case 2:return(0,o.conditionalTerm)((0,o.worksheetFunctionIdToName)(c.WorksheetFuncId.IF),C,!1,e[0],[e[1],m.falseOper],t);case 1:throw new F((0,u.notImplemented)(["single-argument IF"]));default:return(0,i.assertFalse)("calc.runtime.toIfTerm: expected wff")}}toChooseTerm(e,t){return(0,i.assertTrue)("calc.runtime.toChooseTerm: expected wff",e.length>=1),(0,o.conditionalTerm)((0,o.worksheetFunctionIdToName)(c.WorksheetFuncId.CHOOSE),R,!1,e[0],e.slice(1),t)}toAppTerm(e,t,r){return(0,o.appTerm)((0,o.worksheetFunctionIdToName)(c.WorksheetFuncId._UDF),(0,c.higherOrderFunctionType)(),!1,void 0,[e,...t],r)}letNode(e,t,r,n,s,l){const u=e.id===c.WorksheetFuncId.LETREC||e.id!==c.WorksheetFuncId.LET&&(0,i.assertFalse)("calc.runtime.compile");(0,i.assertTrue)("calc.runtime.letNode: expected wff",void 0!==r);const d=this.bindNames(t),m=d[t.length],g=t.map((({name:e})=>e.arg.label));let h;return h=u?f.Pledge.all(t.map((({binder:e})=>f.Pledge.try((()=>(0,p.visitFormulaNode)(m,e.arg)))))):f.Pledge.all(t.map((({binder:e},t)=>{const r=d[t];return f.Pledge.try((()=>(0,p.visitFormulaNode)(r,e.arg)))}))),h.bind((e=>(0,p.visitFormulaNode)(m,r.arg).bind((r=>(0,o.letTerm)(e.map(((e,r)=>this.noopTerm(e,(0,a.runtimePositionLetVal)(t[r].name.arg.label,t[r].binder.arg.label)))),u,g,r,l)))))}lambdaNode(e,t,r,n,a,s){(0,i.assertTrue)("calc.runtime.lambdaNode: expected wff",void 0!==r);const l=this.bindNames(t),u=l[t.length],c=t.reduce(((e,{name:t},r)=>(0,h.fastMax)(e,t.arg.isOptional?0:r+1)),0),d=t.length;return f.Pledge.all(t.map((({name:e},t)=>{if(void 0===e.arg.def)return f.Pledge.resolve(void 0);const r=l[t],n=e.arg.def.rhs;return f.Pledge.try((()=>(0,p.visitFormulaNode)(r,n)))}))).bind((e=>(0,p.visitFormulaNode)(u,r.arg).bind((r=>{const n=[...e.map(((e,t)=>[e,t])).filter((e=>void 0!==e[0])).map((([e])=>e)),r];return(0,o.lambdaTerm)((e=>e>=c&&e<=d),t.map((({name:e})=>({paramNodeLabel:e.arg.label,paramNameLabel:e.arg.name.name.label,hasDef:void 0!==e.arg.def,isRest:!1}))),n,s)}))))}bindNames(e){const t=this.context.numNames,r=[this];return e.reduce(((e,{name:n},o)=>{(0,i.assertTrue)("calc.runtime.bindNames: expected wff",void 0!==n.arg.wholeName);const a=e.setValue((0,u.getBoundName)(this.context.localeInfo,n.arg.wholeName),t+o);return r.push(new E(Object.assign(Object.assign({},this.context),{names:a,numNames:t+o+1}))),a}),this.context.names),r}parenNode(e,t,r){return this.lazyVisitFormulaNode(e).bind((e=>this.noopTerm(e,r)))}nameNode(e,t,r){var n;const i=(null===(n=this.context.annotations[r])||void 0===n?void 0:n.kind)===l.AnnotationKind.AppHeadName;return f.Pledge.resolve(this.toNameTerm(e,t,i))}toNameTerm(e,t,r){const{locals:n,names:s,numNames:d}=this.context,m=(0,l.flattenNameParts)(e).parts;if((0,y.canDenoteLocalName)(t,m)){const[e,...t]=m,r=s.getEntry((0,u.getBoundName)(this.context.localeInfo,e.asWhole));if(void 0!==r){const n=r.value,i=(0,o.readStackTerm)(d-n-1,e.qualifiedLabel);return f.Pledge.resolve(t.reduce(((e,t)=>this.toFieldRefTerm(e,t.rhs.field.whole,t.qualifiedLabel)),i))}}let g;if(null==t&&(0,v.getTypedFeatureGate)("Microsoft.Office.Excel.CalcEtaLambda")&&(0,v.getTypedFeatureGate)("Microsoft.Office.Excel.EtaReducedLambdas")){const t=(0,u.getEtaFuncId)(this.context.localeInfo,e.asWhole);if(void 0!==t){const r=Object.assign({},(0,c.getWorksheetFuncType)(t));r.maxArgs=(0,h.fastMin)(254,r.maxArgs),g=(0,o.lambdaTerm)((e=>(0,u.isValidArgsLength)(r,e)),[{paramNodeLabel:void 0,paramNameLabel:void 0,hasDef:!1,isRest:!0}],[(0,o.appTerm)((0,o.worksheetFunctionIdToName)(t),r,!1,[{isSpread:!0}],[(0,o.readStackTerm)(0,void 0)],(0,a.runtimePositionEtaLambdaBody)(t))],e.qualifiedLabel)}}if((0,y.canDenoteCellRef)(n,t,m)){const[e,...r]=m,n=null!=t&&t.kind===l.QualifierKind.Ident?(0,l.sheetQualifier)(t.name,void 0,t.isQuoted,t.label):t,i=(0,o.cellRefTerm)(e.ref,n,e.qualifiedLabel);g=r.reduce(((e,t)=>this.toFieldRefTerm(e,t.rhs.field.whole,t.qualifiedLabel)),i)}return(0,y.canDenoteUserDefinedFunc)(r,t,e)&&(g=(0,o.udfTerm)(e.asWhole,t,g,e.qualifiedLabel)),e.canDenoteNamedObject&&(g=(0,o.nameTerm)(e.asWhole,t,r?S.NameSource.AppHead:S.NameSource.Plain,g,e.qualifiedLabel)),(0,i.assertTrue)("calc.runtime.compile: expected wff NameNode",void 0!==g),f.Pledge.resolve(g)}cellRefNode(e,t,r){return f.Pledge.resolve((0,o.cellRefTerm)(e,t,r))}fieldRefNode(e,t,r){(0,i.assertTrue)("calc.runtime.compile: expected wff FieldRef",t.field.kind===l.NodeKind.Ident);const n=t.field.whole;return this.lazyVisitFormulaNode(e).bind((e=>this.toFieldRefTerm(e,n,r)))}toFieldRefTerm(e,t,r){const n=c.WorksheetFuncId.FIELDVALUE;return(0,o.appTerm)((0,o.worksheetFunctionIdToName)(n),(0,c.getWorksheetFuncType)(n),!1,void 0,[e,(0,m.stringOper)(t)],r)}noopTerm(e,t){return this.context.locals.emitStepInfo?(0,o.noopTerm)(e,t):e}structRefNode(e,t,r){return f.Pledge.resolve((0,o.structRefTerm)((0,l.structRefNode)(e,t,r),r))}missingNode(e,t){return(0,i.assertFalse)("calc.runtime.compile: unexpected missing node")}badSequenceNode(e,t,r){return(0,i.assertFalse)("calc.runtime.compile: unexpected bad node")}badCharsNode(e,t,r){return(0,i.assertFalse)("calc.runtime.compile: unexpected bad node")}operatorNode(e,t){return f.Pledge.resolve((0,l.operatorNode)(e,t))}wsfNode(e,t,r){return f.Pledge.resolve((0,l.wsfNode)(e,t,r))}constructor(e){this.context=e,this.visitFormulaNode=e=>(0,p.visitFormulaNode)(this,e),this.lazyVisitFormulaNode=e=>f.Pledge.resolve(e).bind(this.visitFormulaNode)}}const T={[c.OperatorId.At]:c.WorksheetFuncId.SINGLE,[c.OperatorId.Pound]:c.WorksheetFuncId.ANCHORARRAY},k=[function(e){if(!(0,o.isOperTerm)(e)&&e.kind===o.TermKind.App&&(0,o.isOperatorName)(e.data.funName)){const t=T[(0,o.operatorNameToId)(e.data.funName)];if(void 0!==t)return(0,o.appTerm)((0,o.worksheetFunctionIdToName)(t),(0,c.getWorksheetFuncType)(t),e.data.isFormulaRoot,e.data.args,e.children,e.position)}return e}],P=(e,t)=>t(e),N=e=>k.reduce(P,e);function A(e,t){return Object.assign(Object.assign({},e),{term:t})}t.compiledFormula=A,t.compiledFormulaTerm=function(e,t){return"object"!=typeof t.term?(0,i.assertFalse)(`${e}: expected known compiled formula type; given ${(0,n.anonymize)(t)}`):t.term},t.createCompiler=function(e){return{compileFormula:(t,r)=>function(e,t,r){var n,i,a;try{const s=null!==(i=null===(n=t.config)||void 0===n?void 0:n.localeInfo)&&void 0!==i?i:e.config.localeInfo,{names:c,numNames:m}=function(e,t){const r=t.annotations[t.node.label],n=d.RedBlackMapTree.create(e.stringCompareCI);if((null==r?void 0:r.kind)===l.AnnotationKind.FormulaRoot){const{contextNames:t=[]}=r;return{names:t.reduce(((t,r,n)=>t.setValue((0,u.getBoundName)(e,r.whole),n)),n),numNames:t.length}}return{names:n,numNames:0}}(s,r),h={globals:e,locals:t,localeInfo:s,annotations:r.annotations,names:c,numNames:m},f=(a=(0,p.reducePledge)(new E(h),r),(0,o.transformBottomUp)(a,N));return(0,g.success)(A(r,f))}catch(e){return e instanceof F?(0,g.failure)(e.reason):(0,g.failure)((0,g.javaScriptError)(e))}}(e,t,r)}}},91649:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dereferenceOpers=t.dereferenceOper=t.dereference=t.getCellValuesAsArray=void 0;const n=r(88065),i=r(16824),o=r(64250),a=r(37616),s=r(86965),l=r(1386),u=r(76964),c=r(22501),d=r(43512),m=r(51286),g=r(69547),p=r(57263),h=r(98224),f=r(78949),S=r(72006),v=r(737),y=16;function F(e,t){const r=t.map.getValue(e);if(void 0!==r){const e=(0,f.recordCellCycle)(r,t.current);return(0,l.throwEvaluationError)(e)}}function C(e,t,r){e.precedents.cells.push(t);const n=e.globals.getCellValue(t);if(n.kind===v.ResultKind.Failure)return(0,l.throwEvaluationError)(n.reason);const i=n.value;if(i.kind===s.CellKind.FinalValue)return i.oper;F(i.anchor,e.visitedCells),r.push(i.anchor)}function R(e,t,r,i){let a;if(e.precedents.cells.push(t),!i||(0,p.gridRangeSize)(t.range)<=y)a=t;else{const r=e.globals.getUsedRange(t.sheet);let n;(0,v.isSuccess)(r)?n=null==r.value?void 0:r.value.range:(0,l.throwEvaluationError)(r.reason);const i=void 0===n?void 0:(0,p.gridRangeIsect)(t.range,(0,h.gridRange)(0,0,n.row+n.rows,n.col+n.cols));if(void 0===i)return new o.StrictSparseArray2D(t.range.rows,t.range.cols,0,0,[],m.blankOper);a=(0,h.sheetGridRange)(t.sheet,i)}const u=e.globals.getCellValues(a);if(u.kind===v.ResultKind.Failure)return(0,l.throwEvaluationError)(u.reason);const c=r.length,d=function(e,t,r,i,a){const l=[],u=i.length;let c=0;(0,n.assertTrue)("calc.runtime.deference: readIntoArray2D number of rows",u===r.rows);for(let o=0;o<u;o+=1){l.push([]);const u=i[o].length;(0,n.assertTrue)("calc.runtime.deference: readIntoArray2D number of cols",u===r.cols),c=0===o?u:(0,g.fastMin)(u,c);for(let r=0;r<u;r+=1){const u=i[o][r];s.CellKind.FinalValue===u.kind?l[o][r]=u.oper:(F(u.anchor,e.visitedCells),(0,n.assertTrue)("calc.runtime.deference: readIntoArray2D correct sheet",(0,p.isSheetIndexEqual)(u.anchor.sheet,t.sheet)),a.push(u.anchor),l[o][r]=m.refErrorOper)}}return new o.StrictSparseArray2D(t.range.rows,t.range.cols,u,c,l,m.blankOper)}(e,t,a.range,u.value,r);return c===r.length?d:void 0}function b(e,t,r){const n=R(e,t,r,!1);if(null!=n)return(0,m.arrayOper)(n.rows,n.cols,n.rows===n.denseRows&&n.cols===n.denseCols?n.denseElements:(0,o.array2DToJaggedArray)(n))}function E(e,t,r,n){if(0!=(r&S.OperKind.Range))return t;if(!(0,p.isRangeOper)(t))return t;const o=t.sheets;if(!(0,p.isSheetIndex)(o))return(0,c.traceErrorOper)("calc.runtime.dereference",m.ErrorType.REF,`3D range, oper = ${(0,a.anonymize)(t)}`),m.refErrorOper;if(1!==t.ranges.length)return(0,c.traceErrorOper)("calc.runtime.dereference",m.ErrorType.VALUE,`union range, oper = ${(0,a.anonymize)(t)}`),m.valueErrorOper;const s=t.ranges[0];if(0!=(r&u.singleReadOperType)){if((0,p.isGridCell)(s))return C(e,(0,h.sheetGridCell)(o,s),n);if(e.locals.implicitIntersect&&(0,i.isFeatureEnabled)(i.FeatureName.CalcLegacyImplicitIntersection)&&!(0,i.isFeatureEnabled)(i.FeatureName.CalcPreventSpillingHack)){const r=e.locals.originGridCell;if(!(0,v.isSuccess)(r))return(0,l.throwEvaluationError)(r.reason);const i=(0,p.gridCellImplicitIsect)(r.value,s);return null==i?((0,c.traceErrorOper)("calc.runtime.dereference",m.ErrorType.VALUE,`empty intersection, oper = ${(0,a.anonymize)(t)}`),m.valueErrorOper):C(e,(0,h.sheetGridCell)(o,i),n)}return b(e,(0,h.sheetGridRange)(o,s),n)}return 0!=(r&S.OperKind.Array)?b(e,(0,h.sheetGridRange)(o,s),n):((0,c.traceErrorOper)("calc.runtime.dereference",m.ErrorType.VALUE,`bad target type ${r}`),m.valueErrorOper)}t.getCellValuesAsArray=R,t.dereference=E,t.dereferenceOper=function(e,t,r){const i=[],o=E(e,t,r,i);if(null==o){if(i.length>0)return(0,l.throwEvaluationError)((0,l.unevaluated)(i));const e=`calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = ${(0,a.anonymize)(t)}`;return n.ulsLogger.ULS.assertTag(595980819,d.LogCategory.msoulscat_ES_EWAJS,!1,e)}return o},t.dereferenceOpers=function(e,t,r){const n=[];for(let i=0;i<t.length;i+=1){const o=E(e,t[i],(0,p.getArgType)(r,i,t.length),n);null!=o&&(t[i]=o)}if(n.length>0)return(0,l.throwEvaluationError)((0,l.unevaluated)(n))}},70947:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCellEvaluationMachine=void 0;const n=r(88065),i=r(86965),o=r(1386),a=r(1386),s=r(76964),l=r(737),u=r(78949),c=r(78949),d=r(98224),m=r(55284),g=r(51286),p=r(37616),h=r(57263),f=r(22501),S=r(91700),v=r(16824);class y{evalCell(){const e=this.context.globals.getCellValue(this.cell);if(e.kind===l.ResultKind.Failure)return{kind:o.CellEvaluationResultKind.ReadFailure,failure:e};const t=e.value;if(t.kind===i.CellKind.FinalValue)return{kind:o.CellEvaluationResultKind.ReadOper};const r=this.context.globals.getCellFormula(t.anchor);if(r.kind===l.ResultKind.Failure){const e="calc.runtime.CellEvaluationMachine.next: unexpected Failure from getCellFormula";return(0,n.assertFalse)(e)}const d=r.value;if(null==d){const e=`calc.runtime.CellEvaluationMachine.next: client error: expected getCellFormula(${(0,p.anonymize)(t.anchor)}) != null`;return(0,n.assertFalse)(e)}const g=this.visitAnchor(d),h=this.context.createFormulaEvaluationMachine(this.context,this.stepConfig,(0,a.evalLocalsGrid)(g.source),g.precedents,(0,c.appendVisitedCell)(this.visitedCells,g),u.emptyVisitedNames,s.readOperType,d.formula);return m.Pledge.fromMachine(h).bind(this.receiveSuccess(g)).catch(this.receiveFailure(g))}visitAnchor(e){const t=(0,h.sheetGridRangeAnchor)(e.source.range),r=this.visitedCells.map.getValue(t);if(null!=r){const e=`calc.runtime.CellEvaluationMachine.visitAnchor: unexpected visitValue at ${(0,p.anonymize)(t)}; given ${(0,p.anonymize)(r)}`;return(0,n.assertFalse)(e)}return{cell:t,cycle:void 0,previous:this.visitedCells.current,source:e.source,precedents:(0,a.bottomEvalPrecedents)()}}receiveSuccess(e){return t=>{if((0,h.isRangeOper)(t)||(0,h.isMissingOper)(t)){const e=`calc.runtime.CellEvaluationMachine.receiveSuccess: expected ReadOper; given ${(0,p.anonymize)(t)}`;return(0,n.assertFalse)(e)}return this.writeSuccess(e.source,t,e.precedents)}}receiveFailure(e){return t=>{const r=t.kind===i.ReasonKind.PreviousFailure&&void 0!==e.cycle?e.cycle:t;return this.writeFailure(e.source,r,e.precedents)}}writeSuccess(e,t,r){return this.setCellValue(e,t,r),{kind:o.CellEvaluationResultKind.WroteOper,source:e}}writeFailure(e,t,r){return this.context.globals.setCellFailure(e.range,t,r),{kind:o.CellEvaluationResultKind.WroteFailure,source:e}}setCellValue(e,t,r){const n=this.context.globals.config.mathpack.zero,i=(0,h.isBlankOper)(t)?n:t;if(e.kind===d.LexicalKind.Cell){if((0,h.isArrayOper)(i)){const t=void 0===i.opers[0]?g.naErrorOper:i.opers[0][0],o=(0,h.isBlankOper)(t)?n:t;if(!this.isLambdaEnabled(e,o,r))return;return this.context.globals.setCellValue(e.range,o,r)}if(!this.isLambdaEnabled(e,i,r))return;return this.context.globals.setCellValue(e.range,i,r)}const o=e.range.range,a=(0,f.broadcastWriteOper)(o.rows,o.cols,i).opers,s=e=>(0,h.isBlankOper)(e)?n:e,l=a.map((e=>e.map(s)));if(this.isLambdaEnabled(e,l,r))return this.context.globals.setCellValues(e.range,l,r)}isLambdaEnabled(e,t,r){return!((Array.isArray(t)?t.some((e=>e.some((e=>e instanceof S.LambdaOper)))):t instanceof S.LambdaOper)&&!(0,v.isFeatureEnabled)(v.FeatureName.CalcLambdaCellValues)&&(this.context.globals.setCellFailure(e.range,(0,h.notImplemented)(["LAMBDA cell values"]),r),1))}constructor(e,t,r,n){this.context=e,this.stepConfig=t,this.visitedCells=r,this.cell=n}}t.createCellEvaluationMachine=function(e,t,r,n){return m.Pledge.try((()=>new y(e,t,r,n).evalCell()))}},13845:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCallTermEvaluationMachine=t.createFormulaEvaluationMachine=void 0;const n=r(88065),i=r(86965),o=r(1386),a=r(1386),s=r(1386),l=r(1386),u=r(1386),c=r(1386),d=r(69547),m=r(76964),g=r(737),p=r(78949),h=r(98224),f=r(98224),S=r(51286),v=r(37616),y=r(57263),F=r(22501),C=r(91700),R=r(16824),b=r(46619),E=r(66959),T=r(91649),k=r(72006),P=r(44e3),N=r(91101),A=r(22501),I=r(7311),O=r(95689),_=r(75929),M=()=>(0,c.throwEvaluationError)((0,y.notImplemented)(["LETREC cycle"]));function D(e,t){return{context:e,holeIndex:0,locals:t}}class w{get globals(){return this.context.globals}get numberFormatter(){return this.context.numberFormatter}next(){try{return this.doNext()}catch(e){if(e instanceof c.EvaluationError)return(0,c.handleEvaluationError)(this.context,this.visitedCells,e.reason);throw e}}receiveResult(e){return(0,g.isSuccess)(e)?this.updateTermTransition(e.value):e}doNext(){if((0,b.isOperTerm)(this.term)){const e=this.continuation;if(0===e.length){(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.doNext: lambdaDepth correctly decremented",this.usage.lambdaDepth===this.initialLambdaDepth);const e=(0,T.dereferenceOper)(this,this.term,this.target),t=(0,P.coerceOper)(this,e,this.target);return this.precedents.bound=S.PrecsBound.Exact,!(0,R.isFeatureEnabled)(R.FeatureName.CalcPreventSpillingHack)||this.isNested||this.locals.lexicalSource.kind!==f.LexicalKind.Cell||!(0,y.isArrayOper)(t)||1===t.rows&&1===t.cols?(0,g.success)(t):(0,g.failure)((0,y.notImplemented)(["spilling"]))}const t=e[e.length-1];return this.applyContinuation(this.term,t)}return this.reduceFormula(this.term)}applyContinuation(e,t){var r,i;const o=t.context;switch(o.kind){case b.TermKind.App:{const i=t.holeIndex,a=o.children.length;(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",i<=a);const s=t.locals;return i===a?((0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",(0,y.isMissingOper)(e)),this.dispatchFunction(s,o.data,o.position)):(!0===(null===(r=o.data.args[i])||void 0===r?void 0:r.isSpread)?((0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",e instanceof E.RestArgsOper),(0,d.safePush)(s,e.opers)):((0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",!(e instanceof E.RestArgsOper)),s.push(e)),i+1<a?this.nextHoleTransition(t,o.children[i+1]):this.nextHoleTransition(t,S.missingOper))}case b.TermKind.Conditional:{const r=t.holeIndex;if(0===r){const i=(0,b.worksheetFunctionNameToId)(o.data.funName),a=i===_.WorksheetFuncId.IF?k.OperKind.Boolean:k.OperKind.Number;let s=(0,T.dereferenceOper)(this,e,a);if((0,y.isArrayOper)(s))return t.locals=[s],this.nextHoleTransition(t,o.children[r+1]);if((0,y.isRichOper)(s))return(0,g.failure)((0,y.notImplemented)(["IF/CHOOSE with a rich value condition"]));if(s=(0,P.coerceOper)(this,s,a),i===_.WorksheetFuncId.IF&&(0,y.isBooleanOper)(s))return this.popContextTransition(o.children[s.value?1:2]);if(i===_.WorksheetFuncId.CHOOSE&&(0,y.isNumberOper)(s)){const e=this.context.globals.config.mathpack.fix(s);if(e<1||e>o.children.length-1){const t=`CHOOSE; out of bounds option = ${(0,v.anonymize)(e)}`;return(0,A.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.applyContinuation",S.ErrorType.VALUE,t),this.popContextTransition(S.valueErrorOper)}return this.popContextTransition(o.children[e])}return(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",(0,y.isErrorOper)(s)),this.popContextTransition(s)}const i=t.locals;return i[r]=e,r+1<o.children.length?this.nextHoleTransition(t,o.children[r+1]):this.dispatchFunction(i,o.data,o.position)}case b.TermKind.CallName:{const r=t.locals;return this.locals=r.locals,this.caller=r.caller,this.restoreStack(r),this.visitedNames=r.visitedNames,this.popContextTransition(e)}case b.TermKind.Let:{const r=t.holeIndex,n=o.children.length-1;if(r>=n){const r=t.locals;return this.restoreStack(r),this.popContextTransition(e)}if(o.data.rec){const t=this.stackEnv.getCount()-n+r;this.stackEnv.getValue(t).value=e,this.stackEnv=this.stackEnv.setValue(t,e)}else this.stackEnv=this.stackEnv.setValue(this.stackEnv.getCount(),e),this.stackMapNumPushed+=1;return r+1>=n&&this.isLetTcoPossible()?this.popContextTransition(o.children[r+1]):this.nextHoleTransition(t,o.children[r+1])}case b.TermKind.Array:{const r=(0,T.dereferenceOper)(this,e,F.writeOperType),{rows:n,cols:i}=o.data,a=t.holeIndex,s=a%i,l=i===s+1,u=(a-s)/i,c=t.locals;if(c[u][s]=(0,P.coerceOper)(this,r,F.writeOperType),n===u+1&&l)return this.popContextTransition((0,S.arrayOper)(n,i,c));const d=l?u+1:u,m=l?0:s+1;return this.nextHoleTransition(t,o.children[d][m])}case b.TermKind.CallLambda:{const r=t.locals;return this.locals=r.locals,this.caller=r.caller,this.restoreStack(r),this.usage.lambdaDepth-=1,this.popContextTransition(e)}case b.TermKind.CallFirstOrderFunc:{const r=t.locals;return this.locals=r.locals,this.caller=r.caller,this.restoreStack(r),this.popContextTransition(e)}case b.TermKind.PostStep:{const r=t.locals;return null===(i=this.stepConfig)||void 0===i||i.postStep(r,e),this.popContextTransition(e)}default:return(0,n.assertNever)("calc.runtime.FormulaEvaluationMachine.applyContinuation",o)}}reduceFormula(e){var t,r,a;switch(e.kind){case b.TermKind.CellRef:return this.updateTermTransition(this.evalCellRefTerm(e));case b.TermKind.StructRef:return this.updateTermTransition(this.evalStructRefTerm(e));case b.TermKind.App:{const t=e.data.funName;if(!(0,b.isOperatorName)(t)){const e=(0,b.worksheetFunctionNameToId)(t);if(e!==_.WorksheetFuncId._UDF){const t=this.globals.getWorksheetFunc(e);if(t.kind===g.ResultKind.Failure)return(0,c.throwEvaluationError)(t.reason)}}if(0===e.children.length){const r=new E.FunctionDispatcher(this.context,this.stepConfig,this.locals,this.stackFrameList(e.position),this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(t,e.data.funType,e.data.isFormulaRoot,[]);return this.updateTermTransition(r)}return this.pushContextTransition(e,e.children[0],[])}case b.TermKind.CallLambda:{const n=this.isCallLambdaTcoPossible();if(this.usage.lambdaCalls[0]+1>(null!==(t=this.globals.limits.maxLambdaCalls)&&void 0!==t?t:1/0))return(0,c.throwEvaluationError)((0,i.limitExceeded)(i.LimitKind.LambdaCalls));if(!n&&this.usage.lambdaDepth+1>(null!==(r=this.globals.limits.maxLambdaDepth)&&void 0!==r?r:1/0))return(0,c.throwEvaluationError)((0,i.limitExceeded)(i.LimitKind.LambdaDepth));n||(this.usage.lambdaDepth+=1),this.usage.lambdaCalls[0]+=1;const o=this.stackEnv;this.stackEnv=e.data.capturedStackEnv;const a=this.stackMapList();this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=e.data.capturedStackMap;const s=this.locals;this.locals=(0,c.evalLocalsLambda)(e.data.capturedLocals,this.locals);const l=this.caller;return this.switchCaller(e.data.caller,n),n?this.updateTermTransition(e.children):this.pushContextTransition(e,e.children,{locals:s,caller:l,stackEnv:o,stackMap:a})}case b.TermKind.CallFirstOrderFunc:{const t=this.locals;this.locals=(0,o.evalLocalsFirstOrderFunc)(e.data.source,this.locals);const r=this.caller;this.switchCaller(e.data.caller,!1);const n=this.stackEnv;this.stackEnv=u.emptyStackEnv;const i=this.stackMapList();return this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0,this.pushContextTransition(e,e.children,{locals:t,caller:r,stackEnv:n,stackMap:i})}case b.TermKind.CallMachine:return(0,m.callMachineTransition)(e.data.machine,this);case b.TermKind.Conditional:return this.pushContextTransition(e,e.children[0],void 0);case b.TermKind.Let:{const t=e.children.length-1;if(0===t)return this.updateTermTransition(e.children[0]);const r=this.stackEnv,n=this.stackMapList();if(this.stackMapLabels=e.data.varLabels,this.stackMapNumPushed=0,this.stackMapNext=n,e.data.rec){for(let e=0;e<t;e+=1)this.stackEnv=this.stackEnv.setValue(this.stackEnv.getCount(),new u.LazyOper(M));this.stackMapNumPushed+=t}return this.pushContextTransition(e,e.children[0],{stackEnv:r,stackMap:n})}case b.TermKind.Name:return this.updateTermTransition(this.evalNameTerm(e));case b.TermKind.CallName:{const t=e.data.loc,r=this.checkForNameCycle(t),n=this.stackFrameList(e.position),i=this.locals;this.locals=(0,c.evalLocalsName)((0,h.lexicalSourceName)(t),i);const o=this.caller;this.switchCaller(n,!1);const a=this.stackEnv;this.stackEnv=u.emptyStackEnv;const s=this.stackMapList();this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0;const l=this.visitedNames;return this.visitedNames=r,this.pushContextTransition(e,e.children,{locals:i,caller:o,stackEnv:a,stackMap:s,visitedNames:l})}case b.TermKind.Udf:return this.updateTermTransition(this.evalUdfTerm(e));case b.TermKind.ReadStack:{const t=this.stackEnv.getValue(this.stackEnv.getCount()-1-e.data);return(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.reduceFormula: ReadStack oper",void 0!==t),this.updateTermTransition(t instanceof u.LazyOper?t.value:t)}case b.TermKind.Array:return this.pushContextTransition(e,e.children[0][0],e.children.map((()=>[])));case b.TermKind.Lambda:return this.updateTermTransition(new C.LambdaOper(e.data.checkArity,e.position,null!==(a=e.data.params)&&void 0!==a?a:[],this.locals,this.stackEnv,this.stackMapList(),e.children));case b.TermKind.Noop:return this.updateTermTransition(e.children);default:return(0,n.assertNever)("calc.runtime.FormulaEvaluationMachine.reduceFormula",e)}}dispatchFunction(e,t,r){const{funName:n,funType:i,isFormulaRoot:o}=t;(0,T.dereferenceOpers)(this,e,i);const a=new E.FunctionDispatcher(this.context,this.stepConfig,this.locals,this.stackFrameList(r),this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(n,i,o,e);return this.popContextTransition(a)}stackFrameList(e){return(0,s.stackFrameList)(this.locals.lexicalSource,e,this.stackEnv,this.stackMapList(),this.caller)}stackMapList(){return void 0!==this.stackMapLabels&&0!==this.stackMapNumPushed?(0,a.stackMapList)(this.stackMapLabels,this.stackMapNumPushed,this.stackMapNext):this.stackMapNext}noopTerm(e,t){return null!=this.stepConfig?(0,b.noopTerm)(e,t):e}pushContextTransition(e,t,r){const n=D(e,r);return this.continuation.push(n),this.updateTermTransition(t)}popContextTransition(e){return this.continuation.pop(),this.updateTermTransition(e)}nextHoleTransition(e,t){return e.holeIndex+=1,this.updateTermTransition(t)}updateTermTransition(e){if(this.term=e,null!=this.stepConfig&&!(0,b.isOperTerm)(e)&&void 0!==e.position&&e.kind!==b.TermKind.Name&&e.kind!==b.TermKind.Udf){const t=function(e,t,r,n,i){const o=(0,s.stackFrameList)(e,t,r,n,i);return{stack:new l.ES5IterableStackFrame(o)}}(this.locals.lexicalSource,e.position,this.stackEnv,this.stackMapList(),this.caller);if(this.continuation.push(D(b.postStepTerm,t)),this.stepConfig.preStep(t)===i.StepAction.Break)return m.breakTransition}return m.nextTransition}switchCaller(e,t){(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.switchCaller: correct nesting",e.caller===this.caller),t||(this.caller=e)}restoreStack({stackEnv:e,stackMap:t}){var r;this.stackEnv=e,this.stackMapLabels=null==t?void 0:t.labels,this.stackMapNumPushed=null!==(r=null==t?void 0:t.numPushed)&&void 0!==r?r:0,this.stackMapNext=null==t?void 0:t.next}isLetTcoPossible(){const e=this.continuation[this.continuation.length-2];if(void 0===e)return!1;const t=e.context;return t.kind===b.TermKind.Let?e.holeIndex>=t.children.length-1:t.kind===b.TermKind.CallLambda||t.kind===b.TermKind.CallName}isCallLambdaTcoPossible(){const e=this.continuation[this.continuation.length-1];return void 0!==e&&e.context.kind===b.TermKind.CallLambda}getNameFormulaAsTerm(e,t){const r=this.globals.getNameFormula(e,t);if(r.kind===g.ResultKind.Failure)return(0,c.throwEvaluationError)(r.reason);const n=r.value;return null!=n?(0,N.compiledFormulaTerm)("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",n):void 0}checkForNameCycle(e){var t;const r=this.visitedNames,n=r.map.getValue(e);if(void 0!==n){const e=(0,p.recordNameCycle)(n,r.current);return(0,c.throwEvaluationError)(e)}return this.visitedNames.map.getCount()+1>(null!==(t=this.globals.limits.maxNameChain)&&void 0!==t?t:1/0)?(0,c.throwEvaluationError)((0,i.limitExceeded)(i.LimitKind.NameChain)):(0,p.appendVisitedName)(this.visitedNames,e)}evalNameTerm(e){const{resolution:t,precedents:r}=this.context.resolver.resolveName(this.locals,(0,O.nameNode)((0,O.identNamePart)(e.data.name,!0),e.data.qualifier),e.data.source);if((0,d.safePush)(this.precedents.names,r),!(0,g.isSuccess)(t)){if(t.reason.kind===I.ResolveReasonKind.NoOriginSheet){const t=`error ref, no sheet, qualifier = ${(0,v.anonymize)(e.data.qualifier)}`;return(0,A.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalName",S.ErrorType.REF,t),this.noopTerm(S.refErrorOper,e.position)}const r=e.children;return t.reason.kind===I.ResolveReasonKind.InvalidQualifier&&void 0!==r?r:(0,c.throwEvaluationError)(t.reason)}const n=t.value;let o;if(void 0===n||void 0===(o=this.getNameFormulaAsTerm(n,e.data.source))){const t=e.children;if(void 0===t){const t=`error ref, qualifier = ${(0,v.anonymize)(e.data.qualifier)}`;return(0,A.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalName",S.ErrorType.NAME,t),this.noopTerm(S.nameErrorOper,e.position)}return t}return(0,b.callNameTerm)(n,this.noopTerm(o,i.runtimePositionFormulaRoot),e.position)}evalCellRefTerm(e){const{resolution:t}=this.context.resolver.resolveCellRef(this.locals,(0,O.cellRefNode)(e.data.ref,e.data.qualifier));if(!(0,g.isSuccess)(t)){if(t.reason.kind===I.ResolveReasonKind.NoOriginSheet){const t=`error ref, no sheet, qualifier = ${(0,v.anonymize)(e.data.qualifier)}`;return(0,A.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",S.ErrorType.REF,t),S.refErrorOper}return(0,c.throwEvaluationError)(t.reason)}const r=t.value;if(!r){const t=`error ref, qualifier = ${(0,v.anonymize)(e.data.qualifier)}`;return(0,A.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",S.ErrorType.REF,t),S.refErrorOper}return(0,S.range3DOper)(r.sheet,r.range)}evalStructRefTerm(e){const{resolution:t,precedents:r}=this.context.resolver.resolveStructRef(this.locals,e.data);if((0,d.safePush)(this.precedents.names,r),!(0,g.isSuccess)(t)){if(t.reason.kind===I.ResolveReasonKind.NoOriginSheet){const t=`error ref, no sheet, struct ref = ${(0,v.anonymize)(e.data)}`;return(0,A.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",S.ErrorType.REF,t),S.refErrorOper}if(t.reason.kind===I.ResolveReasonKind.EmptyIntersection){const t=`error ref, empty intersection, struct ref = ${(0,v.anonymize)(e.data)}`;return(0,A.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",S.ErrorType.VALUE,t),S.valueErrorOper}return(0,c.throwEvaluationError)(t.reason)}const n=t.value;if(!n){const t=`error ref, struct ref = ${(0,v.anonymize)(e.data)}`;return(0,A.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",S.ErrorType.REF,t),S.refErrorOper}return(0,S.range3DOper)(n.sheet,n.range)}evalUdfTerm(e){const{resolution:t,precedents:r}=this.context.resolver.resolveUserDefinedFunc(this.locals,(0,O.nameNode)((0,O.identNamePart)(e.data.name,!0),e.data.qualifier));if((0,d.safePush)(this.precedents.udfs,r),!(0,g.isSuccess)(t)){const r=e.children;if(t.reason.kind===I.ResolveReasonKind.InvalidQualifier&&void 0!==r)return r;(0,c.throwEvaluationError)(t.reason)}const n=t.value;if(!n){const t=e.children;if(void 0===t){const t=`UDF resolution, qualifier = ${(0,v.anonymize)(e.data.qualifier)}`;return(0,A.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",S.ErrorType.NAME,t),this.noopTerm(S.nameErrorOper,e.position)}return t}if(n.length>1){const t="UDF resolution, ambiguous name";return(0,A.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",S.ErrorType.NAME,t),this.noopTerm(S.nameErrorOper,e.position)}const i=n[0],o=this.globals.getUserDefinedFunc(i);return(0,g.isSuccess)(o)||(0,c.throwEvaluationError)(o.reason),new E.UdfOper(i,o.value)}constructor(e,t,r,i,o,a,s,l,c,d,m){this.context=e,this.stepConfig=t,this.locals=r,this.precedents=i,this.visitedCells=o,this.visitedNames=a,this.usage=s,this.target=l,this.isNested=c,this.runStatus=!1,this.stackEnv=u.emptyStackEnv,this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0,this.continuation=[],d.kind!==b.TermKind.CallLambda&&d.kind!==b.TermKind.CallFirstOrderFunc?(this.term=null!=t?(0,b.noopTerm)(d,void 0):d,this.caller=void 0):((0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.constructor: no preStep for CallTerm",void 0===d.position),this.term=d,this.caller=d.data.caller.caller),this.initialLambdaDepth=s.lambdaDepth,m.length>0&&(this.stackEnv=m.reduce(((e,{value:t})=>e.setValue(e.getCount(),t)),this.stackEnv),this.stackMapLabels=m.map((({label:e})=>e)),this.stackMapNumPushed=m.length)}}t.createFormulaEvaluationMachine=function(e,t,r,o,a,s,l,u){var d;const{contextNames:m=[]}=r,g=u.annotations[u.node.label],p=null!==(d=(null==g?void 0:g.kind)===O.AnnotationKind.FormulaRoot?g.contextNames:void 0)&&void 0!==d?d:[];return(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.createFormulaEvaluationMachine: contextNames",p.length===m.length&&m.every(((e,t)=>e.label===p[t].label))),new w(e,t,r,o,a,s,(0,c.evalUsage)([0],0),l,!1,(0,b.noopTerm)((0,N.compiledFormulaTerm)("calc.runtime.createFormulaEvaluationMachine",u),i.runtimePositionFormulaRoot),m)},t.createCallTermEvaluationMachine=function(e,t,r,n,i,o,a,s){return new w(e,t,r,n,i,o,(0,c.evalUsage)(a.lambdaCalls,a.lambdaDepth),k.SignatureType.All,!0,s,[])}},66959:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FunctionDispatcher=t.RestArgsOper=t.UdfOper=void 0;const n=r(37616),i=r(88065),o=r(64250),a=r(86965),s=r(86965),l=r(1386),u=r(92843),c=r(81388),d=r(46619),m=r(46619),g=r(46619),p=r(46619),h=r(46619),f=r(46619),S=r(22501),v=r(22501),y=r(69547),F=r(72933),C=r(98224),R=r(98224),b=r(57263),E=r(95689),T=r(7311),k=r(13276),P=r(51286),N=r(51286),A=r(76125),I=r(95288),O=r(91700),_=r(75929),M=r(76964),D=r(24946),w=r(87718),L=r(72006),x=r(91649),K=r(44e3),U=r(737),B=r(43560),G=r(6780),W=r(16824);class V{getFallback(){return(0,i.assertFalse)("calc.runtime.UdfOper.getFallback")}getField(e){return(0,i.assertFalse)("calc.runtime.UdfOper.getField")}constructor(e,t){this.kind=L.OperKind.Rich,this.loc=e,this.arity=t.arity,this.func=t.func}}t.UdfOper=V;class j{getFallback(){return(0,i.assertFalse)("calc.runtime.RestArgsOper.getFallback")}getField(e){return(0,i.assertFalse)("calc.runtime.RestArgsOper.getField")}constructor(e){this.opers=e,this.kind=L.OperKind.Rich}}function q(e,t,r,n){(0,i.assertTrue)("calc.runtime.compileCallLambda",e.checkArity(t.length));const o=[];{let r=0,n=0;for(const i of e.params){if(i.isRest){o.push(new j(t.slice(n))),n=t.length;continue}let a=n>=t.length?P.missingOper:t[n++];i.hasDef&&((0,b.isMissingOper)(a)&&(a=e.defsAndBody[r]),++r),o.push(a)}(0,i.assertTrue)("calc.runtime.compileCallLambda",n===t.length&&r===e.defsAndBody.length-1)}const s=n?o.map(((t,r)=>{const n=e.params[r];return void 0===n.paramNodeLabel&&void 0===n.paramNameLabel?t:(0,m.noopTerm)(t,(0,a.runtimePositionLambdaParam)(r,n.paramNodeLabel,n.paramNameLabel))})):o,l=o.map(((t,r)=>e.params[r].paramNodeLabel)),u=e.defsAndBody[e.defsAndBody.length-1],c=(0,m.letTerm)(s,!1,l,u,(0,a.runtimePositionLambdaRoot)(e.lambdaNodeLabel,e,t));return(0,m.callLambdaTerm)(e.locals,e.stackEnv,e.stackMap,r,c)}t.RestArgsOper=j;class H{get globals(){return this.context.globals}get numberFormatter(){return this.context.numberFormatter}get internalCaller(){return(0,i.assertTrue)("calc.runtime.FunctionDispatcher.internalCaller",void 0!==this.internalSource),(0,l.stackFrameList)(this.internalSource,H.internalPosition,l.emptyStackEnv,void 0,this.caller)}get internalContext(){const e=this.internalCaller;return{stack:new l.ES5IterableStackFrame(e)}}get calcingArray(){return this.locals.calcingArray}get originGridCell(){const e=this.locals.originGridCell;return(0,U.isSuccess)(e)?e.value:(0,l.throwEvaluationError)(e.reason)}get originSheet(){const e=this.locals.originSheet;return(0,U.isSuccess)(e)?e.value:(0,l.throwEvaluationError)(e.reason)}get reflectionGridCell(){const e=this.locals.reflectionGridCell;return(0,U.isSuccess)(e)?e.value:(0,l.throwEvaluationError)(e.reason)}get reflectionSheet(){const e=this.locals.reflectionSheet;return(0,U.isSuccess)(e)?e.value:(0,l.throwEvaluationError)(e.reason)}get followHyperlinks(){const e=this.locals.followHyperlinks;return(0,U.isSuccess)(e)?e.value:(0,l.throwEvaluationError)(e.reason)}makeChildDispatcher(e){return new H(this.context,this.stepConfig,this.locals,e,this.precedents,this.visitedCells,this.visitedNames,this.usage)}useAsFuncContext(e){return(0,i.assertTrue)("calc.runtime.FunctionDispatcher.useAsFuncContext: caller shouldn't be set",void 0===this.internalSource),void 0!==e&&(this.internalSource=e),this}applyFunction(e,t){const r=this.makeChildDispatcher(this.internalCaller),n=(0,_.getWorksheetFuncType)(e),i=t.some(b.isRangeOper)?t.slice(0):t;return(0,x.dereferenceOpers)(r,i,n),r.termToFuncResult(r.dispatchFunction((0,f.worksheetFunctionIdToName)(e),n,!1,i))}applyLambda(e,t){return this.termToFuncResult(q(e,t,this.internalCaller,null!=this.stepConfig))}handleEvaluationError(e){if(e instanceof l.EvaluationError)return(0,l.handleEvaluationError)(this.context,this.visitedCells,e.reason)}applyOperatorOrFunction(e,t,r){if((0,f.isOperatorName)(e))return(0,c.applyOperator)(this.globals,(0,f.operatorNameToId)(e),t,r);const n=(0,f.worksheetFunctionNameToId)(e);if(n===_.WorksheetFuncId._UDF){if(t[0]instanceof O.LambdaOper){const e=t[0],r=t.slice(1);return e.checkArity(r.length)?((0,i.assertTrue)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: caller shouldn't be set",void 0===this.internalSource),q(e,r,this.caller,null!=this.stepConfig)):N.valueErrorOper}if(t[0]instanceof V){const e=t[0];if(t.length-1!==e.arity)return N.valueErrorOper;const r=e.func(this.useAsFuncContext((0,C.lexicalSourceUDF)(e.loc)),t.slice(1));if(r.kind===L.OperKind.Error){const e="UDF function return value";(0,v.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",r.type,e)}return this.funcContextResultToTerm(r)}switch(t[0].kind){case L.OperKind.Error:return t[0];case L.OperKind.Number:return N.valueErrorOper;case L.OperKind.Rich:return(0,l.throwEvaluationError)((0,b.notImplemented)(["Rich UDF head"]));case L.OperKind.String:case L.OperKind.Boolean:case L.OperKind.Blank:case L.OperKind.Missing:return N.refErrorOper;case L.OperKind.Array:return(0,W.isFeatureEnabled)(W.FeatureName.CalcLambdaArrayLifting)?(0,i.assertFalse)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: unexpected array UDF head"):(0,l.throwEvaluationError)((0,b.notImplemented)(["Array UDF head"]));case L.OperKind.Range:return(0,W.isFeatureEnabled)(W.FeatureName.CalcLambdaCellValues)?(0,i.assertFalse)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: unexpected range UDF head"):(0,l.throwEvaluationError)((0,b.notImplemented)(["Range UDF head"]));default:return(0,i.assertNever)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",t[0])}}const o=this.globals.getWorksheetFunc(n);if(o.kind===U.ResultKind.Failure)return(0,l.throwEvaluationError)(o.reason);const a=o.value;if(null==a){const e=`nonexistent worksheet function ${n}`;return(0,v.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",N.ErrorType.NAME,e),N.nameErrorOper}try{const e=a(this.useAsFuncContext((0,C.lexicalSourceWSF)(n)),t);if(e.kind===L.OperKind.Error){const t=`worksheet function ${n} return value`;(0,v.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",e.type,t)}return this.funcContextResultToTerm(e)}catch(e){throw(0,B.prependErrorMessage)(e,`(in WSF ${(0,F.englishWorksheetFuncIdToName)(n)})`)}}termToFuncResult(e){switch(e.kind){case h.TermKind.CallLambda:case h.TermKind.CallFirstOrderFunc:return(0,M.machineCall)(this.context.createCallTermEvaluationMachine(this.context,this.stepConfig,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage,e));case h.TermKind.CallMachine:return(0,M.machineCall)(e.data.machine)}return e}funcContextResultToTerm(e){return(0,i.assertTrue)("calc.runtime.FunctionDispatcher.funcContextResultToTerm",void 0!==this.internalSource),(0,M.isMachineCall)(e)?(0,d.callFirstOrderFuncTerm)(this.internalSource,this.caller,(0,p.callMachineTerm)(e.machine,H.internalPosition)):e}dispatchFunction(e,t,r,o){if(!(0,b.isValidArgsLength)(t,o.length)){const r=JSON.stringify(t),n=`calc.runtime.FunctionDispatcher.dispatchFunction: bad application of ${JSON.stringify(e)} to ${o.length} arguments, ftype = ${r}`;return(0,i.assertFalse)(n)}const a=o.length;let s=L.SignatureType.None;for(let e=0;e<a;e+=1){const r=o[e],n=r.kind,i=(0,b.getArgType)(t,e,a);0==(n&i)&&(s|=n),(0,b.isRangeOper)(r)&&0==(t.flags&L.FunctionFlags.Allow3dRef)&&0==(i&L.SignatureType.Ref3D)&&!(0,b.isSheetIndex)(r.sheets)&&(s|=n),(0,b.isStringOper)(r)&&0==(t.flags&L.FunctionFlags.AllowLStrs)&&r.value.length>255&&(0,W.isTypedChangeGateEnabled)("Microsoft.Office.Excel.CalcTsLstr")&&(s|=n)}if(s===L.SignatureType.None)return this.applyOperatorOrFunction(e,o,r);if(0!=(s&L.OperKind.Array)){const r=r=>{const n=this.makeChildDispatcher(this.caller);return n.termToFuncResult(n.dispatchFunction(e,t,!1,r))},{machine:n}=(0,S.arrayLift)(this.useAsFuncContext(void 0),t,r,o);return(0,p.callMachineTerm)(n,void 0)}s&=~L.OperKind.Array;const l=[];for(let e=0;e<a;e+=1){let r=o[e];if(0!=(s&r.kind)){const i=(0,b.getArgType)(t,e,a);if(r=this.coerceOper(r,i),(0,b.isErrorOper)(r)&&0==(i&L.OperKind.Error))return r;if((0,b.isRangeOper)(r)&&0==(t.flags&L.FunctionFlags.Allow3dRef)&&0==(i&L.SignatureType.Ref3D)&&!(0,b.isSheetIndex)(r.sheets)){const e=`3D reference, oper = ${(0,n.anonymize)(r)}`;return(0,v.traceErrorOper)("calc.runtime.FunctionDispatcher.dispatchFunction",N.ErrorType.VALUE,e),N.valueErrorOper}if((0,b.isStringOper)(r)&&0==(t.flags&L.FunctionFlags.AllowLStrs)&&r.value.length>255&&(0,W.isTypedChangeGateEnabled)("Microsoft.Office.Excel.CalcTsLstr")){const e=`LStr, oper = ${(0,n.anonymize)(r)}`;return(0,v.traceErrorOper)("calc.runtime.FunctionDispatcher.dispatchFunction",N.ErrorType.VALUE,e),N.valueErrorOper}}l[e]=r}return this.applyOperatorOrFunction(e,l,r)}getAvailableFormula(e){const t=this.globals.getCellFormula(e);return(0,U.isSuccess)(t)?(0,y.isNone)(t.value)?void 0:t.value:(0,l.throwEvaluationError)(t.reason)}getNameFormula(e,t,r){const{resolution:n,precedents:i}=this.context.resolver.resolveName(this.locals,(0,E.nameNode)((0,E.identNamePart)(t,!0),e),r);if((0,y.safePush)(this.precedents.names,i),!(0,U.isSuccess)(n))switch(n.reason.kind){case T.ResolveReasonKind.NoOriginSheet:case T.ResolveReasonKind.InvalidQualifier:return;default:return(0,l.throwEvaluationError)(n.reason)}const o=n.value;if(!o)return;const a=this.globals.getNameFormula(o,r);(0,U.isSuccess)(a)||(0,l.throwEvaluationError)(a.reason);const s=a.value;return(0,y.isNone)(s)?void 0:[o,s.node]}getCellRef(e,t,r,n){const i={originGridCell:(0,U.success)(r.range),originSheet:(0,U.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:n},{resolution:o}=this.context.resolver.resolveCellRef(i,(0,E.cellRefNode)(t,e));if(!(0,U.isSuccess)(o))switch(o.reason.kind){case T.ResolveReasonKind.NoOriginSheet:case T.ResolveReasonKind.InvalidQualifier:return;default:return(0,l.throwEvaluationError)(o.reason)}const a=o.value;if(a)return(0,N.range3DOper)(a.sheet,a.range)}getStructRef(e,t,r){const n={originGridCell:(0,U.success)(r.range),originSheet:(0,U.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1},{resolution:i,precedents:o}=this.context.resolver.resolveStructRef(n,(0,E.structRefNode)(e,t));if((0,y.safePush)(this.precedents.names,o),!(0,U.isSuccess)(i))switch(i.reason.kind){case T.ResolveReasonKind.NoOriginSheet:case T.ResolveReasonKind.InvalidQualifier:case T.ResolveReasonKind.InvalidStructRef:case T.ResolveReasonKind.EmptyIntersection:return;default:return(0,l.throwEvaluationError)(i.reason)}const a=i.value;if(a)return(0,N.range3DOper)(a.sheet,a.range)}dereferenceOper(e,t){return(0,x.dereferenceOper)(this,e,t)}dereferenceOpers(e,t){(0,x.dereferenceOpers)(this,e,t)}getCellFormula(e){this.precedents.cells.push(e);const t=this.globals.getCellValue(e);return(0,U.isSuccess)(t)?this.getAvailableFormula(e):(0,l.throwEvaluationError)(t.reason)}getSheetIndex(e,t){const r=this.globals.getSheetIndex(e,t);return(0,U.isSuccess)(r)?(this.precedents.special|=L.SpecialPrecs.OwnDocSheets,null==r.value?void 0:(0,R.sheetIndex)(e,r.value)):(0,l.throwEvaluationError)(r.reason)}getSheetRangePosition(e){this.precedents.special|=L.SpecialPrecs.OwnDocSheets;const t=this.globals.getSheetRangeIndexes(e);return(0,U.isSuccess)(t)?t.value.position:(0,l.throwEvaluationError)(t.reason)}getSheetRangeIndexes(e){if(void 0!==e.index&&e.index===e.index2)return[e.index];this.precedents.special|=L.SpecialPrecs.OwnDocSheets;const t=this.globals.getSheetRangeIndexes(e);return(0,U.isSuccess)(t)?t.value.sheets:(0,l.throwEvaluationError)(t.reason)}dereferenceAllOpersInner(e,t,r=!1){const n=[],o=[];for(let a=0;a<e.length;a+=1){const s=e[a];if(!(0,b.isRangeOper)(s)){o.push(s);continue}const c=[],d=e=>{const r=(0,x.getCellValuesAsArray)(this,e,n,!0);void 0!==r&&c.push(t(r,e))},m=this.getSheetRangeIndexes(s.sheets);for(let e=0;e<m.length;e+=1){const t=(0,R.sheetIndex)(s.sheets.document,m[e]);for(let e=0;e<s.ranges.length;e+=1){const n=s.ranges[e];if(!r){d((0,R.sheetGridRange)(t,n));continue}const o=this.globals.tryGetHiddenRows(t,n.row,n.row+n.rows);if(!(0,U.isSuccess)(o))return(0,l.throwEvaluationError)(o.reason);const a=o.value;if(0===a.length){d((0,R.sheetGridRange)(t,n));continue}const u=(e,r)=>{const i=(0,R.gridRange)(e,n.col,r-e,n.cols);d((0,R.sheetGridRange)(t,i))};for(let e=0;e<a.length;e+=1){const{start:r,end:o}=a[e],s=0===e?n.row:a[e-1].end;(0,i.assertTrue)("calc.runtime.FunctionDispatcher.dereferenceAllOpersInner: valid interval",s<=r&&r<o&&o<=n.row+n.rows),s!==r&&u(s,r);const l=(0,R.gridRange)(r,n.col,o-r,n.cols);this.precedents.cells.push((0,R.sheetGridRange)(t,l))}const c=a[a.length-1].end;c!==n.row+n.rows&&u(c,n.row+n.rows)}}o.push({kind:u.DerefOperKind.RangeValues,arrays:c})}return n.length>0?(0,l.throwEvaluationError)((0,l.unevaluated)(n)):o}dereferenceAllOpers(e,t){return this.dereferenceAllOpersInner(e,y.identity,t)}dereferenceAllOpersAndFormulae(e,t){return this.dereferenceAllOpersInner(e,((e,t)=>new o.NonstrictSparseArray2D(e.rows,e.cols,e.denseRows,e.denseCols,((r,n)=>{const i=e.get(r,n),o=(0,R.sheetGridCell)(t.sheet,(0,R.gridCell)(t.range.row+r,t.range.col+n));return[i,this.getAvailableFormula(o)]}),(()=>[e.getSparse(),void 0])).strict()),t)}parseFormula(e,t,r,n){const i=this.context.parser.parseFormula((0,k.parseLocals)(r.lexicalKind,t,{refStyle:e}),n);if(!(0,U.isSuccess)(i))return i;const o=this.context.analyzer.checkFormula(r,i.value);return(0,U.isSuccess)(o)?(0,b.isWellFormed)(o.value)?(o.value,o):(0,U.failure)((0,s.illFormedFormula)("ill-formed indirect formula","indirect")):o}getRandom(){this.precedents.special|=L.SpecialPrecs.Calc;const e=this.internalContext,t=this.globals.getRandom(e);return(0,U.isSuccess)(t)||(0,l.throwEvaluationError)(t.reason),t.value}getTime(e){this.precedents.special|=L.SpecialPrecs.Time;const t=this.globals.getTime(e,D.GetTimeKind.Volatile);return(0,U.isSuccess)(t)||(0,l.throwEvaluationError)(t.reason),t.value}coerceOper(e,t){return(0,K.coerceOper)(this,e,t)}parseGeneral(e,t){var r;const n=this.numberFormatter.parseGeneral(e,!1,t,D.GetTimeKind.NonVolatile);return(0,U.isSuccess)(n)||(0,l.throwEvaluationError)(n.reason),null===(r=n.value)||void 0===r?void 0:r.value}parseDate(e){var t;const r=this.numberFormatter.parseDate(e,D.GetTimeKind.NonVolatile);return(0,U.isSuccess)(r)||(0,l.throwEvaluationError)(r.reason),null===(t=r.value)||void 0===t?void 0:t.value}getBinaryOperator(e){const t=(0,_.getOperatorType)(e),r=[N.falseOper,N.falseOper];return(n,o)=>{r[0]=n,r[1]=o,(0,x.dereferenceOpers)(this,r,t);const a=this.dispatchFunction((0,f.operatorIdToName)(e),t,!1,r);return(0,i.assertTrue)("calc.runtime.FunctionDispatcher.getBinaryOperator",(0,g.isOperTerm)(a)),a}}getUnaryOperator(e){const t=(0,_.getOperatorType)(e),r=[N.falseOper];return n=>{r[0]=n,(0,x.dereferenceOpers)(this,r,t);const o=this.dispatchFunction((0,f.operatorIdToName)(e),t,!1,r);return(0,i.assertTrue)("calc.runtime.FunctionDispatcher.getUnaryOperator",(0,g.isOperTerm)(o)),o}}isInFilterMode(e){this.precedents.special|=L.SpecialPrecs.InFilterMode;for(const t of e)if((0,b.isRangeOper)(t))for(const e of this.getSheetRangeIndexes(t.sheets)){const r=this.globals.isInFilterMode((0,R.sheetIndex)(t.sheets.document,e));if(!(0,U.isSuccess)(r))return(0,l.throwEvaluationError)(r.reason);if(r.value)return!0}return!1}printFormula(e,t){const r=(0,R.sheetGridCell)(e.source.range.sheet,t),n=(0,I.adjustFormulaOrigin)(this.globals,(0,A.analyzeLocalsGrid)(R.LexicalKind.Cell,(0,b.sheetGridRangeAnchor)(e.source.range)),t,e.formula);if(!(0,U.isSuccess)(n))return(0,l.throwEvaluationError)(n.reason);const i=this.context.printer.printFormula((0,G.printLocalsGrid)(e.source,r,{refStyle:this.config.refStyle}),n.value);return(0,U.isSuccess)(i)?i.value:(0,l.throwEvaluationError)(i.reason)}applyFormat(e,t,r,n){let i;if("number"==typeof t){const r=this.globals.getKnownFormat(e,t);if(!(0,U.isSuccess)(r))return(0,l.throwEvaluationError)(r.reason);i=r.value}else{const r=(0,w.getFormatString)(this.context.numberFormatter,this.globals,e,t,n);if(!(0,U.isSuccess)(r))switch(r.reason.kind){case D.FormatReasonKind.PreviousFormatFailure:case D.FormatReasonKind.NotFormatString:return;default:return(0,l.throwEvaluationError)(r.reason)}i=r.value}const o=(0,w.renderFormat)(this.context.numberFormatter,i,r);return(0,U.isSuccess)(o)?"string"==typeof o.value?o.value:void 0:(0,l.throwEvaluationError)(o.reason)}constructor(e,t,r,n,i,o,a,s){this.context=e,this.stepConfig=t,this.locals=r,this.caller=n,this.precedents=i,this.visitedCells=o,this.visitedNames=a,this.usage=s,this.internalSource=void 0;const l=e.globals.config.refStyle;this.config={localeInfo:e.globals.config.localeInfo,get refStyle(){return i.special|=L.SpecialPrecs.RefStyle,l},mathpack:e.globals.config.mathpack,date1904:e.globals.config.date1904,dateCompatibility:e.globals.config.dateCompatibility,timezone:e.globals.config.timezone,datepack:e.globals.config.datepack},this.mathpack=this.config.mathpack,this.datepack=this.config.datepack}}t.FunctionDispatcher=H,H.internalPosition=a.runtimePositionFirstOrderFunc},91320:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNameEvaluationMachine=void 0;const n=r(37616),i=r(88065),o=r(737),a=r(55284),s=r(98224),l=r(72006),u=r(1386),c=r(78949);class d{evalName(){const e=this.context.globals.getNameFormula(this.name,s.NameSource.Plain);if(e.kind===o.ResultKind.Failure)return a.Pledge.reject(e.reason);const t=e.value;if(null==t)return a.Pledge.resolve(void 0);const r=(0,u.bottomEvalPrecedents)(),n=this.context.createFormulaEvaluationMachine(this.context,this.stepConfig,(0,u.evalLocalsName)((0,s.lexicalSourceName)(this.name),(0,u.evalLocalsGrid)(this.origin)),r,c.emptyVisitedCells,(0,c.appendVisitedName)(c.emptyVisitedNames,this.name),l.SignatureType.All,t);return a.Pledge.fromMachine(n).catch(this.receiveFailure())}receiveFailure(){return e=>{if(e.kind===u.RuntimeInternalReasonKind.Unevaluated){const t=`calc.runtime.NameEvaluationMachine.receiveFailure: unexpected reason ${(0,n.anonymize)(e)}`;return(0,i.assertFalse)(t)}return a.Pledge.reject(e)}}constructor(e,t,r,n){this.context=e,this.stepConfig=t,this.name=r,this.origin=n}}t.createNameEvaluationMachine=function(e,t,r,n){return a.Pledge.try((()=>new d(e,t,r,n).evalName()))}},75235:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EvaluationRuntime=t.runtimeTimer=t.calculateNextDeadline=t.createSchedule=void 0;const n=r(88065),i=r(86965),o=r(69547),a=r(76964),s=r(43560),l=r(737);function u(e){if(void 0===e.yieldIntervalMs&&void 0===e.endTimeMs)return;if(void 0===e.yieldIntervalMs)return e.endTimeMs;const t=(0,o.now)()+e.yieldIntervalMs;return void 0===e.endTimeMs?t:(0,o.fastMin)(e.endTimeMs,t)}t.createSchedule=function(e){return{yieldIntervalMs:e.yieldIntervalMs,endTimeMs:null==e.totalTimeMs?void 0:(0,o.now)()+e.totalTimeMs,scheduleFunction:null!=e.scheduleFunction?e.scheduleFunction:e=>setTimeout(e,0)}},t.calculateNextDeadline=u,t.runtimeTimer=function(){return{doTimeout:e=>void 0!==e&&(0,o.now)()>=e}};const c={kind:i.ReasonKind.Timeout},d={kind:i.ReasonKind.Breakpoint};t.EvaluationRuntime=class{evaluateAsync(e){if(this.context.globals.interruptToken[0]===i.Interrupt.Stop)return this.generatePartialResults(),Promise.resolve(this.results);if(this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{const t=this.evaluate(u(e));return Array.isArray(t)?Promise.resolve(t):((0,n.assertTrue)("calc.runtime.EvaluationRuntime.evaluateAsync",t.kind===i.ReasonKind.Timeout),new Promise(((t,r)=>e.scheduleFunction((()=>{try{t(this.evaluateAsync(e))}catch(e){r(e)}})))))}catch(e){return Promise.reject(e)}}evaluateSync(e){const t=r=>{if(this.context.globals.interruptToken[0]===i.Interrupt.Stop||this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),this.results;const o=this.evaluate(r);if(Array.isArray(o))return o;switch(o.kind){case i.ReasonKind.Timeout:return(0,i.paused)((r=>t(null!=r?r:u(e))));case i.ReasonKind.Breakpoint:return(0,i.breaked)((()=>t(u(e))));default:return(0,n.assertNever)("calc.runtime.EvaluationRuntime.evaluateSync",o)}};return t(u(e))}evaluate(e){const t=()=>this.context.timer.doTimeout(e);try{for(;this.results.length<this.machineRuntimes.length;){const e=this.machineRuntimes[this.results.length].run(t);if(e.kind===a.TransitionKind.Next)return c;if(e.kind===a.TransitionKind.Break)return d;this.pushResult(e)}return this.results}catch(e){const t=`calc.runtime.EvaluationRuntime.evaluate: unhandled error ${(0,s.messageFromError)(e)}`;return(0,n.assertFalse)(t)}}pushResult(e){return this.results.push(e),a.nextTransition}generatePartialResults(){for(;this.results.length<this.machineRuntimes.length;)this.results.push((0,l.failure)(i.stopped))}constructor(e,t){(0,n.assertPositiveInteger)("calc.runtime.EvaluationRuntime",t.length),this.context=e,this.machineRuntimes=t.map((e=>new a.MachineRuntime(e))),this.results=[]}}},1386:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CellEvaluationResultKind=t.ES5IterableStackFrame=t.ES5IterableStackValue=t.stackFrameList=t.stackMapList=t.emptyStackEnv=t.LazyOper=t.evalLocalsSlice=t.evalLocalsFirstOrderFunc=t.evalLocalsLambda=t.evalLocalsName=t.evalLocalsGrid=t.evalUsage=t.bottomEvalPrecedents=t.handleEvaluationError=t.throwEvaluationError=t.EvaluationError=t.unevaluated=t.RuntimeInternalReasonKind=void 0;const n=r(86965),i=r(57263),o=r(98224),a=r(88065),s=r(51286),l=r(76964),u=r(72006),c=r(737),d=r(49156);var m,g;function p(e){throw new t.EvaluationError(e)}!function(e){e.Unevaluated="Unevaluated"}(m||(t.RuntimeInternalReasonKind=m={})),t.unevaluated=function(e){return 0===e.length&&(0,a.assertFalse)("calc.runtime.unevaluated: expected nonempty array"),{kind:m.Unevaluated,anchors:e}},t.EvaluationError=(0,i.createFailureErrorClass)("EvaluationError"),t.throwEvaluationError=p;class h{next(){return(0,l.callMachineTransition)(this.machine,this)}receiveResult(e){if(!(0,c.isSuccess)(e))return e;switch(e.value.kind){case g.ReadFailure:return e.value.failure;case g.WroteFailure:return(0,c.failure)((0,n.previousFailure)(e.value.source.range))}return c.successUndefined}constructor(e){this.machine=e,this.runStatus=!1}}t.handleEvaluationError=function(e,t,r){var i;if(r.kind===m.Unevaluated){if(t.map.getCount()+1>(null!==(i=e.globals.limits.maxCellChain)&&void 0!==i?i:1/0))return(0,c.failure)((0,n.limitExceeded)(n.LimitKind.CellChain));const o=r.anchors.map((r=>new h(e.createCellEvaluationMachine(e,void 0,t,r))));return(0,l.callMachineTransition)(new l.AllMachine(o),(0,l.nextOnSuccessReceiver)())}return(0,c.failure)(r)},t.bottomEvalPrecedents=function(){return(0,s.precedents)([],[],[],u.SpecialPrecs.None,s.PrecsBound.Lower)},t.evalUsage=function(e,t){return{lambdaCalls:e,lambdaDepth:t}},t.evalLocalsGrid=function(e){const t=(0,i.sheetGridRangeAnchor)(e.range),r=(0,c.success)(t.range),a=(0,c.success)(t.sheet);return(0,n.evalLocals)(e,r,a,e.kind===o.LexicalKind.Range,r,a,e.kind===o.LexicalKind.Cell,!0,!1,(0,c.success)(!1),void 0)},t.evalLocalsName=function(e,t){const r=e.name.scope;let o;if(void 0!==r.index)o=(0,c.success)(r);else{const e=t.originSheet;if(!(0,c.isSuccess)(e))return p(e.reason);o=(0,i.isDocumentLocEqual)(e.value.document,r.document)?e:(0,c.success)(r)}const a=t.originGridCell;return(0,n.evalLocals)(e,a,o,t.calcingArray,a,o,!1,!1,!0,(0,c.success)(!1),void 0)},t.evalLocalsLambda=function(e,t){return(0,n.evalLocals)(e.lexicalSource,e.originGridCell,e.originSheet,t.calcingArray,t.reflectionGridCell,t.reflectionSheet,t.implicitIntersect,e.allowUnqualifiedCell,e.wrapCellReferences,(0,c.success)(!1),void 0)},t.evalLocalsFirstOrderFunc=function(e,{originGridCell:t,originSheet:r,calcingArray:i,reflectionGridCell:o,reflectionSheet:a,implicitIntersect:s,allowUnqualifiedCell:l,wrapCellReferences:u,followHyperlinks:c}){return(0,n.evalLocals)(e,t,r,i,o,a,s,l,u,c,void 0)},t.evalLocalsSlice=function({lexicalSource:e,originGridCell:t,originSheet:r,calcingArray:i,reflectionGridCell:o,reflectionSheet:a,implicitIntersect:s,allowUnqualifiedCell:l,wrapCellReferences:u,followHyperlinks:c,contextNames:d}){return(0,n.evalLocals)(e,t,r,i,o,a,s,l,u,c,d)};class f{get value(){return void 0===this._value?this.fallback():this._value}set value(e){this._value=e}get valueOrUndefined(){return this._value}constructor(e){this.fallback=e}}t.LazyOper=f,t.emptyStackEnv=d.RedBlackMapTree.create(((e,t)=>e-t)),t.stackMapList=function(e,t,r){return{labels:e,numPushed:t,next:r}},t.stackFrameList=function(e,t,r,n,i){var o;return{stackDepth:1+(null!==(o=null==i?void 0:i.stackDepth)&&void 0!==o?o:0),lexicalSource:e,position:t,localValues:new S(r,n),caller:i}};class S{*iterator(){let e=this.stackEnv.getCount()-1;for(let t=this.stackMap;void 0!==t;t=t.next)for(let r=t.numPushed-1;r>=0;r--){const i=t.labels[r],o=this.stackEnv.getValue(e--);if(void 0===i||void 0===o)continue;const a=o instanceof f?o.valueOrUndefined:o;void 0!==a&&(yield(0,n.stackValue)(i,a))}}constructor(e,t){this.stackEnv=e,this.stackMap=t}}t.ES5IterableStackValue=S,t.ES5IterableStackFrame=class{*iterator(){for(let e=this.leafFrame;void 0!==e;e=e.caller)yield e}constructor(e){this.leafFrame=e}},function(e){e[e.ReadFailure=0]="ReadFailure",e[e.ReadOper=1]="ReadOper",e[e.WroteFailure=2]="WroteFailure",e[e.WroteOper=3]="WroteOper"}(g||(t.CellEvaluationResultKind=g={}))},44789:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEvaluator=t.evalName=t.evalCellsAsync=t.evalCells=t.evalFormula=t.evaluationMachineContext=t.runtimeEvaluationContext=void 0;const n=r(23406),i=r(37616),o=r(88065),a=r(737),s=r(12569),l=r(89128),u=r(57263),c=r(54166),d=r(71916),m=r(70947),g=r(13845),p=r(91320),h=r(75235),f=r(1386),S=r(76964),v=r(76964),y=r(86965),F=r(78949);function C(e){return{globals:e,timer:(0,h.runtimeTimer)(),machineContext:R(e)}}function R(e){return{globals:e,resolver:(0,l.createResolver)(e),numberFormatter:(0,c.createNumberFormatter)(e),parser:(0,d.createParser)(e),printer:(0,s.createPrinter)(e),analyzer:(0,n.createAnalyzer)(e),createCellEvaluationMachine:m.createCellEvaluationMachine,createFormulaEvaluationMachine:g.createFormulaEvaluationMachine,createCallTermEvaluationMachine:g.createCallTermEvaluationMachine}}function b(e){if(Array.isArray(e)){const t=e[0];if(t.kind===a.ResultKind.Success){if((0,u.isRangeOper)(t.value)||(0,u.isMissingOper)(t.value)){const e=`calc.runtime.evalFormula: expected ReadOper; given ${(0,i.anonymize)(t)}`;return(0,o.assertFalse)(e)}return t}return t}return e.kind===a.ResultKind.Paused?(0,y.paused)((t=>b(e.resume(t)))):(0,y.breaked)((()=>b(e.resume())))}function E(e,t,r){var n;const i=C(e),o=(0,f.bottomEvalPrecedents)(),a=(0,g.createFormulaEvaluationMachine)(i.machineContext,t.stepConfig,(0,f.evalLocalsSlice)(t),o,F.emptyVisitedCells,F.emptyVisitedNames,v.readOperType,r),s=new h.EvaluationRuntime(i,[a]),l=(0,h.createSchedule)(null!==(n=t.schedulerConfig)&&void 0!==n?n:e.schedulerConfig);return b(s.evaluateSync(l))}function T(e,t,r){const n=C(e),i=[];for(let e=0;e<r.length;e+=1)i.push(new S.VoidMachine((0,m.createCellEvaluationMachine)(n.machineContext,t,F.emptyVisitedCells,r[e])));return new h.EvaluationRuntime(n,i)}function k(e,t,r){var n;if(0===r.length)return[];const i=T(e,t.stepConfig,r),o=(0,h.createSchedule)(null!==(n=t.schedulerConfig)&&void 0!==n?n:e.schedulerConfig);return i.evaluateSync(o)}function P(e,t,r){var n;if(0===r.length)return Promise.resolve([]);const i=T(e,void 0,r),o=(0,h.createSchedule)(null!==(n=t.schedulerConfig)&&void 0!==n?n:e.schedulerConfig);return i.evaluateAsync(o)}function N(e){return Array.isArray(e)?e[0]:e.kind===a.ResultKind.Paused?(0,y.paused)((t=>N(e.resume(t)))):(0,y.breaked)((()=>N(e.resume())))}function A(e,t,r,n){var i;const o=C(e),a=(0,p.createNameEvaluationMachine)(o.machineContext,t.stepConfig,r,n),s=new h.EvaluationRuntime(o,[a]),l=(0,h.createSchedule)(null!==(i=t.schedulerConfig)&&void 0!==i?i:e.schedulerConfig);return N(s.evaluateSync(l))}t.runtimeEvaluationContext=C,t.evaluationMachineContext=R,t.evalFormula=E,t.evalCells=k,t.evalCellsAsync=P,t.evalName=A,t.createEvaluator=function(e){return{evalFormula:(t,r)=>E(e,t,r),evalCells:(t,r)=>k(e,t,r),evalName:(t,r,n)=>A(e,t,r,n),evalCellsAsync:(t,r)=>P(e,t,r)}}},92843:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isRangeValues=t.rangeValues=t.DerefOperKind=t.machine=void 0;const n=r(19181).__importStar(r(76964));var i;t.machine=n,function(e){e.RangeValues="RangeValues"}(i||(t.DerefOperKind=i={})),t.rangeValues=function(e){return{kind:i.RangeValues,arrays:e}},t.isRangeValues=function(e){return e.kind===i.RangeValues}},76964:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.refToVal=t.ArrayMachine=t.earlyReturn=t.EarlyReturnKind=t.ThenMachine=t.isMachineCall=t.machineCall=t.MachineCallKind=t.readOperType=t.singleReadOperType=void 0;const n=r(19181),i=r(51286),o=r(27800),a=r(57263),s=r(737),l=r(72006);var u,c;function d(e){return e.kind===u.MachineCall}n.__exportStar(r(27800),t),t.singleReadOperType=l.OperKind.Number|l.OperKind.String|l.OperKind.Boolean|l.OperKind.Error|l.OperKind.Blank|l.OperKind.Rich,t.readOperType=t.singleReadOperType|l.OperKind.Array,function(e){e.MachineCall="MachineCall"}(u||(t.MachineCallKind=u={})),t.machineCall=function(e){return{kind:u.MachineCall,machine:e}},t.isMachineCall=d,t.ThenMachine=class{next(){var e;try{if(void 0===this.oper1){const e=this.f1();if(d(e))return(0,o.callMachineTransition)(e.machine,this);this.oper1=e}if(void 0===this.oper2){const e=this.f2(this.oper1);if(d(e))return(0,o.callMachineTransition)(e.machine,this);this.oper2=e}return(0,s.success)(this.oper2)}catch(t){return null!==(e=this.context.handleEvaluationError(t))&&void 0!==e?e:(0,s.failure)((0,s.javaScriptError)(t))}}receiveResult(e){return(0,s.isSuccess)(e)?(void 0===this.oper1?this.oper1=e.value:void 0===this.oper2&&(this.oper2=e.value),o.nextTransition):e}constructor(e,t,r){this.context=e,this.f1=t,this.f2=r,this.runStatus=!1,this.oper1=void 0,this.oper2=void 0}},function(e){e.EarlyReturn="EarlyReturn"}(c||(t.EarlyReturnKind=c={})),t.earlyReturn=function(e){return{kind:c.EarlyReturn,value:e}},t.ArrayMachine=class{next(){var e;try{if(void 0!==this.toDeref){const e=this.coercer(this.toDeref,this.opers.length,this.row.length);if(e.kind===c.EarlyReturn)return e.value;this.row.push(e),this.row.length===this.cols&&(this.opers.push(this.row),this.row=[]),this.toDeref=void 0}if(this.opers.length>=this.rows)return(0,s.success)((0,i.arrayOper)(this.rows,this.cols,this.opers));const e=this.func(this.opers.length,this.row.length);return d(e)?(0,o.callMachineTransition)(e.machine,this):(this.toDeref=e,o.nextTransition)}catch(t){return null!==(e=this.context.handleEvaluationError(t))&&void 0!==e?e:(0,s.failure)((0,s.javaScriptError)(t))}}receiveResult(e){return(0,s.isSuccess)(e)?(this.toDeref=e.value,o.nextTransition):e}constructor(e,t,r,n,i){this.context=e,this.rows=t,this.cols=r,this.func=n,this.coercer=i,this.runStatus=!1,this.toDeref=void 0,this.row=[],this.opers=[]}},t.refToVal=function(e,t,r){if(!(0,a.isRangeOper)(t))return t;if(!(0,a.isSheetIndex)(t.sheets))return i.valueErrorOper;if(!r)return 1===t.ranges.length&&(0,a.isGridCell)(t.ranges[0])?e.dereferenceOper(t,l.SignatureType.All&~l.OperKind.Range):e.dereferenceOper(t,l.OperKind.Array);const n=e.dereferenceOper(t,l.SignatureType.All&~(l.OperKind.Range|l.OperKind.Array));return(0,a.isArrayOper)(n)?i.naErrorOper:n}},81388:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyOperator=t.cmpNum=t.cmpStr=t.cmpBool=t.cmpInt=void 0;const n=r(37616),i=r(22501),o=r(72933),a=r(51286),s=r(88065),l=r(75929),u=r(72006),c=r(98224),d=r(57263),m=r(22501);function g(e,r,n){return(0,t.cmpInt)(e,r.value-n.value)}function p(e,r,n,i){return(0,t.cmpInt)(r,e.stringCompareCI(n.value,i.value))}function h(e,r,n,i){return(0,t.cmpInt)(r,e.compare(n,i))}function f(e,t,r){if((0,d.isSheetIndex)(t.sheets))if((0,d.isSheetIndex)(r.sheets))if((0,d.isDocumentLocEqual)(t.sheets.document,r.sheets.document)){if(t.sheets.index===r.sheets.index)return(0,c.sheetIndex)(t.sheets.document,t.sheets.index);{const o=`different sheet, range1 = ${(0,n.anonymize)(t)}, range2 = ${(0,n.anonymize)(r)}`;(0,i.traceErrorOper)(e,a.ErrorType.VALUE,o)}}else{const o=`different document, range1 = ${(0,n.anonymize)(t)}, range2 = ${(0,n.anonymize)(r)}`;(0,i.traceErrorOper)(e,a.ErrorType.VALUE,o)}else(0,i.traceErrorOper)(e,a.ErrorType.VALUE,`3D reference, range2 = ${(0,n.anonymize)(r)}`);else(0,i.traceErrorOper)(e,a.ErrorType.VALUE,`3D reference, range1 = ${(0,n.anonymize)(t)}`)}t.cmpInt=d.applyComparison,t.cmpBool=g,t.cmpStr=p,t.cmpNum=h,t.applyOperator=function(e,r,c,S=!1){const{mathpack:v}=e.config;if(1===c.length){const e=c[0];switch(r){case l.OperatorId.Percent:return v.percent(e);case l.OperatorId.Neg:return v.neg(e);case l.OperatorId.Pos:return e;default:{const e=`calc.runtime.applyOperator: bad application of ${r} to 1 argument`;return s.ulsLogger.ULS.assertTag(593372496,o.LogCategory.msoulscat_ES_EWAJS,!1,e)}}}if(2===c.length){const y=c[0],F=c[1];switch(r){case l.OperatorId.Add:{const e=v.add(y,F);return S&&(0,d.isNumberOper)(e)?v.checkAlmostCancellation(y,e):e}case l.OperatorId.Sub:{const e=v.sub(y,F);return S&&(0,d.isNumberOper)(e)?v.checkAlmostCancellation(y,e):e}case l.OperatorId.Mul:return v.mul(y,F);case l.OperatorId.Div:return v.div(y,F);case l.OperatorId.Pow:return v.power(y,F);case l.OperatorId.Concat:return(0,a.stringOper)((y.value+F.value).substring(0,a.cellStringLimit));case l.OperatorId.Eq:case l.OperatorId.Ne:case l.OperatorId.Lt:case l.OperatorId.Le:case l.OperatorId.Gt:case l.OperatorId.Ge:return(0,a.booleanOper)(function(e,r,n,i){const{localeInfo:o,mathpack:s}=e.config;if(n.kind!==i.kind){if((0,d.isBlankOper)(n))switch(i.kind){case u.OperKind.Number:return h(s,r,s.zero,i);case u.OperKind.String:return p(o,r,m.emptyStringOper,i);case u.OperKind.Boolean:return g(r,a.falseOper,i)}if((0,d.isBlankOper)(i))switch(n.kind){case u.OperKind.Number:return h(s,r,n,s.zero);case u.OperKind.String:return p(o,r,n,m.emptyStringOper);case u.OperKind.Boolean:return g(r,n,a.falseOper)}return(0,t.cmpInt)(r,n.kind-i.kind)}switch(n.kind){case u.OperKind.Number:return h(s,r,n,i);case u.OperKind.String:return p(o,r,n,i);case u.OperKind.Boolean:return g(r,n,i);case u.OperKind.Blank:return(0,t.cmpInt)(r,0);default:return!1}}(e,r,y,F));case l.OperatorId.Range:return function(e,t){const r=f("calc.runtime.applyRangeOp",e,t);if(null==r)return a.valueErrorOper;const n=(0,d.gridRangesJoin)(e.ranges),i=(0,d.gridRangesJoin)(t.ranges),o=[(0,d.gridRangeJoin)(n,i)];return(0,a.rangeSeqOper)(r,o)}(y,F);case l.OperatorId.Isect:return function(e,t){const r=f("calc.runtime.applyIsectOp",e,t);if(null==r)return a.valueErrorOper;const o=[];for(let r=0;r<e.ranges.length;r+=1)for(let n=0;n<t.ranges.length;n+=1){const i=(0,d.gridRangeIsect)(e.ranges[r],t.ranges[n]);null!=i&&o.push(i)}if(0===o.length){const r=`empty intersection, range1 = ${(0,n.anonymize)(e)}, range2 = ${(0,n.anonymize)(t)}`;return(0,i.traceErrorOper)("calc.runtime.applyIsectOp",a.ErrorType.NULL,r),a.nullErrorOper}return(0,a.rangeSeqOper)(r,o)}(y,F);case l.OperatorId.Union:return function(e,t){const r=f("calc.runtime.applyUnionOp",e,t);return null==r?a.valueErrorOper:(0,a.rangeSeqOper)(r,e.ranges.concat(t.ranges))}(y,F);case l.OperatorId.And:return(0,a.booleanOper)(y.value&&F.value);case l.OperatorId.Or:return(0,a.booleanOper)(y.value||F.value);case l.OperatorId.Xor:return(0,a.booleanOper)(y.value!==F.value);case l.OperatorId.Min:return v.cond2(y,F)<=0?y:F;case l.OperatorId.Max:return v.cond2(y,F)>=0?y:F;default:{const e=`calc.runtime.applyOperator: bad application of ${r} to 2 arguments`;return s.ulsLogger.ULS.assertTag(593372497,o.LogCategory.msoulscat_ES_EWAJS,!1,e)}}}const y=`calc.runtime.applyOperator: bad application of ${r} to ${c.length} arguments`;return s.ulsLogger.ULS.assertTag(593372498,o.LogCategory.msoulscat_ES_EWAJS,!1,y)}},75:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGridRangeTable=t.gridRangeDistance=void 0;const n=r(82220),i=r(69547),o=r(57263);function a(e,t){const{row:r,col:n,rows:o,cols:a}=e,{row:s,col:l,rows:u,cols:c}=t;return(0,i.fastAbs)(r-s+.5*(o-u))+(0,i.fastAbs)(n-l+.5*(a-c))}t.gridRangeDistance=a,t.makeGridRangeTable=function(){return n.RTree.create(o.gridRangeJoin,o.gridRangeIsects,o.gridRangeCompare,a)}},86965:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runtimePositionFirstOrderFunc=t.runtimePositionFormulaRoot=t.runtimePositionEtaLambdaBody=t.runtimePositionLambdaParam=t.runtimePositionLambdaRoot=t.runtimePositionLetVal=t.breaked=t.paused=t.limitExceeded=t.previousNameFailure=t.previousFailure=t.cellCycle=t.nameCycle=t.evalLocals=t.evalGlobals=t.userDefinedFunc=t.stopped=t.cellFormula=t.cellWellFormedFormula=t.pendingValue=t.finalValue=t.illFormedFormula=t.LimitKind=t.StepAction=t.RuntimePositionKind=t.stackValue=t.Interrupt=t.CellKind=t.interval=t.compileLocalsName=t.compileLocalsGrid=t.createCompileGlobals=t.ReasonKind=void 0;const n=r(88065),i=r(69547),o=r(57263),a=r(98224),s=r(24946),l=r(737),u=r(7311);var c,d,m,g,p,h;!function(e){e.Timeout="Timeout",e.Breakpoint="Breakpoint",e.Stopped="Stopped",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.PreviousNameFailure="PreviousNameFailure",e.LimitExceeded="LimitExceeded",e.IllFormedFormula="IllFormedFormula"}(c||(c={})),t.ReasonKind=Object.assign(Object.assign(Object.assign(Object.assign({},o.ReasonKind),c),s.FormatReasonKind),u.ResolveReasonKind),t.createCompileGlobals=function(e){return{config:e}},t.compileLocalsGrid=function(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:(0,l.success)(t),allowUnqualifiedCell:!0,emitStepInfo:!1}},t.compileLocalsName=function(e,t){return{config:null!=t?t:void 0,lexicalKind:a.LexicalKind.NameManager,originGridCell:(0,l.success)(e),allowUnqualifiedCell:!1,emitStepInfo:!1}},t.interval=(0,i.typedInstanceCreator)()(((e,t)=>((0,n.assertPositiveInteger)("calc.runtime.interval: end",t),(0,n.assertIndex)("calc.runtime.interval: start",e,t),{start:e,end:t}))),function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue"}(d||(t.CellKind=d={})),function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"}(m||(t.Interrupt=m={})),t.stackValue=(0,i.typedInstanceCreator)()(((e,t)=>({label:e,value:t}))),function(e){e.LetVar="LetVar",e.LambdaRoot="LambdaRoot",e.LambdaParam="LambdaParam",e.EtaLambdaBody="EtaLambdaBody",e.FormulaRoot="FormulaRoot",e.FirstOrderFunc="FirstOrderFunc"}(g||(t.RuntimePositionKind=g={})),function(e){e.Continue="Continue",e.Break="Break"}(p||(t.StepAction=p={})),function(e){e[e.CellChain=0]="CellChain",e[e.NameChain=1]="NameChain",e[e.LambdaCalls=2]="LambdaCalls",e[e.LambdaDepth=3]="LambdaDepth"}(h||(t.LimitKind=h={})),t.illFormedFormula=function(e,r,n){return{kind:t.ReasonKind.IllFormedFormula,message:e,mode:r,diagnostics:n}},t.finalValue=function(e){return{kind:d.FinalValue,oper:e}},t.pendingValue=function(e){return{kind:d.PendingValue,anchor:e}},t.cellWellFormedFormula=function(e,t){return{source:e,formula:t}},t.cellFormula=function(e,t){return{source:e,formula:t}},t.stopped={kind:t.ReasonKind.Stopped},t.userDefinedFunc=function(e,t){return{arity:e,func:t}},t.evalGlobals=function(e,t,r,n,i,a,s,u,c,d,g,p,h,f,S,v,y,F,C,R,b,E,T,k,P,N,A,I,O,_){return{config:e,getDocumentLoc:t,getSheetIndex:r,getSheetName:n,getSheetRangeIndexes:i,getNameLoc:a,getUserDefinedFuncLoc:s,getCellValue:u,getCellValues:c,getWorksheetFunc:d,getUserDefinedFunc:g,getNameFormula:p,getCellFormula:h,getUsedRange:f,interruptToken:[m.Continue],tryGetHiddenRows:S,tryGetHiddenCols:v,isInFilterMode:y,getKnownFormat:F,getIformat:C,getFormatString:R,getRandom:b,getTime:E,schedulerConfig:null!=O?O:{},limits:null!=_?_:{},setCellValue:T,setCellValues:k,setCellFailure:P,getContainingTable:N,getStructRefColumn:A,getStructRefSpecialRef:I,getIntersectingTables:()=>(0,l.failure)((0,o.notImplemented)(["getIntersectingTables"]))}},t.evalLocals=(0,i.typedInstanceCreator)()(((e,t,r,n,i,o,a,s,l,u,c)=>({lexicalSource:e,originGridCell:t,originSheet:r,calcingArray:n,reflectionGridCell:i,reflectionSheet:o,implicitIntersect:a,allowUnqualifiedCell:s,wrapCellReferences:l,followHyperlinks:u,contextNames:c}))),t.nameCycle=function(e){return{kind:t.ReasonKind.NameCycle,names:e}},t.cellCycle=function(e){return{kind:t.ReasonKind.CellCycle,cells:e}},t.previousFailure=function(e){return{kind:t.ReasonKind.PreviousFailure,range:e}},t.previousNameFailure=function(e){return{kind:t.ReasonKind.PreviousNameFailure,name:e}},t.limitExceeded=function(e){return{kind:t.ReasonKind.LimitExceeded,limit:e}},t.paused=function(e){return{kind:l.ResultKind.Paused,reason:t.ReasonKind.Timeout,resume:e}},t.breaked=function(e){return{kind:l.ResultKind.Breaked,resume:e}},t.runtimePositionLetVal=function(e,t){return{kind:g.LetVar,varNamePosition:e,varBinderPosition:t}},t.runtimePositionLambdaRoot=function(e,t,r){return{kind:g.LambdaRoot,lambdaNodePosition:e,head:t,args:r}},t.runtimePositionLambdaParam=function(e,t,r){return{kind:g.LambdaParam,idx:e,paramNodePosition:t,paramNamePosition:r}},t.runtimePositionEtaLambdaBody=function(e){return{kind:g.EtaLambdaBody,wsfId:e}},t.runtimePositionFormulaRoot={kind:g.FormulaRoot},t.runtimePositionFirstOrderFunc={kind:g.FirstOrderFunc}},46619:function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.transformBottomUp=t.isOperTerm=t.postStepTerm=t.callMachineTerm=t.callFirstOrderFuncTerm=t.callLambdaTerm=t.callNameTerm=t.noopTerm=t.conditionalTerm=t.readStackTerm=t.structRefTerm=t.cellRefTerm=t.udfTerm=t.nameTerm=t.appTerm=t.letTerm=t.lambdaTerm=t.arrayTerm=t.isOperatorName=t.worksheetFunctionNameToId=t.worksheetFunctionIdToName=t.operatorNameToId=t.operatorIdToName=t.TermKind=void 0;const o=r(69547),a=r(88065),s=r(55284);var l;function u(e,t){return{kind:e,data:void 0,children:void 0,position:t}}function c(e,t,r,n){const i=u(l.Array,n);return i.children=r,i.data={rows:e,cols:t},i}function d(e,t,r,n){(0,a.assertTrue)("calc.runtime.lambdaTerm: defsAndBody",r.length===1+t.reduce(((e,t)=>e+(t.hasDef?1:0)),0)),(0,a.assertTrue)("calc.runtime.lambdaTerm: params",t.every(((e,t,r)=>!(e.hasDef&&e.isRest||e.isRest&&t!==r.length-1))));const i=u(l.Lambda,n);return i.children=r,i.data={checkArity:e,params:t},i}function m(e,t,r,n,i){(0,a.assertTrue)("calc.runtime.letTerm",e.length===r.length);const o=u(l.Let,i);return o.children=[...e,n],o.data={rec:t,varLabels:r},o}!function(e){e[e.Array=-2147483648]="Array",e[e.Lambda=-2147483647]="Lambda",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483644]="Name",e[e.Udf=-2147483643]="Udf",e[e.CellRef=-2147483642]="CellRef",e[e.ReadStack=-2147483641]="ReadStack",e[e.Conditional=-2147483640]="Conditional",e[e.StructRef=-2147483639]="StructRef",e[e.Noop=-2147483638]="Noop",e[e.CallLambda=-2147483637]="CallLambda",e[e.CallName=-2147483636]="CallName",e[e.CallFirstOrderFunc=-2147483635]="CallFirstOrderFunc",e[e.CallMachine=-2147483634]="CallMachine",e[e.PostStep=-2147483633]="PostStep"}(l||(t.TermKind=l={})),n=(0,o.makeNewtypeIso)(o.identity,o.identity),t.operatorIdToName=n.wrap,t.operatorNameToId=n.unwrap,i=(0,o.makeNewtypeIso)((e=>-e),(e=>-e)),t.worksheetFunctionIdToName=i.wrap,t.worksheetFunctionNameToId=i.unwrap,t.isOperatorName=function(e){return e>0},t.arrayTerm=c,t.lambdaTerm=d,t.letTerm=m;const g=[];function p(e,t,r,n=g,i,o){const a=u(l.App,o);return a.children=i,a.data={funName:e,funType:t,isFormulaRoot:r,args:n},a}function h(e,t,r,n,i){const o=u(l.Name,i);return o.data={name:e,qualifier:t,source:r},o.children=n,o}function f(e,t,r,n){const i=u(l.Udf,n);return i.data={name:e,qualifier:t},i.children=r,i}function S(e,t,r,n,i,o){const a=u(l.Conditional,o);return a.children=[n,...i],a.data={funName:e,funType:t,isFormulaRoot:r,args:g},a}function v(e,t){const r=u(l.Noop,t);return r.children=e,r}function y(e){return e.kind>0}t.appTerm=p,t.nameTerm=h,t.udfTerm=f,t.cellRefTerm=function(e,t,r){const n=u(l.CellRef,r);return n.data={ref:e,qualifier:t},n},t.structRefTerm=function(e,t){const r=u(l.StructRef,t);return r.data=e,r},t.readStackTerm=function(e,t){const r=u(l.ReadStack,t);return r.data=e,r},t.conditionalTerm=S,t.noopTerm=v,t.callNameTerm=function(e,t,r){const n=u(l.CallName,r);return n.children=t,n.data={loc:e},n},t.callLambdaTerm=function(e,t,r,n,i){const o=u(l.CallLambda,void 0);return o.children=i,o.data={capturedLocals:e,capturedStackEnv:t,capturedStackMap:r,caller:n},o},t.callFirstOrderFuncTerm=function(e,t,r){const n=u(l.CallFirstOrderFunc,void 0);return n.children=r,n.data={source:e,caller:t},n},t.callMachineTerm=function(e,t){const r=u(l.CallMachine,t);return r.data={machine:e},r},t.postStepTerm=u(l.PostStep,void 0),t.isOperTerm=y,t.transformBottomUp=function(e,t){function r(e){if(y(e))return s.Pledge.resolve(e);switch(e.kind){case l.Let:return s.Pledge.all(e.children.map(n)).bind((t=>m(t.slice(0,t.length-1),e.data.rec,e.data.varLabels,t[t.length-1],e.position)));case l.App:return s.Pledge.all(e.children.map(n)).bind((t=>p(e.data.funName,e.data.funType,e.data.isFormulaRoot,e.data.args,t,e.position)));case l.Conditional:return s.Pledge.all(e.children.map(n)).bind((([t,...r])=>S(e.data.funName,e.data.funType,e.data.isFormulaRoot,t,r,e.position)));case l.Lambda:return s.Pledge.all(e.children.map(n)).bind((t=>d(e.data.checkArity,e.data.params,t,e.position)));case l.Array:return s.Pledge.all(e.children.map((e=>s.Pledge.all(e.map(n))))).bind((t=>c(e.data.rows,e.data.cols,t,e.position)));case l.Name:return(void 0===e.children?s.Pledge.resolve(void 0):n(e.children)).bind((t=>h(e.data.name,e.data.qualifier,e.data.source,t,e.position)));case l.Udf:return(void 0===e.children?s.Pledge.resolve(void 0):n(e.children)).bind((t=>f(e.data.name,e.data.qualifier,t,e.position)));case l.CellRef:case l.StructRef:case l.ReadStack:return s.Pledge.resolve(e);case l.Noop:return n(e.children).bind((t=>v(t,e.position)));default:return(0,a.assertNever)("calc.runtime.transformBottomUp",e)}}function n(e){return s.Pledge.resolve(e).bind(r).bind(t)}return s.Pledge.settleOrThrow(n(e))}},41488:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomCellEvaluationTest=t.randomTestSheetContents=t.randomTestCellContents=t.randomTestFormula=t.runCellEvaluationTest=t.runMockCellEvaluationTest=t.makeRandomizedTimer=t.abstractEvalCells=t.sheet=t.document=t.makeDirtyCellContents=t.makeFailedCellContents=t.makeFinalCellContents=t.TestCellState=t.SpecialContents=t.locationFormula=t.locationValue=t.parsed=t.compiled=t.makeTestContext=void 0;const n=r(88065),i=r(64250),o=r(77785),a=r(76125),s=r(86965),l=r(1386),u=r(75235),c=r(91101),d=r(16483),m=r(32402),g=r(98224),p=r(57263),h=r(13276),f=r(71916),S=r(72933),v=r(61582),y=r(95689),F=r(51286),C=r(75929),R=r(89128),b=r(76964),E=r(23406),T=r(78949),k=r(54166),P=r(737),N=r(65580),A=r(12569),I=r(79470),O=r(70947),_=r(13845),M=r(16824);function D(e,r,n,i,o=!1){const l=r.kind===g.LexicalKind.NameManager?(0,a.analyzeLocalsName)((0,g.sheetGridCell)(t.sheet,n)):(0,a.analyzeLocalsGrid)(r.kind,(0,g.sheetGridCell)(t.sheet,n)),u=e.analyzer.checkFormula(l,i);if((0,P.isSuccess)(u)&&(0,p.isWellFormed)(u.value)){const t=r.kind===g.LexicalKind.NameManager?(0,s.compileLocalsName)(n):(0,s.compileLocalsGrid)(r.kind,n),i=e.compiler.compileFormula(o?Object.assign(Object.assign({},t),{emitStepInfo:o}):t,u.value);if(i.kind===P.ResultKind.Success)return i.value;throw new Error(`unexpected result ${JSON.stringify(i)}`)}throw new Error(`not well formed formula ${JSON.stringify(u)}`)}var w,L;t.makeTestContext=function(e,t,r){const n=(0,I.createArrayLogger)();(0,v.initCalc)(n,null!=e?e:o.featureEnabledDummyCallback),(0,M.overrideTypedFeatureGates)(M.getTypedFeatureGate,{"Microsoft.Office.Excel.CalcEtaLambda":!0,"Microsoft.Office.Excel.EtaReducedLambdas":!0});const i=(0,S.calcConfig)(null!=t?t:(0,S.getEnglishLocaleInfo)(),void 0,r),a={config:i},s={config:i},l={config:i};return{logger:n,config:i,compileGlobals:s,parser:(0,f.createParser)(a),analyzer:(0,E.createAnalyzer)(l),compiler:(0,c.createCompiler)(s)}},t.compiled=D,t.parsed=function(e,t,r,i=y.RefStyle.A1,o=(t.kind!==g.LexicalKind.NameManager?(0,p.gridRangeAnchor)(t.range.range):(0,n.assertFalse)("must pass origin for LexicalSourceName")),a=!1,s){const l=e.parser.parseFormula((0,h.parseLocals)(t.kind,o,{refStyle:i},s),r);if(l.kind!==P.ResultKind.Success)throw new Error(`unexpected result ${JSON.stringify(l)}`);return D(e,t,o,l.value,a)},t.locationValue=function(e,t){return{cell:e,oper:t}},t.locationFormula=function(e,t){return{source:e,formula:(0,y.formula)(t,[],[],1)}},function(e){e.ValueMocked="ValueMocked",e.ValueUnavailable="ValueUnavailable",e.FormulaUnavailable="FormulaUnavailable",e.EvalNotImplemented="EvalNotImplemented",e.EvalJavaScriptError="EvalJavaScriptError"}(w||(t.SpecialContents=w={})),function(e){e.Dirty="Dirty",e.Final="Final",e.Failed="Failed"}(L||(t.TestCellState=L={}));const x=(()=>{const e=(0,l.bottomEvalPrecedents)();return e.bound=F.PrecsBound.Exact,e})();function K(e,t,r){return{oper:e,reason:t,state:r,precedents:x}}function U(e){return K(e,void 0,L.Final)}function B(e){return K(e,void 0,L.Dirty)}function G({row:e,col:t}){return`R${e+1}C${t+1}`}function W(e,t){return"number"==typeof t?(0,y.literalNode)(e.config.mathpack.fromNumber(t)):t===w.EvalNotImplemented?(0,y.appNode)((0,y.wsfNode)(C.WorksheetFuncId.RAND,"RAND"),[]):t===w.EvalJavaScriptError?(0,y.appNode)((0,y.wsfNode)(C.WorksheetFuncId.NOW,"NOW"),[]):Array.isArray(t)?(0,y.appNode)((0,y.wsfNode)(C.WorksheetFuncId.SUM,"SUM"),t.map(W.bind(void 0,e))):(0,y.cellRefNode)((0,y.cellRefSingle)((0,d.absPos)(t.row),(0,d.absPos)(t.col)))}function V(e,t,r){const i={};for(const r in t){const o=t[r];if(null==o)continue;const a=o[1];if("number"==typeof a){const t=U(e.config.mathpack.fromNumber(a));i[r]=t}else if(Array.isArray(a)||a===w.FormulaUnavailable||a===w.EvalNotImplemented||a===w.EvalJavaScriptError){const e=B(F.blankOper);i[r]=e}else a===w.ValueUnavailable||a===w.ValueMocked||(0,n.assertNever)("calc.runtime.abstractEvalCells, tc",a)}const o={},a=[];function l(r,c){if("number"==typeof c)return(0,P.success)(e.config.mathpack.fromNumber(c));if(c===w.EvalNotImplemented)return(0,P.failure)({kind:s.ReasonKind.NotImplemented});if(c===w.EvalJavaScriptError)return(0,P.failure)({kind:s.ReasonKind.JavaScriptError});const d=[];for(let t=0;t<c.length;t+=1){const n=c[t];if("object"!=typeof n||Array.isArray(n)){const t=l(r,n);if(!(0,P.isSuccess)(t))return t;d.push(e.config.mathpack.toNumber(t.value))}else d.push(n)}for(let e=0;e<d.length;e+=1){const r=d[e];if("number"==typeof r)continue;const n=G(r),l=t[n];if(null!=l&&l[1]===w.ValueUnavailable)return(0,P.failure)({kind:s.ReasonKind.Unavailable});const u=i[n];if(null!=u&&u.state===L.Failed)return(0,P.failure)({kind:s.ReasonKind.PreviousFailure});const c=o[n];if(void 0!==c){for(let e=a.findIndex((e=>e===c));-1!==e&&e<a.length;e+=1)a[e].cycle=!0;return(0,P.failure)({kind:s.ReasonKind.CellCycle})}}let m=0;for(let t=0;t<d.length;t+=1){const o=d[t];if("number"==typeof o){m+=o;continue}const a=u(o);if(void 0!==a)return(0,P.failure)({kind:a});const l=G(o),c=i[l];if(null!=c){if(c.state===L.Failed)return(0,P.failure)({kind:r.cycle?s.ReasonKind.CellCycle:s.ReasonKind.PreviousFailure});(0,n.assertTrue)("calc.runtime.testUtil: Final after abstractEvalCell",c.state===L.Final),m+=e.config.mathpack.toNumber(c.oper)}}return(0,P.success)(e.config.mathpack.fromNumber(m))}function u(e){const r=G(e),u=t[r];if(null==u)return;const c=u[1];if("number"==typeof c||c===w.ValueUnavailable)return;let d=i[r];if(null==d&&(d=U(F.blankOper),i[r]=d),d.state===L.Failed)return void(0,n.assertTrue)("calc.runtime.makeCellEvaluationTest",null!=d.reason);if(d.state===L.Final)return;const m={cycle:!1};(0,n.assertTrue)("calc.runtime.makeCellEvaluationTest.abstractEvalCell: undetected cycle",null==o[r]),o[r]=m,a.push(m);try{switch(c){case w.ValueMocked:return(0,n.assertFalse)("calc.runtime.makeCellEvaluationTest.abstractEvalCell: unexpected ValueMocked");case w.FormulaUnavailable:throw new Error("calc.runtime.makeCellEvaluationTest.abstractEvalCell: dummy Failure from getCellFormula")}const e=l(m,c);return(0,P.isSuccess)(e)?void function(e,t){if(e.state!==L.Dirty){const t=`expected dirty cellContent; given ${JSON.stringify(e)}`;(0,n.assertFalse)(`calc.runtime.makeCellEvaluationTest.setContentFinal: ${t}`)}e.oper=t,e.state=L.Final}(d,e.value):void function(e,t){if(e.state!==L.Dirty){const t=`expected dirty cellContent; given ${JSON.stringify(e)}`;(0,n.assertFalse)(`calc.runtime.makeCellEvaluationTest.setContentFailed: ${t}`)}e.reason=t,e.state=L.Failed}(d,e.reason.kind)}catch(e){return s.ReasonKind.JavaScriptError}finally{delete o[r],a.pop()}}return{evalResults:r.map((e=>{try{return u(e)}catch(e){return s.ReasonKind.JavaScriptError}})),sheetState:i}}function j(e){return"string"==typeof e?s.ReasonKind.PreviousFailure:e}function q(e){return null==e?e:Object.assign(Object.assign({},e),{reason:void 0})}function H(e,t){for(const r in e){const n=e[r];null!=n&&n.state===L.Dirty&&(delete e[r],delete t[r])}}function z(e,t){const r={};for(const n in e)r[n]=t(e[n]);return r}function $(e){const t=[];for(let r=0;r<e;r+=1)t.push(r);return t}function Q(e,t){return null==t?t:"number"==typeof t.row&&"number"==typeof t.col&&1===t.rows&&1===t.cols?`gridCell(${t.row}, ${t.col})`:128===t.kind&&1===Object.getOwnPropertyNames(t).length?"blankOper":t}function Y(e,r,o,a,c,d,h,S={}){const[v,N,I]=function(e,r){const o={},a={};function u(e){let t=o[e];return null==t&&(t=U(F.blankOper),o[e]=t),t}for(const i in r){const o=r[i];if(null==o)continue;const[s,l]=o;if("number"==typeof l)u(i).oper=e.config.mathpack.fromNumber(l);else if(Array.isArray(l)||l===w.EvalNotImplemented||l===w.EvalJavaScriptError){u(i).state=L.Dirty;const r=(0,y.formula)(W(e,l),[],[],2);a[i]=D(e,(0,g.lexicalSourceCell)((0,g.sheetGridCell)(t.sheet,s)),s,r)}else l===w.ValueMocked||l===w.FormulaUnavailable?u(i).state=L.Dirty:l===w.ValueUnavailable||(0,n.assertNever)("calc.runtime.makeCellEvaluationTest, tc",l)}function c(e,t){return(0,l.throwEvaluationError)((0,p.notImplemented)(["RAND"]))}function d(e,t){throw new Error("JavaScript error")}const h={config:e.config,getDocumentLoc:(e,r)=>(0,P.success)(t.document),getSheetIndex:(e,r)=>(0,P.success)(t.sheet.index),getSheetName:(e,t)=>(0,P.success)("Sheet1"),getSheetRangeIndexes:e=>(0,P.success)((0,g.sheetRangeIndexes)([t.sheet.index],0)),getNameLoc:(e,t)=>(0,P.failure)((0,p.unavailable)([`name at ${JSON.stringify((0,g.nameLoc)(e,t))}`])),getUserDefinedFuncLoc:(e,t)=>(0,P.success)([]),getCellValue:function(e){const t=G(e.range),n=r[t];if(null!=n&&n[1]===w.ValueUnavailable)return(0,P.failure)((0,p.unavailable)([`value at ${t}`]));const i=o[t];return null==i?(0,P.success)((0,s.finalValue)(F.blankOper)):i.state===L.Final?(0,P.success)((0,s.finalValue)(i.oper)):i.state===L.Failed?(0,P.failure)((0,s.previousFailure)(e)):(0,P.success)((0,s.pendingValue)(e))},getCellValues:function(e){const{sheet:t,range:{row:r,col:n,rows:o,cols:a}}=e;let l;const u=(0,i.jaggedArray)(o,a,((e,i)=>{const o=h.getCellValue((0,g.sheetGridCell)(t,(0,g.gridCell)(e+r,i+n)));return o.kind===P.ResultKind.Failure?(null==l&&(l=o),(0,s.finalValue)(F.blankOper)):o.value}));return null!=l?l:(0,P.success)(u)},getWorksheetFunc:function(e){if(e===C.WorksheetFuncId.SUM){const t=(0,m.getWorksheetFunc)(e);return null!=t?(0,P.success)(t):(0,P.failure)((0,p.notImplemented)(["SUM"]))}return(0,P.success)(e===C.WorksheetFuncId.RAND?c:d)},getUserDefinedFunc:()=>(0,P.failure)((0,p.unavailable)(["getUserDefinedFunc"])),getNameFormula:e=>(0,P.failure)((0,p.unavailable)([`name at ${JSON.stringify(e)}`])),getCellFormula:function(e){const t=G(e.range),n=r[t];if(null!=n&&n[1]===w.FormulaUnavailable)return(0,P.failure)((0,p.unavailable)([`formula at ${t}`]));const i=a[t];return null!=i?(0,P.success)((0,s.cellFormula)((0,g.lexicalSourceCell)(e),i)):(0,P.success)(void 0)},interruptToken:[s.Interrupt.Continue],tryGetHiddenRows:(e,t,r)=>(0,P.success)([]),tryGetHiddenCols:(e,t,r)=>(0,P.success)([]),isInFilterMode:e=>(0,P.success)(!1),getKnownFormat:()=>(0,P.failure)((0,p.notImplemented)(["getKnownFormat"])),getIformat:()=>(0,P.failure)((0,p.notImplemented)(["getIformat"])),getFormatString:()=>(0,P.failure)((0,p.notImplemented)(["getFormatString"])),getRandom:()=>(0,P.failure)((0,p.notImplemented)(["getRandom"])),getTime:()=>(0,P.failure)((0,p.notImplemented)(["getTime"])),schedulerConfig:{},limits:{},setCellValue:function(e,t){const r=G(e.range),i=o[r];if(null==i||i.state!==L.Dirty){const r=`expected dirty cell at ${JSON.stringify(e)} but have ${JSON.stringify(i)}; given ${JSON.stringify(t)}`;(0,n.assertFalse)(`calc.runtime.makeCellEvaluationTest.setCellValue: ${r}`)}i.oper=t,i.state=L.Final},setCellValues:(e,t)=>{throw new Error("unexpected call to setCellValues")},setCellFailure:function(e,t){if(!(0,p.isSheetGridCell)(e)){const t=`expected cell; given range ${JSON.stringify(e)}`;return(0,n.assertFalse)(`calc.runtime.makeCellEvaluationTest.setCellFailure: ${t}`)}const r=G(e.range),i=o[r];if(null==i||i.state!==L.Dirty){const r=`expected dirty cell at ${JSON.stringify(e)} but have ${JSON.stringify(i)}; given ${JSON.stringify(t)}`;(0,n.assertFalse)(`calc.runtime.makeCellEvaluationTest.setCellFailure: ${r}`)}i.reason=t.kind,i.state=L.Failed},getUsedRange:function(e){return(0,P.success)((0,g.sheetGridRange)(e,(0,g.gridRange)(0,0,g.sheetRows,g.sheetCols)))},getContainingTable:()=>(0,P.failure)((0,p.notImplemented)(["getContainingTable"])),getIntersectingTables:()=>(0,P.failure)((0,p.notImplemented)(["getIntersectingTables"])),getStructRefColumn:()=>(0,P.failure)((0,p.notImplemented)(["getStructRefColumn"])),getStructRefSpecialRef:()=>(0,P.failure)((0,p.notImplemented)(["getStructRefSpecialRef"]))};return[t.sheet,o,h]}(e,a);for(const e in S){const t=e;I[t]=S[t](I[t])}const O=[a,c,d,h],_=c.map((e=>(0,g.sheetGridCell)(v,e))),M=null!=h?h:$(c.length),x=[];for(let e=0;e<M.length;e+=1)x[M[e]]=e;const K={globals:I,resolver:(0,R.createResolver)(I),numberFormatter:(0,k.createNumberFormatter)(I),parser:(0,f.createParser)(I),printer:(0,A.createPrinter)(I),analyzer:(0,E.createAnalyzer)(I),createCellEvaluationMachine:r.createCellEvaluationMachine.bind(r),createFormulaEvaluationMachine:r.createFormulaEvaluationMachine.bind(r),createCallTermEvaluationMachine:r.createCallTermEvaluationMachine.bind(r)},B={globals:I,timer:o,machineContext:K},V=[];for(let e=0;e<M.length;e+=1){const t=_[M[e]];V.push(new b.VoidMachine(K.createCellEvaluationMachine(K,void 0,T.emptyVisitedCells,t)))}return new u.EvaluationRuntime(B,V).evaluateAsync((0,u.createSchedule)(B.globals.schedulerConfig)).then((e=>x.map((t=>{const r=e[t];return r.kind===P.ResultKind.Success?r.value:r.reason.kind})))).catch((e=>null!=e.reason?e.reason.stack:e.stack)).then((e=>{if(Array.isArray(e)){let t=e,r=N,{evalResults:n,sheetState:i}=d;null!=h&&(t=t.map(j),n=n.map(j),r=z(r,q),i=z(i,q),function(e,t){H(e,t),H(t,e)}(r,i));try{expect([O,t,r]).toEqual([O,n,i])}catch(e){throw console.warn("runMockCellEvaluationTest: test failure:",JSON.stringify({testData:O,testResults:t,testState:r},Q,2)),e}}else expect([O,e]).toEqual([O,void 0])}))}t.makeFinalCellContents=U,t.makeFailedCellContents=function(e,t){return K(e,t,L.Failed)},t.makeDirtyCellContents=B,t.document={path:void 0,name:"Book1"},t.sheet=(0,g.sheetIndex)(t.document,0),t.abstractEvalCells=V,t.makeRandomizedTimer=function(e=.5){return{doTimeout:t=>(0,N.randomFloat)()>e}},t.runMockCellEvaluationTest=Y,t.runCellEvaluationTest=function(e,t,r,n,i,o={}){return Y(e,{createCellEvaluationMachine:O.createCellEvaluationMachine,createFormulaEvaluationMachine:_.createFormulaEvaluationMachine,createCallTermEvaluationMachine:e=>{}},(0,u.runtimeTimer)(),t,r,n,i,o)};const J=3;function X(e,t,r=0){const n=(0,N.randomFloat)()*(r<J?1:.625);return n<.05?w.EvalJavaScriptError:n<.1?w.EvalNotImplemented:n<.55?1:[...new Array((0,N.randomIndex)(3)+1)].map((()=>(0,N.randomFloat)()<.5?(0,g.gridCell)((0,N.randomIndex)(e),(0,N.randomIndex)(t)):X(e,t,r+1)))}function Z(e,t){for(;;){const r=(0,N.randomFloat)();return r<.1?w.ValueUnavailable:r<.2?w.FormulaUnavailable:X(e,t)}}function ee(e,t){const r={};for(let n=0;n<e;n+=1)for(let i=0;i<t;i+=1)if((0,N.randomFloat)()<.5){const o=Z(e,t),a=(0,g.gridCell)(n,i);r[G(a)]=[a,o]}return r}t.randomTestFormula=X,t.randomTestCellContents=Z,t.randomTestSheetContents=ee,t.randomCellEvaluationTest=function(e,t,r){const n=ee(t,r);let i=[];for(const e in n){const t=n[e];null!=t&&(0,N.randomFloat)()<.75&&i.push(t[0])}return i=(0,N.randomShuffled)(i),[n,i,V(e,n,i),(0,N.randomFloat)()<.5?(0,N.randomShuffled)($(i.length)):void 0]}},22501:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayLift=t.makeStrict=t.gridRangeAnchorHash=t.broadcastWriteOper=t.isEmptyStringOper=t.emptyStringOper=t.traceErrorOper=t.writeOperType=t.singleWriteOperType=void 0;const n=r(64250),i=r(51286),o=r(57263),a=r(98224),s=r(69547),l=r(76964),u=r(72006),c=r(88065),d=r(72933);t.singleWriteOperType=u.OperKind.Number|u.OperKind.String|u.OperKind.Boolean|u.OperKind.Error|u.OperKind.Rich,t.writeOperType=t.singleWriteOperType|u.OperKind.Array,t.traceErrorOper=function(e,t,r){const n=`${e}: generated Excel error, type ${t}; ${r}`;c.ulsLogger.ULS.traceTag(596120270,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Verbose,n)},t.emptyStringOper=(0,i.stringOper)(""),t.isEmptyStringOper=function(e){return(0,o.isStringOper)(e)&&""===e.value},t.broadcastWriteOper=function(e,t,r){const a=(0,o.isArrayOper)(r)?(0,n.broadcastArray)(r.rows,r.cols,e,t,r.opers,i.naErrorOper):(0,n.constantArray)(e,t,r);return(0,i.arrayOper)(e,t,a)},t.gridRangeAnchorHash=function(e){return a.sheetCols*e.row+e.col},t.makeStrict=function(e){const t=e=>e&~(u.OperKind.Array|u.OperKind.Range);return(0,u.functionType)(e.minArgs,e.maxArgs,e.headTypes.map(t),e.restTypes.map(t),e.tailTypes.map(t),e.returnType,e.staticPrecs,e.flags)},t.arrayLift=function(e,t,r,a){let d=0,m=0;for(let e=0;e<a.length;e+=1){const r=a[e];(0,o.isArrayOper)(r)&&0==((0,o.getArgType)(t,e,a.length)&u.OperKind.Array)?(d=(0,s.fastMax)(d,r.rows),m=(0,s.fastMax)(m,r.cols)):(d=(0,s.fastMax)(d,1),m=(0,s.fastMax)(m,1))}const g=a.map(((r,a,s)=>function(e,t,r,o,a){switch(o.kind){case u.OperKind.Missing:case u.OperKind.Blank:return(0,n.constantArray2D)(t,r,e.zero);case u.OperKind.Array:return 0!=(a&u.OperKind.Array)?(0,n.constantArray2D)(t,r,o):(0,n.broadcastArray2D)(t,r,new n.StrictArray2D(o.rows,o.cols,o.opers),i.naErrorOper);case u.OperKind.Range:default:return(0,n.constantArray2D)(t,r,o)}}(e.mathpack,d,m,r,(0,o.getArgType)(t,a,s.length))));return(0,l.machineCall)(new l.ArrayMachine(e,d,m,((e,t)=>r(g.map((r=>r.get(e,t))))),(t=>{const r=e.coerceOper((0,l.refToVal)(e,t,!0),l.readOperType);return(0,c.assertTrue)("calc.runtime.arrayLift",!(0,o.isMissingOper)(r)&&!(0,o.isRangeOper)(r)),(0,o.isArrayOper)(r)?r.opers[0][0]:r})))}},91700:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LambdaOper=t.RecordOper=void 0;const n=r(51286),i=r(72006);t.RecordOper=class{getFallback(){return this._fallback}getField(e){return this._fields.getValue(e)}constructor(e,t=n.valueErrorOper){this._fields=e,this._fallback=t,this.kind=i.OperKind.Rich}},t.LambdaOper=class{getFallback(){return n.valueErrorOper}getField(e){}constructor(e,t,r,n,o,a,s){this.checkArity=e,this.lambdaNodeLabel=t,this.params=r,this.locals=n,this.stackEnv=o,this.stackMap=a,this.defsAndBody=s,this.kind=i.OperKind.Rich}}},78949:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recordNameCycle=t.appendVisitedName=t.emptyVisitedNames=t.recordCellCycle=t.appendVisitedCell=t.emptyVisitedCells=void 0;const n=r(49156),i=r(86965),o=r(88065);function a(e,t,r){return void 0===e?void 0===t?0:-1:void 0===t?1:r(e,t)}function s(e,t){return e<t?-1:e===t?0:1}function l(e,t){return"string"==typeof e?"string"!=typeof t?1:s(e,t):"string"==typeof t||e<t?-1:e===t?0:1}function u(e,t){let r;return 0!==(r=s(e.name,t.name))?r:a(e.path,t.path,s)}function c(e,t){return{current:e,map:t}}function d(e,t){return{current:e,map:t}}t.emptyVisitedCells=c(void 0,n.RedBlackMapTree.create((function(e,t){let r;return 0!=(r=e.range.col-t.range.col)||0!=(r=e.range.row-t.range.row)||0!==(r=l(e.sheet.index,t.sheet.index))?r:u(e.sheet.document,t.sheet.document)}))),t.appendVisitedCell=function(e,t){return(0,o.assertTrue)("calc.runtime.appendVisitedCell",t.previous===e.current),c(t,e.map.setValue(t.cell,t))},t.recordCellCycle=function(e,t){const r=[],n=(0,i.cellCycle)(r);for(let i=t;r.push(i.cell),i.cycle=n,i!==e;i=i.previous);return r.reverse(),n},t.emptyVisitedNames=d(void 0,n.RedBlackMapTree.create((function(e,t){let r;return 0!==(r=s(e.name,t.name))||0!==(r=a(e.scope.index,t.scope.index,l))?r:u(e.scope.document,t.scope.document)}))),t.appendVisitedName=function(e,t){const r={name:t,previous:e.current};return d(r,e.map.setValue(t,r))},t.recordNameCycle=function(e,t){const r=[];for(let n=t;r.push(n.name),n!==e;n=n.previous);return r.reverse(),(0,i.nameCycle)(r)}},79470:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createArrayLogger=void 0;const n=r(57777);t.createArrayLogger=n.arrayLogger.createArrayLogger},77785:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.featureEnabledDummyCallback=t.ConsoleLogger=t.AssertLogger=void 0;const n=r(57777);t.AssertLogger=n.testConfig.AssertLogger,t.ConsoleLogger=n.testConfig.ConsoleLogger,t.featureEnabledDummyCallback=n.testConfig.featureEnabledDummyCallback},89309:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAnalyzer=void 0;const n=r(70559),i=r(40167),o=r(86483);t.createAnalyzer=function(e){return{checkFormula:(t,r)=>(0,n.checkFormula)(e,t,r),checkFormulaWithDiagnostics:(t,r)=>(0,n.checkFormulaWithDiagnostics)(e,t,r),autocorrectFormula:(t,r)=>(0,i.autocorrectFormula)(e,t,r),resolveStaticPrecedents:(t,r)=>(0,o.resolveStaticPrecedents)(e,t,r)}}},40167:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocorrectFormula=void 0;const n=r(43162),i=r(41118),o=r(65556),a=r(33392),s=r(28694),l=r(20952),u=r(20493),c=r(1389),d=r(86241),m=r(21081),g=r(76457),p={getDocumentLoc:()=>(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getDocumentLoc"),getSheetIndex:()=>(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getSheetIndex"),getSheetName:()=>(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getSheetName"),getNameLoc:()=>(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getNameLoc"),getUserDefinedFuncLoc:()=>(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getUserDefinedFuncLoc"),getSheetRangeIndexes:()=>(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getSheetRangeIndexes"),getContainingTable:()=>(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getContainingTable"),getStructRefColumn:()=>(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getStructRefColumn"),getStructRefSpecialRef:()=>(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getStructRefSpecialRef")},h=(0,i.createFailureErrorClass)("AutocorrectError"),f=Object.assign(Object.assign({},(0,s.binaryVisitor)((0,s.constVisitor)(!1),((e,t)=>e||t))),{badSequenceNode:(e,t,r)=>!0,badCharsNode:(e,t,r)=>!0});class S extends s.IdentityVisitor{autocorrect(){return(0,s.reduceBottomUp)(f,this.f)?this.f.node:(0,s.reduceBottomUp)(this,this.f)}literalNode(e,t,r){return t||(this.seenUnclosed=!0),!this.locals.allowUnqualifiedCell&&e.kind===m.OperKind.Error&&e.type===g.ErrorType.REF&&this.qualifyCellRef()?(0,n.cellRefNode)((0,n.cellRefError)(),this.qualifyCellRef(),r):(0,n.literalNode)(e,t,r)}nameNode(e,t,r){const i=(0,n.nameNode)(e,t,r),s=(0,n.flattenNameParts)(e).parts,c=Object.assign(Object.assign({},this.locals),{allowUnqualifiedCell:!0}),{headResolved:d,fieldsResolved:m}=this.resolver.resolveDottedName(c,i,this.f.annotations);if((0,u.canDenoteCellRef)(c,t,s)){const[e,t,...r]=s;if(d.kind===l.ResolvedKind.ResolvedCellRef){const{ref:i,qualifier:a,label:l}=d.node,{ref:u,qualifier:c}=this.cellRefNode(i,a,l);(0,o.assertTrue)("calc.analyze.autocorrectFormula: resolved CellRefKind correct",i.kind===e.ref.kind),(0,o.assertTrue)("calc.analyze.autocorrectFormula: autocorrect doesn't change CellRefKind",u.kind===i.kind),(0,o.assertTrue)("calc.analyze.autocorrectFormula: autocorrect doesn't generate ErrorQualifier",(null==c?void 0:c.kind)!==n.QualifierKind.Error),(0,o.assertTrue)("calc.analyze.autocorrectFormula: all flattened field parts resolved",s.length===1+m.length);const g=(e,{rhs:t,canDenoteNamedObject:r,label:i,qualifiedLabel:o})=>(0,n.fieldRefNamePart)(e,t,r,i,o);return(0,n.nameNode)(r.reduce(g,g((0,n.cellRefNamePart)(u,e.asWhole,e.label,e.qualifiedLabel),t)),c,l)}this.throwIfResolutionUnknown(d.resolution)}if(this.locals.allowRelativeQualifier&&void 0===t){if(d.kind===l.ResolvedKind.ResolvedName&&(0,a.isSuccess)(d.resolution)&&d.resolution.value&&void 0!==d.resolution.value.scope.index)return(0,n.nameNode)(e,this.qualifySheetName(d.resolution.value.scope),r);this.throwIfResolutionUnknown(d.resolution)}if(t&&(t.kind===n.QualifierKind.Sheet||t.kind===n.QualifierKind.Ident)){if(d.kind===l.ResolvedKind.ResolvedName&&(0,a.isSuccess)(d.resolution)&&d.resolution.value&&void 0===d.resolution.value.scope.index&&d.qualifierResolution===n.QualifierKind.Sheet)return(0,n.nameNode)(e,this.qualifyBookName(d.resolution.value.scope),r);this.throwIfResolutionUnknown(d.resolution)}return i}arrayNode(e,t,r){return t||(this.seenUnclosed=!0),(0,n.arrayNode)(e,t,r)}appNode(e,t,r,o){const a=this.appNodeBase(e,r,o);return r||(this.seenUnclosed=!0),(0,i.isOperatorNode)(e)||(this.seenParen=!0),(0,i.isOperatorNode)(e)&&t.some(i.isMissingNode)&&(this.seenMissingOperand=!0),(0,n.appNode)(e,t,a,o)}letNode(e,t,r,i,o,a){const s=this.appNodeBase(e,o,a);return o||(this.seenUnclosed=!0),this.seenParen=!0,(0,n.letNode)(e,t,r,i,s,a)}lambdaNode(e,t,r,i,o,a){const s=this.appNodeBase(e,o,a);return o||(this.seenUnclosed=!0),this.seenParen=!0,(0,n.lambdaNode)(e,t,r,i,s,a)}parenNode(e,t,r){return t||(this.seenUnclosed=!0),this.seenParen=!0,(0,n.parenNode)(e,t,r)}cellRefNode(e,t,r){return e.isBracketed&&"("===this.localeInfo.rcLeftBracket&&(this.seenParen=!0),this.locals.allowUnqualifiedCell||void 0!==t?(0,n.cellRefNode)(e,t,r):(0,n.cellRefNode)(e,this.qualifyCellRef(),r)}fieldRefNode(e,t,r){return t.isClosed||(this.seenUnclosed=!0),(0,n.fieldRefNode)(e,t,r)}structRefNode(e,t,r){if(t.isClosed||(this.seenUnclosed=!0),void 0!==e&&e.qualifier){const{resolution:i,qualifierResolution:o}=this.resolver.resolveName(this.locals,e,c.NameSource.StructRef);if((0,a.isSuccess)(i)&&i.value&&o===n.QualifierKind.Sheet)return(0,n.structRefNode)((0,n.nameNode)(e.parts,void 0,e.label),t,r);this.throwIfResolutionUnknown(i)}return(0,n.structRefNode)(e,t,r)}qualifyCellRef(){const e=this.locals.originSheet;if(!(0,a.isSuccess)(e))throw new h(e.reason);if(void 0===e.value.index)return;const t=this.globals.getSheetName(e.value.document,e.value.index);if(!(0,a.isSuccess)(t))throw new h(t.reason);return(0,n.sheetQualifier)(t.value,void 0,(0,d.shouldQuoteQualifier)(this.localeInfo,this.refStyle,t.value))}qualifySheetName(e){const t=this.globals.getSheetName(e.document,e.index);if(!(0,a.isSuccess)(t))throw new h(t.reason);return(0,n.sheetQualifier)(t.value,void 0,(0,d.shouldQuoteQualifier)(this.localeInfo,this.refStyle,t.value))}qualifyBookName({document:e}){return(0,n.identQualifier)(e.name,(0,d.shouldQuoteQualifier)(this.localeInfo,this.refStyle,e.name))}appNodeBase(e,t,r){return t||!(0,i.isOperatorNode)(e)&&this.isFormulaRoot(r)&&!this.seenParen&&!this.seenUnclosed&&!this.seenMissingOperand}isFormulaRoot(e){var t;return(null===(t=this.f.annotations[e])||void 0===t?void 0:t.kind)===n.AnnotationKind.FormulaRoot}throwIfResolutionUnknown(e){if(!(0,a.isSuccess)(e)&&e.reason.kind!==l.ResolveReasonKind.NoOriginSheet&&e.reason.kind!==l.ResolveReasonKind.InvalidQualifier&&e.reason.kind!==l.ResolveReasonKind.InvalidCellRef&&e.reason.kind!==l.ResolveReasonKind.InvalidStructRef&&e.reason.kind!==l.ResolveReasonKind.EmptyIntersection)throw new h(e.reason)}constructor(e,t,r){var n,i,o,a;super(),this.f=r,this.seenUnclosed=!1,this.seenParen=!1,this.seenMissingOperand=!1;const s=function(e){var t,r,n,i,o,a,s,l,u,c,d,m,g,h,f,S,v,y;return{config:e.config,getDocumentLoc:null!==(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:p.getDocumentLoc,getSheetIndex:null!==(i=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e))&&void 0!==i?i:p.getSheetIndex,getSheetName:null!==(a=null===(o=e.getSheetName)||void 0===o?void 0:o.bind(e))&&void 0!==a?a:p.getSheetName,getNameLoc:null!==(l=null===(s=e.getNameLoc)||void 0===s?void 0:s.bind(e))&&void 0!==l?l:p.getNameLoc,getUserDefinedFuncLoc:null!==(c=null===(u=e.getUserDefinedFuncLoc)||void 0===u?void 0:u.bind(e))&&void 0!==c?c:p.getUserDefinedFuncLoc,getSheetRangeIndexes:null!==(m=null===(d=e.getSheetRangeIndexes)||void 0===d?void 0:d.bind(e))&&void 0!==m?m:p.getSheetRangeIndexes,getContainingTable:null!==(h=null===(g=e.getContainingTable)||void 0===g?void 0:g.bind(e))&&void 0!==h?h:p.getContainingTable,getStructRefColumn:null!==(S=null===(f=e.getStructRefColumn)||void 0===f?void 0:f.bind(e))&&void 0!==S?S:p.getStructRefColumn,getStructRefSpecialRef:null!==(y=null===(v=e.getStructRefSpecialRef)||void 0===v?void 0:v.bind(e))&&void 0!==y?y:p.getStructRefSpecialRef}}(e);this.globals=s,this.locals=t,this.resolver=(0,u.createResolver)(s),this.localeInfo=null!==(i=null===(n=t.config)||void 0===n?void 0:n.localeInfo)&&void 0!==i?i:e.config.localeInfo,this.refStyle=null!==(a=null===(o=t.config)||void 0===o?void 0:o.refStyle)&&void 0!==a?a:e.config.refStyle}}t.autocorrectFormula=function(e,t,r){try{const{spans:i,annotations:o,depthUpperBound:s}=r,l=new S(e,t,r).autocorrect();return(0,a.success)((0,n.formula)(l,i,o,s))}catch(e){return e instanceof h?(0,a.failure)(e.reason):(0,a.failure)((0,a.javaScriptError)(e))}}},70559:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkFormula=t.checkFormulaWithDiagnostics=void 0;const n=r(65556),i=r(1910),o=r(42096),a=r(6013),s=r(41118),l=r(21081),u=r(43162),c=r(76457),d=r(64842),m=r(33392),g=r(1389),p=r(93905),h=r(20493),f=r(82993),S={};function v(e,t){return{context:e,result:t}}const y=l.OperKind.String|l.OperKind.Boolean|l.OperKind.Error,F=(C=e=>0!=(e.kind&y),e=>e.kind===u.NodeKind.Literal&&C(e.oper));var C;function R(e,t,r,n=!1){n||(e.errorData=e.reportError(t,r,e.errorData))}function b(e,t){return t!==l.OperKind.Range||0!=(e&l.OperKind.Range)}function E(e,t){if(t.kind===u.NodeKind.Literal)switch(R(e,t,o.baseErrors.Unclosed_literal,t.isClosed),t.oper.kind){case l.OperKind.Number:case l.OperKind.Boolean:case l.OperKind.String:case l.OperKind.Error:return;case l.OperKind.Missing:break;default:return(0,n.assertNever)("calc.analyze.checker.checkArrayElement: literal kind",t.oper)}R(e,t,o.baseErrors.Illegal_array_literal_element)}function T(e,t,r,i,a){return p.Pledge.try((()=>{if(e.earlyExit&&!e.isOk())throw S;return A(e,t,a)})).bind((a=>(b(a.result,r)||((0,n.assertTrue)("calc.analyze.checker.check: typeSource passed",void 0!==i),R(e,t,{kind:o.TypeError.Types_not_related,typeGiven:a.result,typeExpected:r,typeSource:i})),a.result=r,a)))}function k(e,t,r){if(r.kind===u.NodeKind.Ident){const n=(0,s.getBoundName)(e.localeInfo,r.whole);return R(e,r,o.baseErrors.Invalid_binder,n.indexOf(".")<0),R(e,r,o.baseErrors.Duplicate_binder,!t.contains(n)),t.setValue(n,!0)}return R(e,r,r.kind===u.NodeKind.Missing?o.baseErrors.Missing_binder:o.baseErrors.Invalid_binder),t}const P=e=>0===e.args.length?e:e.args[e.args.length-1];function N(e,t){return p.Pledge.try((()=>(R(e,t,o.baseErrors.Unclosed_application,t.isClosed),(0,s.isWSFNode)(t.head)?function(e,t){return p.Pledge.try((()=>{const r=t.head.id,c=(0,d.getWorksheetFuncType)(r),{minArgs:m,maxArgs:h,headTypes:S,restTypes:y,tailTypes:F,flags:C}=c,b=t.args,E=b.length,N=(0,s.getArguments)(t.args).length;if(R(e,t.head,o.baseErrors.Invalid_function_name,0==(C&l.FunctionFlags.OnlyParsedDuringLoad)||e.locals.workbookLoad),(0,f.isTypedChangeGateEnabled)("Microsoft.Office.Excel.CalcTsInvalidChartMacro")&&R(e,t.head,o.baseErrors.Invalid_function_name,0==(C&l.FunctionFlags.Chart)&&(0==(C&l.FunctionFlags.Macro)||e.locals.lexicalKind===g.LexicalKind.NameManager)),N<m)switch(r){case d.WorksheetFuncId.IF:case d.WorksheetFuncId.LET:case d.WorksheetFuncId.LETREC:case d.WorksheetFuncId.LAMBDA:break;default:const n=b[E-1];R(e,void 0===n?t:n,{kind:o.TypeError.Insufficient_function_arguments,funcId:r,numArgsGiven:N,numArgsExpected:m})}if(N>h){const n=b[E-1];R(e,void 0===n?t:n,{kind:o.TypeError.Excess_function_arguments,funcId:r,numArgsGiven:N,numArgsExpected:h})}else if(y.length>1&&N>S.length+y.length){const n=(N-S.length)%y.length;n>F.length&&R(e,P(t),{kind:o.TypeError.Insufficient_function_arguments,funcId:r,numArgsGiven:N,numArgsExpected:N+(y.length-n)})}let I;if(t.kind===u.NodeKind.App)I=(0,s.getArguments)(t.args).map(((t,n)=>T(e,t,(0,s.getArgType)(c,n,N),{kind:o.TypeSourceKind.WSFArgument,funcId:r,argIndex:n,numArgsGiven:N})));else if(t.kind===u.NodeKind.Let)I=[...t.vars.map((({binder:e})=>e.arg)),...t.body?[t.body.arg]:[]].map((t=>A(e,t)));else{const r=t.params.map((({name:e})=>{var t;return null===(t=e.arg.def)||void 0===t?void 0:t.rhs})).filter(i.isDefined),n=t.body?[t.body.arg]:[];I=[...r.map((t=>A(e,t,o.baseErrors.Missing_default_expression))),...n.map((t=>A(e,t)))]}return p.Pledge.all(I).bind((r=>(function(e,t){const r=t.head.id,l=(0,s.getArguments)(t.args).length;switch(r){case d.WorksheetFuncId.IF:const c=e.locals.lexicalKind===g.LexicalKind.NameManager?1:2;return void(l<c&&R(e,P(t),{kind:o.TypeError.Insufficient_function_arguments,funcId:r,numArgsGiven:l,numArgsExpected:c}));case d.WorksheetFuncId._UDF:return R(e,t,o.baseErrors.Unexpected_application_head);case d.WorksheetFuncId.LET:case d.WorksheetFuncId.LETREC:{(0,n.assertTrue)("calc.analyze.applySpecificWorksheetFunctionChecks",t.kind===u.NodeKind.Let);let s=a.RedBlackMapTree.create(e.localeInfo.stringCompareCI);for(const{name:r}of t.vars)s=k(e,s,r.arg.name);for(const r of t.badArgs)R(e,r.arg,o.baseErrors.Invalid_binder);R(e,P(t),{kind:o.TypeError.Insufficient_function_arguments,funcId:r,numArgsGiven:l,numArgsExpected:(0,i.fastMax)(3,l+1+l%2)},l>=3&&void 0!==t.body);break}case d.WorksheetFuncId.LAMBDA:{(0,n.assertTrue)("calc.analyze.applySpecificWorksheetFunctionChecks",t.kind===u.NodeKind.Lambda);let i=a.RedBlackMapTree.create(e.localeInfo.stringCompareCI),c=!1;for(const{name:r}of t.params)R(e,r.arg.name,o.baseErrors.Unclosed_bracket,r.arg.name.isClosed),void 0!==r.arg.def&&R(e,r.arg.name,o.baseErrors.Binder_requires_brackets,r.arg.name.isBracketed),r.arg.isOptional?c=!0:R(e,r.arg,o.baseErrors.Mandatory_binder_after_optional,!c),i=k(e,i,r.arg.name.name);for(const r of t.badArgs)R(e,r.arg,o.baseErrors.Invalid_binder);l>=1&&void 0!==t.body?void 0!==t.body&&(0,s.isMissingLiteralNode)(t.body.arg)&&R(e,t.body.arg,o.baseErrors.Invalid_body):R(e,P(t),{kind:o.TypeError.Insufficient_function_arguments,funcId:r,numArgsGiven:l,numArgsExpected:l+1});break}}}(e,t),v(e,c.returnType))))}))}(e,t):(0,s.isOperatorNode)(t.head)?function(e,t){return p.Pledge.try((()=>{const{head:r,args:n}=t,i=r.id,a=(0,d.getOperatorType)(i),u=n.length,c=u===a.minArgs;return R(e,r,{kind:o.TypeError.Incorrect_number_of_operator_arguments,opId:i},c),p.Pledge.all(n.map(((t,r)=>p.Pledge.try((()=>T(e,t,(0,s.getArgType)(a,r,u),{kind:o.TypeSourceKind.OperatorArgument,opId:i,argIndex:r,numArgsGiven:u},{kind:o.SyntaxError.Missing_operation_argument,opId:i})))))).bind((t=>c&&!n.some(s.isMissingNode)?v(e,a.returnType):v(e,l.SignatureType.All)))}))}(e,t):function(e,t){return p.Pledge.try((()=>{const r=t.head,n=t.args,i=n.length,a=(0,s.getArguments)(n).length,c=n[i-1],m=(0,d.higherOrderFunctionType)().maxArgs-1;return a>m&&R(e,void 0===c?t:c,{kind:o.SyntaxError.Excess_higher_order_function_arguments,numArgsGiven:a,numArgsExpected:m}),p.Pledge.all(n.map((t=>T(e,t,l.SignatureType.All,void 0)))).bind((t=>A(e,r).bind((t=>(b(t.result,l.OperKind.Range)||0!=(t.result&(l.OperKind.Array|l.OperKind.Rich))||R(e,r,F(r)||r.kind===u.NodeKind.Array?o.baseErrors.Unexpected_application_head:o.baseErrors.Unexpected_application_head_with_fix),v(e,l.SignatureType.All))))))}))}(e,t))))}function A(e,t,r,i=!1){return p.Pledge.try((()=>{var a,d,m,g;if(e.earlyExit&&!e.isOk())throw S;switch(t.kind){case u.NodeKind.App:case u.NodeKind.Let:case u.NodeKind.Lambda:return N(e,t);case u.NodeKind.Array:return function(e,t){return p.Pledge.try((()=>{R(e,t,o.baseErrors.Unclosed_array,t.isClosed);const r=t.nodes.length>0&&!(1===t.nodes.length&&1===t.nodes[0].length&&(0,s.isMissingNode)(t.nodes[0][0]));if(R(e,t,o.baseErrors.Empty_array_literal,r),!r)return v(e,l.OperKind.Array);const n=t.nodes[0].length;for(let r=0;r<t.nodes.length;r+=1){const i=t.nodes[r],a=i.length;R(e,t,o.baseErrors.Irregular_array_shape,a===n);for(let t=0;t<a;t+=1)E(e,i[t])}return v(e,l.OperKind.Array)}))}(e,t);case u.NodeKind.BadChars:case u.NodeKind.BadSequence:return function(e,t){return p.Pledge.try((()=>{var r;if(t.kind===u.NodeKind.BadSequence){switch(t.type){case u.BadType.Unexpected:R(e,t,o.baseErrors.Bad_node,t.contents.some((e=>e.kind===u.NodeKind.BadChars||e.kind===u.NodeKind.BadSequence)));break;case u.BadType.StructRef:R(e,null!==(r=t.contents[0])&&void 0!==r?r:t,o.baseErrors.Invalid_struct_ref_table_name);break;case u.BadType.FieldRef:return void R(e,t,o.baseErrors.Unexpected_field_ref)}return p.Pledge.all(t.contents.map((t=>A(e,t))))}switch(t.type){case u.BadType.Unexpected:switch(t.chars){case")":return R(e,t,o.baseErrors.Unexpected_closing_paren);case e.localeInfo.rightBrace:return R(e,t,o.baseErrors.Unexpected_closing_brace);case e.localeInfo.rightBracket:return R(e,t,o.baseErrors.Unexpected_closing_bracket);case".":return R(e,t,o.baseErrors.Unexpected_dot);default:return R(e,t,{kind:o.SyntaxError.Unexpected_character,text:t.chars})}case u.BadType.NumberLiteral:return R(e,t,o.baseErrors.Invalid_number_literal);case u.BadType.StringLiteral:return R(e,t,o.baseErrors.Invalid_string_literal);case u.BadType.ErrorLiteral:return R(e,t,o.baseErrors.Invalid_error_literal);case u.BadType.FieldName:case u.BadType.ParamName:return R(e,t,o.baseErrors.Bad_node);case u.BadType.Qualifier:return R(e,t,o.baseErrors.Invalid_qualifier);default:(0,n.assertNever)("calc.analyze.diagnoseBadNode",t)}}))}(e,t).bind((()=>v(e,l.SignatureType.All)));case u.NodeKind.Missing:return!1!==r&&R(e,t,null!=r?r:o.baseErrors.Bad_node),v(e,l.SignatureType.All);case u.NodeKind.CellRef:return e.locals.allowRelativeQualifier||(null===(a=t.qualifier)||void 0===a?void 0:a.kind)!==u.QualifierKind.Relative?e.locals.allowUnqualifiedCell||void 0!==t.qualifier?(null===(d=t.qualifier)||void 0===d?void 0:d.kind)===u.QualifierKind.Document||(null===(m=t.qualifier)||void 0===m?void 0:m.kind)===u.QualifierKind.Bad?(R(e,t,o.baseErrors.Invalid_qualifier),v(e,l.SignatureType.All)):t.ref.kind===u.CellRefKind.Bad?(R(e,t,o.baseErrors.Invalid_cell_ref),v(e,l.SignatureType.All)):v(e,l.OperKind.Range):(R(e,t,o.baseErrors.Invalid_unqualified_cell),v(e,l.SignatureType.All)):(R(e,t,o.baseErrors.Invalid_rel_sheet_qualifier_in_cell),v(e,l.SignatureType.All));case u.NodeKind.Literal:return R(e,t,o.baseErrors.Unclosed_literal,t.isClosed),(0,s.isErrorOper)(t.oper)&&R(e,t,o.baseErrors.Invalid_error_literal,!((g=t.oper.type)>c.ErrorType.GETTING_DATA&&g!==c.ErrorType.BUSY&&g!==c.ErrorType.EXTERNAL)),v(e,t.oper.kind|((0,s.isErrorOper)(t.oper)&&t.oper.type===c.ErrorType.REF?l.OperKind.Range:0));case u.NodeKind.Name:{const{qualifier:r}=t;if((i||!e.locals.allowRelativeQualifier)&&(null==r?void 0:r.kind)===u.QualifierKind.Relative)return R(e,t,o.baseErrors.Invalid_rel_sheet_qualifier_in_name),v(e,l.SignatureType.All);if(!e.locals.workbookLoad&&(null==r?void 0:r.kind)===u.QualifierKind.Document&&!r.isQuoted)return R(e,t,o.baseErrors.Invalid_qualifier),v(e,l.SignatureType.All);if((null==r?void 0:r.kind)===u.QualifierKind.SheetRange||(null==r?void 0:r.kind)===u.QualifierKind.Bad)return R(e,t,o.baseErrors.Invalid_qualifier),v(e,l.SignatureType.All);const n=(0,u.flattenNameParts)(t.parts).parts,a=e.annotations[n[0].label],s=e.annotations[t.label],c=(null==s?void 0:s.kind)===u.AnnotationKind.AppHeadName;return(null==a?void 0:a.kind)===u.AnnotationKind.LocalNameUse?R(e,t,o.baseErrors.Invalid_name,(0,h.canDenoteLocalName)(r,n)):R(e,t,i?o.baseErrors.Invalid_struct_ref_table_name:o.baseErrors.Invalid_name,t.parts.canDenoteNamedObject||(0,h.canDenoteUserDefinedFunc)(c,r,t.parts)||(0,h.canDenoteCellRef)(e.locals,r,n)),v(e,l.SignatureType.All)}case u.NodeKind.Paren:return R(e,t,o.baseErrors.Unclosed_paren,t.isClosed),R(e,t,o.baseErrors.Empty_parenthesis,!(0,s.isMissingNode)(t.node)),A(e,t.node,!1);case u.NodeKind.FieldRef:return R(e,t,o.baseErrors.Unclosed_bracket,t.rhs.isClosed),R(e,t,o.baseErrors.Unexpected_field_ref,!(0,s.isMissingNode)(t.lhs)&&!(0,s.isNumberLiteralNode)(t.lhs)),t.rhs.field.kind!==u.NodeKind.Ident&&R(e,t.rhs.field,t.rhs.field.kind===u.NodeKind.Missing?o.baseErrors.Missing_field_name:o.baseErrors.Invalid_field_name),A(e,t.lhs,!1).bind((t=>v(e,l.SignatureType.All)));case u.NodeKind.StructRef:if(R(e,t,o.baseErrors.Missing_struct_ref_table_name,void 0!==t.lhs||e.locals.allowImplicitTable),void 0===t.rhs.innerRef);else{const r=t=>{switch(null==t?void 0:t.kind){case void 0:break;case u.StructRefKind.RangeOpRef:r(t.lhs),r(t.rhs);break;case u.StructRefKind.CommaOpRef:R(e,t,o.baseErrors.Invalid_struct_ref_comma_parts,(0,s.isCommaOpRefWellFormed)(t)),t.refs.forEach(r);break;case u.StructRefKind.SpecialRef:case u.StructRefKind.ColumnRef:R(e,t,o.baseErrors.Unclosed_bracket,t.isClosed);break;case u.StructRefKind.ThisRowOpRef:r(t.ref);break;case u.StructRefKind.MissingRef:R(e,t,o.baseErrors.Invalid_struct_ref_missing_part);break;case u.StructRefKind.BadRef:R(e,t,o.baseErrors.Unclosed_bracket,t.isClosed),R(e,t,o.baseErrors.Invalid_struct_ref_bad_part)}};r(t.rhs.innerRef)}return R(e,t,o.baseErrors.Unclosed_bracket,t.rhs.isClosed),(void 0===t.lhs?p.Pledge.resolve(void 0):A(e,t.lhs,void 0,!0)).bind((t=>v(e,l.SignatureType.All)));default:return(0,n.assertNever)("calc.analyze.checker.infer: unhandled formula case",t)}}))}const I={ok:!0,isOk:i.identity,collect:(e,t,r)=>!1};function O(e,t,{annotations:r},n,i=!0){var o,a;const s={globals:e,locals:t,localeInfo:null!==(a=null===(o=t.config)||void 0===o?void 0:o.localeInfo)&&void 0!==a?a:e.config.localeInfo,annotations:r,reportError:n.collect,isOk:()=>n.isOk(s.errorData),earlyExit:i,errorData:n.ok};return s}function _(e,t){try{const r=p.Pledge.settleOrThrow(T(e,t.node,l.SignatureType.All,void 0,o.baseErrors.Empty_formula));return function(e,t){const r=t.annotations[t.node.label];function a(t){for(const r of t)R(e,r,o.baseErrors.Unclosed_comment,r.isClosed)}function s(e){const r=t.spans[e];null!=r&&(r.preComments&&a(r.preComments),r.postComments&&a(r.postComments))}(null==r?void 0:r.kind)===u.AnnotationKind.FormulaRoot&&void 0!==r.syntaxFeatures&&r.syntaxFeatures[u.SyntaxFeature.Comments]&&p.Pledge.settleOrThrow(function e(t){return p.Pledge.try((()=>{switch(s(t.label),t.kind){case u.NodeKind.Literal:case u.NodeKind.Missing:case u.NodeKind.BadChars:break;case u.NodeKind.App:case u.NodeKind.Let:case u.NodeKind.Lambda:return t.head.kind===u.NodeKind.Operator&&s(t.head.label),p.Pledge.all(t.args.map(e));case u.NodeKind.Array:return p.Pledge.all((0,i.safeConcat)([],t.nodes.map((t=>t.map(e)))));case u.NodeKind.BadSequence:return p.Pledge.all(t.contents.map(e));case u.NodeKind.CellRef:case u.NodeKind.Name:t.qualifier&&s(t.qualifier.label);break;case u.NodeKind.Paren:return e(t.node);case u.NodeKind.FieldRef:return s(t.rhs.label),s(t.rhs.field.label),e(t.lhs);case u.NodeKind.StructRef:return t.lhs?e(t.lhs):void 0;case u.NodeKind.Var:s(t.name.label);break;case u.NodeKind.Param:if(s(t.name.label),s(t.name.name.label),t.def)return s(t.def.label),e(t.def.rhs);break;default:return(0,n.assertNever)("calc.analyze.checker.comments",t)}}))}(t.node))}(e,t),r}catch(t){if(t===S)return v(e,l.SignatureType.All);throw t}}t.checkFormulaWithDiagnostics=function(e,t,r){try{const n=_(O(e,t,r,{ok:void 0,isOk:e=>void 0===e,collect:(e,t,r)=>{var n;const i=null!=r?r:[];return(null!==(n=i[e.label])&&void 0!==n?n:i[e.label]=[]).push(t),i}},!1),r).context.errorData;return(0,m.success)([Object.assign(Object.assign({},r),{isWellFormed:void 0===n}),n])}catch(e){return(0,m.failure)((0,m.javaScriptError)(e))}},t.checkFormula=function(e,t,r){try{const n=_(O(e,t,r,I),r).context.errorData;return(0,m.success)(Object.assign(Object.assign({},r),{isWellFormed:n}))}catch(e){return(0,m.failure)((0,m.javaScriptError)(e))}}},42096:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertDiagnosticToNLMessage=t.baseNLErrors=t.formatDiagnostic=t.baseErrors=t.TypeSourceKind=t.TypeError=t.SyntaxError=void 0;const n=r(61920),i=r(54741);var o,a,s;!function(e){e.Unclosed_application="Unclosed_application",e.Unclosed_paren="Unclosed_paren",e.Unclosed_bracket="Unclosed_bracket",e.Unclosed_array="Unclosed_array",e.Unclosed_literal="Unclosed_literal",e.Unclosed_comment="Unclosed_comment",e.Invalid_number_literal="Invalid_number_literal",e.Invalid_string_literal="Invalid_string_literal",e.Invalid_error_literal="Invalid_error_literal",e.Invalid_function_name="Invalid_function_name",e.Invalid_name="Invalid_name",e.Illegal_array_literal_element="Illegal_array_literal_element",e.Empty_array_literal="Empty_array_literal",e.Irregular_array_shape="Irregular_array_shape",e.Empty_parenthesis="Empty_parenthesis",e.Missing_operation_argument="Missing_operation_argument",e.Bad_node="Bad_node",e.Invalid_qualifier="Invalid_qualifier",e.Invalid_cell_ref="Invalid_cell_ref",e.Invalid_binder="Invalid_binder",e.Missing_binder="Missing_binder",e.Duplicate_binder="Duplicate_binder",e.Invalid_body="Invalid_body",e.Mandatory_binder_after_optional="Mandatory_binder_after_optional",e.Missing_default_expression="Missing_default_expression",e.Binder_requires_brackets="Binder_requires_brackets",e.Invalid_field_name="Invalid_field_name",e.Missing_field_name="Missing_field_name",e.Empty_formula="Empty_formula",e.Invalid_rel_sheet_qualifier_in_cell="Invalid_rel_sheet_qualifier_in_cell",e.Invalid_rel_sheet_qualifier_in_name="Invalid_rel_sheet_qualifier_in_name",e.Invalid_unqualified_cell="Invalid_unqualified_cell",e.Unexpected_closing_paren="Unexpected_closing_paren",e.Unexpected_closing_brace="Unexpected_closing_brace",e.Unexpected_closing_bracket="Unexpected_closing_bracket",e.Unexpected_character="Unexpected_character",e.Unexpected_field_ref="Unexpected_field_ref",e.Unexpected_dot="Unexpected_dot",e.Invalid_struct_ref_table_name="Invalid_struct_ref_table_name",e.Missing_struct_ref_table_name="Missing_struct_ref_table_name",e.Invalid_struct_ref_comma_parts="Invalid_struct_ref_comma_parts",e.Invalid_struct_ref_missing_part="Invalid_struct_ref_missing_part",e.Invalid_struct_ref_bad_part="Invalid_struct_ref_bad_part",e.Excess_higher_order_function_arguments="Excess_higher_order_function_arguments"}(o||(t.SyntaxError=o={})),function(e){e.Types_not_related="Types_not_related",e.Unexpected_application_head="Unexpected_application_head",e.Unexpected_application_head_with_fix="Unexpected_application_head_with_fix",e.Incorrect_number_of_operator_arguments="Incorrect_number_of_operator_arguments",e.Excess_function_arguments="Excess_function_arguments",e.Insufficient_function_arguments="Insufficient_function_arguments"}(a||(t.TypeError=a={})),function(e){e.WSFArgument="WSFArgument",e.OperatorArgument="OperatorArgument"}(s||(t.TypeSourceKind=s={})),t.baseErrors={[o.Unclosed_application]:{kind:o.Unclosed_application},[o.Unclosed_paren]:{kind:o.Unclosed_paren},[o.Unclosed_bracket]:{kind:o.Unclosed_bracket},[o.Unclosed_array]:{kind:o.Unclosed_array},[o.Unclosed_literal]:{kind:o.Unclosed_literal},[o.Unclosed_comment]:{kind:o.Unclosed_comment},[o.Invalid_number_literal]:{kind:o.Invalid_number_literal},[o.Invalid_string_literal]:{kind:o.Invalid_string_literal},[o.Invalid_error_literal]:{kind:o.Invalid_error_literal},[o.Invalid_function_name]:{kind:o.Invalid_function_name},[o.Invalid_name]:{kind:o.Invalid_name},[o.Illegal_array_literal_element]:{kind:o.Illegal_array_literal_element},[o.Empty_array_literal]:{kind:o.Empty_array_literal},[o.Irregular_array_shape]:{kind:o.Irregular_array_shape},[o.Empty_parenthesis]:{kind:o.Empty_parenthesis},[o.Bad_node]:{kind:o.Bad_node},[o.Invalid_qualifier]:{kind:o.Invalid_qualifier},[o.Invalid_cell_ref]:{kind:o.Invalid_cell_ref},[o.Invalid_binder]:{kind:o.Invalid_binder},[o.Missing_binder]:{kind:o.Missing_binder},[o.Duplicate_binder]:{kind:o.Duplicate_binder},[o.Invalid_body]:{kind:o.Invalid_body},[o.Mandatory_binder_after_optional]:{kind:o.Mandatory_binder_after_optional},[o.Missing_default_expression]:{kind:o.Missing_default_expression},[o.Binder_requires_brackets]:{kind:o.Binder_requires_brackets},[o.Invalid_field_name]:{kind:o.Invalid_field_name},[o.Missing_field_name]:{kind:o.Missing_field_name},[o.Empty_formula]:{kind:o.Empty_formula},[o.Invalid_rel_sheet_qualifier_in_cell]:{kind:o.Invalid_rel_sheet_qualifier_in_cell},[o.Invalid_rel_sheet_qualifier_in_name]:{kind:o.Invalid_rel_sheet_qualifier_in_name},[o.Invalid_unqualified_cell]:{kind:o.Invalid_unqualified_cell},[o.Unexpected_closing_paren]:{kind:o.Unexpected_closing_paren},[o.Unexpected_closing_brace]:{kind:o.Unexpected_closing_brace},[o.Unexpected_closing_bracket]:{kind:o.Unexpected_closing_bracket},[o.Unexpected_field_ref]:{kind:o.Unexpected_field_ref},[o.Unexpected_dot]:{kind:o.Unexpected_dot},[o.Invalid_struct_ref_table_name]:{kind:o.Invalid_struct_ref_table_name},[o.Missing_struct_ref_table_name]:{kind:o.Missing_struct_ref_table_name},[o.Invalid_struct_ref_comma_parts]:{kind:o.Invalid_struct_ref_comma_parts},[o.Invalid_struct_ref_missing_part]:{kind:o.Invalid_struct_ref_missing_part},[o.Invalid_struct_ref_bad_part]:{kind:o.Invalid_struct_ref_bad_part},[a.Unexpected_application_head]:{kind:a.Unexpected_application_head},[a.Unexpected_application_head_with_fix]:{kind:a.Unexpected_application_head_with_fix}},t.formatDiagnostic=function(e){switch(e.kind){case a.Insufficient_function_arguments:case a.Excess_function_arguments:return`${e.kind}: ${(0,n.englishWorksheetFuncIdToName)(e.funcId)}`;case o.Missing_operation_argument:case a.Incorrect_number_of_operator_arguments:return`${e.kind}: ${(0,n.englishOperatorIdToName)(e.opId)}`;case o.Unexpected_character:return`${e.kind}: ${(0,i.anonymizeFormulaString)(e.text)}`;case a.Types_not_related:return`${e.kind}: ${function(e){const{kind:t,argIndex:r}=e;switch(e.kind){case s.WSFArgument:return JSON.stringify({kind:t,funcId:(0,n.englishWorksheetFuncIdToName)(e.funcId),argIndex:r});case s.OperatorArgument:return JSON.stringify({kind:t,opId:(0,n.englishOperatorIdToName)(e.opId),argIndex:r})}}(e.typeSource)}`;default:return e.kind}};const l="The formulas has an error";t.baseNLErrors={[o.Unclosed_application]:"The formula is missing a parenthesis",[o.Unclosed_paren]:"The formula is missing a parenthesis",[o.Unclosed_bracket]:"The formula is missing a bracket",[o.Unclosed_array]:"The formula is missing a brace",[o.Unclosed_literal]:"The formula is missing a quote",[o.Unclosed_comment]:"The formula comment is missing an end",[o.Invalid_number_literal]:"The formula has an invalid number",[o.Invalid_string_literal]:"The formula has an invalid string",[o.Invalid_error_literal]:"The formula has an invalid value",[o.Invalid_function_name]:"The formula has an invalid function name",[o.Invalid_name]:"The formula has an invalid name",[o.Illegal_array_literal_element]:"The formula has an invalid value",[o.Empty_array_literal]:"The formula has an empty array",[o.Irregular_array_shape]:"The formula has an incorrectly shaped array",[o.Empty_parenthesis]:"The formula is missing values between parentheses",[o.Missing_operation_argument]:"The formula has an extra operator",[o.Bad_node]:l,[o.Invalid_qualifier]:"The formula has an invalid sheet reference",[o.Invalid_cell_ref]:"The formula has an invalid cell reference",[o.Invalid_binder]:l,[o.Missing_binder]:l,[o.Duplicate_binder]:l,[o.Invalid_body]:l,[o.Mandatory_binder_after_optional]:l,[o.Missing_default_expression]:l,[o.Binder_requires_brackets]:l,[o.Invalid_field_name]:"The formula has an invalid field name",[o.Missing_field_name]:"The formula is missing a field name",[o.Empty_formula]:"The formula is empty",[o.Invalid_rel_sheet_qualifier_in_cell]:"The formula has an incorrect reference",[o.Invalid_rel_sheet_qualifier_in_name]:"The formula has an incorrect reference",[o.Invalid_unqualified_cell]:"The formula has an incorrect reference",[o.Unexpected_closing_paren]:"The formula has an extra parenthesis",[o.Unexpected_closing_brace]:"The formula has an extra brace",[o.Unexpected_closing_bracket]:"The formula has an extra bracket",[o.Unexpected_character]:"The formula has some extra characters",[o.Unexpected_field_ref]:"The formula has an extra field",[o.Unexpected_dot]:"The formula has an extra dot",[o.Invalid_struct_ref_table_name]:"The formula has a malformed table name in a structured reference",[o.Missing_struct_ref_table_name]:"The formula is missing the table name in a structured reference",[o.Invalid_struct_ref_comma_parts]:"The formula has a structured reference with commas that has issues between its brackets",[o.Invalid_struct_ref_missing_part]:"The formula has a structured reference with missing references between its brackets",[o.Invalid_struct_ref_bad_part]:"The formula has a bad reference in a structured reference",[o.Excess_higher_order_function_arguments]:"The formula has a function call with too many arguments",[a.Types_not_related]:"The formula has an operation using data that cannot be mixed together",[a.Unexpected_application_head]:"The formula has a malformed function call",[a.Unexpected_application_head_with_fix]:"The formula has a malformed function call",[a.Incorrect_number_of_operator_arguments]:"The formula has an operation with the wrong number of arguments",[a.Excess_function_arguments]:"The formula has a function call with too many arguments",[a.Insufficient_function_arguments]:"The formula has a function call with missing arguments"},t.convertDiagnosticToNLMessage=function(e){return t.baseNLErrors[e.kind]}},86483:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveStaticPrecedents=void 0;const n=r(65556),i=r(1910),o=r(33392),a=r(43162),s=r(1389),l=r(20493),u=r(20952),c=r(64842),d=r(21081),m=r(41118),g=r(76457),p=r(28694),h=r(23050),f={getDocumentLoc:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getDocumentLoc"),getSheetIndex:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetIndex"),getSheetName:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetName"),getNameLoc:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getNameLoc"),getUserDefinedFuncLoc:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getUserDefinedFuncLoc"),getSheetRangeIndexes:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetRangeIndexes"),getContainingTable:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getContainingTable"),getStructRefColumn:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getStructRefColumn"),getStructRefSpecialRef:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getStructRefSpecialRef")},S=(0,m.createFailureErrorClass)("ResolveStaticPrecedentsError");class v extends p.IdentityVisitor{appNode(e,t,r,n){if(e.kind===a.NodeKind.WSF){const r=e.id;let n=(0,c.getWorksheetFuncType)(r).staticPrecs;switch(r){case c.WorksheetFuncId.LOOKUP:case c.WorksheetFuncId.SUMIF:case c.WorksheetFuncId.AVERAGEIF:const e=({label:e})=>{const t=this.resolutions[e],r=(null==t?void 0:t.kind)===u.ResolvedKind.ResolvedCellRef||(null==t?void 0:t.kind)===u.ResolvedKind.ResolvedStructRef?t.resolution:void 0;return(null==r?void 0:r.kind)===o.ResultKind.Success?r.value:void 0},i=(t,r)=>{const n=e(t),i=e(r);return void 0!==n&&void 0!==i&&(0,s.isSheetGridRange)(n)&&(0,s.isSheetGridRange)(i)&&(0,m.isDocumentLocEqual)(n.sheet.document,i.sheet.document)&&n.range.rows===i.range.rows&&n.range.cols===i.range.cols};(t.length<3||t[2].kind===a.NodeKind.Literal||t[2].kind===a.NodeKind.Array||i(t[2],r===c.WorksheetFuncId.LOOKUP?t[1]:t[0]))&&(n&=~d.SpecialPrecs.AllCells)}n!==d.SpecialPrecs.None&&(this.ownSpecial|=n)}return super.appNode(e,t,r,n)}nameNode(e,t,r){const n=this.resolver.resolveDottedName(this.locals,(0,a.nameNode)(e,t,r),this.annotations);this.resolutions[r]=n,(0,i.safePush)(this.names,n.precedents.names),(0,i.safePush)(this.udfs,n.precedents.udfs);const{headResolved:s}=n;switch(s.kind){case u.ResolvedKind.ResolvedName:if(!(0,o.isSuccess)(s.resolution)){this.handleResolutionError(s.resolution.reason);break}void 0!==s.resolution.value&&(this.nameSpecial|=d.SpecialPrecs.All);break;case u.ResolvedKind.ResolvedUserDefinedFunc:if(!(0,o.isSuccess)(s.resolution)){this.handleResolutionError(s.resolution.reason);break}break;case u.ResolvedKind.ResolvedCellRef:this.pushResolvedGridRef(s.resolution)}return super.nameNode(e,t,r)}cellRefNode(e,t,r){const n=this.resolver.resolveCellRef(this.locals,(0,a.cellRefNode)(e,t,r));this.resolutions[r]=n;const{resolution:i}=n;return this.pushResolvedGridRef(i),super.cellRefNode(e,t,r)}structRefNode(e,t,r){const n=this.resolver.resolveStructRef(this.locals,(0,a.structRefNode)(e,t,r));this.resolutions[r]=n,(0,i.safePush)(this.names,n.precedents);const{resolution:o}=n;return this.pushResolvedGridRef(o),super.structRefNode(e,t,r)}pushResolvedGridRef(e){if(e.kind!==o.ResultKind.Success)return this.handleResolutionError(e.reason);if(void 0!==e.value){const t=e.value;if((0,s.isSheetGridRange)(t))this.cells.push(t);else{this.ownSpecial|=d.SpecialPrecs.OwnDocSheets;const e=this.globals.getSheetRangeIndexes(t.sheet);if(!(0,o.isSuccess)(e))throw new S(e.reason);(0,i.safePush)(this.cells,e.value.sheets.map((e=>(0,s.sheetGridRange)((0,s.sheetIndex)(t.sheet.document,e),t.range))))}}}handleResolutionError(e){switch(e.kind){case u.ResolveReasonKind.NoOriginSheet:case u.ResolveReasonKind.InvalidStructRef:case u.ResolveReasonKind.InvalidCellRef:case u.ResolveReasonKind.InvalidQualifier:case u.ResolveReasonKind.EmptyIntersection:return}throw new S(e)}constructor(e,t,r){super(),this.locals=t,this.annotations=r,this.cells=[],this.names=[],this.udfs=[],this.nameSpecial=d.SpecialPrecs.None,this.ownSpecial=d.SpecialPrecs.None,this.resolutions=[],this.globals=function(e){var t,r,n,i,o,a,s,l,u,c,d,m,g,p,h,S,v,y;return{config:e.config,getDocumentLoc:null!==(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:f.getDocumentLoc,getSheetIndex:null!==(i=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e))&&void 0!==i?i:f.getSheetIndex,getSheetName:null!==(a=null===(o=e.getSheetName)||void 0===o?void 0:o.bind(e))&&void 0!==a?a:f.getSheetName,getNameLoc:null!==(l=null===(s=e.getNameLoc)||void 0===s?void 0:s.bind(e))&&void 0!==l?l:f.getNameLoc,getUserDefinedFuncLoc:null!==(c=null===(u=e.getUserDefinedFuncLoc)||void 0===u?void 0:u.bind(e))&&void 0!==c?c:f.getUserDefinedFuncLoc,getSheetRangeIndexes:null!==(m=null===(d=e.getSheetRangeIndexes)||void 0===d?void 0:d.bind(e))&&void 0!==m?m:f.getSheetRangeIndexes,getContainingTable:null!==(p=null===(g=e.getContainingTable)||void 0===g?void 0:g.bind(e))&&void 0!==p?p:f.getContainingTable,getStructRefColumn:null!==(S=null===(h=e.getStructRefColumn)||void 0===h?void 0:h.bind(e))&&void 0!==S?S:f.getStructRefColumn,getStructRefSpecialRef:null!==(y=null===(v=e.getStructRefSpecialRef)||void 0===v?void 0:v.bind(e))&&void 0!==y?y:f.getStructRefSpecialRef}}(e),this.resolver=(0,l.createResolver)(this.globals)}}t.resolveStaticPrecedents=function(e,t,r){try{const n=new v(e,t,r.annotations);return(0,p.reduceBottomUp)(n,r),(0,o.success)((0,h.staticPrecedents)(n.cells,n.names,n.udfs,n.nameSpecial|n.ownSpecial,n.ownSpecial,g.PrecsBound.Upper,n.resolutions))}catch(e){return e instanceof S?(0,o.failure)(e.reason):(0,o.failure)((0,o.javaScriptError)(e))}}},23050:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.analyzeLocalsName=t.analyzeLocalsGrid=t.createAnalyzeGlobals=t.staticPrecedents=t.summarizeFormulaDiagnostics=t.diagnostics=void 0;const n=r(19181),i=r(1389),o=n.__importStar(r(42096));t.diagnostics=o;const a=r(33392);t.summarizeFormulaDiagnostics=function(e){if(void 0===e)return;const t={};return Object.keys(e).forEach((r=>{e[Number(r)].forEach((e=>{var r;const n=o.formatDiagnostic(e);t[n]=(null!==(r=t[n])&&void 0!==r?r:0)+1}))})),t},t.staticPrecedents=function(e,t,r,n,i,o,a){return{cells:e,names:t,udfs:r,special:n,ownSpecial:i,bound:o,resolutions:a}},t.createAnalyzeGlobals=function(e,t){return{config:e,getSheetName:t}},t.analyzeLocalsGrid=function(e,t,r,n=!1){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:(0,a.success)(t.range),originSheet:(0,a.success)(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:n}},t.analyzeLocalsName=function(e,t,r=!1){return{config:null!=t?t:void 0,lexicalKind:i.LexicalKind.NameManager,originGridCell:(0,a.success)(e.range),originSheet:(0,a.success)(e.sheet),allowRelativeQualifier:!0,allowUnqualifiedCell:!1,allowImplicitTable:!1,wrapCellReferences:!0,workbookLoad:r}}},54741:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;const n=r(57777);t.anonymize=n.anonymizer.anonymize,t.anonymizeFormulaString=n.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=n.anonymizer.anonymizeMagnitude,t.kindAnonymizers=n.anonymizer.kindAnonymizers},65556:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;const n=r(57777);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},15964:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointExclamationMark=t.codePointEuroSign=t.codePointEqualsSign=t.codePointDoubleQuote=t.codePointDollarSign=t.codePointDigitZero=t.codePointDigitTwo=t.codePointDigitThree=t.codePointDigitSix=t.codePointDigitSeven=t.codePointDigitOne=t.codePointDigitNine=t.codePointDigitFour=t.codePointDigitFive=t.codePointDigitEight=t.codePointComma=t.codePointColon=t.codePointCircumflexAccent=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointCR=t.codePointBacktick=t.codePointBackslash=t.codePointAtSign=t.codePointAsterisk=t.codePointAmpersand=void 0,t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointSlash=t.codePointSingleQuote=t.codePointSemicolon=t.codePointRightSquareBracket=t.codePointRightParen=t.codePointRightCurlyBracket=t.codePointQuestionMark=t.codePointPlusSign=t.codePointPipe=t.codePointPercentSign=t.codePointMinusSign=t.codePointLessThanSign=t.codePointLeftSquareBracket=t.codePointLeftParen=t.codePointLeftCurlyBracket=t.codePointLF=t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointHash=t.codePointGreaterThanSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitZero=t.codePointFullwidthDigitNine=t.codePointFullStop=void 0,t.codePointRightSingleQuotationMark=t.codePointLeftSingleQuotationMark=t.codePointUnderscore=t.codePointTilde=t.codePointThaiDigitZero=t.codePointThaiDigitNine=t.codePointTab=t.codePointSpace=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=void 0;const n=r(57777);t.codePointAmpersand=n.codePoint.codePointAmpersand,t.codePointAsterisk=n.codePoint.codePointAsterisk,t.codePointAtSign=n.codePoint.codePointAtSign,t.codePointBackslash=n.codePoint.codePointBackslash,t.codePointBacktick=n.codePoint.codePointBacktick,t.codePointCR=n.codePoint.codePointCR,t.codePointCapitalA=n.codePoint.codePointCapitalA,t.codePointCapitalB=n.codePoint.codePointCapitalB,t.codePointCapitalC=n.codePoint.codePointCapitalC,t.codePointCapitalD=n.codePoint.codePointCapitalD,t.codePointCapitalE=n.codePoint.codePointCapitalE,t.codePointCapitalF=n.codePoint.codePointCapitalF,t.codePointCapitalG=n.codePoint.codePointCapitalG,t.codePointCapitalH=n.codePoint.codePointCapitalH,t.codePointCapitalI=n.codePoint.codePointCapitalI,t.codePointCapitalJ=n.codePoint.codePointCapitalJ,t.codePointCapitalK=n.codePoint.codePointCapitalK,t.codePointCapitalL=n.codePoint.codePointCapitalL,t.codePointCapitalM=n.codePoint.codePointCapitalM,t.codePointCapitalN=n.codePoint.codePointCapitalN,t.codePointCapitalO=n.codePoint.codePointCapitalO,t.codePointCapitalP=n.codePoint.codePointCapitalP,t.codePointCapitalQ=n.codePoint.codePointCapitalQ,t.codePointCapitalR=n.codePoint.codePointCapitalR,t.codePointCapitalS=n.codePoint.codePointCapitalS,t.codePointCapitalT=n.codePoint.codePointCapitalT,t.codePointCapitalU=n.codePoint.codePointCapitalU,t.codePointCapitalV=n.codePoint.codePointCapitalV,t.codePointCapitalW=n.codePoint.codePointCapitalW,t.codePointCapitalX=n.codePoint.codePointCapitalX,t.codePointCapitalY=n.codePoint.codePointCapitalY,t.codePointCapitalZ=n.codePoint.codePointCapitalZ,t.codePointCircumflexAccent=n.codePoint.codePointCircumflexAccent,t.codePointColon=n.codePoint.codePointColon,t.codePointComma=n.codePoint.codePointComma,t.codePointDigitEight=n.codePoint.codePointDigitEight,t.codePointDigitFive=n.codePoint.codePointDigitFive,t.codePointDigitFour=n.codePoint.codePointDigitFour,t.codePointDigitNine=n.codePoint.codePointDigitNine,t.codePointDigitOne=n.codePoint.codePointDigitOne,t.codePointDigitSeven=n.codePoint.codePointDigitSeven,t.codePointDigitSix=n.codePoint.codePointDigitSix,t.codePointDigitThree=n.codePoint.codePointDigitThree,t.codePointDigitTwo=n.codePoint.codePointDigitTwo,t.codePointDigitZero=n.codePoint.codePointDigitZero,t.codePointDollarSign=n.codePoint.codePointDollarSign,t.codePointDoubleQuote=n.codePoint.codePointDoubleQuote,t.codePointEqualsSign=n.codePoint.codePointEqualsSign,t.codePointEuroSign=n.codePoint.codePointEuroSign,t.codePointExclamationMark=n.codePoint.codePointExclamationMark,t.codePointFullStop=n.codePoint.codePointFullStop,t.codePointFullwidthDigitNine=n.codePoint.codePointFullwidthDigitNine,t.codePointFullwidthDigitZero=n.codePoint.codePointFullwidthDigitZero,t.codePointFullwidthLatinCapitalA=n.codePoint.codePointFullwidthLatinCapitalA,t.codePointFullwidthLatinCapitalZ=n.codePoint.codePointFullwidthLatinCapitalZ,t.codePointFullwidthLatinSmallA=n.codePoint.codePointFullwidthLatinSmallA,t.codePointFullwidthLatinSmallZ=n.codePoint.codePointFullwidthLatinSmallZ,t.codePointGreaterThanSign=n.codePoint.codePointGreaterThanSign,t.codePointHash=n.codePoint.codePointHash,t.codePointInvertedExclamationMark=n.codePoint.codePointInvertedExclamationMark,t.codePointInvertedQuestionMark=n.codePoint.codePointInvertedQuestionMark,t.codePointLF=n.codePoint.codePointLF,t.codePointLeftCurlyBracket=n.codePoint.codePointLeftCurlyBracket,t.codePointLeftParen=n.codePoint.codePointLeftParen,t.codePointLeftSquareBracket=n.codePoint.codePointLeftSquareBracket,t.codePointLessThanSign=n.codePoint.codePointLessThanSign,t.codePointMinusSign=n.codePoint.codePointMinusSign,t.codePointPercentSign=n.codePoint.codePointPercentSign,t.codePointPipe=n.codePoint.codePointPipe,t.codePointPlusSign=n.codePoint.codePointPlusSign,t.codePointQuestionMark=n.codePoint.codePointQuestionMark,t.codePointRightCurlyBracket=n.codePoint.codePointRightCurlyBracket,t.codePointRightParen=n.codePoint.codePointRightParen,t.codePointRightSquareBracket=n.codePoint.codePointRightSquareBracket,t.codePointSemicolon=n.codePoint.codePointSemicolon,t.codePointSingleQuote=n.codePoint.codePointSingleQuote,t.codePointSlash=n.codePoint.codePointSlash,t.codePointSmallA=n.codePoint.codePointSmallA,t.codePointSmallB=n.codePoint.codePointSmallB,t.codePointSmallC=n.codePoint.codePointSmallC,t.codePointSmallD=n.codePoint.codePointSmallD,t.codePointSmallE=n.codePoint.codePointSmallE,t.codePointSmallF=n.codePoint.codePointSmallF,t.codePointSmallG=n.codePoint.codePointSmallG,t.codePointSmallH=n.codePoint.codePointSmallH,t.codePointSmallI=n.codePoint.codePointSmallI,t.codePointSmallJ=n.codePoint.codePointSmallJ,t.codePointSmallK=n.codePoint.codePointSmallK,t.codePointSmallL=n.codePoint.codePointSmallL,t.codePointSmallM=n.codePoint.codePointSmallM,t.codePointSmallN=n.codePoint.codePointSmallN,t.codePointSmallO=n.codePoint.codePointSmallO,t.codePointSmallP=n.codePoint.codePointSmallP,t.codePointSmallQ=n.codePoint.codePointSmallQ,t.codePointSmallR=n.codePoint.codePointSmallR,t.codePointSmallS=n.codePoint.codePointSmallS,t.codePointSmallT=n.codePoint.codePointSmallT,t.codePointSmallU=n.codePoint.codePointSmallU,t.codePointSmallV=n.codePoint.codePointSmallV,t.codePointSmallW=n.codePoint.codePointSmallW,t.codePointSmallX=n.codePoint.codePointSmallX,t.codePointSmallY=n.codePoint.codePointSmallY,t.codePointSmallZ=n.codePoint.codePointSmallZ,t.codePointSpace=n.codePoint.codePointSpace,t.codePointTab=n.codePoint.codePointTab,t.codePointThaiDigitNine=n.codePoint.codePointThaiDigitNine,t.codePointThaiDigitZero=n.codePoint.codePointThaiDigitZero,t.codePointTilde=n.codePoint.codePointTilde,t.codePointUnderscore=n.codePoint.codePointUnderscore,t.codePointLeftSingleQuotationMark=n.codePoint.codePointLeftSingleQuotationMark,t.codePointRightSingleQuotationMark=n.codePoint.codePointRightSingleQuotationMark},1910:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;const n=r(57777);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},6013:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;const n=r(57777);t.RedBlackMapTree=n.rbMapTree.RedBlackMapTree},82993:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;const n=r(57777);t.FeatureName=n.featureConfiguration.FeatureName,t.initFeatureConfiguration=n.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=n.featureConfiguration.isFeatureEnabled,t.getFeatures=n.featureConfiguration.getFeatures,t.getTypedFeatureGate=n.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=n.featureConfiguration.isTypedChangeGateEnabled;var i=r(12367);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return i.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return i.setFeatureGateDictionaryGetter}})},33392:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;const n=r(57777);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},93905:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;const n=r(57777);t.Pledge=n.pledge.Pledge},2910:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.surrogatePairToCodePoint=t.stringFromCodePoint=t.stringCodePointAt=t.scanCodePointsBack=t.scanCodePoints=t.numCodeUnits=t.isLowSurrogate=t.isHighSurrogate=t.isAnySurrogate=t.countCodePoints=t.codePointIterator=void 0;const n=r(57777);t.codePointIterator=n.unicode.codePointIterator,t.countCodePoints=n.unicode.countCodePoints,t.isAnySurrogate=n.unicode.isAnySurrogate,t.isHighSurrogate=n.unicode.isHighSurrogate,t.isLowSurrogate=n.unicode.isLowSurrogate,t.numCodeUnits=n.unicode.numCodeUnits,t.scanCodePoints=n.unicode.scanCodePoints,t.scanCodePointsBack=n.unicode.scanCodePointsBack,t.stringCodePointAt=n.unicode.stringCodePointAt,t.stringFromCodePoint=n.unicode.stringFromCodePoint,t.surrogatePairToCodePoint=n.unicode.surrogatePairToCodePoint},42665:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;const n=r(57777);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},37883:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.util=t.tokenizeFormulaModule=t.token=t.parseStructRefModule=t.parserState=t.parserService=t.parseResultHelperModule=t.parseRefModule=t.parser=t.parseQualifierModule=t.parseOperators=t.parseLiteralModule=t.parseFormulaModule=t.parseFieldRefModule=t.parseCommon=t.parseServiceTypes=t.analyzeServiceTypes=t.diagnostics=t.checker=t.autocorrect=t.analyzeService=t.PackageName=void 0;const n=r(19181);t.PackageName="excel-online-calc-syntax",t.analyzeService=n.__importStar(r(89309)),t.autocorrect=n.__importStar(r(40167)),t.checker=n.__importStar(r(70559)),t.diagnostics=n.__importStar(r(42096)),t.analyzeServiceTypes=n.__importStar(r(23050)),t.parseServiceTypes=n.__importStar(r(35303)),t.parseCommon=n.__importStar(r(45873)),t.parseFieldRefModule=n.__importStar(r(85593)),t.parseFormulaModule=n.__importStar(r(21236)),t.parseLiteralModule=n.__importStar(r(60353)),t.parseOperators=n.__importStar(r(46347)),t.parseQualifierModule=n.__importStar(r(89062)),t.parser=n.__importStar(r(97892)),t.parseRefModule=n.__importStar(r(13711)),t.parseResultHelperModule=n.__importStar(r(29269)),t.parserService=n.__importStar(r(73917)),t.parserState=n.__importStar(r(679)),t.parseStructRefModule=n.__importStar(r(50628)),t.token=n.__importStar(r(59590)),t.tokenizeFormulaModule=n.__importStar(r(9782)),t.util=n.__importStar(r(50019))},3222:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildAnnotations=void 0;const n=r(81836);t.buildAnnotations=n.annotations.buildAnnotations},86241:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldQuoteQualifier=t.resolvePosition=t.quoteQualifier=t.formatRowRange=t.formatRow=t.formatRangePos=t.formatQualifier=t.formatGridRange=t.formatColRange=t.formatCol=t.formatCellPos=t.columnName=t.canonicaliseRowRange=t.canonicaliseRow=t.canonicaliseRangePos=t.canonicaliseColRange=t.canonicaliseCol=t.canonicaliseCellPos=t.canonicaliseBrackets=void 0;const n=r(81836);t.canonicaliseBrackets=n.cellFormat.canonicaliseBrackets,t.canonicaliseCellPos=n.cellFormat.canonicaliseCellPos,t.canonicaliseCol=n.cellFormat.canonicaliseCol,t.canonicaliseColRange=n.cellFormat.canonicaliseColRange,t.canonicaliseRangePos=n.cellFormat.canonicaliseRangePos,t.canonicaliseRow=n.cellFormat.canonicaliseRow,t.canonicaliseRowRange=n.cellFormat.canonicaliseRowRange,t.columnName=n.cellFormat.columnName,t.formatCellPos=n.cellFormat.formatCellPos,t.formatCol=n.cellFormat.formatCol,t.formatColRange=n.cellFormat.formatColRange,t.formatGridRange=n.cellFormat.formatGridRange,t.formatQualifier=n.cellFormat.formatQualifier,t.formatRangePos=n.cellFormat.formatRangePos,t.formatRow=n.cellFormat.formatRow,t.formatRowRange=n.cellFormat.formatRowRange,t.quoteQualifier=n.cellFormat.quoteQualifier,t.resolvePosition=n.cellFormat.resolvePosition,t.shouldQuoteQualifier=n.cellFormat.shouldQuoteQualifier},50591:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapPosition=t.parseGridRangeA1=t.parseGridCellA1=t.parseCellRef=t.isR1C1IdentStart=t.SpecialPos=void 0;const n=r(81836);t.SpecialPos=n.cellParse.SpecialPos,t.isR1C1IdentStart=n.cellParse.isR1C1IdentStart,t.parseCellRef=n.cellParse.parseCellRef,t.parseGridCellA1=n.cellParse.parseGridCellA1,t.parseGridRangeA1=n.cellParse.parseGridRangeA1,t.wrapPosition=n.cellParse.wrapPosition},61920:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ulsLogger=t.operatorIdToName=t.localeInfo=t.isNumeral=t.getOrdinal=t.getNumberShape=t.getEnglishWorksheetFuncIdToName=t.getEnglishLocaleInfo=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishSpecialRefNames=t.englishPictureSpecial=t.englishPictureSingle=t.englishPictureDbnum=t.englishPictureColor=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishErrorNames=t.createWorksheetFuncNameCallbacks=t.calcConfig=t.TraceLevel=t.PictureSpecial=t.PictureSingle=t.PictureDbnum=t.PictureColor=t.NulLogger=t.LogCategory=t.LCID=t.Country=void 0;const n=r(81836);t.Country=n.config.Country,t.LCID=n.config.LCID,t.LogCategory=n.config.LogCategory,t.NulLogger=n.config.NulLogger,t.PictureColor=n.config.PictureColor,t.PictureDbnum=n.config.PictureDbnum,t.PictureSingle=n.config.PictureSingle,t.PictureSpecial=n.config.PictureSpecial,t.TraceLevel=n.config.TraceLevel,t.calcConfig=n.config.calcConfig,t.createWorksheetFuncNameCallbacks=n.config.createWorksheetFuncNameCallbacks,t.englishErrorNames=n.config.englishErrorNames,t.englishErrorTypeToName=n.config.englishErrorTypeToName,t.englishOperatorIdToName=n.config.englishOperatorIdToName,t.englishPictureColor=n.config.englishPictureColor,t.englishPictureDbnum=n.config.englishPictureDbnum,t.englishPictureSingle=n.config.englishPictureSingle,t.englishPictureSpecial=n.config.englishPictureSpecial,t.englishSpecialRefNames=n.config.englishSpecialRefNames,t.englishSysDateFormat=n.config.englishSysDateFormat,t.englishSysTimeFormat=n.config.englishSysTimeFormat,t.englishWorksheetFuncIdToName=n.config.englishWorksheetFuncIdToName,t.getEnglishLocaleInfo=n.config.getEnglishLocaleInfo,t.getEnglishWorksheetFuncIdToName=n.config.getEnglishWorksheetFuncIdToName,t.getNumberShape=n.config.getNumberShape,t.getOrdinal=n.config.getOrdinal,t.isNumeral=n.config.isNumeral,t.localeInfo=n.config.localeInfo,t.operatorIdToName=n.config.operatorIdToName,t.ulsLogger=n.config.ulsLogger},43162:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.localNameUseAnnotation=t.localNameDeclAnnotation=t.literalNode=t.letVar=t.letNode=t.lambdaParam=t.lambdaNode=t.indexedArg=t.identQualifier=t.identNamePart=t.headNamePart=t.formulaSpan=t.multiLineComment=t.singleLineComment=t.formulaRootAnnotation=t.formula=t.flattenNameParts=t.flattenLetArgs=t.flattenLambdaArgs=t.fieldRefNode=t.fieldRefNamePart=t.fieldRef=t.errorQualifier=t.documentQualifier=t.commaOpRef=t.columnRef=t.cellRefSingle=t.cellRefRow=t.cellRefRange=t.cellRefNode=t.cellRefNamePart=t.cellRefError=t.cellRefCol=t.cellRefBad=t.badRef=t.badQualifier=t.arrayNode=t.appNode=t.appHeadNameAnnotation=t.StructRefKind=t.SpecialRefId=t.RefStyle=t.QualifierKind=t.PosKind=t.NodeKind=t.NamePartKind=t.CellRefKind=t.BadType=t.AnnotationKind=t.SyntaxFeature=void 0,t.badSequenceNode=t.badCharsNode=t.varNode=t.identNode=t.missingNode=t.getDepthUpperBound=t.wsfNode=t.thisRowOpRef=t.contextNameNode=t.structRefNode=t.structRef=t.specialRef=t.sheetRangeQualifier=t.sheetQualifier=t.relativeQualifier=t.rangeOpRef=t.pos=t.parenNode=t.paramNode=t.paramName=t.paramDefault=t.operatorNode=t.nameNode=t.missingRef=void 0;const n=r(81836);t.SyntaxFeature=n.formulaModule.SyntaxFeature,t.AnnotationKind=n.formulaModule.AnnotationKind,t.BadType=n.formulaModule.BadType,t.CellRefKind=n.formulaModule.CellRefKind,t.NamePartKind=n.formulaModule.NamePartKind,t.NodeKind=n.formulaModule.NodeKind,t.PosKind=n.formulaModule.PosKind,t.QualifierKind=n.formulaModule.QualifierKind,t.RefStyle=n.formulaModule.RefStyle,t.SpecialRefId=n.formulaModule.SpecialRefId,t.StructRefKind=n.formulaModule.StructRefKind,t.appHeadNameAnnotation=n.formulaModule.appHeadNameAnnotation,t.appNode=n.formulaModule.appNode,t.arrayNode=n.formulaModule.arrayNode,t.badQualifier=n.formulaModule.badQualifier,t.badRef=n.formulaModule.badRef,t.cellRefBad=n.formulaModule.cellRefBad,t.cellRefCol=n.formulaModule.cellRefCol,t.cellRefError=n.formulaModule.cellRefError,t.cellRefNamePart=n.formulaModule.cellRefNamePart,t.cellRefNode=n.formulaModule.cellRefNode,t.cellRefRange=n.formulaModule.cellRefRange,t.cellRefRow=n.formulaModule.cellRefRow,t.cellRefSingle=n.formulaModule.cellRefSingle,t.columnRef=n.formulaModule.columnRef,t.commaOpRef=n.formulaModule.commaOpRef,t.documentQualifier=n.formulaModule.documentQualifier,t.errorQualifier=n.formulaModule.errorQualifier,t.fieldRef=n.formulaModule.fieldRef,t.fieldRefNamePart=n.formulaModule.fieldRefNamePart,t.fieldRefNode=n.formulaModule.fieldRefNode,t.flattenLambdaArgs=n.formulaModule.flattenLambdaArgs,t.flattenLetArgs=n.formulaModule.flattenLetArgs,t.flattenNameParts=n.formulaModule.flattenNameParts,t.formula=n.formulaModule.formula,t.formulaRootAnnotation=n.formulaModule.formulaRootAnnotation,t.singleLineComment=n.formulaModule.singleLineComment,t.multiLineComment=n.formulaModule.multiLineComment,t.formulaSpan=n.formulaModule.formulaSpan,t.headNamePart=n.formulaModule.headNamePart,t.identNamePart=n.formulaModule.identNamePart,t.identQualifier=n.formulaModule.identQualifier,t.indexedArg=n.formulaModule.indexedArg,t.lambdaNode=n.formulaModule.lambdaNode,t.lambdaParam=n.formulaModule.lambdaParam,t.letNode=n.formulaModule.letNode,t.letVar=n.formulaModule.letVar,t.literalNode=n.formulaModule.literalNode,t.localNameDeclAnnotation=n.formulaModule.localNameDeclAnnotation,t.localNameUseAnnotation=n.formulaModule.localNameUseAnnotation,t.missingRef=n.formulaModule.missingRef,t.nameNode=n.formulaModule.nameNode,t.operatorNode=n.formulaModule.operatorNode,t.paramDefault=n.formulaModule.paramDefault,t.paramName=n.formulaModule.paramName,t.paramNode=n.formulaModule.paramNode,t.parenNode=n.formulaModule.parenNode,t.pos=n.formulaModule.pos,t.rangeOpRef=n.formulaModule.rangeOpRef,t.relativeQualifier=n.formulaModule.relativeQualifier,t.sheetQualifier=n.formulaModule.sheetQualifier,t.sheetRangeQualifier=n.formulaModule.sheetRangeQualifier,t.specialRef=n.formulaModule.specialRef,t.structRef=n.formulaModule.structRef,t.structRefNode=n.formulaModule.structRefNode,t.contextNameNode=n.formulaModule.contextNameNode,t.thisRowOpRef=n.formulaModule.thisRowOpRef,t.wsfNode=n.formulaModule.wsfNode,t.getDepthUpperBound=n.formulaModule.getDepthUpperBound,t.missingNode=n.formulaModule.missingNode,t.identNode=n.formulaModule.identNode,t.varNode=n.formulaModule.varNode,t.badCharsNode=n.formulaModule.badCharsNode,t.badSequenceNode=n.formulaModule.badSequenceNode},4468:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseUint=t.parseSignedLiteral=t.parseNumberLiteral=t.isLineBreak=t.isSpace=void 0;const n=r(81836);t.isSpace=n.literalParse.isSpace,t.isLineBreak=n.literalParse.isLineBreak,t.parseNumberLiteral=n.literalParse.parseNumberLiteral,t.parseSignedLiteral=n.literalParse.parseSignedLiteral,t.parseUint=n.literalParse.parseUint},1389:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userDefinedFuncLoc=t.unsafeGridRange=t.structRefColumnLoc=t.sheetRows=t.sheetRangeIndexes=t.sheetRange=t.sheetIndex=t.sheetGridRange=t.sheetGridCube=t.sheetGridCell=t.sheetCols=t.originCell=t.nameScope=t.nameLoc=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceRange=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceCell=t.isSheetIndex=t.isSheetGridRange=t.isSheetGridCell=t.isGridCell=t.gridRange=t.gridCell=t.documentScope=t.documentLoc=t.allSheetsRange=t.NameSource=t.LexicalKind=void 0;const n=r(81836);t.LexicalKind=n.location.LexicalKind,t.NameSource=n.location.NameSource,t.allSheetsRange=n.location.allSheetsRange,t.documentLoc=n.location.documentLoc,t.documentScope=n.location.documentScope,t.gridCell=n.location.gridCell,t.gridRange=n.location.gridRange,t.isGridCell=n.location.isGridCell,t.isSheetGridCell=n.location.isSheetGridCell,t.isSheetGridRange=n.location.isSheetGridRange,t.isSheetIndex=n.location.isSheetIndex,t.lexicalSourceCell=n.location.lexicalSourceCell,t.lexicalSourceGrid=n.location.lexicalSourceGrid,t.lexicalSourceName=n.location.lexicalSourceName,t.lexicalSourceRange=n.location.lexicalSourceRange,t.lexicalSourceWSF=n.location.lexicalSourceWSF,t.lexicalSourceUDF=n.location.lexicalSourceUDF,t.nameLoc=n.location.nameLoc,t.nameScope=n.location.nameScope,t.originCell=n.location.originCell,t.sheetCols=n.location.sheetCols,t.sheetGridCell=n.location.sheetGridCell,t.sheetGridCube=n.location.sheetGridCube,t.sheetGridRange=n.location.sheetGridRange,t.sheetIndex=n.location.sheetIndex,t.sheetRange=n.location.sheetRange,t.sheetRangeIndexes=n.location.sheetRangeIndexes,t.sheetRows=n.location.sheetRows,t.structRefColumnLoc=n.location.structRefColumnLoc,t.unsafeGridRange=n.location.unsafeGridRange,t.userDefinedFuncLoc=n.location.userDefinedFuncLoc},20493:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canDenoteCellRef=t.canDenoteUserDefinedFunc=t.canDenoteLocalName=t.resolveGridRef=t.createResolver=void 0;const n=r(81836);t.createResolver=n.resolveService.createResolver,t.resolveGridRef=n.resolveService.resolveGridRef,t.canDenoteLocalName=n.resolveService.canDenoteLocalName,t.canDenoteUserDefinedFunc=n.resolveService.canDenoteUserDefinedFunc,t.canDenoteCellRef=n.resolveService.canDenoteCellRef},20952:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedUserDefinedFunc=t.resolvedStructRef=t.resolvedNever=t.resolvedName=t.resolvedLocalName=t.resolvedDottedName=t.resolvedCellRef=t.resolveLocalsGrid=t.noOriginSheet=t.invalidStructRef=t.invalidQualifier=t.invalidCellRef=t.emptyIntersection=t.ResolvedKind=t.ResolveReasonKind=t.InvalidStructRefReason=t.InvalidQualifierReason=t.InvalidCellRefReason=void 0;const n=r(81836);t.InvalidCellRefReason=n.resolveServiceTypes.InvalidCellRefReason,t.InvalidQualifierReason=n.resolveServiceTypes.InvalidQualifierReason,t.InvalidStructRefReason=n.resolveServiceTypes.InvalidStructRefReason,t.ResolveReasonKind=n.resolveServiceTypes.ResolveReasonKind,t.ResolvedKind=n.resolveServiceTypes.ResolvedKind,t.emptyIntersection=n.resolveServiceTypes.emptyIntersection,t.invalidCellRef=n.resolveServiceTypes.invalidCellRef,t.invalidQualifier=n.resolveServiceTypes.invalidQualifier,t.invalidStructRef=n.resolveServiceTypes.invalidStructRef,t.noOriginSheet=n.resolveServiceTypes.noOriginSheet,t.resolveLocalsGrid=n.resolveServiceTypes.resolveLocalsGrid,t.resolvedCellRef=n.resolveServiceTypes.resolvedCellRef,t.resolvedDottedName=n.resolveServiceTypes.resolvedDottedName,t.resolvedLocalName=n.resolveServiceTypes.resolvedLocalName,t.resolvedName=n.resolveServiceTypes.resolvedName,t.resolvedNever=n.resolveServiceTypes.resolvedNever,t.resolvedStructRef=n.resolveServiceTypes.resolvedStructRef,t.resolvedUserDefinedFunc=n.resolveServiceTypes.resolvedUserDefinedFunc},64842:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unknownFunctionType=t.operatorStrings=t.higherOrderFunctionType=t.getWorksheetFuncType=t.getWorksheetFuncEnglishName=t.getOperatorType=t.WorksheetFuncId=t.OperatorId=void 0;const n=r(81836);t.OperatorId=n.signature.OperatorId,t.WorksheetFuncId=n.signature.WorksheetFuncId,t.getOperatorType=n.signature.getOperatorType,t.getWorksheetFuncEnglishName=n.signature.getWorksheetFuncEnglishName,t.getWorksheetFuncType=n.signature.getWorksheetFuncType,t.higherOrderFunctionType=n.signature.higherOrderFunctionType,t.operatorStrings=n.signature.operatorStrings,t.unknownFunctionType=n.signature.unknownFunctionType},21081:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.SpecialPrecs=t.SignatureType=t.OperKind=t.FunctionFlags=void 0;const n=r(81836);t.FunctionFlags=n.types.FunctionFlags,t.OperKind=n.types.OperKind,t.SignatureType=n.types.SignatureType,t.SpecialPrecs=n.types.SpecialPrecs,t.functionType=n.types.functionType},41118:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridRange=t.isSheetGridCellEqual=t.isSheetGridCell=t.isRichOper=t.isReadOperEqual=t.isRangeOper=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isPrimitiveOper=t.isOperatorNode=t.isNumberOper=t.isNumberLiteralNode=t.isNameScopeEqual=t.isMissingOper=t.isMissingLiteralNode=t.isMissingNode=t.isGridRangeEqual=t.isGridCellEqual=t.isGridCell=t.isErrorOper=t.isDocumentLocEqual=t.isCommaOpRefWellFormed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isBooleanOper=t.isBooleanLiteralNode=t.isBlankOper=t.isArrayOper=t.internal=t.gridRangesJoin=t.gridRangeSize=t.gridRangeJoinOpt=t.gridRangeJoin=t.gridRangeIsects=t.gridRangeIsect=t.gridRangeExcept=t.gridRangeCompare=t.gridRangeAnchor=t.gridCellRange=t.gridCellImplicitIsect=t.getWorksheetFuncId=t.getUserDefinedFuncName=t.getBoundName=t.getArguments=t.getArgType=t.forEachTileInRange=t.forEachCellInRange=t.createFailureErrorClass=t.ReasonKind=t.LangReasonKind=void 0,t.unavailable=t.shouldFieldRefBeBracketed=t.sheetGridRangeAnchor=t.notImplemented=t.normalizeCommaOpRef=t.isWriteOper=t.isWellFormed=t.isWSFNode=t.isValidArgsLength=t.isUnqualifiedNameNode=t.isStringOper=t.isSheetIndexEqual=t.isSheetIndex=t.isSheetGridRangeEqual=void 0;const n=r(81836);t.LangReasonKind=n.util.LangReasonKind,t.ReasonKind=n.util.ReasonKind,t.createFailureErrorClass=n.util.createFailureErrorClass,t.forEachCellInRange=n.util.forEachCellInRange,t.forEachTileInRange=n.util.forEachTileInRange,t.getArgType=n.util.getArgType,t.getArguments=n.util.getArguments,t.getBoundName=n.util.getBoundName,t.getUserDefinedFuncName=n.util.getUserDefinedFuncName,t.getWorksheetFuncId=n.util.getWorksheetFuncId,t.gridCellImplicitIsect=n.util.gridCellImplicitIsect,t.gridCellRange=n.util.gridCellRange,t.gridRangeAnchor=n.util.gridRangeAnchor,t.gridRangeCompare=n.util.gridRangeCompare,t.gridRangeExcept=n.util.gridRangeExcept,t.gridRangeIsect=n.util.gridRangeIsect,t.gridRangeIsects=n.util.gridRangeIsects,t.gridRangeJoin=n.util.gridRangeJoin,t.gridRangeJoinOpt=n.util.gridRangeJoinOpt,t.gridRangeSize=n.util.gridRangeSize,t.gridRangesJoin=n.util.gridRangesJoin,t.internal=n.util.internal,t.isArrayOper=n.util.isArrayOper,t.isBlankOper=n.util.isBlankOper,t.isBooleanLiteralNode=n.util.isBooleanLiteralNode,t.isBooleanOper=n.util.isBooleanOper,t.isCommaOpClosed=n.util.isCommaOpClosed,t.isCommaOpNoBadOrMissing=n.util.isCommaOpNoBadOrMissing,t.isCommaOpRefWellFormed=n.util.isCommaOpRefWellFormed,t.isDocumentLocEqual=n.util.isDocumentLocEqual,t.isErrorOper=n.util.isErrorOper,t.isGridCell=n.util.isGridCell,t.isGridCellEqual=n.util.isGridCellEqual,t.isGridRangeEqual=n.util.isGridRangeEqual,t.isMissingNode=n.util.isMissingNode,t.isMissingLiteralNode=n.util.isMissingLiteralNode,t.isMissingOper=n.util.isMissingOper,t.isNameScopeEqual=n.util.isNameScopeEqual,t.isNumberLiteralNode=n.util.isNumberLiteralNode,t.isNumberOper=n.util.isNumberOper,t.isOperatorNode=n.util.isOperatorNode,t.isPrimitiveOper=n.util.isPrimitiveOper,t.isRangeOpClosed=n.util.isRangeOpClosed,t.isRangeOpNoMissing=n.util.isRangeOpNoMissing,t.isRangeOper=n.util.isRangeOper,t.isReadOperEqual=n.util.isReadOperEqual,t.isRichOper=n.util.isRichOper,t.isSheetGridCell=n.util.isSheetGridCell,t.isSheetGridCellEqual=n.util.isSheetGridCellEqual,t.isSheetGridRange=n.util.isSheetGridRange,t.isSheetGridRangeEqual=n.util.isSheetGridRangeEqual,t.isSheetIndex=n.util.isSheetIndex,t.isSheetIndexEqual=n.util.isSheetIndexEqual,t.isStringOper=n.util.isStringOper,t.isUnqualifiedNameNode=n.util.isUnqualifiedNameNode,t.isValidArgsLength=n.util.isValidArgsLength,t.isWSFNode=n.util.isWSFNode,t.isWellFormed=n.util.isWellFormed,t.isWriteOper=n.util.isWriteOper,t.normalizeCommaOpRef=n.util.normalizeCommaOpRef,t.notImplemented=n.util.notImplemented,t.sheetGridRangeAnchor=n.util.sheetGridRangeAnchor,t.shouldFieldRefBeBracketed=n.util.shouldFieldRefBeBracketed,t.unavailable=n.util.unavailable},76457:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valueErrorOper=t.trueOper=t.stringOper=t.refErrorOper=t.rangeSeqOper=t.range3DOper=t.precedents=t.numErrorOper=t.nullErrorOper=t.nameErrorOper=t.naErrorOper=t.missingOper=t.gettingDataErrorOper=t.fieldErrorOper=t.falseOper=t.errorOper=t.div0ErrorOper=t.cellStringLimit=t.booleanOper=t.blankOper=t.arrayOper=t.PrecsBound=t.ErrorType=void 0;const n=r(81836);t.ErrorType=n.value.ErrorType,t.PrecsBound=n.value.PrecsBound,t.arrayOper=n.value.arrayOper,t.blankOper=n.value.blankOper,t.booleanOper=n.value.booleanOper,t.cellStringLimit=n.value.cellStringLimit,t.div0ErrorOper=n.value.div0ErrorOper,t.errorOper=n.value.errorOper,t.falseOper=n.value.falseOper,t.fieldErrorOper=n.value.fieldErrorOper,t.gettingDataErrorOper=n.value.gettingDataErrorOper,t.missingOper=n.value.missingOper,t.naErrorOper=n.value.naErrorOper,t.nameErrorOper=n.value.nameErrorOper,t.nullErrorOper=n.value.nullErrorOper,t.numErrorOper=n.value.numErrorOper,t.precedents=n.value.precedents,t.range3DOper=n.value.range3DOper,t.rangeSeqOper=n.value.rangeSeqOper,t.refErrorOper=n.value.refErrorOper,t.stringOper=n.value.stringOper,t.trueOper=n.value.trueOper,t.valueErrorOper=n.value.valueErrorOper},28694:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zipVisitor=t.voidVisitor=t.visitWSFNode=t.visitQualifier=t.visitOperatorNode=t.visitFormulaNode=t.visitCellRef=t.visitAppHeadNode=t.reduceTopDown_Pledge=t.reducePledge=t.reduceBottomUp_Recursive=t.reduceBottomUp_Pledge=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_CPS=t.reduceBottomUp=t.identityVisitor=t.depthVisitor=t.constVisitor=t.composeVisitor=t.bindVisitor=t.binaryVisitor=t.ZipVisitor=t.PledgeReducer=t.IdentityVisitor=t.DelegatingVisitor=t.ConstVisitor=t.ComposeVisitor=t.BinaryVisitor=void 0;const n=r(81836);t.BinaryVisitor=n.visitor.BinaryVisitor,t.ComposeVisitor=n.visitor.ComposeVisitor,t.ConstVisitor=n.visitor.ConstVisitor,t.DelegatingVisitor=n.visitor.DelegatingVisitor,t.IdentityVisitor=n.visitor.IdentityVisitor,t.PledgeReducer=n.visitor.PledgeReducer,t.ZipVisitor=n.visitor.ZipVisitor,t.binaryVisitor=n.visitor.binaryVisitor,t.bindVisitor=n.visitor.bindVisitor,t.composeVisitor=n.visitor.composeVisitor,t.constVisitor=n.visitor.constVisitor,t.depthVisitor=n.visitor.depthVisitor,t.identityVisitor=n.visitor.identityVisitor,t.reduceBottomUp=n.visitor.reduceBottomUp,t.reduceBottomUp_CPS=n.visitor.reduceBottomUp_CPS,t.reduceBottomUp_MaxDepth=n.visitor.reduceBottomUp_MaxDepth,t.reduceBottomUp_Pledge=n.visitor.reduceBottomUp_Pledge,t.reduceBottomUp_Recursive=n.visitor.reduceBottomUp_Recursive,t.reducePledge=n.visitor.reducePledge,t.reduceTopDown_Pledge=n.visitor.reduceTopDown_Pledge,t.visitAppHeadNode=n.visitor.visitAppHeadNode,t.visitCellRef=n.visitor.visitCellRef,t.visitFormulaNode=n.visitor.visitFormulaNode,t.visitOperatorNode=n.visitor.visitOperatorNode,t.visitQualifier=n.visitor.visitQualifier,t.visitWSFNode=n.visitor.visitWSFNode,t.voidVisitor=n.visitor.voidVisitor,t.zipVisitor=n.visitor.zipVisitor},45873:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBracketedTokens=t.parseIdentContinue=t.parseEnd=t.parseEscape=t.parseAtOp=t.parseRangeOp=t.parseDotSepTokenNotFollowedByLeftBracket=t.parseRightBracket=t.parseLeftBracket=t.parseRightSQuote=t.parseLeftSQuote=t.parseRightBrace=t.parseLeftBrace=t.parseRightParen=t.parseLeftParen=t.parseAssignToken=t.parseDotSepToken=t.parseQualSep=t.parseColSep=t.parseRowSep=t.parseListSep=t.parseCharIndex=t.parseSpacesOnly=t.parseWhitespace=t.isWhitespaceToken=t.isCommentToken=t.isBracketToken=t.isRightBracketToken=t.isLeftBracketToken=t.isRefErrorToken=t.isAtOpToken=t.isRangeOpToken=t.isListSepToken=t.isDotSepToken=void 0;const n=r(54741),i=r(65556),o=r(76457),a=r(64842),s=r(59590),l=r(97892),u=r(21081);function c(e){return e.kind===s.TokenKind.Sep&&e.value===s.SepId.Dot}function d(e){return e.kind===s.TokenKind.Operator&&e.value===a.OperatorId.Range}function m(e){return e.kind===s.TokenKind.Operator&&e.value===a.OperatorId.At}function g(e){return e.kind===s.TokenKind.Left&&e.value===s.DelimId.Bracket}function p(e){return(e.kind===s.TokenKind.Left||e.kind===s.TokenKind.Right)&&e.value===s.DelimId.Bracket}function h(e){return e.kind===s.TokenKind.Spaces||e.kind===s.TokenKind.SingleLineComment||e.kind===s.TokenKind.MultiLineComment}function f(e){return(0,l.take)(((t,r)=>r.kind===s.TokenKind.Sep&&r.value===e?r:void 0))}function S(e){return(0,l.take)(((t,r)=>r.kind===s.TokenKind.Left&&r.value===e?r:void 0))}function v(e){return(0,l.take)(((t,r)=>r.kind===s.TokenKind.Right&&r.value===e?r:void 0))}t.isDotSepToken=c,t.isListSepToken=function(e){return e.kind===s.TokenKind.Sep&&e.value===s.SepId.List},t.isRangeOpToken=d,t.isAtOpToken=m,t.isRefErrorToken=function(e){return e.kind===s.TokenKind.Literal&&e.oper.kind===u.OperKind.Error&&e.oper.type===o.ErrorType.REF},t.isLeftBracketToken=g,t.isRightBracketToken=function(e){return e.kind===s.TokenKind.Right&&e.value===s.DelimId.Bracket},t.isBracketToken=p,t.isCommentToken=function(e){return e.kind===s.TokenKind.SingleLineComment||e.kind===s.TokenKind.MultiLineComment},t.isWhitespaceToken=h,t.parseWhitespace=(0,l.many)((0,l.take)(((e,t)=>h(t)?t:void 0))),t.parseSpacesOnly=(0,l.opt)((0,l.take)(((e,t)=>t.kind===s.TokenKind.Spaces?t.chars:void 0)),""),t.parseCharIndex=function(e,t,r,o,a){const s=e[t];if(null==s){const r=`calc.parse.pStart: internal error: expected token at ${t} in ${(0,n.anonymize)(e)}`;return(0,i.assertFalse)(r)}return o(s.start,t)},t.parseListSep=f(s.SepId.List),t.parseRowSep=f(s.SepId.Row),t.parseColSep=f(s.SepId.Col),t.parseQualSep=f(s.SepId.Qual),t.parseDotSepToken=f(s.SepId.Dot),t.parseAssignToken=f(s.SepId.Assign),t.parseLeftParen=S(s.DelimId.Paren),t.parseRightParen=v(s.DelimId.Paren),t.parseLeftBrace=S(s.DelimId.Brace),t.parseRightBrace=v(s.DelimId.Brace),t.parseLeftSQuote=S(s.DelimId.SQuote),t.parseRightSQuote=v(s.DelimId.SQuote),t.parseLeftBracket=S(s.DelimId.Bracket),t.parseRightBracket=v(s.DelimId.Bracket),t.parseDotSepTokenNotFollowedByLeftBracket=(0,l.takePeek)(((e,t,r)=>c(t)&&!g(r)?t:void 0)),t.parseRangeOp=(0,l.take)(((e,t)=>d(t)?t:void 0)),t.parseAtOp=(0,l.take)(((e,t)=>m(t)?t:void 0)),t.parseEscape=(0,l.take)(((e,t)=>t.kind===s.TokenKind.Escape?t:void 0)),t.parseEnd=(0,l.take)(((e,t)=>t.kind===s.TokenKind.End?t:void 0)),t.parseIdentContinue=(0,l.apply)((0,l.many1)((0,l.take)(((e,t)=>t.isIdentContinue?t:void 0))),((e,t)=>{const r=t[0];return 1===t.length?r:(0,s.identToken)(r.start,t.map((e=>e.chars)).join(""))}));const y=(0,l.take)(((e,t)=>p(t)||t.kind===s.TokenKind.End?void 0:t)),F=(0,l.lazy)((()=>(0,l.flatten)((0,l.many)((0,l.any)((0,l.many1)(y),(0,l.concat)((0,l.tuple)(t.parseLeftBracket),F,(0,l.opt)((0,l.tuple)(t.parseRightBracket),[])))))));t.parseBracketedTokens=(0,l.apply)((0,l.tuple)(t.parseLeftBracket,F,t.parseCharIndex,(0,l.opt)(t.parseRightBracket,void 0)),((e,[t,r,n,i])=>(r.push((0,s.endToken)(n)),[r,void 0!==i])))},85593:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFieldRef=t.isUnbracketedField=void 0;const n=r(19181),i=r(43162),o=r(59590),a=r(97892),s=r(46347),l=r(679),u=r(45873),c=r(33392),d=r(2910),m=n.__importStar(r(15964)),{codePointQuestionMark:g,codePointBackslash:p,codePointUnderscore:h}=m;function f(e,t){if(0===t.length)return!1;const r=(0,d.stringCodePointAt)(t,0);return!((n=r)===h||n===p||!e.isIdentStart(n)&&!e.isNumeral(n))&&(0,d.codePointIterator)(t,(0,d.numCodeUnits)(r)).every((function(t){return t!==g&&t!==p&&e.isIdentContinue(t)}));var n}t.isUnbracketedField=f;const S=(0,a.take)(((e,t)=>(0,u.isBracketToken)(t)||t.kind===o.TokenKind.Escape||t.kind===o.TokenKind.End?void 0:t.chars)),v=(0,a.take)(((e,t)=>t.kind!==o.TokenKind.Ident||t.chars!==e.localeInfo.leftBracket&&t.chars!==e.localeInfo.rightBracket&&"'"!==t.chars?void 0:t.chars)),y=(0,a.any)(S,(0,a.right)(u.parseEscape,v)),F=(0,a.apply)((0,a.tuple)((0,a.many)(y),u.parseEnd),((e,[t,r])=>t.join(""))),C=(0,a.applyTake)(u.parseBracketedTokens,((e,[t,r])=>{const n=(0,a.runParser)(F,t,0,e);if(!(0,c.isSuccess)(n))return;const o=t[0].start,s=t[t.length-1].start,u=n.value.output;if(u.length>255){const r=t.map((e=>e.chars)).join("");return[(0,i.badCharsNode)(i.BadType.FieldName,r,(0,l.addSpan)(e,o,s,"","")),!1,!0]}return[(0,i.identNode)(u,(0,l.addSpan)(e,o,s,"","")),!0,r]})),R=(0,a.apply)(u.parseIdentContinue,((e,t)=>{const r=t.start,n=t.start+t.chars.length;return!f(e.localeInfo,t.chars)||t.chars.length>255?[(0,i.badCharsNode)(i.BadType.FieldName,t.chars,(0,l.addSpan)(e,r,n,"","")),!1,!0]:[(0,i.identNode)(t.chars,(0,l.addSpan)(e,r,n,"","")),!1,!0]}));t.parseFieldRef=(0,a.apply)((0,a.tuple)(u.parseCharIndex,u.parseWhitespace,u.parseDotSepToken,(0,a.any)(R,C),u.parseCharIndex),((e,[t,r,n,[o,a,u],c])=>{const d=(0,l.addSpan)(e,n.start,c,r,""),m=(0,i.fieldRef)(o,a,u,!1,d);return(0,s.fieldRefTerm)(r.length>0,m,t,c)}))},21236:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSpParam=t.runFormulaParser=t.parseFormula=void 0;const n=r(54741),i=r(65556),o=r(43162),a=r(43162),s=r(64842),l=r(59590),u=r(97892),c=r(46347),d=r(679),m=r(45873),g=r(13711),p=r(60353),h=r(85593),f=r(50628),S=r(33392),v=r(3222),y=r(2910),F=r(57777),C=r(50591),R=r(82993),b=r(41118),E=r(76457),T=(0,u.apply)((0,u.tuple)(m.parseWhitespace,(0,u.lazy)((()=>t.parseFormula)),m.parseWhitespace),((e,[t,r,n])=>{const o=(0,d.getNodeSpan)(e,r);return(0,i.assertTrue)("calc.parse.parseSpFormula",!(o.pre.length>0&&t.length>0)),(0,i.assertTrue)("calc.parse.parseSpFormula",!(o.post.length>0&&n.length>0)),t.length>0&&([o.pre,o.preComments]=(0,d.addWhitespace)(e,t)),n.length>0&&([o.post,o.postComments]=(0,d.addWhitespace)(e,n)),r})),k=(0,u.apply)((0,u.tuple)(m.parseLeftParen,(0,d.withDelim)({delimId:l.DelimId.Paren,listSep:d.ListSep.Union},T),(0,u.opt)(m.parseRightParen,void 0),m.parseCharIndex),((e,[t,r,n,i])=>(0,o.parenNode)(r,void 0!==n,(0,d.addSpan)(e,t.start,i,"","")))),P=(0,u.many1)(T,(0,u.right)(m.parseColSep,T)),N=(0,u.many1)(P,(0,u.right)(m.parseRowSep,P)),A=(0,u.apply)((0,u.tuple)(m.parseLeftBrace,(0,d.withDelim)({delimId:l.DelimId.Brace,listSep:d.ListSep.Union},N),(0,u.opt)(m.parseRightBrace,void 0),m.parseCharIndex),((e,[t,r,n,i])=>(0,o.arrayNode)(r,void 0!==n,(0,d.addSpan)(e,t.start,i,"",""))));function I(e){return(0,u.takePeek)(((t,r,n)=>e(r)?(0,o.badCharsNode)(o.BadType.Unexpected,r.chars,(0,d.addSpan)(t,r.start,n.start,"","")):void 0))}const O=(0,u.apply)((0,u.tuple)(m.parseCharIndex,I(m.isLeftBracketToken),(0,d.withDelim)({delimId:l.DelimId.Bracket,listSep:d.ListSep.Union},T),(0,u.opt)(I(m.isRightBracketToken),void 0),m.parseCharIndex),((e,[t,r,n,i,a])=>{const s=[r,n];return null!=i&&s.push(i),(0,o.badSequenceNode)(o.BadType.Unexpected,s,(0,d.addSpan)(e,t,a,"",""))})),_=(0,u.takePeek)(((e,t,r)=>{switch(t.kind){case l.TokenKind.End:case l.TokenKind.Operator:case l.TokenKind.Spaces:case l.TokenKind.SingleLineComment:case l.TokenKind.MultiLineComment:return;case l.TokenKind.Sep:if(t.value===l.SepId.Dot)return;if(t.value===l.SepId.Qual||t.value===l.SepId.Assign)break;if(e.delim.delimId===l.DelimId.Brace||t.value!==l.SepId.Col&&t.value!==l.SepId.Row)return;break;case l.TokenKind.Right:if(t.value!==l.DelimId.SQuote&&e.delim.stack[t.value])return}return(0,o.badCharsNode)(o.BadType.Unexpected,t.chars,(0,d.addSpan)(e,t.start,r.start,"",""))})),M=(0,u.any)(g.parseRef,p.parseLiteral,k,A,h.parseFieldRef,f.parseStructRef,O,g.parseUnqualBadRef,_);function D(e){return(0,u.tuple)(m.parseLeftParen,(0,d.withDelim)({delimId:l.DelimId.Paren,listSep:d.ListSep.Arg},(0,u.apply)((0,u.many1)(e,(0,u.right)(m.parseListSep,e)),((e,t)=>t.map((e=>e.kind===o.NodeKind.Missing?(0,o.literalNode)(E.missingOper,!0,e.label):e))))),(0,u.opt)(m.parseRightParen,void 0),m.parseCharIndex)}const w=(0,u.apply)(D(T),((e,[t,r,n,i])=>(0,c.argsTerm)(r,void 0!==n,t.start,i))),L=(0,u.apply)(D((0,u.any)((0,u.lazy)((()=>t.parseSpParam)),T)),((e,[t,r,n,i])=>(0,c.lambdaArgsTerm)(r,void 0!==n,t.start,i))),x=(0,u.take)(((e,t)=>t.kind!==l.TokenKind.Operator||t.value!==s.OperatorId.Percent&&t.value!==s.OperatorId.Pound?void 0:t)),K=(0,u.take)(((e,t)=>t.kind===l.TokenKind.Operator||(0,m.isDotSepToken)(t)?t:function(e,t){return t.kind===l.TokenKind.Sep&&t.value===l.SepId.List&&e.delim.listSep===d.ListSep.Union?(0,l.operatorToken)(t.start,e.localeInfo.listSeparator,s.OperatorId.Union):void 0}(e,t))),U=(0,u.many)((0,u.take)(((e,t)=>(0,m.isWhitespaceToken)(t)?t:void 0))),B=(0,u.any)((0,u.concat)((0,u.bind)((0,u.any)(M,x),((e,t)=>{const r=(0,c.isWSFNode)(e.localeInfo,t);return(null==r?void 0:r.id)===s.WorksheetFuncId.LAMBDA?(0,u.concat)((0,u.parseSucceed)([t]),(0,u.opt)((0,u.tuple)(L),[])):(0,u.parseSucceed)([t])})),(0,u.many)((0,u.any)(w,h.parseFieldRef,f.parseStructRef))),(0,u.tuple)(K)),G=(0,u.flatten)((0,u.many1)(B,(0,u.concat)(U,B)));t.parseFormula=(0,u.apply)((0,u.tuple)((0,u.opt)(G,void 0),m.parseCharIndex),((e,[t,r])=>{if(null==t){const t=(0,d.addSpan)(e,r,r,"","");return(0,o.missingNode)("",t)}const n=t;return n.push((0,l.endToken)(r)),(0,c.runOperatorPrecedenceParser)(e,n)})),t.runFormulaParser=function(e,t,r,s,c,m,g,p){const h=p.length-1;if(h<0){const e="calc.parse.runTokenParser: internal error: expected at least 1 token";return(0,i.assertFalse)(e)}if(p[h].kind!==l.TokenKind.End){const e=`calc.parse.runTokenParser: internal error: array[n] !== End in ${(0,n.anonymize)(p)}`;return(0,i.assertFalse)(e)}const f=(0,d.makeState)(e,t,r,s,c),y=(0,u.runParser)(T,p,0,f);if(!(0,S.isSuccess)(y)||y.value.index<h){const e=`calc.parse.runTokenParser: internal error: consumed ${(0,S.isSuccess)(y)?y.value.index:0} out of ${h} in ${(0,n.anonymize)(p)}`;return(0,i.assertFalse)(e)}const F=y.value.output,C=f.spans,R=(0,v.buildAnnotations)(e,F,m,void 0===g?void 0:{[a.SyntaxFeature.Comments]:!0===g[a.SyntaxFeature.Comments],[a.SyntaxFeature.Statements]:!0===g[a.SyntaxFeature.Statements]});return(0,o.formula)(F,C,R)};const{codePointFullStop:W}=F.codePoint,V=(0,u.apply)((0,u.many1)((0,u.take)(((e,t)=>t.isIdentContinue||(0,m.isDotSepToken)(t)?t:void 0))),((e,t)=>{const r=t[0].start,n=t.map((e=>e.chars)).join(""),i=(0,d.addSpan)(e,r,r+n.length,"","");return function(e,t){if(!e.localeInfo.isIdentStart((0,y.stringCodePointAt)(t,0)))return!1;if(!(0,y.codePointIterator)(t).every((t=>t===W||e.localeInfo.isIdentContinue(t))))return!1;const r=(0,C.parseCellRef)(e.localeInfo,e.refStyle,e.origin,t,0);if(void 0!==r&&r.i===t.length){const n=r.refStyle===o.RefStyle.A1?(0,l.cellRefA1Token)(0,t,r.row,r.col):(0,l.cellRefR1C1Token)(0,t,r.row,r.col,r.enLocale);if((0,g.isCompleteCellRefToken)(e,n))return!1}return!0}(e,n)?(0,o.identNode)(n,i):(0,o.badCharsNode)(o.BadType.ParamName,n,i)})),j=(0,u.applyTake)((0,u.tuple)(m.parseCharIndex,m.parseLeftBracket,m.parseCharIndex,m.parseSpacesOnly,(0,u.opt)(V,void 0),m.parseSpacesOnly,m.parseCharIndex,(0,u.opt)(m.parseRightBracket,void 0),m.parseCharIndex),((e,[t,r,n,i,a,s,l,u,c])=>{if(void 0!==a){const t=(0,d.getNodeSpan)(e,a);t.pre=i,t.post=s}const m=null!=a?a:(0,o.missingNode)(i+s,(0,d.addSpan)(e,n,l,"",""));return(0,o.paramName)(m,!0,void 0!==u,(0,d.addSpan)(e,t,c,"",""))})),q=(0,u.applyTake)((0,u.tuple)(m.parseCharIndex,g.parseRef,m.parseCharIndex),((e,[t,r,n])=>{const i=r.kind===c.TermKind.MaybeWSFTerm?r.node:r;if((0,b.isUnqualifiedNameNode)(i))return(0,o.paramName)((0,o.identNode)(i.whole,i.label),!1,!0,(0,d.addSpan)(e,t,n,"",""))})),H=(0,u.apply)((0,u.tuple)(m.parseWhitespace,m.parseCharIndex,m.parseAssignToken,m.parseWhitespace,(0,u.lazy)((()=>t.parseFormula)),m.parseCharIndex),((e,[t,r,n,i,a,s])=>{const l=(0,d.getNodeSpan)(e,a);return[l.pre,l.preComments]=(0,d.addWhitespace)(e,i),(0,o.paramDefault)(a,(0,d.addSpan)(e,r,s,t,""))})),z=(0,u.lazy)((()=>(0,R.isFeatureEnabled)(R.FeatureName.CalcLambdaDefaultParameters)?H:(0,u.parseFail)()));t.parseSpParam=(0,u.applyTake)((0,u.tuple)(m.parseWhitespace,m.parseCharIndex,(0,u.bind)((0,u.any)(q,j),((e,t)=>t.isClosed?(0,u.apply)((0,u.opt)(z,void 0),((e,r)=>[t,r])):(0,u.parseSucceed)([t,void 0]))),m.parseCharIndex,m.parseWhitespace,(0,u.peek)(((e,t)=>t))),((e,[t,r,[n,i],a,s,u])=>{if(void 0!==i||u.kind===l.TokenKind.End&&n.isBracketed||(0,m.isListSepToken)(u)&&n.isClosed)return(0,o.paramNode)(n,i,(0,d.addSpan)(e,r,a,t,s))}))},60353:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseLiteral=void 0;const n=r(43162),i=r(59590),o=r(97892),a=r(46347),s=r(679),l=r(45873),u=r(76457),c=r(41118),d=r(21081),m=(0,o.take)(((e,t)=>t.kind===i.TokenKind.Literal&&t.oper.kind!==d.OperKind.Boolean?t:t.kind===i.TokenKind.CellRef&&function(e){return e.refStyle===n.RefStyle.A1&&null==e.col&&"object"==typeof e.row&&e.row.kind===n.PosKind.Rel}(t)?(0,i.literalToken)(t.start,t.chars,e.mathpack.fromNumber(t.row.index+e.origin.row+1)):void 0)),g=(0,o.take)(((e,t)=>t.kind===i.TokenKind.Literal&&t.oper.kind===d.OperKind.Boolean?t:void 0));t.parseLiteral=(0,o.apply)((0,o.tuple)((0,o.any)(m,(0,o.left)(g,(0,o.fails)(l.parseDotSepTokenNotFollowedByLeftBracket))),l.parseCharIndex),((e,[t,r])=>{const o=(0,s.addSpan)(e,t.start,r,"","");if((0,i.isBadNumberOper)(t.oper))return(0,n.badCharsNode)(n.BadType.NumberLiteral,t.chars,o);if((0,i.isBadErrorOper)(t.oper))return(0,n.badCharsNode)(n.BadType.ErrorLiteral,t.chars,o);if((0,c.isStringOper)(t.oper)&&t.oper.value.length>u.cellStringLimit)return(0,n.badCharsNode)(n.BadType.StringLiteral,t.chars,o);const l=(0,n.literalNode)(t.oper,t.hasRight,o);return(0,c.isBooleanOper)(t.oper)?(0,a.maybeWSFTerm)(l,t.chars):l}))},46347:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runOperatorPrecedenceParser=t.isWSFNode=t.maybeWSFTerm=t.structRefTerm=t.fieldRefTerm=t.argsTerm=t.lambdaArgsTerm=t.TermKind=void 0;const n=r(54741),i=r(65556),o=r(43162),a=r(64842),s=r(59590),l=r(97892),u=r(679),c=r(41118),d=r(45873),m=r(33392),g=r(82993),p=r(21081);var h;function f(e,t,r,n){return{kind:h.FieldRefTerm,hasDotPreSpace:e,rhs:t,start:r,end:n}}function S(e){return e.kind!==s.TokenKind.Operator&&e.kind!==s.TokenKind.Sep&&e.kind!==s.TokenKind.End&&e.kind!==s.TokenKind.Spaces&&e.kind!==s.TokenKind.SingleLineComment&&e.kind!==s.TokenKind.MultiLineComment&&!(e.kind in h)}function v(e){return e.kind===s.TokenKind.Spaces||e.kind===s.TokenKind.SingleLineComment||e.kind===s.TokenKind.MultiLineComment}function y(e,t){return S(t=t.kind===h.MaybeWSFTerm?t.node:t)?(0,u.getNodeSpan)(e,t).start:t.start}!function(e){e.LambdaArgsTerm="LambdaArgsTerm",e.ArgsTerm="ArgsTerm",e.FieldRefTerm="FieldRefTerm",e.StructRefTerm="StructRefTerm",e.MaybeWSFTerm="MaybeWSFTerm"}(h||(t.TermKind=h={})),t.lambdaArgsTerm=function(e,t,r,n){return{kind:h.LambdaArgsTerm,nodes:e,isClosed:t,start:r,end:n}},t.argsTerm=function(e,t,r,n){return{kind:h.ArgsTerm,nodes:e,isClosed:t,start:r,end:n}},t.fieldRefTerm=f,t.structRefTerm=function(e,t,r){return{kind:h.StructRefTerm,rhs:e,start:t,end:r}},t.maybeWSFTerm=function(e,t){return{kind:h.MaybeWSFTerm,node:e,whole:t}};const F=(0,l.many)((0,l.take)(((e,t)=>v(t)?t:void 0))),C=(0,l.many1)((0,l.take)(((e,t)=>v(t)?t:void 0))),R=(0,l.peek)(((e,t)=>t)),b=function(e,t,r,o,a){const s=e[t];if(null==s){const r=`calc.parse.pStart: internal error: expected term at ${t} in ${(0,n.anonymize)(e)}`;return(0,i.assertFalse)(r)}return o(y(r,s),t)};function E(e){return(0,l.apply)((0,l.tuple)(F,b,(0,l.take)(e),b,F),((e,[t,r,n,i,a])=>(0,o.operatorNode)(n,(0,u.addSpan)(e,r,i,t,a))))}function T(e){return(0,l.apply)((0,l.tuple)(F,b,(0,l.take)(e),b),((e,[t,r,n,i])=>(0,o.operatorNode)(n,(0,u.addSpan)(e,r,i,t,""))))}function k(e){return(0,l.apply)((0,l.tuple)(b,(0,l.take)(e),b,F),((e,[t,r,n,i])=>(0,o.operatorNode)(r,(0,u.addSpan)(e,t,n,"",i))))}const P=E(((e,t)=>t.kind!==s.TokenKind.Operator||t.value!==a.OperatorId.Add&&t.value!==a.OperatorId.Sub?void 0:t.value)),N=k(((e,t)=>{if(t.kind===s.TokenKind.Operator){if(t.value===a.OperatorId.Add)return a.OperatorId.Pos;if(t.value===a.OperatorId.Sub)return a.OperatorId.Neg}})),A=k(((e,t)=>t.kind===s.TokenKind.Operator&&t.value===a.OperatorId.At?t.value:void 0)),I=T(((e,t)=>t.kind===s.TokenKind.Operator&&t.value===a.OperatorId.Pound?t.value:void 0)),O=(0,l.take)(((e,t)=>t.kind===h.StructRefTerm?t:void 0)),_=E(((e,t)=>t.kind!==s.TokenKind.Operator||t.value!==a.OperatorId.Mul&&t.value!==a.OperatorId.Div?void 0:t.value)),M=E(((e,t)=>t.kind===s.TokenKind.Operator&&t.value===a.OperatorId.Pow?t.value:void 0)),D=T(((e,t)=>t.kind===s.TokenKind.Operator&&t.value===a.OperatorId.Percent?t.value:void 0)),w=E(((e,t)=>t.kind===s.TokenKind.Operator&&t.value===a.OperatorId.Concat?t.value:void 0)),L=E(((e,t)=>t.kind===s.TokenKind.Operator&&t.value>=a.OperatorId.Eq&&t.value<=a.OperatorId.Ge?t.value:void 0)),x=E(((e,t)=>t.kind===s.TokenKind.Operator&&t.value===a.OperatorId.Range?t.value:void 0)),K=E(((e,t)=>t.kind===s.TokenKind.Operator&&t.value===a.OperatorId.Union?t.value:void 0)),U=(0,l.applyTake)((0,l.tuple)(C,R),((e,[t,r])=>{if(!(r.kind===s.TokenKind.End||r.kind===s.TokenKind.Operator&&r.value!==a.OperatorId.At||r.kind===s.TokenKind.Sep&&(0,d.isDotSepToken)(r))){if(1!==t.length||t[0].kind!==s.TokenKind.Spaces)return t;const n=y(e,r),i=(0,u.addSpan)(e,n,n,t[0].chars,"");return(0,o.operatorNode)(a.OperatorId.Isect,i)}})),B=(0,l.take)(((e,t)=>t.kind===s.TokenKind.Sep&&(0,d.isDotSepToken)(t)?t:void 0)),G=(0,l.take)(((e,t)=>t.kind===h.ArgsTerm?t:void 0)),W=(0,l.take)(((e,t)=>t.kind===h.LambdaArgsTerm?t:void 0)),V=(0,l.take)(((e,t)=>t.kind===h.ArgsTerm||t.kind===h.FieldRefTerm?t:void 0)),j={[a.WorksheetFuncId.LETREC]:g.FeatureName.CalcLetRecFunction};function q(e,t){if(t.kind===h.MaybeWSFTerm&&void 0!==t.whole){const r=(0,c.getWorksheetFuncId)(e,t.whole);if(void 0===r)return;if((0,i.assertTrue)("calc.parse.parseWSFName: unexpected UDF",r!==a.WorksheetFuncId._UDF),0!=((0,a.getWorksheetFuncType)(r).flags&p.FunctionFlags.Internal))return;const n=j[r];if(void 0!==n&&!(0,g.isFeatureEnabled)(n))return;return(0,o.wsfNode)(r,t.whole,t.node.label)}}t.isWSFNode=q;const H=(0,l.take)(((e,t)=>q(e.localeInfo,t))),z=(0,l.take)(((e,t)=>{const r=q(e.localeInfo,t);return(null==r?void 0:r.id)===a.WorksheetFuncId.LAMBDA?r:void 0})),$=(0,l.apply)((0,l.tuple)(z,W),((e,[t,r])=>{const n=(0,u.getNodeSpan)(e,t).start,i=r.nodes,a=(t.id,[]);let s;const l=[];for(let e=0;e<i.length;e+=1){const t=i[e];t.kind===o.NodeKind.Param?a.push((0,o.lambdaParam)((0,o.indexedArg)(t,e))):e===i.length-1?s=(0,o.indexedArg)(t,e):l.push((0,o.indexedArg)(t,e))}const c=(0,u.addSpan)(e,n,r.end,"","");return(0,o.lambdaNode)(t,a,s,l,r.isClosed,c)})),Q=(0,l.apply)((0,l.tuple)(H,G),((e,[t,r])=>{const n=(0,u.getNodeSpan)(e,t).start,s=r.nodes;switch(t.id){case a.WorksheetFuncId.LET:case a.WorksheetFuncId.LETREC:{t.id;const i=[],a=[];let m;for(let t=0;t<s.length;t+=1){const r=s[t];t!==s.length-1?!(t+1<s.length&&(0,c.isUnqualifiedNameNode)(r))||t+3<s.length&&(l=e.refStyle,d=s[t+2],!((0,c.isUnqualifiedNameNode)(d)||l===o.RefStyle.A1&&d.kind===o.NodeKind.CellRef&&void 0===d.qualifier&&d.ref.kind===o.CellRefKind.Single&&d.ref.col.kind===o.PosKind.Rel&&d.ref.row.kind===o.PosKind.Rel))&&(0,c.isUnqualifiedNameNode)(s[t+1])?a.push((0,o.indexedArg)(r,t)):(i.push((0,o.letVar)((0,o.indexedArg)((0,o.varNode)((0,o.identNode)(r.whole,r.parts.label),r.label),t),(0,o.indexedArg)(s[t+1],t+1))),t+=1):m=(0,o.indexedArg)(r,t)}const g=(0,u.addSpan)(e,n,r.end,"","");return(0,o.letNode)(t,i,m,a,r.isClosed,g)}case a.WorksheetFuncId.LAMBDA:return(0,i.assertFalse)("calc.parse.parseWSFApp: unexpected LAMBDA+ArgTerm")}var l,d;return Z(e,t,s,r.isClosed,n,r.end)}));function Y(e,t,r){return(0,l.apply)((0,l.tuple)((0,l.many)(e),t),((e,[t,n])=>t.reduceRight(r(e),n)))}function J(e,t,r){return(0,l.apply)((0,l.tuple)(e,(0,l.many)(t)),((e,[t,n])=>n.reduce(r(e),t)))}function X(e){return(t,[r,n])=>{if(a=r,Array.isArray(a)){const a=(0,u.getNodeSpan)(e,t);(0,i.assertTrue)("calc.parse.makeAppNodeInfix",0===a.post.length),[a.post,a.postComments]=(0,u.addWhitespace)(e,r);const s=(0,u.getNodeSpan)(e,n),l=(0,u.addSpan)(e,a.start,s.end,"","");return(0,o.badSequenceNode)(o.BadType.Unexpected,[t,n],l)}var a;const s=(0,u.getNodeSpan)(e,t).start,l=(0,u.getNodeSpan)(e,n).end,c=(0,u.addSpan)(e,s,l,"","");return(0,o.appNode)(r,[t,n],!0,c)}}function Z(e,t,r,n,i,a){const s=(0,u.addSpan)(e,i,a,"","");return(0,o.appNode)(t,r,n,s)}function ee(e){return(t,r)=>{const n=(0,u.getNodeSpan)(e,t).start;switch(r.kind){case h.ArgsTerm:return Z(e,t,r.nodes,r.isClosed,n,r.end);case h.FieldRefTerm:{const i=(0,u.addSpan)(e,n,r.end,"",""),{start:a,end:s,pre:l}=(0,u.getNodeSpan)(e,r.rhs);if((0,c.isNumberLiteralNode)(t)){const n=(0,u.addSpan)(e,a,a,"",""),l=(0,o.missingNode)("",n),c=r.rhs.label,d=(0,u.addSpan)(e,a,s,"",""),m=!1,g=(0,o.fieldRef)(r.rhs.field,r.rhs.isBracketed,r.rhs.isClosed,m,d);return(0,o.badSequenceNode)(o.BadType.FieldRef,[t,(0,o.fieldRefNode)(l,g,c)],i)}const d=!r.rhs.isBracketed&&(0,c.shouldFieldRefBeBracketed)(t,r.rhs,l),m=(0,o.fieldRef)(r.rhs.field,r.rhs.isBracketed,r.rhs.isClosed,d,r.rhs.label);return(0,o.fieldRefNode)(t,m,i)}case h.StructRefTerm:{const i=(0,u.addSpan)(e,n,r.end,"","");switch(t.kind){case o.NodeKind.Name:return(0,o.structRefNode)(t,r.rhs,i);case o.NodeKind.Missing:return(0,o.structRefNode)(void 0,r.rhs,i)}return(0,o.badSequenceNode)(o.BadType.StructRef,[t,(0,o.structRefNode)(void 0,r.rhs,(0,u.addSpan)(e,r.start,r.end,"",""))],i)}case o.NodeKind.Operator:return Z(e,r,[t],!0,n,(0,u.getNodeSpan)(e,r).end)}}}function te(e){let t=!0;return(r,n)=>{const i=(0,u.getNodeSpan)(e,n).start,s=(0,u.getNodeSpan)(e,r).end,l=(0,u.addSpan)(e,i,s,"","");if((n.id===a.OperatorId.Pos||n.id===a.OperatorId.Neg)&&t&&(t=!1,(0,c.isNumberLiteralNode)(r)&&""===(0,u.getNodeSpan)(e,n).post)){const t=n.id===a.OperatorId.Pos?r.oper:e.mathpack.neg(r.oper);return(0,o.literalNode)(t,!0,l)}return(0,o.appNode)(n,[r],!0,l)}}const re=(0,l.take)(((e,t)=>t.kind===h.MaybeWSFTerm?t.node:S(t)?t:void 0)),ne=(0,l.apply)((0,l.tuple)(F,B,b,F),((e,[t,r,n,i])=>(0,o.badCharsNode)(o.BadType.Unexpected,r.chars,(0,u.addSpan)(e,r.start,n,t,i)))),ie=(0,l.apply)((0,l.tuple)(b,F,B,b),((e,[t,r,n,i])=>{const a=(0,u.addSpan)(e,i,i,"",""),s=(0,u.addSpan)(e,n.start,i,r,""),l=(0,o.fieldRef)((0,o.missingNode)("",a),!1,!0,!1,s);return f(r.length>0,l,t,i)})),oe=(0,l.lazy)((()=>(0,l.apply)((0,l.tuple)(b,(0,l.many)((0,l.any)($,Q,re,ne),(0,l.any)($,Q,re,(0,l.right)((0,l.succeeds)(A),ce))),b),((e,[t,r,n])=>{if(1===r.length)return r[0];const i=(0,u.addSpan)(e,t,n,"","");return 0===r.length?(0,o.missingNode)("",i):(0,o.badSequenceNode)(o.BadType.Unexpected,r,i)})))),ae=J((0,l.lazy)((()=>(0,l.any)((0,l.right)((0,l.succeeds)(A),ce),(0,l.right)((0,l.succeeds)(N),me),oe))),(0,l.any)(I,O),ee),se=J(ae,(0,l.tuple)(x,ae),X),le=J(se,(0,l.tuple)(U,se),X),ue=J(le,(0,l.any)(V,ie),ee),ce=Y(A,ue,te),de=J(ce,(0,l.tuple)(K,ce),X),me=Y(N,de,te),ge=J(me,D,ee),pe=J(ge,(0,l.tuple)(M,ge),X),he=J(pe,(0,l.tuple)(_,pe),X),fe=J(he,(0,l.tuple)(P,he),X),Se=J(fe,(0,l.tuple)(w,fe),X),ve=J(Se,(0,l.tuple)(L,Se),X);t.runOperatorPrecedenceParser=function(e,t){let r=t.length-1;if(r<1){const e="calc.parse.runTermParser: internal error: expected at least 1 term";return(0,i.assertFalse)(e)}if(t[r].kind!==s.TokenKind.End){const e=`calc.parse.runTermParser: internal error: array[n].kind !== End in ${(0,n.anonymize)(t)}`;return(0,i.assertFalse)(e)}if(1===r&&S(t[0]))return t[0];if(v(t[0])){const e=`calc.parse.runTermParser: internal error: array[0].kind === Spaces/comment in ${(0,n.anonymize)(t)}`;return(0,i.assertFalse)(e)}if(v(t[r-1])){const e=`calc.parse.runTermParser: internal error: array[n-1].kind === Spaces/comment in ${(0,n.anonymize)(t)}`;return(0,i.assertFalse)(e)}for(;;){const o=(0,l.runParser)(ve,t,0,e);if((0,m.isSuccess)(o)&&o.value.index>=r)return o.value.output;if(!(0,m.isSuccess)(o)||0===o.value.index||1===o.value.index&&S(t[0])){const e=`calc.parse.runTermParser: internal error: consumed ${(0,m.isSuccess)(o)?o.value.index:0} out of ${r} in ${(0,n.anonymize)(t)}`;return(0,i.assertFalse)(e)}r=(t=[o.value.output,...t.slice(o.value.index)]).length-1}}},89062:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseQualifier=void 0;const n=r(19181),i=r(43162),o=r(97892),a=r(679),s=r(45873),l=r(59590),u=n.__importStar(r(15964)),c=r(21081),d=r(86241),m=r(65556);function g(e){return e.kind===l.TokenKind.Literal&&e.oper.kind===c.OperKind.Boolean}const{codePointFullStop:p}=u,h=(0,o.opt)((0,o.takePeek)(((e,t,r)=>t.kind!==l.TokenKind.Spaces||(0,s.isWhitespaceToken)(r)?void 0:t.chars)),""),f=(0,o.take)(((e,t)=>t.isIdentContinue&&!g(t)&&t.chars.length>0&&t.chars.charCodeAt(0)!==p?t.chars:void 0)),S=(0,o.take)(((e,t)=>t.isIdentContinue||(0,s.isDotSepToken)(t)?t.chars:void 0)),v=(0,o.apply)((0,o.many1)(f,S),((e,t)=>t.join(""))),y=(0,o.take)(((e,t)=>t.kind===l.TokenKind.Ident?t.chars:void 0)),F=(e,t)=>{var r;return(null!==(r=t.path)&&void 0!==r?r:"")+e.leftBracket+t.document+e.rightBracket};function C(e,t,r,n,o,a){let s,l;if(null==t)null==n?(s=(0,i.identQualifier)(r,o,a),l=r):(s=(0,i.sheetRangeQualifier)(r,n,void 0,o,a),l=`${r}:${n}`);else{const u=F(e.localeInfo,t);null==n?(s=(0,i.sheetQualifier)(r,t,o,a),l=`${u}${r}`):(s=(0,i.sheetRangeQualifier)(r,n,t,o,a),l=`${u}${r}:${n}`)}return[s,o?(0,d.quoteQualifier)(l):l]}const R=(0,o.take)(((e,t)=>t.kind===l.TokenKind.Ident||(0,s.isRangeOpToken)(t)?t.chars:void 0)),b=(0,o.apply)((0,o.tuple)(s.parseCharIndex,(0,o.many)(R),s.parseLeftBracket,(0,o.many1)(R),s.parseRightBracket,s.parseCharIndex),((e,[t,r,n,o,s,l])=>{const u=r.join(""),c=o.join("");return(0,i.documentQualifier)(c,""!==u?u:void 0,!0,(0,a.addSpan)(e,t,l,"",""))})),E=(0,o.apply)((0,o.tuple)(s.parseCharIndex,s.parseLeftBracket,(0,o.many1)(S),s.parseRightBracket,s.parseCharIndex),((e,[t,r,n,o,s])=>{const l=n.join("");return(0,i.documentQualifier)(l,void 0,!1,(0,a.addSpan)(e,t,s,"",""))})),T=(0,o.apply)((0,o.tuple)(s.parseCharIndex,(0,o.opt)(E,void 0),v,(0,o.opt)((0,o.right)(s.parseRangeOp,v),void 0),s.parseCharIndex),((e,[t,r,n,i,o])=>C(e,r,n,i,!1,(0,a.addSpan)(e,t,o,"","")))),k=(0,o.apply)((0,o.tuple)(s.parseLeftSQuote,(0,o.opt)(b,void 0),y,(0,o.opt)((0,o.right)(s.parseRangeOp,y),void 0),s.parseRightSQuote,s.parseCharIndex),((e,[t,r,n,i,o,s])=>C(e,r,n,i,!0,(0,a.addSpan)(e,t.start,s,"","")))),P=(0,o.apply)(E,((e,t)=>[t,F(e.localeInfo,t)])),N=(0,o.apply)((0,o.tuple)(s.parseLeftSQuote,b,s.parseRightSQuote,s.parseCharIndex),((e,[t,r,n,o])=>[(0,i.documentQualifier)(r.document,r.path,!0,(0,a.addSpan)(e,t.start,o,"","")),(0,d.quoteQualifier)(F(e.localeInfo,r))])),A=(0,o.take)(((e,t)=>t.kind===l.TokenKind.End||t.kind===l.TokenKind.Right&&t.value===l.DelimId.SQuote?void 0:t.chars)),I=(0,o.apply)((0,o.tuple)(s.parseLeftSQuote,(0,o.many)(A),(0,o.opt)((0,o.tuple)(s.parseRightSQuote,(0,o.opt)((0,o.tuple)(s.parseQualSep,h),[void 0,""])),[void 0,[void 0,""]]),s.parseCharIndex),((e,[t,r,[n,[o,s]],l])=>{const u=void 0!==n,c=void 0!==o,d=`'${r.join("")}${u?"'":""}${c?"!":""}`,m=(0,a.addSpan)(e,t.start,l-s.length,"",s);return[(0,i.badQualifier)(d,!0,u,c,m),d]})),O=(0,o.takePeek)(((e,t,r)=>{if((0,s.isRefErrorToken)(t)){const n=(0,a.addSpan)(e,t.start,r.start,"","");return[(0,i.errorQualifier)(n),t.chars]}})),_=(0,o.peek)(((e,t)=>{const r=(0,a.addSpan)(e,t.start,t.start,"","");return[(0,i.relativeQualifier)(r),""]})),M=(0,o.apply)((0,o.tuple)((0,o.any)(T,k,P,N,_),s.parseQualSep,h),((e,[[t,r],n,i])=>{const o=(0,a.getNodeSpan)(e,t);return o.end+=1,(0,m.assertTrue)("calc.parse.parseGoodQualifier",o.end===n.start+n.chars.length),(0,m.assertTrue)("calc.parse.parseGoodQualifier",0===o.post.length),o.post=i,[t,`${r}!`]})),D=(0,o.take)(((e,t)=>t.isIdentContinue||(0,s.isDotSepToken)(t)||g(t)||function(e){return e.kind===l.TokenKind.Literal&&(0,l.isNumberLikeOper)(e.oper)}(t)?t.chars:void 0)),w=(0,o.apply)((0,o.tuple)(s.parseCharIndex,(0,o.many)(D),s.parseQualSep,s.parseCharIndex,h),((e,[t,r,n,o,s])=>{const l=`${r.join("")}!`,u=(0,a.addSpan)(e,t,o,"",s);return[(0,i.badQualifier)(l,!1,!0,!0,u),l]}));t.parseQualifier=(0,o.any)(O,M,w,I)},13711:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseRef=t.parseUnqualBadRef=t.isCompleteCellRefToken=void 0;const n=r(54741),i=r(65556),o=r(43162),a=r(76457),s=r(50591),l=r(59590),u=r(97892),c=r(46347),d=r(679),m=r(41118),g=r(45873),p=r(89062),h=r(21081),f=r(2910),S=r(85593);function v(e,t){return e.refStyle===t.refStyle&&!t.isBadLocale&&t.row!==s.SpecialPos.A1BadDollar&&t.col!==s.SpecialPos.A1BadDollar}function y(e){return e.refStyle===o.RefStyle.R1C1||"object"==typeof e.row&&"object"==typeof e.col}function F(e,t){return t.kind===l.TokenKind.CellRef&&v(e,t)&&y(t)}t.isCompleteCellRefToken=F;const C=(0,o.pos)(o.PosKind.Rel,0);function R(e){return e===s.SpecialPos.RCNoNum?C:e}function b(e,t){if(e.row!==s.SpecialPos.A1BadDollar&&e.col!==s.SpecialPos.A1BadDollar){const r=e.refStyle===o.RefStyle.R1C1&&!e.isIdentContinue;if(null!=e.row&&null!=e.col)return(0,o.cellRefSingle)(R(e.row),R(e.col),r,t);if(null!=e.row){const n=R(e.row);return(0,o.cellRefRow)(n,n,r,t)}if(null!=e.col){const n=R(e.col);return(0,o.cellRefCol)(n,n,r,t)}}const r=`calc.parse.cellRefToken2cellRef: bad token ${(0,n.anonymize)(e)}`;return(0,i.assertFalse)(r)}function E(e,t){return t.isIdentContinue&&e.localeInfo.isIdentStart((0,f.stringCodePointAt)(t.chars,0))}const T=(0,u.take)(((e,t)=>F(e,t)&&!E(e,t)||(0,g.isRefErrorToken)(t)?t:void 0)),k=(0,u.take)(((e,t)=>F(e,t)&&E(e,t)?t:void 0)),P=(0,u.apply)((0,u.tuple)((0,u.any)(T,(0,u.withState)((e=>e.cellRefMustBeCellRefNode?k:(0,u.left)(k,(0,u.fails)((0,u.any)(g.parseIdentContinue,g.parseDotSepTokenNotFollowedByLeftBracket)))))),g.parseCharIndex),((e,[t,r])=>{const n=t.kind===l.TokenKind.CellRef?b(t,(0,d.addSpan)(e,t.start,r,"","")):(0,o.cellRefError)((0,d.addSpan)(e,t.start,r,"","")),i=t.kind===l.TokenKind.CellRef?t.chars:void 0;return(0,c.maybeWSFTerm)((0,o.cellRefNode)(n,void 0,(0,d.addSpan)(e,t.start,r,"","")),i)})),N=(0,u.takePeek)(((e,t,r)=>t.kind!==l.TokenKind.CellRef||!v(e,t)||function(e,t,r){return r.kind===l.TokenKind.Left&&r.value===l.DelimId.Paren&&t.isIdentContinue&&null!=(0,m.getWorksheetFuncId)(e.localeInfo,t.chars)}(e,t,r)||r.isIdentContinue?void 0:[t,r.start])),A=(0,u.bind)((0,u.tuple)(N,g.parseSpacesOnly,g.parseRangeOp,g.parseSpacesOnly,N),((e,[[t,r],n,i,a,[s,m]])=>{const g=(0,d.addSpan)(e,t.start,r,"",n),p=(0,d.addSpan)(e,s.start,m,a,""),h=b(t,g),f=b(s,p);let S;if(h.kind===o.CellRefKind.Single&&f.kind===o.CellRefKind.Single){const r=(0,d.addSpan)(e,t.start,m,"","");S=(0,o.cellRefRange)(h,f,r)}else if(0===n.length&&0===a.length)if(h.kind===o.CellRefKind.Row&&f.kind===o.CellRefKind.Row){const r=h.isBracketed||f.isBracketed,n=(0,d.addSpan)(e,t.start,m,"","");S=(0,o.cellRefRow)(h.row1,f.row1,r,n)}else if(h.kind===o.CellRefKind.Col&&f.kind===o.CellRefKind.Col){const r=h.isBracketed||f.isBracketed,n=(0,d.addSpan)(e,t.start,m,"","");S=(0,o.cellRefCol)(h.col1,f.col1,r,n)}if(null==S)return(0,u.parseFail)();const v=(0,c.maybeWSFTerm)((0,o.cellRefNode)(S,void 0,(0,d.addSpan)(e,t.start,m,"","")),void 0);return t.isIdentContinue&&s.isIdentContinue?(0,u.peek)(((e,t)=>t.kind===l.TokenKind.Sep&&t.value===l.SepId.Qual?void 0:v)):(0,u.parseSucceed)(v)})),I=(0,u.any)(A,P);t.parseUnqualBadRef=(0,u.apply)((0,u.take)(((e,t)=>t.kind===l.TokenKind.CellRef?t:void 0)),((e,t)=>{const r=t.start+t.chars.length,n=t.refStyle===o.RefStyle.R1C1&&!t.isIdentContinue;return(0,c.maybeWSFTerm)((0,o.cellRefNode)((0,o.cellRefBad)(t.chars,n,(0,d.addSpan)(e,t.start,r,"","")),void 0,(0,d.addSpan)(e,t.start,r,"","")),t.chars)}));const O=(0,u.take)(((e,t)=>t.kind===l.TokenKind.Ident&&e.localeInfo.isIdentStart((0,f.stringCodePointAt)(t.chars,0))||t.kind===l.TokenKind.CellRef&&E(e,t)?t:void 0)),_=(0,u.take)(((e,t)=>t.kind===l.TokenKind.Literal&&t.oper.kind===h.OperKind.Boolean?t:void 0)),M=(0,u.any)(O,(0,u.left)(_,(0,u.succeeds)(g.parseDotSepTokenNotFollowedByLeftBracket))),D=(0,u.peek)(((e,t)=>(0,g.isLeftBracketToken)(t))),w=(0,u.tuple)((0,u.many1)(M,g.parseIdentContinue),(0,u.many)((0,u.any)(g.parseIdentContinue,g.parseDotSepTokenNotFollowedByLeftBracket)),D,g.parseCharIndex),L=(0,u.apply)(w,(function(e,[t,r,n,a]){var u,m,g,p,h,f,F,C,R;const E=t[0],T=1===t.length&&(null===(u=r[0])||void 0===u?void 0:u.kind)===l.TokenKind.Sep,k=E.kind!==l.TokenKind.CellRef||(P=E).refStyle===o.RefStyle.A1&&null==P.row&&"object"==typeof P.col&&P.col.kind===o.PosKind.Rel||function(e,t){return t.refStyle===o.RefStyle.A1&&e.refStyle===o.RefStyle.A1&&t.isIdentContinue||t.refStyle===o.RefStyle.R1C1&&(0,s.isR1C1IdentStart)(t.row,t.col)}(e,E)&&T;var P;if(n||function(e,t,r){return 0===r.length||1===t.length&&t[0].kind===l.TokenKind.Literal||r.some(((t,r)=>r%2==0?t.kind!==l.TokenKind.Sep:t.kind===l.TokenKind.Sep||!(0,S.isUnbracketedField)(e.localeInfo,t.chars)))}(e,t,r)){const n=[...t,...r].map((e=>e.chars)).join(""),i=(0,d.addSpan)(e,E.start,a,"",""),s=(0,d.addSpan)(e,E.start,a,"",""),l=(0,o.identNamePart)(n,k,i,s),u=(0,o.nameNode)(l,void 0,(0,d.addSpan)(e,E.start,a,"",""));return(0,c.maybeWSFTerm)(u,u.whole)}let N,A=k,I=0,O=null!==(g=null===(m=r[I])||void 0===m?void 0:m.start)&&void 0!==g?g:a,_=(0,d.addSpan)(e,E.start,O,"",""),M=(0,d.addSpan)(e,E.start,O,"","");if(1===t.length&&E.kind===l.TokenKind.CellRef)if(v(e,E))if(y(E)){const t=b(E,(0,d.addSpan)(e,E.start,O,"",""));N=(0,o.cellRefNamePart)(t,E.chars,_,M)}else N=(0,o.identNamePart)(E.chars,A,_,M);else A=!1,N=(0,o.identNamePart)(E.chars,A,_,M);else{let n=t.map((e=>e.chars)).join("");(0===e.localeInfo.stringCompareCI(n,"_xlpm")||0===e.localeInfo.stringCompareCI(n,"_xleta"))&&I+1<r.length&&(n+="."+r[I+1].chars,I+=2,O=null!==(h=null===(p=r[I])||void 0===p?void 0:p.start)&&void 0!==h?h:a,_=(0,d.addSpan)(e,E.start,O,"",""),M=(0,d.addSpan)(e,E.start,O,"","")),N=(0,o.identNamePart)(n,A,_,M)}let D=N;for(;I+1<r.length;I+=2){const t=r[I],n=r[I+1],i=null!==(F=null===(f=r[I+2])||void 0===f?void 0:f.start)&&void 0!==F?F:a;D=(0,o.fieldRefNamePart)(D,(0,o.fieldRef)((0,o.identNode)(n.chars,(0,d.addSpan)(e,n.start,i,"","")),!1,!0,!1,(0,d.addSpan)(e,t.start,i,"","")),I+2>=r.length?k:A,(0,d.addSpan)(e,E.start,i,"",""),(0,d.addSpan)(e,E.start,i,"",""))}if(I<r.length){const t=r[I],n=null!==(R=null===(C=r[I+1])||void 0===C?void 0:C.start)&&void 0!==R?R:a,i=(0,o.fieldRef)((0,o.missingNode)("",(0,d.addSpan)(e,n,n,"","")),!1,!0,!1,(0,d.addSpan)(e,t.start,n,"",""));D=(0,o.fieldRefNamePart)(D,i,k,(0,d.addSpan)(e,E.start,n,"",""),(0,d.addSpan)(e,E.start,n,"","")),I+=1}(0,i.assertTrue)("calc.parse.pUnqualName: i == tailTokens",I===r.length),D.kind===o.NamePartKind.CellRefNamePart&&(0,i.assertFalse)("calc.parse.pUnqualName: expected lhs.kind !== NamePartKind.CellRefNamePart");const w=(0,o.nameNode)(D,void 0,(0,d.addSpan)(e,E.start,a,"",""));return(0,c.maybeWSFTerm)(w,w.whole)})),x=(0,u.opt)((0,u.any)(I,L,t.parseUnqualBadRef),{node:void 0}),K=(0,u.any)(I,(0,u.right)((0,u.fails)(L),t.parseUnqualBadRef)),U=(0,u.bind)(p.parseQualifier,((e,[t,r])=>(0,u.apply)(t.kind===o.QualifierKind.SheetRange?(0,d.cellRefMustBeCellRefNode)(t.isQuoted?x:K):t.kind===o.QualifierKind.Error?(0,d.cellRefMustBeCellRefNode)(x):x,((e,{node:n})=>{if(null==n)return t.kind===o.QualifierKind.Error?(0,o.literalNode)(a.refErrorOper,!0,t.label):(0,o.badCharsNode)(o.BadType.Qualifier,r,t.label);const s=(0,d.getNodeSpan)(e,t).start,l=(0,d.getNodeSpan)(e,n).end;if(n.kind===o.NodeKind.Name){const r=(0,d.addSpan)(e,s,l,"","");if(t.kind===o.QualifierKind.Error){const e=(0,o.literalNode)(a.refErrorOper,!0,t.label);return(0,o.badSequenceNode)(o.BadType.Unexpected,[e,n],r)}return(0,i.assertTrue)("calc.parse.pQualRef: sheet-range-name quoted",t.kind!==o.QualifierKind.SheetRange||t.isQuoted),t.kind===o.QualifierKind.SheetRange&&void 0===t.document&&(t=(0,o.identQualifier)(`${t.sheet1}:${t.sheet2}`,t.isQuoted,t.label)),(0,o.nameNode)(function(e,t,r){let n=t;for(;(0,d.getSpan)(e,n.qualifiedLabel).start=r,n.kind===o.NamePartKind.FieldRefNamePart;)n=n.lhs;return t}(e,n.parts,s),t,r)}const u=(0,d.addSpan)(e,s,l,"","");return t.kind===o.QualifierKind.Ident&&(t=(0,o.sheetQualifier)(t.name,void 0,t.isQuoted,t.label)),(0,o.cellRefNode)(n.ref,t,u)})))),B=(0,u.apply)((0,u.any)(I,L),((e,t)=>t.node.kind===o.NodeKind.CellRef&&t.node.ref.kind===o.CellRefKind.Error?(0,o.literalNode)(a.refErrorOper,!0,t.node.label):t));t.parseRef=(0,u.any)(U,B)},29269:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseResultHelper=t.ExtractLetVisitor=t.CaretInsideArrayNodeIdentityVisitor=void 0;const n=r(65556),i=r(43162),o=r(61920),a=r(64842),s=r(33392),l=r(28694),u=r(1910),c=r(42665),d=r(21081),m=r(76457),g=r(12367);class p extends l.IdentityVisitor{arrayNode(e,t,r){const n=super.arrayNode(e,t,r);return this.autoCompleteFixForArrayNodesEnabled&&this.caretInNode(n)&&(this.isInsideArrayNode=!0),n}caretInNode(e){if(void 0===e)return!1;const t=this.parsedFormulaTree.spans[e.label];return void 0!==t&&this.caretPosition>=t.start&&this.caretPosition<=t.end}constructor(e,t){super(),this.parsedFormulaTree=e,this.caretPosition=t,this.isInsideArrayNode=!1,this.autoCompleteFixForArrayNodesEnabled=(0,g.isChangeGateEnabled)("OfficeVSO:7896479_autoCompleteFixForArrayNodesEnabled")}}function h(e,t){const r=e[t];return(0,n.assertTrue)("ParseResultHelper.getFormulaSpan: expected span to be defined",void 0!==r),r}t.CaretInsideArrayNodeIdentityVisitor=p;class f extends p{letNode(e,t,r,n,i,o){if(this.caretInNode(null==r?void 0:r.arg))this.pushNames(t);else for(let r=0;r<t.length;r+=1){const{binder:n}=t[r];if(this.caretInNode(n.arg)){this.pushNames(e.id===a.WorksheetFuncId.LET?t.slice(0,r):t);break}}return super.letNode(e,t,r,n,i,o)}lambdaNode(e,t,r,n,i,o){if(this.caretInNode(null==r?void 0:r.arg))this.pushNames(t);else for(let e=0;e<t.length;e+=1){const{name:r}=t[e];if(void 0!==r.arg.def&&this.caretInNode(r.arg.def.rhs)){this.pushNames(t.slice(0,e));break}}return super.lambdaNode(e,t,r,n,i,o)}pushNames(e){(0,u.safePush)(this.references,e.map((({name:e})=>e.arg.wholeName)).filter(u.isDefined).reverse())}constructor(e,t){super(e,t),this.references=[]}}function S(e,t,r,a,u=!1,g,p){if(!(0,s.isSuccess)(e))return!1;try{!function(e,t,r,n,o,a,u){if(null==e||null==n)return;const c={};null!=r?r.forEach((e=>{c[e]=!0})):c["*"]=!0;const g={};{let t=0;const r=[],n=Object.assign(Object.assign({},l.voidVisitor),{letNode(n,i,o,a,s,l){for(const{name:e}of i)g[e.arg.label]=t;r.push({letCount:t,span:h(e.spans,l)}),t+=1},lambdaNode(n,i,o,a,s,l){for(const{name:e}of i)g[e.arg.label]=t;r.push({letCount:t,span:h(e.spans,l)}),t+=1}});(0,l.reduceBottomUp)(n,e),r.sort(((e,t)=>e.span.start-t.span.start));const i={};for(let e=0;e<r.length;e+=1)i[r[e].letCount]=e;for(const e of Object.keys(g).map(Number))g[e]=i[g[e]]}const p={literalNode(e,t,r){const i=l.identityVisitor.literalNode(e,t,r);return f("literal")&&n("literal",{label:r,value:i,valueKind:e.kind}),i},missingNode(e,t){const r=l.identityVisitor.missingNode(e,t);return f("literal")&&n("literal",{label:t,value:(0,i.literalNode)(m.missingOper,!0,t),valueKind:d.OperKind.Missing}),r},arrayNode:(e,t,r)=>l.identityVisitor.arrayNode(e,t,r),appNode(e,t,r,n){const i=l.identityVisitor.appNode(e,t,r,n);return v(e,0,r,n),i},letNode(e,t,r,o,a,s){const l=(0,i.letNode)(e,t,r,o,a,s);v(e,l.args,a,s);for(const{name:e}of t)f("letName")&&n("letName",{label:e.arg.label,name:e.arg.wholeName,number:g[e.arg.label],qualifier:void 0});return l},lambdaNode(e,t,r,o,a,s){const l=(0,i.lambdaNode)(e,t,r,o,a,s);v(e,l.args,a,s);for(const{name:e}of t)f("letName")&&n("letName",{label:e.arg.name.name.label,name:e.arg.wholeName,number:g[e.arg.label],qualifier:void 0});return l},parenNode:(e,t,r)=>l.identityVisitor.parenNode(e,t,r),nameNode(t,r,o){const a=(0,i.nameNode)(t,r,o),s=e.annotations[t.label],l=e.annotations[o];if((null==l?void 0:l.kind)===i.AnnotationKind.AppHeadName);else if((null==s?void 0:s.kind)===i.AnnotationKind.LocalNameUse){const e=g[s.label];f("letName")&&null!=e&&n("letName",{label:o,name:s.name,number:e,qualifier:void 0})}else if(f("namedRange")){const e=a.whole.split(".");n("namedRange",{label:o,name:e[0],names:e.slice(1),qualifier:S(a)})}return a},cellRefNode(t,r,o){const a=(0,i.cellRefNode)(t,r,o);return f("range")&&function(t){if(null!=e&&null!=n)switch(t.ref.kind){case i.CellRefKind.Error:break;case i.CellRefKind.Col:const r=t.ref;n("range",{label:t.label,type:"col",startIndex:r.col1,endIndex:r.col2,span:h(e.spans,r.label),qualifier:S(t)});break;case i.CellRefKind.Row:const o=t.ref;n("range",{label:t.label,type:"row",startIndex:o.row1,endIndex:o.row2,span:h(e.spans,o.label),qualifier:S(t)});break;case i.CellRefKind.Single:const a=t.ref;n("range",{label:t.label,type:"cell",row:a.row,col:a.col,span:h(e.spans,a.label),qualifier:S(t)});break;case i.CellRefKind.Range:const s=t.ref;n("range",{label:t.label,type:"range",top:s.ref1.row,left:s.ref1.col,bottom:s.ref2.row,right:s.ref2.col,topLeftSpan:h(e.spans,s.ref1.label),bottomRightSpan:h(e.spans,s.ref2.label),qualifier:S(t)})}}(a),a},fieldRefNode:(e,t,r)=>l.identityVisitor.fieldRefNode(e,t,r),structRefNode(t,r,o){const l=(0,i.structRefNode)(t,r,o);if(f("structRefRange")){if(null==u||null==a)return l;const{resolution:r}=u.resolveStructRef(a,l);if(!(0,s.isSuccess)(r)||void 0===r.value)return l;const c=r.value;n("structRefRange",{label:o,type:"range",top:(0,i.pos)(i.PosKind.Rel,c.range.row),left:(0,i.pos)(i.PosKind.Rel,c.range.col),bottom:(0,i.pos)(i.PosKind.Rel,c.range.row+c.range.rows-1),right:(0,i.pos)(i.PosKind.Rel,c.range.col+c.range.cols-1),span:h(e.spans,o),qualifier:void 0!==t?S(t):void 0,name:void 0!==t?t.whole:void 0})}return l},badSequenceNode:(e,t,r)=>l.identityVisitor.badSequenceNode(e,t,r),badCharsNode:(e,t,r)=>l.identityVisitor.badCharsNode(e,t,r),operatorNode:(e,t)=>l.identityVisitor.operatorNode(e,t),wsfNode:(e,t,r)=>l.identityVisitor.wsfNode(e,t,r)};function f(e){return c[e]||c["*"]}function S(e){if(null!=e.qualifier){const t={};switch(e.qualifier.kind){case i.QualifierKind.Sheet:const r=e.qualifier;t.type="Sheet",t.sheet=r.sheet,null!=r.document&&(t.document=r.document.document,null!=r.document.path&&(t.documentPath=r.document.path));break;case i.QualifierKind.SheetRange:const n=e.qualifier;t.type="SheetRange",t.sheet1=n.sheet1,t.sheet2=n.sheet2,null!=n.document&&(t.document=n.document.document,null!=n.document.path&&(t.documentPath=n.document.path));break;case i.QualifierKind.Ident:const o=e.qualifier;t.type="Ident",t.name=o.name;break;case i.QualifierKind.Document:const a=e.qualifier;t.type="Document",t.document=a.document,null!=a.path&&(t.documentPath=a.path)}return t}}function v(e,t,r,o){if(null!=n)switch(e.kind){case i.NodeKind.Operator:f("operator")&&n("operator",{label:o,value:e.id});break;case i.NodeKind.WSF:case i.NodeKind.Name:f("function")&&n("function",{label:o,name:e.whole,isClosed:r,args:[]})}}(0,l.reduceBottomUp)(p,e)}(e.value,null!=a||(0,o.getEnglishLocaleInfo)(),t,r,0,g,p)}catch(e){const t=`ParseResultHelper.traverse: unhandled error ${(0,c.messageFromError)(e)}`;n.ulsLogger.ULS.traceTag(507381982,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,t)}return!0}t.ExtractLetVisitor=f,t.parseResultHelper={isSuccess:s.isSuccess,traverse:S,extractReferences:function(e,t,r=!1,n,i){if(!(0,s.isSuccess)(e))return;const o=[];return S(e,["range","namedRange","letName","literal","function","structRefRange"],((t,r)=>{const n={kind:t,ref:r,span:h(e.value.spans,r.label)};o.push(n)}),t,r,n,i),o.sort(((e,t)=>{let r;return 0!=(r=e.span.start-t.span.start)||0!=(r=t.span.end-e.span.end)?r:0})),o},extractLetVariables:function(e,t){if((0,s.isSuccess)(e))try{const r=new f(e.value,t);return(0,l.reduceBottomUp)(r,e.value),r.references.reverse()}catch(e){const t=`ParseResultHelper.extractLetVariables: unhandled error ${(0,c.messageFromError)(e)}`;return n.ulsLogger.ULS.traceTag(507381983,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,t),[]}}}},50628:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseStructRef=void 0;const n=r(97892),i=r(46347),o=r(45873),a=r(43162),s=r(679),l=r(59590),u=r(33392),c=(0,n.take)(((e,t)=>t.isIdentContinue||t.kind===l.TokenKind.Spaces?t:void 0)),d=(0,n.apply)((0,n.many1)(c),((e,t)=>{const r=t[0];return 1===t.length?r:(0,l.identToken)(r.start,t.map((e=>e.kind===l.TokenKind.Escape?"":e.chars)).join(""))})),m=(0,n.take)(((e,t)=>t.isIdentContinue||t.kind===l.TokenKind.Spaces||t.kind===l.TokenKind.Escape||(0,o.isListSepToken)(t)||(0,o.isRangeOpToken)(t)?t:void 0)),g=(0,n.apply)((0,n.many1)(m),((e,t)=>{const r=t[0];return 1===t.length?r:(0,l.identToken)(r.start,t.map((e=>e.kind===l.TokenKind.Escape?"":e.chars)).join(""))})),p=(0,n.take)(((e,t)=>t.kind===l.TokenKind.SpecialRef?t:void 0)),h=(0,n.apply)((0,n.tuple)(o.parseCharIndex,p,o.parseCharIndex),((e,[t,r,n])=>(0,a.specialRef)(r.value,!1,!0,(0,s.addSpan)(e,t,n,"","")))),f=(0,n.apply)((0,n.tuple)(o.parseCharIndex,o.parseLeftBracket,p,(0,n.opt)(o.parseRightBracket,void 0),o.parseCharIndex),((e,[t,r,n,i,o])=>(0,a.specialRef)(n.value,!0,void 0!==i,(0,s.addSpan)(e,t,o,"","")))),S=(0,n.any)(h,f),v=(0,n.apply)((0,n.tuple)(o.parseCharIndex,d,o.parseCharIndex),((e,[t,r,n])=>(0,a.columnRef)(r.chars,!1,!0,(0,s.addSpan)(e,t,n,"","")))),y=(0,n.apply)((0,n.tuple)(o.parseCharIndex,o.parseLeftBracket,(0,n.opt)(g,void 0),(0,n.opt)(o.parseRightBracket,void 0),o.parseCharIndex),((e,[t,r,n,i,o])=>{var l;return(0,a.columnRef)(null!==(l=null==n?void 0:n.chars)&&void 0!==l?l:"",!0,void 0!==i,(0,s.addSpan)(e,t,o,"",""))})),F=(0,n.apply)((0,n.tuple)(o.parseCharIndex,g,o.parseCharIndex),((e,[t,r,n])=>(0,a.columnRef)(r.chars,!1,!0,(0,s.addSpan)(e,t,n,"","")))),C=(0,n.any)(v,y),R=(0,n.apply)(o.parseCharIndex,((e,t)=>(0,a.missingRef)((0,s.addSpan)(e,t,t,"","")))),b=(0,n.any)(C,R),E=(0,n.take)(((e,t)=>"#"===t.chars?t:void 0)),T=(0,n.apply)((0,n.many1)(E,c),((e,t)=>(0,l.unexpectedToken)(t[0].start,t.map((e=>e.chars)).join("")))),k=(0,n.apply)((0,n.many1)(E,m),((e,t)=>(0,l.unexpectedToken)(t[0].start,t.map((e=>e.chars)).join("")))),P=(0,n.apply)((0,n.tuple)(o.parseCharIndex,T,o.parseCharIndex),((e,[t,r,n])=>(0,a.badRef)(r.chars,!1,!0,(0,s.addSpan)(e,t,n,"","")))),N=(0,n.apply)((0,n.tuple)(o.parseCharIndex,o.parseLeftBracket,k,(0,n.opt)(o.parseRightBracket,void 0),o.parseCharIndex),((e,[t,r,n,i,o])=>(0,a.badRef)(n.chars,!0,void 0!==i,(0,s.addSpan)(e,t,o,"","")))),A=(0,n.any)(P,N),I=(0,n.apply)((0,n.tuple)(o.parseCharIndex,b,o.parseRangeOp,b,o.parseCharIndex),((e,[t,r,n,i,o])=>(0,a.rangeOpRef)(r,i,(0,s.addSpan)(e,t,o,"","")))),O=(0,n.any)(I,C),_=(0,n.any)(S,A,I,C,R),M=(0,n.apply)((0,n.tuple)(o.parseCharIndex,_,(0,n.many1)((0,n.tuple)(o.parseListSep,_)),o.parseCharIndex),((e,[t,r,n,i])=>(0,a.commaOpRef)([r,...n.map((([e,t])=>t))],(0,s.addSpan)(e,t,i,"","")))),D=(0,n.apply)((0,n.tuple)(o.parseCharIndex,o.parseAtOp,(0,n.opt)(O,void 0),o.parseCharIndex),((e,[t,r,n,i])=>(0,a.thisRowOpRef)(n,(0,s.addSpan)(e,t,i,"","")))),w=(0,n.apply)(o.parseSpacesOnly,(()=>{})),L=(0,n.any)((0,n.left)(w,o.parseEnd),(0,n.left)(F,o.parseEnd),(0,n.left)(M,o.parseEnd),(0,n.left)(D,o.parseEnd),(0,n.left)(I,o.parseEnd),(0,n.left)(S,o.parseEnd),(0,n.left)(A,o.parseEnd),(0,n.left)(y,o.parseEnd));t.parseStructRef=(0,n.applyTake)((0,n.tuple)(o.parseCharIndex,o.parseBracketedTokens,o.parseCharIndex),((e,[t,[r,o],l])=>{const c=(0,n.runParser)(L,r,0,e);return(0,u.isSuccess)(c)?(0,i.structRefTerm)((0,a.structRef)(c.value.output,o,(0,s.addSpan)(e,t,l,"","")),t,l):void 0}))},97892:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.concat=t.flatten=t.middle=t.right=t.left=t.tuple=t.many1=t.many=t.reduce=t.applyTake=t.takePeek=t.peek=t.take=t.fails=t.succeeds=t.opt=t.any=t.withState=t.apply=t.bind=t.parseFail=t.parseSucceed=t.warnSucceedOrFail=t.setDebugging=t.lazy=t.runParser=void 0;const n=r(65556),i=r(54741),o=r(33392),a=r(1910);t.runParser=function(e,t,r,a){let s;if(function(e){let t=e;for(;null!=t;)t=t()}(e(t,r,a,(function(e,t){s=(0,o.success)({output:e,index:t})}),(function(){s=(0,o.failure)(void 0)}))),null==s){const e=`calc.parse.runParser: internal error: parser did not call resolve or reject on ${(0,i.anonymize)(t)}`;return(0,n.assertFalse)(e)}return s},t.lazy=function(e){let t;return function(r,n,i,o,a){const s=null!=t?t:t=e();return()=>s(r,n,i,o,a)}};let s=!1;function l(e){return function(t,r,n,i,o){return i(e,r)}}t.setDebugging=function(e){s=e},t.warnSucceedOrFail=function(e,t){return function(r,n,i,o,a){return e(r,n,i,((e,n)=>(s&&console.warn(`${t} succeeded, returning index ${n} (of ${r.length}) with`,e),o(e,n))),(()=>(s&&console.warn(`${t} failed at index ${n} (of ${r.length})`),a)))}},t.parseSucceed=l;const u=(e,t,r,n,i)=>i;function c(){return u}function d(e,t){return function(r,n,i,o,a){return e(r,n,i,((e,n)=>t(i,e)(r,n,i,o,a)),a)}}function m(e,t){return function(r,n,i,o,a){return e(r,n,i,((e,r)=>o(t(i,e),r)),a)}}function g(e,t){return function(r,n,i,o,a){return e(r,n,i,o,(()=>t(r,n,i,o,a)))}}function p(e,t){return function(r,n,i,o,a){const s=r[n];if(null==s)return a;const l=e(i,s);return null==l?a:o(l,n+t)}}function h(e,t,r){return function(o,a,s,l,u){let c=r,d=a;function m(){return e(o,d,s,g,p)}function g(e,r){if(r<=d){const e=(0,i.anonymize)(o),t=`calc.parse.reduce: internal error: no progress made at index ${d} on ${e}`;return(0,n.assertFalse)(t)}return c=t(s,e,c),d=r,m}function p(){return l(c,d)}return m}}function f(e,t){return h(e,(function(e,t,r){return r.push(t),r}),t)}function S(...e){if(0===e.length)return l([]);if(1===e.length)return m(e[0],((e,t)=>[t]));const t=e.length;return function(r,n,i,o,a){let s=n;const l=[];function u(){return e[l.length](r,s,i,c,a)}function c(e,r){return s=r,l.push(e),l.length<t?u:o(l,s)}return u}}function v(e){return m(e,((e,t)=>(0,a.safeConcat)([],t)))}t.parseFail=c,t.bind=d,t.apply=m,t.withState=function(e){return(t,r,n,i,o)=>e(n)(t,r,n,i,o)},t.any=function(...e){return 0===e.length?c():e.reduce(g)},t.opt=function(e,t){return function(r,n,i,o,a){return e(r,n,i,o,(()=>o(t,n)))}},t.succeeds=function(e){return function(t,r,n,i,o){return e(t,r,n,(()=>i(!0,r)),o)}},t.fails=function(e){return function(t,r,n,i,o){return e(t,r,n,o,(()=>i(!0,r)))}},t.take=function(e){return p(e,1)},t.peek=function(e){return p(e,0)},t.takePeek=function(e){return function(t,r,n,i,o){const a=t[r],s=t[r+1];if(null==a||null==s)return o;const l=e(n,a,s);return null==l?o:i(l,r+1)}},t.applyTake=function(e,t){return function(r,n,i,o,a){return e(r,n,i,((e,r)=>{const n=t(i,e);return null==n?a:o(n,r)}),a)}},t.reduce=h,t.many=function(e,t){return void 0===t?function(t,r,n,i,o){return f(e,[])(t,r,n,i,o)}:function(r,n,i,o,a){return e(r,n,i,((e,n)=>f(t,[e])(r,n,i,o,a)),(()=>o([],n)))}},t.many1=function(e,t=e){return d(e,((e,r)=>f(t,[r])))},t.tuple=S,t.left=function(e,t){return m(S(e,t),((e,[t])=>t))},t.right=function(e,t){return m(S(e,t),((e,[,t])=>t))},t.middle=function(e,t,r){return m(S(e,t,r),((e,[,t])=>t))},t.flatten=v,t.concat=function(...e){return v(S(...e))}},73917:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createParser=void 0;const n=r(19181),i=r(9782),o=r(21236),a=r(35303),s=r(41118),l=r(33392),u=n.__importStar(r(15964)),{codePointEqualsSign:c,codePointPlusSign:d,codePointMinusSign:m,codePointAtSign:g}=u,p={[c]:1,[d]:0,[m]:0,[g]:-1};function h(e,t,r,n){var a,s,u,c;const d=null!==(s=null===(a=t.config)||void 0===a?void 0:a.localeInfo)&&void 0!==s?s:e.config.localeInfo,m=null!==(c=null===(u=t.config)||void 0===u?void 0:u.refStyle)&&void 0!==c?c:e.config.refStyle,g=e.config.mathpack,p=(0,i.tokenizeFormula)(d,g,m,t.originGridCell.value,r,n,t.syntaxFeatures),h=(0,o.runFormulaParser)(d,g,m,t.lexicalKind,t.originGridCell.value,t.contextNames,t.syntaxFeatures,p);return(0,l.success)(h)}t.createParser=function(e){return{parseFormula:(t,r,n)=>function(e,t,r,n=0){try{const i=n>=0&&n<r.length?p[r.charCodeAt(n)]:void 0;return null==i?(0,l.failure)((0,a.notFormulaString)("first character is not '=', '+', '-' or '@'")):i<0?(0,l.failure)((0,s.notImplemented)(["Lotus 1-2-3 syntax"])):h(e,t,r,n+i)}catch(e){return(0,l.failure)((0,l.javaScriptError)(e))}}(e,t,r,n),parseFormulaExpression:(t,r,n)=>function(e,t,r,n=0){try{return h(e,t,r,n)}catch(e){return(0,l.failure)((0,l.javaScriptError)(e))}}(e,t,r,n)}}},679:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cellRefMustBeCellRefNode=t.withDelim=t.addSpan=t.addWhitespace=t.getSpan=t.getNodeSpan=t.makeState=t.ListSep=void 0;const n=r(54741),i=r(65556),o=r(59590),a=r(43162),s=r(45873);var l;!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}(l||(t.ListSep=l={})),t.makeState=function(e,t,r,n,i){return{localeInfo:e,mathpack:t,refStyle:r,lexicalKind:n,origin:i,delim:{delimId:void 0,listSep:l.Union,stack:{[o.DelimId.Paren]:!1,[o.DelimId.Brace]:!1,[o.DelimId.Bracket]:!1}},cellRefMustBeCellRefNode:!1,label:1,spans:[]}},t.getNodeSpan=function(e,t){const r=e.spans[t.label];if(null==r){const e=`calc.parse.getNodeSpan: internal error: expected node to have a span; given ${(0,n.anonymize)(t)}`;(0,i.assertFalse)(e)}return r},t.getSpan=function(e,t){const r=e.spans[t];return(0,i.assertTrue)("calc.parse.getSpan: internal error: expected label to have a span",null!=r),r};const u=[];function c(e,t){const r="string"==typeof t?u:t.filter(s.isCommentToken);return["string"==typeof t?t:t.map((e=>e.chars)).join(""),r.length>0?r.map((t=>function(e,t){const r=d(e,t.start,t.start+t.chars.length,"","");return t.kind===o.TokenKind.SingleLineComment?(0,a.singleLineComment)(t.chars,r):(0,a.multiLineComment)(t.chars,t.isClosed,r)}(e,t))):void 0]}function d(e,t,r,n,i){const o=e.label;e.label+=1;const[s,l]=c(e,n),[u,d]=c(e,i);return e.spans[o]=(0,a.formulaSpan)(t,r,s,u,l,d),o}function m(e,t,r){return(n,i,o,a,s)=>{const l=e(o);return r(n,i,o,((e,r)=>(t(o,l),a(e,r))),(()=>(t(o,l),s)))}}t.addWhitespace=c,t.addSpan=d,t.withDelim=function({delimId:e,listSep:t},r){return m((r=>{const n=r.delim;return r.delim={delimId:e,listSep:t,stack:Object.assign(Object.assign({},n.stack),{[e]:!0})},n}),((e,t)=>e.delim=t),r)},t.cellRefMustBeCellRefNode=function(e){return m((e=>{const t=e.cellRefMustBeCellRefNode;return e.cellRefMustBeCellRefNode=!0,t}),((e,t)=>e.cellRefMustBeCellRefNode=t),e)}},35303:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notFormulaString=t.ReasonKind=t.parseLocals=t.createParseGlobals=void 0;const n=r(41118),i=r(33392);var o;t.createParseGlobals=function(e){return{config:e}},t.parseLocals=function(e,t,r,n,o){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:(0,i.success)(t),contextNames:n,syntaxFeatures:o}},function(e){e.NotFormulaString="NotFormulaString"}(o||(o={})),t.ReasonKind=Object.assign(Object.assign({},n.ReasonKind),o),t.notFormulaString=function(e){return{kind:t.ReasonKind.NotFormulaString,message:e}}},59590:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rangeOperatorToken=t.geOperatorToken=t.leOperatorToken=t.neOperatorToken=t.gtOperatorToken=t.ltOperatorToken=t.eqOperatorToken=t.concatOperatorToken=t.percentOperatorToken=t.powOperatorToken=t.divOperatorToken=t.mulOperatorToken=t.subOperatorToken=t.addOperatorToken=t.operatorToken=t.identOrBooleanToken=t.literalToken=t.cellRefR1C1Token=t.cellRefA1Token=t.specialRefToken=t.assignSepToken=t.dotSepToken=t.qualSepToken=t.rowSepToken=t.colSepToken=t.listSepToken=t.rightSQuoteToken=t.rightBraceToken=t.rightBracketToken=t.rightParenToken=t.leftSQuoteToken=t.leftBraceToken=t.leftBracketToken=t.leftParenToken=t.identToken=t.multiLineCommentToken=t.singleLineCommentToken=t.escapeToken=t.unexpectedToken=t.spacesToken=t.endToken=t.badErrorOper=t.isBadErrorOper=t.badNumberOper=t.isNumberLikeOper=t.isBadNumberOper=t.TokenOperKind=t.SepId=t.DelimId=t.TokenKind=void 0,t.appendToken=t.poundOperatorToken=t.atOperatorToken=void 0;const n=r(19181),i=r(64842),o=r(43162),a=r(76457),s=r(21081),l=r(2910),u=n.__importStar(r(15964)),c=r(50591),{codePointAsterisk:d,codePointMinusSign:m,codePointPlusSign:g,codePointSlash:p,codePointSpace:h}=u;var f,S,v,y;function F(e){return e.kind===y.BadNumber||e.kind===s.OperKind.Number}function C(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:n}}function R(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:!1,value:n}}function b(e,t,r,n,i,o,a){return{kind:f.CellRef,start:e,chars:t,isIdentContinue:r,row:n,col:i,refStyle:o,isBadLocale:a}}function E(e,t,r,n=!0){const i=r.kind===s.OperKind.Boolean||F(r)&&function(e){for(const t of(0,l.codePointIterator)(e))if(t===g||t===m||t===d||t===h||t===p)return!1;return!0}(t);return{kind:f.Literal,start:e,chars:t,isIdentContinue:i,oper:r,hasRight:n}}function T(e,t,r){return{kind:f.Operator,start:e,chars:t,isIdentContinue:!1,value:r}}function k(e){const t=i.operatorStrings[e];if(null==t)throw new Error(`operatorTokenMaker: invalid operator ${e}`);return r=>T(r,t,e)}!function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected",e[e.Escape=12]="Escape",e[e.SingleLineComment=13]="SingleLineComment",e[e.MultiLineComment=14]="MultiLineComment"}(f||(t.TokenKind=f={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(S||(t.DelimId=S={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual",e[e.Dot=5]="Dot",e[e.Assign=6]="Assign"}(v||(t.SepId=v={})),function(e){e.BadNumber="BadNumber",e.BadError="BadError"}(y||(t.TokenOperKind=y={})),t.isBadNumberOper=function(e){return e.kind===y.BadNumber},t.isNumberLikeOper=F,t.badNumberOper={kind:y.BadNumber},t.isBadErrorOper=function(e){return e.kind===y.BadError},t.badErrorOper={kind:y.BadError},t.endToken=e=>C(f.End,e,"",!1),t.spacesToken=(e,t)=>C(f.Spaces,e,t,!1),t.unexpectedToken=(e,t)=>C(f.Unexpected,e,t,!1),t.escapeToken=(e,t)=>C(f.Escape,e,t,!1),t.singleLineCommentToken=(e,t)=>C(f.SingleLineComment,e,t,!1),t.multiLineCommentToken=(e,t,r)=>({kind:f.MultiLineComment,start:e,chars:t,isIdentContinue:!1,isClosed:r}),t.identToken=(e,t)=>C(f.Ident,e,t,!0),t.leftParenToken=e=>R(f.Left,e,"(",S.Paren),t.leftBracketToken=(e,t)=>R(f.Left,e,t,S.Bracket),t.leftBraceToken=(e,t)=>R(f.Left,e,t,S.Brace),t.leftSQuoteToken=e=>R(f.Left,e,"'",S.SQuote),t.rightParenToken=e=>R(f.Right,e,")",S.Paren),t.rightBracketToken=(e,t)=>R(f.Right,e,t,S.Bracket),t.rightBraceToken=(e,t)=>R(f.Right,e,t,S.Brace),t.rightSQuoteToken=e=>R(f.Right,e,"'",S.SQuote),t.listSepToken=(e,t)=>R(f.Sep,e,t,v.List),t.colSepToken=(e,t)=>R(f.Sep,e,t,v.Col),t.rowSepToken=(e,t)=>R(f.Sep,e,t,v.Row),t.qualSepToken=e=>R(f.Sep,e,"!",v.Qual),t.dotSepToken=e=>R(f.Sep,e,".",v.Dot),t.assignSepToken=e=>R(f.Sep,e,":=",v.Assign),t.specialRefToken=(e,t,r)=>R(f.SpecialRef,e,t,r),t.cellRefA1Token=function(e,t,r,n){return b(e,t,(null==r||"object"==typeof r&&r.kind===o.PosKind.Rel)&&(null==n||"object"==typeof n&&n.kind===o.PosKind.Rel),r,n,o.RefStyle.A1,!1)},t.cellRefR1C1Token=function(e,t,r,n,i=!1){return b(e,t,!(r!==c.SpecialPos.RCNoNum&&null!=r&&r.kind!==o.PosKind.Abs||n!==c.SpecialPos.RCNoNum&&null!=n&&n.kind!==o.PosKind.Abs),r,n,o.RefStyle.R1C1,i)},t.literalToken=E,t.identOrBooleanToken=function(e,r,n){return 0===e.stringCompareCI(e.falseName,n)?E(r,n,a.falseOper):0===e.stringCompareCI(e.trueName,n)?E(r,n,a.trueOper):(0,t.identToken)(r,n)},t.operatorToken=T,t.addOperatorToken=k(i.OperatorId.Add),t.subOperatorToken=k(i.OperatorId.Sub),t.mulOperatorToken=k(i.OperatorId.Mul),t.divOperatorToken=k(i.OperatorId.Div),t.powOperatorToken=k(i.OperatorId.Pow),t.percentOperatorToken=k(i.OperatorId.Percent),t.concatOperatorToken=k(i.OperatorId.Concat),t.eqOperatorToken=k(i.OperatorId.Eq),t.ltOperatorToken=k(i.OperatorId.Lt),t.gtOperatorToken=k(i.OperatorId.Gt),t.neOperatorToken=k(i.OperatorId.Ne),t.leOperatorToken=k(i.OperatorId.Le),t.geOperatorToken=k(i.OperatorId.Ge),t.rangeOperatorToken=k(i.OperatorId.Range),t.atOperatorToken=k(i.OperatorId.At),t.poundOperatorToken=k(i.OperatorId.Pound),t.appendToken=function(e,t,r){return r.push(t),t.start+e}},9782:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tokenizeFormula=void 0;const n=r(19181),i=r(65556),o=r(59590),a=r(76457),s=r(50591),l=r(4468),u=r(1910),c=r(43162),d=r(50019),m=r(2910),g=n.__importStar(r(15964)),p=r(42665),h=r(82993),f=r(45873),{codePointAsterisk:S,codePointAtSign:v,codePointColon:y,codePointDoubleQuote:F,codePointExclamationMark:C,codePointHash:R,codePointLeftParen:b,codePointQuestionMark:E,codePointRightParen:T,codePointSingleQuote:k,codePointFullStop:P,codePointDigitZero:N,codePointSlash:A,codePointMinusSign:I,codePointSpace:O,codePointInvertedExclamationMark:_,codePointInvertedQuestionMark:M,codePointLeftSingleQuotationMark:D,codePointRightSingleQuotationMark:w}=g;let L;function x(e){if(!L){L=(0,u.makeStringMap)();for(const e of Object.getOwnPropertyNames(K))L[e.charCodeAt(0)]=!0;for(const e of Object.getOwnPropertyNames(U))L[e.charCodeAt(0)]=!0}return!0===L[e]}const K={"+":o.addOperatorToken,"-":o.subOperatorToken,"*":o.mulOperatorToken,"/":o.divOperatorToken,"^":o.powOperatorToken,"%":o.percentOperatorToken,"&":o.concatOperatorToken,"=":o.eqOperatorToken,"<":o.ltOperatorToken,">":o.gtOperatorToken,":":o.rangeOperatorToken,".":o.dotSepToken,"@":o.atOperatorToken,"#":o.poundOperatorToken},U={"<>":o.neOperatorToken,"<=":o.leOperatorToken,">=":o.geOperatorToken};function B(e,t,r){if(t<e.length-1){const n=U[e.substring(t,t+2)];if(null!=n)return(0,o.appendToken)(2,n(t),r)}const n=K[e.charAt(t)];return null!=n?(0,o.appendToken)(1,n(t),r):(0,i.assertFalse)("calc.parse.tokenizeOperator: internal error: expected operator")}function G(e,t,r,n,i){const a=(0,l.parseNumberLiteral)(e,t,r,n,!1,!1,!1);if(void 0===a)return;const{value:s,i:u}=a,c=r.substring(n,u);return(0,o.appendToken)(u-n,(0,o.literalToken)(n,c,null!=s?s:o.badNumberOper,!0),i),u}const W=(e,t)=>e.charCodeAt(t)!==F,V=(e,t)=>e.charCodeAt(t)===F;function j(e,t,r){const[n,i]=(0,d.scanEscapedWhile)(e,t+1,W,'"',V),s=e.substring(t,i+1);return i<e.length?(0,o.appendToken)(i+1-t,(0,o.literalToken)(t,s,(0,a.stringOper)(n),!0),r):(0,o.appendToken)(i-t,(0,o.literalToken)(t,s,(0,a.stringOper)(n),!1),r)}function q(e,t,r,n){for(let i=1;i<e.errorNames.length;i+=1){const s=e.errorNames[i];if(null==s)continue;const l=t.substring(r,r+s.length);if(0===e.stringCompareCI(s,l))return(0,o.appendToken)(s.length,(0,o.literalToken)(r,l,(0,a.errorOper)(i)),n)}let i=r+1,s=!1;for(;i<t.length;){const n=(0,m.stringCodePointAt)(t,i);if(i!==r+1||n!==_&&n!==M)if(!(i>r+1)||n!==A&&n!==I&&n!==O||s)if(i>r+1&&n===P)i+=1;else{if(i>r+1&&n===N){i+=1,i<t.length&&t.charCodeAt(i)===C&&(i+=1);break}if(n===C||n===E){i!==r+1&&(i+=1);break}if(!e.isIdentContinue(n)||e.isNumeral(n)){if(n!==D&&n!==w)break;i+=1}else i+=(0,m.numCodeUnits)(n)}else s=!0,i+=1;else i+=1}for(;i>r+1&&t.charCodeAt(i-1)===O;)--i;if(i>r+1){const e=t.substring(r,i);return(0,o.appendToken)(i-r,(0,o.literalToken)(r,e,o.badErrorOper),n)}}function H(e,t,r,n){for(let i=1;i<e.specialRefNames.length;i+=1){const a=e.specialRefNames[i];if(null==a)continue;const s=t.substring(r,r+a.length);if(0===e.stringCompareCI(a,s))return(0,o.appendToken)(a.length,(0,o.specialRefToken)(r,s,i),n)}}function z(e,t,r){const n=t.charCodeAt(r);return!((0,l.isSpace)(n)||n===k||n===R||n===y||n===v||(0,p.stringStartsWith)(t,e.listSeparator,r)||(0,p.stringStartsWith)(t,e.leftBracket,r)||(0,p.stringStartsWith)(t,e.rightBracket,r))}const $=(e,t)=>(0,l.isSpace)((0,m.stringCodePointAt)(e,t)),Q=(e,t)=>!(0,l.isLineBreak)((0,m.stringCodePointAt)(e,t)),Y=(e,t)=>!(t+1<e.length&&e.charCodeAt(t)===S&&e.charCodeAt(t+1)===A);function J(e,t,r,n){let i=r,a=0;const s=(t,r)=>z(e,t,r),u=(t,r)=>!z(e,t,r),c=(0,d.makeProgressAsserter)("calc.parse.tokenizeBracketedRef",i);for(;i<t.length;){c(i);const r=(0,m.stringCodePointAt)(t,i);if(n.length>0&&n[n.length-1].kind===o.TokenKind.Escape&&u(t,i))i=(0,o.appendToken)((0,m.numCodeUnits)(r),(0,o.identToken)(i,(0,m.stringFromCodePoint)(r)),n);else if(r!==v){if(r===R){const r=H(e,t,i,n);if(null!=r){i=r;continue}}if(r!==k)if((0,p.stringStartsWith)(t,e.rightBracket,i)){if(i=(0,o.appendToken)(e.rightBracket.length,(0,o.rightBracketToken)(i,e.rightBracket),n),a-=1,0===a)return i}else if(s(t,i)){const[e,r]=(0,d.scanWhile)(t,i,s);i=(0,o.appendToken)(r-i,(0,o.identToken)(i,e),n)}else if((0,l.isSpace)(r)){const[e,r]=(0,d.scanWhile)(t,i,$);i=(0,o.appendToken)(r-i,(0,o.spacesToken)(i,e),n)}else r!==y?(0,p.stringStartsWith)(t,e.listSeparator,i)?i=(0,o.appendToken)(e.listSeparator.length,(0,o.listSepToken)(i,e.listSeparator),n):(0,p.stringStartsWith)(t,e.leftBracket,i)&&a<2?(i=(0,o.appendToken)(e.leftBracket.length,(0,o.leftBracketToken)(i,e.leftBracket),n),a+=1):i=(0,o.appendToken)((0,m.numCodeUnits)(r),(0,o.unexpectedToken)(i,(0,m.stringFromCodePoint)(r)),n):i=(0,o.appendToken)(1,(0,o.rangeOperatorToken)(i),n);else i=(0,o.appendToken)(1,(0,o.escapeToken)(i,"'"),n)}else i=(0,o.appendToken)(1,(0,o.atOperatorToken)(i),n)}return i}function X(e,t,r,n){let i=(0,o.appendToken)(1,(0,o.leftSQuoteToken)(r),n);const a=(t,r)=>function(e,t,r){const n=t.charCodeAt(r);return n!==k&&n!==y&&n!==S&&n!==E&&!(0,p.stringStartsWith)(t,e.leftBracket,r)&&!(0,p.stringStartsWith)(t,e.rightBracket,r)}(e,t,r),s=(e,t)=>e.charCodeAt(t)===k,l=(0,d.makeProgressAsserter)("calc.parse.tokenizeQuotedQualifier",i);for(;i<t.length;){l(i);const r=(0,m.stringCodePointAt)(t,i);if(r===k&&!(i+1<t.length&&t.charCodeAt(i+1)===k))return(0,o.appendToken)(1,(0,o.rightSQuoteToken)(i),n);if(r!==y)if((0,p.stringStartsWith)(t,e.leftBracket,i))i=(0,o.appendToken)(e.leftBracket.length,(0,o.leftBracketToken)(i,e.leftBracket),n);else if((0,p.stringStartsWith)(t,e.rightBracket,i))i=(0,o.appendToken)(e.rightBracket.length,(0,o.rightBracketToken)(i,e.rightBracket),n);else if((0,d.getEscapedSkip)(t,i,a,"'",s)>0){const[e,r]=(0,d.scanEscapedWhile)(t,i,a,"'",s);i=(0,o.appendToken)(r-i,(0,o.identToken)(i,e),n)}else i=(0,o.appendToken)((0,m.numCodeUnits)(r),(0,o.unexpectedToken)(i,(0,m.stringFromCodePoint)(r)),n);else i=(0,o.appendToken)(1,(0,o.rangeOperatorToken)(i),n)}return i}function Z(e,t,r,n,i,a){const l=(0,s.parseCellRef)(e,t,r,n,i);if(null!=l){const e=l.i,t=n.substring(e,i),r=l.refStyle===c.RefStyle.A1?(0,o.cellRefA1Token)(i,t,l.row,l.col):(0,o.cellRefR1C1Token)(i,t,l.row,l.col,l.enLocale);return(0,o.appendToken)(e-i,r,a)}}function ee(e,t,r,n){let i=n.length-1,a=n[i];if(null==a)return!0;if(a.kind===o.TokenKind.Sep&&a.value===o.SepId.Dot)return!1;if((0,p.stringStartsWith)(t,e.decimalSeparator,r)){for(;null!=a&&(0,f.isWhitespaceToken)(a);)a=n[--i];return null==a||a.kind!==o.TokenKind.Ident&&a.kind!==o.TokenKind.CellRef&&a.kind!==o.TokenKind.Right&&(a.kind!==o.TokenKind.Literal||(0,o.isNumberLikeOper)(a.oper))}return e.isNumeral((0,m.stringCodePointAt)(t,r))}function te(e,t,r,n){let i=e[t],o=t+1;for(;o<e.length;o+=1){const t=e[o];if(t.kind!==r)break;i=n(i,t)}return[i,o]}t.tokenizeFormula=function(e,t,r,n,a,s,u){const[g,f]=function(e,t,r,n,a,s,u){const g=[],f=[];let v=s;const y=!0===(null==u?void 0:u[c.SyntaxFeature.Comments]),E=!0===(null==u?void 0:u[c.SyntaxFeature.Statements]),P=!(0,p.stringStartsWith)(e.statementSeparator,e.columnSeparator)&&!(0,p.stringStartsWith)(e.statementSeparator,e.rowSeparator),N=!(0,p.stringStartsWith)(e.statementSeparator,e.listSeparator)&&!(0,p.stringStartsWith)(e.statementSeparator,e.decimalSeparator),I=(0,d.makeProgressAsserter)("calc.parse.tokenize",v);for(;v<a.length;){I(v);const s=Z(e,r,n,a,v,g);if(null!=s){v=s;continue}const u=(0,m.stringCodePointAt)(a,v),c=f.length>0&&f[f.length-1].delim===o.DelimId.Brace;if(ee(e,a,v,g)){const r=G(e,t,a,v,g);if(null!=r){v=r;continue}}if(u!==F)if(!e.isIdentContinue(u)||(0,p.stringStartsWith)(a,e.listSeparator,v)||c&&(0,p.stringStartsWith)(a,e.columnSeparator,v)||c&&(0,p.stringStartsWith)(a,e.rowSeparator,v))if(u!==R)if((0,l.isSpace)(u)){const[e,t]=(0,d.scanWhile)(a,v,$);v=(0,o.appendToken)(t-v,(0,o.spacesToken)(v,e),g)}else if(u!==b)if(u!==T)if((0,p.stringStartsWith)(a,e.leftBrace,v))f.push({delim:o.DelimId.Brace,lastParen:f.length>0?f[f.length-1].lastParen:void 0,lastBrace:f.length}),v=(0,o.appendToken)(e.leftBrace.length,(0,o.leftBraceToken)(v,e.leftBrace),g);else if((0,p.stringStartsWith)(a,e.rightBrace,v)){const t=f.length>0?f[f.length-1].lastBrace:void 0;void 0!==t&&(f.length=t),v=(0,o.appendToken)(e.rightBrace.length,(0,o.rightBraceToken)(v,e.rightBrace),g)}else if((0,p.stringStartsWith)(a,e.leftBracket,v))v=J(e,a,v,g);else if((0,p.stringStartsWith)(a,e.rightBracket,v))v=(0,o.appendToken)(e.rightBracket.length,(0,o.rightBracketToken)(v,e.rightBracket),g);else{if(c){if(E&&P&&(0,p.stringStartsWith)(a,e.statementSeparator,v))break;if((0,p.stringStartsWith)(a,e.columnSeparator,v)){v=(0,o.appendToken)(e.columnSeparator.length,(0,o.colSepToken)(v,e.columnSeparator),g);continue}if((0,p.stringStartsWith)(a,e.rowSeparator,v)){v=(0,o.appendToken)(e.rowSeparator.length,(0,o.rowSepToken)(v,e.rowSeparator),g);continue}}if(E&&(0,p.stringStartsWith)(a,e.statementSeparator,v)&&(N||0===f.length))break;if((0,p.stringStartsWith)(a,e.listSeparator,v))v=(0,o.appendToken)(e.listSeparator.length,(0,o.listSepToken)(v,e.listSeparator),g);else if(u!==C)if(u!==k){if(u===A&&v+1<a.length&&y){const e=a.charCodeAt(v+1);if(e===A){const[e,t]=(0,d.scanWhile)(a,v,Q);v=(0,o.appendToken)(t-v,(0,o.singleLineCommentToken)(v,e),g);continue}if(e===S){let[e,t]=(0,d.scanWhile)(a,v+2,Y);const r=(0,p.stringStartsWith)(a,"*/",t);(0,i.assertTrue)("calc.parse.tokenize: /**/",r||t===a.length),t+=r?2:0,e="/*"+e+(r?"*/":""),v=(0,o.appendToken)(t-v,(0,o.multiLineCommentToken)(v,e,r),g);continue}}if(x(u)){if((0,p.stringStartsWith)(a,":=",v)&&(0,h.isFeatureEnabled)(h.FeatureName.CalcLambdaDefaultParameters)){v=(0,o.appendToken)(2,(0,o.assignSepToken)(v),g);continue}v=B(a,v,g)}else v=(0,o.appendToken)((0,m.numCodeUnits)(u),(0,o.unexpectedToken)(v,(0,m.stringFromCodePoint)(u)),g)}else v=X(e,a,v,g);else v=(0,o.appendToken)(1,(0,o.qualSepToken)(v),g)}else{const e=f.length>0?f[f.length-1].lastParen:void 0;void 0!==e&&(f.length=e),v=(0,o.appendToken)(1,(0,o.rightParenToken)(v),g)}else f.push({delim:o.DelimId.Paren,lastParen:f.length,lastBrace:f.length>0?f[f.length-1].lastBrace:void 0}),v=(0,o.appendToken)(1,(0,o.leftParenToken)(v),g);else{const t=q(e,a,v,g);if(null!=t){v=t;continue}v=B(a,v,g)}else{const[t,r]=(0,d.scanWhile)(a,v,((t,r)=>e.isIdentContinue((0,m.stringCodePointAt)(t,r))));v=(0,o.appendToken)(r-v,(0,o.identOrBooleanToken)(e,v,t),g)}else v=j(a,v,g)}return[g,v]}(e,t,r,n,a,s,u),v=[];let y=0;for(;y<g.length;){const e=g[y];if(e.kind!==o.TokenKind.Unexpected)v.push(e),y+=1;else{const[e,t]=te(g,y,o.TokenKind.Unexpected,((e,t)=>{const r=e,n=t;return(0,o.unexpectedToken)(r.start,r.chars+n.chars)}));v.push(e),y=t}}return v.push((0,o.endToken)(f)),v}},50019:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scanEscapedWhile=t.getEscapedSkip=t.scanWhile=t.makeProgressAsserter=void 0;const n=r(65556),i=r(2910),o=r(42665);function a(e,t,r,n,i){return r(e,t)?1:(0,o.stringStartsWith)(e,n,t)&&t+n.length<e.length&&i(e,t+n.length)?2:0}t.makeProgressAsserter=function(e,t){let r=t-1;return function(t){if(t<=r){const r=`${e}: internal error: no progress made at index ${t}`;return(0,n.assertFalse)(r)}r=t}},t.scanWhile=function(e,t,r){let n=t;for(;n<e.length&&r(e,n);)n+=(0,i.numCodeUnits)((0,i.stringCodePointAt)(e,n));return[e.substring(t,n),n]},t.getEscapedSkip=a,t.scanEscapedWhile=function(e,t,r,n,o){const s=[];let l=t,u=t;for(;u<e.length;){const t=a(e,u,r,n,o);if(0===t)break;2===t&&(l!==u&&s.push(e.substring(l,u)),l=u+n.length,u+=n.length),u+=(0,i.numCodeUnits)((0,i.stringCodePointAt)(e,u))}return l!==u&&s.push(e.substring(l,u)),[s.join(""),u]}},91889:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAnalyzer=void 0;const n=r(37883);t.createAnalyzer=n.analyzeService.createAnalyzer},30006:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.staticPrecedents=t.summarizeFormulaDiagnostics=t.diagnostics=t.createAnalyzeGlobals=t.analyzeLocalsName=t.analyzeLocalsGrid=void 0;const n=r(37883);t.analyzeLocalsGrid=n.analyzeServiceTypes.analyzeLocalsGrid,t.analyzeLocalsName=n.analyzeServiceTypes.analyzeLocalsName,t.createAnalyzeGlobals=n.analyzeServiceTypes.createAnalyzeGlobals,t.diagnostics=n.analyzeServiceTypes.diagnostics,t.summarizeFormulaDiagnostics=n.analyzeServiceTypes.summarizeFormulaDiagnostics,t.staticPrecedents=n.analyzeServiceTypes.staticPrecedents},13756:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAnalyzer=t.createAnalyzeGlobals=t.staticPrecedents=t.summarizeFormulaDiagnostics=t.diagnostics=t.analyzeLocalsName=t.analyzeLocalsGrid=void 0;const n=r(19181),i=n.__importStar(r(30006)),o=n.__importStar(r(91889));t.analyzeLocalsGrid=i.analyzeLocalsGrid,t.analyzeLocalsName=i.analyzeLocalsName,t.diagnostics=i.diagnostics,t.summarizeFormulaDiagnostics=i.summarizeFormulaDiagnostics,t.staticPrecedents=i.staticPrecedents,t.createAnalyzeGlobals=i.createAnalyzeGlobals,t.createAnalyzer=o.createAnalyzer},58293:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.evalFormulaFormatToUnion=t.cellFormatToInferredFormat=t.namedObjectToNamedObjectData=t.namedObjectDataToNamedObject=t.readOperToCellValue=t.cellValueToReadOper=t.createExcludeCellSet=t.gridCellToCellLocation=t.sheetGridRangeToLocation=t.sheetGridRangeToHiddenCols=t.sheetGridRangeToHiddenRows=t.sheetGridRangeToCellSet=t.unusedCellsUpdateToUsedRange=t.sheetCellLocationToGridCell=t.sheetRangeLocationToGridRange=t.localeInfoFromData=t.createLocaleInfo=void 0;const n=r(12450),i=r(55340),o=r(7793),a=r(31053),s=r(25201),l=r(55380),u=r(88928),c=r(30333),d=r(50338),m=r(20456),g=r(83102),p=r(57264),h=r(47324),f=r(20778),S=r(73693),v=r(71510);function y(e,t){const r=(0,n.makeStringCompareCI)("en-US"),{getWorksheetFuncId:o,getWorksheetFuncName:a}=function(e,t,r){const n=(0,i.getEnglishWorksheetFuncIdToName)().slice();return(0,h.filterCheck)(t,h.chWorksheetFunctionName,r,"localeData.worksheetFunctionNames").forEach((e=>n[e.functionId]=e.functionName)),(0,i.createWorksheetFuncNameCallbacks)(e,n)}(r,e.worksheetFunctionNames,t),s=(l=e.thousandsData,(0,n.isNone)(l)?e=>e>0&&e%3==0:(0,i.createIsThousandsPositionCallback)(l));var l;const u=function(e,t){const r=i.englishErrorNames.slice();return(0,h.filterCheck)(e,h.chErrorTypeName,t,"localeData.errorTypeNames").forEach((e=>r[e.errorType]=e.errorName)),r}(e.errorTypeNames,t),{lcid:c}=e,d=c===i.LCID.Thailand,m=c===i.LCID.Korea,g=c===i.LCID.Japan,p=c===i.LCID.ChinaT||c===i.LCID.HongKong,f=c===i.LCID.China,S=m||g||f||p,v=c===i.LCID.Hindi||c===i.LCID.Tamil,y=c===i.LCID.Thailand||c===i.LCID.Vietnam||v,F=(c&i.LCID.LANG)==(i.LCID.Hebrew&i.LCID.LANG)||(c&i.LCID.LANG)==(i.LCID.Arabic&i.LCID.LANG)||c===i.LCID.Syriac||y,C=";"===e.listSeparator||";"===e.decimalSeparator?";;":";";return Object.assign(Object.assign({},e),{leftBracket:"[",rightBracket:"]",rcLeftBracket:e.leftBracket,rcRightBracket:e.rightBracket,getWorksheetFuncId:o,getWorksheetFuncName:a,isNumeral:i.isNumeral,getOrdinal:i.getOrdinal,getNumberShape:i.getNumberShape,isThousandsPosition:s,isIdentStart:i.isIdentStart,isIdentContinue:i.isIdentContinue,stringCompareCI:r,errorNames:u,statementSeparator:C,isThai:d,isEastAsia:S,isKorea:m,isJapan:g,isChinaT:p,isChinaS:f,isComplexScript:F})}function F(e,t){return(0,n.isNone)(t)?{index:e,length:1}:{index:e,length:(0,n.fastAbs)(t-e)+1}}function C(e,t){const{index:r,length:n}=F(t.row,t.lastRow),{index:i,length:a}=F(t.column,t.lastColumn);return(0,o.sheetGridRange)((0,o.sheetIndex)(e,t.sheetId),(0,o.gridRange)(r,i,n,a))}function R(e){return(0,d.isSheetGridCell)(e)?(0,a.sheetRangeLocation)(e.sheet.index,e.range.row,e.range.col):(0,a.sheetRangeLocation)(e.sheet.index,e.range.row,e.range.col,e.range.row+e.range.rows-1,e.range.col+e.range.cols-1)}t.createLocaleInfo=y,t.localeInfoFromData=function(e){return y(e,{})},t.sheetRangeLocationToGridRange=C,t.sheetCellLocationToGridCell=function(e,t){const{row:r,column:n}=t;return(0,o.sheetGridCell)((0,o.sheetIndex)(e,t.sheetId),(0,o.gridCell)(r,n))},t.unusedCellsUpdateToUsedRange=function(e,t){const{sheetId:r,usedRange:i}=t;return(0,n.isDefined)(i)?C(e,Object.assign({sheetId:r},i)):(0,u.sheetUsedRange)((0,o.sheetIndex)(e,r),l.emptyUsedRange)},t.sheetGridRangeToCellSet=function({sheet:e,range:t},r,n){const i=function(e,t,r){const n=(0,g.createFromProduct)({row:t}),i=(0,g.createFromProduct)({col:r}),o=(0,g.unionProduct)(n,i);return(0,g.exceptProduct)((0,s.createCellSetFromRange)(e),o)}(t,r,n);return{sheet:e,set:i}},t.sheetGridRangeToHiddenRows=function({sheet:e,range:t},r){return{sheet:e,range:t,hidden:r}},t.sheetGridRangeToHiddenCols=function({sheet:e,range:t},r){return{sheet:e,range:t,hidden:r}},t.sheetGridRangeToLocation=R,t.gridCellToCellLocation=function({row:e,col:t}){return{row:e,column:t}},t.createExcludeCellSet=function(e,t,r,i){let o=m.empty;if((0,n.isNone)(i))return o;for(let a=0;a<i.length;a+=1){const s=i[a];if(e<=s&&s<e+t){let e=1;for(;a+e<i.length&&i[a+e]===s+e;)e+=1;a+=e-1,o=(0,m.union)(o,r((0,n.pair)(s,s+e)))}}return o},t.cellValueToReadOper=function(e,t){switch(typeof t){case"string":return(0,c.stringOper)(t);case"boolean":return(0,c.booleanOper)(t);case"number":return e.fromNumber(t)}switch(t.kind){case"Blank":return c.blankOper;case"Error":return(0,c.errorOper)(t.type);default:return}},t.readOperToCellValue=function(e,t){switch(t.kind){case S.OperKind.String:case S.OperKind.Boolean:return t.value;case S.OperKind.Number:return e.toNumber(t);case S.OperKind.Error:return(0,a.errorValue)(t.type);case S.OperKind.Blank:return a.blankValue;default:return}},t.namedObjectDataToNamedObject=function(e,t,r,i){if(!(0,n.isNone)(i))switch(i.kind){case"NamedValue":switch(typeof i.value){case"string":return(0,f.namedValue)((0,c.stringOper)(i.value));case"boolean":return(0,f.namedValue)((0,c.booleanOper)(i.value));case"number":return(0,f.namedValue)(e.fromNumber(i.value))}return"Error"===i.value.kind?(0,f.namedValue)((0,c.errorOper)(i.value.type)):(0,p.assertNever)("calc.calc.namedObjectDataToNamedObject: NamedValue",i.value.kind);case"NamedFormula":return(0,f.namedFormula)(i.formulaBarText);case"NamedRange":{const e=C(r,i.range);return(0,f.namedRange)((0,c.range3DOper)(e.sheet,e.range))}case"NamedTable":{const e=C(r,i.range);return(0,f.namedTable)(e,i.hasHeadersRow,i.hasTotalsRow,i.columns,t)}case"NamedFailure":return(0,f.namedFailure)(i.failureReason,(0,n.isNone)(i.objectKind)?void 0:i.objectKind);default:return(0,p.assertNever)("calc.calc.namedObjectDataToNamedObject: kind",i)}},t.namedObjectToNamedObjectData=function(e,t,r){if(r)switch(r.kind){case"NamedValue":switch(r.value.kind){case S.OperKind.Number:return(0,a.namedValueData)(e.toNumber(r.value));case S.OperKind.String:case S.OperKind.Boolean:return(0,a.namedValueData)(r.value.value);case S.OperKind.Error:return(0,a.namedValueData)(r.value.type);default:return}case"NamedFormula":return(0,a.namedFormulaData)(r.fmla);case"NamedRange":{const e=(0,o.sheetGridRange)((0,o.sheetIndex)(t,r.value.sheets.index),r.value.ranges[0]);return(0,a.namedRangeData)(R(e))}case"NamedTable":{const e=r.specialRefRanges[v.SpecialRefId.Data],t=[];return r.columnIndexes.forEach(((e,r)=>(t.push((0,a.columnData)(e,r)),!0))),(0,a.namedTableData)(R(e),r.hasHeadersRow,r.hasTotalsRow,t)}case"NamedFailure":return r;default:return(0,p.assertNever)("calc.calc.namedObjectToNamedObjectData: kind",r)}},t.cellFormatToInferredFormat=function(e){if(void 0!==e)return(0,u.isOutputFormatUnavailable)(e.format)?(0,a.inferredFormat)({kind:e.format.kind},e.valueType,e.decimals):(0,a.inferredFormat)(e.format,e.valueType,e.decimals)},t.evalFormulaFormatToUnion=function(e){if(null!=e)switch(e.kind){case"Origin":return{kind:u.SpecialFormat.Origin};case"Iformat":return(0,p.assertTrue)("calc.calc.evalFormulaFormatToUnion: iformat","number"==typeof e.iformat),e.iformat;case"Known":return(0,p.assertTrue)("calc.calc.evalFormulaFormatToUnion: knownFormat","number"==typeof e.knownFormat),{kind:u.SpecialFormat.Known,knownFormat:e.knownFormat};case"Inferred":return{kind:u.SpecialFormat.Inferred};case"Aggregate":return{kind:u.SpecialFormat.Aggregate};default:return(0,p.assertNever)("calc.calc.evalFormulaFormatToUnion: kind",e.kind)}}},87512:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExceLintExperiment=void 0;const n=r(7793),i=r(5055),o=r(57777),a=r(75653),s=r(36665),l=r(57264),u=r(55340),c=r(33436),d=r(71510);t.ExceLintExperiment=class{get done(){return!0}setContext({documents:e}){try{l.ulsLogger.ULS.traceTag(578588694,u.LogCategory.msoulscat_ES_EWAJS,u.TraceLevel.Info,"calc.calc.RecalcService: ExceLint experiment setContext started");const t=function(e){var t,r,i,s;const l=e.getServerDocument(),u=[];for(const m of e.getServerAvailableCells()){let g="UndefinedSheet";if(void 0!==l){const t=e.getSheetName(l,m.sheetIdx.index);t.kind===c.ResultKind.Success&&(g=t.value)}const p=e.getServerUsedRange(m.sheetIdx);if(p.kind===c.ResultKind.Failure||void 0===p.value)continue;const h=p.value.sheet,f=Object.assign({},p.value.range);f.cols=Math.min(f.cols,75),f.rows=Math.min(f.rows,1e3);const S=[],v=[],y=[];let F=0;for(let a=f.row,l=f.row+f.rows-1;a<=l;a+=1){const l=[],u=[],d=[];for(let m=f.col,g=f.col+f.cols-1;m<=g;m+=1){const g=(0,n.sheetGridCell)(h,(0,n.gridCell)(a,m)),p=e.getServerValue(g),f=p.kind===c.ResultKind.Success?JSON.stringify(p.value):"";u.push(f);const S=e.getServerFormat(g),v=S.kind===c.ResultKind.Success?(0,o.fnv1a)(JSON.stringify(S.value)).toString():"";d.push(v);const y=e.getServerFormula(g),C=y.kind===c.ResultKind.Success?null===(r=null===(t=y.value)||void 0===t?void 0:t[1].compiledFmla)||void 0===r?void 0:r.getValue():void 0,R=(null==C?void 0:C.kind)===c.ResultKind.Success&&null!==(s=null===(i=y.value)||void 0===i?void 0:i[1].fmla)&&void 0!==s?s:"";""!==R&&(F+=1),l.push(R)}S.push(l),v.push(u),y.push(d)}if(0===F)continue;const C={sheetName:g,usedRangeAddress:(0,a.formatGridRange)(e.config.localeInfo,f,d.RefStyle.A1,g),values:v,formulas:S,styles:y};u.push(C)}return{workbookName:"PartialWorkbook",worksheets:u}}(e);this.result=(0,i.detect_errors)(t,void 0,void 0,this.timeLimitMS)}catch(e){this.result=`ExceLint experiment crashed with error: ${e}`}}step(){}get report(){return void 0===this.result||"string"==typeof this.result?[]:Object.keys(this.result.worksheets).map((e=>{const t=this.result.worksheets[e],r=t.exampleFixes.map(((e,r)=>{const n=t.proposedFixes[r][0],i=e.rangeSizes,o=i.reduce(((e,t)=>e+t),0);return{anomalousnessIndex:n,categories:e.bin,sizeOfCellRange:o,sizeOfEachSFRRange:i,redactedFormulaForEachSFR:e.formulas.map(s.anonymizeFormulaString),stylesDiffer:!e.sameFormat,operatorsDiffer:null,direction:e.direction}})),n=r.map((e=>e.sizeOfEachSFRRange.length)).reduce(((e,t)=>e+t),0);return{totalFormulas:t.numFormulaCells,totalSimilarFormulaRanges:n,numberOfAdjacentSFRs:r.length,numberOfAnomalousRanges:t.suspiciousRanges,numberOfCellsInAnomalousRanges:t.suspiciousCells,anomalies:r,elapsedTimeSeconds:t.elapsedTimeSeconds,proposedFixesTimeSeconds:t.proposedFixesTimeSeconds,adjustProposedFixesTimeSeconds:t.adjustProposedFixesTimeSeconds,adjustFormatProposedFixesTimeSeconds:t.adjustFormatProposedFixesTimeSeconds,exampleFixesTimeSeconds:t.exampleFixesTimeSeconds,numCountingTimeSeconds:t.numCountingTimeSeconds,columns:t.columns,rows:t.rows}})).filter((e=>e.totalFormulas>0))}get resultLogMessage(){return"string"==typeof this.result?this.result:void 0===this.result?"ExceLint experiment return <undefined>":`ExceLint experiment done. Result: ${JSON.stringify(this.report)}`}get failedLogMessage(){return this.resultLogMessage+" BTW, experiment ran out of time budget"}constructor(e=75){this.timeLimitMS=e,this.result=void 0}}},73362:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrecisionExperiment=t.PrecisionStopReason=t.PrecisionMessageKind=t.precisionValue=void 0;const n=r(50338),i=r(7793),o=r(12450),a=r(57777),s=r(36665),l=r(20456),u=r(20665),c=r(42261),d=r(88928),m=r(55380),g=r(25201),p=r(83102),h=r(55340),f=r(57264),S=r(73693),v=r(33436),y=r(39986),F=r(96438),C=r(64303),R=r(23623),b=r(81476);function E(e,t){switch(t.kind){case S.OperKind.Number:return{kind:"n",magnitude:(0,s.anonymizeMagnitude)(e.toNumber(t))};case S.OperKind.String:return{kind:"s"};case S.OperKind.Boolean:return{kind:"b"};case S.OperKind.Error:return{kind:"e",type:(0,h.englishErrorTypeToName)(t.type)};case S.OperKind.Rich:return{kind:"r"};case S.OperKind.Array:return{kind:"a"};case S.OperKind.Blank:return{kind:"z"};default:return(0,f.assertNever)("calc.calc.precisionValue",t)}}var T,k;function P(e,t){const r=e[t.sheet.index];return void 0!==r&&(0,p.meetsProduct)(r,(0,g.createCellSetFromRange)(t.range))}function N(e,t){var r;const n=null!==(r=e[t.sheet.index])&&void 0!==r?r:l.empty;e[t.sheet.index]=(0,p.unionProduct)(n,(0,g.createCellSetFromRange)(t.range))}t.precisionValue=E,function(e){e.EvalStatistics="EvalStatistics",e.PrintFormulaStatistics="PrintFormulaStatistics",e.UnhandledFailure="UnhandledFailure"}(T||(t.PrecisionMessageKind=T={})),function(e){e.Success="Success",e.Timeout="Timeout"}(k||(t.PrecisionStopReason=k={}));const A={[F.OperatorId.Add]:.05,[F.OperatorId.Sub]:.069,[F.OperatorId.Eq]:.097,[F.OperatorId.Mul]:.1,[F.OperatorId.Div]:.11,[F.OperatorId.Concat]:.36,[F.OperatorId.Gt]:.65,[F.OperatorId.Ne]:.79,[F.OperatorId.Lt]:.89,[F.OperatorId.Le]:1.6,[F.OperatorId.Ge]:1.9,[F.OperatorId.Percent]:2.9,[F.OperatorId.At]:6.2,[F.OperatorId.Pow]:13,[F.OperatorId.Range]:67},I={[F.WorksheetFuncId.IF]:.076,[F.WorksheetFuncId.SUM]:.11,[F.WorksheetFuncId.IFERROR]:.5,[F.WorksheetFuncId.COUNTIF]:.77,[F.WorksheetFuncId.AND]:.82,[F.WorksheetFuncId.VLOOKUP]:1.5,[F.WorksheetFuncId.AVERAGE]:1.5,[F.WorksheetFuncId.HOUR]:1.9,[F.WorksheetFuncId.MINUTE]:1.9,[F.WorksheetFuncId.TEXT]:2,[F.WorksheetFuncId.OR]:2,[F.WorksheetFuncId.NOW]:2.1,[F.WorksheetFuncId.ISBLANK]:2.3,[F.WorksheetFuncId.CONCATENATE]:2.6,[F.WorksheetFuncId.SUMIF]:2.7,[F.WorksheetFuncId.COUNTIFS]:3.3,[F.WorksheetFuncId.LEFT]:3.4,[F.WorksheetFuncId.ISNUMBER]:3.7,[F.WorksheetFuncId.MID]:3.9,[F.WorksheetFuncId.COUNTA]:4,[F.WorksheetFuncId.MONTH]:4.2,[F.WorksheetFuncId.SECOND]:4.3,[F.WorksheetFuncId.LEN]:4.9,[F.WorksheetFuncId.WEEKNUM]:5,[F.WorksheetFuncId.DAY]:5.2,[F.WorksheetFuncId.ROUND]:5.4,[F.WorksheetFuncId.FIND]:5.8,[F.WorksheetFuncId.NETWORKDAYS]:6.2,[F.WorksheetFuncId.COUNT]:6.2,[F.WorksheetFuncId.YEAR]:6.3,[F.WorksheetFuncId.INT]:6.4,[F.WorksheetFuncId.RIGHT]:6.7,[F.WorksheetFuncId.ABS]:7,[F.WorksheetFuncId.CONCAT]:7.2,[F.WorksheetFuncId.CHAR]:7.4,[F.WorksheetFuncId.MAX]:8,[F.WorksheetFuncId.ROW]:8.1,[F.WorksheetFuncId.WEEKDAY]:9.1,[F.WorksheetFuncId.DAYS]:9.2,[F.WorksheetFuncId.MIN]:9.8,[F.WorksheetFuncId.SEARCH]:9.8,[F.WorksheetFuncId.WORKDAY]:11,[F.WorksheetFuncId.DATEDIF]:12,[F.WorksheetFuncId.TIME]:13,[F.WorksheetFuncId.HYPERLINK]:13,[F.WorksheetFuncId.IFS]:13,[F.WorksheetFuncId.ISERROR]:13,[F.WorksheetFuncId.COUNTBLANK]:14,[F.WorksheetFuncId.TODAY]:14,[F.WorksheetFuncId.VALUE]:18,[F.WorksheetFuncId.ROUNDUP]:18,[F.WorksheetFuncId.MATCH]:19,[F.WorksheetFuncId.DATE]:20,[F.WorksheetFuncId.SUBSTITUTE]:20,[F.WorksheetFuncId.INDIRECT]:22,[F.WorksheetFuncId.INDEX]:23,[F.WorksheetFuncId.TRIM]:24,[F.WorksheetFuncId.UPPER]:25,[F.WorksheetFuncId.SUMIFS]:28,[F.WorksheetFuncId.EXACT]:29,[F.WorksheetFuncId.NOT]:32,[F.WorksheetFuncId.PRODUCT]:35,[F.WorksheetFuncId.ROUNDDOWN]:37,[F.WorksheetFuncId.AVERAGEIF]:38,[F.WorksheetFuncId.ISTEXT]:40,[F.WorksheetFuncId.ISOWEEKNUM]:41,[F.WorksheetFuncId.EOMONTH]:42,[F.WorksheetFuncId.MROUND]:45,[F.WorksheetFuncId.COLUMN]:45,[F.WorksheetFuncId.ROWS]:46,[F.WorksheetFuncId.TIMEVALUE]:52,[F.WorksheetFuncId.TRUNC]:53,[F.WorksheetFuncId.LOOKUP]:59,[F.WorksheetFuncId.NA]:59,[F.WorksheetFuncId.DAYS360]:61,[F.WorksheetFuncId.RANK]:67,[F.WorksheetFuncId.EDATE]:72,[F.WorksheetFuncId.MOD]:82,[F.WorksheetFuncId.OFFSET]:83,[F.WorksheetFuncId.STDEV]:87,[F.WorksheetFuncId.SUBTOTAL]:91},O=(0,y.binaryVisitor)(Object.assign(Object.assign({},(0,y.constVisitor)(.01)),{nameNode:()=>1,operatorNode:e=>{var t;return null!==(t=A[e])&&void 0!==t?t:100},wsfNode:e=>{var t;return null!==(t=I[e])&&void 0!==t?t:100}}),o.fastMax);t.PrecisionExperiment=class{get done(){return void 0!==this.result}get resultLogMessage(){return this.createResultLogMessage(k.Success)}get failedLogMessage(){return this.createResultLogMessage(k.Timeout)}get readonlyDebugLog(){return this.log}setContext(e){this.stateId=e.stateId,this.docs=e.documents,this.docs.reconfigure({yieldIntervalMs:e.stepBudget/2,totalTimeMs:e.totalBudget},this.docs.limits,this.docs.maxDereferenceCells,this.docs.isServerWorkbookLoad),this.runtime=new u.MachineRuntime(this.sampleCells().bind((({evalCells:e,printCells:t})=>c.Pledge.all([...e.map(this.testEval),...t.map(this.testPrint)]))).catch((e=>{this.log.push({kind:T.UnhandledFailure,reason:e})})))}step(){if(this.result)return;const e=this.runtime.step();this.result=e.kind===C.TransitionKind.Break||e.kind===C.TransitionKind.Next?void 0:e}sampleCells(){const e=[],t=[],r=[];return this.docs.getServerAvailableCells().forEach((({sheetIdx:n})=>(r.push(c.Pledge.try((()=>{this.docs.forEachServerNonBlankCellInSet(n,l.dense,(r=>{const a=(0,i.sheetGridCell)(n,r),{samplePrecisionEvalRate:s,samplePrecisionPrintFormulaRate:l,samplePrecisionPrintValueRate:u}=this.config;if(s>0){const t=this.getWeight(a),r=void 0===t?void 0:s>=1?1:(0,o.fastMin)(1,s*t);void 0!==r&&this.rng.next()<r&&(N(this.sampledSets,a),e.push({cell:a,p:r}))}const c=(0,o.fastMax)(l,u);if(c>0){const e=this.rng.next();if(e<c){const r=this.isValueCell(a)?u:l;e<r&&t.push({cell:a,p:r})}}return!0}))}))),!0))),c.Pledge.all(r).bind((()=>({evalCells:e,printCells:t})))}getWeight(e){const t=this.getFormula(e);if(!(0,v.isSuccess)(t))return this.onUnavailableObject(t.reason);const[,r]=t.value;return void 0!==r.compiledFmla?function(e){return(0,v.isSuccess)(e)?(0,y.reduceBottomUp)(O,e.value):1}(r.compiledFmla.getValue()):void 0}isValueCell(e){const t=this.getFormula(e);return(0,v.isSuccess)(t)?void 0===t.value[1].compiledFmla:(this.onUnavailableObject(t.reason),!1)}resumeToPledge(e,t){return c.Pledge.try((()=>{try{this.p=t;const r=e();return Array.isArray(r)?r:this.resumeToPledge(r.resume,t)}finally{this.p=void 0}}))}getFormula(e){var t;const r=this.docs.getEditedFormula(e);if(!(0,v.isSuccess)(r))return r;const[n,o]=null!==(t=r.value)&&void 0!==t?t:[e.range,m.blankCellGridFormula],a=(0,i.lexicalSourceGrid)(o.lexicalKind,(0,i.sheetGridRange)(e.sheet,n));return(0,v.success)([a,o])}onRangeFailure(e,t,r,n,i){const o={samples:[],failures:[t]};this.log.push({kind:T.EvalStatistics,stats:o})}onNameFailure(){}onNumberFormatFailure(){}onInferFormatFailure(){}onReturnCellValue(){}onUnavailableObject(e){const t=(0,n.unavailable)([e]);this.onUnavailable(t)}onUnavailable(e){this.log.push({kind:T.UnhandledFailure,reason:e})}hasWrongPrecedent(e){return e.cells.some((e=>P(this.precisionWrongSets,e)))}onSetCellValue(e,t,r,n,i){const o=this.getFormula(e);if(!(0,v.isSuccess)(o))return this.onUnavailableObject(o.reason);const[a,s]=o.value,l=this.hasWrongPrecedent(r);return this.logPrecisionResult(e,t,a,s,l)}onSetCellValues(e,t,r,o,a){const s=this.getFormula((0,n.sheetGridRangeAnchor)(e));if(!(0,v.isSuccess)(s))return this.onUnavailableObject(s.reason);const[l,u]=s.value,c=this.hasWrongPrecedent(r);(0,n.forEachCellInRange)(e.range,((r,n,o)=>(this.logPrecisionResult((0,i.sheetGridCell)(e.sheet,r),t[n][o],l,u,c),!0)))}logPrecisionResult(e,t,r,n,i){const o=this.docs.allServerAvailable(e);if(!(0,v.isSuccess)(o))return this.onUnavailableObject(o.reason);if(!0!==o.value)return;const a=this.docs.getServerValue(e);if(!(0,v.isSuccess)(a))return this.onUnavailableObject(a.reason);const s=P(this.sampledSets,e),l=this.precisionResult(t,a.value.oper,r,n,s,i);(function(e){return void 0===e.sampled})(l)||N(this.precisionWrongSets,e);const u={samples:[l],failures:[]};this.log.push({kind:T.EvalStatistics,stats:u})}precisionResult(e,t,r,i,o,a){const l=this.p,{mathpack:u}=this.docs.config,c=E(u,t),[d,m]=this.docs.anonymizeFormula(r,i);if((0,n.isReadOperEqual)(u,e,t,!0))return{expected:c,formula:d,functions:m,root:o,cascaded:a,p:l};const g=E(u,e);if((0,n.isNumberOper)(t)&&(0,n.isNumberOper)(e)){const r=u.toNumber(t),n=u.toNumber(e);return{expected:c,sampled:g,relMagnitude:(0,s.anonymizeMagnitude)(0===r?n:(n-r)/r),formula:d,functions:m,root:o,cascaded:a,p:l}}return{expected:c,sampled:g,formula:d,functions:m,root:o,cascaded:a,p:l}}createResultLogMessage(e){if(0===this.log.length&&e===k.Success)return;const t={samples:[],failures:{}},r={samples:[],failures:{}},n={};for(const e of this.log)switch(e.kind){case T.EvalStatistics:t.samples.push(...e.stats.samples);for(const r of e.stats.failures)(0,R.incrementFailure)(t.failures,r);break;case T.PrintFormulaStatistics:r.samples.push(...e.stats.samples);for(const t of e.stats.failures)(0,R.incrementFailure)(r.failures,t);break;case T.UnhandledFailure:(0,R.incrementFailure)(n,e.reason);break;default:(0,f.assertNever)("calc.calc.PrecisionExperiment.createResultMessage",e)}return["PrecisionExperiment",e,`stateId = ${this.stateId}`,`evalStats = ${JSON.stringify(t)}`,`printStats = ${JSON.stringify(r)}`,`unhandledFailures = ${JSON.stringify(n)}`].join(", ")}constructor(e){var t,r,n,i;this.sampledSets={},this.precisionWrongSets={},this.log=[],this.result=void 0,this.testEval=({cell:e,p:t})=>this.resumeToPledge((()=>this.docs.evaluate(d.ComputeKind.EditedCell,[e],b.VolatileMode.PrecisionTest)),t),this.testPrint=({cell:e,p:t})=>c.Pledge.try((()=>{const r=this.getFormula(e);if(!(0,v.isSuccess)(r))return this.onUnavailableObject(r.reason);const[n,i]=r.value;let o;if(void 0===i.compiledFmla){const t=this.docs.getServerValue(e);if(!(0,v.isSuccess)(t))return this.onUnavailableObject(t.reason);o=this.docs.renderValueBarText(e,t.value.oper,i.fmla)}else{const e=i.compiledFmla.getValue();o=(0,v.isSuccess)(e)?this.docs.printFormulaBarText(n,i.origin,e.value):e}if(!(0,v.isSuccess)(o))return void this.log.push({kind:T.PrintFormulaStatistics,stats:{samples:[],failures:[o.reason]}});const a=(0,s.anonymizeFormulaString)(i.fmla),l=o.value===i.fmla?{expected:a,p:t}:{expected:a,sampled:(0,s.anonymizeFormulaString)(o.value),p:t};this.log.push({kind:T.PrintFormulaStatistics,stats:{samples:[l],failures:[]}})})),this.config={samplePrecisionEvalRate:null!==(t=e.samplePrecisionEvalRate)&&void 0!==t?t:0,samplePrecisionPrintFormulaRate:null!==(r=e.samplePrecisionPrintFormulaRate)&&void 0!==r?r:0,samplePrecisionPrintValueRate:null!==(n=e.samplePrecisionPrintValueRate)&&void 0!==n?n:0,rngSeed:null!==(i=e.rngSeed)&&void 0!==i?i:0|(0,o.now)()},this.rng=new a.JSF32(this.config.rngSeed)}}},35268:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.Messages=void 0,function(e){e.Root="calc.exp.UnitExperiment",e.Default="uninitialised",e.Initialised="init",e.Failure="fail",e.UnifyBound="unifyBound"}(r||(t.Messages=r={}))},40285:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runSolverStep=t.numberFormatFromCellFormat=t.valueTypeFromCellFormat=t.updateFormatStatsFromCellFormat=t.isInterestingFormat=t.makeSolverContext=t.ConstraintKind=t.UnitExperimentSettings=void 0;const n=r(99796),i=r(10051),o=r(35268),a=r(40773),s=r(7793),l=r(50338),u=r(57264),c=r(25201),d=r(88928),m=r(83102),g=r(94591),p=r(33436),h=r(42549);var f,S;t.UnitExperimentSettings={get UnitlessTimeAndDate(){return(0,h.getTypedFeatureGate)("Microsoft.Office.Excel.UnitlessTimeAndDate")},get IgnoreDivMul(){return(0,h.getTypedFeatureGate)("Microsoft.Office.Excel.UnitExpIgnoreDivMul")}},function(e){e[e.RangeEquality=0]="RangeEquality",e[e.StagedRangeEquality=1]="StagedRangeEquality",e[e.UnitEquality=2]="UnitEquality",e[e.FormatEquality=3]="FormatEquality"}(f||(t.ConstraintKind=f={})),function(e){e[e.Solved=0]="Solved",e[e.Failed=1]="Failed",e[e.Deferred=2]="Deferred",e[e.Staged=3]="Staged"}(S||(S={}));const v={kind:S.Solved},y=e=>({kind:S.Failed,error:e}),F=e=>({kind:S.Deferred,constraint:e}),C=(0,i.fromConstants)({error:1}),R=(0,i.fromConstants)({}),b=(0,i.fromConstants)({currency:1}),E=(0,i.fromConstants)({date:1}),T=(0,i.fromConstants)({time:1});function k(e,t){return void 0===t.link&&(t.link=e.uf.makePoint(t.unit)),t.link}function P(e,t,r,n){return(0,u.assertTrue)(o.Messages.Root,0===r.varCount),e.uf.union(void 0===n?e.uf.makePoint(r):n,t,!0),v}function N(e,t,r,n,a){return t===e.errorUnit?((0,u.assertTrue)(o.Messages.Root,r===e.errorPoint),void 0!==a&&e.uf.union(e.errorPoint,a,!0),v):n===e.errorUnit?((0,u.assertTrue)(o.Messages.Root,a===e.errorPoint),void 0!==r&&e.uf.union(e.errorPoint,r,!0),v):0===t.varCount?0===n.varCount?(0,i.areSignaturesEqual)(t,n)?v:(void 0!==r&&e.uf.union(e.errorPoint,r,!0),void 0!==a&&e.uf.union(e.errorPoint,a,!0),y([t,n])):((0,u.assertTrue)(o.Messages.Root,void 0!==a),P(e,a,t,r)):1===n.varCount?((0,u.assertTrue)(o.Messages.Root,void 0!==r),(0,u.assertTrue)(o.Messages.Root,void 0!==a),e.uf.union(r,a),v):((0,u.assertTrue)(o.Messages.Root,void 0!==r),P(e,r,n,a))}function A(e,t,r){if(!(0,i.isSimpleUnit)(t))return F({kind:f.UnitEquality,unit:t,target:r});const n=k(e,r),[a,s]=e.uf.findWithDescriptor(n);if(1===t.varCount){(0,u.assertTrue)(o.Messages.Root,void 0!==t.name);const r=e.symbolContext.getTable().getValue(t.name);(0,u.assertTrue)(o.Messages.Root,void 0!==r);const[n,i]=e.uf.findWithDescriptor(k(e,r));return N(e,i,n,s,a)}return N(e,t,void 0,s,a)}function I(e,t){if(t===d.SpecialFormat.Unavailable||0===t)return!1;const r=M(e,t);if(void 0===r)return!1;const n=null==r?void 0:r.valueType;return void 0!==n&&n!==g.FormatValueType.General&&(n!==g.FormatValueType.Currency&&n!==g.FormatValueType.Accounting||void 0!==r.currencySymbol)}function O(e,t,r,n){var i,o,a;n?r.referencedFormatCells+=1:r.allFormatCells+=1;const s=M(e,t),l=n?r.enriched.referencedFormatTypes:r.enriched.allFormatTypes,u=null==s?void 0:s.valueType;if(void 0!==u&&(l[u]=(null!==(i=l[u])&&void 0!==i?i:0)+1),u===g.FormatValueType.Currency||u===g.FormatValueType.Accounting){const e=n?r.enriched.referencedCurrencyTypes:r.enriched.allCurrencyTypes,t=null==s?void 0:s.currencySymbol,i=null===(o=null==s?void 0:s.culture)||void 0===o?void 0:o.culture,l=void 0===t?"none":t===g.FormatCurrency.LocaleInfo?"defaultSymbol":t+"_"+i;e[l]=(null!==(a=e[l])&&void 0!==a?a:0)+1}}function _(e,t){var r;return null===(r=M(e,t))||void 0===r?void 0:r.valueType}function M(e,t){if("number"==typeof t){const r=e.getIformat(t);return(0,p.isSuccess)(r)?r.value:void 0}return t}function D(e,t,r){const i=e.typeContext.types[t.index];if(void 0===i)return(0,u.assertFalse)(o.Messages.Root);const a=i.getValue(r);if(void 0===a){const o=(0,s.sheetGridCell)(t,r),a=e.typeContext.formats(o);if((0,p.isSuccess)(a)){if(!I(e.typeContext,a.value)||e.typeContext.isStringValue(o)){const o=e.symbolContext.freshSymbol().unit;return e.typeContext.types[t.index]=i.setValue(r,(0,n.primitiveUnitType)(o)),o}let s=w(e,a.value);return void 0===s?s=e.symbolContext.freshSymbol().unit:O(e.typeContext,a.value,e.stats,!0),e.typeContext.types[t.index]=i.setValue(r,(0,n.primitiveUnitType)(s)),s}const l=e.symbolContext.freshSymbol().unit;return e.typeContext.types[t.index]=i.setValue(r,(0,n.primitiveUnitType)(l)),l}return a.kind===n.TypeKind.Scalar?a.unit:void 0}function w(e,r){const n=_(e.typeContext,r);if(void 0!==n)switch(n){case g.FormatValueType.Currency:case g.FormatValueType.Accounting:return b;case g.FormatValueType.Percentage:return R;case g.FormatValueType.Date:return t.UnitExperimentSettings.UnitlessTimeAndDate?R:E;case g.FormatValueType.Time:return t.UnitExperimentSettings.UnitlessTimeAndDate?R:T;default:return}}function L(e){const t=e.symbolContext.getTable();return r=>{const n=t.getValue(r);if(void 0!==n&&void 0!==n.link)return void 0===n.ufSubstitution&&(n.ufSubstitution=e.uf.findWithDescriptor(n.link)[1]),n.ufSubstitution}}t.makeSolverContext=function(e,t,r){const n=new a.UF,o=n.makePoint(C),s=(0,i.createPoisonApplication)(C);return{symbolContext:e,typeContext:t,stats:r,uf:n,errorPoint:o,errorUnit:C,apply:s}},t.isInterestingFormat=I,t.updateFormatStatsFromCellFormat=O,t.valueTypeFromCellFormat=_,t.numberFormatFromCellFormat=M;const x={[f.UnitEquality]:function(e,t){return A(e,t.unit,t.target)},[f.FormatEquality]:function(e,t){const r=w(e,t.format);if(void 0===r)return v;const n=D(e,t.cell.sheet,t.cell.range);if(void 0===n)return v;if(!(0,i.isSimpleUnit)(n))return F(t);if(1===n.varCount){(0,u.assertTrue)(o.Messages.Root,void 0!==n.name);const t=e.symbolContext.getTable().getValue(n.name);(0,u.assertTrue)(o.Messages.Root,void 0!==t);const[i,a]=e.uf.findWithDescriptor(k(e,t));return N(e,a,i,r,void 0)}return N(e,n,void 0,r,void 0)},[f.RangeEquality]:function(e,t){const r=t.type.resolution;if(!(0,l.isSheetIndex)(r.sheet))return v;if((0,l.isGridCell)(r.range)){const n=D(e,r.sheet,r.range);return void 0===n?v:A(e,n,t.target)}const n=e.typeContext.available[r.sheet.index];if(void 0===n)return v;const i=n.usedRange;if(void 0===i)return v;const o=(0,l.gridRangeIsect)(r.range,i);if(void 0===o)return v;const a=(0,m.intersectProduct)((0,m.intersectProduct)((0,c.createCellSetFromRange)(o),c.availableReadProduct),n.availableCells),s=[];return(0,c.forEachCellInSet)(a,(e=>(s.push(e),!0))),{kind:S.Staged,constraint:{kind:f.StagedRangeEquality,cursor:0,index:n.sheetIdx,cells:s,target:t.target},output:void 0}},[f.StagedRangeEquality]:function(e,t){const{cursor:r,cells:n}=t;if(r>=n.length)return v;const i=n[r],o=D(e,t.index,i),a=void 0===o?v:A(e,o,t.target);return t.cursor+=1,{kind:S.Staged,constraint:t,output:a}}};t.runSolverStep=function(e){return e.kind===n.ExperimentState.SolvingSimple?e.constraintCursor===e.constraints.length?function(e){const{apply:t,errorUnit:r}=e.context,o={kind:n.ExperimentState.SolvingFull,context:e.context,stats:e.stats,constraints:e.deferred,constraintCursor:0,unifyNF:(e,n)=>{const a=t(o.substitution,e);if(a===r)return;const s=t(o.substitution,n);if(s===r)return;const l=(0,i.unify)(t,a,s);l.kind!==i.UnificationResultKind.Subst?(o.stats.errorCount+=1,o.stats.enriched.errors.push({error:[t(o.substitution,e),t(o.substitution,n)]})):o.substitution=(0,i.compose)(t,l.substitution,o.substitution)},substitution:L(e.context)};return o}(e):function(e){const{constraints:t,context:r,constraintCursor:n,deferred:i}=e,o=t[n],a=x[o.kind](r,o);switch(a.kind){case S.Deferred:i.push(a.constraint);break;case S.Failed:e.stats.errorCount+=1,e.stats.enriched.errors.push({error:a.error});break;case S.Staged:if(t[n]=a.constraint,void 0!==a.output)switch(a.output.kind){case S.Deferred:i.push(a.output.constraint);break;case S.Failed:e.stats.errorCount+=1,e.stats.enriched.errors.push({error:a.output.error})}return e}return e.constraintCursor+=1,e}(e):function(e){const{constraints:t,context:r,constraintCursor:n,unifyNF:i}=e,a=t[n];switch(a.kind){case f.UnitEquality:i(a.unit,a.target.unit);break;case f.FormatEquality:const t=w(r,a.format);if(void 0===t)break;const n=D(r,a.cell.sheet,a.cell.range);if(void 0===n)break;i(t,n);break;default:return e.constraintCursor+=1,(0,u.assertNever)(o.Messages.Root,a)}return e.constraintCursor+=1,e}(e)}},99796:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExperimentState=t.isResolvedReferenceType=t.primitiveUnitType=t.primitiveType=t.topType=t.bottomType=t.oneType=t.errorType=t.dimensionlessNumberType=t.dimensionLess=t.numberType=t.stringType=t.boolType=t.typeFromDimensions=t.joinDimensions=t.getLiftingDimensionsFromTypes=t.dimensionsFromType=t.makeArrayType=t.makeResolvedReferenceType=t.makeReferenceType=t.makePrimitiveType=t.TypeKind=void 0;const n=r(50338),i=r(10051),o=r(73693);var a,s;function l(e,t=void 0){return{kind:a.Scalar,flags:e,unit:t}}function u(e){return{kind:a.Reference,reference:e,resolution:void 0}}function c(e,t){return{kind:a.Array,elementType:e,dimensions:t}}function d(e){return{kind:a.Union,flags:e}}function m(e){var t;switch(e.kind){case a.Reference:const r=null===(t=e.resolution)||void 0===t?void 0:t.range;return void 0!==r&&(!!(0,n.isGridCell)(r)||{rows:r.rows,columns:r.cols,exact:!0});case a.Array:return e.dimensions;case a.Scalar:return!0;case a.Union:return!1}}function g(e,t){return"object"==typeof e?"object"==typeof t?{rows:Math.max(e.rows,t.rows),columns:Math.max(e.columns,t.columns),exact:e.exact&&t.exact}:Object.assign(Object.assign({},e),{exact:e.exact&&t}):"object"==typeof t?Object.assign(Object.assign({},t),{exact:t.exact&&e}):e&&t}!function(e){e[e.Scalar=0]="Scalar",e[e.Reference=1]="Reference",e[e.Array=2]="Array",e[e.Union=3]="Union"}(a||(t.TypeKind=a={})),t.makePrimitiveType=l,t.makeReferenceType=u,t.makeResolvedReferenceType=function(e,t){const r=u(e);return r.resolution=t,r},t.makeArrayType=c,t.dimensionsFromType=m,t.getLiftingDimensionsFromTypes=function(e,t){return g(m(e),m(t))},t.joinDimensions=g,t.typeFromDimensions=function(e,t){return!0===t?e:c(e,t)},t.boolType=l(o.OperKind.Boolean),t.stringType=l(o.OperKind.String),t.numberType=l(o.OperKind.Number),t.dimensionLess=(0,i.fromConstants)({}),t.dimensionlessNumberType=l(o.OperKind.Number,t.dimensionLess),t.errorType=l(o.OperKind.Error),t.oneType=l(o.OperKind.Missing|o.OperKind.Blank),t.bottomType=d(o.SignatureType.None),t.topType=d(o.SignatureType.All),t.primitiveType=l(o.OperKind.Number|o.OperKind.Boolean|o.OperKind.String),t.primitiveUnitType=e=>l(o.OperKind.Number|o.OperKind.Boolean|o.OperKind.String,e),t.isResolvedReferenceType=function(e){return void 0!==e.resolution},function(e){e[e.Checking=0]="Checking",e[e.SolvingSimple=1]="SolvingSimple",e[e.SolvingFull=2]="SolvingFull"}(s||(t.ExperimentState=s={}))},40773:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UF=void 0,t.UF=class{makePoint(e){const t=this.roots.length;return this.roots.push(t),this.backlinks.push(t),this.descriptors.push(e),this.ranks.push(0),t}find(e){const t=this.roots;let r=e;for(;t[r]!==r;)t[r]=t[t[r]],r=t[r];return r}findWithDescriptor(e){const t=this.find(e);return[t,this.descriptors[t]]}union(e,t,r=!1){const n=this.find(e),i=this.find(t);if(n===i)return;const o=this.roots,a=this.backlinks,s=this.ranks;if(r){const e=a[i];return a[i]=a[n],a[n]=e,o[i]=n,void(s[n]<=s[i]&&(s[n]=s[i]+1))}if(s[n]<s[i]){const e=a[n];a[n]=a[i],a[i]=e,o[n]=i}else{const e=a[i];a[i]=a[n],a[n]=e,o[i]=n,s[n]===s[i]&&(s[n]+=1)}}forEachInClass(e,t){const r=this.backlinks;let n=e;for(t(n);r[n]!==e;)n=r[n],t(n)}constructor(){this.roots=[],this.backlinks=[],this.descriptors=[],this.ranks=[]}}},86344:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnitExperiment=void 0;const n=r(57264),i=r(7793),o=r(96438),a=r(71510),s=r(71948),l=r(97865),u=r(10051),c=r(35268),d=r(99796),m=r(40285),g=r(40285),p=r(94297),h=r(91709),f=r(48262),S=r(33436),v=r(73693),y=r(39986),F=r(42261),C=r(50338),R=r(25201),b=r(83102);t.UnitExperiment=class{get done(){return this.isDone}freshCheckingState(e){this.lastStepMessage="freshCheckingState";const t=[],r={};e.getServerAvailableCells().forEach((n=>{var i;const o=e.getServerUsedRange(n.sheetIdx);if(o.kind!==S.ResultKind.Success)return this.isDone=!0,void(this.statsMessage="Unit experiment: getServerUsedRange failed");const a=Object.assign(Object.assign({},n),{usedRange:null===(i=o.value)||void 0===i?void 0:i.range});r[n.sheetIdx.index]=a,t.push(a)}));const n=void 0===e.getServerDocument()?()=>(0,S.failure)(void 0):t=>e.getIformat(e.getServerDocument(),t);return{kind:d.ExperimentState.Checking,locale:e.config.localeInfo,mathpack:e.config.mathpack,resolver:(0,l.createResolver)(e),documentTypeContext:{formats:t=>e.getServerFormat(t),types:{},available:r,getIformat:n,isStringValue:t=>{if(void 0===e.getServerDocument())return!1;const r=e.getServerValue(t);return r.kind===S.ResultKind.Success&&r.value.oper.kind===v.OperKind.String}},constraints:[],stats:{formulaCells:0,referencedFormatCells:0,allFormatCells:0,totalCells:0,errorCount:0,enriched:{errors:[],referencedFormatTypes:{},allFormatTypes:{},referencedCurrencyTypes:{},allCurrencyTypes:{}}},sheets:t,mutableState:{symbolContext:E.init(),ranges:void 0,cells:void 0,sheetCursor:0,rangeCursor:0,cellCursor:0}}}freshSolvingState(e){return this.lastStepMessage="freshSolvingState",{kind:d.ExperimentState.SolvingSimple,stats:e.stats,context:(0,g.makeSolverContext)(e.mutableState.symbolContext,e.documentTypeContext,e.stats),constraints:e.constraints,constraintCursor:0,deferred:[]}}step(){if(!this.isDone){if(void 0===this.documentContext)return this.isDone=!0,(0,n.assertNever)(`${c.Messages.Root}.${c.Messages.Initialised}`,this.documentContext);void 0===this.state&&(this.state=this.freshCheckingState(this.documentContext));try{const e=this.state;switch(e.kind){case d.ExperimentState.Checking:return e.mutableState.sheetCursor<e.sheets.length?void(this.state=this.runCheckStep(this.documentContext,e)):void(this.state=this.freshSolvingState(e));case d.ExperimentState.SolvingSimple:return this.lastStepMessage="SolvingSimple",void(this.state=(0,g.runSolverStep)(e));case d.ExperimentState.SolvingFull:return e.constraintCursor<e.constraints.length?(this.lastStepMessage="SolvingFull",void(this.state=(0,g.runSolverStep)(e))):(this.lastStepMessage="done SolvingFull",this.isDone=!0,void(this.statsMessage=this.statsForLogging(e.stats)))}}catch(e){return this.statsMessage=`${c.Messages.Root}.${c.Messages.Failure}: ${(0,h.messageFromError)(e)}`,void(this.isDone=!0)}}}setContext({documents:e}){this.documentContext=e}initialiseSheetStep(e){this.lastStepMessage="initialiseSheetStep";const{mutableState:t,sheets:r}=e,{sheetCursor:n}=t,i=r[n],o=i.usedRange,a=[];if(void 0!==o){const e=(0,b.intersectProduct)(i.availableCells,R.availableReadProduct);(0,R.forEachRangeInSet)(e,(e=>{const t=(0,C.gridRangeIsect)(e,o);if(void 0!==t){if((0,C.gridRangeSize)(t)<250)return a.push(t),!0;(0,C.forEachTileInRange)(t,15,(e=>(a.push(e),!0)))}return!0}))}return t.ranges=a,t.rangeCursor=0,e.documentTypeContext.types[i.sheetIdx.index]=(0,f.makeGridRangeTable)(),e}initialiseRangeCells(e,t){this.lastStepMessage="initialiseRangeCells";const{mutableState:r,stats:n,sheets:o}=t,{sheetCursor:a}=r,s=[],l=o[a],u=r.ranges[r.rangeCursor];return e.forEachServerNonBlankCellInSet(l.sheetIdx,(0,R.createCellSetFromRange)(u),(r=>{var o;const a=(0,i.sheetGridCell)(l.sheetIdx,r),u=e.getServerFormula(a);u.kind===S.ResultKind.Success&&void 0!==(null===(o=u.value)||void 0===o?void 0:o[1].compiledFmla)&&(s.push(u.value[1]),n.formulaCells+=1);const c=e.getServerFormat(a);return c.kind===S.ResultKind.Success&&(0,g.isInterestingFormat)(t.documentTypeContext,c.value)&&(0,g.updateFormatStatsFromCellFormat)(t.documentTypeContext,c.value,n,!1),n.totalCells+=1,!0})),r.cells=s,r.cellCursor=0,t}checkCell(e,t){this.lastStepMessage="checkCell";const{sheets:r,constraints:n,stats:o,mutableState:a}=t,{cells:s,sheetCursor:l,cellCursor:u}=a,c=r[l],m=s[u],p=m.compiledFmla.getValue();if(p.kind===S.ResultKind.Success){const r=(0,i.sheetGridCell)(c.sheetIdx,m.origin),a=function(e,t,r){const{constraints:n,locale:i,mathpack:o,resolver:a,documentTypeContext:s}=e,l=s.types[t.sheet.index],u=e.mutableState.symbolContext.copy(),c={origin:t,locale:i,mathpack:o,resolver:a,symbolContext:u,pushConstraint:e=>void 0!==e&&(n.push(e),!0)},m=function(e,t){return(0,y.reducePledge)(new O(e),t)}(c,r),p=N(c,m);let h=A(c,void 0===p?d.topType:p);if(h.kind===d.TypeKind.Reference){const e=u.freshSymbol(),t={kind:g.ConstraintKind.RangeEquality,type:h,target:e};h=(0,d.primitiveUnitType)(e.unit),n.push(t)}return e.mutableState.symbolContext=u,h.kind===d.TypeKind.Array?l:l.setValue(t.range,h)}(t,r,p.value);t.documentTypeContext.types[c.sheetIdx.index]=a;const s=e.getServerFormat(r);s.kind===S.ResultKind.Success&&(0,g.isInterestingFormat)(t.documentTypeContext,s.value)&&(n.push({kind:g.ConstraintKind.FormatEquality,cell:r,format:s.value}),(0,g.updateFormatStatsFromCellFormat)(t.documentTypeContext,s.value,o,!0))}return t.mutableState.cellCursor+=1,t}runCheckStep(e,t){if(!function(e){return void 0!==e.mutableState.ranges}(t))return this.initialiseSheetStep(t);const{mutableState:r}=t;return r.rangeCursor===r.ranges.length?(r.ranges=void 0,r.sheetCursor+=1,t):function(e){return void 0!==e.mutableState.cells}(t)?r.cellCursor<t.mutableState.cells.length?this.checkCell(e,t):(r.cells=void 0,r.rangeCursor+=1,t):this.initialiseRangeCells(e,t)}statsForLogging(e){return JSON.stringify(e)}get resultLogMessage(){var e;return null!==(e=this.statsMessage)&&void 0!==e?e:`${c.Messages.Root}.${c.Messages.Default}`}get failedLogMessage(){var e,t,r,n,i;const o=null===(e=this.state)||void 0===e?void 0:e.kind,a=(null===(t=this.state)||void 0===t?void 0:t.kind)===d.ExperimentState.Checking&&0===(null===(r=this.state)||void 0===r?void 0:r.mutableState.cellCursor);return`Units experiment timed out. Last step: ${this.lastStepMessage}. Experiment state: ${void 0!==o?d.ExperimentState[o]:"NotStarted"}. isCellCursorZero: ${a}. Number of constraints: ${null===(n=this.state)||void 0===n?void 0:n.constraints.length}. Stats: ${this.statsForLogging(null===(i=this.state)||void 0===i?void 0:i.stats)}`}constructor(){this.isDone=!1,this.lastStepMessage="before started"}};class E{static init(){return new E(0,p.RedBlackMapTree.create(((e,t)=>e.localeCompare(t))))}getTable(){return this.table}freshSymbol(e){const t=`${void 0===e?"gen":e}@${this.seed+=1}`,r={unit:(0,u.fromVar)(t),link:void 0,ufSubstitution:void 0};return this.table=this.table.setValue(t,r),r}copy(){return new E(this.seed,this.table)}constructor(e,t){this.seed=e,this.table=t}}function T(e,t,r){switch(e.kind){case d.TypeKind.Array:if(e.elementType.kind===d.TypeKind.Reference)return;return r?T(e.elementType,t,!1):void 0;case d.TypeKind.Reference:return{kind:g.ConstraintKind.RangeEquality,type:e,target:t};case d.TypeKind.Scalar:return void 0===e.unit?void 0:{kind:g.ConstraintKind.UnitEquality,unit:e.unit,target:t};case d.TypeKind.Union:return;default:return(0,n.assertNever)(c.Messages.Root,e)}}function k(e,t,r){switch(t.kind){case d.TypeKind.Array:if(t.elementType.kind===d.TypeKind.Reference)return;return r?k(e,t.elementType,!1):void 0;case d.TypeKind.Reference:const i=e.symbolContext.freshSymbol(),o={kind:g.ConstraintKind.RangeEquality,type:t,target:i};return[i.unit,o];case d.TypeKind.Scalar:return void 0===t.unit?void 0:[t.unit,void 0];case d.TypeKind.Union:return;default:return(0,n.assertNever)(c.Messages.Root,t)}}function P(e){const t=e.length;if(0===t)return d.topType;let r=d.bottomType;const n=e[0].length;for(let t=0;t<e.length;t+=1){const n=e[t];for(let e=0;e<n.length;e+=1)i=r,o=n[e],r=i===d.bottomType?o:o===d.bottomType||i===d.topType?i:o===d.topType?o:i.kind===d.TypeKind.Scalar&&o.kind===d.TypeKind.Scalar&&void 0===i.unit&&void 0===o.unit?(0,d.makePrimitiveType)(i.flags|o.flags):d.topType}var i,o;return(0,d.makeArrayType)(r,{rows:t,columns:n,exact:!0})}function N(e,t){if(t.kind===d.TypeKind.Reference&&!(0,d.isResolvedReferenceType)(t)){const r=function(e,t){const r=(0,s.resolveLocalsGrid)(e.origin),{resolution:n}=e.resolver.resolveCellRef(r,t.reference);return!!(0,S.isSuccess)(n)&&(!n.value||n.value)}(e,t);return"object"==typeof r?(0,d.makeResolvedReferenceType)(t.reference,r):r?d.errorType:void 0}if(t.kind===d.TypeKind.Array){const r=N(e,t.elementType);return void 0===r?r:r===t.elementType?t:(0,d.makeArrayType)(r,t.dimensions)}return t}function A(e,t){switch(t.kind){case d.TypeKind.Scalar:if(void 0===t.unit){const r=e.symbolContext.freshSymbol();return(0,d.makePrimitiveType)(t.flags,r.unit)}return t;case d.TypeKind.Array:let r=t;const i=[];for(;r.kind===d.TypeKind.Array;)i.push(r.dimensions),r=r.elementType;const o=A(e,r);return i.reduceRight(d.makeArrayType,o);case d.TypeKind.Reference:case d.TypeKind.Union:return t;default:return(0,n.assertNever)(c.Messages.Root,t)}}function I(e,t,r,n,i){const o=e.symbolContext.freshSymbol(),a=T(t,o,n),s=T(r,o,n);if(void 0!==a&&void 0!==s||i&&(void 0!==a||void 0!==s))return e.pushConstraint(a),e.pushConstraint(s),o}class O{literalNode(e){return F.Pledge.resolve(function(e){switch(e.kind){case v.OperKind.Number:return d.numberType;case v.OperKind.String:return d.stringType;case v.OperKind.Boolean:return d.boolType;case v.OperKind.Error:return d.errorType;default:return d.oneType}}(e))}arrayNode(e){return F.Pledge.all(e.map((e=>F.Pledge.all(e.map(this.lazyVisitFormulaNode))))).bind(P)}appNode(e,t){return e.kind===a.NodeKind.Operator?F.Pledge.all(t.map((e=>this.lazyVisitFormulaNode(e).bind((t=>[t,e]))))).bind((t=>function(e,t,r){switch(t){case o.OperatorId.Add:case o.OperatorId.Sub:case o.OperatorId.Mul:case o.OperatorId.Div:case o.OperatorId.Pow:case o.OperatorId.Eq:case o.OperatorId.Ne:case o.OperatorId.Lt:case o.OperatorId.Le:case o.OperatorId.Gt:case o.OperatorId.Ge:case o.OperatorId.Range:case o.OperatorId.Isect:case o.OperatorId.Union:case o.OperatorId.Concat:case o.OperatorId.And:case o.OperatorId.Or:case o.OperatorId.Xor:case o.OperatorId.Min:case o.OperatorId.Max:return function(e,t,r){if(r.length<2)return d.topType;const i=N(e,r[0][0]),a=N(e,r[1][0]);if(void 0===i||void 0===a)return d.topType;const s=(0,d.getLiftingDimensionsFromTypes)(i,a);if(!1===s)return d.topType;const l="object"==typeof s;switch(t){case o.OperatorId.Add:case o.OperatorId.Sub:case o.OperatorId.Min:case o.OperatorId.Max:{const t=I(e,i,a,l,!0);return(0,d.typeFromDimensions)(void 0===t?d.numberType:(0,d.makePrimitiveType)(v.OperKind.Number,t.unit),s)}case o.OperatorId.Eq:case o.OperatorId.Ne:case o.OperatorId.Lt:case o.OperatorId.Le:case o.OperatorId.Gt:case o.OperatorId.Ge:return I(e,i,a,l,!1),(0,d.typeFromDimensions)(d.boolType,s);case o.OperatorId.Mul:case o.OperatorId.Div:if(m.UnitExperimentSettings.IgnoreDivMul)return d.numberType;{const r=e.symbolContext.freshSymbol(),n=e.symbolContext.freshSymbol(),c=T(i,r,l),m=T(a,n,l);if(e.pushConstraint(c),e.pushConstraint(m),void 0===c&&void 0===m)return(0,d.typeFromDimensions)(d.numberType,s);const g=t===o.OperatorId.Mul?(0,u.prod)(r.unit,n.unit):(0,u.prod)(r.unit,(0,u.inv)(n.unit));return(0,d.typeFromDimensions)((0,d.makePrimitiveType)(v.OperKind.Number,g),s)}case o.OperatorId.Pow:const[,g]=r[1];if((0,C.isNumberLiteralNode)(g)){const t=e.mathpack.toNumber(g.oper);if((0,h.isInteger)(t)){const r=k(e,i,"object"==typeof s);return void 0===r?(0,d.typeFromDimensions)(d.numberType,s):(e.pushConstraint(r[1]),(0,d.typeFromDimensions)((0,d.makePrimitiveType)(v.OperKind.Number,(0,u.pow)(r[0],t,d.dimensionLess)),s))}}return d.topType;case o.OperatorId.Range:case o.OperatorId.Isect:case o.OperatorId.Union:return d.topType;case o.OperatorId.Concat:return(0,d.typeFromDimensions)(d.stringType,s);case o.OperatorId.And:case o.OperatorId.Or:case o.OperatorId.Xor:return(0,d.typeFromDimensions)(d.boolType,s);default:return(0,n.assertNever)(c.Messages.Root,t)}}(e,t,r);case o.OperatorId.Percent:case o.OperatorId.Neg:case o.OperatorId.Pos:case o.OperatorId.At:case o.OperatorId.Pound:return function(e,t,r){if(r.length<1)return d.topType;const[i]=r[0],a=N(e,i);if(void 0===a)return d.topType;const s=(0,d.dimensionsFromType)(a);if(!1===s)return d.topType;switch(t){case o.OperatorId.Percent:return(0,d.typeFromDimensions)(d.dimensionlessNumberType,s);case o.OperatorId.Neg:case o.OperatorId.Pos:const r=k(e,a,"object"==typeof s);return void 0===r?(0,d.typeFromDimensions)(d.numberType,s):(e.pushConstraint(r[1]),(0,d.typeFromDimensions)((0,d.makePrimitiveType)(v.OperKind.Number,r[0]),s));case o.OperatorId.At:case o.OperatorId.Pound:return d.topType;default:return(0,n.assertNever)(c.Messages.Root,t)}}(e,t,r);default:return(0,n.assertNever)(c.Messages.Root,t)}}(this.context,e.id,t))):e.kind===a.NodeKind.WSF?F.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((t=>function(e,t,r){switch(t){case o.WorksheetFuncId.SUM:case o.WorksheetFuncId.AVERAGE:case o.WorksheetFuncId.MAX:case o.WorksheetFuncId.MIN:if(0===r.length)return d.topType;const t=e.symbolContext.freshSymbol();let n=!0;return r.forEach((r=>{const i=N(e,r);i&&e.pushConstraint(T(i,t,!0))&&(n=!1)})),n?d.numberType:(0,d.makePrimitiveType)(v.OperKind.Number,t.unit);case o.WorksheetFuncId.IF:if(r.length<2)return d.topType;const i=N(e,r[0]),a=N(e,r[1]),s=N(e,void 0===r[2]?d.boolType:r[2]);if(void 0===i)return void 0!==a&&void 0!==s&&I(e,a,s,!0,!1),d.topType;const l=(0,d.dimensionsFromType)(i),u="object"==typeof l;if(void 0===a||void 0===s)return d.topType;const c=I(e,a,s,!0,!0),m=c?(0,d.primitiveUnitType)(c.unit):d.primitiveType;return u?(0,d.makeArrayType)(m,l):m;default:return d.topType}}(this.context,e.id,t))):F.Pledge.resolve(d.topType)}letNode(e,t,r,n){return F.Pledge.resolve(d.topType)}lambdaNode(e,t,r,n){return F.Pledge.resolve(d.topType)}parenNode(e){return this.lazyVisitFormulaNode(e)}nameNode(e,t){return F.Pledge.resolve(d.topType)}cellRefNode(e,t){return F.Pledge.resolve((0,d.makeReferenceType)((0,a.cellRefNode)(e,t)))}fieldRefNode(e,t){return F.Pledge.resolve(d.topType)}structRefNode(e,t){return F.Pledge.resolve(d.topType)}missingNode(e){return F.Pledge.resolve(d.topType)}badSequenceNode(e,t){return F.Pledge.resolve(d.topType)}badCharsNode(e,t){return F.Pledge.resolve(d.topType)}operatorNode(e,t){return F.Pledge.resolve((0,a.operatorNode)(e,t))}wsfNode(e,t,r){return F.Pledge.resolve((0,a.wsfNode)(e,t,r))}constructor(e){this.context=e,this.visitFormulaNode=e=>(0,y.visitFormulaNode)(this,e),this.lazyVisitFormulaNode=e=>F.Pledge.resolve(e).bind(this.visitFormulaNode)}}},10051:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unify=t.compose=t.createPoisonApplication=t.UnificationResultKind=t.substituteVariable=t.serialiseMeasure=t.toUnitConstraint=t.shuffleNormalForms=t.pow=t.inv=t.prod=t.areSignaturesEqual=t.isSimpleUnit=t.fromVar=t.fromConstants=t.makeSignature=t.someVar=t.everyVar=t.someConst=t.everyConst=void 0;const n=r(57264),i=r(35268);function o(e,t){for(const r in e)if(!t(r,e[r]))return!1;return!0}const a=(e,t)=>!o(e,((e,r)=>!t(e,r)));function s(e,t){let r=0;!function(e,t){for(const t in e)e[t],r+=1}(t.vars),(0,n.assertTrue)(e,void 0===t.name||1===t.varCount),(0,n.assertTrue)(e,t.varCount===r)}function l(e,t,r){const n={varCount:e,vars:t,consts:r,name:void 0};return s(i.Messages.Root,n),n}function u(){}function c(){return new u}t.everyConst=(e,t)=>o(e.consts,t),t.someConst=(e,t)=>a(e.consts,t),t.everyVar=(e,t)=>o(e.vars,t),t.someVar=(e,t)=>a(e.vars,t),t.makeSignature=l;const d=c();function m(){return l(0,{},c())}function g(e){return l(0,{},e)}t.fromConstants=g,t.fromVar=function(e){const t=l(1,{[e]:1},d);return t.name=e,t};const p=()=>!1;function h(e,r){return(0,t.everyVar)(e,((e,t)=>r.vars[e]===t))&&(0,t.everyConst)(e,((e,t)=>r.consts[e]===t))}function f(e,t){var r,n;const o=m(),{vars:a,consts:l}=e,{vars:u,consts:c}=t;for(const e in a){const t=a[e]-(null!==(r=u[e])&&void 0!==r?r:0);0!==t&&(o.vars[e]=t,o.varCount+=1)}for(const e in l){const t=l[e]-(null!==(n=c[e])&&void 0!==n?n:0);0!==t&&(o.consts[e]=t)}for(const e in u)void 0===a[e]&&(o.vars[e]=-u[e],o.varCount+=1);for(const e in c)void 0===l[e]&&(o.consts[e]=-c[e]);return s(i.Messages.Root,o),o}function S(e,t,r,n){return r?1===t?e:`${e}^${t}`:-1===t?e:`${e}^${t*n}`}function v(e,t,r){const{vars:n,consts:i}=t,o=n[e];if(void 0===o)return t;let a=0;const{vars:s,consts:u}=m();for(const t in n){const i=r.vars[t],l=void 0===i?0:i,u=(t===e?0:n[t])+l*o;0!==u&&(a+=1,s[t]=u)}for(const e in r.vars)void 0===n[e]&&(a+=1,s[e]=o*r.vars[e]);for(const e in i){const t=r.consts[e],n=i[e]+o*(void 0===t?0:t);0!==n&&(u[e]=n)}for(const e in r.consts)void 0===i[e]&&(u[e]=o*r.consts[e]);return l(a,s,u)}var y;t.isSimpleUnit=function(e){if(0===e.varCount)return!0;if(void 0!==e.name)return!0;if(1===e.varCount&&(e.consts===d||(0,t.everyConst)(e,p))){const t=function(e,t){for(const t in e.vars)return 1===e.vars[t]?t:void 0}(e);return void 0!==t&&(e.name=t,!0)}return!1},t.areSignaturesEqual=function(e,t){return h(e,t)&&h(t,e)},t.prod=function(e,t){var r,n;const o=m(),{vars:a,consts:l}=e,{vars:u,consts:c}=t;for(const e in a){const t=a[e]+(null!==(r=u[e])&&void 0!==r?r:0);0!==t&&(o.vars[e]=t,o.varCount+=1)}for(const e in l){const t=l[e]+(null!==(n=c[e])&&void 0!==n?n:0);0!==t&&(o.consts[e]=t)}for(const e in u)void 0===a[e]&&(o.vars[e]=u[e],o.varCount+=1);for(const e in c)void 0===l[e]&&(o.consts[e]=c[e]);return s(i.Messages.Root,o),o},t.inv=function(e){const t=m(),{vars:r,consts:n}=e;for(const e in r)t.vars[e]=-r[e];for(const e in n)t.consts[e]=-n[e];return t.varCount=e.varCount,s(i.Messages.Root,t),t},t.pow=function(e,t,r){if(0===t)return r;const n=m(),{vars:o,consts:a}=e;for(const e in o)n.vars[e]=o[e]*t;for(const e in a)n.consts[e]=a[e]*t;return n.varCount=e.varCount,s(i.Messages.Root,n),n},t.shuffleNormalForms=function(e,r){var o,a;const l=m(),u=m(),c=l.vars,d=u.consts;for(const t in e.vars){const n=e.vars[t]-(null!==(o=r.vars[t])&&void 0!==o?o:0);0!==n&&(c[t]=n,l.varCount+=1)}for(const t in r.vars)void 0===e.vars[t]&&(c[t]=-r.vars[t],l.varCount+=1);for(const t in r.consts){const n=r.consts[t]-(null!==(a=e.consts[t])&&void 0!==a?a:0);0!==n&&(d[t]=n)}for(const t in e.consts)void 0===r.consts[t]&&(d[t]=-e.consts[t]);return s(i.Messages.Root,l),s(i.Messages.Root,u),(0,n.assertTrue)(i.Messages.Root,(0,t.everyConst)(l,p)),{vars:l,consts:u}},t.toUnitConstraint=f,t.serialiseMeasure=function(e){const t=[],r=[];for(const n in e.vars){const i=e.vars[n];i>0?t.push([n,i]):r.push([n,i])}for(const n in e.consts){const i=e.consts[n];i>0?t.push([n,i]):r.push([n,i])}if(0===r.length)return 0===t.length?"1":t.map((([e,t])=>S(e,t,!0,1))).join("*");let n=r.map((([e,t])=>S(e,t,!1,-1))).join("*");return r.length>1&&(n="("+n+")"),0===t.length?`1/${n}`:`${t.map((([e,t])=>S(e,t,!0,1))).join("*")}/${n}`},t.substituteVariable=v,function(e){e[e.Fail=0]="Fail",e[e.Subst=1]="Subst"}(y||(t.UnificationResultKind=y={}));const F=()=>{},C={kind:y.Subst,substitution:F},R=e=>({kind:y.Subst,substitution:e}),b={kind:y.Fail},E=e=>e<0?-e:e;function T(e,t,r){const n={};return r===F?t:t===F?r:i=>{const o=n[i];if(void 0!==o)return o;const a=r(i);return n[i]=void 0===a?t(i):e(t,a)}}function k(e,t){return r=>e===r?t:void 0}function P(e,r,o){if(e>=100)return(0,n.assertFalse)(i.Messages.UnifyBound);if(0===o.varCount)return(0,t.everyConst)(o,p)?C:b;if(1===o.varCount){let e;for(const t in o.vars){e=t;break}(0,n.assertTrue)(i.Messages.Root,void 0!==e);const t=o.vars[e],r={};for(const e in o.consts){const n=o.consts[e];if(n%t!=0)return b;r[e]=-n/t}return R(k(e,g(r)))}let a,s,u=0;const{vars:c,consts:d,varCount:m}=o;for(const e in c){const t=c[e],r=E(t);(void 0===s||r<s)&&(u=t,s=r,a=e)}(0,n.assertTrue)(i.Messages.Root,void 0!==a),(0,n.assertTrue)(i.Messages.Root,0!==u);const h={},f={};for(const e in c)if(e===a)h[e]=1;else{const t=c[e];h[e]=-Math.floor(t/u)}for(const e in d){const t=d[e];f[e]=-Math.floor(t/u)}const S=l(m,h,f),F=P(e+1,r,v(a,o,S));return F.kind===y.Fail?F:R(T(r,F.substitution,k(a,S)))}t.createPoisonApplication=function(e){return(t,r)=>{if(0===r.varCount||t===F)return r;let n=r;for(const i in r.vars){const r=t(i);if(r===e)return e;void 0!==r&&(n=v(i,n,r))}return n}},t.compose=T,t.unify=(e,t,r)=>P(0,e,f(t,r))},37610:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logMissingJSFeatures=t.getMissingJSFeatures=void 0;const n=r(57264),i=r(55340),o=r(91709),a=[{name:"self",test:()=>"undefined"!=typeof self},{name:"fetch",test:()=>"function"==typeof fetch},{name:"Set",test:()=>"function"==typeof Set},{name:"Map",test:()=>"function"==typeof Map},{name:"WeakMap",test:()=>"function"==typeof WeakMap},{name:"Symbol",test:()=>"function"==typeof Symbol},{name:"WebAssembly",test:()=>"object"==typeof WebAssembly},{name:"Atomics",test:()=>"object"==typeof Atomics},{name:"BigInt",test:()=>"function"==typeof BigInt},{name:"String.startsWith",test:()=>"function"==typeof"".startsWith},{name:"String.codePointAt",test:()=>"function"==typeof"".codePointAt},{name:"Object.assign",test:()=>"function"==typeof Object.assign},{name:"Object.setPrototypeOf",test:()=>"function"==typeof Object.setPrototypeOf},{name:"Number.EPSILON",test:()=>"number"==typeof Number.EPSILON},{name:"Number.isFinite",test:()=>"function"==typeof Number.isFinite},{name:"Number.parseInt",test:()=>"function"==typeof Number.parseInt},{name:"Math.acosh",test:()=>"function"==typeof Math.acosh},{name:"Math.hypot",test:()=>"function"==typeof Math.hypot},{name:"Math.log1p",test:()=>"function"==typeof Math.log1p},{name:"Math.trunc",test:()=>"function"==typeof Math.trunc},{name:"Promise.finally",test:()=>"function"==typeof Promise.resolve().finally},{name:"RegExp_flags",test:()=>(new RegExp("x","i"),!0)},{name:"RegExp.flags",test:()=>"string"==typeof/x/.flags},{name:"Array.of",test:()=>"function"==typeof Array.of},{name:"Array.entries",test:()=>"function"==typeof[].entries},{name:"Array.find",test:()=>"function"==typeof[].find},{name:"performance",test:()=>"object"==typeof performance},{name:"performance.now",test:()=>"function"==typeof performance.now},{name:"performance.timeOrigin",test:()=>"number"==typeof performance.timeOrigin},{name:"performance.memory",test:()=>"object"==typeof performance.memory}];function s(){return a.map((({name:e,test:t})=>{try{return t()?"":e}catch(t){return e}})).filter((e=>e.length>0))}t.getMissingJSFeatures=s,t.logMissingJSFeatures=function(e){e().then((e=>{const t={main:s(),worker:e},r=`calc.calc.logMissingJSFeatures: missing = ${JSON.stringify(t)}`;n.ulsLogger.ULS.traceTag(561534152,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,r)})).catch((e=>{const t=`calc.calc.logMissingJSFeatures: threw ${(0,o.messageFromError)(e)}`;n.ulsLogger.ULS.traceTag(561534153,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,t)}))}},14408:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbook=t.EvalOnClonePropsFromPartialWBDocumentCollection=t.EvalOnClonePropsFromPartialWB=t.MaxStateIdDifferenceForGC=void 0;const n=r(53750),i=r(53750),o=r(53750),a=r(50338),s=r(50338),l=r(7793),u=r(30333),c=r(96438),d=r(88928),m=r(57264),g=r(25201),p=r(55380),h=r(47324),f=r(12450),S=r(74185),v=r(57777),y=r(83102),F=r(17350),C=r(43512),R=r(66547),b=r(94591),E=r(71273),T=r(33436),k=r(33436),P=r(39986),N=r(73362),A=r(68616),I=r(82751),O=r(81476),_=r(23623),M=r(91709),D=r(83567),w=r(48262),L=r(77721),x=r(96547),K=r(91889),U=r(30006),B=2*l.sheetCols;t.MaxStateIdDifferenceForGC=17;const G=(0,l.gridRange)(0,0,l.sheetRows,l.sheetCols);function W(e,t){let r;return t.kind===i.ReasonKind.Unavailable&&t.objects.length>0&&"kind"in t.objects[0]&&(r=t.objects[0].kind),(0,k.failure)({cell:e,kind:t.kind,innerKind:r})}const V=(0,P.binaryVisitor)(Object.assign(Object.assign({},(0,P.constVisitor)(!1)),{wsfNode:e=>e===c.WorksheetFuncId.HYPERLINK}),((e,t)=>e||t));var j,q;!function(e){e.EvalFinished="EvalFinished",e.EvalTimedOut="EvalTimedOut",e.StateIdAdvanced="StateIdAdvanced",e.EditReceived="EditReceived",e.SetSheetNames="SetSheetNames",e.SetLangConfig="SetLangConfig"}(j||(j={})),t.EvalOnClonePropsFromPartialWB=class{constructor(e,t){this.formatResults=t,this.resultsPromise=new I.ResolvablePromise,this.stateId=-1,this.cloneLazy=new O.ResettableLazy((()=>e.createSnapshotSync()))}},t.EvalOnClonePropsFromPartialWBDocumentCollection=class{constructor(e,t){this.formatResults=t,this.resultsPromise=new I.ResolvablePromise,this.stateId=-1,this.cloneLazy=new O.ResettableLazy((()=>e.clone(S.voidCallback,p.CloningTarget.Client)))}},function(e){e[e.ServerUpdate=0]="ServerUpdate",e[e.ClientEdit=1]="ClientEdit",e[e.EvalFormula=2]="EvalFormula",e[e.BeforeCompute=3]="BeforeCompute",e[e.ComputeCellValue=4]="ComputeCellValue",e[e.AfterCompute=5]="AfterCompute",e[e.ComputeEvalOnClone=6]="ComputeEvalOnClone",e[e.ComputeEvalFormula=7]="ComputeEvalFormula",e[e.RecalcFinished=8]="RecalcFinished",e[e.CompleteDataQuery=9]="CompleteDataQuery",e[e.MaybeCollectGarbage=10]="MaybeCollectGarbage",e[e.RunExperiment=11]="RunExperiment",e[e.TestAdvanceState=12]="TestAdvanceState"}(q||(q={}));class H{reconfigure(e){var t,r;this.config=e,this.rng=new v.JSF32(void 0!==e.rngSeed?e.rngSeed:0),this.docs.reconfigure(e,e,null!==(t=e.maxDereferenceCells)&&void 0!==t?t:B,null!==(r=e.isServerWorkbookLoad)&&void 0!==r&&r)}getDocs(){return this.docs}setWorksheetFuncOverrides(e){this.docs.setWorksheetFuncOverrides(e)}onNameFailure(e,t,r){r.computeKind!==d.ComputeKind.EvalFormula&&this.outputMessageLog.push({kind:d.OutputMessageKind.NameFailure,stateId:this.stateId,name:e,reason:t})}onRangeFailure(e,t,r,n,i){i.computeKind!==d.ComputeKind.EvalFormula&&this.outputMessageLog.push({kind:d.OutputMessageKind.RangeFailure,stateId:this.stateId,cellKind:n,range:e,reason:t})}onNumberFormatFailure(e){this.outputMessageLog.push({kind:d.OutputMessageKind.NumberFormatFailure,stateId:this.stateId,reason:e})}onInferFormatFailure(e,t){this.outputMessageLog.push({kind:d.OutputMessageKind.InferFormatFailure,stateId:this.stateId,range:e,reason:t})}onUnavailableObject(e){const t=(0,s.unavailable)([e]);this.onUnavailable(t)}onUnavailable(e){this.outputMessageLog.push({kind:d.OutputMessageKind.UnhandledFailure,stateId:this.stateId,reason:e})}onSetCellValue(e,t,r,n,i){if(i.computeKind===d.ComputeKind.EvalFormula)return;const o=this.outputCell(e,t,n,this.printFormulaProperties);void 0!==o?(this.outputMessageLog.push({kind:d.OutputMessageKind.RecalcStatistics,message:d.RecalcStatisticsMessage.ChangedCell,stateId:this.stateId,cellKind:n}),n!==d.ComputedCellKind.EditedCell&&n!==d.ComputedCellKind.DependentCell||this.outputMessageLog.push(Object.assign(Object.assign({kind:d.OutputMessageKind.CellWrite,stateId:this.stateId,cellKind:n,cell:e},o),{formatted:this.formatValue(n,e,t)}))):this.outputMessageLog.push({kind:d.OutputMessageKind.RecalcStatistics,message:d.RecalcStatisticsMessage.UnchangedCell,stateId:this.stateId,cellKind:n})}onSetCellValues(e,t,r,n,i){if(i.computeKind===d.ComputeKind.EvalFormula)return;const o=this.outputRange(e,t,n);void 0!==o&&(n!==d.ComputedCellKind.EditedCell&&n!==d.ComputedCellKind.DependentCell||this.outputMessageLog.push(Object.assign(Object.assign({kind:d.OutputMessageKind.RangeWrite,stateId:this.stateId,cellKind:n,range:e},o),{formatted:t.map(((t,r)=>t.map(((t,i)=>this.formatValue(n,(0,l.sheetGridCell)(e.sheet,(0,l.gridCell)(e.range.row+r,e.range.col+i)),t)))))})))}onReturnCellValue(e,t,r){const n=this.outputCell(e,t,r,(()=>this.printValueProperties(e,t)));void 0!==n?(this.outputMessageLog.push({kind:d.OutputMessageKind.RecalcStatistics,message:d.RecalcStatisticsMessage.ChangedCell,stateId:this.stateId,cellKind:d.ComputedCellKind.EditedCell}),r===d.ComputedCellKind.EditedCell&&this.outputMessageLog.push(Object.assign(Object.assign({kind:d.OutputMessageKind.CellWrite,stateId:this.stateId,cellKind:d.ComputedCellKind.EditedCell,cell:e},n),{formatted:this.formatValue(r,e,t)}))):this.outputMessageLog.push({kind:d.OutputMessageKind.RecalcStatistics,message:d.RecalcStatisticsMessage.UnchangedCell,stateId:this.stateId,cellKind:d.ComputedCellKind.EditedCell})}createSnapshot(e,t=p.CloningTarget.Client){return new Promise((r=>{this.scheduler.addTask(q.CompleteDataQuery,R.QueuePos.Back,{onRun:()=>{let n=!1;const i=this.docs.clone(S.voidCallback,t);void 0!==this.latestSnapshot&&-1!==this.latestSnapshotID&&this.latestSnapshot.compareVersion(i)||(n=!0,this.latestSnapshot=i,this.latestSnapshotID=e),D.x10Logger.log({kind:"snapshotCreation",payload:n}),r({snapshot:this.latestSnapshot,correspondingId:this.latestSnapshotID})},onDeleted:()=>{r(void 0)}})}))}createSnapshotSync(e=p.CloningTarget.Client){return this.docs.clone(S.voidCallback,e)}outputCell(e,t,r,n){let i;if(r===d.ComputedCellKind.EditedCell||r===d.ComputedCellKind.DependentCell){const r=this.docs.testAndSetClientValue(e,t);i=(0,k.isSuccess)(r)?r.value?t:void 0:void this.onUnavailableObject(r.reason)}const o=this.outputFormat(e,r),a=this.outputFormulaProperties(e,r,n);return void 0!==i||void 0!==o||void 0!==a?{value:t,format:o,formulaBarText:null==a?void 0:a.formulaBarText,hasHyperlink:null==a?void 0:a.hasHyperlink}:void 0}outputRange(e,t,r){if(r===d.ComputedCellKind.EditedCell||r===d.ComputedCellKind.DependentCell){const r=this.docs.setClientValue(e,t);(0,k.isSuccess)(r)||this.onUnavailableObject(r.reason)}const n=t.map(((t,n)=>t.map(((t,i)=>this.outputFormat((0,l.sheetGridCell)(e.sheet,(0,l.gridCell)(e.range.row+n,e.range.col+i)),r))))),i=this.outputFormulaProperties(e,r,this.printFormulaProperties);return{values:t,formats:n,formulaBarText:null==i?void 0:i.formulaBarText}}outputFormat(e,t){if(t!==d.ComputedCellKind.EditedCell)return;const r=this.docs.getEditedFormat(e);if(!(0,k.isSuccess)(r))return void this.onUnavailableObject(r.reason);const n=this.docs.testAndSetClientFormat(e,r.value);if(!(0,k.isSuccess)(n))return void this.onUnavailableObject(n.reason);if(!n.value)return;const i=r.value;if(i===d.SpecialFormat.Unavailable)return{format:(0,s.unavailable)([{kind:d.UnavailableKind.CellFormat}]),valueType:b.FormatValueType.Custom,decimals:0};const o=this.docs.resolveCellFormat(e.sheet.document,i);return(0,k.isSuccess)(o)?{format:"number"==typeof i?i:i.formatString,valueType:o.value.valueType,decimals:o.value.decimals}:void 0}outputFormulaProperties(e,t,r){if(t!==d.ComputedCellKind.EditedCell)return;const n=r(e);if(void 0===n)return;const{formulaBarText:i,hasHyperlink:o,isFormula:a}=n,s=this.docs.testAndSetClientFormula(e,i,o);if(!(0,k.isSuccess)(s))return void this.onUnavailableObject(s.reason);const{hasFmlaChanged:l,hasHyperlinkChanged:u}=s.value;return l||u?{formulaBarText:l?i:void 0,hasHyperlink:u?o:void 0,isFormula:a}:void 0}formatValue(e,t,r,n){const i=null!=n?n:this.docs,o=i.formatValueCell(t,r);if((0,k.isSuccess)(o))return o.value;i===this.docs&&this.outputMessageLog.push({kind:d.OutputMessageKind.FormatValueFailure,stateId:this.stateId,cellKind:e,range:t,reason:o.reason})}getAvailableFormula(e){const t=this.docs.getEditedFormula(e);if(!(0,k.isSuccess)(t))return t;if(void 0===t.value)return(0,k.failure)({kind:d.UnavailableKind.CellMissingFormula});const[r,n]=t.value;if(void 0===n.compiledFmla)return(0,k.failure)({kind:d.UnavailableKind.CellEvaluatingValue});const i=(0,l.lexicalSourceGrid)(n.lexicalKind,(0,l.sheetGridRange)(e.sheet,r));return(0,k.success)([i,n])}formulaHasHyperlink(e){if(e.lexicalKind!==l.LexicalKind.Cell)return!1;const t=null==e?void 0:e.compiledFmla.getValue();return(0,k.isSuccess)(t)?(0,P.reduceBottomUp)(V,t.value):void 0}handleSetCellContents(e,t,r,n,i,o,a,u,c,g,p){let h,f,S,v=void 0!==c?(0,s.unavailable)([{kind:d.UnavailableKind.ClientFailure,reason:c}]):void 0,y=a;void 0!==n?(h=n,(0,m.assertTrue)("calc.calc.PartialWorkbook.handleSetCellContents: formula edit",void 0!==i),f=i):void 0===r?((0,m.assertTrue)("calc.calc.PartialWorkbook.handleSetCellContents: format edit",!e&&void 0===i&&void 0!==a&&void 0===v),h=!1,f=void 0):((0,m.assertTrue)("calc.calc.PartialWorkbook.handleSetCellContents: inferred edit",!e&&void 0===v&&y===d.SpecialFormat.Weak),({isFormula:h,oper:f,cellFailure:v,cellFormat:y,inferredFormat:S}=this.parseInferredEdit(t,r,o,v,y,p)));const F=void 0!==p?p.cloneLazy.getValue():this.docs,C=F.setCellContents(e,t,r,h,o,f,v,y,u,g);if(C.kind===k.ResultKind.Failure)return this.onUnavailableObject(C.reason);if(F.onCellModified(e),!e){const e=(0,l.sheetGridCell)(t.sheet,o);let n=void 0===r?(0,k.success)(void 0):h?F.inferFormulaFormat(e):void 0!==S&&S!==E.KnownFormat.General?F.resolveValueFormat(t.sheet.document,S):(0,k.success)(void 0);n.kind!==k.ResultKind.Success&&(this.onInferFormatFailure(e,n.reason),n=(0,k.success)(d.SpecialFormat.Unavailable)),void 0!==n.value&&F.fillInferredFormat(t,n.value),void 0!==p?(p.stateId=this.stateId,this.enqueueEvalFormulaComputeCellValuesOnDocs(t,F,p)):this.enqueueBeforeCompute(g)}}parseInferredEdit(e,t,r,n,i,o){const a=o?o.cloneLazy.getValue().parseInferredEdit((0,l.sheetGridCell)(e.sheet,r),t,this.getVolatileMode()):this.docs.parseInferredEdit((0,l.sheetGridCell)(e.sheet,r),t,this.getVolatileMode());if(!(0,k.isSuccess)(a))return{isFormula:!1,oper:u.blankOper,cellFailure:a.reason,cellFormat:d.SpecialFormat.Unavailable};const s=t.length>0?t.charAt(0):"";switch("="!==s&&"+"!==s&&"-"!==s||a.value.kind!==b.EditKind.Formula&&a.value.kind!==b.EditKind.Number||m.ulsLogger.ULS.dnmTraceTag(541189698,C.LogCategory.msoulscat_ES_EWAJS,C.TraceLevel.Info,JSON.stringify({startChar:s,editKind:String(a.value.kind)})),a.value.kind){case b.EditKind.Formula:return{isFormula:!0,oper:u.blankOper,cellFailure:n,cellFormat:i};case b.EditKind.String:case b.EditKind.Other:return{isFormula:!1,oper:a.value.value,cellFailure:n,cellFormat:i};case b.EditKind.Number:return{isFormula:!1,oper:a.value.value,cellFailure:n,cellFormat:i,inferredFormat:a.value.format}}}handleSetRangeFormula(e,t,r,n,i){const o=(0,h.isFormulaText)(r);(0,m.assertTrue)("calc.calc.PartialWorkbook: handleSetRangeFormula",""===r&&!e||o);const a=e?void 0:u.blankOper,s=e?void 0:d.SpecialFormat.Weak,l=e?void 0:d.SpecialStyle.Weak,c=this.docs.setRangeFormula(e,t,r,n,a,s,l,i);if(c.kind===k.ResultKind.Failure)return this.onUnavailableObject(c.reason);this.docs.onCellModified(e),e||this.enqueueBeforeCompute(i)}handleEditPaste(e,t,r,n){const i=(0,l.sheetGridRange)(t.sheet,(0,l.gridRange)(t.range.row,t.range.col,r.range.rows,r.range.cols)),o=this.docs.copyRange(r);if(o.kind===k.ResultKind.Failure)return this.onUnavailableObject(o.reason);const a=this.docs.pasteRange(i,o.value);if(a.kind===k.ResultKind.Failure)return this.onUnavailableObject(a.reason);this.docs.onCellModified(!1),this.enqueueBeforeCompute(n)}handleAssumeRecalcFinal(e){this.scheduler.getCount(q.BeforeCompute)<0||this.scheduler.addTask(q.ComputeCellValue,R.QueuePos.Front,(()=>{const t=this.docs.assumeRecalcFinal(e);if(t.kind===k.ResultKind.Failure)return this.onUnavailableObject(t.reason)}))}evalFormula(e,t,r,n,i){return new Promise((a=>{const s=()=>a({value:(0,k.failure)(o.stopped)});this.scheduler.deleteTasks(q.EvalFormula,void 0),this.scheduler.addTask(q.EvalFormula,R.QueuePos.Back,{onRun:()=>{if(!i&&!this.trySetStateId(q.EvalFormula,e))return s();this.enqueueComputeEvalFormula(t,r,n,i,a)},onDeleted:s}),this.enqueueRecalcFinished()}))}enqueueBeforeCompute(e){this.scheduler.deleteTasks(q.BeforeCompute,void 0),this.scheduler.addTask(q.BeforeCompute,R.QueuePos.Back,(()=>{this.enqueueAfterCompute(),this.restrictToViewport(this.docs.getNonDirtyEditedCells(),e,d.ComputeKind.EditedCell,this.scheduleAvailableValues),this.restrictToViewport(this.docs.getDirtyEditedCells(),e,d.ComputeKind.EditedCell,this.scheduleAvailableFormulas),this.restrictToViewport(this.docs.getDirtyDependentCells(),e,d.ComputeKind.DependentCell,this.scheduleAvailableFormulas)}))}withEvalTiming(e){const t=this.docs.schedulerConfig.totalTimeMs;if(void 0===t)return e();const r=(0,f.now)();let n;try{n=e()}finally{this.stateEvalTime+=(0,f.fastMax)(1,(0,f.now)()-r),this.stateEvalTime>=t&&(this.deleteComputeTasks(j.EvalTimedOut),this.outputMessageLog.push({kind:d.OutputMessageKind.RecalcStatistics,stateId:this.stateId,message:d.RecalcStatisticsMessage.StateTimedOut}),n=[])}return n}enqueueEvalFormulaComputeCellValuesOnDocs(e,t,r){const u=[];(0,g.forEachCellInSet)(e.set,(t=>(u.push((0,l.sheetGridCell)(e.sheet,t)),!0)));let c=(0,w.makeGridRangeTable)();const p=(t,r,n)=>{(0,s.isSheetIndexEqual)(t.sheet,e.sheet)&&(0,y.meetsProduct)(e.set,(0,g.createCellSetFromRange)(t.range))&&(0,a.forEachCellInRange)(t.range,(e=>(c=c.setValue(e,r),!0)))};let h=()=>t.evaluate(d.ComputeKind.EvalFormula,u,this.getVolatileMode(),p);const S={onRun:()=>{const e=this.withEvalTiming(h);if(Array.isArray(e)){const o=e.map(((e,o)=>{var a;const l=u[o].range;if(!(0,k.isSuccess)(e)){if(e.reason.kind===i.ReasonKind.Stopped)return W(l,e.reason);const t=(0,s.unavailable)([{kind:d.UnavailableKind.EvalFailure,reason:e.reason}]);return this.onUnavailable(t),W(l,t)}const g=t.getCellValue(u[o]);if(!(0,k.isSuccess)(g))return W(l,null!==(a=c.getValue(l))&&void 0!==a?a:g.reason);try{(0,m.assertTrue)("calc.calc.PartialWorkbook: FinalValue after evalCell",g.value.kind===n.CellKind.FinalValue)}catch(e){const t=(0,s.unavailable)([{kind:d.UnavailableKind.EvalFailure,reason:(0,T.javaScriptError)(e)}]);return this.onUnavailable(t),W(l,t)}const p=g.value.oper;if(!0===r.formatResults){const e=this.formatValue(d.ComputedCellKind.EditedCell,u[o],p,t);return(0,k.success)({cell:l,value:p,formatted:e})}return!1===r.formatResults?(0,k.success)({cell:l,value:p,formatted:void 0}):(0,k.success)((0,f.pair)(u[o].range,p))}));r.resultsPromise.resolve({stateId:r.stateId,results:o})}else h=e.resume,this.scheduler.addTask(q.ComputeEvalOnClone,R.QueuePos.Front,S)},onDeleted:()=>r.resultsPromise.resolve({stateId:r.stateId,results:(0,M.arrayFill)(new Array(u.length),(0,k.failure)(o.stopped))})};this.scheduler.addTask(q.ComputeEvalOnClone,R.QueuePos.Front,S)}enqueueComputeCellValue(e,t){const r=t===d.ComputeKind.EditedCell&&this.shouldSample(this.config.sampleRecalcEditedStopwatchRate)?(0,F.ulsStopwatchFactory)("calc.calc.PartialWorkbook: recalc edited"):void 0;let n,o=!0,a=()=>this.docs.evaluate(t,[e],this.getVolatileMode());const s=()=>{if(o){o=!1,n=this.shouldSample(this.config.sampleCellEvalStopwatchRate)?(0,F.ulsStopwatchFactory)("calc.calc.PartialWorkbook: cell eval"):void 0;const t=this.docs.getEditedFormula(e);if(!(0,k.isSuccess)(t))return this.onUnavailableObject(t.reason);if(void 0===t.value)return}else this.outputMessageLog.push({kind:d.OutputMessageKind.RecalcStatistics,stateId:this.stateId,message:d.RecalcStatisticsMessage.ContinueComputation});const t=this.withEvalTiming(a);if(Array.isArray(t)){null==n||n.stop(),null==r||r.stop();for(const e of t)(0,k.isSuccess)(e)||e.reason.kind===i.ReasonKind.Stopped||this.onUnavailableObject({kind:d.UnavailableKind.EvalFailure,reason:e.reason})}else a=t.resume,this.scheduler.addTask(q.ComputeCellValue,R.QueuePos.Front,s)};this.scheduler.addTask(q.ComputeCellValue,R.QueuePos.Back,s)}enqueueComputeEvalFormula(e,t,r,n=this.docs,i){const a=this.getVolatileMode();let s=()=>n.evalFormula(e,t,r,a);const l={onRun:()=>{const e=s();e.kind===k.ResultKind.Paused||e.kind===k.ResultKind.Breaked?(s=e.resume,this.scheduler.addTask(q.ComputeEvalFormula,R.QueuePos.Front,l)):i(e.value)},onDeleted:()=>i({value:(0,k.failure)(o.stopped)})};this.scheduler.addTask(q.ComputeEvalFormula,R.QueuePos.Back,l)}enqueueReturnCellValue(e,t){const r=this.getVolatileMode();this.scheduler.addTask(q.ComputeCellValue,R.QueuePos.Back,(()=>{this.docs.evalValue(e,t,r)}))}enqueueAfterCompute(){this.scheduler.deleteTasks(q.AfterCompute,j.EditReceived);const e=this.shouldSample(this.config.sampleRecalcViewportStopwatchRate)?(0,F.ulsStopwatchFactory)("calc.calc.PartialWorkbook: recalc viewport"):void 0;this.scheduler.addTask(q.AfterCompute,R.QueuePos.Back,{onRun:()=>{null==e||e.stop(j.EvalFinished),this.outputMessageLog.push({kind:d.OutputMessageKind.RecalcStatistics,message:d.RecalcStatisticsMessage.EditFinished,stateId:this.stateId})},onDeleted:t=>{null==e||e.stop(t)}})}enqueueRecalcFinished(){this.scheduler.deleteTasks(q.RecalcFinished,void 0),this.scheduler.addTask(q.RecalcFinished,R.QueuePos.Back,(()=>{this.outputMessageLog.push({kind:d.OutputMessageKind.RecalcStatistics,message:d.RecalcStatisticsMessage.RecalcFinished,stateId:this.stateId})}))}promoteCellContents(e,t,r,n){this.scheduler.addTask(q.ServerUpdate,R.QueuePos.Back,(()=>{if(!this.trySetStateId(q.ServerUpdate,e))return;const i=this.docs.promoteServerAvailability(r,n);if(i.kind===k.ResultKind.Failure)return this.onUnavailableObject(i.reason);this.docs.onCellModified(!0),i.value||this.outputMessageLog.push({kind:d.OutputMessageKind.UpdateRequest,stateId:this.stateId,range:t})}))}writeCellContents(e,t,r,n,i,o,a,s,l,u){this.scheduler.addTask(q.ServerUpdate,R.QueuePos.Back,(()=>{(u||this.trySetStateId(q.ServerUpdate,e))&&this.handleSetCellContents(!0,t,r,n,o,i,a,s,l,void 0,u)}))}editCellContents(e,t,r,n,i,o=u.blankOper,a=(0,l.sheetGridRange)(t.sheet,G),s){this.lastViewport=a,this.scheduler.addTask(q.ClientEdit,R.QueuePos.Back,(()=>{this.trySetStateId(q.ClientEdit,e)&&this.handleSetCellContents(!1,t,r,n,o,i,d.SpecialFormat.Weak,d.SpecialStyle.Weak,void 0,a,s)})),this.enqueueRecalcFinished()}editCellContentsOnClone(e,t,r,n,i){this.editCellContents(this.stateId,e,t,r,n,void 0,void 0,i)}editCellFormats(e,t,r,n,i=(0,l.sheetGridRange)(t.sheet,G)){this.lastViewport=i,this.scheduler.addTask(q.ClientEdit,R.QueuePos.Back,(()=>{if(!this.trySetStateId(q.ClientEdit,e))return;const o="SetFormat"===r.kind?this.docs.resolveEditFormat(t.sheet.document,r.format):"RibbonFormat"===r.kind?this.docs.resolveRibbonFormat(t.sheet.document,r.ribbon,(0,l.sheetGridCell)(t.sheet,n)):"ChangeDecimals"===r.kind?this.docs.resolveChangeDecimals(t.sheet.document,r.changeDecimals,(0,l.sheetGridCell)(t.sheet,n)):(0,m.assertNever)("calc.calc.PartialWorkbook: editCellFormats",r);(0,k.isSuccess)(o)||(0,g.forEachRangeInSet)(t.set,(e=>(this.onInferFormatFailure((0,l.sheetGridRange)(t.sheet,e),o.reason),!0))),(0,k.isSuccess)(o)&&void 0===o.value||this.handleSetCellContents(!1,t,void 0,void 0,void 0,(0,l.gridCell)(0,0),(0,k.isSuccess)(o)?o.value:d.SpecialFormat.Unavailable,void 0,void 0,i)})),this.enqueueRecalcFinished()}writeArrayFormula(e,t,r,n=(0,s.gridRangeAnchor)(t.range),i=!1){this.scheduler.addTask(q.ServerUpdate,R.QueuePos.Back,(()=>{this.trySetStateId(q.ServerUpdate,e)&&this.handleSetRangeFormula(!0,t,r,n,void 0)}))}editArrayFormula(e,t,r,n=(0,s.gridRangeAnchor)(t.range),i=(0,l.sheetGridRange)(t.sheet,G)){this.lastViewport=i,this.scheduler.addTask(q.ClientEdit,R.QueuePos.Back,(()=>{this.trySetStateId(q.ClientEdit,e)&&this.handleSetRangeFormula(!1,t,r,n,i)})),this.enqueueRecalcFinished()}editPaste(e,t,r,n,i=(0,l.sheetGridRange)(r.sheet,G)){this.scheduler.addTask(q.ClientEdit,R.QueuePos.Back,(()=>{this.trySetStateId(q.ClientEdit,e)&&this.handleEditPaste(t,r,n,i)})),this.enqueueRecalcFinished()}assumeRecalcFinal(e,t){this.scheduler.addTask(q.ClientEdit,R.QueuePos.Back,(()=>{this.stateId===e&&this.handleAssumeRecalcFinal(t)}))}testAdvanceState(e){this.scheduler.addTask(q.TestAdvanceState,R.QueuePos.Back,(()=>{this.trySetStateId(q.TestAdvanceState,e)}))}step(){if(!this.scheduler.runTask())return{queueEmpty:!0,messages:[]};const e=this.outputMessageLog;return this.outputMessageLog=[],{queueEmpty:!1,messages:e}}trySetStateId(e,t){var r,n,i,o,a;if(t<this.stateId)return!1;if(e===q.ClientEdit&&(this.deleteComputeTasks(j.EditReceived),this.stateEvalTime=0),t>this.stateId){if(this.stateId!==-1/0){const e=this.config.sampleWorkbookStatisticsRate;void 0!==e&&this.shouldSample(e)&&this.outputMessageLog.push({kind:d.OutputMessageKind.WorkbookStatistics,stateId:this.stateId,stats:this.getStatistics(),p:e})}const e=1;this.stateChanges===e&&this.enqueueRunExperiments(A.ExperimentKind.OneShot),this.stateChanges>=e&&0===this.scheduler.getCount(q.RunExperiment)&&this.enqueueRunExperiments(A.ExperimentKind.Recurring);const s=null!==(r=this.config.samplePrecisionEvalRate)&&void 0!==r?r:0,l=null!==(n=this.config.samplePrecisionPrintFormulaRate)&&void 0!==n?n:0,u=null!==(i=this.config.samplePrecisionPrintValueRate)&&void 0!==i?i:0;if(this.stateChanges>=e&&(s>0||l>0||u>0)&&this.numPrecisionFailures<H.maxPrecisionFailures&&0===this.scheduler.getCount(q.RunExperiment)){const e=this.config.experimentFactories,t=null!==(o=null==e?void 0:e.stepBudget)&&void 0!==o?o:10,r=null!==(a=null==e?void 0:e.totalBudget)&&void 0!==a?a:1e4,n=new N.PrecisionExperiment({samplePrecisionEvalRate:s,samplePrecisionPrintFormulaRate:l,samplePrecisionPrintValueRate:u}),i={stateId:this.stateId,documents:this.docs.clone(n),stepBudget:t,totalBudget:r,viewport:this.lastViewport};n.setContext(i),this.enqueueRunExperiment("PrecisionExperiment",t,r,A.ExperimentKind.Precision,n,(()=>this.numPrecisionFailures=0),(()=>this.numPrecisionFailures+=1))}this.deleteComputeTasks(j.StateIdAdvanced),this.lastViewport=void 0;const c=this.stateId;this.stateId=t,this.docs.advanceState(c),this.outputMessageLog.push({kind:d.OutputMessageKind.StateAdvanced,stateId:this.stateId}),this.stateEvalTime=0,this.stateChangesSinceLastGC+=1,this.stateChanges+=1,this.enqueueMaybeCollectGarbage()}return!0}deleteComputeTasks(e){this.scheduler.deleteTasks(q.BeforeCompute,void 0),this.scheduler.deleteTasks(q.ComputeCellValue,void 0),this.scheduler.deleteTasks(q.AfterCompute,e),e!==j.EvalTimedOut&&this.scheduler.deleteTasks(q.ComputeEvalFormula,void 0)}enqueueRunExperiment(e,t,r,n,i,o,a){let s=0,l=0;const u=(t,r,o,a)=>{const s=i.failedLogMessage;void 0!==s&&this.outputMessageLog.push({experimentName:e,kind:d.OutputMessageKind.ExperimentRunResult,experimentKind:n,logMessage:s,timeoutReason:{budgetType:t,budget:r,elapsedTime:o,stepsCount:a}})},c=()=>{if(i.done){const t=i.resultLogMessage;return void 0!==t&&this.outputMessageLog.push({experimentName:e,kind:d.OutputMessageKind.ExperimentRunResult,experimentKind:n,logMessage:t}),void o()}const m=(0,f.now)();let g=m;for(let e=0;e<1e3&&g===m;e+=1){i.step(),l+=1;const e=(0,f.now)(),r=e-g;if(r>=t&&!i.done)return u("stepBudget",t,r,l),void a();g=e}if(s+=g>m?g-m:1,s>=r&&!i.done)return u("totalBudget",r,s,l),void a();this.scheduler.addTask(q.RunExperiment,R.QueuePos.Front,c)};this.scheduler.addTask(q.RunExperiment,R.QueuePos.Back,c)}enqueueRunExperiments(e){var t;if(!this.config.experimentFactories)return;const{stepBudget:r,totalBudget:n,factories:i}=this.config.experimentFactories,o=i.filter((t=>{var r,n;return t.kind===e&&(null!==(r=t.numFailures)&&void 0!==r?r:0)<(null!==(n=t.maxFailures)&&void 0!==n?n:3)}));if(0===o.length)return;const a={stateId:this.stateId,documents:this.docs.clone(S.voidCallback,e===A.ExperimentKind.OneShot?p.CloningTarget.Server:p.CloningTarget.Client),stepBudget:r,totalBudget:n,viewport:this.lastViewport};for(const i of o){const o=i.create();o&&(o.setContext(a),this.enqueueRunExperiment(i.experimentName,null!==(t=i.stepBudget)&&void 0!==t?t:r,n,e,o,(()=>i.numFailures=0),(()=>{var e;return i.numFailures=(null!==(e=i.numFailures)&&void 0!==e?e:0)+1})))}}setSheetNames(e,t,r){this.scheduler.addTask(q.ServerUpdate,R.QueuePos.Back,(()=>{if(!this.trySetStateId(q.ServerUpdate,r))return;const n=this.docs.setSheetNames(e,t);n.kind===k.ResultKind.Failure&&this.onUnavailableObject(n.reason),this.deleteComputeTasks(j.SetSheetNames)}))}setLangConfig(e,t){this.scheduler.addTask(q.ServerUpdate,R.QueuePos.Back,(()=>{if(!this.trySetStateId(q.ServerUpdate,e))return;const r=this.docs.config.localeInfo!==t.localeInfo,n=this.docs.config.refStyle!==t.refStyle;this.docs.setConfig(t),r&&this.docs.clearCompiledNumberFormats(),(r||n)&&(this.docs.clearCompiledFormulas(),this.deleteComputeTasks(j.SetLangConfig))}))}setNumberFormats(e,t,r,n){this.scheduler.addTask(q.ServerUpdate,R.QueuePos.Back,(()=>{if(!this.trySetStateId(q.ServerUpdate,n))return;const i=this.docs.setNumberFormats(e,t,r);return i.kind===k.ResultKind.Failure?this.onUnavailable(i.reason):void 0}))}writeNamedObject(e,t,r,n){this.scheduler.addTask(q.ServerUpdate,R.QueuePos.Back,(()=>{if(!this.trySetStateId(q.ServerUpdate,e))return;const i=this.docs.setNamedObject(!0,(0,l.nameLoc)(t,r),n);return i.kind===k.ResultKind.Failure?this.onUnavailable(i.reason):void 0}))}writeUndefinedNames(e,t){this.scheduler.addTask(q.ServerUpdate,R.QueuePos.Back,(()=>{if(!this.trySetStateId(q.ServerUpdate,e))return;const r=this.docs.setUndefinedNames(t);return r.kind===k.ResultKind.Failure?this.onUnavailable(r.reason):void 0}))}promoteNamedObjects(e,t,r){this.scheduler.addTask(q.ServerUpdate,R.QueuePos.Back,(()=>{if(!this.trySetStateId(q.ServerUpdate,e))return;const n=this.docs.promoteNamedObjects(t,r);if(n.kind===k.ResultKind.Failure)return this.onUnavailable(n.reason);n.value||this.outputMessageLog.push({kind:d.OutputMessageKind.UpdateNamesRequest,stateId:this.stateId,scope:t})}))}extendUnusedRange(e,t){this.scheduler.addTask(q.ServerUpdate,R.QueuePos.Back,(()=>{if(!this.trySetStateId(q.ServerUpdate,t))return;const r=this.docs.extendServerUnused(e.sheet,e.range);if(r.kind===k.ResultKind.Failure)return this.onUnavailableObject(r.reason);this.docs.onCellModified(!0)}))}writeHiddenRows(e,t){this.scheduler.addTask(q.ServerUpdate,R.QueuePos.Back,(()=>{if(!this.trySetStateId(q.ServerUpdate,e))return;const r=this.docs.writeHiddenRows(t.sheet,t.range,t.hidden);return r.kind===k.ResultKind.Failure?this.onUnavailableObject(r.reason):void 0}))}writeHiddenCols(e,t){this.scheduler.addTask(q.ServerUpdate,R.QueuePos.Back,(()=>{if(!this.trySetStateId(q.ServerUpdate,e))return;const r=this.docs.writeHiddenCols(t.sheet,t.range,t.hidden);return r.kind===k.ResultKind.Failure?this.onUnavailableObject(r.reason):void 0}))}writeInFilterMode(e,t){this.scheduler.addTask(q.ServerUpdate,R.QueuePos.Back,(()=>{if(!this.trySetStateId(q.ServerUpdate,e))return;const r=this.docs.writeInFilterMode(t.sheet,t.inFilterMode);return r.kind===k.ResultKind.Failure?this.onUnavailableObject(r.reason):void 0}))}getStatistics(){return{queueSize:this.scheduler.getCount(),totalGridStatistics:this.docs.getGridStatistics(),totalNameStatistics:this.docs.getNameStatistics()}}enqueueMaybeCollectGarbage(){this.scheduler.deleteTasks(q.MaybeCollectGarbage,void 0),this.scheduler.addTask(q.MaybeCollectGarbage,R.QueuePos.Back,(()=>{if(this.stateChangesSinceLastGC<t.MaxStateIdDifferenceForGC)return;const e=this.stateId-t.MaxStateIdDifferenceForGC;this.docs.collectGarbage(e),this.outputMessageLog.push({kind:d.OutputMessageKind.GarbageCollected,minStateIdKept:e}),this.stateChangesSinceLastGC=0}))}shouldSample(e){return void 0!==e&&this.rng.next()<=e}translateEnglishFormula(e,t){const r=this.englishParser.parseFormula((0,x.parseLocals)(l.LexicalKind.Cell,t.range),e);if(!(0,k.isSuccess)(r))return r;const i=this.englishAnalyzer.checkFormula((0,U.analyzeLocalsGrid)(l.LexicalKind.Cell,(0,l.sheetGridCell)(t.sheet,t.range)),r.value);if(!(0,k.isSuccess)(i))return i;if(!(0,a.isWellFormed)(i.value))return(0,k.failure)((0,n.illFormedFormula)("ill-formed formula"));const o=this.docs.printFormulaBarText((0,l.lexicalSourceGrid)(l.LexicalKind.Cell,t),t.range,i.value);return(0,k.isSuccess)(o)?(0,k.success)(o.value):o}restrictToViewport(e,t,r,n){if(void 0!==t){const{sheet:i,range:o}=t,a=(0,g.createCellSetFromRange)(o);for(const t of e)(0,s.isSheetIndexEqual)(i,t.sheet)&&n((0,d.sheetCellSet)(i,(0,y.intersectProduct)(t.set,a)),r)}else for(const t of e)n(t,r)}getVolatileMode(){var e;return null!==(e=this.config.volatileMode)&&void 0!==e?e:O.VolatileMode.Estimation}constructor(e,t={}){var r,n;this.scheduler=new R.PriorityScheduler,this.englishParser=(0,L.createParser)((0,x.createParseGlobals)(_.initialRecalcServiceConfig)),this.englishAnalyzer=(0,K.createAnalyzer)((0,U.createAnalyzeGlobals)(_.initialRecalcServiceConfig)),this.outputMessageLog=[],this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.stateChanges=0,this.stateEvalTime=0,this.latestSnapshotID=-1,this.numPrecisionFailures=0,this.printFormulaProperties=e=>{const t=(0,s.sheetGridRangeAnchor)(e),r=this.getAvailableFormula(t);if(!(0,k.isSuccess)(r))return void this.onUnavailableObject(r.reason);const[n,i]=r.value,o=i.compiledFmla.getValue(),a=(0,k.isSuccess)(o)?this.docs.printFormulaBarText(n,t.range,o.value):o;return{formulaBarText:a.kind===k.ResultKind.Success?a.value:void this.outputMessageLog.push({kind:d.OutputMessageKind.PrintFormulaFailure,stateId:this.stateId,range:e,reason:a.reason}),hasHyperlink:this.formulaHasHyperlink(i),isFormula:!0}},this.printValueProperties=(e,t)=>{var r,n;const i=this.docs.getEditedFormula(e);if(!(0,k.isSuccess)(i))return void this.onUnavailableObject(i.reason);const o=null!==(n=null===(r=i.value)||void 0===r?void 0:r[1].fmla)&&void 0!==n?n:"",a=this.docs.renderValueBarText(e,t,o);return{formulaBarText:(0,k.isSuccess)(a)?a.value:void this.outputMessageLog.push({kind:d.OutputMessageKind.PrintFormulaFailure,stateId:this.stateId,range:e,reason:a.reason}),hasHyperlink:!1,isFormula:!1}},this.scheduleAvailableFormulas=(e,t)=>{const r=this.docs.forEachEditedNonBlankCellInSet(e.sheet,e.set,(r=>{const n=(0,l.sheetGridCell)(e.sheet,r),i=this.docs.getEditedFormula(n);return i.kind===k.ResultKind.Failure?(this.onUnavailableObject(i.reason),!0):(void 0!==i.value&&void 0!==i.value[1].compiledFmla&&this.enqueueComputeCellValue(n,t),!0)}));(0,k.isSuccess)(r)||this.onUnavailableObject(r.reason)},this.scheduleAvailableValues=(e,t)=>{const r=this.docs.forEachEditedCellInSet(e.sheet,e.set,(r=>{const n=(0,l.sheetGridCell)(e.sheet,r),i=this.docs.getEditedFormula(n);return i.kind===k.ResultKind.Failure?(this.onUnavailableObject(i.reason),!0):(void 0!==i.value&&void 0!==i.value[1].compiledFmla||this.enqueueReturnCellValue(n,t),!0)}));(0,k.isSuccess)(r)||this.onUnavailableObject(r.reason)},this.docs=new S.PartialWorkbookDocumentCollection(e,this,t,t,null!==(r=t.maxDereferenceCells)&&void 0!==r?r:B,null!==(n=t.isServerWorkbookLoad)&&void 0!==n&&n),this.reconfigure(t)}}t.PartialWorkbook=H,H.maxPrecisionFailures=3},55195:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPartialWorkbook=t.blankStyle=t.genFmt=t.knownFormatData=t.kfToIformat=t.englishLocaleData=t.defaultConfig=t.mathpack=t.locale=t.createRange=t.assertMessageOrder=void 0;const n=r(88928),i=r(57264),o=r(53750),a=r(7793),s=r(25201),l=r(77497),u=r(14408),c=r(55340),d=r(71510),m=r(16811),g=r(71273),p=r(12450),h=r(90823),f=r(31053),S=r(68616),v=r(91709);var y;!function(e){e.EditedPhase="EditedPhase",e.DependentPhase="DependentPhase",e.StatisticsPhase="StatisticsPhase",e.Finished="Finished"}(y||(y={}));const F={kind:y.EditedPhase,stateId:-1/0},C=Object.getOwnPropertyNames(n.OutputMessageKind);function R(e,t){const r={};return e.forEach((e=>r[e]=t)),r}const b={[y.EditedPhase]:Object.assign(Object.assign(Object.assign({[n.OutputMessageKind.StateAdvanced]:()=>y.EditedPhase,[n.OutputMessageKind.RecalcStatistics]:(e,t)=>{if(t.message===n.RecalcStatisticsMessage.ChangedCell){if(t.cellKind===n.ComputedCellKind.EditedCell)return y.EditedPhase;if(t.cellKind===n.ComputedCellKind.DependentCell)return y.DependentPhase;if(t.cellKind===n.ComputedCellKind.IndependentCell)return y.EditedPhase;if(t.cellKind===n.ComputedCellKind.UnknownNonEditedCell)return e(`a different message.cellKind than ${t.cellKind}`);(0,i.assertNever)("calc.calc.partialWorkbook.testutilsutils.transitions",t.cellKind)}if(t.message===n.RecalcStatisticsMessage.UnchangedCell){if(t.cellKind===n.ComputedCellKind.EditedCell)return y.EditedPhase;if(t.cellKind===n.ComputedCellKind.DependentCell)return y.DependentPhase;if(t.cellKind===n.ComputedCellKind.IndependentCell)return y.EditedPhase;if(t.cellKind===n.ComputedCellKind.UnknownNonEditedCell)return e(`a different message.cellKind than ${t.cellKind}`);(0,i.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind)}return t.message===n.RecalcStatisticsMessage.ContinueComputation?y.EditedPhase:t.message===n.RecalcStatisticsMessage.EditFinished||t.message===n.RecalcStatisticsMessage.StateTimedOut?y.StatisticsPhase:t.message===n.RecalcStatisticsMessage.RecalcFinished?y.Finished:void(0,i.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.message)}},R([n.OutputMessageKind.CellWrite,n.OutputMessageKind.RangeWrite],((e,t)=>t.cellKind===n.ComputedCellKind.EditedCell?y.EditedPhase:t.cellKind===n.ComputedCellKind.DependentCell?y.DependentPhase:void(0,i.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind)))),{[n.OutputMessageKind.RangeFailure]:(e,t)=>t.cellKind===n.ComputedCellKind.EditedCell?y.EditedPhase:t.cellKind===n.ComputedCellKind.DependentCell?y.DependentPhase:t.cellKind===n.ComputedCellKind.IndependentCell?y.EditedPhase:t.cellKind===n.ComputedCellKind.UnknownNonEditedCell?y.DependentPhase:void(0,i.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind),[n.OutputMessageKind.PrintFormulaFailure]:()=>y.EditedPhase,[n.OutputMessageKind.InferFormatFailure]:()=>y.EditedPhase,[n.OutputMessageKind.FormatValueFailure]:()=>y.EditedPhase}),R([n.OutputMessageKind.GarbageCollected,n.OutputMessageKind.Alert,n.OutputMessageKind.ExperimentRunResult,n.OutputMessageKind.UpdateRequest,n.OutputMessageKind.WorkbookStatistics,n.OutputMessageKind.UnhandledFailure,n.OutputMessageKind.NumberFormatFailure,n.OutputMessageKind.NameFailure,n.OutputMessageKind.UpdateNamesRequest],(()=>y.EditedPhase))),[y.DependentPhase]:Object.assign(Object.assign(Object.assign(Object.assign({[n.OutputMessageKind.RecalcStatistics]:(e,t)=>{if(t.message===n.RecalcStatisticsMessage.ChangedCell){if(t.cellKind===n.ComputedCellKind.EditedCell)return e(`a different cellKind than ${t.cellKind}`);if(t.cellKind===n.ComputedCellKind.DependentCell)return y.DependentPhase;if(t.cellKind===n.ComputedCellKind.IndependentCell)return y.DependentPhase;if(t.cellKind===n.ComputedCellKind.UnknownNonEditedCell)return e(`a different cellKind than ${t.cellKind}`);(0,i.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind)}if(t.message===n.RecalcStatisticsMessage.UnchangedCell){if(t.cellKind===n.ComputedCellKind.EditedCell)return e(`a different cellKind than ${t.cellKind}`);if(t.cellKind===n.ComputedCellKind.DependentCell)return y.DependentPhase;if(t.cellKind===n.ComputedCellKind.IndependentCell)return y.DependentPhase;if(t.cellKind===n.ComputedCellKind.UnknownNonEditedCell)return e(`a different cellKind than ${t.cellKind}`);(0,i.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind)}return t.message===n.RecalcStatisticsMessage.ContinueComputation?e(`a different message.message than ${t.message}`):t.message===n.RecalcStatisticsMessage.EditFinished?y.StatisticsPhase:t.message===n.RecalcStatisticsMessage.StateTimedOut||t.message===n.RecalcStatisticsMessage.RecalcFinished?e(`a different message.message than ${t.message}`):void(0,i.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.message)}},R([n.OutputMessageKind.CellWrite,n.OutputMessageKind.RangeWrite],((e,t)=>t.cellKind===n.ComputedCellKind.EditedCell?e(`a different message.cellKind than ${t.cellKind}`):t.cellKind===n.ComputedCellKind.DependentCell?y.DependentPhase:void(0,i.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind)))),{[n.OutputMessageKind.RangeFailure]:(e,t)=>t.cellKind===n.ComputedCellKind.EditedCell?t.reason.kind===o.ReasonKind.CellCycle?y.DependentPhase:e(`the current state to be ${y.EditedPhase}, or ${y.DependentPhase} and failure ${o.ReasonKind.CellCycle}`):t.cellKind===n.ComputedCellKind.IndependentCell||t.cellKind===n.ComputedCellKind.DependentCell||t.cellKind===n.ComputedCellKind.UnknownNonEditedCell?y.DependentPhase:void(0,i.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind),[n.OutputMessageKind.FormatValueFailure]:()=>y.DependentPhase}),R([n.OutputMessageKind.GarbageCollected,n.OutputMessageKind.Alert,n.OutputMessageKind.ExperimentRunResult],((e,t)=>e(`a different message.kind than ${t.kind}`)))),R([n.OutputMessageKind.StateAdvanced,n.OutputMessageKind.UpdateRequest,n.OutputMessageKind.WorkbookStatistics,n.OutputMessageKind.UnhandledFailure,n.OutputMessageKind.NumberFormatFailure,n.OutputMessageKind.NameFailure,n.OutputMessageKind.PrintFormulaFailure,n.OutputMessageKind.InferFormatFailure,n.OutputMessageKind.UpdateNamesRequest],((e,t)=>e(`a different message.kind than ${t.kind}`)))),[y.StatisticsPhase]:Object.assign(Object.assign({[n.OutputMessageKind.RecalcStatistics]:(e,t)=>t.message===n.RecalcStatisticsMessage.ChangedCell||t.message===n.RecalcStatisticsMessage.UnchangedCell||t.message===n.RecalcStatisticsMessage.ContinueComputation||t.message===n.RecalcStatisticsMessage.EditFinished||t.message===n.RecalcStatisticsMessage.StateTimedOut?e(`a different message.message than ${t.message}`):t.message===n.RecalcStatisticsMessage.RecalcFinished?y.Finished:void(0,i.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.message)},R([n.OutputMessageKind.GarbageCollected,n.OutputMessageKind.Alert,n.OutputMessageKind.ExperimentRunResult],((e,t)=>e(`a different message.kind than ${t.kind}`)))),R([n.OutputMessageKind.CellWrite,n.OutputMessageKind.RangeWrite,n.OutputMessageKind.RangeFailure,n.OutputMessageKind.PrintFormulaFailure,n.OutputMessageKind.InferFormatFailure,n.OutputMessageKind.FormatValueFailure,n.OutputMessageKind.StateAdvanced,n.OutputMessageKind.UpdateRequest,n.OutputMessageKind.WorkbookStatistics,n.OutputMessageKind.NumberFormatFailure,n.OutputMessageKind.UnhandledFailure,n.OutputMessageKind.NameFailure,n.OutputMessageKind.UpdateNamesRequest],((e,t)=>e(`a different message.kind than ${t.kind}`)))),[y.Finished]:R(C,(e=>e("no message once recalc finished")))};function E(e,t,r){const{stateId:i,kind:o}=e,a=function(e,t){switch(t.kind){case n.OutputMessageKind.GarbageCollected:return expect(t.minStateIdKept).toBeLessThanOrEqual(e),e;case n.OutputMessageKind.Alert:return e;case n.OutputMessageKind.ExperimentRunResult:return t.experimentKind===S.ExperimentKind.OneShot&&expect(e).toEqual(1),e;default:return expect(e).toBeLessThanOrEqual(t.stateId),t.stateId}}(i,t);return{kind:(0,b[o][t.kind])((function(n){return expect({state:e,message:t,index:r}).toEqual(n)}),t,o),stateId:a}}t.assertMessageOrder=function(e){e.reduce(E,F)},t.createRange=function(e,t){return[(0,a.sheetGridRange)(e,t),(0,n.sheetCellSet)(e,(0,s.createCellSetFromRange)(t))]},t.locale=(0,c.getEnglishLocaleInfo)(),t.mathpack=l.xlMathpack,t.defaultConfig={localeInfo:t.locale,mathpack:t.mathpack,refStyle:d.RefStyle.A1,date1904:!1,dateCompatibility:!0,timezone:m.tzUTC,datepack:m.xlDatepack},t.englishLocaleData=(0,f.localeData)([{functionId:0,functionName:"COUNT"}],[{errorType:1,errorName:"#NULL!"}],"TRUE","FALSE","R","C","{","}","[","]",".",",",",",";",[3,0],",",1033,1,2,!1," ",!1,"Paren",!0,!1,"$",2,"MDY","/","-",!0,!1,!1,!0,":",null,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],["AM/PM","A/P","/",null,"General","$"],[null,";","#","0",".","%",",",":","/","/"," ","-","+","(",")",null,"\\","*","y","m","d","h","m","s","E","/",'"',"[","]","@","?","_","r","a","g","e",null,null,null,null,null,null,"B","N","","","","b","","","","","",null],["Black","White","Red","Green","Blue","Yellow","Magenta","Cyan","Color"],["DBNum1","DBNum2","DBNum3","DBNum4"],(0,v.partialArray)({[d.SpecialRefId.All]:"#All",[d.SpecialRefId.Data]:"#Data",[d.SpecialRefId.Headers]:"#Headers",[d.SpecialRefId.Totals]:"#Totals",[d.SpecialRefId.ThisRow]:"#This Row"}),"dddd, mmmm dd, yyyy","h:mm:ss AM/PM"),t.kfToIformat=e=>Math.abs(e),t.knownFormatData=(0,p.numEnumArray)(g.KnownFormat).filter((e=>(0,h.isKnownFormatDefined)(e,(0,c.getEnglishLocaleInfo)()))).map((e=>(0,f.numberFormat)((0,t.kfToIformat)(e),(0,h.getKnownFormat)(t.locale,e),!0))),t.genFmt=(0,t.kfToIformat)(g.KnownFormat.General),t.blankStyle=n.SpecialStyle.Blank,t.createPartialWorkbook=function(e,r,n){var i,o,a;const s=new u.PartialWorkbook(Object.assign(Object.assign({},t.defaultConfig),{localeInfo:null!==(i=null==n?void 0:n.localeOverride)&&void 0!==i?i:t.locale}),r);return s.setWorksheetFuncOverrides(null!==(o=null==n?void 0:n.worksheetFuncOverrides)&&void 0!==o?o:{}),(null===(a=null==n?void 0:n.setNumberFormats)||void 0===a||a)&&s.setNumberFormats(e,t.knownFormatData,!1,-1/0),s}},84057:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookDocument=void 0;const n=r(50338),i=r(12450),o=r(55380),a=r(25201),s=r(88928),l=r(33436),u=r(83102),c=r(43364),d=r(67396);class m{clone(e=o.CloningTarget.Server){let t;if(this.grids){t=(0,i.makeStringMap)();for(const r in this.grids){const n=this.grids[r];t[r]=n.clone(e)}}return new m(this.document,this.stringCompareCI,this.formats.clone(),this.styles.clone(),this.sheets.clone(),t,void 0,this.nameManager.clone())}getReadonlyNameManager(){return this.nameManager}getReadonlySheets(){return this.sheets}setClientValue(e,t,r){const n=this.getGridById(e.sheet.index);return n.kind===l.ResultKind.Failure?n:(0,l.success)(n.value.setClientValue(e.range,t,r))}setClientFormula(e,t,r){const n=this.getGridById(e.sheet.index);return n.kind===l.ResultKind.Failure?n:(0,l.success)(n.value.setClientFormula(e.range,e.range,t,r))}setRecalcFailure(e,t){const r=this.getGridById(e);return r.kind===l.ResultKind.Failure?r:(0,l.success)(r.value.setRecalcFailure(t))}setRecalcEditTaint(e,t){const r=this.getGridById(e);return r.kind===l.ResultKind.Failure?r:(0,l.success)(r.value.setRecalcEditTaint(t))}setRecalcValue(e,t){const r=this.getGridById(e.sheet.index);return r.kind===l.ResultKind.Failure?r:(0,l.success)(r.value.setRecalcValue(e.range,t))}setEditedFormat(e,t){const r=this.getGridById(e.sheet.index);return r.kind===l.ResultKind.Failure?r:(0,l.success)(r.value.setEditedFormat(e.range,t))}setClientFormat(e,t,r){const n=this.getGridById(e.sheet.index);return n.kind===l.ResultKind.Failure?n:(0,l.success)(n.value.setClientFormat(e.range,t,r))}setHiddenRows(e,t,r){const n=this.getGridById(e);return n.kind===l.ResultKind.Failure?n:(0,l.success)(n.value.setHiddenRows(t,r))}setHiddenCols(e,t,r){const n=this.getGridById(e);return n.kind===l.ResultKind.Failure?n:(0,l.success)(n.value.setHiddenCols(t,r))}setMergeCell(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.setMergeCell(e.range))}setInFilterMode(e,t){const r=this.getGridById(e);return r.kind===l.ResultKind.Failure?r:(0,l.success)(r.value.setInFilterMode(t))}setCellContents(e,t,r,i,o,a,s,u,c){const d=this.getGridById(t.sheet.index);if(d.kind===l.ResultKind.Failure)return d;const m=void 0!==u&&(0,n.isSheetIndexEqual)(t.sheet,u.sheet)?u.range:void 0;return(0,l.success)(d.value.setCellContents(e,t.set,r,i,o,a,s,m,c))}setRangeFormula(e,t,r,i,o,a,s,u){const c=this.getGridById(t.sheet.index);if(c.kind===l.ResultKind.Failure)return c;const d=void 0!==s&&(0,n.isSheetIndexEqual)(t.sheet,s.sheet)?s.range:void 0;return(0,l.success)(c.value.setRangeFormula(e,t.range,r,i,o,a,d,u))}copyRange(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.copyRange(e.range))}pasteRange(e,t,r){const n=this.getGridById(e.sheet.index);return n.kind===l.ResultKind.Failure?n:(0,l.success)(n.value.pasteRange(e.range,t,r))}assumeRecalcFinal(e,t){const r=this.getGridById(e.sheet.index);return r.kind===l.ResultKind.Failure?r:(0,l.success)(r.value.assumeRecalcFinal(e.set,t))}getDirtyEditedCells(){const e=[];return this.forEachSheet(((t,r)=>{e.push((0,s.sheetCellSet)(t.sheetIndex,r.getDirtyEditedCells()))})),e}getNonDirtyEditedCells(){const e=[];return this.forEachSheet(((t,r)=>{e.push((0,s.sheetCellSet)(t.sheetIndex,r.getNonDirtyEditedCells()))})),e}getDirtyDependentCells(){const e=[];return this.forEachSheet(((t,r)=>{e.push((0,s.sheetCellSet)(t.sheetIndex,r.getDirtyDependentCells()))})),e}setNamedObject(e,t,r,n){return this.nameManager.setNamedObject(e,t,r,n)}setUndefinedNames(e){return this.nameManager.setUndefinedNames(e)}promoteNamedObjects(e,t){return this.nameManager.promoteNamedObjects(e,t)}setSheetNames(e){var t,r;const n=null!==(t=this.grids)&&void 0!==t?t:this.oldGrids,a=(0,i.makeStringMap)();for(const{sheetId:t}of e)a[t]=null!==(r=null==n?void 0:n[t])&&void 0!==r?r:o.PartialWorkbookGrid.create();return new m(this.document,this.stringCompareCI,this.formats,this.styles,this.sheets.setSheetNames(e),a,void 0,this.nameManager.setSheetNames(e))}extendServerUnused(e,t,r){const n=this.getGridById(e);return n.kind===l.ResultKind.Failure?n:(0,l.success)(n.value.extendServerUnused(t,r))}promoteServerAvailability(e,t,r){const n=this.getGridById(e);return n.kind===l.ResultKind.Failure?n:(0,l.success)(n.value.promoteServerAvailability(t,r))}getNameLoc(e,t,r){return this.nameManager.getNameLoc(e,t,r)}getNameFormula(e,t){return this.nameManager.getNameFormula(e,t)}hasRecalcNameFailure(e){return this.nameManager.hasRecalcNameFailure(e)}setRecalcNameFailure(e){return this.nameManager.setRecalcNameFailure(e)}getContainingTable(e){const t=this.nameManager.getContainingTable(e);if(t.kind===l.ResultKind.Failure||void 0!==t.value)return t;const r=this.getGridById(e.sheet.index);if(r.kind===l.ResultKind.Failure)return(0,l.failure)((0,n.unavailable)([r.reason]));const i=(0,u.intersectProduct)((0,a.createCellSetFromRange)(e.range),a.availableSetProduct);return(0,u.meetsProduct)(i,r.value.getServerAvailability())?l.successUndefined:(0,l.failure)((0,n.unavailable)([{kind:s.UnavailableKind.ContainingTable,range:e}]))}getNamedRanges(e){const t=this.nameManager.getNamedRanges(e);if(t.kind===l.ResultKind.Failure||void 0!==t.value)return t;const r=this.getGridById(e.sheet.index);if(r.kind===l.ResultKind.Failure)return(0,l.failure)((0,n.unavailable)([r.reason]));const i=(0,u.intersectProduct)((0,a.createCellSetFromRange)(e.range),a.availableSetProduct);return(0,u.meetsProduct)(i,r.value.getServerAvailability())?(0,l.success)([]):(0,l.failure)((0,n.unavailable)([{kind:s.UnavailableKind.NamedRanges,range:e}]))}getIntersectingTables(e){return this.nameManager.getIntersectingTables(e)}getStructRefColumn(e,t){return this.nameManager.getStructRefColumn(e,t)}getStructRefSpecialRef(e,t){return this.nameManager.getStructRefSpecialRef(e,t)}getEditedFormula(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.getEditedFormula(e.range))}forEachEditedFormula(e,t){const r=this.getGridById(e.sheet.index);return r.kind===l.ResultKind.Failure?r:(0,l.success)(r.value.forEachEditedFormula(e.range,t))}getEditedValue(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.getEditedValue(e.range))}forEachEditedValue(e,t){const r=this.getGridById(e.sheet.index);return r.kind===l.ResultKind.Failure?r:(0,l.success)(r.value.forEachEditedValue(e.range,t))}getEditedFormat(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.getEditedFormat(e.range))}forEachEditedFormat(e,t){const r=this.getGridById(e.sheet.index);return r.kind===l.ResultKind.Failure?r:(0,l.success)(r.value.forEachEditedFormat(e.range,t))}getEditedStyle(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.getEditedStyle(e.range))}isInFilterMode(e){const t=this.getGridById(e);return t.kind===l.ResultKind.Failure?t:t.value.isInFilterMode()}getHiddenRows(e,t,r){const n=this.getGridById(e);return n.kind===l.ResultKind.Failure?o.hiddennessFullyUnavailable:n.value.getHiddenRows(t,r)}tryGetHiddenRows(e,t,r){const n=this.getGridById(e);return n.kind===l.ResultKind.Failure?n:n.value.tryGetHiddenRows(t,r)}getHiddenCols(e,t,r){const n=this.getGridById(e);return n.kind===l.ResultKind.Failure?o.hiddennessFullyUnavailable:n.value.getHiddenCols(t,r)}tryGetHiddenCols(e,t,r){const n=this.getGridById(e);return n.kind===l.ResultKind.Failure?n:n.value.tryGetHiddenCols(t,r)}getMergeCell(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.getMergeCell(e.range))}getServerFormat(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.getServerFormat(e.range))}getServerStyle(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.getServerStyle(e.range))}getClientFormat(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.getClientFormat(e.range))}getClientValue(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.getClientValue(e.range))}getRecalcValues(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.getRecalcValues(e.range))}forEachRecalcValue(e,t){const r=this.getGridById(e.sheet.index);return r.kind===l.ResultKind.Failure?r:(0,l.success)(r.value.forEachRecalcValue(e.range,t))}getServerValue(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.getServerValue(e.range))}getServerFormula(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.getServerFormula(e.range))}getClientFormula(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.getClientFormula(e.range))}getServerUsedRange(e){const t=this.getGridById(e);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.getServerUsedRange())}allServerAvailable(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.allServerAvailable(e.range))}allEditedAvailable(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.allEditedAvailable(e.range))}forEachRecalcDirty(e,t){const r=this.getGridById(e.sheet.index);return r.kind===l.ResultKind.Failure?r:(0,l.success)(r.value.forEachRecalcDirty(e.range,t))}hasRecalcDirty(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.hasRecalcDirty(e.range))}hasRecalcFailure(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.hasRecalcFailure(e.range))}hasEditedEditTaint(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.hasEditedEditTaint(e.range))}hasRecalcEditTaint(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.hasRecalcEditTaint(e.range))}forEachEditedNonBlankCellInSet(e,t,r){const n=this.getGridById(e);return n.kind===l.ResultKind.Failure?n:(0,l.success)(n.value.forEachEditedNonBlankCellInSet(t,r))}forEachServerNonBlankCellInSet(e,t,r){const n=this.getGridById(e);return n.kind===l.ResultKind.Failure?n:(0,l.success)(n.value.forEachServerNonBlankCellInSet(t,r))}forEachEditedCellInSet(e,t,r){const n=this.getGridById(e);return n.kind===l.ResultKind.Failure?n:(0,l.success)(n.value.forEachEditedCellInSet(t,r))}getSheetIndex(e){const t=this.sheets.getSheetByName(e);return t.kind===l.ResultKind.Failure||void 0===t.value?t:(0,l.success)(t.value.sheetIndex)}getSheetName(e){const t=this.sheets.getSheetById(e);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.name)}getEditedUsedRange(e){const t=this.getGridById(e);return t.kind===l.ResultKind.Failure?t:(0,l.success)(t.value.getEditedUsedRange())}getSheetRangeIds(e){return this.sheets.getSheetRangeIds(e)}getIformat(e){return this.formats.getIformat(e)}getIformats(){return this.formats.getIformats()}getKnownFormat(e){return this.formats.getKnownFormat(e)}getFormatString(e){return this.formats.getFormatString(e)}resolveCellStyle(e){return this.styles.resolveCellStyle(e)}setNumberFormats(e,t){this.formats.setNumberFormats(e,t)}setStyles(e,t){this.styles.setStyles(e,t)}setFonts(e,t){this.styles.setFonts(e,t)}setFills(e,t){this.styles.setFills(e,t)}setBorders(e,t){this.styles.setBorders(e,t)}onCellModified(e,t){this.forEachSheet(((r,n)=>{n.onCellModified(e,t)})),this.nameManager.onCellModified(e)}collectGarbage(e,t){this.forEachSheet(((r,n)=>{n.collectGarbage(e,t)})),this.nameManager.collectGarbage(e)}advanceState(e,t){this.forEachSheet(((r,n)=>{n.advanceState(e,t)})),this.nameManager.advanceState(e),this.sheets.advanceState(e),this.oldGrids=this.grids,this.grids=void 0}clearCompiledFormulas(){this.forEachSheet(((e,t)=>{t.clearCompiledFormulas()})),this.nameManager.resetLazyData()}clearCompiledNumberFormats(){this.formats.clearCompiledNumberFormats()}getGridStatistics(){let e=o.emptyGridStatistics;return this.forEachSheet(((t,r)=>e=(0,o.mergeGridStatistics)(e,r.getStatistics()))),e}getNameStatistics(){return this.nameManager.getNameStatistics()}getServerAvailableCells(){const e=[];return this.forEachSheet(((t,r)=>{e.push({sheetIdx:t.sheetIndex,availableCells:r.getServerAvailability()})})),e}forEachSheet(e){const t=this.grids;t&&this.sheets.forEachSheet(((r,n)=>{const i=t[n];i&&e(r,i)}))}getGridById(e){const t=this.grids;if(!t)return(0,l.failure)({kind:s.UnavailableKind.SheetNames});const r=t[e];return void 0===r?(0,l.failure)({kind:s.UnavailableKind.SheetId,document:this.document,sheetId:e}):(0,l.success)(r)}constructor(e,t,r,n,i=new d.PartialWorkbookSheets(e,t),o,a,s=new c.PartialWorkbookNameManager(e,t)){this.document=e,this.stringCompareCI=t,this.formats=r,this.styles=n,this.sheets=i,this.grids=o,this.oldGrids=a,this.nameManager=s}}t.PartialWorkbookDocument=m},74185:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookDocumentCollection=t.voidCallback=void 0;const n=r(84057),i=r(7793),o=r(50338),a=r(50338),s=r(55340),l=r(55380),u=r(30333),c=r(25201),d=r(88928),m=r(88928),g=r(91889),p=r(30006),h=r(53750),f=r(96547),S=r(77721),v=r(65524),y=r(71510),F=r(71510),C=r(71510),R=r(81476),b=r(96438),E=r(69609),T=r(12450),k=r(57264),P=r(74226),N=r(30007),A=r(57296),I=r(36665),O=r(5241),_=r(94591),M=r(88449),D=r(82659),w=r(73693),L=r(33436),x=r(71948),K=r(57777),U=r(71273),B=r(20778),G=r(23430),W=r(90823),V=r(91709),j=r(39986),q=r(24270),H=r(25856),z=r(12367),$=(0,i.gridCell)(0,0);class Q extends j.ConstVisitor{wsfNode(e){this.fns.push((0,s.englishWorksheetFuncIdToName)(e))}operatorNode(e){this.fns.push((0,s.englishOperatorIdToName)(e))}constructor(){super(void 0),this.fns=[]}}function Y(e){const t=new Q;return(0,j.reduceBottomUp)(t,e),t.fns}const J=(0,u.precedents)([],[],[],w.SpecialPrecs.None,u.PrecsBound.Exact);t.voidCallback={onNameFailure:()=>{},onRangeFailure:()=>{},onNumberFormatFailure:()=>{},onInferFormatFailure:()=>{},onUnavailableObject:()=>{},onUnavailable:()=>{},onSetCellValue:()=>{},onSetCellValues:()=>{},onReturnCellValue:()=>{}};class X{clone(e=t.voidCallback,r=l.CloningTarget.Server){var n;const i=new X(this.config,e,this.schedulerConfig,this.limits,this.maxDereferenceCells,this.isServerWorkbookLoad);return i.documentLoc=this.documentLoc,i.document=null===(n=this.document)||void 0===n?void 0:n.clone(r),i.worksheetFuncOverrides=this.worksheetFuncOverrides,i.userDefinedFuncOverrides=this.userDefinedFuncOverrides,i.version=this.version,i}compareVersion(e){return this.version===e.version}getSingleReadonlyDocument(){return this.document}reconfigure(e,t,r,n){this.schedulerConfig=e,this.limits=t,this.maxDereferenceCells=r,this.isServerWorkbookLoad=n,this.advanceVersion()}setConfig(e){this.config=e}forEachDocument(e){void 0!==this.document&&e(this.document)}getDocumentLoc(e,t){const r=this.documentLoc;return void 0===r||void 0!==e&&e!==r.path||0!==this.config.localeInfo.stringCompareCI(t,r.name)?(0,L.failure)((0,a.unavailable)([{kind:d.UnavailableKind.DocumentLoc,document:(0,i.documentLoc)(e,t)}])):(0,L.success)(r)}getNameLoc(e,t,r){const n=this.getDocument(e.document);return n.kind===L.ResultKind.Failure?(0,L.failure)((0,a.unavailable)([n.reason])):n.value.getNameLoc(e.index,t,r)}getUserDefinedFuncLoc(e,t){if(void 0!==this.userDefinedFuncOverrides[t]){const r=(0,i.userDefinedFuncLoc)(e,t);return(0,L.success)([r])}return(0,L.failure)((0,a.notImplemented)(["call UDF"]))}getCellFormat(e){const t=this.allEditedAvailable(e);if(t.kind===L.ResultKind.Failure)return(0,L.failure)((0,a.unavailable)([t.reason]));if(!0!==t.value)return(0,L.failure)((0,a.unavailable)([{kind:d.UnavailableKind.GridRange,unavailableCells:t.value,range:e}]));const r=this.getEditedFormat(e);return r.kind===L.ResultKind.Failure?(0,L.failure)((0,a.unavailable)([r.reason])):r.value===m.SpecialFormat.Unavailable?(0,L.failure)((0,a.unavailable)([{kind:d.UnavailableKind.CellFormat}])):(0,L.success)(r.value)}getCellStyle(e){const t=this.allEditedAvailable(e);if(!(0,L.isSuccess)(t))return(0,L.failure)((0,a.unavailable)([t.reason]));if(!0!==t.value)return(0,L.failure)((0,a.unavailable)([{kind:d.UnavailableKind.GridRange,unavailableCells:t.value,range:e}]));const r=this.getEditedStyle(e);return(0,L.isSuccess)(r)?r.value===m.SpecialStyle.Unavailable?(0,L.failure)((0,a.unavailable)([{kind:d.UnavailableKind.CellStyle}])):this.resolveCellStyle(e.sheet.document,r.value):(0,L.failure)((0,a.unavailable)([r.reason]))}getIformat(e,t){const r=this.getDocument(e);if(r.kind===L.ResultKind.Failure)return(0,L.failure)((0,a.unavailable)([r.reason]));const n=r.value.getIformat(t);if(n.kind===L.ResultKind.Failure)return(0,L.failure)((0,a.unavailable)([n.reason]));const i=n.value.getValue();return i.kind===L.ResultKind.Failure?(0,L.failure)((0,_.previousFormatFailure)((0,_.formatLocIFormat)(e,t))):i}getIformats(e,t,r){const n=this.getDocument(e);if(n.kind===L.ResultKind.Failure)return(0,L.failure)((0,a.unavailable)([n.reason]));const i=n.value.getIformats(),o=[];for(let e=t,n=(0,T.fastMin)(i.length,r);e<n;e+=1){const t=i[e];void 0!==t&&o.push({iformat:e,formatString:t.formatString,builtIn:t.builtIn})}return(0,L.success)(o)}getKnownFormat(e,t){const r=this.getDocument(e);if(r.kind===L.ResultKind.Failure)return(0,L.failure)((0,a.unavailable)([r.reason]));const n=r.value.getKnownFormat(t);if(n.kind===L.ResultKind.Failure)return(0,L.failure)((0,a.unavailable)([n.reason]));const i=n.value.getValue();return i.kind===L.ResultKind.Failure?(0,L.failure)((0,_.previousFormatFailure)((0,_.formatLocKnownFormat)(e,t))):i}getFormatString(e,t){const r=this.getDocument(e);if(r.kind===L.ResultKind.Failure)return(0,L.failure)((0,a.unavailable)([r.reason]));const n=r.value.getFormatString(t);return n.kind===L.ResultKind.Failure?(0,L.failure)((0,a.unavailable)([n.reason])):n}getNameFormula(e,t){const r=this.getDocument(e.scope.document);if(r.kind===L.ResultKind.Failure)return(0,L.failure)((0,a.unavailable)([r.reason]));const n=r.value.getNameFormula(e,t);if(n.kind===L.ResultKind.Failure)return n;if(void 0===n.value)return(0,L.success)(void 0);const i=n.value.lazyData.getValue();if((0,L.isSuccess)(i))return i;const o=this.hasRecalcNameFailure(e);return(0,L.isSuccess)(o)?o.value||this.setNameFailure(e,i.reason):this.cb.onUnavailable(o.reason),(0,L.failure)((0,h.previousNameFailure)(e))}getCellFormula(e){const t=this.getEditedFormula(e);if(t.kind===L.ResultKind.Failure)return(0,L.failure)((0,a.unavailable)([t.reason]));if(void 0===t.value)return(0,L.success)(void 0);const[r,n]=t.value;if(void 0===n.compiledFmla)return(0,L.success)(void 0);const o=(0,i.sheetGridRange)(e.sheet,r),s=this.readCompiledFmla(o,n.compiledFmla);return(0,L.isSuccess)(s)?(0,L.success)((0,h.cellFormula)((0,i.lexicalSourceGrid)(n.lexicalKind,o),s.value)):s}setCellValue(e,t,r){const n=this.setRecalcValue(e,t);if(n.kind===L.ResultKind.Failure)return this.cb.onUnavailableObject(n.reason);const i=this.propagateEditTaint(e,r);if(i.kind===L.ResultKind.Failure)return this.cb.onUnavailableObject(i.reason);this.cb.onSetCellValue(e,t,r,i.value,this.evalParams)}setCellValues(e,t,r){const n=this.setClientValue(e,t);if(n.kind===L.ResultKind.Failure)return this.cb.onUnavailableObject(n.reason);const i=this.setRecalcValue(e,t);if(i.kind===L.ResultKind.Failure)return this.cb.onUnavailableObject(i.reason);const o=this.propagateEditTaint(e,r);if(o.kind===L.ResultKind.Failure)return this.cb.onUnavailableObject(o.reason);this.cb.onSetCellValues(e,t,r,o.value,this.evalParams)}getWorksheetFunc(e){var t;if((0,b.isVolatileFunc)(e)){let t=!1;const r=this.evalParams.volatileMode;switch(e){case b.WorksheetFuncId.RAND:case b.WorksheetFuncId.RANDBETWEEN:case b.WorksheetFuncId.RANDARRAY:case b.WorksheetFuncId.NOW:t=r===R.VolatileMode.GroundTruth;break;case b.WorksheetFuncId.TODAY:t=r===R.VolatileMode.GroundTruth||r===R.VolatileMode.Estimation;break;default:t=void 0===b.WorksheetFuncId[e]}if(!t)return(0,L.failure)((0,a.unavailable)([{kind:d.UnavailableKind.VolatileFunction,name:(0,s.englishWorksheetFuncIdToName)(e)}]))}const r=null!==(t=this.worksheetFuncOverrides[e])&&void 0!==t?t:(0,E.getWorksheetFunc)(e);return null!=r?(0,L.success)(r):(0,L.failure)((0,a.notImplemented)([(0,s.englishWorksheetFuncIdToName)(e)]))}getUserDefinedFunc(e){const t=e.id;return void 0!==this.userDefinedFuncOverrides[t]?(0,L.success)(this.userDefinedFuncOverrides[t]):(0,L.failure)((0,a.notImplemented)(["call UDF"]))}getSheetRangeIndexes(e){return this.getSheetRangeIds(e)}setCellFailure(e,t,r){var n;const i=this.setRecalcFailure(e.sheet,(0,c.createCellSetFromRange)(e.range));if(i.kind===L.ResultKind.Failure)return this.cb.onUnavailableObject(i.reason);const o=this.setClientValue(e,l.clientValueUnknownOper);if(o.kind===L.ResultKind.Failure)return this.cb.onUnavailableObject(o.reason);const a=this.setRecalcValue(e,u.blankOper);if(a.kind===L.ResultKind.Failure)return this.cb.onUnavailableObject(a.reason);const s=this.propagateEditTaint(e,r);if(s.kind===L.ResultKind.Failure)return this.cb.onUnavailableObject(s.reason);const d=this.evalParams;null===(n=d.onRangeFailure)||void 0===n||n.call(d,e,t,r),this.cb.onRangeFailure(e,t,r,s.value,d)}getUsedRange(e){const t=this.getEditedUsedRange(e);return t.kind===L.ResultKind.Failure?(0,L.failure)((0,a.unavailable)([t.reason])):t}getSheetName(e,t){const r=this.getDocument(e);if(r.kind===L.ResultKind.Failure)return(0,L.failure)((0,a.unavailable)([r.reason]));const n=r.value.getSheetName(t);return n.kind===L.ResultKind.Failure||void 0===n.value?n:(0,L.success)(n.value)}getSheetIndex(e,t){const r=this.getDocument(e);if(r.kind===L.ResultKind.Failure)return(0,L.failure)((0,a.unavailable)([r.reason]));const n=r.value.getSheetIndex(t);return n.kind===L.ResultKind.Failure||void 0===n.value?n:(0,L.success)(n.value.index)}getContainingTable(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?(0,L.failure)((0,a.unavailable)([t.reason])):t.value.getContainingTable(e)}getNamedRanges(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?(0,L.failure)((0,a.unavailable)([t.reason])):t.value.getNamedRanges(e)}getStructRefColumn(e,t){const r=this.getDocument(e.scope.document);return r.kind===L.ResultKind.Failure?(0,L.failure)((0,a.unavailable)([r.reason])):r.value.getStructRefColumn(e,t)}getStructRefSpecialRef(e,t){const r=this.getDocument(e.scope.document);return r.kind===L.ResultKind.Failure?(0,L.failure)((0,a.unavailable)([r.reason])):r.value.getStructRefSpecialRef(e,t)}getIntersectingTables(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?(0,L.failure)((0,a.unavailable)([t.reason])):t.value.getIntersectingTables(e)}getNamedObject(e,t){var r;const n=this.getDocument(e.scope.document);if(n.kind===L.ResultKind.Failure)return(0,L.failure)((0,a.unavailable)([n.reason]));const i=n.value.getNameFormula(e,t);return i.kind===L.ResultKind.Failure?i:(0,L.success)(null===(r=i.value)||void 0===r?void 0:r.obj)}getHiddenRows(e,t,r){const n=this.getDocument(e.document);return n.kind===L.ResultKind.Failure?l.hiddennessFullyUnavailable:n.value.getHiddenRows(e.index,t,r)}tryGetHiddenRows(e,t,r){const n=this.getDocument(e.document);if(n.kind===L.ResultKind.Failure)return(0,L.failure)((0,a.unavailable)([n.reason]));const i=n.value.tryGetHiddenRows(e.index,t,r);return i.kind===L.ResultKind.Failure?(0,L.failure)((0,a.unavailable)([i.reason])):i}getHiddenCols(e,t,r){const n=this.getDocument(e.document);return n.kind===L.ResultKind.Failure?l.hiddennessFullyUnavailable:n.value.getHiddenCols(e.index,t,r)}tryGetHiddenCols(e,t,r){const n=this.getDocument(e.document);if(n.kind===L.ResultKind.Failure)return(0,L.failure)((0,a.unavailable)([n.reason]));const i=n.value.tryGetHiddenCols(e.index,t,r);return i.kind===L.ResultKind.Failure?(0,L.failure)((0,a.unavailable)([i.reason])):i}getMergeCell(e){const t=this.allEditedAvailable(e);if(t.kind===L.ResultKind.Failure)return(0,L.failure)((0,a.unavailable)([t.reason]));if(!0!==t.value)return(0,L.failure)((0,a.unavailable)([{kind:d.UnavailableKind.GridRange,unavailableCells:t.value,range:e}]));const r=this.getDocument(e.sheet.document);if(r.kind===L.ResultKind.Failure)return(0,L.failure)((0,a.unavailable)([r.reason]));const n=r.value.getMergeCell(e);return n.kind===L.ResultKind.Failure?(0,L.failure)((0,a.unavailable)([n.reason])):n}isInFilterMode(e){const t=this.getDocument(e.document);if(t.kind===L.ResultKind.Failure)return(0,L.failure)((0,a.unavailable)([t.reason]));const r=t.value.isInFilterMode(e.index);return r.kind===L.ResultKind.Failure?(0,L.failure)((0,a.unavailable)([r.reason])):r}getRandom(){return(0,k.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: getRandom",this.evalParams.volatileMode===R.VolatileMode.GroundTruth),(0,L.success)(this.config.mathpack.fromNumber(this.random.next()))}getTime(e,t){return(0,R.getTimeImpl)(this.config,e,t,this.evalParams.volatileMode)}withEvalParams(e,t){const r=this.evalParams;this.evalParams=e;try{const r=t();return Array.isArray(r)?r:r.kind===L.ResultKind.Paused?(0,h.paused)((()=>this.withEvalParams(e,r.resume))):(0,h.breaked)((()=>this.withEvalParams(e,r.resume)))}finally{this.evalParams=r}}withEvalParamsEvalFormula(e,t){const r=this.evalParams;this.evalParams=e;try{const r=t();return r.kind===L.ResultKind.Paused?(0,h.paused)((()=>this.withEvalParamsEvalFormula(e,r.resume))):r.kind===L.ResultKind.Breaked?(0,h.breaked)((()=>this.withEvalParamsEvalFormula(e,r.resume))):r}finally{this.evalParams=r}}evaluate(e,t,r,n){return this.withEvalParams({computeKind:e,computeCells:t,volatileMode:r,onRangeFailure:n},(()=>this.evaluator.evalCells({},t)))}evalFormula(e,t,r,n){const o={lexicalKind:i.LexicalKind.Other,originGridCell:(0,L.success)(t.range),originSheet:(0,L.success)(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:!1,emitStepInfo:!1,contextNames:void 0},a={lexicalSource:{kind:i.LexicalKind.Other},originGridCell:(0,L.success)(t.range),originSheet:(0,L.success)(t.sheet),calcingArray:!1,reflectionGridCell:(0,L.success)(t.range),reflectionSheet:(0,L.success)(t.sheet),implicitIntersect:!1,allowUnqualifiedCell:!0,wrapCellReferences:!1,followHyperlinks:(0,L.success)(!1),contextNames:void 0},s=(e,n)=>{if(n.kind===L.ResultKind.Paused)return(0,h.paused)((()=>s(e,n.resume())));if(n.kind===L.ResultKind.Breaked)return(0,h.breaked)((()=>s(e,n.resume())));if(!(0,L.isSuccess)(n))return(0,L.success)({value:n});const i=this.evalFormulaFormat(t,e,n.value,r);return(0,L.success)({value:(0,L.success)(n.value),formatted:i})};return this.withEvalParamsEvalFormula({computeKind:m.ComputeKind.EvalFormula,computeCells:[t],volatileMode:n},(()=>{const t=this.parser.parseFormula(o,e),r=this.checkFormula(o,t,e,m.FormulaMode.EvalFormula),n=this.compileFormula(o,r);return(0,L.isSuccess)(n)?s(n.value,this.evaluator.evalFormula(a,n.value)):(0,L.success)({value:n})}))}evalFormulaFormat(e,t,r,n){var i;if(void 0===n)return;if("number"==typeof n)return this.formatValueIformat(e.sheet.document,n,r);if(n.kind===m.SpecialFormat.Known)return this.formatValueKnownFormat(e.sheet.document,n.knownFormat,r);let o=r;if(this.renderBlanksAsZerosEnabled&&(0,a.isBlankOper)(r)&&(n.kind===m.SpecialFormat.Origin||n.kind===m.SpecialFormat.Inferred||n.kind===m.SpecialFormat.Edit)&&null!==(i=n.renderBlanksAsZeros)&&void 0!==i&&i&&(o=this.config.mathpack.zero),n.kind===m.SpecialFormat.Origin||n.kind===m.SpecialFormat.Aggregate){const t=this.ensureCellExists(e);return(0,T.isNone)(t)||!(0,L.isSuccess)(t)?t:n.kind===m.SpecialFormat.Origin?this.formatValueCell(e,o):this.formatValueAggregate(e,o)}return n.kind===m.SpecialFormat.Inferred?this.applyInferredFormat(e,t,o):n.kind===m.SpecialFormat.Edit?this.applyEditFormat(e,t,o,n.isWholeFormula):(0,k.assertNever)("calc.calc.PartialWorkbookDocumentCollection.evalFormulaFormat",n)}evalValue(e,t,r){var n;const i=this.evalParams;this.evalParams={computeKind:t,computeCells:[e],volatileMode:r};try{const t=this.getEditedFormula(e);if(!(0,L.isSuccess)(t))return this.cb.onUnavailableObject(t.reason);if(void 0!==(null===(n=t.value)||void 0===n?void 0:n[1].compiledFmla))return;const r=this.hasRecalcDirty(e);if(!(0,L.isSuccess)(r))return this.cb.onUnavailableObject(r.reason);if(r.value)return;const i=this.tryGetCellValue(e.range,e.sheet);if(void 0===i)return;(0,k.assertTrue)("calc.calc.PartialWorkbookDocumentCollection.evalValue",i.kind===h.CellKind.FinalValue),this.cb.onReturnCellValue(e,i.oper,m.ComputedCellKind.EditedCell)}finally{this.evalParams=i}}advanceVersion(){return this.version++,this.version}setUserDefinedFuncOverrides(e){this.userDefinedFuncOverrides=e,this.advanceVersion()}setWorksheetFuncOverrides(e){this.worksheetFuncOverrides=e,this.advanceVersion()}setSheetNames(e,t){const r=this.ensureDocument(e);return r.kind===L.ResultKind.Failure?r:(this.document=r.value.setSheetNames(t),(0,L.success)(void 0))}advanceState(e){void 0!==this.document&&this.document.advanceState(e,this.advanceVersion())}onCellModified(e){if(void 0!==this.document)return this.document.onCellModified(e,this.advanceVersion())}getServerDocument(){return this.documentLoc}allServerAvailable(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.allServerAvailable(e)}forEachEditedNonBlankCellInSet({index:e,document:t},r,n){const i=this.getDocument(t);return i.kind===L.ResultKind.Failure?i:i.value.forEachEditedNonBlankCellInSet(e,r,n)}forEachServerNonBlankCellInSet({index:e,document:t},r,n){const i=this.getDocument(t);return i.kind===L.ResultKind.Failure?i:i.value.forEachServerNonBlankCellInSet(e,r,n)}forEachEditedCellInSet({index:e,document:t},r,n){const i=this.getDocument(t);return i.kind===L.ResultKind.Failure?i:i.value.forEachEditedCellInSet(e,r,n)}clearCompiledFormulas(){if(void 0!==this.document)return this.document.clearCompiledFormulas()}clearCompiledNumberFormats(){if(void 0!==this.document)return this.document.clearCompiledNumberFormats()}getGridStatistics(){return void 0!==this.document?this.document.getGridStatistics():l.emptyGridStatistics}getNameStatistics(){return void 0!==this.document?this.document.getNameStatistics():B.emptyNameStatistics}collectGarbage(e){if(void 0!==this.document)return this.document.collectGarbage(e,this.advanceVersion())}getEditedFormula(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getEditedFormula(e)}forEachEditedFormula(e,t){const r=this.getDocument(e.sheet.document);return r.kind===L.ResultKind.Failure?r:r.value.forEachEditedFormula(e,t)}getEditedValue(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getEditedValue(e)}forEachEditedValue(e,t){const r=this.getDocument(e.sheet.document);return r.kind===L.ResultKind.Failure?r:r.value.forEachEditedValue(e,t)}getEditedFormat(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getEditedFormat(e)}forEachEditedFormat(e,t){const r=this.getDocument(e.sheet.document);return r.kind===L.ResultKind.Failure?r:r.value.forEachEditedFormat(e,t)}getEditedStyle(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getEditedStyle(e)}getServerFormat(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getServerFormat(e)}getServerStyle(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getServerStyle(e)}getClientFormat(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getClientFormat(e)}getClientValue(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getClientValue(e)}getRecalcValues(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getRecalcValues(e)}forEachRecalcValue(e,t){const r=this.getDocument(e.sheet.document);return r.kind===L.ResultKind.Failure?r:r.value.forEachRecalcValue(e,t)}getServerValue(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getServerValue(e)}getServerFormula(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getServerFormula(e)}getClientFormula(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.getClientFormula(e)}getServerUsedRange(e){const t=this.getDocument(e.document);if(t.kind===L.ResultKind.Failure)return t;const r=t.value.getServerUsedRange(e.index);return r.kind===L.ResultKind.Failure||void 0===r.value?r:(0,L.success)((0,i.sheetGridRange)(e,r.value))}getServerAvailableCells(){const e=[];return this.forEachDocument((t=>{(0,T.safePush)(e,t.getServerAvailableCells())})),e}promoteServerAvailability({sheet:e,set:t},r){const n=this.getDocument(e.document);return n.kind===L.ResultKind.Failure?n:n.value.promoteServerAvailability(e.index,t,r)}extendServerUnused(e,t){const r=this.getDocument(e.document);return r.kind===L.ResultKind.Failure?r:r.value.extendServerUnused(e.index,t,this.advanceVersion())}setCellContents(e,t,r,n,o,a,s,u,c,d){const m=this.getDocument(t.sheet.document);if(m.kind===L.ResultKind.Failure)return m;const g=void 0===r?void 0:n?this.compileFmla(e,i.LexicalKind.Cell,(0,i.sheetGridCell)(t.sheet,o),void 0,r):""===r?l.blankCellGridFormula:{fmla:r,lexicalKind:i.LexicalKind.Cell,origin:o,compiledFmla:void 0,hasHyperlink:l.SpecialBoolean.ClientValueUnknown};return m.value.setCellContents(e,t,g,a,s,u,c,d,this.advanceVersion())}setRangeFormula(e,t,r,n,o,s,u,c){const d=this.getDocument(t.sheet.document);if(d.kind===L.ResultKind.Failure)return d;const m=""===r?l.blankRangeGridFormula:this.compileFmla(e,i.LexicalKind.Range,(0,i.sheetGridCell)(t.sheet,n),(0,a.gridRangeAnchor)(t.range),r);return d.value.setRangeFormula(e,t,m,o,s,u,c,this.advanceVersion())}copyRange(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.copyRange(e)}pasteRange(e,t){const r=this.getDocument(e.sheet.document);return r.kind===L.ResultKind.Failure?r:r.value.pasteRange(e,t,this.advanceVersion())}assumeRecalcFinal(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.assumeRecalcFinal(e,this.advanceVersion())}getDirtyEditedCells(){return this.document?this.document.getDirtyEditedCells():[]}getNonDirtyEditedCells(){return this.document?this.document.getNonDirtyEditedCells():[]}getDirtyDependentCells(){return this.document?this.document.getDirtyDependentCells():[]}setNamedObject(e,t,r){const n=this.getDocument(t.scope.document);return n.kind===L.ResultKind.Failure?(0,L.failure)((0,a.unavailable)([n.reason])):n.value.setNamedObject(e,t,r,this.compileNamedObject)}setUndefinedNames(e){const t=this.getDocument(e.document);return t.kind===L.ResultKind.Failure?(0,L.failure)((0,a.unavailable)([t.reason])):t.value.setUndefinedNames(e)}promoteNamedObjects(e,t){const r=this.getDocument(e.document);return r.kind===L.ResultKind.Failure?(0,L.failure)((0,a.unavailable)([r.reason])):r.value.promoteNamedObjects(e,t)}setNumberFormats(e,t,r){const n=this.ensureDocument(e);if(n.kind===L.ResultKind.Failure)return(0,L.failure)((0,a.unavailable)([n.reason]));const i=[];return t.forEach((({iformat:e,formatString:t,builtIn:r})=>{const n=this.compileNumberFormat(t,r);i[e]={formatString:t,builtIn:r,compiledFormat:n}})),(0,L.success)(n.value.setNumberFormats(i,r))}setStyles(e,t,r){const n=this.ensureDocument(e);return n.kind===L.ResultKind.Failure?n:(0,L.success)(n.value.setStyles(t,r))}setFonts(e,t,r){const n=this.ensureDocument(e);return n.kind===L.ResultKind.Failure?n:(0,L.success)(n.value.setFonts(t,r))}setFills(e,t,r){const n=this.ensureDocument(e);return n.kind===L.ResultKind.Failure?n:(0,L.success)(n.value.setFills(t,r))}setBorders(e,t,r){const n=this.ensureDocument(e);return n.kind===L.ResultKind.Failure?n:(0,L.success)(n.value.setBorders(t,r))}writeHiddenRows(e,t,r){const n=this.getDocument(e.document);return n.kind===L.ResultKind.Failure?n:n.value.setHiddenRows(e.index,t,r)}writeHiddenCols(e,t,r){const n=this.getDocument(e.document);return n.kind===L.ResultKind.Failure?n:n.value.setHiddenCols(e.index,t,r)}writeMergeCell(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.setMergeCell(e)}writeInFilterMode(e,t){const r=this.getDocument(e.document);return r.kind===L.ResultKind.Failure?r:r.value.setInFilterMode(e.index,t)}resolveCellFormat(e,t){if("number"!=typeof t)return(0,L.success)(t);const r=this.getDocument(e);if(!(0,L.isSuccess)(r))return(0,L.failure)((0,a.unavailable)([r.reason]));const n=r.value.getIformat(t);return(0,L.isSuccess)(n)?n.value.getValue():(0,L.failure)((0,a.unavailable)([n.reason]))}resolveCellStyle(e,t){const r=this.getDocument(e);if(!(0,L.isSuccess)(r))return(0,L.failure)((0,a.unavailable)([r.reason]));const n=r.value.resolveCellStyle(t);return(0,L.isSuccess)(n)?(0,L.success)(n.value):(0,L.failure)((0,a.unavailable)([n.reason]))}resolveValueFormat(e,t){var r;if("string"==typeof t)return this.resolveStringFormat(e,t);const n=this.getKnownFormat(e,t);if(!(0,L.isSuccess)(n))return n;const i=this.getFormatString(e,n.value.formatString);return(0,L.isSuccess)(i)?(0,L.success)(null!==(r=i.value)&&void 0!==r?r:n.value):i}resolveStringFormat(e,t){const r=this.getFormatString(e,t);return(0,L.isSuccess)(r)?void 0!==r.value?(0,L.success)(r.value):this.formatter.createFormat(t,!1):r}resolveObjectFormat(e,t){const r=this.getFormatString(e,t.formatString);return(0,L.isSuccess)(r)?void 0!==r.value?(0,L.success)(r.value):(0,L.success)(t):r}resolveEditFormat(e,t){return"number"==typeof t?(0,L.success)(t):this.resolveStringFormat(e,t)}resolveRibbonFormat(e,t,r){let n;switch(t){case H.RibbonFormat.GalleryShortDate:case H.RibbonFormat.GalleryLongDate:{const e=this.getCellFormat(r);if(!(0,L.isSuccess)(e))return e;const t=this.resolveCellFormat(r.sheet.document,e.value);if(!(0,L.isSuccess)(t))return t;n=t.value;break}}const i=(0,H.getRibbonFormat)(this.config.localeInfo,t,n);return this.resolveStringFormat(e,i)}resolveChangeDecimals(e,t,r){const n=this.getCellFormat(r);if(!(0,L.isSuccess)(n))return n;const i=this.resolveCellFormat(r.sheet.document,n.value);if(!(0,L.isSuccess)(i))return i;const o=this.formatter.changeFormatDecimals(i.value,t);return(0,L.isSuccess)(o)?void 0===o.value?L.successUndefined:this.resolveObjectFormat(e,o.value):o}parseInferredEdit(e,t,r){const n=this.getCellFormat(e);if(!(0,L.isSuccess)(n))return n;const i=this.resolveCellFormat(e.sheet.document,n.value);if(!(0,L.isSuccess)(i))return i;const o=this.evalParams;this.evalParams={computeKind:m.ComputeKind.ParseEdit,computeCells:[e],volatileMode:r};try{return this.formatter.parseEdit(t,i.value)}finally{this.evalParams=o}}inferFormulaFormat(e){const t=this.getEditedFormula(e);if(!(0,L.isSuccess)(t))return(0,L.success)(void this.cb.onUnavailableObject(t.reason));if(void 0===t.value||void 0===t.value[1].compiledFmla)return(0,L.success)(void this.cb.onUnavailableObject({kind:d.UnavailableKind.CellEvaluatingValue}));const r=t.value[1].compiledFmla.getValue();if(!(0,L.isSuccess)(r))return r;const n=(0,i.lexicalSourceGrid)(t.value[1].lexicalKind,(0,i.sheetGridRange)(e.sheet,t.value[0])),o=r.value;return this.formatter.evalFormat((0,_.evalFormatLocalsGrid)(n),o)}fillInferredFormat(e,t){let r=t,n=t===m.SpecialFormat.Unavailable?(0,L.success)(m.SpecialFormat.Unavailable):this.resolveCellFormat(e.sheet.document,t);if(!(0,L.isSuccess)(n)){const t=n.reason;(0,c.forEachRangeInSet)(e.set,(r=>{const n=(0,i.sheetGridRange)(e.sheet,r);return this.cb.onInferFormatFailure(n,t),!0})),n=(0,L.success)(m.SpecialFormat.Unavailable),r=m.SpecialFormat.Unavailable}const o=n.value;(0,c.forEachCellInSet)(e.set,(t=>{const n=(0,i.sheetGridCell)(e.sheet,t),a=this.getEditedFormat(n);if(!(0,L.isSuccess)(a))return this.cb.onUnavailableObject(a.reason),!0;if(a.value===m.SpecialFormat.Unavailable)return!0;const s=this.resolveCellFormat(e.sheet.document,a.value);if(!(0,L.isSuccess)(s))return this.cb.onInferFormatFailure(n,s.reason),!0;if((0,D.shouldInstallFormat)(o===m.SpecialFormat.Unavailable?void 0:o,s.value)){const e=this.setEditedFormat(n,r);(0,L.isSuccess)(e)||this.cb.onUnavailableObject(e.reason)}return!0}))}anonymizeFormula(e,t){var r;const n=null===(r=t.compiledFmla)||void 0===r?void 0:r.getValue();return void 0!==n&&(0,L.isSuccess)(n)?[(0,A.anonymizeFormula)(this.config,n.value,e),Y(n.value)]:[(0,I.anonymizeFormulaString)(t.fmla),[]]}compileFmla(e,t,r,n,i){return{fmla:i,lexicalKind:t,origin:null!=n?n:r.range,compiledFmla:new R.ResettableLazy((()=>{const o=this.parser.parseFormula((0,f.parseLocals)(t,r.range),i),a=e?o:this.autocorrectFormula((0,p.analyzeLocalsGrid)(t,r),o),s=e&&this.isServerWorkbookLoad,l=this.checkFormula((0,p.analyzeLocalsGrid)(t,r,void 0,s),a,i,e?m.FormulaMode.ServerCellFormula:m.FormulaMode.EditCellFormula),u=this.adjustFormulaOrigin(l,r,n);return this.compileFormula((0,h.compileLocalsGrid)(t,r.range),u)})),hasHyperlink:l.SpecialBoolean.ClientValueUnknown}}compileFormula(e,t){return(0,L.isSuccess)(t)?this.compiler.compileFormula(e,t.value):t}checkFormula(e,t,r,n){if(!(0,L.isSuccess)(t))return t;const i=this.analyzer.checkFormulaWithDiagnostics(e,t.value);if(!(0,L.isSuccess)(i))return i;if(!(0,a.isWellFormed)(i.value[0])){const e="calc.PartialWorkbook.checkFormula: expected well-formed formula; given "+(0,I.anonymizeFormulaString)(r);return(0,L.failure)((0,h.illFormedFormula)(e,n,(0,p.summarizeFormulaDiagnostics)(i.value[1])))}return(0,L.success)(i.value[0])}autocorrectFormula(e,t){return(0,L.isSuccess)(t)?this.analyzer.autocorrectFormula(e,t.value):t}adjustFormulaOrigin(e,t,r){if(!(0,L.isSuccess)(e)||void 0===r)return e;const n=(0,x.resolveLocalsGrid)(t);return(0,O.adjustFormulaOrigin)(this,n,r,e.value)}compileNumberFormat(e,t){return new R.ResettableLazy((()=>{const r=this.formatter.createFormat(e,t);return(0,L.isSuccess)(r)||this.cb.onNumberFormatFailure(r.reason),r}))}compileKnownFormats(){return(0,T.numEnumMap)(U.KnownFormat,(e=>this.compileNumberFormat((0,W.getKnownFormat)(this.config.localeInfo,e),!1)))}printFormulaBarText(e,t,r){return this.printer.printFormula((0,N.printLocalsGrid)(e,(0,i.sheetGridCell)(e.range.sheet,t)),r)}renderValueBarText(e,t,r){const n=this.getEditedResolvedFormat(e);return(0,L.isSuccess)(n)?this.formatter.renderFormulaBar(e.sheet.document,t,n.value,(0,V.stringStartsWith)(r,"'")):n}formatValueCell(e,t){if((0,a.isBlankOper)(t))return(0,L.success)((0,_.formattedValue)([],void 0,_.Alignment.Left,_.Clip.All));const r=this.getEditedResolvedFormat(e);return(0,L.isSuccess)(r)?this.formatter.applyFormat(r.value,t,!0):r}formatValueAggregate(e,t){if(!(0,o.isNumberOper)(t))return(0,L.success)((0,_.hashesValue)(_.aggregationError,void 0));let r;if((0,o.isNumberOper)(t)&&0===this.config.mathpack.cond(t))r=this.getKnownFormat(e.sheet.document,U.KnownFormat.General);else{if(r=this.getEditedResolvedFormat(e),!(0,L.isSuccess)(r))return r;const{valueType:t}=r.value;t===_.FormatValueType.Text?r=this.getKnownFormat(e.sheet.document,U.KnownFormat.General):t===_.FormatValueType.Time&&(r=this.getKnownFormat(e.sheet.document,U.KnownFormat.AbsHMMSS))}return(0,L.isSuccess)(r)?this.formatter.applyFormat(r.value,t,!0):r}formatValueIformat(e,t,r){const n=this.getIformat(e,t);return(0,L.isSuccess)(n)?this.formatter.applyFormat(n.value,r,!0):n}formatValueKnownFormat(e,t,r){const n=this.getKnownFormat(e,t);return(0,L.isSuccess)(n)?this.formatter.applyFormat(n.value,r,!0):n}getEditedResolvedFormat(e){const t=this.getEditedFormat(e);return(0,L.isSuccess)(t)?t.value===m.SpecialFormat.Unavailable?(0,L.failure)((0,a.unavailable)([{kind:d.UnavailableKind.CellFormat}])):this.resolveCellFormat(e.sheet.document,t.value):(0,L.failure)((0,a.unavailable)([t.reason]))}getDocument(e){return void 0!==this.documentLoc&&void 0!==this.document&&(0,a.isDocumentLocEqual)(this.documentLoc,e)?(0,L.success)(this.document):(0,L.failure)({kind:d.UnavailableKind.DocumentLoc,document:e})}ensureDocument(e){return void 0===this.documentLoc&&void 0===this.document&&(this.documentLoc=e,this.document=new n.PartialWorkbookDocument(e,this.config.localeInfo.stringCompareCI,new G.PartialWorkbookFormats(this.compileKnownFormats()),new q.PartialWorkbookStyles)),this.getDocument(e)}tryGetCellValues(e,t){const r=(0,i.sheetGridRange)(t,e),{row:n,col:o,rows:s,cols:l}=e,u=this.getRecalcValues(r);if(u.kind===L.ResultKind.Failure)return void this.cb.onUnavailableObject(u.reason);let c=!1;for(let e=0;e<s;e+=1){const r=u.value[e];for(let a=0;a<l;a+=1){const{failure:s}=r[a];void 0!==s&&(this.setCellFailure((0,i.sheetGridCell)(t,(0,i.gridCell)(n+e,o+a)),s,J),c=!0)}}if(c)return;const m=e=>(0,h.finalValue)(e.oper),g=u.value.map((e=>e.map(m))),p=this.forEachRecalcDirty(r,(e=>{const r=(0,i.sheetGridCell)(t,e),s=this.getEditedFormula(r);if(s.kind===L.ResultKind.Failure)return this.cb.onUnavailableObject(s.reason),!1;if(void 0===s.value)return this.setCellFailure(r,(0,a.unavailable)([{kind:d.UnavailableKind.CellMissingFormula}]),J),c=!0,!0;const[l,u]=s.value;if(void 0===u.compiledFmla)return this.cb.onUnavailableObject({kind:d.UnavailableKind.CellEvaluatingValue}),!1;const m=this.readCompiledFmla((0,i.sheetGridRange)(t,l),u.compiledFmla);return(0,L.isSuccess)(m)?(g[e.row-n][e.col-o]=(0,h.pendingValue)((0,i.sheetGridCell)(t,(0,a.gridRangeAnchor)(l))),!0):(c=!0,!0)}));if((0,L.isSuccess)(p)){if(p.value&&!c)return g}else this.cb.onUnavailableObject(p.reason)}tryGetCellValue(e,t){const r=this.tryGetCellValues(e,t);return void 0===r?void 0:r[0][0]}makeGetCellValues(e){return t=>{const r=this.allEditedAvailable(t);if(r.kind===L.ResultKind.Failure)return(0,L.failure)((0,a.unavailable)([r.reason]));if(!0!==r.value)return(0,L.failure)((0,a.unavailable)([{kind:d.UnavailableKind.GridRange,range:t,unavailableCells:r.value}]));const n=this.hasRecalcFailure(t);if(n.kind===L.ResultKind.Failure)return(0,L.failure)((0,a.unavailable)([n.reason]));if(n.value)return(0,L.failure)((0,h.previousFailure)(t));if((0,a.gridRangeSize)(t.range)>this.maxDereferenceCells)return(0,L.failure)((0,a.unavailable)([{kind:d.UnavailableKind.GridRangeSize,range:t}]));const i=e(t.range,t.sheet);return void 0===i?(0,L.failure)((0,h.previousFailure)(t)):(0,L.success)(i)}}readCompiledFmla(e,t){const r=t.getValue();return(0,L.isSuccess)(r)?r:(this.setCellFailure(e,r.reason,J),r.reason.kind===h.ReasonKind.Unavailable?(r.reason,r):(0,L.failure)((0,a.unavailable)([{kind:d.UnavailableKind.CellFormula,reason:r.reason}])))}getEditedUsedRange(e){const t=this.getDocument(e.document);if(t.kind===L.ResultKind.Failure)return t;const r=t.value.getEditedUsedRange(e.index);return r.kind===L.ResultKind.Failure||void 0===r.value?r:(0,L.success)((0,i.sheetGridRange)(e,r.value))}getSheetRangeIds(e){const t=this.getDocument(e.document);return t.kind===L.ResultKind.Failure?(0,L.failure)((0,a.unavailable)([t.reason])):t.value.getSheetRangeIds(e)}allEditedAvailable(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.allEditedAvailable(e)}forEachRecalcDirty(e,t){const r=this.getDocument(e.sheet.document);return r.kind===L.ResultKind.Failure?r:r.value.forEachRecalcDirty(e,t)}hasRecalcDirty(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.hasRecalcDirty(e)}hasRecalcFailure(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.hasRecalcFailure(e)}hasEditedEditTaint(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.hasEditedEditTaint(e)}hasRecalcEditTaint(e){const t=this.getDocument(e.sheet.document);return t.kind===L.ResultKind.Failure?t:t.value.hasRecalcEditTaint(e)}setEditedFormat(e,t){const r=this.getDocument(e.sheet.document);return r.kind===L.ResultKind.Failure?r:r.value.setEditedFormat(e,t)}setClientFormat(e,t){const r=this.getDocument(e.sheet.document);return r.kind===L.ResultKind.Failure?r:r.value.setClientFormat(e,t,this.advanceVersion())}setRecalcFailure(e,t){const r=this.getDocument(e.document);return r.kind===L.ResultKind.Failure?r:r.value.setRecalcFailure(e.index,t)}testAndSetClientValue(e,t){const r=this.getClientValue(e);if(r.kind===L.ResultKind.Failure)return r;const n=(0,l.isClientValueUnknownOper)(r.value.oper)||!(0,a.isReadOperEqual)(this.config.mathpack,r.value.oper,t,!0);if(n){const r=this.setClientValue(e,t);if(r.kind===L.ResultKind.Failure)return r}return(0,L.success)(n)}testAndSetClientFormat(e,t){const r=this.getClientFormat(e);if(r.kind===L.ResultKind.Failure)return r;const n=t!==r.value;if(n){const r=this.setClientFormat(e,t);if(r.kind===L.ResultKind.Failure)return r}return(0,L.success)(n)}testAndSetClientFormula(e,t,r){var n;const o=this.getClientFormula((0,a.sheetGridRangeAnchor)(e));if(o.kind===L.ResultKind.Failure)return o;const[s,u]=null!==(n=o.value)&&void 0!==n?n:[e.range,l.blankClientGridFormula],c=(0,a.gridRangeAnchor)(e.range),d=void 0!==t&&t!==u.fmla||void 0!==u.compiledFmla&&!(0,a.isGridCellEqual)(c,u.origin),m=void 0!==r&&r!==u.hasHyperlink;if(d||m){const{compiledFmla:n}=u,o=this.setClientFormula((0,i.sheetGridRange)(e.sheet,s),{fmla:null!=t?t:u.fmla,compiledFmla:n,origin:void 0!==t?c:u.origin,hasHyperlink:null!=r?r:u.hasHyperlink});if(o.kind===L.ResultKind.Failure)return o}return(0,L.success)({hasFmlaChanged:d,hasHyperlinkChanged:m})}setRecalcEditTaint(e,t){const r=this.getDocument(e.document);return r.kind===L.ResultKind.Failure?r:r.value.setRecalcEditTaint(e.index,t)}propagateEditTaint(e,t){const r=this.hasEditedEditTaint(e);if(r.kind===L.ResultKind.Failure)return r;if(r.value)return(0,L.success)(m.ComputedCellKind.EditedCell);for(const r of t.cells){const t=this.hasRecalcEditTaint(r);if(t.kind===L.ResultKind.Failure)return t;if(t.value){const t=this.setRecalcEditTaint(e.sheet,(0,c.createCellSetFromRange)(e.range));return t.kind===L.ResultKind.Failure?t:(0,L.success)(m.ComputedCellKind.DependentCell)}}if(0!=(t.special&(w.SpecialPrecs.Calc|w.SpecialPrecs.Time))){const t=this.setRecalcEditTaint(e.sheet,(0,c.createCellSetFromRange)(e.range));return t.kind===L.ResultKind.Failure?t:(0,L.success)(m.ComputedCellKind.DependentCell)}return t.bound===u.PrecsBound.Exact||void 0!==this.evalParams&&this.evalParams.computeKind===m.ComputeKind.EditedCell?(0,L.success)(m.ComputedCellKind.IndependentCell):(0,L.success)(m.ComputedCellKind.UnknownNonEditedCell)}setClientValue(e,t){const r=this.getDocument(e.sheet.document);return r.kind===L.ResultKind.Failure?r:r.value.setClientValue(e,t,this.advanceVersion())}setRecalcValue(e,t){const r=this.getDocument(e.sheet.document);return r.kind===L.ResultKind.Failure?r:r.value.setRecalcValue(e,t)}setClientFormula(e,t){const r=this.getDocument(e.sheet.document);return r.kind===L.ResultKind.Failure?r:r.value.setClientFormula(e,t,this.advanceVersion())}hasRecalcNameFailure(e){const t=this.getDocument(e.scope.document);return t.kind===L.ResultKind.Failure?(0,L.failure)((0,a.unavailable)([t.reason])):t.value.hasRecalcNameFailure(e)}setRecalcNameFailure(e){const t=this.getDocument(e.scope.document);return t.kind===L.ResultKind.Failure?(0,L.failure)((0,a.unavailable)([t.reason])):t.value.setRecalcNameFailure(e)}setNameFailure(e,t){const r=this.setRecalcNameFailure(e);if(r.kind===L.ResultKind.Failure)return this.cb.onUnavailable(r.reason);this.cb.onNameFailure(e,t,this.evalParams)}applyInferredFormat(e,t,r){const n=this.getInferredFormat(e,t);return(0,L.isSuccess)(n)?void 0===n.value?this.formatValueKnownFormat(e.sheet.document,U.KnownFormat.General,r):"number"==typeof n.value?this.formatValueIformat(e.sheet.document,n.value,r):this.formatter.applyFormat(n.value,r,!0):n}applyEditFormat(e,t,r,n){if(t.node.kind===F.NodeKind.CellRef&&!n)return this.applyInferredFormat(e,t,r);const i=this.ensureCellExists(e);if((0,T.isNone)(i)||!(0,L.isSuccess)(i))return i;const o=this.getEditedResolvedFormat(e);if(!(0,L.isSuccess)(o))return o;const a=this.getInferredFormat(e,t);if(!(0,L.isSuccess)(a))return a;let s;if(void 0===a.value)s=void 0;else if("number"==typeof a.value){const t=this.getIformat(e.sheet.document,a.value);if(!(0,L.isSuccess)(t))return t;s=t.value}else s=a.value;const l=(0,W.getKnownFormat)(this.config.localeInfo,U.KnownFormat.General)===o.value.formatString;return(n||l)&&(0,T.isDefined)(s)&&(0,D.shouldInstallFormat)(s,o.value)?this.formatter.applyFormat(s,r,!0):this.formatter.applyFormat(o.value,r,!0)}getInferredFormat(e,t){const r={lexicalSource:{kind:i.LexicalKind.Other},originGridCell:(0,L.success)(e.range),originSheet:(0,L.success)(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1};return this.formatter.evalFormat(r,t)}ensureCellExists(e){const t=this.allEditedAvailable(e);if((0,L.isSuccess)(t))return!0!==t.value?(0,L.failure)((0,a.unavailable)([{kind:d.UnavailableKind.GridRange,unavailableCells:t.value,range:e}])):(0,L.success)(!0);this.cb.onUnavailableObject(t.reason)}constructor(e,t,r,n,o,s){this.cb=t,this.schedulerConfig=r,this.limits=n,this.maxDereferenceCells=o,this.isServerWorkbookLoad=s,this.renderBlanksAsZerosEnabled=(0,z.isChangeGateEnabled)("OfficeVSO:7042222_renderBlanksAsZeros"),this.random=new K.JSF32(4294967296*Math.random()),this.worksheetFuncOverrides={},this.userDefinedFuncOverrides={},this.version=0,this.interruptToken=[h.Interrupt.Continue],this.getCellValue=this.makeGetCellValues(this.tryGetCellValue.bind(this)),this.getCellValues=this.makeGetCellValues(this.tryGetCellValues.bind(this)),this.compileNamedObject=(e,t,r)=>{const n=e?m.FormulaMode.ServerNamedFormula:m.FormulaMode.EditNamedFormula;switch(r.kind){case"NamedFormula":{const t=r.fmla,o=this.parser.parseFormula((0,f.parseLocals)(i.LexicalKind.NameManager,$),t);(0,k.assertTrue)("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: isServerUpdate",e);const a=e&&this.isServerWorkbookLoad,s=(0,p.analyzeLocalsName)((0,i.originCell)((0,i.documentScope)(this.documentLoc),$),void 0,a),l=o,u=this.checkFormula(s,l,t,n);return this.compileFormula((0,h.compileLocalsName)($),u)}case"NamedValue":case"NamedRange":case"NamedTable":{let e,n;if("NamedRange"===r.kind){const o=r.value;(0,k.assertTrue)("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: bad range",(0,a.isDocumentLocEqual)(r.value.sheets.document,t.scope.document));const s=o.sheets,l=this.getDocument(s.document);if(!(0,L.isSuccess)(l))return this.cb.onUnavailableObject(l.reason),(0,L.failure)((0,a.unavailable)([l.reason]));const u=l.value.getSheetName(s.index);if(!(0,L.isSuccess)(u))return this.cb.onUnavailable(u.reason),u;const c=r.value.ranges[0];e=(0,C.formula)((0,C.cellRefNode)((0,C.cellRefRange)((0,C.cellRefSingle)((0,C.pos)(C.PosKind.Abs,c.row),(0,C.pos)(C.PosKind.Abs,c.col)),(0,C.cellRefSingle)((0,C.pos)(C.PosKind.Abs,c.row+c.rows-1),(0,C.pos)(C.PosKind.Abs,c.col+c.cols-1))),(0,C.sheetQualifier)(u.value)),[],[],1),n=(0,i.sheetGridCell)(s,$)}else"NamedTable"===r.kind?(e=(0,C.formula)((0,C.structRefNode)((0,C.nameNode)((0,y.identNamePart)(t.name)),(0,C.structRef)(void 0)),[],[],1),n=(0,i.originCell)((0,i.documentScope)(this.documentLoc),$)):(e=(0,C.formula)((0,C.literalNode)(r.value,!0),[],[],1),n=(0,i.originCell)((0,i.documentScope)(this.documentLoc),$));const o=this.analyzer.checkFormula((0,p.analyzeLocalsName)(n),e);return(0,L.isSuccess)(o)&&(0,a.isWellFormed)(o.value)?this.compileFormula((0,h.compileLocalsName)($),(0,L.success)(o.value)):(0,k.assertFalse)(`calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: constructed ill-formed formula ${(0,A.anonymizeFormula)(this.config,e,(0,i.lexicalSourceName)(t))}`)}case"NamedFailure":return(0,L.failure)((0,a.unavailable)([{kind:d.UnavailableKind.ClientFailure,reason:r.failureReason}]));default:return(0,k.assertNever)("calc.calc.partialWorkbookDocumentCollection.compileNamedFmla",r)}},this.config=e,this.parser=(0,S.createParser)(this),this.printer=(0,A.createPrinter)(this),this.analyzer=(0,g.createAnalyzer)(this),this.formatter=(0,M.createNumberFormatter)(this),this.compiler=(0,v.createCompiler)(this),this.evaluator=(0,P.createEvaluator)(this)}}t.PartialWorkbookDocumentCollection=X},91480:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFailureOutputMessage=void 0;const n=r(88928),i=[n.OutputMessageKind.RangeFailure,n.OutputMessageKind.NameFailure,n.OutputMessageKind.NumberFormatFailure,n.OutputMessageKind.PrintFormulaFailure,n.OutputMessageKind.InferFormatFailure,n.OutputMessageKind.FormatValueFailure,n.OutputMessageKind.UnhandledFailure];t.isFailureOutputMessage=function(e){return i.includes(e.kind)}},23430:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookFormats=void 0;const n=r(12450),i=r(33436),o=r(88928);class a{clone(){const e=new a(this.knownFormats);return Object.keys(this.iformats).map(Number).forEach((t=>{e.iformats[t]=this.iformats[t]})),Object.keys(this.formatStrings).forEach((t=>{e.formatStrings[t]=this.formatStrings[t]})),e}clearCompiledNumberFormats(){this.iformats.forEach((e=>{e.compiledFormat.reset()})),Object.keys(this.knownFormats).map((e=>Number(e))).forEach((e=>{this.knownFormats[e].reset()})),this.formatStrings=(0,n.makeStringMap)(),Object.keys(this.iformats).map(Number).forEach((e=>{const t=this.iformats[e];this.formatStrings[t.formatString]=e}))}getIformat(e){const t=this.iformats[e];return void 0===t?(0,i.failure)({kind:o.UnavailableKind.NumberFormat,iformat:e}):(0,i.success)(t.compiledFormat)}getIformats(){return this.iformats}getKnownFormat(e){return(0,i.success)(this.knownFormats[e])}getFormatString(e){return(0,i.success)(this.formatStrings[e])}setNumberFormats(e,t){t||(this.iformats=[],this.formatStrings=(0,n.makeStringMap)()),Object.keys(e).map(Number).forEach((t=>{const r=this.iformats[t];void 0!==r&&delete this.formatStrings[r.formatString];const n=e[t];this.iformats[t]=n,this.formatStrings[n.formatString]=t}))}constructor(e){this.iformats=[],this.formatStrings=(0,n.makeStringMap)(),this.knownFormats=e}}t.PartialWorkbookFormats=a},55380:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookGrid=t.CloningTarget=t.usedRangeIsect=t.usedRangeJoin=t.denseUsedRange=t.emptyUsedRange=t.mergeGridStatistics=t.emptyGridStatistics=t.hiddennessFullyUnavailable=t.isBlankGridValue=t.blankGridValue=t.isClientValueUnknownOper=t.clientValueUnknownOper=t.ClientOperKind=t.blankClientGridFormula=t.isBlankGridFormula=t.blankRangeGridFormula=t.blankCellGridFormula=t.SpecialString=t.SpecialBoolean=t.isBlankCellFormat=t.blankCellFormat=void 0;const n=r(53750),i=r(50338),o=r(7793),a=r(30333),s=r(25201),l=r(48262),u=r(12450),c=r(20456),d=r(83102),m=r(88928),g=r(88928),p=r(33436),h=r(91709);function f(e){return Array.isArray(e)}var S,v,y;function F(e){return e.kind===y.ClientValueUnknown}function C(e,t){return(0,i.isBlankOper)(e)&&void 0===t}function R(e,t,r){return e.setValue(t,r,(e=>e.fmla!==r.fmla||e.lexicalKind!==r.lexicalKind||void 0!==e.compiledFmla&&!(0,i.isGridCellEqual)(e.origin,r.origin)||null==e.compiledFmla!=(null==r.compiledFmla)))}function b(e,r){return e.forEachMeets(r,((r,n)=>{if(n.fmla.length>0){const i=n.lexicalKind===o.LexicalKind.Cell?t.blankCellGridFormula:t.blankRangeGridFormula;e=e.setValue(r,i)}return!0})),e}function E(e,r){return e.forEachMeets(r,((r,n)=>((n.fmla===v.ClientValueUnknown||n.fmla.length>0)&&(e=e.setValue(r,t.blankClientGridFormula)),!0))),e}function T(e,t,r,n){const i=(0,d.intersectProduct)(t,s.availableReadProduct),o=(0,d.project)((0,d.intersectProduct)(r,i),"row","col");return(0,s.forEachCellInSet)((0,d.exceptProduct)(t,o),(t=>(e=e.setValue(t,n),!0))),e}t.blankCellFormat=0,t.isBlankCellFormat=e=>0===e,function(e){e.ClientValueUnknown="ClientValueUnknown"}(S||(t.SpecialBoolean=S={})),function(e){e[e.ClientValueUnknown=0]="ClientValueUnknown"}(v||(t.SpecialString=v={})),t.blankCellGridFormula={fmla:"",lexicalKind:o.LexicalKind.Cell,origin:(0,o.gridCell)(0,0),compiledFmla:void 0,hasHyperlink:!1},(0,u.staticAssertExtends)(),t.blankRangeGridFormula={fmla:"",lexicalKind:o.LexicalKind.Range,origin:(0,o.gridCell)(0,0),compiledFmla:void 0,hasHyperlink:!1},(0,u.staticAssertExtends)(),t.isBlankGridFormula=(e,t)=>""===e&&!t,t.blankClientGridFormula=t.blankCellGridFormula,function(e){e.ClientValueUnknown="ClientValueUnknown"}(y||(t.ClientOperKind=y={})),t.clientValueUnknownOper={kind:y.ClientValueUnknown},t.isClientValueUnknownOper=F,t.blankGridValue={oper:a.blankOper,failure:void 0},(0,u.staticAssertExtends)(),t.isBlankGridValue=C,t.hiddennessFullyUnavailable={hidden:[],available:[]};const k={values:(0,l.makeGridRangeTable)(),formats:(0,l.makeGridRangeTable)(),styles:(0,l.makeGridRangeTable)(),formulae:(0,l.makeGridRangeTable)(),dirty:c.empty};function P(e,r){return e===t.emptyUsedRange?r:r===t.emptyUsedRange?e:(0,i.gridRangeJoin)(e,r)}function N(e,r){return e===t.emptyUsedRange||r===t.emptyUsedRange?t.emptyUsedRange:(0,i.gridRangeIsect)(e,r)}var A;t.emptyGridStatistics={serverFormulaeNodeCount:0,serverFormatsNodeCount:0,serverStylesNodeCount:0,serverValuesNodeCount:0,serverDirtySetSubspaceCount:0,editedFormulaeNodeCount:0,editedFormatsNodeCount:0,editedStylesNodeCount:0,editedValuesNodeCount:0,editedDirtySetSubspaceCount:0,clientFormulaeNodeCount:0,clientFormatsNodeCount:0,clientValuesNodeCount:0,recalcValuesNodeCount:0,recalcDirtySetSubspaceCount:0,recalcFailuresSetSubspaceCount:0,recalcTaintSetSubspaceCount:0,availabilitySetSubspaceCount:0,availabilityHistorySize:0,hiddenRowsNodeCount:0,hiddenColsNodeCount:0},t.mergeGridStatistics=function(e,t){return{serverFormulaeNodeCount:e.serverFormulaeNodeCount+t.serverFormulaeNodeCount,serverFormatsNodeCount:e.serverFormatsNodeCount+t.serverFormatsNodeCount,serverStylesNodeCount:e.serverStylesNodeCount+t.serverStylesNodeCount,serverValuesNodeCount:e.serverValuesNodeCount+t.serverValuesNodeCount,serverDirtySetSubspaceCount:e.serverDirtySetSubspaceCount+t.serverDirtySetSubspaceCount,editedFormulaeNodeCount:e.editedFormulaeNodeCount+t.editedFormulaeNodeCount,editedFormatsNodeCount:e.editedFormatsNodeCount+t.editedFormatsNodeCount,editedStylesNodeCount:e.editedStylesNodeCount+t.editedStylesNodeCount,editedValuesNodeCount:e.editedValuesNodeCount+t.editedValuesNodeCount,editedDirtySetSubspaceCount:e.editedDirtySetSubspaceCount+t.editedDirtySetSubspaceCount,clientFormulaeNodeCount:e.clientFormulaeNodeCount+t.clientFormulaeNodeCount,clientFormatsNodeCount:e.clientFormatsNodeCount+t.clientFormatsNodeCount,clientValuesNodeCount:e.clientValuesNodeCount+t.clientValuesNodeCount,recalcValuesNodeCount:e.recalcValuesNodeCount+t.recalcValuesNodeCount,recalcDirtySetSubspaceCount:e.recalcDirtySetSubspaceCount+t.recalcDirtySetSubspaceCount,recalcFailuresSetSubspaceCount:e.recalcFailuresSetSubspaceCount+t.recalcFailuresSetSubspaceCount,recalcTaintSetSubspaceCount:e.recalcTaintSetSubspaceCount+t.recalcTaintSetSubspaceCount,availabilitySetSubspaceCount:e.availabilitySetSubspaceCount+t.availabilitySetSubspaceCount,availabilityHistorySize:e.availabilityHistorySize+t.availabilityHistorySize,hiddenRowsNodeCount:e.hiddenRowsNodeCount+t.hiddenRowsNodeCount,hiddenColsNodeCount:e.hiddenColsNodeCount+t.hiddenColsNodeCount}},t.emptyUsedRange=void 0,t.denseUsedRange=(0,o.gridRange)(0,0,o.sheetRows,o.sheetCols),t.usedRangeJoin=P,t.usedRangeIsect=N,function(e){e[e.Server=0]="Server",e[e.Client=1]="Client"}(A||(t.CloningTarget=A={}));class I{static create(){return new I}clone(e=A.Server){const t=new I(this.serverContents,this.serverAvailability,this.serverUsed,this.hiddenRows,this.hiddenRowsAvailability,this.hiddenCols,this.hiddenColsAvailability,this.mergeCells,this.inFilterMode,this.filterModeAvailable);return e===A.Client&&(t.editedContents=this.editedContents,t.clientContents=this.clientContents,t.recalcValues=this.recalcValues,t.recalcDirty=this.recalcDirty,t.recalcFailures=this.recalcFailures,t.editedTaint=this.editedTaint,t.recalcTaint=this.recalcTaint,t.editedAvailability=this.editedAvailability),t}advanceState(e,r){this.oldAvailabilities[e]=this.serverAvailability,this.availabilityHistorySize+=1,this.serverAvailability=c.empty,this.serverUsed=t.denseUsedRange,this.hiddenRows=this.hiddenRowsAvailability=c.empty,this.hiddenCols=this.hiddenColsAvailability=c.empty,this.inFilterMode=this.filterModeAvailable=!1,this.rollBackToServerState(r)}rollBackToServerState(e){this.editedContents=this.serverContents,this.editedAvailability=this.serverAvailability,this.editedUsed=this.serverUsed,this.editedTaint=c.empty,this.rollBackToEditedState(e)}rollBackToEditedState(e){this.setClientContents(this.editedContents,e),this.recalcValues=this.editedContents.values,this.recalcFailures=c.empty,this.recalcDirty=this.editedContents.dirty,this.recalcTaint=this.editedTaint}allServerAvailable(e){return this.allAvailable(e,this.serverAvailability)}allEditedAvailable(e){return this.allAvailable(e,this.editedAvailability)}allAvailable(e,t){const r=(0,s.createCellSetFromRange)(e),n=(0,d.intersectProduct)(r,s.availableReadProduct),i=(0,d.intersectProduct)(t,n),o=(0,d.project)((0,d.exceptProduct)(n,i),"row","col"),a=(0,d.compareProduct)(i,n);return!!(void 0!==a&&a>=0)||o}forEachRecalcDirty(e,t){return(0,s.forEachCellInSet)((0,d.intersectProduct)(this.recalcDirty,(0,s.createCellSetFromRange)(e)),t)}hasRecalcDirty(e){return(0,d.meetsProduct)(this.recalcDirty,(0,s.createCellSetFromRange)(e))}hasRecalcFailure(e){return(0,d.meetsProduct)(this.recalcFailures,(0,s.createCellSetFromRange)(e))}hasEditedEditTaint(e){return(0,d.meetsProduct)(this.editedTaint,(0,s.createCellSetFromRange)(e))}hasRecalcEditTaint(e){return(0,d.meetsProduct)(this.recalcTaint,(0,s.createCellSetFromRange)(e))}getEditedUsedRange(){return this.editedUsed}getServerUsedRange(){return this.serverUsed}getServerAvailability(){return this.serverAvailability}getHiddenRows(e,t){const r=s.bspFactory.row((0,u.pair)(e,t)),i=(0,c.intersect)(this.hiddenRowsAvailability,r),o=[];(0,s.forEachRow)(i,(([e,t])=>(o.push((0,n.interval)(e,t)),!0)));const a=[];return(0,s.forEachRow)((0,c.intersect)(this.hiddenRows,i),(([e,t])=>(a.push((0,n.interval)(e,t)),!0))),{hidden:a,available:o}}tryGetHiddenRows(e,t){const r=this.getHiddenRows(e,t);return 1===r.available.length&&r.available[0].start===e&&r.available[0].end===t?(0,p.success)(r.hidden):(0,p.failure)({kind:m.UnavailableKind.HiddenRows})}setHiddenRows(e,t){const r=s.bspFactory.row((0,u.pair)(e.row,e.row+e.rows));this.hiddenRows=(0,c.union)((0,c.except)(this.hiddenRows,r),(0,c.intersect)(t,r)),this.hiddenRowsAvailability=(0,c.union)(this.hiddenRowsAvailability,r)}getHiddenCols(e,t){const r=s.bspFactory.col((0,u.pair)(e,t)),i=(0,c.intersect)(this.hiddenColsAvailability,r),o=[];(0,s.forEachCol)(i,(([e,t])=>(o.push((0,n.interval)(e,t)),!0)));const a=[];return(0,s.forEachCol)((0,c.intersect)(this.hiddenCols,i),(([e,t])=>(a.push((0,n.interval)(e,t)),!0))),{hidden:a,available:o}}tryGetHiddenCols(e,t){const r=this.getHiddenCols(e,t);return 1===r.available.length&&r.available[0].start===e&&r.available[0].end===t?(0,p.success)(r.hidden):(0,p.failure)({kind:m.UnavailableKind.HiddenCols})}setHiddenCols(e,t){const r=s.bspFactory.col((0,u.pair)(e.col,e.col+e.cols));this.hiddenCols=(0,c.union)((0,c.except)(this.hiddenCols,r),(0,c.intersect)(t,r)),this.hiddenColsAvailability=(0,c.union)(this.hiddenColsAvailability,r)}setMergeCell(e){this.mergeCells=this.mergeCells.setValue(e,!0)}getMergeCell(e){let t;return this.mergeCells.forEachGe(e,(e=>(t=e,!0))),t}isInFilterMode(){return this.filterModeAvailable?(0,p.success)(this.inFilterMode):(0,p.failure)({kind:m.UnavailableKind.InFilterMode})}setInFilterMode(e){this.inFilterMode=e,this.filterModeAvailable=!0}forEachNonBlankSetCellInSet(e,r,n,o){const a=(0,d.intersectProduct)(e,s.availableSetProduct);return(0,s.forEachRangeInSet)((0,d.intersectProduct)(n,a),(e=>o.formulae.forEachMeets(e,((n,o)=>!!(0,t.isBlankGridFormula)(o.fmla,void 0!==o.compiledFmla)||(0,i.forEachCellInRange)((0,i.gridRangeIsect)(e,n),r)))))}forEachReadableCellInSet(e,t,r){const n=(0,d.intersectProduct)(e,s.availableReadProduct);return(0,s.forEachRangeInSet)((0,d.intersectProduct)(r,n),(e=>(0,i.forEachCellInRange)(e,t)))}forEachEditedNonBlankCellInSet(e,t){return this.forEachNonBlankSetCellInSet(e,t,this.editedAvailability,this.editedContents)}forEachServerNonBlankCellInSet(e,t){return this.forEachNonBlankSetCellInSet(e,t,this.serverAvailability,this.serverContents)}forEachEditedCellInSet(e,t){return this.forEachReadableCellInSet(e,t,this.editedAvailability)}promoteServerAvailability(e,t){const r=(0,d.intersectProduct)(e,s.availableSetProduct),n=this.oldAvailabilities[t];if(void 0===n)return!1;const i=(0,d.compareProduct)(n,r);return void 0!==i&&i>=0&&(this.unionAvailability(!0,(0,d.intersectProduct)(e,s.availableAllProduct)),this.unionTaint(!0,c.empty),this.unionUsed(!0,(0,s.cellSetBounds)(e)),!0)}extendServerUnused(e,r){const n=e===t.emptyUsedRange?c.empty:(0,s.createCellSetFromRange)(e),i=(0,d.complementProduct)(n);let{values:o,formats:a,styles:l,formulae:u,dirty:m}=this.serverContents;(0,s.forEachRangeInSet)(i,(e=>(o.forEachLe(e,((e,r)=>(C(r.oper,r.failure)||(o=o.setValue(e,t.blankGridValue)),!0))),a.forEachLe(e,((e,r)=>((0,t.isBlankCellFormat)(r)||(a=a.setValue(e,t.blankCellFormat)),!0))),l.forEachLe(e,((e,t)=>(t!==g.SpecialStyle.Blank&&(l=l.setValue(e,g.SpecialStyle.Blank)),!0))),!0))),(0,s.forEachRangeInSet)(i,(e=>(u=b(u,e),!0))),m=(0,d.exceptProduct)(m,i),this.setContents(!0,{values:o,formats:a,styles:l,formulae:u,dirty:m},r);const p=(0,d.intersectProduct)(i,s.availableReadProduct);this.serverAvailability=this.editedAvailability=(0,d.unionProduct)(this.serverAvailability,p),this.editedTaint=this.recalcTaint=c.empty;let h=this.serverUsed;h=N(h,e),this.serverUsed=this.editedUsed=h}setRecalcFailure(e){this.recalcFailures=(0,d.unionProduct)(this.recalcFailures,e)}setRecalcEditTaint(e){this.recalcTaint=(0,d.unionProduct)(this.recalcTaint,e)}setRecalcValue(e,t){(0,i.forEachCellInRange)(e,((e,r,n)=>(this.recalcValues=this.recalcValues.setValue(e,{oper:f(t)?t[r][n]:t,failure:void 0}),!0))),this.recalcDirty=(0,d.exceptProduct)(this.recalcDirty,(0,s.createCellSetFromRange)(e))}setClientContents(e,t){this.clientContents=e}setClientValue(e,t,r){let{values:n}=this.clientContents;(0,i.forEachCellInRange)(e,((e,r,i)=>(n=n.setValue(e,{oper:f(t)?t[r][i]:t,failure:void 0}),!0))),this.setClientContents(Object.assign(Object.assign({},this.clientContents),{values:n}),r)}setClientFormula(e,t,r,n){let{formulae:o}=this.clientContents;o=E(o,e),void 0!==t?o=o.setValue(t,r):(0,i.forEachCellInRange)(e,(e=>(o=o.setValue(e,r),!0))),this.setClientContents(Object.assign(Object.assign({},this.clientContents),{formulae:o}),n)}setClientFormat(e,t,r){let{formats:n}=this.clientContents;(0,i.forEachCellInRange)(e,(e=>(n=n.setValue(e,t),!0))),this.setClientContents(Object.assign(Object.assign({},this.clientContents),{formats:n}),r)}getRecalcValues(e){const{row:r,col:n,rows:i,cols:o}=e,a=new Array(i);for(let e=0;e<i;e+=1)a[e]=(0,h.arrayFill)(new Array(o),t.blankGridValue);return this.recalcValues.forEachLe(e,((e,t)=>(a[e.row-r][e.col-n]=t,!0))),a}forEachRecalcValue(e,t){return this.recalcValues.forEachMeets(e,t)}getClientValue(e){const r=this.clientContents.values.getValue(e);return null!=r?r:t.blankGridValue}getServerValue(e){const r=this.serverContents.values.getValue(e);return null!=r?r:t.blankGridValue}getEditedValue(e){const r=this.editedContents.values.getValue(e);return null!=r?r:t.blankGridValue}forEachEditedValue(e,t){return this.editedContents.values.forEachMeets(e,t)}getServerFormula(e){return this.getFormula(e,this.serverContents.formulae)}getClientFormula(e){return this.getFormula(e,this.clientContents.formulae)}setEditedFormat(e,t){this.editedContents=Object.assign(Object.assign({},this.editedContents),{formats:this.editedContents.formats.setValue(e,t)})}getEditedFormat(e){const r=this.editedContents.formats.getValue(e);return null!=r?r:t.blankCellFormat}forEachEditedFormat(e,t){return this.editedContents.formats.forEachMeets(e,t)}getServerFormat(e){const r=this.serverContents.formats.getValue(e);return null!=r?r:t.blankCellFormat}getEditedStyle(e){const t=this.editedContents.styles.getValue(e);return null!=t?t:g.SpecialStyle.Blank}getServerStyle(e){const t=this.serverContents.styles.getValue(e);return null!=t?t:g.SpecialStyle.Blank}getClientFormat(e){const r=this.clientContents.formats.getValue(e);return null!=r?r:t.blankCellFormat}getEditedFormula(e){return this.getFormula(e,this.editedContents.formulae)}forEachEditedFormula(e,t){return this.editedContents.formulae.forEachMeets(e,t)}getFormula(e,r){let n;return r.forEachGe(e,((e,r)=>!!(0,t.isBlankGridFormula)(r.fmla,void 0!==r.compiledFmla)||(n=[e,r],!1))),n}setContents(e,t,r){e&&(this.serverContents=t),this.editedContents=t,e&&this.setClientContents(this.editedContents,r),this.recalcValues=this.editedContents.values,this.recalcDirty=this.editedContents.dirty,this.recalcFailures=c.empty}unionAvailability(e,t){let r=e?this.serverAvailability:this.editedAvailability;r=(0,d.unionProduct)(r,t),e&&(this.serverAvailability=r),this.editedAvailability=r}unionTaint(e,t){this.editedTaint=e?c.empty:(0,d.unionProduct)(this.editedTaint,t),this.recalcTaint=this.editedTaint}unionUsed(e,t){let r=e?this.serverUsed:this.editedUsed;r=P(r,t),e&&(this.serverUsed=r),this.editedUsed=r}setCellContents(e,t,r,n,i,o,a,s,l){this.setCommon(e,t,void 0,r,n,i,o,a,s,l)}setRangeFormula(e,t,r,n,i,o,a,l){const u=(0,s.createCellSetFromRange)(t);this.setCommon(e,u,t,r,n,void 0,i,o,a,l)}setCommon(e,r,n,i,o,a,l,u,m,p){let{values:h,formats:f,styles:S,formulae:v,dirty:y}=e?this.serverContents:this.editedContents;const F=void 0===i&&void 0!==o||void 0!==(null==i?void 0:i.compiledFmla);let E=i;void 0!==i&&((0,s.forEachRangeInSet)(r,(e=>(v=b(v,e),!0))),(0,t.isBlankGridFormula)(i.fmla,void 0!==i.compiledFmla)&&(E=void 0));const k=void 0!==E&&void 0===n?i:void 0,P=void 0!==E&&void 0!==n?i:void 0;let N=o;void 0!==o&&C(o,a)&&((0,s.forEachRangeInSet)(r,(e=>(h.forEachLe(e,((e,r)=>(C(r.oper,r.failure)||(h=h.setValue(e,t.blankGridValue)),!0))),!0))),y=F?(0,d.unionProduct)(y,r):(0,d.exceptProduct)(y,r),N=void 0);const A=void 0!==N?{oper:N,failure:a}:void 0;let I=l;void 0!==l&&(0,t.isBlankCellFormat)(l)&&((0,s.forEachRangeInSet)(r,(e=>(f.forEachLe(e,((e,r)=>((0,t.isBlankCellFormat)(r)||(f=f.setValue(e,t.blankCellFormat)),!0))),!0))),I=void 0);const O=I===g.SpecialFormat.Weak?void 0:I,_=I===g.SpecialFormat.Weak?I:void 0;let M=u;void 0!==u&&u===g.SpecialStyle.Blank&&((0,s.forEachRangeInSet)(r,(e=>(S.forEachLe(e,((e,t)=>(t!==g.SpecialStyle.Blank&&(S=S.setValue(e,g.SpecialStyle.Blank)),!0))),!0))),M=void 0);const D=M===g.SpecialStyle.Weak?void 0:M,w=M===g.SpecialStyle.Weak?M:void 0;let L=r;if(!e){const e=(0,d.intersectProduct)(r,s.availableSetProduct),t=(0,d.project)((0,d.intersectProduct)(this.editedAvailability,e),"row","col"),n=(0,d.intersectProduct)(r,void 0!==m?(0,s.createCellSetFromRange)(m):c.empty);L=(0,d.unionProduct)(t,n)}if(void 0===k&&void 0===O&&void 0===D&&void 0===A||((0,s.forEachCellInSet)(L,(e=>(void 0!==k&&(v=R(v,e,k)),void 0!==O&&(f=f.setValue(e,O)),void 0!==D&&(S=S.setValue(e,D)),void 0!==A&&(h=h.setValue(e,A)),!0))),void 0===k&&void 0===A||(y=F?(0,d.unionProduct)(y,L):(0,d.exceptProduct)(y,L))),void 0!==P){v=R(v,n,P);const e=(0,s.createCellSetFromRange)(n);y=F?(0,d.unionProduct)(y,e):(0,d.exceptProduct)(y,e)}void 0!==_&&(f=T(f,L,e?this.serverAvailability:this.editedAvailability,g.SpecialFormat.Unavailable)),void 0!==w&&(S=function(e,t,r){const n=(0,d.intersectProduct)(t,s.availableReadProduct),i=(0,d.project)((0,d.intersectProduct)(r,n),"row","col");return(0,s.forEachCellInSet)((0,d.exceptProduct)(t,i),(t=>(e=e.setValue(t,g.SpecialStyle.Unavailable),!0))),e}(S,L,e?this.serverAvailability:this.editedAvailability));const x=void 0===o?c.empty:L,K=void 0===i?c.empty:L,U=void 0===l?c.empty:L,B=void 0===o&&void 0===l?c.empty:L;e||((0,s.forEachRangeInSet)(x,(e=>(this.setClientValue(e,t.clientValueUnknownOper,p),!0))),void 0!==i&&(void 0!==n?this.setClientFormula(n,n,i,p):(0,s.forEachRangeInSet)(K,(e=>(this.setClientFormula(e,void 0,i,p),!0)))),l===g.SpecialFormat.Weak?this.setClientContents(Object.assign(Object.assign({},this.clientContents),{formats:T(this.clientContents.formats,U,this.editedAvailability,g.SpecialFormat.ClientValueUnknown)}),p):(0,s.forEachRangeInSet)(U,(e=>(this.setClientFormat(e,g.SpecialFormat.ClientValueUnknown,p),!0)))),this.setContents(e,{values:h,formats:f,styles:S,formulae:v,dirty:y},p),this.unionAvailability(e,(0,d.intersectProduct)(x,s.availableAllProduct)),e||(this.editedAvailability=(0,d.exceptProduct)(this.editedAvailability,(0,d.exceptProduct)(r,L))),this.unionTaint(e,B),this.unionUsed(e,(0,s.cellSetBounds)(r))}copyRange(e){function t(t,r){return t.forEachLe(e,((e,t)=>(r=r.setValue(e,t),!0))),r}let{values:r,formats:n,styles:o,formulae:a}=k;const{values:l,formats:u,styles:c,formulae:m}=this.editedContents;r=t(l,r),n=t(u,n),o=t(c,o),m.forEachMeets(e,((t,r)=>(a=a.setValue((0,i.gridRangeIsect)(t,e),r),!0)));const g=(0,i.gridRangeAnchor)(e),p=(0,d.intersectProduct)(this.editedAvailability,(0,s.createCellSetFromRange)(e)),h=N(this.editedUsed,e);return{origin:g,formats:n,styles:o,values:r,formulae:a,availability:p,used:h}}pasteRange(e,r,n){const i=(0,s.createCellSetFromRange)(e),a=(0,o.gridRange)(r.origin.row,r.origin.col,e.rows,e.cols);let{values:l,formats:u,styles:m,formulae:p,dirty:h}=this.editedContents;const f=this.editedUsed,y=e.row-r.origin.row,F=e.col-r.origin.col;function C(e){return(0,o.gridRange)(e.row+y,e.col+F,e.rows,e.cols)}function R(t,r,n){return r.forEachMeets(e,((e,t)=>(r=r.setValue(e,n),!0))),t.forEachLe(a,((e,t)=>(r=r.setValue(C(e),t),!0))),r}const b=P(f,r.used!==t.emptyUsedRange?C(r.used):t.emptyUsedRange),T=N(b,e);l=R(r.values,l,t.blankGridValue),T!==t.emptyUsedRange&&this.setClientValue(T,t.clientValueUnknownOper,n),u=R(r.formats,u,t.blankCellFormat),m=R(r.styles,m,g.SpecialStyle.Blank),T!==t.emptyUsedRange&&this.setClientFormat(T,g.SpecialFormat.ClientValueUnknown,n),p=R(r.formulae,p,t.blankCellGridFormula),h=(0,d.exceptProduct)(h,i);{let{formulae:t}=this.clientContents;t=E(t,e),p.forEachLe(e,((e,{origin:r,compiledFmla:n})=>(void 0!==n&&(h=(0,d.unionProduct)(h,(0,s.createCellSetFromRange)(e))),t=t.setValue(e,{fmla:v.ClientValueUnknown,origin:r,compiledFmla:n,hasHyperlink:S.ClientValueUnknown}),!0))),this.setClientContents(Object.assign(Object.assign({},this.clientContents),{formulae:t}),n)}const k=!1;var A;this.setContents(k,{values:l,formats:u,styles:m,formulae:p,dirty:h},n),this.editedAvailability=(0,d.exceptProduct)(this.editedAvailability,i),this.unionAvailability(k,(A=r.availability,(0,s.translateAvailabilitySet)(A,y,F))),this.unionTaint(k,T===t.emptyUsedRange?c.empty:(0,s.createCellSetFromRange)(T)),this.unionUsed(k,b)}assumeRecalcFinal(e,t){this.recalcDirty=(0,d.exceptProduct)(this.recalcDirty,e)}getDirtyEditedCells(){return(0,d.intersectProduct)(this.recalcDirty,this.editedTaint)}getNonDirtyEditedCells(){return(0,d.exceptProduct)(this.editedTaint,this.recalcDirty)}getDirtyDependentCells(){return(0,d.exceptProduct)(this.recalcDirty,this.editedTaint)}onCellModified(e,r){const n=e?this.serverContents:this.editedContents;this.setContents(e,n,r),this.unionAvailability(e,c.empty),this.unionTaint(e,c.empty),this.unionUsed(e,t.emptyUsedRange)}clearCompiledFormulas(){for(const e of[this.serverContents.formulae,this.editedContents.formulae])e.forEach(((e,t)=>(void 0!==t.compiledFmla&&t.compiledFmla.reset(),!0)))}getStatistics(){return{serverFormulaeNodeCount:this.serverContents.formulae.getCount(),serverFormatsNodeCount:this.serverContents.formats.getCount(),serverStylesNodeCount:this.serverContents.styles.getCount(),serverValuesNodeCount:this.serverContents.values.getCount(),serverDirtySetSubspaceCount:(0,d.getSubspaceCount)(this.serverContents.dirty),editedFormulaeNodeCount:this.editedContents.formulae.getCount(),editedFormatsNodeCount:this.editedContents.formats.getCount(),editedStylesNodeCount:this.editedContents.styles.getCount(),editedValuesNodeCount:this.editedContents.values.getCount(),editedDirtySetSubspaceCount:(0,d.getSubspaceCount)(this.editedContents.dirty),clientFormulaeNodeCount:this.clientContents.formulae.getCount(),clientFormatsNodeCount:this.clientContents.formats.getCount(),clientValuesNodeCount:this.clientContents.values.getCount(),recalcValuesNodeCount:this.recalcValues.getCount(),recalcDirtySetSubspaceCount:(0,d.getSubspaceCount)(this.recalcDirty),recalcFailuresSetSubspaceCount:(0,d.getSubspaceCount)(this.recalcFailures),recalcTaintSetSubspaceCount:(0,d.getSubspaceCount)(this.recalcTaint),availabilityHistorySize:this.availabilityHistorySize,availabilitySetSubspaceCount:(0,d.getSubspaceCount)(this.editedAvailability),hiddenRowsNodeCount:(0,c.getNodeCount)(this.hiddenRows)+(0,c.getNodeCount)(this.hiddenRowsAvailability),hiddenColsNodeCount:(0,c.getNodeCount)(this.hiddenCols)+(0,c.getNodeCount)(this.hiddenColsAvailability)}}collectGarbage(e,r){let n=c.empty;for(const t in this.oldAvailabilities)if(this.oldAvailabilities.hasOwnProperty(t)){const r=Number(t);if(r>=e){n=(0,d.unionProduct)(n,this.oldAvailabilities[r]);continue}delete this.oldAvailabilities[r],this.availabilityHistorySize-=1}function i(e){return(0,d.meetsProduct)((0,d.intersectProduct)((0,s.createCellSetFromRange)(e),s.availableSetProduct),n)}function o(e,r){return!(0,t.isBlankGridFormula)(r.fmla,void 0!==r.compiledFmla)&&i(e)}function a(e,r){return!(0,t.isBlankCellFormat)(r)&&i(e)}function l(e,t){return t!==g.SpecialStyle.Blank&&i(e)}function u(e,t){return!(!F(t.oper)&&C(t.oper,t.failure))&&i(e)}const m=(0,d.project)(n,"row","col");this.serverContents={formulae:this.serverContents.formulae.filter(o),formats:this.serverContents.formats.filter(a),styles:this.serverContents.styles.filter(l),values:this.serverContents.values.filter(u),dirty:(0,d.intersectProduct)(this.serverContents.dirty,m)},this.editedContents={formulae:this.editedContents.formulae.filter(o),formats:this.editedContents.formats.filter(a),styles:this.editedContents.styles.filter(l),values:this.editedContents.values.filter(u),dirty:(0,d.intersectProduct)(this.editedContents.dirty,m)},this.setClientContents({formulae:this.clientContents.formulae.filter(o),formats:this.clientContents.formats.filter(a),values:this.clientContents.values.filter(u)},r),this.recalcValues=this.recalcValues.filter(u),this.recalcDirty=(0,d.intersectProduct)(this.recalcDirty,m)}constructor(e=k,r=c.empty,n=t.denseUsedRange,i=c.empty,o=c.empty,a=c.empty,s=c.empty,u=(0,l.makeGridRangeTable)(),d=!1,m=!1){this.oldAvailabilities={},this.availabilityHistorySize=0,this.serverContents=e,this.serverAvailability=r,this.serverUsed=n,this.hiddenRows=i,this.hiddenRowsAvailability=o,this.hiddenCols=a,this.hiddenColsAvailability=s,this.mergeCells=u,this.inFilterMode=d,this.filterModeAvailable=m,this.rollBackToServerState(0)}}t.PartialWorkbookGrid=I},88928:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isOutputFormatUnavailable=t.OutputMessageKind=t.FormulaMode=t.SpecialStyle=t.SpecialFormat=t.SetMessageKind=t.mergeRecalcStatistics=t.RecalcStatisticsMessage=t.emptyRecalcStatistics=t.ComputedCellKind=t.ComputeKind=t.sheetInFilterMode=t.sheetHiddenRows=t.sheetUsedRange=t.createSheetCellSetFromRange=t.sheetCellSet=t.UnavailableKind=void 0;const n=r(25201),i=r(57264);var o,a,s,l,u,c,d,m,g;function p(e,t){return{sheet:e,set:t}}function h(e,t){var r;return Object.assign(Object.assign({},e),{[t]:(null!==(r=e[t])&&void 0!==r?r:0)+1})}!function(e){e.DocumentLoc="DocumentLoc",e.SheetId="SheetId",e.SheetNames="SheetNames",e.GridRange="GridRange",e.GridRangeSize="GridRangeSize",e.CellFormat="CellFormat",e.CellStyle="CellStyle",e.HiddenRows="HiddenRows",e.HiddenCols="HiddenCols",e.InFilterMode="InFilterMode",e.CellFormula="CellFormula",e.CellMissingFormula="CellMissingFormula",e.CellEvaluatingValue="CellEvaluatingValue",e.EvalFailure="EvalFailure",e.ClientFailure="ClientFailure",e.NumberFormat="NumberFormat",e.StyleId="StyleId",e.FontId="FontId",e.FillId="FillId",e.BorderId="BorderId",e.NameLoc="NameLoc",e.VolatileFunction="VolatileFunction",e.TimeGranularity="TimeGranularity",e.GetTimeKind="GetTimeKind",e.ColumnName="ColumnName",e.ContainingTable="ContainingTable",e.NamedRanges="NamedRanges"}(o||(t.UnavailableKind=o={})),t.sheetCellSet=p,t.createSheetCellSetFromRange=function(e){return p(e.sheet,(0,n.createCellSetFromRange)(e.range))},t.sheetUsedRange=function(e,t){return{sheet:e,range:t}},t.sheetHiddenRows=function(e,t,r){return{sheet:e,range:t,hidden:r}},t.sheetInFilterMode=function(e,t){return{sheet:e,inFilterMode:t}},function(e){e.PrecisionTest="PrecisionTest",e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.EvalFormula="EvalFormula",e.ParseEdit="ParseEdit"}(a||(t.ComputeKind=a={})),function(e){e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.IndependentCell="IndependentCell",e.UnknownNonEditedCell="UnknownNonEditedCell"}(s||(t.ComputedCellKind=s={})),t.emptyRecalcStatistics={calculatedCellCount:{},changedCellCount:{},continueCount:0,editFinishedCount:0,stateTimedOut:!1,recalcFinishedCount:0},function(e){e.ChangedCell="ChangedCell",e.UnchangedCell="UnchangedCell",e.ContinueComputation="ContinueComputation",e.EditFinished="EditFinished",e.StateTimedOut="StateTimedOut",e.RecalcFinished="RecalcFinished"}(l||(t.RecalcStatisticsMessage=l={})),t.mergeRecalcStatistics=function(e,t){switch(t.message){case l.ChangedCell:return Object.assign(Object.assign({},e),{changedCellCount:h(e.changedCellCount,t.cellKind),calculatedCellCount:h(e.calculatedCellCount,t.cellKind)});case l.UnchangedCell:return Object.assign(Object.assign({},e),{calculatedCellCount:h(e.calculatedCellCount,t.cellKind)});case l.ContinueComputation:return Object.assign(Object.assign({},e),{continueCount:e.continueCount+1});case l.StateTimedOut:return Object.assign(Object.assign({},e),{stateTimedOut:!0});case l.EditFinished:return Object.assign(Object.assign({},e),{editFinishedCount:e.editFinishedCount+1});case l.RecalcFinished:return Object.assign(Object.assign({},e),{recalcFinishedCount:e.recalcFinishedCount+1});default:return(0,i.assertNever)("calc.calc.partialWorkbookMessages.mergeRecalcStatistics",t)}},function(e){e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo",e.SetNumberFormats="SetNumberFormats",e.WriteNamedObject="WriteNamedObject",e.WriteUndefinedNames="WriteUndefinedNames",e.PromoteNamedObjects="PromoteNamedObjects",e.ExtendUnusedRange="ExtendUnusedRange",e.WriteHiddenRows="WriteHiddenRows",e.WriteInFilterMode="WriteInFilterMode",e.SetCellContents="SetCellContents",e.SetRangeFormula="SetRangeFormula",e.PromoteCellContents="PromoteCellContents"}(u||(t.SetMessageKind=u={})),function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.ClientValueUnknown="ClientValueUnknown",e.Origin="Origin",e.Aggregate="Aggregate",e.Inferred="Inferred",e.Known="Known",e.Edit="Edit"}(c||(t.SpecialFormat=c={})),function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.Blank="Blank"}(d||(t.SpecialStyle=d={})),function(e){e.EvalFormula="eval-formula",e.ServerCellFormula="server-cell-formula",e.EditCellFormula="edit-cell-formula",e.ServerNamedFormula="server-named-formula",e.EditNamedFormula="edit-named-formula"}(m||(t.FormulaMode=m={})),function(e){e.StateAdvanced="StateAdvanced",e.CellWrite="CellWrite",e.RangeWrite="RangeWrite",e.NameFailure="NameFailure",e.RangeFailure="RangeFailure",e.NumberFormatFailure="NumberFormatFailure",e.PrintFormulaFailure="PrintFormulaFailure",e.InferFormatFailure="InferFormatFailure",e.FormatValueFailure="FormatValueFailure",e.UnhandledFailure="UnhandledFailure",e.UpdateRequest="UpdateRequest",e.UpdateNamesRequest="UpdateNamesRequest",e.GarbageCollected="GarbageCollected",e.Alert="Alert",e.RecalcStatistics="RecalcStatistics",e.WorkbookStatistics="WorkbookStatistics",e.ExperimentRunResult="ExperimentRunResult"}(g||(t.OutputMessageKind=g={})),t.isOutputFormatUnavailable=function(e){return"object"==typeof e}},43364:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookNameManager=void 0;const n=r(7793),i=r(12450),o=r(33436),a=r(71510),s=r(50338),l=r(57264),u=r(20778),c=r(71948),d=r(87555),m=r(88928);class g{clone(){let e;if(this.sheetScopedNames){e=(0,i.makeStringMap)();for(const t in this.sheetScopedNames){const r=this.sheetScopedNames[t];e[t]=r.clone()}}return new g(this.document,this.stringCompareCI,e,void 0,this.globalNames.clone())}setNamedObject(e,t,r,i){const a=this.getNameFormula(t,n.NameSource.StructRef);void 0!==r&&"NamedTable"===r.kind&&(0,o.isSuccess)(a)&&void 0!==a.value&&"NamedTable"===a.value.obj.kind&&(0,u.isNamedTableRangeEqual)(a.value.obj,r)&&(r=(0,u.mergeNamedTables)(a.value.obj,r));const s=this.getNamesBySheetId(t.scope.index);return s.kind===o.ResultKind.Failure?s:s.value.setNamedObject(e,t,r,i,this.onWriteNamedObject)}setUndefinedNames(e){const t=this.getNamesBySheetId(e.index);return t.kind===o.ResultKind.Failure?t:(0,o.success)(t.value.setUndefinedNames())}promoteNamedObjects(e,t){const r=this.getNamesBySheetId(e.index);return r.kind===o.ResultKind.Failure?r:r.value.promoteNamedObjects(t,this.onWriteNamedObject)}setSheetNames(e){var t,r;const o=null!==(t=this.sheetScopedNames)&&void 0!==t?t:this.oldSheetScopedNames,a=(0,i.makeStringMap)();for(const{sheetId:t}of e)a[t]=null!==(r=null==o?void 0:o[t])&&void 0!==r?r:new u.PartialWorkbookNames(this.stringCompareCI,(0,n.sheetIndex)(this.document,t));return new g(this.document,this.stringCompareCI,a,void 0,this.globalNames)}getNameLoc(e,t,r){const n=this.getNamesBySheetId(e);if(n.kind===o.ResultKind.Failure)return n;const i=n.value.getNameLoc(t,r);return i.kind,o.ResultKind.Failure,i}getAvailableNamesInScope(e){const t=this.getAllDocumentNames(),r=this.getNamesBySheetId(e);return r.kind===o.ResultKind.Success&&(0,i.safePush)(t,r.value.getAvailableNames((0,n.nameScope)(this.document,e))),t}getAllDocumentNames(){return this.globalNames.getAvailableNames((0,n.documentScope)(this.document))}getAvailableTableColumns(e){const t=this.getNameFormula(e,n.NameSource.StructRef),r=[];if(t.kind!==o.ResultKind.Success||void 0===t.value||"NamedTable"!==t.value.obj.kind)return{cols:r,isPartial:!0};const i=!t.value.obj.allColumnNamesAvailable;return t.value.obj.columnNames.forEach((e=>(r.push(e),!0))),{cols:r,isPartial:i}}getNameFormula(e,t){const r=this.getNamesBySheetId(e.scope.index);return r.kind===o.ResultKind.Failure?r:r.value.getNameFormula(e.name,t)}hasRecalcNameFailure(e){const t=this.getNamesBySheetId(e.scope.index);return t.kind===o.ResultKind.Failure?t:(0,o.success)(t.value.hasRecalcFailure(e.name))}setRecalcNameFailure(e){const t=this.getNamesBySheetId(e.scope.index);return t.kind===o.ResultKind.Failure?t:(0,o.success)(t.value.setRecalcFailure(e.name))}getNamesBySheetId(e){if(void 0===e)return(0,o.success)(this.globalNames);if(!this.sheetScopedNames)return(0,o.failure)((0,s.unavailable)([{kind:m.UnavailableKind.SheetNames}]));const t=this.sheetScopedNames[e];return void 0===t?(0,o.failure)((0,s.unavailable)([{kind:m.UnavailableKind.SheetId,document:this.document,sheetId:e}])):(0,o.success)(t)}getContainingTable(e){const t=this.getNamesBySheetId(e.sheet.index);return t.kind===o.ResultKind.Failure?t:(0,o.success)(t.value.getContainingTable(e.range))}getNamedRanges(e){const t=this.getNamesBySheetId(e.sheet.index);return t.kind===o.ResultKind.Failure?t:(0,o.success)(t.value.getNamedRanges(e.range))}getIntersectingTables(e){const t=this.getNamesBySheetId(e.sheet.index);return t.kind===o.ResultKind.Failure?t:(0,o.success)(t.value.getIntersectingTables(e.range))}getStructRefColumn(e,t){const r=this.getNameFormula(e,n.NameSource.StructRef);if(r.kind===o.ResultKind.Failure)return r;if(void 0===r.value)return(0,o.success)(void 0);if("NamedTable"!==r.value.obj.kind)return(0,o.failure)((0,c.invalidStructRef)(c.InvalidStructRefReason.NamedObjectNotTable));const i=r.value.obj;let l;if("string"==typeof t)l=i.columnNames.getEntry(t);else{const e=i.columnIndexes.getValue(t);l=void 0===e?void 0:(0,d.entry)(e,t)}if(void 0===l)return i.allColumnNamesAvailable?(0,o.success)(void 0):(0,o.failure)((0,s.unavailable)([{kind:m.UnavailableKind.ColumnName,table:e,columnNameOrIndex:t}]));const{sheet:u,range:g}=i.specialRefRanges[a.SpecialRefId.Data],p=(0,n.sheetGridRange)(u,(0,n.gridRange)(g.row,l.value,g.rows,1));return(0,o.success)((0,n.structRefColumnLoc)(l.key,p,i.hasHeadersRow,i.hasTotalsRow))}getStructRefSpecialRef(e,t){const r=this.getNameFormula(e,n.NameSource.StructRef);return r.kind===o.ResultKind.Failure?r:void 0===r.value?(0,o.success)(void 0):"NamedTable"!==r.value.obj.kind?(0,o.failure)((0,c.invalidStructRef)(c.InvalidStructRefReason.NamedObjectNotTable)):(0,o.success)(r.value.obj.specialRefRanges[t])}onCellModified(e){this.forEachSheetScope((t=>{t.onCellModified(e)})),this.globalNames.onCellModified(e)}collectGarbage(e){this.forEachSheetScope((t=>{t.collectGarbage(e)})),this.globalNames.collectGarbage(e)}advanceState(e){this.forEachSheetScope((t=>{t.advanceState(e)})),this.globalNames.advanceState(e),this.oldSheetScopedNames=this.sheetScopedNames,this.sheetScopedNames=void 0}resetLazyData(){this.forEachSheetScope((e=>{e.resetLazyData()})),this.globalNames.resetLazyData()}getNameStatistics(){let e=this.globalNames.getStatistics();return this.forEachSheetScope((t=>e=(0,u.mergeNameStatistics)(e,t.getStatistics()))),e}forEachSheetScope(e){for(const t in this.sheetScopedNames)Object.prototype.hasOwnProperty.call(this.sheetScopedNames,t)&&e(this.sheetScopedNames[t])}constructor(e,t,r,i,c){this.document=e,this.stringCompareCI=t,this.sheetScopedNames=r,this.oldSheetScopedNames=i,this.onWriteNamedObject=(e,t,r)=>{if("NamedRange"===t.kind){const n=t.value;(0,l.assertTrue)("calc.calc.PartialWorkbookDocument.onWriteNamedObject: bad range",(0,s.isDocumentLocEqual)(t.value.sheets.document,e.scope.document));const i=this.getNamesBySheetId(n.sheets.index);if(i.kind===o.ResultKind.Failure)return i;i.value.onWriteNamedRange(e,t,r)}if("NamedTable"===t.kind){const n=this.getNamesBySheetId(t.specialRefRanges[a.SpecialRefId.All].sheet.index);if(n.kind===o.ResultKind.Failure)return n;n.value.onWriteNamedTable(e,t,r)}return o.successUndefined},this.globalNames=null!=c?c:new u.PartialWorkbookNames(t,(0,n.documentScope)(e))}}t.PartialWorkbookNameManager=g},20778:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookNames=t.isNamedTableRangeEqual=t.mergeNameStatistics=t.emptyNameStatistics=t.namedFailure=t.namedFormula=t.mergeNamedTables=t.namedTable=t.namedRange=t.namedValue=void 0;const n=r(77954),i=r(7793),o=r(12450),a=r(81476),s=r(94297),l=r(33436),u=r(71510),c=r(50338),d=r(57264),m=r(48262),g=r(88928);t.namedValue=(0,o.typedInstanceCreator)()((e=>({kind:"NamedValue",value:e}))),t.namedRange=(0,o.typedInstanceCreator)()((e=>({kind:"NamedRange",value:e})));const p=s.RedBlackMapTree.create(((e,t)=>e-t));t.namedTable=function(e,t,r,n,o){const{sheet:a,range:l}=e,m=t?(0,i.gridRange)(l.row-1,l.col,1,l.cols):void 0,g=r?(0,i.gridRange)(l.row+l.rows,l.col,1,l.cols):void 0,h=(0,c.gridRangeJoinOpt)((0,c.gridRangeJoinOpt)(m,e.range),g),f=n.reduce(((t,r)=>((0,d.assertTrue)("calc.calc.namedTable: column names in range",r.column>=e.range.col&&r.column<e.range.col+e.range.cols),t.setValue(r.column,r.name))),p);let S=s.RedBlackMapTree.create(o);f.forEach(((e,t)=>(S=S.setValue(t,e),!0)));const v=f.getCount()===e.range.cols;return{kind:"NamedTable",specialRefRanges:{[u.SpecialRefId.Data]:e,[u.SpecialRefId.Headers]:m?(0,i.sheetGridRange)(a,m):void 0,[u.SpecialRefId.Totals]:g?(0,i.sheetGridRange)(a,g):void 0,[u.SpecialRefId.All]:(0,i.sheetGridRange)(a,h)},columnNames:S,columnIndexes:f,allColumnNamesAvailable:v,hasHeadersRow:t,hasTotalsRow:r}},t.mergeNamedTables=function(e,t){let r=e.columnNames,n=e.columnIndexes;t.columnIndexes.forEach(((t,n)=>{const i=e.columnIndexes.getValue(t);return void 0!==i&&(r=r.remove(i)),!0})),t.columnIndexes.forEach(((e,t)=>(r=r.setValue(t,e),n=n.setValue(e,t),!0)));const i=n.getCount()===t.specialRefRanges[u.SpecialRefId.All].range.cols;return Object.assign(Object.assign({},t),{columnNames:r,columnIndexes:n,allColumnNamesAvailable:i})},t.namedFormula=(0,o.typedInstanceCreator)()((e=>({kind:"NamedFormula",fmla:e}))),t.namedFailure=(0,o.typedInstanceCreator)()(((e,t)=>({kind:"NamedFailure",failureReason:e,objectKind:t})));const h=(0,m.makeGridRangeTable)(),f=(0,m.makeGridRangeTable)();t.emptyNameStatistics={namesCount:0,tablesCount:0,rangesCount:0,recalcFailuresCount:0,scopes:0,allAvailableScopes:0},t.mergeNameStatistics=function(e,t){return{namesCount:e.namesCount+t.namesCount,tablesCount:e.tablesCount+t.tablesCount,rangesCount:e.rangesCount+t.rangesCount,recalcFailuresCount:e.recalcFailuresCount+t.recalcFailuresCount,scopes:e.scopes+t.scopes,allAvailableScopes:e.allAvailableScopes+t.allAvailableScopes}},t.isNamedTableRangeEqual=function(e,t){return(0,c.isSheetGridRangeEqual)(e.specialRefRanges[u.SpecialRefId.Data],t.specialRefRanges[u.SpecialRefId.Data])&&e.hasHeadersRow===t.hasHeadersRow&&e.hasTotalsRow===t.hasTotalsRow};class S{static create(e){return new S(s.RedBlackMapTree.create(e),!1,h,f)}update(e,t,r,n){return e!==this.names||t!==this.allAvailable||r!==this.tables||n!==this.ranges?new S(e,t,r,n):this}getEntry(e,t,r){const n=this.names.getEntry(t);return void 0===n?this.allAvailable?(0,l.success)(void 0):(0,l.failure)((0,c.unavailable)([{kind:g.UnavailableKind.NameLoc,name:(0,i.nameLoc)(e,t),source:r}])):(0,l.success)(!1!==n.value?n:void 0)}getEntryIfDefined(e){const t=this.names.getEntry(e);if(void 0!==t)return!1!==t.value?t:void 0}setValue(e,t){return this.update(this.names.setValue(e,t),this.allAvailable,this.tables,this.ranges)}remove(e){return this.update(this.allAvailable?this.names.remove(e):this.names.setValue(e,!1),this.allAvailable,this.tables,this.ranges)}getContainingTable(e){let t;return this.tables.forEachGe(e,((e,r)=>(t=r,!1))),t}getIntersectingTables(e){const t=[];return this.tables.forEachMeets(e,((e,r)=>(t.push(r),!0))),t}getNamedRanges(e){var t;return null!==(t=this.ranges.getValue(e))&&void 0!==t?t:[]}getAvailableNames(e){const t=[];return this.names.forEach(((r,n)=>(!1!==n&&t.push((0,i.nameLoc)(e,r)),!0))),t}forEachAvailableName(e){return this.names.forEach(((t,r)=>e(t,!1===r?void 0:r)))}setUndefined(){return this.update(this.names,!0,this.tables,this.ranges)}getStatistics(e){return{namesCount:this.names.getCount(),tablesCount:this.tables.getCount(),rangesCount:this.ranges.getCount(),recalcFailuresCount:e,scopes:1,allAvailableScopes:this.allAvailable?1:0}}collectGarbage(){return this.update(this.allAvailable?this.names.filter(((e,t)=>!1!==t)):this.names,this.allAvailable,this.tables,this.ranges)}resetLazyData(){this.names.forEach(((e,t)=>(!1!==t&&t.lazyData.reset(),!0)))}onWriteNamedTable(e,t,r){const n=t.specialRefRanges[u.SpecialRefId.All].range;return this.update(this.names,this.allAvailable,"remove"===r?this.tables.remove(n):this.tables.setValue(n,e),this.ranges)}onWriteNamedRange(e,t,r){var n;const i=t.value.ranges[0],o=null!==(n=this.ranges.getValue(i))&&void 0!==n?n:[],a="remove"===r?o.filter((t=>(0,c.isNameScopeEqual)(e.scope,t.scope)&&e.name===t.name)):[...o,e];return this.update(this.names,this.allAvailable,this.tables,0===a.length?this.ranges.remove(i):this.ranges.setValue(i,a))}constructor(e,t,r,n){this.names=e,this.allAvailable=t,this.tables=r,this.ranges=n}}class v{clone(){const e=new v(this.stringCompareCI,this.scope);return e.contents=this.contents,e}advanceState(e){this.oldContents=this.contents,this.oldStateId=this.isCurrent?e:void 0,this.contents=this.emptyContents,this.isCurrent=this.isChanged=!1,this.recalcFailures=this.emptyRecalcFailures}getStatistics(){return this.contents.getStatistics(this.recalcFailures.getCount())}collectGarbage(e){void 0===this.oldStateId||this.oldStateId<e?(this.oldContents=this.emptyContents,this.oldStateId=void 0):this.oldContents=this.oldContents.collectGarbage(),this.contents=this.contents.collectGarbage()}getNameLoc(e,t){const r=this.contents.getEntry(this.scope,e,t);return(0,l.isSuccess)(r)?(0,l.success)(void 0!==r.value?(0,i.nameLoc)(this.scope,r.value.key):void 0):r}getNameFormula(e,t){const r=this.contents.getEntry(this.scope,e,t);return(0,l.isSuccess)(r)?(0,l.success)(void 0!==r.value?r.value.value:void 0):r}getContainingTable(e){return this.contents.getContainingTable(e)}getIntersectingTables(e){return this.contents.getIntersectingTables(e)}getNamedRanges(e){return this.contents.getNamedRanges(e)}allAvailable(){return this.contents.allAvailable}getAvailableNames(e){return this.contents.getAvailableNames(e)}hasRecalcFailure(e){return this.recalcFailures.contains(e)}setRecalcFailure(e){this.recalcFailures=this.recalcFailures.setValue(e,!0)}onCellModified(e){this.recalcFailures=this.emptyRecalcFailures}resetLazyData(){this.contents.resetLazyData(),this.oldContents!==this.contents&&this.oldContents.resetLazyData()}setNamedObject(e,t,r,n,o){const s=this.contents.getEntryIfDefined(t.name);if(void 0!==s){const e=o((0,i.nameLoc)(this.scope,s.key),s.value.obj,"remove");if(e.kind===l.ResultKind.Failure)return e}if(this.contents=void 0===r?this.contents.remove(t.name):this.contents.setValue(t.name,{obj:r,lazyData:new a.ResettableLazy((()=>n(e,t,r)))}),this.isCurrent=this.isChanged=!0,void 0!==r){const e=o(t,r,"add");if(e.kind===l.ResultKind.Failure)return e}return l.successUndefined}setUndefinedNames(){this.contents=this.contents.setUndefined(),this.isCurrent=this.isChanged=!0}promoteNamedObjects(e,t){if(this.isChanged||e!==this.oldStateId)return(0,l.success)(!1);this.contents=this.oldContents,this.isCurrent=!0;let r=(0,l.success)(!0);return this.contents.forEachAvailableName(((e,n)=>{if(void 0===n)return!0;const o=t((0,i.nameLoc)(this.scope,e),n.obj,"add");return o.kind===l.ResultKind.Success||(r=o,!1)})),r}onWriteNamedTable(e,t,r){this.contents=this.contents.onWriteNamedTable(e,t,r)}onWriteNamedRange(e,t,r){this.contents=this.contents.onWriteNamedRange(e,t,r)}forEachAvailableName(e){return this.contents.forEachAvailableName(e)}constructor(e,t){this.stringCompareCI=e,this.scope=t,this.isCurrent=!1,this.isChanged=!1,this.oldContents=this.contents=this.emptyContents=S.create(e),this.emptyRecalcFailures=this.recalcFailures=n.ArrayMapTree.create(e)}}t.PartialWorkbookNames=v},25201:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.translateAvailabilitySet=t.forEachCellInSet=t.forEachRangeInSet=t.forEachCol=t.forEachRow=t.availableAllProduct=t.availableReadProduct=t.availableSetProduct=t.cellSetBounds=t.createCellSetFromRange=t.bspFactory=t.availabilityOperations=t.anyAvailability=t.AvailabilityKind=void 0;const n=r(7793),i=r(50338),o=r(96258),a=r(20456),s=r(96703),l=r(83102);var u;!function(e){e[e.AvailableSet=0]="AvailableSet",e[e.AvailableRead=1]="AvailableRead"}(u||(t.AvailabilityKind=u={})),t.anyAvailability=[u.AvailableSet,u.AvailableRead+1];const c=[0,n.sheetRows],d=[0,n.sheetCols];t.availabilityOperations=(0,s.boundedParetoSetOperations)(1,t.anyAvailability[0]+1,t.anyAvailability[1],t.anyAvailability,"Availability operations, alpha = 1");const m=(0,s.boundedParetoSetOperations)(.2,c[0]+1,c[1],c,"Row operations, alpha = 0.2"),g=(0,s.boundedParetoSetOperations)(.35,d[0]+1,d[1],d,"Col operations, alpha = 0.35"),p={availability:t.availabilityOperations,row:m,col:g};function h(e,t){return e!==a.dense?(0,a.forEachKey)(e,t):t(p.row.top)}function f(e,t){return e!==a.dense?(0,a.forEachKey)(e,t):t(p.col.top)}function S(e,t){return(0,l.forEachProduct)(e,(e=>h(e.row,(r=>{const[i,o]=r;return f(e.col,(e=>{const[r,a]=e;return t((0,n.gridRange)(i,r,o-i,a-r))}))}))),"row","col")}t.bspFactory={availability:(0,a.createFromKey)(p.availability),row:(0,a.createFromKey)(p.row),col:(0,a.createFromKey)(p.col)},t.createCellSetFromRange=function(e){return(0,l.createFromProduct)({row:t.bspFactory.row([e.row,e.row+e.rows]),col:t.bspFactory.col([e.col,e.col+e.cols])})},t.cellSetBounds=function(e){if(e===a.empty)return;const t=e===a.dense?void 0:e.root.bounds.row,r=e===a.dense?void 0:e.root.bounds.col,[i,s]=void 0===t?p.row.top:function(e){const t=[];return h(e,(e=>(t.push(e),!0))),t.reduce(o.ivlJoin)}((0,a.fromUntyped)(p.row,t)),[l,u]=void 0===r?p.col.top:function(e){const t=[];return f(e,(e=>(t.push(e),!0))),t.reduce(o.ivlJoin)}((0,a.fromUntyped)(p.col,r));return(0,n.gridRange)(i,l,s-i,u-l)},t.availableSetProduct=(0,l.createFromProduct)({availability:t.bspFactory.availability([u.AvailableSet,u.AvailableSet+1])}),t.availableReadProduct=(0,l.createFromProduct)({availability:t.bspFactory.availability([u.AvailableRead,u.AvailableRead+1])}),t.availableAllProduct=(0,l.createFromProduct)({availability:t.bspFactory.availability([u.AvailableSet,u.AvailableRead+1])}),t.forEachRow=h,t.forEachCol=f,t.forEachRangeInSet=S,t.forEachCellInSet=function(e,t){return S(e,(e=>(0,i.forEachCellInRange)(e,t)))},t.translateAvailabilitySet=function(e,r,n){let i=a.empty;return(0,l.forEachProduct)(e,(e=>{let o=a.empty;h(e.row,(([e,n])=>(o=(0,a.union)(o,t.bspFactory.row([e+r,n+r])),!0)));let s=a.empty;f(e.col,(([e,r])=>(s=(0,a.union)(s,t.bspFactory.col([e+n,r+n])),!0)));const u=(0,l.createFromProduct)({row:o,col:s,availability:e.availability});return i=(0,l.unionProduct)(i,u),!0}),"row","col","availability"),i}},67396:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookSheets=void 0;const n=r(77954),i=r(12450),o=r(7793),a=r(33436),s=r(50338),l=r(88928);class u{clone(){return new u(this.document,this.stringCompareCI,this.sheetPosToId,this.sheetNameToId,this.data,void 0)}setSheetNames(e){var t;const r=null!==(t=this.data)&&void 0!==t?t:this.oldData,a=(0,i.makeStringMap)(),s=[],l=[];for(let t=0;t<e.length;t+=1){const{sheetName:n,sheetId:i}=e[t];s[t]=i,l.push([n,i]);const u=null==r?void 0:r[i];if(void 0===u){const e=(0,o.sheetIndex)(this.document,i);a[i]={pos:t,name:n,sheetIndex:e}}else a[i]=Object.assign(Object.assign({},u),{pos:t,name:n})}const c=n.ArrayMapTree.create(this.stringCompareCI).setValues(l);return new u(this.document,this.stringCompareCI,s,c,a,void 0)}advanceState(e){this.oldData=this.data,this.sheetPosToId=void 0,this.sheetNameToId=void 0,this.data=void 0}getSheetRangeIds(e){let t,r;if(!this.sheetPosToId)return(0,a.failure)((0,s.unavailable)([{kind:l.UnavailableKind.SheetNames}]));if(void 0===e.index)t=0,r=this.sheetPosToId.length;else{const n=this.getSheetById(e.index);if(!(0,a.isSuccess)(n))return n;const o=this.getSheetById(e.index2);if(!(0,a.isSuccess)(o))return o;t=(0,i.fastMin)(n.value.pos,o.value.pos),r=(0,i.fastMax)(n.value.pos,o.value.pos)+1}const n=[];for(let e=t;e<r;e+=1)n.push(this.sheetPosToId[e]);return(0,a.success)((0,o.sheetRangeIndexes)(n,t))}getSheetById(e){if(!this.data)return(0,a.failure)((0,s.unavailable)([{kind:l.UnavailableKind.SheetNames}]));const t=this.data[e];return void 0===t?(0,a.failure)((0,s.unavailable)([{kind:l.UnavailableKind.SheetId,document:this.document,sheetId:e}])):(0,a.success)(t)}getSheetByName(e){if(!this.sheetNameToId)return(0,a.failure)((0,s.unavailable)([{kind:l.UnavailableKind.SheetNames}]));const t=this.sheetNameToId.getValue(e);return void 0===t?(0,a.success)(void 0):this.getSheetById(t)}forEachSheet(e){if(this.sheetPosToId&&this.data)for(const t of this.sheetPosToId){const r=this.data[t];r&&e(r,t)}}constructor(e,t,r,n,i,o){this.document=e,this.stringCompareCI=t,this.sheetPosToId=r,this.sheetNameToId=n,this.data=i,this.oldData=o}}t.PartialWorkbookSheets=u},24270:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookStyles=t.blankStyleValue=void 0;const n=r(33436),i=r(92217),o=r(88928),a={type:i.BorderLineType.None,color:{argb:"00000000"}};t.blankStyleValue={font:{name:"Calibri",bold:!1,italic:!1,underline:i.FontUnderline.None,strikethrough:!1,verticalAlign:i.FontVerticalAlignment.None,size:11,color:{argb:"ff000000"}},fill:{kind:i.FillKind.Pattern,pattern:i.PatternType.None,fgColor:{argb:"00000000"},bgColor:{argb:"00000000"}},border:{top:a,bottom:a,left:a,right:a},alignment:{horizontal:i.HorizontalAlignment.Automatic,vertical:i.VerticalAlignment.Bottom,textRotation:0,wrapText:!1,indent:0,relativeIndent:0,shrinkToFit:!1,readingOrder:0}};class s{clone(){function e(e,t){Object.keys(e).map(Number).forEach((r=>{t[r]=e[r]}))}const t=new s;return e(this.styles,t.styles),e(this.fonts,t.fonts),e(this.fills,t.fills),e(this.borders,t.borders),t}resolveCellStyle(e){if(e===o.SpecialStyle.Blank)return(0,n.success)(t.blankStyleValue);const r=this.styles[e];if(void 0===r)return(0,n.failure)({kind:o.UnavailableKind.StyleId,styleId:e});const{fontId:i,fillId:a,borderId:s,alignment:l}=r,u=void 0!==i?this.fonts[i]:t.blankStyleValue.font;if(void 0===u)return(0,n.failure)({kind:o.UnavailableKind.FontId,fontId:i});const c=void 0!==a?this.fills[a]:t.blankStyleValue.fill;if(void 0===c)return(0,n.failure)({kind:o.UnavailableKind.FillId,fillId:a});const d=void 0!==s?this.borders[s]:t.blankStyleValue.border;return void 0===d?(0,n.failure)({kind:o.UnavailableKind.BorderId,borderId:s}):(0,n.success)({font:u,fill:c,border:d,alignment:l})}setStyles(e,t){t||(this.styles=[]),Object.keys(e).map(Number).forEach((t=>{this.styles[t]=e[t]}))}setFonts(e,t){t||(this.fonts=[]),Object.keys(e).map(Number).forEach((t=>{this.fonts[t]=e[t]}))}setFills(e,t){t||(this.fills=[]),Object.keys(e).map(Number).forEach((t=>{this.fills[t]=e[t]}))}setBorders(e,t){t||(this.borders=[]),Object.keys(e).map(Number).forEach((t=>{this.borders[t]=e[t]}))}constructor(){this.styles=[],this.fonts=[],this.fills=[],this.borders=[]}}t.PartialWorkbookStyles=s},66547:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PriorityScheduler=t.QueuePos=void 0;const n=r(20963);var i;!function(e){e[e.Back=0]="Back",e[e.Front=1]="Front"}(i||(t.QueuePos=i={})),t.PriorityScheduler=class{deleteTasks(e,t){const r=this.taskDeqs[e];if(!r)return;let n;for(;n=r.popFront();)"function"!=typeof n&&n.onDeleted&&n.onDeleted(t)}addTask(e,t,r){var o;const a=null!==(o=this.taskDeqs[e])&&void 0!==o?o:this.taskDeqs[e]=new n.Deque;t===i.Back?a.pushBack(r):a.pushFront(r),e<this.minPriority&&(this.minPriority=e)}runTask(){var e;for(let t=this.minPriority;t<this.taskDeqs.length;t+=1){this.minPriority=t;const r=null===(e=this.taskDeqs[t])||void 0===e?void 0:e.popFront();if(r)return"function"==typeof r?r():r.onRun(),!0}return!1}getCount(e){var t,r;return void 0!==e?null!==(r=null===(t=this.taskDeqs[e])||void 0===t?void 0:t.getCount())&&void 0!==r?r:0:this.taskDeqs.reduce(((e,t)=>t?e+t.getCount():e),0)}constructor(){this.minPriority=0,this.taskDeqs=[]}}},17338:function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.recalcServiceInsideInit=t.RecalcServiceImpl=void 0;const i=r(19181),o=i.__importStar(r(66932)),a=r(43512),s=r(12450),l=r(93087),u=r(7793),c=r(31053),d=r(25201),m=r(14408),g=r(55380),p=r(88928),h=r(30333),f=r(50338),S=r(20456),v=r(83102),y=r(57264),F=r(53750),C=r(92383),R=r(47324),b=r(28196),E=r(91709),T=r(68616),k=r(70911),P=r(33436),N=r(42549),A=r(38692),I=r(37610),O=r(58293),_=r(23623),M=r(81476),D=r(94746);class w{setOutputStateId(e){e<=this.currentOutputStateId||(this.flush(),this.currentOutputStateId=e)}pushCellWrite(e,t){(e!==p.ComputedCellKind.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas).push(t)}pushRangeWrite(e,t){(0,s.safePush)(e!==p.ComputedCellKind.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas,t)}pushRangeFailure(e,t){(e!==p.ComputedCellKind.DependentCell?this.editedRangeFailures:this.dependentRangeFailures).push(t)}pushUpdateRequest(e){this.rangeUpdateRequests.push(e)}pushUpdateNameRequest(e){this.namesUpdateRequests.push(e.index)}pushRecalcFinished(e){this.recalcFinished=this.recalcFinished||e}isRecalcFinished(){return this.recalcFinished}flush(){(this.rangeUpdateRequests.length>0||this.namesUpdateRequests.length>0)&&(this.onUpdateRequest((0,c.updateRequest)(this.rangeUpdateRequests,[],this.namesUpdateRequests)),this.rangeUpdateRequests=[],this.namesUpdateRequests=[]),(this.editedRangeDeltas.length>0||this.editedRangeFailures.length>0)&&(this.sendRecalcResults("Edited",this.editedRangeDeltas,[],this.editedRangeFailures),this.editedRangeDeltas=[],this.editedRangeFailures=[]),(this.dependentRangeDeltas.length>0||this.dependentRangeFailures.length>0)&&(this.sendRecalcResults("Dependents",this.dependentRangeDeltas,[],this.dependentRangeFailures),this.dependentRangeDeltas=[],this.dependentRangeFailures=[]),this.recalcFinished&&(this.onRecalcResults((0,c.recalcResults)(this.currentOutputStateId,"Dependents",!0,[],[],[])),this.recalcFinished=!1)}sendRecalcResults(e,t,r,n){for(let i=0;i<(0,s.fastMax)((0,s.fastMax)(t.length,r.length),n.length);i+=10)this.onRecalcResults((0,c.recalcResults)(this.currentOutputStateId,e,!1,t.slice(i,i+10),r.slice(i,i+10),n.slice(i,i+10)))}constructor(e,t,r){this.onRecalcResults=e,this.onUpdateRequest=t,this.currentOutputStateId=r,this.editedRangeDeltas=[],this.dependentRangeDeltas=[],this.editedRangeFailures=[],this.dependentRangeFailures=[],this.rangeUpdateRequests=[],this.namesUpdateRequests=[],this.recalcFinished=!1}}function L({kind:e}){return{kind:e}}class x{get document(){return this.dataTransformer.document}get mathpack(){return this.dataTransformer.getLangConfig().mathpack}ping(){}setInputStateId(e,t){const r=e-this.currentInputStateId;return r<0?(this.logInputStateIdDecrease(t),!1):(0!==r&&(this.flushInputLogs(),this.currentInputStateId=e),!0)}setOutputStateId(e){const t=e-this.currentOutputStateId;return t<0?(this.logOutputStateIdDecrease(),!1):(0!==t&&(this.flushOutputLogs(),this.currentOutputStateId=e),!0)}clearAsyncResumeRecalc(){void 0!==this.recalcLoop&&this.recalcLoop.stop()}resumeRecalc(){this.flushInputLogs(),this.clearAsyncResumeRecalc(),this.recalcLoop=this.asyncLoopFactory((()=>{const{messages:e,queueEmpty:t}=this.dataModel.step();return e.length>0&&this.processRecalcResults(e),t?void 0:1}),{costThreshold:1,timeThreshold:this.config.yieldIntervalMs});const e=this.recalcLoop;return(0,b.promiseFinally)(this.recalcLoop.promise,(()=>{this.recalcLoop===e&&(this.recalcLoop=void 0)}))}testResumeRecalc(e){return i.__awaiter(this,void 0,void 0,(function*(){if(yield this.resumeRecalc(),void 0!==e){const t=`calc.calc.RecalcService: resumeRecalc finished; resumeId = ${e}`;y.ulsLogger.ULS.traceTag(574128980,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,t)}}))}processRecalcResults(e){const t=new w(this.onRecalcResults,this.onUpdateRequest,this.currentOutputStateId);for(const r of e)if(r.kind!==p.OutputMessageKind.GarbageCollected)if(r.kind!==p.OutputMessageKind.Alert)if(r.kind!==p.OutputMessageKind.ExperimentRunResult){if(this.setOutputStateId(r.stateId))switch(t.setOutputStateId(r.stateId),r.kind){case p.OutputMessageKind.CellWrite:{const{cell:e,value:n,format:i,cellKind:o,formulaBarText:a,formatted:l,hasHyperlink:u}=r,{sheet:c,range:d}=e,m=this.cellWriteToRangeDelta(c.index,d.row,d.col,n,i,a,l,u,"messages.<index>.value");(0,s.isDefined)(m)&&t.pushCellWrite(o,m);break}case p.OutputMessageKind.RangeWrite:{const{range:e,values:n,cellKind:i,formulaBarText:o,formatted:a,formats:s}=r,{sheet:l,range:u}=e;t.pushRangeWrite(i,this.rangeWriteToRangeDeltas(l.index,u,n,s,o,a,"messages.<index>.values"));break}case p.OutputMessageKind.NameFailure:this.nameFailures.push(r);break;case p.OutputMessageKind.RangeFailure:{const{range:e,cellKind:n,reason:i}=r;t.pushRangeFailure(n,this.rangeFailure(e,i)),this.rangeFailures.push(r);break}case p.OutputMessageKind.NumberFormatFailure:this.numberFormatFailures.push(r);break;case p.OutputMessageKind.PrintFormulaFailure:this.printFormulaFailures.push(r);break;case p.OutputMessageKind.InferFormatFailure:this.inferFormatFailures.push(r);break;case p.OutputMessageKind.FormatValueFailure:{const{range:e,cellKind:n,reason:i}=r;t.pushRangeFailure(n,this.rangeFailure(e,i)),this.formatValueFailures.push(r);break}case p.OutputMessageKind.UnhandledFailure:this.unhandledFailures.push(r);break;case p.OutputMessageKind.UpdateRequest:t.pushUpdateRequest((0,O.sheetGridRangeToLocation)(r.range));break;case p.OutputMessageKind.UpdateNamesRequest:t.pushUpdateNameRequest(r.scope);break;case p.OutputMessageKind.RecalcStatistics:t.pushRecalcFinished(r.message===p.RecalcStatisticsMessage.RecalcFinished),this.recalcStatistics=(0,p.mergeRecalcStatistics)(this.recalcStatistics,r);break;case p.OutputMessageKind.WorkbookStatistics:this.logWorkbookStats(r.stateId,r.stats,r.p);break;case p.OutputMessageKind.StateAdvanced:break;default:return(0,y.assertNever)("calc.calc.RecalcServiceImpl.processRecalcResults",r)}}else this.logExperimentRunResult(r.experimentName,JSON.stringify({message:r.logMessage,timeoutReason:r.timeoutReason}));else this.onAlert(r.message);else this.onGC(r.minStateIdKept);t.isRecalcFinished()&&this.flushOutputLogs(),t.flush()}logExperimentRunResult(e,t){y.ulsLogger.ULS.traceTag(594409422,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,`calc.calc.RecalcService: ${e} done; ${t}`),"UnitExperiment"===e&&y.ulsLogger.ULS.traceTag(538567681,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,`calc.calc.RecalcService: UnitExperiment done: ${t}`)}logAllFailureStats(){const e=this.nameFailures;this.nameFailures=[];const t=this.rangeFailures;this.rangeFailures=[];const r=this.numberFormatFailures;this.numberFormatFailures=[];const n=this.printFormulaFailures;this.printFormulaFailures=[];const i=this.inferFormatFailures;this.inferFormatFailures=[];const o=this.formatValueFailures;this.formatValueFailures=[];const s=this.unhandledFailures;this.unhandledFailures=[],this.logGenFailureStats(e,595194337,"name",a.TraceLevel.Info),this.logCellFailureStats(t,595658722,"range",a.TraceLevel.Info),this.logGenFailureStats(r,590484946,"format",a.TraceLevel.Info),this.logGenFailureStats(n,592730065,"print-formula",a.TraceLevel.Info),this.logGenFailureStats(i,590484947,"infer-format",a.TraceLevel.Info),this.logCellFailureStats(o,590484948,"format-value",a.TraceLevel.Info),this.logGenFailureStats(s,595194338,"unhandled",a.TraceLevel.Warning)}logGenFailureStats(e,t,r,n){if(0===e.length)return;const i={};for(const{reason:t}of e)(0,_.incrementFailure)(i,t);const o=`calc.calc.RecalcService: recalc ${r} failures; stateId = ${this.currentOutputStateId}, stats = ${JSON.stringify(i)}`;y.ulsLogger.ULS.traceTag(t,a.LogCategory.msoulscat_ES_EWAJS,n,o),this.logJavaScriptFailures(e,r)}logCellFailureStats(e,t,r,n){var i;if(0===e.length)return;const o={};for(const{reason:t,cellKind:r}of e){const e=null!==(i=o[r])&&void 0!==i?i:o[r]={};(0,_.incrementFailure)(e,t)}Object.getOwnPropertyNames(o).sort().forEach((e=>{const i=o[e],s=`calc.calc.RecalcService: recalc ${r} failures; stateId = ${this.currentOutputStateId}, cell kind = ${e}, stats = ${JSON.stringify(i)}`;y.ulsLogger.ULS.traceTag(t,a.LogCategory.msoulscat_ES_EWAJS,n,s)})),this.logJavaScriptFailures(e,r)}logJavaScriptFailures(e,t){for(const{reason:r}of e)if(r.kind===F.ReasonKind.JavaScriptError){const e=`calc.calc.RecalcService: recalc ${t} JavaScript error: ${(0,E.messageFromError)(r.error)}`;y.ulsLogger.ULS.traceTag(595658721,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,e)}}logIgnoredStats(e,t,r,n){if(0===Object.getOwnPropertyNames(n).length)return;const i=`calc.calc.RecalcService: ignored ${r} data; stateId = ${t}, stats = ${JSON.stringify(n)}`;y.ulsLogger.ULS.traceTag(e,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,i)}logIgnoredInputStats(){this.logIgnoredStats(595658723,this.currentInputStateId,"input",this.ignoredInputStats),this.ignoredInputStats={}}logIgnoredOutputStats(){this.logIgnoredStats(595658752,this.currentOutputStateId,"output",this.ignoredOutputStats),this.ignoredOutputStats={}}logRecalcStats(){if(this.currentOutputStateId===-1/0)return;if(this.lastRecalcStatsStateId===this.currentOutputStateId&&this.recalcStatistics===p.emptyRecalcStatistics)return;const e=this.recalcStatistics;this.recalcStatistics=p.emptyRecalcStatistics,this.lastRecalcStatsStateId=this.currentOutputStateId;const t=this.config.sampleRecalcStatisticsRate;if(!this.dataModel.shouldSample(t))return;const r=`calc.calc.RecalcService: recalc statistics; stateId = ${this.currentOutputStateId}, stats = ${JSON.stringify(e)}, p = ${JSON.stringify(t)}`;y.ulsLogger.ULS.traceTag(595654593,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,r)}logUnavailableStats(){if(this.currentOutputStateId===-1/0)return;if(0===this.rangeFailures.length)return;const e=(0,k.computeUnavailableCellsStats)(this.rangeFailures);if(0===e.numOfUnavailableCellsInTheSameSheet&&0===e.numOfUnavailableCellsInDifferentSheet&&0===e.totalNumOfUnavailableCells)return;const t=`calc.calc.RecalcService: unavailable cells statistics; stateId = ${this.currentOutputStateId}, stats = ${JSON.stringify(e)}`;y.ulsLogger.ULS.traceTag(589632004,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,t)}logWorkbookStats(e,t,r){const n=`calc.calc.RecalcService: workbook statistics; stateId = ${e}, stats = ${JSON.stringify(t)}, p = ${JSON.stringify(r)}`;y.ulsLogger.ULS.traceTag(595359882,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,n)}logInputStateIdDecrease(e){(0,R.incrementStat)(this.ignoredInputStats,`${e}: input stateId went backwards`)}logOutputStateIdDecrease(){(0,R.incrementStat)(this.ignoredOutputStats,"output stateId went backwards")}flushInputLogs(){this.logIgnoredInputStats()}flushOutputLogs(){this.logUnavailableStats(),this.logAllFailureStats(),this.logIgnoredOutputStats(),this.logRecalcStats()}cellWriteToRangeDelta(e,t,r,n,i,o,a,l,u){if(!(0,R.check)(n,R.chReadOper,this.ignoredOutputStats,u))return;const d=(0,O.readOperToCellValue)(this.mathpack,n),m=(0,O.cellFormatToInferredFormat)(i);return(0,s.isDefined)(o)||(0,s.isDefined)(d)||(0,s.isDefined)(m)||(0,s.isDefined)(a)||(0,s.isDefined)(l)?(0,c.rangeDelta)((0,c.sheetRangeLocation)(e,t,r),(0,c.cellDataDelta)(o,d,m,a,l)):void 0}rangeWriteToRangeDeltas(e,t,r,n,i,o,a){const l=`${a}.<index>.<index>`,{row:u,col:c,rows:d,cols:m}=t,g=[];for(let t=0;t<d;t+=1)for(let a=0;a<m;a+=1){const d=this.cellWriteToRangeDelta(e,u+t,c+a,r[t][a],n[t][a],0===t&&0===a?i:void 0,o[t][a],void 0,l);(0,s.isDefined)(d)&&g.push(d)}return g}rangeFailure(e,t){return(0,c.rangeFailure)((0,O.sheetGridRangeToLocation)(e),L(t))}setA1ReferenceStyle(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setA1ReferenceStyle(this.dataModel,this.currentInputStateId,e)}setLocale(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setLocaleInfo(this.dataModel,this.currentInputStateId,e,this.ignoredInputStats)}setWorkbookProps(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setWorkbookProps(this.dataModel,this.currentInputStateId,e,this.ignoredInputStats)}setNumberFormats(e,t){this.clearAsyncResumeRecalc(),this.dataModel.setNumberFormats(this.document,(0,R.filterCheck)(e,R.chNumberFormat,this.ignoredInputStats,"numberFormats"),t,this.currentInputStateId)}updateSheetNames(e,t){this.setInputStateId(e,"sheetNames")&&(this.clearAsyncResumeRecalc(),this.dataTransformer.updateSheetNames(this.dataModel,e,t,this.ignoredInputStats))}updateNamedObjects(e,t){this.setInputStateId(e,"namedObjectsUpdates")&&(this.clearAsyncResumeRecalc(),this.dataTransformer.updateNamedObjects(this.dataModel,e,t,this.ignoredInputStats))}updateUnusedCells(e,t){if(!this.setInputStateId(e,"unusedCellsUpdates"))return;this.clearAsyncResumeRecalc();const r=(0,R.filterCheck)(t,R.chUnusedCellsUpdate,this.ignoredInputStats,"unusedCellsUpdates");for(const t of r)this.dataModel.extendUnusedRange((0,O.unusedCellsUpdateToUsedRange)(this.document,t),e)}updateRanges(e,t){this.setInputStateId(e,"rangeUpdates")&&(this.clearAsyncResumeRecalc(),this.applyRangeUpdates(e,t))}updateArrays(e,t){if(!this.setInputStateId(e,"arrayUpdates"))return;this.clearAsyncResumeRecalc();const r=(0,R.filterCheck)(t,R.chArrayUpdate,this.ignoredInputStats,"arrayUpdates");for(const t of r){const{range:r,data:n,fromStateId:i}=t,o=(0,O.sheetRangeLocationToGridRange)(this.document,r);if((0,s.isDefined)(n)){const{formulaBarText:t,isSpilled:r}=n,i=(0,f.gridRangeAnchor)(o.range);this.dataModel.writeArrayFormula(e,o,t,i,r)}else(0,s.isDefined)(i)}}editRangeFormulas(e,t){this.setInputStateId(e,"rangeFormulaEdits")&&(this.clearAsyncResumeRecalc(),this.applyRangeFormulaEdits(t,e))}evalOnClonedModel(e,t,r){return this.evalOnClonedModelOnSnapshot(e,t,void 0,r)}evalOnClonedModelOnSnapshot(e,t,r=void 0,n){(0,y.assertPositiveInteger)("edits array should not be empty",t.length);const i=void 0===r?new m.EvalOnClonePropsFromPartialWB(this.dataModel,n):new m.EvalOnClonePropsFromPartialWBDocumentCollection(r,n);return this.applyRangeUpdates(-1,e,i),this.applyRangeFormulaEdits(t,-1,i),i.resultsPromise.toPromise()}applyRangeUpdates(e,t,r){var n,i;const o=(0,R.filterCheck)(t,R.chRangeUpdate,this.ignoredInputStats,"rangeUpdates");for(const t of o){const{range:o,excludeRows:a,excludeColumns:l,data:u,fromStateId:c}=t,m=(0,O.sheetRangeLocationToGridRange)(this.document,o),S=m.range,v=(0,O.createExcludeCellSet)(S.row,S.rows,d.bspFactory.row,a),F=(0,O.createExcludeCellSet)(S.col,S.cols,d.bspFactory.col,l),C=(0,O.sheetGridRangeToCellSet)(m,v,F),R=(0,s.isDefined)(u)?(0,O.cellValueToReadOper)(this.mathpack,u.value):h.blankOper;(0,y.assertTrue)("calc.calc.RecalcService: updateRanges oper",null!=R);const b=(0,f.gridRangeAnchor)(S);if((0,s.isDefined)(u)){const t=u.iformat,o="ArrayFormula"===u.kind?void 0:null!==(n=u.formulaBarText)&&void 0!==n?n:void 0,a=null!==(i=u.failureReason)&&void 0!==i?i:void 0,s="CellFormula"===u.kind;this.dataModel.writeCellContents(e,C,o,s,b,R,t,p.SpecialStyle.Blank,a,r)}else if((0,s.isNone)(c))this.dataModel.writeCellContents(e,C,"",!1,b,h.blankOper,g.blankCellFormat,void 0,void 0,r);else{if(r)throw new Error("Promote cell data is unsupported for cloned models.");this.dataModel.promoteCellContents(e,m,C,c)}r||(this.dataModel.writeHiddenRows(e,(0,O.sheetGridRangeToHiddenRows)(m,v)),this.dataModel.writeHiddenCols(e,(0,O.sheetGridRangeToHiddenCols)(m,F)))}}localizeEnglishFormula(e,t){const r=this.dataModel.translateEnglishFormula(e,(0,O.sheetCellLocationToGridCell)(this.document,t));return Promise.resolve(r)}applyRangeFormulaEdits(e,t,r){const n=(0,R.filterCheck)(e,R.chRangeFormulaEdit,this.ignoredInputStats,"rangeFormulaEdits");for(const e of n){const{kind:n,range:i,formulaBarText:o,value:a,origin:l,viewport:c}=e;let m=S.empty;i.forEach((e=>{m=(0,v.unionProduct)(m,(0,d.createCellSetFromRange)((0,O.sheetRangeLocationToGridRange)(this.document,e).range))}));const g=(0,O.sheetRangeLocationToGridRange)(this.document,i[0]),h=(0,s.isDefined)(l)?(0,u.gridCell)(l.row,l.column):(0,f.gridRangeAnchor)(g.range),F=(0,s.isDefined)(c)?(0,O.sheetRangeLocationToGridRange)(this.document,c):void 0;let C;(0,s.isDefined)(a)?(C=(0,O.cellValueToReadOper)(this.mathpack,a),(0,y.assertTrue)("calc.calc.RecalcService: editRangeFormulas oper",null!=C)):C=void 0;const R="CellFormula"===n||"Value"!==n&&void 0;r?this.dataModel.editCellContentsOnClone((0,p.sheetCellSet)(g.sheet,m),o,R,h,r):this.dataModel.editCellContents(t,(0,p.sheetCellSet)(g.sheet,m),o,R,h,C,F)}}editRangeFormats(e,t){if(!this.setInputStateId(e,"rangeFormatEdits"))return;this.clearAsyncResumeRecalc();const r=(0,R.filterCheck)(t,R.chRangeFormatEdit,this.ignoredInputStats,"rangeFormatEdits");for(const t of r){const{range:r,operation:n,origin:i,viewport:o}=t,a="SetFormat"!==n.kind||(0,s.isNone)(n.format)?"RibbonFormat"!==n.kind||(0,s.isNone)(n.ribbon)?"ChangeDecimals"!==n.kind||(0,s.isNone)(n.changeDecimals)?void 0:{kind:n.kind,changeDecimals:n.changeDecimals}:{kind:n.kind,ribbon:n.ribbon}:{kind:n.kind,format:n.format};(0,y.assertTrue)("calc.calc.RecalcService: editRangeFormats operation",null!=a);let l=S.empty;r.forEach((e=>{l=(0,v.unionProduct)(l,(0,d.createCellSetFromRange)((0,O.sheetRangeLocationToGridRange)(this.document,e).range))}));const c=(0,O.sheetRangeLocationToGridRange)(this.document,r[0]),m=null!=i?(0,u.gridCell)(i.row,i.column):(0,f.gridRangeAnchor)(c.range),g=(0,s.isDefined)(o)?(0,O.sheetRangeLocationToGridRange)(this.document,o):void 0;this.dataModel.editCellFormats(e,(0,p.sheetCellSet)(c.sheet,l),a,m,g)}}editArrayFormulas(e,t){if(!this.setInputStateId(e,"arrayFormulaEdits"))return;this.clearAsyncResumeRecalc();const r=(0,R.filterCheck)(t,R.chArrayFormulaEdit,this.ignoredInputStats,"arrayFormulaEdits");for(const t of r){const{range:r,formulaBarText:n,origin:i,viewport:o}=t,a=(0,O.sheetRangeLocationToGridRange)(this.document,r),l=(0,s.isDefined)(i)?(0,u.gridCell)(i.row,i.column):(0,u.gridCell)(r.row,r.column),c=(0,s.isDefined)(o)?(0,O.sheetRangeLocationToGridRange)(this.document,o):void 0;this.dataModel.editArrayFormula(e,a,n,l,c)}}editRangePaste(e,t){if(!this.setInputStateId(e,"editRangePaste"))return;this.clearAsyncResumeRecalc();const r=(0,R.filterCheck)(t,R.chPasteEdit,this.ignoredInputStats,"pasteEdits");for(const t of r){const{kind:r,source:n,target:i,viewport:o}=t,a=(0,O.sheetRangeLocationToGridRange)(this.document,n),l=(0,O.sheetCellLocationToGridCell)(this.document,i),u=(0,s.isDefined)(o)?(0,O.sheetRangeLocationToGridRange)(this.document,o):void 0;this.dataModel.editPaste(e,r,l,a,u)}}setConfig(e){var t,r,n,i,o,a,s,l,c,d,m,g;const p=Array.isArray(e.runExperiments)?{stepBudget:null!==(t=e.experimentStepBudget)&&void 0!==t?t:10,totalBudget:null!==(r=e.experimentTotalBudget)&&void 0!==r?r:1e4,factories:(0,T.getExperimentFactories)(e.runExperiments)}:void 0;this.config={yieldIntervalMs:10,totalTimeMs:null!==(n=e.totalEvalTimeMs)&&void 0!==n?n:1e4,maxCellChain:2*u.sheetCols,maxNameChain:128,maxLambdaCalls:1e4,maxLambdaDepth:1e3,samplePrecisionEvalRate:null!==(i=e.samplePrecisionEvalRate)&&void 0!==i?i:.02,samplePrecisionPrintFormulaRate:null!==(o=e.samplePrecisionPrintFormulaRate)&&void 0!==o?o:.001,samplePrecisionPrintValueRate:null!==(a=e.samplePrecisionPrintValueRate)&&void 0!==a?a:1e-4,sampleRecalcStatisticsRate:null!==(s=e.sampleRecalcStatisticsRate)&&void 0!==s?s:.2,sampleWorkbookStatisticsRate:null!==(l=e.sampleWorkbookStatisticsRate)&&void 0!==l?l:.1,sampleCellEvalStopwatchRate:null!==(c=e.sampleCellEvalStopwatchRate)&&void 0!==c?c:.003,sampleRecalcEditedStopwatchRate:null!==(d=e.sampleRecalcEditedStopwatchRate)&&void 0!==d?d:1,sampleRecalcViewportStopwatchRate:null!==(m=e.sampleRecalcViewportStopwatchRate)&&void 0!==m?m:1,rngSeed:null!==(g=e.rngSeed)&&void 0!==g?g:1e3*Date.now(),volatileMode:null!=e.volatileMode?M.VolatileMode[e.volatileMode]:M.VolatileMode.Estimation,experimentFactories:p}}reconfigure(e){this.setConfig(e),this.dataModel.reconfigure(this.config)}clearCache(){this.clearAsyncResumeRecalc(),this.dataModel=new m.PartialWorkbook(this.dataTransformer.getLangConfig(),this.config),this.recalcStatistics=p.emptyRecalcStatistics,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.currentInputStateId=this.currentOutputStateId=this.lastRecalcStatsStateId=-1/0}evalFormula(e,t,r,n){return(0,R.check)(r,R.chSheetCellLocation,this.ignoredInputStats,"origin")?(0,R.check)(n,R.chEvalFormulaFormat,this.ignoredInputStats,"format")?this.dataModel.evalFormula(e,t,(0,O.sheetCellLocationToGridCell)(this.document,r),(0,O.evalFormulaFormatToUnion)(n)).then((({value:e,formatted:t})=>{let r,n;if((0,P.isSuccess)(e)){if(!(0,R.check)(e.value,R.chReadOper,this.ignoredOutputStats,"evalFormula"))throw new Error("ignored output");const t=(0,O.readOperToCellValue)(this.mathpack,e.value);(0,y.assertTrue)("calc.calc.RecalcService.evalFormula",void 0!==t),r=(0,P.success)(t)}else r=(0,P.failure)(L(e.reason));return n=void 0===t?void 0:(0,P.isSuccess)(t)?t:(0,P.failure)(L(t.reason)),(0,c.evalFormulaData)(r,n)})):Promise.reject(new Error("ignored format")):Promise.reject(new Error("ignored input"))}evalFormulaOnSnapshotImpl(e,t,r,n){return this.dataModel.evalFormula(-1,e,t,r,n)}testAdvanceState(e){this.setInputStateId(e,"testAdvanceState")&&(this.dataModel.testAdvanceState(e),this.clearAsyncResumeRecalc())}getMissingJSFeatures(){return(0,I.getMissingJSFeatures)()}constructor(e,t,r,n,o,a={},s="Local"){this.onRecalcResults=e,this.onUpdateRequest=t,this.onGC=r,this.onAlert=n,this.asyncLoopFactory=o,this.twConfig=a,this.dataTransformer=new _.RecalcServiceDataTransformer,this.currentInputStateId=-1/0,this.currentOutputStateId=-1/0,this.lastRecalcStatsStateId=-1/0,this.recalcStatistics=p.emptyRecalcStatistics,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.printFormulaFailures=[],this.inferFormatFailures=[],this.formatValueFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.initCalcThreadInside=(e,t,r)=>i.__awaiter(this,void 0,void 0,(function*(){return(0,l.initCalcInThread)(e,t,r,this.twConfig)})),this.setConfig({}),this.dataModel=new m.PartialWorkbook(this.dataTransformer.getLangConfig(),this.config)}}t.RecalcServiceImpl=x;const K=(0,A.mixin)(x,(e=>new D.RecalcSideGrid(e)),["getSheetNames","getRangeValues","getRangeFormats","getRangeFormulae","getIntersectingTables","getIformats","discardSnapshot","createIGridExportEndpoint","getHiddenRows","getHiddenCols","evalFormulaOnSnapshot","evalClonedModelOnSnapshot","getCorrespondingSnapshotID"]);if((0,N.getTypedFeatureGate)("TESTING_ONLY_RECALC_SERVICE_IMPORTSCRIPTS_FAIL")&&(self.__retries=(null!==(n=self.__retries)&&void 0!==n?n:-1)+1,0===self.__retries))throw"";t.recalcServiceInsideInit=({config:e,connection:t})=>o.Endpoint.createInside(t,(r=>new K(((...e)=>r.post.onRecalcResults(...e)),((...e)=>r.post.onUpdateRequest(...e)),((...e)=>r.post.onGC(...e)),((...e)=>r.post.onAlert(...e)),C.asyncLoop,e,t.createMode)))},77806:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createRecalcService=void 0;const n=r(19181),i=n.__importStar(r(66932)),o=r(43512),a=r(57264),s=r(17338),l=r(91709),u=r(28196),c=r(12450),d=r(59416),m=r(85304),g=r(93087),p=r(37610);t.createRecalcService=function(e,...[t,r]){return n.__awaiter(this,void 0,void 0,(function*(){const[h,f]="boolean"==typeof t?t?[(new d.PluginSchedulerSingleton).instance(),(new d.GridImportManagerSingleton).instance()]:[void 0,void 0]:[t,r];let S=-1/0,v=!1;const y={onRecalcResults(e){},onUpdateRequest(e){},onGC(e){S=e},onAlert(e){if(v)return;const t=document.createElement("div"),r=document.createElement("p");r.textContent=e,t.appendChild(r);const n=document.createElement("button");n.textContent="OK",t.appendChild(n),t.setAttribute("style","position: fixed; top: 0; left: 30%; right: 30%; background: red; color: white; font-size: 16px; font-weight: bold; z-index: 1000; padding: 3em; white-space: pre-line;"),n.onclick=()=>{document.body.removeChild(t)},document.body.appendChild(t),v=!0}},F=yield i.createWorker({id:"RecalcService",createMode:e},{local:s.recalcServiceInsideInit,thread:{scriptUrl:(0,g.getCalcAbsUrlOrThrow)(),insideInitName:"excelOnlineCalc.calc.recalcServiceInsideInit"}},(()=>y)),C=[];let R="Requested";function b(e="Requested"){R=e,F.close()}F.onClose=()=>{for(const e of C)try{e()}catch(e){a.ulsLogger.ULS.traceTag(539341771,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`calc.calc.createRecalcService.service.onClose: callback threw ${(0,l.messageFromError)(e)}`)}const e=`calc.calc.createRecalcService.service.onClose: recalc service closed; reason = ${R}`;a.ulsLogger.ULS.traceTag(561534148,o.LogCategory.msoulscat_ES_EWAJS,"Requested"===R?o.TraceLevel.Info:o.TraceLevel.Warning,e)};try{if("Thread"===F.createMode){const e=yield(0,g.initCalcThread)(F);C.push((()=>e.close())),(0,p.logMissingJSFeatures)(F.call.getMissingJSFeatures)}F.call.ping.callTimeout=3e4;let e=3,t=0,r=()=>{};(0,u.promiseLoop)((()=>n.__awaiter(this,void 0,void 0,(function*(){if(yield new Promise((e=>setTimeout(e,1e3))),F.hasBeenClosed())return;const n=F.call.ping.callTimeout,s=(0,c.now)();try{yield F.call.ping()}catch(l){if(!i.WorkerError.isWorkerError(l)||"Timeout"!==l.info.cause)throw l;const u=(0,c.now)()-s;t+=1,t>=e&&b("Unresponsive");const d=F.hasBeenClosed(),m={timeout:n,waitTime:u,timeoutCount:t,hasBeenClosed:d},g=`calc.calc.RecalcService: unresponsive; ${JSON.stringify(m)}`;return a.ulsLogger.ULS.traceTag(561534149,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,g),r(n,u,t,d),!0}return t=0,!0}))),!0).catch((e=>{const t=`calc.calc.RecalcService: ping loop threw an error: ${(0,l.messageFromError)(e)}`;a.ulsLogger.ULS.traceTag(561534150,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,t)})),F.post.updateRanges.onPostMessageError=i.dispatchWorkerError;const s={setOnRecalcResults(e){y.onRecalcResults=e},setOnUpdateRequest(e){y.onUpdateRequest=e},setOnUnresponsive(e){r=e},setA1ReferenceStyle(...e){F.post.setA1ReferenceStyle(...e),void 0!==h&&h.doNotify(m.NotificationKind.setA1ReferenceStyle,e)},setLocale(...e){F.post.setLocale(...e),void 0!==h&&h.doNotify(m.NotificationKind.setLocale,e)},setWorkbookProps(...e){F.post.setWorkbookProps(...e),void 0!==h&&h.doNotify(m.NotificationKind.setWorkbookProps,e)},updateSheetNames(...e){F.post.updateSheetNames(...e),void 0!==h&&h.doNotify(m.NotificationKind.updateSheetNames,e)},updateNamedObjects(...e){F.post.updateNamedObjects(...e),void 0!==h&&h.doNotify(m.NotificationKind.updateNamedObjects,e)},setNumberFormats:F.post.setNumberFormats,updateUnusedCells:F.post.updateUnusedCells,updateRanges:F.post.updateRanges,updateArrays:F.post.updateArrays,editRangeFormulas:F.post.editRangeFormulas,editRangeFormats:F.post.editRangeFormats,editArrayFormulas:F.post.editArrayFormulas,editRangePaste:F.post.editRangePaste,resumeRecalc:F.post.resumeRecalc,reconfigure(t){var r,n;F.call.ping.callTimeout=null!==(r=t.responsivenessPingTimeout)&&void 0!==r?r:3e4,e=null!==(n=t.responsivenessPingAttempts)&&void 0!==n?n:3,F.post.reconfigure(t)},clearCache(){F.post.clearCache(),S=-1/0},testAdvanceState:F.post.testAdvanceState,testResumeRecalc:F.call.testResumeRecalc,close:b,stateIdAvailable:e=>e>=S,evalFormula:F.call.evalFormula,evalOnClonedModel:F.call.evalOnClonedModel,localizeEnglishFormula:(...e)=>F.call.localizeEnglishFormula(...e),createIGridExportEndpoint:(e,t)=>(C.push(t),F.call.createIGridExportEndpoint.transfer([e.port],e))};return void 0!==f&&f.onGridExporterCreated(s),s}catch(e){throw b("Error"),e}}))}},47324:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.chNamedRangeData=t.chNamedFormulaData=t.chNamedValueData=t.chNamedValue=t.chUnusedCellsUpdate=t.chArrayUpdate=t.chArrayData=t.chRangeUpdate=t.chCellData=t.chCellFormat=t.chCellValue=t.chError=t.chBlank=t.chSheetCellLocation=t.chSheetRangeLocation=t.chRangeLocation=t.chCellLocation=t.chCol=t.chRow=t.chSheetName=t.chSheetId=t.chNumberFormat=t.chErrorTypeName=t.chWorksheetFunctionName=t.chFormulaText=t.isFormulaText=t.oneOfChecker=t.eqChecker=t.chArray=t.chBoolean=t.chNonemptyString=t.chString=t.chNatural=t.chInteger=t.chFiniteNumber=t.chPossiblyInfiniteNumber=t.chNever=t.intChecker=t.typeofChecker=t.taggedUnionChecker=t.arrayChecker=t.depAllChecker=t.allChecker=t.objectChecker=t.fromChecker=t.optChecker=t.filterCheck=t.check=t.checker=t.incrementStat=void 0,t.chReadOper=t.chEvalFormulaFormat=t.chWorkbookProps=t.chLocaleData=t.chPasteEdit=t.chArrayFormulaEdit=t.chRangeFormatEdit=t.chRangeFormulaEdit=t.chNamedObjectsUpdate=t.chNamedObject=t.chNamedObjectData=t.chNamedFailureData=t.chNamedTableScope=t.chNamedTableData=t.chColumnData=void 0;const n=r(12450),i=r(12450),o=r(73693),a=r(7793),s=r(71273),l=r(55340),u=r(71510),c=r(91709),d=r(25856);function m(e,t){var r;e[t]=(null!==(r=e[t])&&void 0!==r?r:0)+1}function g(e,t,r){return e.push(`${t.join(".")}: expected ${r}`),!1}function p(e,t){return(r,n,o)=>(0,i.isDefined)(r)&&e(r)||g(n,o,t)}function h(e,t,r,n){const i=[],o=t(e,i,[n]);for(const e of i)m(r,e);return o}function f(e){return(t,r,n)=>!!(0,i.isNone)(t)||e(t,r,n)}function S(e){return(t,r,n)=>{if((0,i.isNone)(t))return g(r,n,"non-null object");const o=n.length;try{let i=!0;for(const a in e)n[o]=a,i=i&&e[a](t[a],r,n);return i}finally{n.length=o}}}function v(...e){return(t,r,n)=>e.reduce(((e,i)=>e&&i(t,r,n)),!0)}function y(e,...t){return(r,n,i)=>t.reduce(((e,t)=>e&&t(r)(r,n,i)),e(r,n,i))}function F(e){return(t,r,n)=>{if(!Array.isArray(t))return g(r,n,"Array");n.push("<index>");try{return t.reduce(((t,i)=>t&&e(i,r,n)),!0)}finally{n.pop()}}}function C(e){const t=`one of ${JSON.stringify(Object.getOwnPropertyNames(e).sort())}`;return(r,n,o)=>{if((0,i.isNone)(r))return g(n,o,"non-null object");const a=o.length;try{const a="string"==typeof r.kind||"number"==typeof r.kind?e[r.kind]:void 0;return(0,i.isNone)(a)?(o.push("kind"),g(n,o,t)):a(r,n,o)}finally{o.length=a}}}function R(e){const t=`typeof one of ${JSON.stringify(Object.getOwnPropertyNames(e).sort())}`;return(r,n,o)=>{const a=e[typeof r];return(0,i.isNone)(a)?g(n,o,t):a(r,n,o)}}function b(e){return"number"==typeof e&&e>-1/0&&e<1/0}function E(e){return(0|e)===e||Math.floor(e)===e}function T(e,t,r=(0!==e?`integer >= ${e} and < ${t}`:`natural < ${t}`)){return p((r=>"number"==typeof r&&r>=e&&r<t&&E(r)),r)}function k(e){return p((t=>t===e),JSON.stringify(e))}function P(...e){const t=Object.create(null),r=Object.create(null);for(const n of e)"number"==typeof n?r[n]=!0:t[n]=!0;return p((e=>{switch(typeof e){case"string":case"symbol":return!0===t[e];case"number":return!0===r[e]}return!1}),`one of ${JSON.stringify(e.slice().sort())}`)}function N(e){return"="===e[0]||"+"===e[0]||"-"===e[0]}t.incrementStat=m,t.checker=p,t.check=h,t.filterCheck=function(e,r,n,i){if(!h(e,t.chArray,n,i))return[];const o=`${i}.<index>`;return e.filter((e=>h(e,r,n,o)))},t.optChecker=f,t.fromChecker=function(e){return(t,r,n)=>e(t,r,n)},t.objectChecker=S,t.allChecker=v,t.depAllChecker=y,t.arrayChecker=F,t.taggedUnionChecker=C,t.typeofChecker=R,t.intChecker=T,t.chNever=p((e=>!1),"never"),t.chPossiblyInfiniteNumber=p((function(e){return"number"==typeof e&&!isNaN(e)}),"number (non-NaN)"),t.chFiniteNumber=p(b,"finite number"),t.chInteger=p((e=>b(e)&&E(e)),"integer"),t.chNatural=T(0,1/0,"natural"),t.chString=p((e=>"string"==typeof e),"string"),t.chNonemptyString=p((e=>"string"==typeof e&&e.length>0),"nonempty string"),t.chBoolean=p((e=>"boolean"==typeof e),"boolean"),t.chArray=p((e=>Array.isArray(e)),"Array"),t.eqChecker=k,t.oneOfChecker=P,t.isFormulaText=N,t.chFormulaText=p((e=>"string"==typeof e&&N(e)),"formula text"),t.chWorksheetFunctionName=S({functionId:t.chNatural,functionName:t.chNonemptyString});const A=p((e=>"string"==typeof e&&e.length>1&&(0,c.stringStartsWith)(e,"#")),"error name");t.chErrorTypeName=S({errorType:t.chNatural,errorName:A}),t.chNumberFormat=S({iformat:t.chNatural,formatString:t.chString,builtIn:t.chBoolean}),t.chSheetId=p((e=>"string"==typeof e||b(e)),"string or finite number"),t.chSheetName=S({sheetId:t.chSheetId,sheetName:t.chString}),t.chRow=T(0,a.sheetRows),t.chCol=T(0,a.sheetCols),t.chCellLocation=S({row:t.chRow,column:t.chCol});const I=p((e=>null==e.lastRow||e.lastRow>=e.row),"lastRow >= row"),O=p((e=>null==e.lastColumn||e.lastColumn>=e.column),"lastColumn >= column"),_=v(t.chCellLocation,S({lastRow:f(t.chRow),lastColumn:f(t.chCol)}));t.chRangeLocation=y(_,(e=>I),(e=>O)),t.chSheetRangeLocation=v(t.chRangeLocation,S({sheetId:t.chSheetId})),t.chSheetCellLocation=v(t.chSheetRangeLocation,S({lastRow:f(t.chNever),lastColumn:f(t.chNever)})),t.chBlank=S({kind:k("Blank")}),t.chError=S({kind:k("Error"),type:t.chNatural}),t.chCellValue=R({number:t.chFiniteNumber,string:t.chString,boolean:t.chBoolean,object:C({Blank:t.chBlank,Error:t.chError})}),t.chCellFormat=R({number:t.chNatural,string:t.chString}),t.chCellData=v(S({value:t.chCellValue,iformat:t.chNatural,failureReason:f(t.chString)}),C({CellFormula:S({formulaBarText:t.chFormulaText}),ArrayFormula:S({formulaBarText:f(t.chNever)}),Value:S({formulaBarText:t.chString})})),t.chRangeUpdate=S({range:t.chSheetRangeLocation,excludeRows:f(F(t.chRow)),excludeColumns:f(F(t.chCol)),data:f(t.chCellData),fromStateId:f(t.chInteger)}),t.chArrayData=S({isSpilled:t.chBoolean,formulaBarText:t.chFormulaText}),t.chArrayUpdate=S({range:t.chSheetRangeLocation,data:f(t.chArrayData),fromStateId:f(t.chInteger)}),t.chUnusedCellsUpdate=S({sheetId:t.chSheetId,usedRange:f(t.chRangeLocation)}),t.chNamedValue=R({number:t.chFiniteNumber,string:t.chString,boolean:t.chBoolean,object:C({Error:t.chError})}),t.chNamedValueData=S({kind:k("NamedValue"),value:t.chNamedValue}),t.chNamedFormulaData=S({kind:k("NamedFormula"),formulaBarText:t.chFormulaText}),t.chNamedRangeData=S({kind:k("NamedRange"),range:t.chSheetRangeLocation}),t.chColumnData=S({column:t.chNatural,name:t.chNonemptyString});const M=e=>{var t;return(null!==(t=e.lastRow)&&void 0!==t?t:e.row)-e.row+1},D=e=>{var t;return(null!==(t=e.lastColumn)&&void 0!==t?t:e.column)-e.column+1},w=p((e=>(!e.hasHeadersRow||e.range.row>0)&&(!e.hasTotalsRow||e.range.row+M(e.range)<a.sheetRows)),"enough rows for headers and totals"),L=p((e=>{const t=e.range.column,r=e.range.column+D(e.range);return e.columns.every((e=>e.column>=t&&e.column<r))}),"column names in range");t.chNamedTableData=y(S({kind:k("NamedTable"),range:t.chSheetRangeLocation,hasHeadersRow:t.chBoolean,hasTotalsRow:t.chBoolean,columns:F(t.chColumnData)}),(e=>w),(e=>L)),t.chNamedTableScope=e=>p((t=>{var r;return"NamedTable"!==(null===(r=t.data)||void 0===r?void 0:r.kind)||null==e}),"NamedTable at global scope"),t.chNamedFailureData=S({kind:k("NamedFailure"),failureReason:t.chString,objectKind:f(P("NamedValue","NamedFormula","NamedRange","NamedTable"))}),t.chNamedObjectData=C({NamedValue:t.chNamedValueData,NamedFormula:t.chNamedFormulaData,NamedRange:t.chNamedRangeData,NamedTable:t.chNamedTableData,NamedFailure:t.chNamedFailureData});const x=S({name:t.chString,data:f(t.chNamedObjectData)});t.chNamedObject=e=>y(x,(r=>(0,t.chNamedTableScope)(e))),t.chNamedObjectsUpdate=S({scope:f(t.chSheetId),objects:f(t.chArray),fromStateId:f(t.chInteger)});const K=p((e=>e.length>0),"a non-empty array"),U=p((e=>e.every((t=>t.sheetId===e[0].sheetId))),"ranges on the same sheet"),B=y(F(t.chSheetRangeLocation),(e=>K),(e=>U));t.chRangeFormulaEdit=v(S({range:B,origin:f(t.chCellLocation),viewport:f(t.chSheetRangeLocation)}),C({CellFormula:S({formulaBarText:t.chFormulaText,value:f(t.chNever)}),Value:S({formulaBarText:t.chString,value:t.chCellValue}),Inferred:S({formulaBarText:t.chString,value:f(t.chNever)})}));const G=C({SetFormat:S({format:t.chCellFormat}),RibbonFormat:S({ribbon:P(...(0,i.strEnumArray)(d.RibbonFormat))}),ChangeDecimals:S({changeDecimals:T(-20,20)})});t.chRangeFormatEdit=S({range:B,operation:G,origin:f(t.chCellLocation),viewport:f(t.chSheetRangeLocation)}),t.chArrayFormulaEdit=S({range:t.chSheetRangeLocation,formulaBarText:p((e=>"string"==typeof e&&(0===e.length||N(e))),"empty string or text denoting formula"),origin:f(t.chCellLocation),viewport:f(t.chSheetRangeLocation)});const W=p((e=>{const t=D(e.source),r=M(e.source);return e.target.column+t<=a.sheetCols&&e.target.row+r<=a.sheetRows}),"(target,source) in range");t.chPasteEdit=y(S({kind:P("CopyPaste"),target:t.chSheetCellLocation,source:t.chSheetRangeLocation,viewport:f(t.chSheetRangeLocation)}),(e=>W));const V=p((e=>2===e.length),"2 AM/PM symbols"),j=p((e=>7===e.length),"7 day symbols"),q=p((e=>12===e.length),"12 month symbols");function H(e){const t=(0,i.numEnumMap)(e,i.identity);return p((e=>e.every(((e,r)=>null==e||r in t))),"indexes in enum")}const z=H(u.SpecialRefId),$=H(l.PictureSpecial),Q=H(l.PictureSingle),Y=H(l.PictureColor),J=H(l.PictureDbnum);t.chLocaleData=S({worksheetFunctionNames:t.chArray,thousandsData:F(t.chNatural),errorTypeNames:t.chArray,specialRefNames:y(F(f(t.chNonemptyString)),(e=>z)),trueName:t.chNonemptyString,falseName:t.chNonemptyString,rowLetter:t.chNonemptyString,columnLetter:t.chNonemptyString,leftBrace:t.chNonemptyString,rightBrace:t.chNonemptyString,leftBracket:t.chNonemptyString,rightBracket:t.chNonemptyString,decimalSeparator:t.chNonemptyString,listSeparator:t.chNonemptyString,columnSeparator:t.chNonemptyString,rowSeparator:t.chNonemptyString,thousandsSeparator:t.chString,lcid:t.chNatural,country:t.chNatural,numberDecimals:t.chNatural,isExpSepBySpace:t.chBoolean,fractionSeparator:t.chNonemptyString,isPercentSepBySpace:t.chBoolean,currencyFormat:P(s.CurrencyFormat.Paren,s.CurrencyFormat.Lead,s.CurrencyFormat.Intern,s.CurrencyFormat.Trail),isCurrencySymbolLead:t.chBoolean,isCurrencySepBySpace:t.chBoolean,currencySymbol:t.chString,currencyDecimals:t.chNatural,dateOrder:P(s.DateOrder.MDY,s.DateOrder.DMY,s.DateOrder.YMD,s.DateOrder.MYD,s.DateOrder.DYM,s.DateOrder.YDM),dateSeparator:t.chString,dateAltSeparator:t.chString,year4Digits:t.chBoolean,month2Digits:t.chBoolean,day2Digits:t.chBoolean,longDateFormat:t.chBoolean,timeSeparator:t.chString,timeAltSeparator:f(t.chString),hour2Digits:t.chBoolean,clock24Hour:t.chBoolean,isAMPMSepBySpace:t.chBoolean,ampmSymbols:y(F(t.chString),(e=>V)),dayNameShort:y(F(t.chString),(e=>j)),dayNameLong:y(F(t.chString),(e=>j)),monthNameShort:y(F(t.chString),(e=>q)),monthNameLong:y(F(t.chString),(e=>q)),pictureSpecial:y(F(f(t.chNonemptyString)),(e=>$)),pictureSingle:y(F(f(t.chNonemptyString)),(e=>Q)),pictureColor:y(F(f(t.chNonemptyString)),(e=>Y)),pictureDbnum:y(F(f(t.chNonemptyString)),(e=>J)),sysDateFormat:t.chString,sysTimeFormat:t.chString});const X=S({yr:t.chInteger,mon:T(1,13),dom:T(1,6),wdy:T(1,8),hour:T(0,24),min:T(0,60),sec:T(0,60),fracSec:k(0),rounding:T(0,4)}),Z=y(S({bias:t.chFiniteNumber,standardDate:f(X),standardBias:t.chFiniteNumber,daylightDate:f(X),daylightBias:t.chFiniteNumber}),(e=>p((e=>(0,i.isNone)(e.standardDate)===(0,i.isNone)(e.daylightDate)),"standardDate iff daylightDate")));t.chWorkbookProps=S({date1904:f(t.chBoolean),dateCompatibility:f(t.chBoolean),timezone:f(Z)}),t.chEvalFormulaFormat=f(C({Origin:S({iformat:f(t.chNever),knownFormat:f(t.chNever)}),Iformat:S({iformat:t.chNatural,knownFormat:f(t.chNever)}),Known:S({iformat:f(t.chNever),knownFormat:P(...(0,n.numEnumArray)(s.KnownFormat))}),Inferred:S({iformat:f(t.chNever),knownFormat:f(t.chNever)}),Aggregate:S({iformat:f(t.chNever),knownFormat:f(t.chNever)})}));const ee={[o.OperKind.Number]:!0,[o.OperKind.String]:!0,[o.OperKind.Boolean]:!0,[o.OperKind.Error]:!0,[o.OperKind.Array]:!1,[o.OperKind.Blank]:!0,[o.OperKind.Rich]:!1};t.chReadOper=p((e=>ee[e.kind]),"supported ReadOper")},23623:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.incrementFailure=t.RecalcServiceDataTransformer=t.initialRecalcServiceConfig=void 0;const n=r(7793),i=r(12450),o=r(55340),a=r(47324),s=r(47324),l=r(58293),u=r(71510),c=r(77497),d=r(16811),m=r(88928),g=r(96547),p=r(94591),h=r(53750),f=r(57264);t.initialRecalcServiceConfig={localeInfo:(0,o.getEnglishLocaleInfo)(),mathpack:c.xlMathpack,refStyle:u.RefStyle.A1,timezone:d.tzUTC,date1904:!1,dateCompatibility:!0,datepack:d.xlDatepack},t.RecalcServiceDataTransformer=class{getLangConfig(){return this.langConfig}setA1ReferenceStyle(e,t,r){this.langConfig=Object.assign(Object.assign({},this.langConfig),{refStyle:r?u.RefStyle.A1:u.RefStyle.R1C1}),e.setLangConfig(t,this.langConfig)}setLocaleInfo(e,t,r,n){(0,s.check)(r,s.chLocaleData,n,"localeData")&&(this.langConfig=Object.assign(Object.assign({},this.langConfig),{localeInfo:(0,l.createLocaleInfo)(r,n)}),e.setLangConfig(t,this.langConfig))}setWorkbookProps(e,r,n,i){var o,a,l;(0,s.check)(n,s.chWorkbookProps,i,"workbookProps")&&(this.langConfig=Object.assign(Object.assign({},this.langConfig),{date1904:null!==(o=n.date1904)&&void 0!==o?o:t.initialRecalcServiceConfig.date1904,dateCompatibility:null!==(a=n.dateCompatibility)&&void 0!==a?a:t.initialRecalcServiceConfig.dateCompatibility,timezone:null!==(l=n.timezone)&&void 0!==l?l:t.initialRecalcServiceConfig.timezone}),e.setLangConfig(r,this.langConfig))}updateSheetNames(e,t,r,n){e.setSheetNames(this.document,(0,s.filterCheck)(r,s.chSheetName,n,"sheetNames"),t)}updateNamedObjects(e,t,r,o){const a=(0,s.filterCheck)(r,s.chNamedObjectsUpdate,o,"namedObjectsUpdates");for(const r of a){const{scope:a,objects:u,fromStateId:c}=r,d=(0,n.nameScope)(this.document,(0,i.isDefined)(a)?a:void 0);if((0,i.isDefined)(u)){const r=(0,s.filterCheck)(u,(0,s.chNamedObject)(a),o,"namedObjectsUpdates.<index>.objects");for(const n of r){const{name:r,data:i}=n;e.writeNamedObject(t,d,r,(0,l.namedObjectDataToNamedObject)(this.langConfig.mathpack,this.langConfig.localeInfo.stringCompareCI,this.document,i))}}else(0,i.isDefined)(c)?e.promoteNamedObjects(t,d,c):e.writeUndefinedNames(t,d)}}constructor(){this.document=(0,n.documentLoc)(void 0,""),this.langConfig=t.initialRecalcServiceConfig}},t.incrementFailure=function(e,t){var r,n;switch(t.kind){case h.ReasonKind.NotImplemented:for(const r of t.features)(0,a.incrementStat)(e,`${h.ReasonKind.NotImplemented} ${r}`);break;case h.ReasonKind.IllFormedFormula:(0,a.incrementStat)(e,`${h.ReasonKind.IllFormedFormula} ${null!==(r=t.mode)&&void 0!==r?r:""} ${JSON.stringify({diagnostics:null!==(n=t.diagnostics)&&void 0!==n?n:{},message:t.mode===m.FormulaMode.ServerCellFormula||t.mode===m.FormulaMode.ServerNamedFormula?t.message:void 0})}`);break;case h.ReasonKind.Unavailable:for(const r of t.objects){const t=[h.ReasonKind.Unavailable];if("string"==typeof r.kind&&r.kind in m.UnavailableKind){const e=r;switch(t.push(e.kind),e.kind){case m.UnavailableKind.SheetId:t.push(e.sheetId);break;case m.UnavailableKind.NameLoc:t.push(e.source),t.push(void 0===e.name.scope.index?"global":"sheet");break;case m.UnavailableKind.ClientFailure:t.push(e.reason);break;case m.UnavailableKind.CellFormula:case m.UnavailableKind.EvalFailure:t.push(e.reason.kind);break;case m.UnavailableKind.VolatileFunction:t.push(e.name);break;case m.UnavailableKind.TimeGranularity:t.push(d.TimeGranularity[e.granularity]);break;case m.UnavailableKind.GetTimeKind:t.push(e.getTimeKind)}}else t.push(JSON.stringify(r));(0,a.incrementStat)(e,t.join(" "))}break;case h.ReasonKind.LimitExceeded:(0,a.incrementStat)(e,`${t.kind} ${h.LimitKind[t.limit]}`);break;case p.FormatReasonKind.NotFormatString:case p.FormatReasonKind.NotValueString:(0,a.incrementStat)(e,`${t.kind} ${t.message}`);break;case h.ReasonKind.InvalidQualifier:case h.ReasonKind.InvalidCellRef:case h.ReasonKind.InvalidStructRef:(0,a.incrementStat)(e,`${t.kind} ${t.reason}`);break;case h.ReasonKind.Internal:(0,a.incrementStat)(e,`${t.kind} ${t.message}`);break;case h.ReasonKind.JavaScriptError:case g.ReasonKind.NotFormulaString:case h.ReasonKind.CellCycle:case h.ReasonKind.NameCycle:case h.ReasonKind.Stopped:case h.ReasonKind.PreviousFailure:case h.ReasonKind.PreviousNameFailure:case p.FormatReasonKind.PreviousFormatFailure:(0,a.incrementStat)(e,t.kind);break;default:(0,f.assertNever)("calc.calc.incrementFailure",t)}}},68616:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerExperimentFactory=t.getExperimentFactories=t.ExperimentKind=void 0;const n=r(43512),i=r(57264),o=r(12450),a=r(87512),s=r(86344);class l{static create(e){if("number"==typeof e)return new l(e);{const t=`calc.calc.TestExperiment: expected number; given ${e}`;i.ulsLogger.ULS.traceTag(591974878,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,t)}}setContext(){}step(){const e=(0,o.now)();for(;(0,o.now)()<e+this.stepDelay;);this.iters+=1,this.iters>1&&(this.done=!0)}constructor(e){this.stepDelay=e,this.done=!1,this.resultLogMessage="TestExperiment",this.failedLogMessage="TestExperiment exceeded budget",this.iters=0}}var u;!function(e){e.OneShot="OneShot",e.Recurring="Recurring",e.Precision="Precision"}(u||(t.ExperimentKind=u={}));const c={TestExperiment:e=>({experimentName:"TestExperiment",kind:u.OneShot,create:()=>l.create(e)}),ExceLintExperiment:()=>({experimentName:"ExceLintExperiment",kind:u.OneShot,create:()=>new a.ExceLintExperiment}),UnitExperiment:()=>({experimentName:"UnitExperiment",kind:u.OneShot,create:()=>new s.UnitExperiment,stepBudget:80})};t.getExperimentFactories=function(e){return e.map((({name:e,param:t})=>{var r;return null===(r=c[e])||void 0===r?void 0:r.call(c,t)})).filter((e=>void 0!==e))},t.registerExperimentFactory=function(e,t){c[e]=t}},31053:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.copyPasteRangePasteEdit=t.rangePasteEdit=t.arrayFormulaEdit=t.rangeFormatEdit=t.formatEditChangeDecimals=t.formatEditRibbonFormat=t.formatEditSetFormat=t.formatEditOperation=t.RibbonFormat=t.inferredRangeFormulaEdit=t.valueRangeFormulaEdit=t.cellFormulaRangeFormulaEdit=t.rangeFormulaEdit=t.namedObjectsPromote=t.undefinedNamesWrite=t.namedObjectsWrite=t.namedObjectsUpdate=t.namedObject=t.namedFailureData=t.namedTableData=t.columnData=t.namedRangeData=t.namedFormulaData=t.namedValueData=t.unusedCellsUpdate=t.arrayPromote=t.arrayWrite=t.arrayUpdate=t.arrayData=t.rangePromote=t.rangeWrite=t.rangeUpdate=t.valueCellData=t.arrayFormulaCellData=t.cellFormulaCellData=t.cellData=t.sheetCellLocation=t.sheetRangeLocation=t.rangeLocation=t.cellLocation=t.getCellFormatKind=t.getCellValueKind=t.richValue=t.errorValue=t.blankValue=t.sheetName=t.numberFormat=t.localeData=t.errorTypeName=t.worksheetFunctionName=void 0,t.RecalcServiceCreateMode=t.workbookProps=t.recalcServiceConfig=t.runExperiment=t.updateRequest=t.evalFormulaData=t.evalFormulaFormatAggregate=t.evalFormulaFormatInferred=t.evalFormulaFormatKnown=t.evalFormulaFormatIformat=t.evalFormulaFormatOrigin=t.evalFormulaFormat=t.recalcResults=t.rangeFailure=t.arrayDelta=t.rangeDelta=t.cellDataDelta=t.inferredFormat=void 0;const n=r(12450),i=r(25856);var o;Object.defineProperty(t,"RibbonFormat",{enumerable:!0,get:function(){return i.RibbonFormat}}),t.worksheetFunctionName=(0,n.typedInstanceCreator)()(((e,t)=>({functionId:e,functionName:t}))),t.errorTypeName=(0,n.typedInstanceCreator)()(((e,t)=>({errorType:e,errorName:t}))),t.localeData=(0,n.typedInstanceCreator)()(((e,t,r,n,i,o,a,s,l,u,c,d,m,g,p,h,f,S,v,y,F,C,R,b,E,T,k,P,N,A,I,O,_,M,D,w,L,x,K,U,B,G,W,V,j,q,H,z,$,Q,Y)=>({worksheetFunctionNames:e,errorTypeNames:t,specialRefNames:$,trueName:r,falseName:n,rowLetter:i,columnLetter:o,leftBrace:a,rightBrace:s,leftBracket:l,rightBracket:u,decimalSeparator:c,listSeparator:d,columnSeparator:m,rowSeparator:g,thousandsData:p,thousandsSeparator:h,lcid:f,country:S,numberDecimals:v,isExpSepBySpace:y,fractionSeparator:F,isPercentSepBySpace:C,currencyFormat:R,isCurrencySymbolLead:b,isCurrencySepBySpace:E,currencySymbol:T,currencyDecimals:k,dateOrder:P,dateSeparator:N,dateAltSeparator:A,year4Digits:I,month2Digits:O,day2Digits:_,longDateFormat:M,timeSeparator:D,timeAltSeparator:w,hour2Digits:L,clock24Hour:x,isAMPMSepBySpace:K,ampmSymbols:U,dayNameShort:B,dayNameLong:G,monthNameShort:W,monthNameLong:V,pictureSpecial:j,pictureSingle:q,pictureColor:H,pictureDbnum:z,sysDateFormat:Q,sysTimeFormat:Y}))),t.numberFormat=(0,n.typedInstanceCreator)()(((e,t,r)=>({iformat:e,formatString:t,builtIn:r}))),t.sheetName=(0,n.typedInstanceCreator)()(((e,t)=>({sheetId:e,sheetName:t}))),t.blankValue={kind:"Blank"},t.errorValue=(0,n.typedInstanceCreator)()((e=>({kind:"Error",type:e}))),t.richValue=(0,n.typedInstanceCreator)()((e=>({kind:"Rich",fields:e}))),t.getCellValueKind=function(e){return"object"==typeof e?e.kind:typeof e},t.getCellFormatKind=function(e){return"object"==typeof e?e.kind:typeof e},t.cellLocation=(0,n.typedInstanceCreator)()(((e,t)=>({row:e,column:t}))),t.rangeLocation=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({row:e,column:t,lastRow:r,lastColumn:n}))),t.sheetRangeLocation=(0,n.typedInstanceCreator)()(((e,t,r,n,i)=>({sheetId:e,row:t,column:r,lastRow:n,lastColumn:i}))),t.sheetCellLocation=(0,n.typedInstanceCreator)()(((e,t,r)=>({sheetId:e,row:t,column:r,lastRow:void 0,lastColumn:void 0}))),t.cellData=(0,n.typedInstanceCreator)()(((e,t,r,n,i)=>({formulaBarText:e,value:t,iformat:r,failureReason:n,kind:i}))),t.cellFormulaCellData=function(e,r,n,i){return(0,t.cellData)(e,r,n,i,"CellFormula")},t.arrayFormulaCellData=function(e,r,n){return(0,t.cellData)(void 0,e,r,n,"ArrayFormula")},t.valueCellData=function(e,r,n,i){return(0,t.cellData)(e,r,n,i,"Value")},t.rangeUpdate=(0,n.typedInstanceCreator)()(((e,t,r,n,i)=>({range:e,data:t,fromStateId:r,excludeRows:n,excludeColumns:i}))),t.rangeWrite=(0,n.typedInstanceCreator)()(((e,r,n,i)=>(0,t.rangeUpdate)(e,r,void 0,n,i))),t.rangePromote=function(e,r,n,i){return(0,t.rangeUpdate)(e,void 0,r,n,i)},t.arrayData=(0,n.typedInstanceCreator)()(((e,t)=>({isSpilled:e,formulaBarText:t}))),t.arrayUpdate=(0,n.typedInstanceCreator)()(((e,t,r)=>({range:e,data:t,fromStateId:r}))),t.arrayWrite=function(e,r){return(0,t.arrayUpdate)(e,r,void 0)},t.arrayPromote=function(e,r){return(0,t.arrayUpdate)(e,void 0,r)},t.unusedCellsUpdate=(0,n.typedInstanceCreator)()(((e,t)=>({sheetId:e,usedRange:t}))),t.namedValueData=(0,n.typedInstanceCreator)()((e=>({kind:"NamedValue",value:e}))),t.namedFormulaData=(0,n.typedInstanceCreator)()((e=>({kind:"NamedFormula",formulaBarText:e}))),t.namedRangeData=(0,n.typedInstanceCreator)()((e=>({kind:"NamedRange",range:e}))),t.columnData=(0,n.typedInstanceCreator)()(((e,t)=>({column:e,name:t}))),t.namedTableData=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({kind:"NamedTable",range:e,hasHeadersRow:t,hasTotalsRow:r,columns:n}))),t.namedFailureData=(0,n.typedInstanceCreator)()(((e,t)=>({kind:"NamedFailure",failureReason:e,objectKind:t}))),t.namedObject=(0,n.typedInstanceCreator)()(((e,t)=>({name:e,data:t}))),t.namedObjectsUpdate=(0,n.typedInstanceCreator)()(((e,t,r)=>({scope:e,objects:t,fromStateId:r}))),t.namedObjectsWrite=function(e,r){return(0,t.namedObjectsUpdate)(e,r,void 0)},t.undefinedNamesWrite=function(e){return(0,t.namedObjectsUpdate)(e,void 0,void 0)},t.namedObjectsPromote=function(e,r){return(0,t.namedObjectsUpdate)(e,void 0,r)},t.rangeFormulaEdit=(e,t,r,n,i,o="Inferred")=>({range:Array.isArray(e)?e:[e],formulaBarText:t,value:r,origin:n,viewport:i,kind:o}),t.cellFormulaRangeFormulaEdit=function(e,r,n,i){return(0,t.rangeFormulaEdit)(e,r,void 0,n,i,"CellFormula")},t.valueRangeFormulaEdit=function(e,r,n,i){return(0,t.rangeFormulaEdit)(e,r,n,void 0,i,"Value")},t.inferredRangeFormulaEdit=function(e,r,n,i){return(0,t.rangeFormulaEdit)(e,r,void 0,n,i,"Inferred")},t.formatEditOperation=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({kind:e,format:t,ribbon:r,changeDecimals:n}))),t.formatEditSetFormat=function(e){return(0,t.formatEditOperation)("SetFormat",e,void 0,void 0)},t.formatEditRibbonFormat=function(e){return(0,t.formatEditOperation)("RibbonFormat",void 0,e,void 0)},t.formatEditChangeDecimals=function(e){return(0,t.formatEditOperation)("ChangeDecimals",void 0,void 0,e)},t.rangeFormatEdit=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({range:e,operation:t,origin:r,viewport:n}))),t.arrayFormulaEdit=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({range:e,formulaBarText:t,origin:r,viewport:n}))),t.rangePasteEdit=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({kind:e,target:t,source:r,viewport:n}))),t.copyPasteRangePasteEdit=function(e,r,n){const i=(0,t.sheetCellLocation)(e.sheetId,e.row,e.column);return(0,t.rangePasteEdit)("CopyPaste",i,r,n)},t.inferredFormat=(0,n.typedInstanceCreator)()(((e,t,r)=>({format:e,category:t,decimals:r}))),t.cellDataDelta=(0,n.typedInstanceCreator)()(((e,t,r,n,i)=>({formulaBarText:e,value:t,format:r,formatted:n,hasHyperlink:i}))),t.rangeDelta=(0,n.typedInstanceCreator)()(((e,t)=>({range:e,data:t}))),t.arrayDelta=(0,n.typedInstanceCreator)()(((e,t)=>({range:e,data:t}))),t.rangeFailure=(0,n.typedInstanceCreator)()(((e,t)=>({range:e,reason:t}))),t.recalcResults=(0,n.typedInstanceCreator)()(((e,t,r,n,i,o)=>({stateId:e,priorityGroup:t,isFinished:r,rangeDeltas:n,arrayDeltas:i,rangeFailures:o}))),t.evalFormulaFormat=(0,n.typedInstanceCreator)()(((e,t,r)=>({kind:e,iformat:t,knownFormat:r}))),t.evalFormulaFormatOrigin=function(){return(0,t.evalFormulaFormat)("Origin")},t.evalFormulaFormatIformat=function(e){return(0,t.evalFormulaFormat)("Iformat",e)},t.evalFormulaFormatKnown=function(e){return(0,t.evalFormulaFormat)("Known",void 0,e)},t.evalFormulaFormatInferred=function(){return(0,t.evalFormulaFormat)("Inferred")},t.evalFormulaFormatAggregate=function(){return(0,t.evalFormulaFormat)("Aggregate")},t.evalFormulaData=function(e,t){return{value:e,formatted:t}},t.updateRequest=(0,n.typedInstanceCreator)()(((e,t,r)=>({rangeUpdateRanges:e,arrayUpdateRanges:t,namesUpdateScopes:r}))),t.runExperiment=(0,n.typedInstanceCreator)()(((e,t)=>({name:e,param:t}))),t.recalcServiceConfig=(0,n.typedInstanceCreator)()(((e,t,r,n,i,o,a,s,l,u,c=(null==u?void 0:u/(u>=1?1:10)),d)=>({totalEvalTimeMs:e,samplePrecisionEvalRate:t,samplePrecisionPrintFormulaRate:u,samplePrecisionPrintValueRate:c,sampleRecalcStatisticsRate:s,sampleWorkbookStatisticsRate:n,sampleRecalcEditedStopwatchRate:i,sampleRecalcViewportStopwatchRate:o,sampleCellEvalStopwatchRate:a,rngSeed:r,volatileMode:d,runExperiments:l}))),t.workbookProps=(0,n.typedInstanceCreator)()(((e,t,r)=>({date1904:e,dateCompatibility:t,timezone:r}))),function(e){e.Thread="Thread",e.Local="Local",e.ThreadOrLocal="ThreadOrLocal"}(o||(t.RecalcServiceCreateMode=o={}))},94746:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertX10RangeFormulaEditsToCalcRangeFormulaEdits=t.convertX10UpdatesToCalcUpdates=t.RecalcSideGrid=void 0;const n=r(19181),i=r(12450),o=r(33436),a=r(7793),s=r(50338),l=r(50338),u=r(83781),c=r(55380),d=n.__importStar(r(66932)),m=r(31053),g=r(58293),p=r(88928),h=r(25201),f=r(83102),S=r(71510);function v(e,t){return e.map((e=>{if(!(0,i.isDefined)(e.data))return{data:void 0,range:(0,g.sheetGridRangeToLocation)(e.range)};const r=(0,g.readOperToCellValue)(t,e.data.value);return{data:{kind:e.data.kind,formulaBarText:e.data.formulaBarText,value:null!=r?r:m.blankValue,iformat:e.data.iformat,failureReason:void 0===r?"unsupported Oper serialization":void 0},range:(0,g.sheetGridRangeToLocation)(e.range)}}))}function y(e,t){return e.map((e=>{const[r,...n]=e.range,o=[(0,g.sheetGridRangeToLocation)(r),...n.map((e=>(0,g.sheetGridRangeToLocation)(e)))];return{kind:e.kind,range:o,formulaBarText:e.formulaBarText,value:(0,i.isDefined)(e.value)?(0,g.readOperToCellValue)(t,e.value):void 0,origin:(0,i.isDefined)(e.origin)?(0,g.gridCellToCellLocation)(e.origin):void 0}}))}(0,i.staticAssertSame)(),(0,i.staticAssertSame)(),(0,i.staticAssertSame)(),(0,i.staticAssertSame)(),t.RecalcSideGrid=class{createIGridExportEndpoint(e){return n.__awaiter(this,void 0,void 0,(function*(){yield d.Endpoint.createInside(e,(()=>this))}))}discardSnapshot(e){return void 0!==this.snapshotPromises[e]&&(delete this.snapshotPromises[e],!0)}evalClonedModelOnSnapshot(e,t,r,i){var a;return n.__awaiter(this,void 0,void 0,(function*(){const{snapshot:n}=null!==(a=yield this.getOrCreateSnapshot(e))&&void 0!==a?a:{snapshot:void 0};if(void 0===n)return(0,o.failure)((0,l.unavailable)(["evalOnClonedModel"]));const s=v(t,n.config.mathpack),u=y(r,n.config.mathpack),c=this.calcGrid.evalOnClonedModelOnSnapshot(s,u,n,i);return this.calcGrid.resumeRecalc(),(0,o.success)(yield c)}))}evalFormulaOnSnapshot(e,t,r,i={kind:p.SpecialFormat.Origin}){var a;return n.__awaiter(this,void 0,void 0,(function*(){const{snapshot:n}=null!==(a=yield this.getOrCreateSnapshot(e))&&void 0!==a?a:{snapshot:void 0};if(void 0===n)return(0,o.failure)((0,l.unavailable)(["evalFormula"]));const u=this.calcGrid.evalFormulaOnSnapshotImpl(t,r,i,n);this.calcGrid.resumeRecalc();const c=function(e){if(e.value.kind===o.ResultKind.Failure&&e.value.reason.kind===s.ReasonKind.Unavailable){const t=e.value.reason.objects;for(let e=0;e<t.length;e++){const r=t[e];r.kind===p.UnavailableKind.GridRange&&(t[e]=Object.assign(Object.assign({},r),{unavailableCells:!0}))}}return e}(yield u);return(0,o.success)(c)}))}getSheetNames(e){var t;return n.__awaiter(this,void 0,void 0,(function*(){const{snapshot:r}=null!==(t=yield this.getOrCreateSnapshot(e))&&void 0!==t?t:{snapshot:void 0};if(void 0===r)return(0,o.failure)((0,l.unavailable)(["getSheetNames"]));const n={document:this.calcGrid.document,sheets:new Array},i=r.getSheetRangeIndexes((0,a.allSheetsRange)(this.calcGrid.document));if(!(0,o.isSuccess)(i))return i;for(const e of i.value.sheets){const t=r.getSheetName(this.calcGrid.document,e);if(!(0,o.isSuccess)(t))return t;n.sheets.push({sheetIndex:(0,a.sheetIndex)(this.calcGrid.document,e),sheetName:t.value})}return(0,o.success)(n)}))}getCorrespondingSnapshotID(e){return n.__awaiter(this,void 0,void 0,(function*(){const t=yield this.getOrCreateSnapshot(e);return void 0===t?-1:t.correspondingId}))}getOrCreateSnapshot(e){return n.__awaiter(this,void 0,void 0,(function*(){return void 0===this.snapshotPromises[e]&&(this.snapshotPromises[e]=this.calcGrid.dataModel.createSnapshot(e),this.calcGrid.resumeRecalc().catch((e=>{setTimeout((()=>{throw e}))}))),this.snapshotPromises[e]}))}getRangeFormats(e,t){return this.getRangeData(e,t,"formats")}getRangeValues(e,t){return this.getRangeData(e,t,"values")}getRangeFormulae(e,t){return this.getRangeData(e,t,"formulae")}getRangeData(e,t,r){var i;return n.__awaiter(this,void 0,void 0,(function*(){const{snapshot:n}=null!==(i=yield this.getOrCreateSnapshot(e))&&void 0!==i?i:{snapshot:void 0};if(void 0===n)return(0,o.failure)((0,l.unavailable)(["getRangeData/getOrCreateSnapshot"]));const s=n.allEditedAvailable(t);if(s.kind!==o.ResultKind.Success)return(0,o.failure)((0,l.unavailable)(["getRangeData/allEditedAvailable"]));let d=(0,h.createCellSetFromRange)(t.range);!0!==s.value&&(d=(0,f.exceptProduct)(d,s.value));const m=e=>{const r=[];return(0,h.forEachRangeInSet)(d,(n=>{const i=e((0,a.sheetGridRange)(t.sheet,n),(e=>{d=(0,f.exceptProduct)(d,(0,h.createCellSetFromRange)(e))}),((e,t)=>{r.push([[e.row,e.col],t])}));return i.kind===o.ResultKind.Success&&i.value}))?(0,o.success)(r):(0,o.failure)((0,l.unavailable)(["getRangeData/extractData"]))},g={formulae:()=>m(((e,t,r)=>n.forEachEditedFormula(e,((e,{lexicalKind:n,compiledFmla:i,fmla:o,origin:s})=>(n!==a.LexicalKind.Range&&(0,l.isGridCell)(e)?(0,c.isBlankGridFormula)(o,void 0!==i)||r(e,{kind:void 0!==i?u.FormulaKind.CellFormula:u.FormulaKind.Value,formulaBarText:o,origin:(0,l.isGridCellEqual)(s,e)?void 0:s}):t(e),!0))))),formats:()=>m(((e,t,r)=>n.forEachEditedFormat(e,((e,n)=>(n===p.SpecialFormat.Unavailable?t(e):(0,c.isBlankCellFormat)(n)||r(e,"number"==typeof n?n:n.formatString),!0))))),values:()=>m(((e,t,r)=>n.forEachRecalcValue(e,((e,n)=>(void 0!==n.failure?t(e):(0,c.isBlankGridValue)(n.oper,n.failure)||r(e,n.oper),!0)))))}[r]();if(g.kind!==o.ResultKind.Success)return g;const S=[];return(0,h.forEachRangeInSet)(d,(e=>(S.push(e),!0))),(0,o.success)({nonEmptyCells:g.value,availableRanges:S})}))}getIntersectingTables(e,t){var r,i;return n.__awaiter(this,void 0,void 0,(function*(){const{snapshot:n}=null!==(r=yield this.getOrCreateSnapshot(e))&&void 0!==r?r:{snapshot:void 0};if(void 0===n)return(0,o.failure)((0,l.unavailable)(["getIntersectingTables/getOrCreateSnapshot"]));const s=n.allServerAvailable(t);if(s.kind!==o.ResultKind.Success)return(0,o.failure)((0,l.unavailable)(["getIntersectingTables/allServerAvailable"]));const u=n.getIntersectingTables(t);if(!(0,o.isSuccess)(u))return(0,o.failure)((0,l.unavailable)(["getIntersectingTables/getIntersectingTables"]));const c=[];for(const e of u.value){const t=n.getNamedObject(e,a.NameSource.Plain);if(t.kind!==o.ResultKind.Success)return t;if("NamedTable"!==(null===(i=t.value)||void 0===i?void 0:i.kind))continue;const r=[];t.value.columnIndexes.forEach(((e,t)=>(r.push({column:e,name:t}),!0))),c.push({name:e.name,dataRange:t.value.specialRefRanges[S.SpecialRefId.Data].range,hasHeadersRow:t.value.hasHeadersRow,hasTotalsRow:t.value.hasTotalsRow,columns:r})}const d=(0,h.createCellSetFromRange)(t.range),m=!0===s.value?d:(0,f.exceptProduct)(d,s.value),g=[];return(0,h.forEachRangeInSet)(m,(e=>(g.push(e),!0))),(0,o.success)({tables:c,availableRanges:g})}))}getIformats(e,t,r,i){var a;return n.__awaiter(this,void 0,void 0,(function*(){const{snapshot:n}=null!==(a=yield this.getOrCreateSnapshot(e))&&void 0!==a?a:{snapshot:void 0};if(void 0===n)return(0,o.failure)((0,l.unavailable)(["getIformats/getOrCreateSnapshot"]));const s=n.getIformats(t,r,i);return(0,o.isSuccess)(s)?(0,o.success)({availableFormats:s.value}):(0,o.failure)((0,l.unavailable)(["getIformats/getIntersectingTables"]))}))}getHiddenRows(e,t,r,i){var o;return n.__awaiter(this,void 0,void 0,(function*(){const{snapshot:n}=null!==(o=yield this.getOrCreateSnapshot(e))&&void 0!==o?o:{snapshot:void 0};return void 0===n?c.hiddennessFullyUnavailable:n.getHiddenRows(t,r,i)}))}getHiddenCols(e,t,r,i){var o;return n.__awaiter(this,void 0,void 0,(function*(){const{snapshot:n}=null!==(o=yield this.getOrCreateSnapshot(e))&&void 0!==o?o:{snapshot:void 0};return void 0===n?c.hiddennessFullyUnavailable:n.getHiddenCols(t,r,i)}))}constructor(e){this.calcGrid=e,this.snapshotPromises=[]}},t.convertX10UpdatesToCalcUpdates=v,t.convertX10RangeFormulaEditsToCalcRangeFormulaEdits=y},70911:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computeUnavailableCellsStats=void 0;const n=r(88928),i=r(25201),o=r(50338),a=r(83102),s=r(12450),l=r(20456);t.computeUnavailableCellsStats=function(e){var t,r,u,c,d,m,g;const p=(0,s.makeStringMap)(),h=(0,s.makeStringMap)();for(const i of e){const e=i.range;if(i.reason.kind===o.LangReasonKind.Unavailable)for(const s of i.reason.objects)s.kind===n.UnavailableKind.GridRange&&((0,o.isSheetIndexEqual)(s.range.sheet,e.sheet)?p[s.range.sheet.index]=(0,a.unionProduct)(null!==(t=p[s.range.sheet.index])&&void 0!==t?t:l.empty,!0!==s.unavailableCells?s.unavailableCells:l.empty):h[s.range.sheet.index]=(0,a.unionProduct)(null!==(r=h[s.range.sheet.index])&&void 0!==r?r:l.empty,!0!==s.unavailableCells?s.unavailableCells:l.empty))}let f=0,S=0,v=0;const y=(0,s.makeStringMap)();for(const e in p){const t=null!==(u=p[e])&&void 0!==u?u:l.empty;y[e]=(0,a.unionProduct)(null!==(c=y[e])&&void 0!==c?c:l.empty,t),(0,i.forEachRangeInSet)(t,(e=>(f+=e.rows*e.cols,!0)))}for(const e in h){const t=null!==(d=h[e])&&void 0!==d?d:l.empty;y[e]=(0,a.unionProduct)(null!==(m=y[e])&&void 0!==m?m:l.empty,t),(0,i.forEachRangeInSet)(t,(e=>(S+=e.rows*e.cols,!0)))}for(const e in y){const t=null!==(g=y[e])&&void 0!==g?g:l.empty;(0,i.forEachRangeInSet)(t,(e=>(v+=e.rows*e.cols,!0)))}return{numOfUnavailableCellsInTheSameSheet:f,numOfUnavailableCellsInDifferentSheet:S,totalNumOfUnavailableCells:v}}},81476:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTimeImpl=t.VolatileMode=t.asyncLazy=t.ResettableLazy=void 0;const n=r(57264),i=r(33436),o=r(88928),a=r(16811),s=r(94591),l=r(50338);class u{getValue(){return void 0===this.value&&(this.value=this.valueCreationFunc()),this.value}force(){void 0===this.value&&(this.value=this.valueCreationFunc())}reset(){this.value=void 0}constructor(e){this.valueCreationFunc=e,this.value=void 0}}var c;t.ResettableLazy=u,t.asyncLazy=function(e){return new u(e)},function(e){e.GroundTruth="GroundTruth",e.Estimation="Estimation",e.PrecisionTest="PrecisionTest"}(c||(t.VolatileMode=c={}));const d=()=>new Date;t.getTimeImpl=function(e,t,r,u=c.Estimation,m=d){switch(u){case c.PrecisionTest:return(0,i.failure)((0,l.unavailable)([{kind:o.UnavailableKind.GetTimeKind,getTimeKind:r}]));case c.Estimation:switch(r){case s.GetTimeKind.NonVolatile:return(0,i.failure)((0,l.unavailable)([{kind:o.UnavailableKind.GetTimeKind,getTimeKind:r}]));case s.GetTimeKind.ValueCell:case s.GetTimeKind.Volatile:}case c.GroundTruth:}const{mathpack:g,datepack:p}=e,h=m(),f=p.utcToLocal(e,(0,a.dateTime)(h.getUTCFullYear(),h.getUTCMonth()+1,h.getUTCDate(),h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds(),h.getUTCDay()+1,h.getUTCMilliseconds(),a.Rounding.Round1000ths),e.timezone);(0,n.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: to local",!1!==f);const{yr:S,rounding:v}=f;let{mon:y,dom:F,hour:C,min:R,sec:b,fracSec:E}=f;t<a.TimeGranularity.Instant&&(E=0,b=0,R=0,C=0),t<a.TimeGranularity.Day&&(F=1,y=1);const T=(0,a.dateTime)(S,y,F,C,R,b,1,E,v),k=p.toNum(e,T);(0,n.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: toNum",!(0,l.isErrorOper)(k));const P=g.toNumber(k);if(u===c.GroundTruth)return(0,i.success)(k);const N=p.toNum(e,f);(0,n.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: toNum",!(0,l.isErrorOper)(N));const A=g.toNumber(N);let I;switch(t){case a.TimeGranularity.Instant:I=A;break;case a.TimeGranularity.Day:I=P+1;break;case a.TimeGranularity.Year:{const t=(0,a.dateTime)(S+1,y,F,C,R,b,1,E,v),r=p.toNum(e,t);(0,n.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: toNum",!(0,l.isErrorOper)(r)),I=g.toNumber(r);break}}const O=10/1440;return A<P+O||A>I-O?(0,i.failure)((0,l.unavailable)([{kind:o.UnavailableKind.TimeGranularity,granularity:t}])):(0,i.success)(k)}},88131:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.copyPasteRangePasteEdit=t.rangePasteEdit=t.arrayFormulaEdit=t.rangeFormatEdit=t.formatEditChangeDecimals=t.formatEditRibbonFormat=t.formatEditSetFormat=t.formatEditOperation=t.RibbonFormat=t.inferredRangeFormulaEdit=t.valueRangeFormulaEdit=t.cellFormulaRangeFormulaEdit=t.rangeFormulaEdit=t.columnData=t.namedTableData=t.namedObjectsPromote=t.undefinedNamesWrite=t.namedObjectsWrite=t.namedObjectsUpdate=t.namedObject=t.namedFailureData=t.namedRangeData=t.namedFormulaData=t.namedValueData=t.unusedCellsUpdate=t.arrayPromote=t.arrayWrite=t.arrayUpdate=t.arrayData=t.rangePromote=t.rangeWrite=t.rangeUpdate=t.valueCellData=t.arrayFormulaCellData=t.cellFormulaCellData=t.cellData=t.sheetCellLocation=t.sheetRangeLocation=t.rangeLocation=t.cellLocation=t.getCellFormatKind=t.getCellValueKind=t.richValue=t.errorValue=t.blankValue=t.sheetName=t.numberFormat=t.localeData=t.errorTypeName=t.worksheetFunctionName=void 0,t.internal=t.RecalcServiceDataTransformer=t.getTime=t.recalcServiceInsideInit=t.readOperToCellValue=t.cellValueToReadOper=t.localeInfoFromData=t.RecalcServiceCreateMode=t.createRecalcService=t.workbookProps=t.recalcServiceConfig=t.runExperiment=t.updateRequest=t.evalFormulaFormatAggregate=t.evalFormulaFormatInferred=t.evalFormulaFormatKnown=t.evalFormulaFormatIformat=t.evalFormulaFormatOrigin=t.evalFormulaFormat=t.evalFormulaData=t.recalcResults=t.rangeFailure=t.arrayDelta=t.rangeDelta=t.cellDataDelta=t.inferredFormat=void 0;const n=r(19181),i=n.__importStar(r(31053)),o=n.__importStar(r(77806)),a=n.__importStar(r(58293)),s=n.__importStar(r(17338)),l=n.__importStar(r(81476)),u=n.__importStar(r(83079)),c=n.__importStar(r(23623));t.worksheetFunctionName=i.worksheetFunctionName,t.errorTypeName=i.errorTypeName,t.localeData=i.localeData,t.numberFormat=i.numberFormat,t.sheetName=i.sheetName,t.blankValue=i.blankValue,t.errorValue=i.errorValue,t.richValue=i.richValue,t.getCellValueKind=i.getCellValueKind,t.getCellFormatKind=i.getCellFormatKind,t.cellLocation=i.cellLocation,t.rangeLocation=i.rangeLocation,t.sheetRangeLocation=i.sheetRangeLocation,t.sheetCellLocation=i.sheetCellLocation,t.cellData=i.cellData,t.cellFormulaCellData=i.cellFormulaCellData,t.arrayFormulaCellData=i.arrayFormulaCellData,t.valueCellData=i.valueCellData,t.rangeUpdate=i.rangeUpdate,t.rangeWrite=i.rangeWrite,t.rangePromote=i.rangePromote,t.arrayData=i.arrayData,t.arrayUpdate=i.arrayUpdate,t.arrayWrite=i.arrayWrite,t.arrayPromote=i.arrayPromote,t.unusedCellsUpdate=i.unusedCellsUpdate,t.namedValueData=i.namedValueData,t.namedFormulaData=i.namedFormulaData,t.namedRangeData=i.namedRangeData,t.namedFailureData=i.namedFailureData,t.namedObject=i.namedObject,t.namedObjectsUpdate=i.namedObjectsUpdate,t.namedObjectsWrite=i.namedObjectsWrite,t.undefinedNamesWrite=i.undefinedNamesWrite,t.namedObjectsPromote=i.namedObjectsPromote,t.namedTableData=i.namedTableData,t.columnData=i.columnData,t.rangeFormulaEdit=i.rangeFormulaEdit,t.cellFormulaRangeFormulaEdit=i.cellFormulaRangeFormulaEdit,t.valueRangeFormulaEdit=i.valueRangeFormulaEdit,t.inferredRangeFormulaEdit=i.inferredRangeFormulaEdit,t.RibbonFormat=i.RibbonFormat,t.formatEditOperation=i.formatEditOperation,t.formatEditSetFormat=i.formatEditSetFormat,t.formatEditRibbonFormat=i.formatEditRibbonFormat,t.formatEditChangeDecimals=i.formatEditChangeDecimals,t.rangeFormatEdit=i.rangeFormatEdit,t.arrayFormulaEdit=i.arrayFormulaEdit,t.rangePasteEdit=i.rangePasteEdit,t.copyPasteRangePasteEdit=i.copyPasteRangePasteEdit,t.inferredFormat=i.inferredFormat,t.cellDataDelta=i.cellDataDelta,t.rangeDelta=i.rangeDelta,t.arrayDelta=i.arrayDelta,t.rangeFailure=i.rangeFailure,t.recalcResults=i.recalcResults,t.evalFormulaData=i.evalFormulaData,t.evalFormulaFormat=i.evalFormulaFormat,t.evalFormulaFormatOrigin=i.evalFormulaFormatOrigin,t.evalFormulaFormatIformat=i.evalFormulaFormatIformat,t.evalFormulaFormatKnown=i.evalFormulaFormatKnown,t.evalFormulaFormatInferred=i.evalFormulaFormatInferred,t.evalFormulaFormatAggregate=i.evalFormulaFormatAggregate,t.updateRequest=i.updateRequest,t.runExperiment=i.runExperiment,t.recalcServiceConfig=i.recalcServiceConfig,t.workbookProps=i.workbookProps,t.createRecalcService=o.createRecalcService,t.RecalcServiceCreateMode=i.RecalcServiceCreateMode,t.localeInfoFromData=a.localeInfoFromData,t.cellValueToReadOper=a.cellValueToReadOper,t.readOperToCellValue=a.readOperToCellValue,t.recalcServiceInsideInit=s.recalcServiceInsideInit,t.getTime=l.getTimeImpl,t.RecalcServiceDataTransformer=c.RecalcServiceDataTransformer,t.internal=u},29174:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getExcelOnlineCalcNewPackagesNames=void 0;const n=r(57777),i=r(81836),o=r(37883),a=r(40535),s=r(53698),l=r(98448),u=`${n.PackageName}, ${i.PackageName},\n  ${o.PackageName}, ${a.PackageName}, ${s.PackageName}, ${l.PackageName}`;t.getExcelOnlineCalcNewPackagesNames=function(){return u}},36665:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;const n=r(57777);t.anonymize=n.anonymizer.anonymize,t.anonymizeFormulaString=n.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=n.anonymizer.anonymizeMagnitude,t.kindAnonymizers=n.anonymizer.kindAnonymizers},57264:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;const n=r(57777);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},92383:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delayPromiseImpl=t.asyncLoopFactory=t.asyncLoop=void 0;const n=r(57777);t.asyncLoop=n.asyncLoopModule.asyncLoop,t.asyncLoopFactory=n.asyncLoopModule.asyncLoopFactory,t.delayPromiseImpl=n.asyncLoopModule.delayPromiseImpl},93087:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.maxRetriesForLoadingScript=t.isCalcInit=t.initCalcThread=t.initCalcInThread=t.initCalcCalled=t.initCalc=t.getCalcAbsUrlOrThrow=t.getCalcAbsUrl=void 0;const n=r(57777);t.getCalcAbsUrl=n.config.getCalcAbsUrl,t.getCalcAbsUrlOrThrow=n.config.getCalcAbsUrlOrThrow,t.initCalc=n.config.initCalc,t.initCalcCalled=n.config.initCalcCalled,t.initCalcInThread=n.config.initCalcInThread,t.initCalcThread=n.config.initCalcThread,t.isCalcInit=n.config.isCalcInit,t.maxRetriesForLoadingScript=n.config.maxRetriesForLoadingScript},12450:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;const n=r(57777);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},77954:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enumerateKeysInOrder=t.enumerateInOrder=t.RootPointer=t.ArrayMapTree=t.floorToPowerOf2=void 0;const n=r(57777);t.floorToPowerOf2=n.arrayMapTree.floorToPowerOf2,t.ArrayMapTree=n.arrayMapTree.ArrayMapTree,t.RootPointer=n.arrayMapTree.RootPointer,t.enumerateInOrder=n.arrayMapTree.enumerateInOrder,t.enumerateKeysInOrder=n.arrayMapTree.enumerateKeysInOrder},20456:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachKeyUntyped=t.forEachKey=t.getNodeCount=t.complement=t.symmetricDiff=t.lazy=t.empty=t.dense=t.compareUntyped=t.combineCmp=t.compare=t.exceptUntyped=t.except=t.meetsUntyped=t.meets=t.intersectUntyped=t.intersect=t.unionUntyped=t.union=t.fromUntyped=t.createFromKey=t.cacheKeySplitting=t.SetKind=void 0;const n=r(57777);t.SetKind=n.bspSet.SetKind,t.cacheKeySplitting=n.bspSet.cacheKeySplitting,t.createFromKey=n.bspSet.createFromKey,t.fromUntyped=n.bspSet.fromUntyped,t.union=n.bspSet.union,t.unionUntyped=n.bspSet.unionUntyped,t.intersect=n.bspSet.intersect,t.intersectUntyped=n.bspSet.intersectUntyped,t.meets=n.bspSet.meets,t.meetsUntyped=n.bspSet.meetsUntyped,t.except=n.bspSet.except,t.exceptUntyped=n.bspSet.exceptUntyped,t.compare=n.bspSet.compare,t.combineCmp=n.bspSet.combineCmp,t.compareUntyped=n.bspSet.compareUntyped,t.dense=n.bspSet.dense,t.empty=n.bspSet.empty,t.lazy=n.bspSet.lazy,t.symmetricDiff=n.bspSet.symmetricDiff,t.complement=n.bspSet.complement,t.getNodeCount=n.bspSet.getNodeCount,t.forEachKey=n.bspSet.forEachKey,t.forEachKeyUntyped=n.bspSet.forEachKeyUntyped},20963:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Deque=void 0;const n=r(57777);t.Deque=n.deque.Deque},96258:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ivlCompare=t.ivlExcept=t.ivlMeetsOrTouches=t.ivlMeets=t.ivlDistance=t.ivlMeet=t.ivlJoin=void 0;const n=r(57777);t.ivlJoin=n.interval.ivlJoin,t.ivlMeet=n.interval.ivlMeet,t.ivlDistance=n.interval.ivlDistance,t.ivlMeets=n.interval.ivlMeets,t.ivlMeetsOrTouches=n.interval.ivlMeetsOrTouches,t.ivlExcept=n.interval.ivlExcept,t.ivlCompare=n.interval.ivlCompare},21620:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PriorityQueue=void 0;const n=r(57777);t.PriorityQueue=n.priorityQueue.PriorityQueue},83102:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.productSetSerializer=t.ProductSetSerializer=t.getSubspaceCount=t.forEachProduct=t.getSubspaces=t.symmetricDiffProduct=t.complementProduct=t.meetsProduct=t.compareProduct=t.exceptProduct=t.intersectProduct=t.unionProduct=t.project=t.createFromProduct=void 0;const n=r(57777);t.createFromProduct=n.productSet.createFromProduct,t.project=n.productSet.project,t.unionProduct=n.productSet.unionProduct,t.intersectProduct=n.productSet.intersectProduct,t.exceptProduct=n.productSet.exceptProduct,t.compareProduct=n.productSet.compareProduct,t.meetsProduct=n.productSet.meetsProduct,t.complementProduct=n.productSet.complementProduct,t.symmetricDiffProduct=n.productSet.symmetricDiffProduct,t.getSubspaces=n.productSet.getSubspaces,t.forEachProduct=n.productSet.forEachProduct,t.getSubspaceCount=n.productSet.getSubspaceCount,t.ProductSetSerializer=n.productSet.ProductSetSerializer,t.productSetSerializer=n.productSet.productSetSerializer},94297:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;const n=r(57777);t.RedBlackMapTree=n.rbMapTree.RedBlackMapTree},96703:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boundedParetoSetOperations=t.boundedParetoSplitter=t.boundedPareto=void 0;const n=r(57777);t.boundedPareto=n.split.boundedPareto,t.boundedParetoSplitter=n.split.boundedParetoSplitter,t.boundedParetoSetOperations=n.split.boundedParetoSetOperations},87555:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entry=t.makeEmptyTable=void 0;const n=r(57777);t.makeEmptyTable=n.table.makeEmptyTable,t.entry=n.table.entry},42549:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;const n=r(57777);t.FeatureName=n.featureConfiguration.FeatureName,t.initFeatureConfiguration=n.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=n.featureConfiguration.isFeatureEnabled,t.getFeatures=n.featureConfiguration.getFeatures,t.getTypedFeatureGate=n.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=n.featureConfiguration.isTypedChangeGateEnabled;var i=r(12367);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return i.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return i.setFeatureGateDictionaryGetter}})},83611:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSF32=void 0;var n=r(57777);Object.defineProperty(t,"JSF32",{enumerable:!0,get:function(){return n.JSF32}})},38692:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mixin=void 0;var n=r(57777);Object.defineProperty(t,"mixin",{enumerable:!0,get:function(){return n.mixin}})},28196:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promiseLoop=t.promiseFinally=t.newPromise=t.isThenable=t.collapseThenable=t.bindMaybeThenable=t.MaybeThenable=void 0;const n=r(57777);t.MaybeThenable=n.promise.MaybeThenable,t.bindMaybeThenable=n.promise.bindMaybeThenable,t.collapseThenable=n.promise.collapseThenable,t.isThenable=n.promise.isThenable,t.newPromise=n.promise.newPromise,t.promiseFinally=n.promise.promiseFinally,t.promiseLoop=n.promise.promiseLoop},82751:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResolvablePromiseWithSyncValue=t.ResolvablePromiseWithTimeout=t.ResolvablePromise=void 0;const n=r(57777);t.ResolvablePromise=n.resolvablePromise.ResolvablePromise,t.ResolvablePromiseWithTimeout=n.resolvablePromise.ResolvablePromiseWithTimeout,t.ResolvablePromiseWithSyncValue=n.resolvablePromise.ResolvablePromiseWithSyncValue},33436:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;const n=r(57777);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},64303:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.breakTransition=t.nextTransition=t.nextOnSuccessReceiver=t.callMachineTransition=t.TransitionKind=t.MachineRuntime=t.MachineCycle=t.AllMachine=void 0;const n=r(57777);t.AllMachine=n.machine.AllMachine,t.MachineCycle=n.machine.MachineCycle,t.MachineRuntime=n.machine.MachineRuntime,t.TransitionKind=n.machine.TransitionKind,t.callMachineTransition=n.machine.callMachineTransition,t.nextOnSuccessReceiver=n.machine.nextOnSuccessReceiver,t.nextTransition=n.machine.nextTransition,t.breakTransition=n.machine.breakTransition},42261:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;const n=r(57777);t.Pledge=n.pledge.Pledge},63019:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSetTimeoutInterface=t.clearTimerUnified=t.setImmediateUnified=void 0;const n=r(57777);t.setImmediateUnified=n.setTimeoutInterfaceModule.setImmediateUnified,t.clearTimerUnified=n.setTimeoutInterfaceModule.clearTimerUnified,t.defaultSetTimeoutInterface=n.setTimeoutInterfaceModule.defaultSetTimeoutInterface},17350:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ulsStopwatchFactory=t.initStopwatch=void 0;const n=r(57777);t.initStopwatch=n.stopwatch.initStopwatch,t.ulsStopwatchFactory=n.stopwatch.ulsStopwatchFactory},91709:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;const n=r(57777);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},72959:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapIntoAsyncClass=t.wrapIntoAsync=void 0;const n=r(57777);t.wrapIntoAsync=n.wrapIntoAsyncModule.wrapIntoAsync,t.wrapIntoAsyncClass=n.wrapIntoAsyncModule.wrapIntoAsyncClass},69711:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ds=t.ResultKind=t.arrayFill=t.stringEndsWith=t.stringStartsWith=t.isInteger=t.messageFromError=t.assertIndex=t.assertPositiveInteger=t.assertPositiveLength=t.assertFalse=t.assertTrue=t.assertNatural=t.assertNever=t.Pledge=t.JSF32=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.now=t.makeStringMap=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.numEnumMap=t.numEnumArray=t.identity=t.fastAbs=t.fastMax=t.fastMin=void 0;const n=r(19181),i=n.__importStar(r(12450)),o=n.__importStar(r(57264)),a=n.__importStar(r(91709)),s=n.__importStar(r(20963)),l=n.__importStar(r(57777)),u=n.__importStar(r(42261));t.fastMin=i.fastMin,t.fastMax=i.fastMax,t.fastAbs=i.fastAbs,t.identity=i.identity,t.numEnumArray=i.numEnumArray,t.numEnumMap=i.numEnumMap,t.safePush=i.safePush,t.safeConcat=i.safeConcat,t.isDefined=i.isDefined,t.isNone=i.isNone,t.makeStringMap=i.makeStringMap,t.now=i.now,t.staticAssertExtends=i.staticAssertExtends,t.staticAssertSame=i.staticAssertSame,t.staticAssertIs=i.staticAssertIs,t.staticAssertIsOptional=i.staticAssertIsOptional,t.JSF32=l.JSF32,t.Pledge=u.Pledge,t.assertNever=o.assertNever,t.assertNatural=o.assertNatural,t.assertTrue=o.assertTrue,t.assertFalse=o.assertFalse,t.assertPositiveLength=o.assertPositiveLength,t.assertPositiveInteger=o.assertPositiveInteger,t.assertIndex=o.assertIndex,t.messageFromError=a.messageFromError,t.isInteger=a.isInteger,t.stringStartsWith=a.stringStartsWith,t.stringEndsWith=a.stringEndsWith,t.arrayFill=a.arrayFill,t.ResultKind=l.result.ResultKind,t.ds=s},86506:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeatureName=t.getCalcAbsUrl=t.isCalcInit=t.createIsThousandsPositionCallback=t.createWorksheetFuncNameCallbacks=t.operatorIdToName=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishWorksheetFuncIdToName=t.getEnglishLocaleInfo=t.initCalc=t.calcConfig=t.PictureDbnum=t.PictureColor=t.PictureSingle=t.PictureSpecial=t.Country=t.LCID=t.localeInfo=t.ulsLogger=t.NulLogger=t.TraceLevel=t.LogCategory=void 0;const n=r(19181),i=n.__importStar(r(55340)),o=n.__importStar(r(93087)),a=n.__importStar(r(42549));t.LogCategory=i.LogCategory,t.TraceLevel=i.TraceLevel,t.NulLogger=i.NulLogger,t.ulsLogger=i.ulsLogger,t.localeInfo=i.localeInfo,t.LCID=i.LCID,t.Country=i.Country,t.PictureSpecial=i.PictureSpecial,t.PictureSingle=i.PictureSingle,t.PictureColor=i.PictureColor,t.PictureDbnum=i.PictureDbnum,t.calcConfig=i.calcConfig,t.initCalc=o.initCalc,t.getEnglishLocaleInfo=i.getEnglishLocaleInfo,t.englishWorksheetFuncIdToName=i.englishWorksheetFuncIdToName,t.englishErrorTypeToName=i.englishErrorTypeToName,t.englishOperatorIdToName=i.englishOperatorIdToName,t.operatorIdToName=i.operatorIdToName,t.createWorksheetFuncNameCallbacks=i.createWorksheetFuncNameCallbacks,t.createIsThousandsPositionCallback=i.createIsThousandsPositionCallback,t.isCalcInit=o.isCalcInit,t.getCalcAbsUrl=o.getCalcAbsUrl,t.FeatureName=a.FeatureName},12220:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.TimeGranularity=t.dateTime=t.tzUTC=t.tzData=t.Rounding=t.TimeDivision=void 0;const n=r(19181).__importStar(r(16811));t.TimeDivision=n.TimeDivision,t.Rounding=n.Rounding,t.tzData=n.tzData,t.tzUTC=n.tzUTC,t.dateTime=n.dateTime,t.TimeGranularity=n.TimeGranularity,t.xlDatepack=n.xlDatepack},98451:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.machine=t.DerefOperKind=void 0;const n=r(19181).__importStar(r(83056));t.DerefOperKind=n.DerefOperKind,t.machine=n.machine},94470:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contextNameNode=t.fieldRefNamePart=t.cellRefNamePart=t.identNamePart=t.nameNode=t.parenNode=t.wsfNode=t.operatorNode=t.lambdaNode=t.lambdaParam=t.paramNode=t.paramDefault=t.paramName=t.flattenLambdaArgs=t.letNode=t.letVar=t.indexedArg=t.flattenLetArgs=t.appNode=t.arrayNode=t.literalNode=t.formulaSpan=t.singleLineComment=t.multiLineComment=t.formula=t.cellRefBad=t.cellRefCol=t.cellRefRow=t.cellRefRange=t.cellRefSingle=t.cellRefError=t.pos=t.badQualifier=t.sheetRangeQualifier=t.identQualifier=t.sheetQualifier=t.documentQualifier=t.relativeQualifier=t.errorQualifier=t.BadType=t.StructRefKind=t.SpecialRefId=t.NamePartKind=t.NodeKind=t.CommentKind=t.PosKind=t.CellRefKind=t.QualifierKind=t.SyntaxFeature=t.RefStyle=void 0,t.localNameDeclAnnotation=t.localNameUseAnnotation=t.formulaRootAnnotation=t.appHeadNameAnnotation=t.AnnotationKind=t.headNamePart=t.flattenNameParts=t.badSequenceNode=t.badCharsNode=t.missingNode=t.identNode=t.varNode=t.badRef=t.missingRef=t.thisRowOpRef=t.commaOpRef=t.rangeOpRef=t.columnRef=t.specialRef=t.structRef=t.structRefNode=t.fieldRef=t.fieldRefNode=t.cellRefNode=void 0;const n=r(19181).__importStar(r(71510));t.RefStyle=n.RefStyle,t.SyntaxFeature=n.SyntaxFeature,t.QualifierKind=n.QualifierKind,t.CellRefKind=n.CellRefKind,t.PosKind=n.PosKind,t.CommentKind=n.CommentKind,t.NodeKind=n.NodeKind,t.NamePartKind=n.NamePartKind,t.SpecialRefId=n.SpecialRefId,t.StructRefKind=n.StructRefKind,t.BadType=n.BadType,t.errorQualifier=n.errorQualifier,t.relativeQualifier=n.relativeQualifier,t.documentQualifier=n.documentQualifier,t.sheetQualifier=n.sheetQualifier,t.identQualifier=n.identQualifier,t.sheetRangeQualifier=n.sheetRangeQualifier,t.badQualifier=n.badQualifier,t.pos=n.pos,t.cellRefError=n.cellRefError,t.cellRefSingle=n.cellRefSingle,t.cellRefRange=n.cellRefRange,t.cellRefRow=n.cellRefRow,t.cellRefCol=n.cellRefCol,t.cellRefBad=n.cellRefBad,t.formula=n.formula,t.multiLineComment=n.multiLineComment,t.singleLineComment=n.singleLineComment,t.formulaSpan=n.formulaSpan,t.literalNode=n.literalNode,t.arrayNode=n.arrayNode,t.appNode=n.appNode,t.flattenLetArgs=n.flattenLetArgs,t.indexedArg=n.indexedArg,t.letVar=n.letVar,t.letNode=n.letNode,t.flattenLambdaArgs=n.flattenLambdaArgs,t.paramName=n.paramName,t.paramDefault=n.paramDefault,t.paramNode=n.paramNode,t.lambdaParam=n.lambdaParam,t.lambdaNode=n.lambdaNode,t.operatorNode=n.operatorNode,t.wsfNode=n.wsfNode,t.parenNode=n.parenNode,t.nameNode=n.nameNode,t.identNamePart=n.identNamePart,t.cellRefNamePart=n.cellRefNamePart,t.fieldRefNamePart=n.fieldRefNamePart,t.contextNameNode=n.contextNameNode,t.cellRefNode=n.cellRefNode,t.fieldRefNode=n.fieldRefNode,t.fieldRef=n.fieldRef,t.structRefNode=n.structRefNode,t.structRef=n.structRef,t.specialRef=n.specialRef,t.columnRef=n.columnRef,t.rangeOpRef=n.rangeOpRef,t.commaOpRef=n.commaOpRef,t.thisRowOpRef=n.thisRowOpRef,t.missingRef=n.missingRef,t.badRef=n.badRef,t.varNode=n.varNode,t.identNode=n.identNode,t.missingNode=n.missingNode,t.badCharsNode=n.badCharsNode,t.badSequenceNode=n.badSequenceNode,t.flattenNameParts=n.flattenNameParts,t.headNamePart=n.headNamePart,t.AnnotationKind=n.AnnotationKind,t.appHeadNameAnnotation=n.appHeadNameAnnotation,t.formulaRootAnnotation=n.formulaRootAnnotation,t.localNameUseAnnotation=n.localNameUseAnnotation,t.localNameDeclAnnotation=n.localNameDeclAnnotation},69609:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFunc=void 0;const n=r(53698);t.getWorksheetFunc=n.getWorksheetFuncModule.getWorksheetFunc},79761:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nextFuncs=t.getWorksheetFunc=void 0;const n=r(19181).__importStar(r(69609)),i=r(53698);t.getWorksheetFunc=n.getWorksheetFunc,t.nextFuncs=i.nextFuncs.nextFuncs},85612:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.packageVersion=void 0,t.packageVersion="56.5.15"},65839:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConsistentAnonymizer=t.x10TypesSubpackage=t.syntaxSubpackage=t.runtimeSubpackage=t.recalcSubpackage=t.numfmtSubpackage=t.langSubpackage=t.commonSubpackage=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.x10=t.worker=t.style=t.funcs=t.calc=t.runtime=t.numfmt=t.analyze=t.parse=t.date=t.math=t.config=t.util=t.signature=t.value=t.formula=t.location=t.common=t.sheetName=t.FormulaAuthoringHelperSingletonGlobal=t.PluginSchedulerSingletonGlobal=t.packageVersion=void 0;const n=r(19181);var i=r(85612);Object.defineProperty(t,"packageVersion",{enumerable:!0,get:function(){return i.packageVersion}});const o=n.__importStar(r(69711));t.common=o;const a=n.__importStar(r(38057));t.location=a;const s=n.__importStar(r(94470));t.formula=s;const l=n.__importStar(r(3895));t.value=l;const u=n.__importStar(r(75350));t.signature=u;const c=n.__importStar(r(1396));t.util=c;const d=n.__importStar(r(86506));t.config=d;const m=n.__importStar(r(15770));t.math=m;const g=n.__importStar(r(12220));t.date=g;const p=n.__importStar(r(23169));t.parse=p;const h=n.__importStar(r(13756));t.analyze=h;const f=n.__importStar(r(20429));t.numfmt=f;const S=n.__importStar(r(47644));t.runtime=S;const v=n.__importStar(r(88131));t.calc=v;const y=n.__importStar(r(79761));t.funcs=y;const F=n.__importStar(r(97083));t.style=F;const C=n.__importStar(r(89786));t.worker=C;const R=n.__importStar(r(7863));t.x10=R;const b=r(59416),E=r(96532);t.PluginSchedulerSingletonGlobal=new b.PluginSchedulerSingleton,t.FormulaAuthoringHelperSingletonGlobal=new E.FormulaAuthoringHelperSingleton;var T=r(31053);Object.defineProperty(t,"sheetName",{enumerable:!0,get:function(){return T.sheetName}});var k=r(42549);Object.defineProperty(t,"getTypedFeatureGate",{enumerable:!0,get:function(){return k.getTypedFeatureGate}}),Object.defineProperty(t,"isTypedChangeGateEnabled",{enumerable:!0,get:function(){return k.isTypedChangeGateEnabled}});const P=n.__importStar(r(57777));t.commonSubpackage=P;const N=n.__importStar(r(81836));t.langSubpackage=N;const A=n.__importStar(r(40535));t.numfmtSubpackage=A;const I=n.__importStar(r(98448));t.recalcSubpackage=I;const O=n.__importStar(r(53698));t.runtimeSubpackage=O;const _=n.__importStar(r(37883));t.syntaxSubpackage=_;const M=n.__importStar(r(90277));t.x10TypesSubpackage=M;var D=r(86251);Object.defineProperty(t,"ConsistentAnonymizer",{enumerable:!0,get:function(){return D.ConsistentAnonymizer}})},83079:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.objectChecker=t.chPossiblyInfiniteNumber=t.chFiniteNumber=t.check=t.chBoolean=t.arrayChecker=t.incrementFailure=t.registerExperimentFactory=t.ExperimentKind=t.UnitExperiment=t.blankStyleValue=t.forEachProduct=t.project=t.compareProduct=t.intersectProduct=t.exceptProduct=t.meetsProduct=t.unionProduct=t.union=t.dense=t.empty=t.namedTable=t.namedFormula=t.makeGridRangeTable=t.forEachRangeInSet=t.forEachCellInSet=t.bspFactory=t.createCellSetFromRange=t.PartialWorkbook=t.blankStyle=t.knownFormatData=t.genFmt=t.locale=t.createRange=t.mathpack=t.englishLocaleData=t.blankCellFormat=t.CloningTarget=t.UnavailableKind=t.OutputMessageKind=t.isFailureOutputMessage=t.SpecialFormat=t.SpecialStyle=t.ComputeKind=t.ComputedCellKind=t.createSheetCellSetFromRange=t.sheetCellSet=t.voidCallback=t.VolatileMode=t.PartialWorkbookDocumentCollection=void 0,t.optChecker=t.oneOfChecker=void 0;const n=r(19181),i=n.__importStar(r(81476)),o=n.__importStar(r(91480)),a=n.__importStar(r(88928)),s=n.__importStar(r(74185)),l=n.__importStar(r(14408)),u=n.__importStar(r(55380)),c=n.__importStar(r(55195)),d=n.__importStar(r(25201)),m=n.__importStar(r(20456)),g=n.__importStar(r(83102)),p=n.__importStar(r(24270)),h=n.__importStar(r(48262)),f=n.__importStar(r(20778)),S=n.__importStar(r(68616)),v=n.__importStar(r(47324)),y=n.__importStar(r(86344)),F=n.__importStar(r(23623));t.PartialWorkbookDocumentCollection=s.PartialWorkbookDocumentCollection,t.VolatileMode=i.VolatileMode,t.voidCallback=s.voidCallback,t.sheetCellSet=a.sheetCellSet,t.createSheetCellSetFromRange=a.createSheetCellSetFromRange,t.ComputedCellKind=a.ComputedCellKind,t.ComputeKind=a.ComputeKind,t.SpecialStyle=a.SpecialStyle,t.SpecialFormat=a.SpecialFormat,t.isFailureOutputMessage=o.isFailureOutputMessage,t.OutputMessageKind=a.OutputMessageKind,t.UnavailableKind=a.UnavailableKind,t.CloningTarget=u.CloningTarget,t.blankCellFormat=u.blankCellFormat,t.englishLocaleData=c.englishLocaleData,t.mathpack=c.mathpack,t.createRange=c.createRange,t.locale=c.locale,t.genFmt=c.genFmt,t.knownFormatData=c.knownFormatData,t.blankStyle=c.blankStyle,t.PartialWorkbook=l.PartialWorkbook,t.createCellSetFromRange=d.createCellSetFromRange,t.bspFactory=d.bspFactory,t.forEachCellInSet=d.forEachCellInSet,t.forEachRangeInSet=d.forEachRangeInSet,t.makeGridRangeTable=h.makeGridRangeTable,t.namedFormula=f.namedFormula,t.namedTable=f.namedTable,t.empty=m.empty,t.dense=m.dense,t.union=m.union,t.unionProduct=g.unionProduct,t.meetsProduct=g.meetsProduct,t.exceptProduct=g.exceptProduct,t.intersectProduct=g.intersectProduct,t.compareProduct=g.compareProduct,t.project=g.project,t.forEachProduct=g.forEachProduct,t.blankStyleValue=p.blankStyleValue,t.UnitExperiment=y.UnitExperiment,t.ExperimentKind=S.ExperimentKind,t.registerExperimentFactory=S.registerExperimentFactory,t.incrementFailure=F.incrementFailure,t.arrayChecker=v.arrayChecker,t.chBoolean=v.chBoolean,t.check=v.check,t.chFiniteNumber=v.chFiniteNumber,t.chPossiblyInfiniteNumber=v.chPossiblyInfiniteNumber,t.objectChecker=v.objectChecker,t.oneOfChecker=v.oneOfChecker,t.optChecker=v.optChecker},5241:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustFormulaOrigin=void 0;const n=r(81836);t.adjustFormulaOrigin=n.adjust.adjustFormulaOrigin},4210:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildAnnotations=void 0;const n=r(81836);t.buildAnnotations=n.annotations.buildAnnotations},75653:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldQuoteQualifier=t.resolvePosition=t.quoteQualifier=t.formatRowRange=t.formatRow=t.formatRangePos=t.formatQualifier=t.formatName=t.formatGridRange=t.formatColRange=t.formatCol=t.formatCellPos=t.columnName=t.canonicaliseRowRange=t.canonicaliseRow=t.canonicaliseRangePos=t.canonicaliseColRange=t.canonicaliseCol=t.canonicaliseCellPos=t.canonicaliseBrackets=void 0;const n=r(81836);t.canonicaliseBrackets=n.cellFormat.canonicaliseBrackets,t.canonicaliseCellPos=n.cellFormat.canonicaliseCellPos,t.canonicaliseCol=n.cellFormat.canonicaliseCol,t.canonicaliseColRange=n.cellFormat.canonicaliseColRange,t.canonicaliseRangePos=n.cellFormat.canonicaliseRangePos,t.canonicaliseRow=n.cellFormat.canonicaliseRow,t.canonicaliseRowRange=n.cellFormat.canonicaliseRowRange,t.columnName=n.cellFormat.columnName,t.formatCellPos=n.cellFormat.formatCellPos,t.formatCol=n.cellFormat.formatCol,t.formatColRange=n.cellFormat.formatColRange,t.formatGridRange=n.cellFormat.formatGridRange,t.formatName=n.cellFormat.formatName,t.formatQualifier=n.cellFormat.formatQualifier,t.formatRangePos=n.cellFormat.formatRangePos,t.formatRow=n.cellFormat.formatRow,t.formatRowRange=n.cellFormat.formatRowRange,t.quoteQualifier=n.cellFormat.quoteQualifier,t.resolvePosition=n.cellFormat.resolvePosition,t.shouldQuoteQualifier=n.cellFormat.shouldQuoteQualifier},48339:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapPosition=t.parseQualifier=t.parseGridRangeA1=t.parseGridCellA1=t.parseCellRef=t.isR1C1IdentStart=t.SpecialPos=void 0;const n=r(81836);t.SpecialPos=n.cellParse.SpecialPos,t.isR1C1IdentStart=n.cellParse.isR1C1IdentStart,t.parseCellRef=n.cellParse.parseCellRef,t.parseGridCellA1=n.cellParse.parseGridCellA1,t.parseGridRangeA1=n.cellParse.parseGridRangeA1,t.parseQualifier=n.cellParse.parseQualifier,t.wrapPosition=n.cellParse.wrapPosition},55340:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ulsLogger=t.operatorIdToName=t.localeInfo=t.isIdentContinue=t.isIdentStart=t.isNumeral=t.getOrdinal=t.getNumberShape=t.getEnglishWorksheetFuncIdToName=t.getEnglishLocaleInfo=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishSpecialRefNames=t.englishPictureSpecial=t.englishPictureSingle=t.englishPictureDbnum=t.englishPictureColor=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishErrorNames=t.createIsThousandsPositionCallback=t.createWorksheetFuncNameCallbacks=t.calcConfig=t.TraceLevel=t.PictureSpecial=t.PictureSingle=t.PictureDbnum=t.PictureColor=t.NulLogger=t.LogCategory=t.LCID=t.Country=void 0;const n=r(81836);t.Country=n.config.Country,t.LCID=n.config.LCID,t.LogCategory=n.config.LogCategory,t.NulLogger=n.config.NulLogger,t.PictureColor=n.config.PictureColor,t.PictureDbnum=n.config.PictureDbnum,t.PictureSingle=n.config.PictureSingle,t.PictureSpecial=n.config.PictureSpecial,t.TraceLevel=n.config.TraceLevel,t.calcConfig=n.config.calcConfig,t.createWorksheetFuncNameCallbacks=n.config.createWorksheetFuncNameCallbacks,t.createIsThousandsPositionCallback=n.config.createIsThousandsPositionCallback,t.englishErrorNames=n.config.englishErrorNames,t.englishErrorTypeToName=n.config.englishErrorTypeToName,t.englishOperatorIdToName=n.config.englishOperatorIdToName,t.englishPictureColor=n.config.englishPictureColor,t.englishPictureDbnum=n.config.englishPictureDbnum,t.englishPictureSingle=n.config.englishPictureSingle,t.englishPictureSpecial=n.config.englishPictureSpecial,t.englishSpecialRefNames=n.config.englishSpecialRefNames,t.englishSysDateFormat=n.config.englishSysDateFormat,t.englishSysTimeFormat=n.config.englishSysTimeFormat,t.englishWorksheetFuncIdToName=n.config.englishWorksheetFuncIdToName,t.getEnglishLocaleInfo=n.config.getEnglishLocaleInfo,t.getEnglishWorksheetFuncIdToName=n.config.getEnglishWorksheetFuncIdToName,t.getNumberShape=n.config.getNumberShape,t.getOrdinal=n.config.getOrdinal,t.isNumeral=n.config.isNumeral,t.isIdentStart=n.config.isIdentStart,t.isIdentContinue=n.config.isIdentContinue,t.localeInfo=n.config.localeInfo,t.operatorIdToName=n.config.operatorIdToName,t.ulsLogger=n.config.ulsLogger},16811:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.tzUTC=t.tzData=t.dateTime=t.TimeGranularity=t.TimeDivision=t.Rounding=void 0;const n=r(81836);t.Rounding=n.datepack.Rounding,t.TimeDivision=n.datepack.TimeDivision,t.TimeGranularity=n.datepack.TimeGranularity,t.dateTime=n.datepack.dateTime,t.tzData=n.datepack.tzData,t.tzUTC=n.datepack.tzUTC,t.xlDatepack=n.datepack.xlDatepack},71510:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.literalNode=t.letVar=t.letNode=t.lambdaParam=t.lambdaNode=t.indexedArg=t.identQualifier=t.identNamePart=t.headNamePart=t.formulaSpan=t.singleLineComment=t.multiLineComment=t.formulaRootAnnotation=t.formula=t.flattenNameParts=t.flattenLetArgs=t.flattenLambdaArgs=t.fieldRefNode=t.contextNameNode=t.fieldRefNamePart=t.fieldRef=t.errorQualifier=t.documentQualifier=t.commaOpRef=t.columnRef=t.cellRefSingle=t.cellRefRow=t.cellRefRange=t.cellRefNode=t.cellRefNamePart=t.cellRefError=t.cellRefCol=t.cellRefBad=t.badRef=t.badQualifier=t.arrayNode=t.appNode=t.appHeadNameAnnotation=t.StructRefKind=t.SpecialRefId=t.RefStyle=t.QualifierKind=t.PosKind=t.NodeKind=t.NamePartKind=t.CommentKind=t.CellRefKind=t.BadType=t.AnnotationKind=t.SyntaxFeature=void 0,t.badSequenceNode=t.badCharsNode=t.varNode=t.identNode=t.missingNode=t.getDepthUpperBound=t.wsfNode=t.thisRowOpRef=t.structRefNode=t.structRef=t.specialRef=t.sheetRangeQualifier=t.sheetQualifier=t.relativeQualifier=t.rangeOpRef=t.pos=t.parenNode=t.paramNode=t.paramName=t.paramDefault=t.operatorNode=t.nameNode=t.missingRef=t.localNameUseAnnotation=t.localNameDeclAnnotation=void 0;const n=r(81836);t.SyntaxFeature=n.formulaModule.SyntaxFeature,t.AnnotationKind=n.formulaModule.AnnotationKind,t.BadType=n.formulaModule.BadType,t.CellRefKind=n.formulaModule.CellRefKind,t.CommentKind=n.formulaModule.CommentKind,t.NamePartKind=n.formulaModule.NamePartKind,t.NodeKind=n.formulaModule.NodeKind,t.PosKind=n.formulaModule.PosKind,t.QualifierKind=n.formulaModule.QualifierKind,t.RefStyle=n.formulaModule.RefStyle,t.SpecialRefId=n.formulaModule.SpecialRefId,t.StructRefKind=n.formulaModule.StructRefKind,t.appHeadNameAnnotation=n.formulaModule.appHeadNameAnnotation,t.appNode=n.formulaModule.appNode,t.arrayNode=n.formulaModule.arrayNode,t.badQualifier=n.formulaModule.badQualifier,t.badRef=n.formulaModule.badRef,t.cellRefBad=n.formulaModule.cellRefBad,t.cellRefCol=n.formulaModule.cellRefCol,t.cellRefError=n.formulaModule.cellRefError,t.cellRefNamePart=n.formulaModule.cellRefNamePart,t.cellRefNode=n.formulaModule.cellRefNode,t.cellRefRange=n.formulaModule.cellRefRange,t.cellRefRow=n.formulaModule.cellRefRow,t.cellRefSingle=n.formulaModule.cellRefSingle,t.columnRef=n.formulaModule.columnRef,t.commaOpRef=n.formulaModule.commaOpRef,t.documentQualifier=n.formulaModule.documentQualifier,t.errorQualifier=n.formulaModule.errorQualifier,t.fieldRef=n.formulaModule.fieldRef,t.fieldRefNamePart=n.formulaModule.fieldRefNamePart,t.contextNameNode=n.formulaModule.contextNameNode,t.fieldRefNode=n.formulaModule.fieldRefNode,t.flattenLambdaArgs=n.formulaModule.flattenLambdaArgs,t.flattenLetArgs=n.formulaModule.flattenLetArgs,t.flattenNameParts=n.formulaModule.flattenNameParts,t.formula=n.formulaModule.formula,t.formulaRootAnnotation=n.formulaModule.formulaRootAnnotation,t.multiLineComment=n.formulaModule.multiLineComment,t.singleLineComment=n.formulaModule.singleLineComment,t.formulaSpan=n.formulaModule.formulaSpan,t.headNamePart=n.formulaModule.headNamePart,t.identNamePart=n.formulaModule.identNamePart,t.identQualifier=n.formulaModule.identQualifier,t.indexedArg=n.formulaModule.indexedArg,t.lambdaNode=n.formulaModule.lambdaNode,t.lambdaParam=n.formulaModule.lambdaParam,t.letNode=n.formulaModule.letNode,t.letVar=n.formulaModule.letVar,t.literalNode=n.formulaModule.literalNode,t.localNameDeclAnnotation=n.formulaModule.localNameDeclAnnotation,t.localNameUseAnnotation=n.formulaModule.localNameUseAnnotation,t.missingRef=n.formulaModule.missingRef,t.nameNode=n.formulaModule.nameNode,t.operatorNode=n.formulaModule.operatorNode,t.paramDefault=n.formulaModule.paramDefault,t.paramName=n.formulaModule.paramName,t.paramNode=n.formulaModule.paramNode,t.parenNode=n.formulaModule.parenNode,t.pos=n.formulaModule.pos,t.rangeOpRef=n.formulaModule.rangeOpRef,t.relativeQualifier=n.formulaModule.relativeQualifier,t.sheetQualifier=n.formulaModule.sheetQualifier,t.sheetRangeQualifier=n.formulaModule.sheetRangeQualifier,t.specialRef=n.formulaModule.specialRef,t.structRef=n.formulaModule.structRef,t.structRefNode=n.formulaModule.structRefNode,t.thisRowOpRef=n.formulaModule.thisRowOpRef,t.wsfNode=n.formulaModule.wsfNode,t.getDepthUpperBound=n.formulaModule.getDepthUpperBound,t.missingNode=n.formulaModule.missingNode,t.identNode=n.formulaModule.identNode,t.varNode=n.formulaModule.varNode,t.badCharsNode=n.formulaModule.badCharsNode,t.badSequenceNode=n.formulaModule.badSequenceNode},7793:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userDefinedFuncLoc=t.unsafeGridRange=t.structRefColumnLoc=t.sheetRows=t.sheetRangeIndexes=t.sheetRange=t.sheetIndex=t.sheetGridRange=t.sheetGridCube=t.sheetGridCell=t.sheetCols=t.originCell=t.nameScope=t.nameLoc=t.lexicalSourceRange=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceCell=t.isSheetIndex=t.isSheetGridRange=t.isSheetGridCell=t.isGridCell=t.gridRange=t.gridCell=t.documentScope=t.documentLoc=t.allSheetsRange=t.NameSource=t.LexicalKind=void 0;const n=r(81836);t.LexicalKind=n.location.LexicalKind,t.NameSource=n.location.NameSource,t.allSheetsRange=n.location.allSheetsRange,t.documentLoc=n.location.documentLoc,t.documentScope=n.location.documentScope,t.gridCell=n.location.gridCell,t.gridRange=n.location.gridRange,t.isGridCell=n.location.isGridCell,t.isSheetGridCell=n.location.isSheetGridCell,t.isSheetGridRange=n.location.isSheetGridRange,t.isSheetIndex=n.location.isSheetIndex,t.lexicalSourceCell=n.location.lexicalSourceCell,t.lexicalSourceGrid=n.location.lexicalSourceGrid,t.lexicalSourceName=n.location.lexicalSourceName,t.lexicalSourceWSF=n.location.lexicalSourceWSF,t.lexicalSourceUDF=n.location.lexicalSourceUDF,t.lexicalSourceRange=n.location.lexicalSourceRange,t.nameLoc=n.location.nameLoc,t.nameScope=n.location.nameScope,t.originCell=n.location.originCell,t.sheetCols=n.location.sheetCols,t.sheetGridCell=n.location.sheetGridCell,t.sheetGridCube=n.location.sheetGridCube,t.sheetGridRange=n.location.sheetGridRange,t.sheetIndex=n.location.sheetIndex,t.sheetRange=n.location.sheetRange,t.sheetRangeIndexes=n.location.sheetRangeIndexes,t.sheetRows=n.location.sheetRows,t.structRefColumnLoc=n.location.structRefColumnLoc,t.unsafeGridRange=n.location.unsafeGridRange,t.userDefinedFuncLoc=n.location.userDefinedFuncLoc},39973:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.numberComponents=t.formatScientificLeft=void 0;const n=r(81836);t.formatScientificLeft=n.mathpack.formatScientificLeft,t.numberComponents=n.mathpack.numberComponents},67589:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ieeeMathpack=void 0;const n=r(81836);t.ieeeMathpack=n.mathpackIEEE.ieeeMathpack},77497:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlMathpack=void 0;const n=r(81836);t.xlMathpack=n.mathpackXL.xlMathpack},71273:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumberShape=t.KnownFormat=t.DateOrder=t.CurrencyFormat=t.Calendar=void 0;const n=r(81836);t.Calendar=n.numfmt.Calendar,t.CurrencyFormat=n.numfmt.CurrencyFormat,t.DateOrder=n.numfmt.DateOrder,t.KnownFormat=n.numfmt.KnownFormat,t.NumberShape=n.numfmt.NumberShape},57296:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPrinter=t.anonymizeFormula=void 0;const n=r(81836);t.anonymizeFormula=n.printService.anonymizeFormula,t.createPrinter=n.printService.createPrinter},30007:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printLocalsName=t.printLocalsGrid=t.createSimplePrintGlobals=void 0;const n=r(81836);t.createSimplePrintGlobals=n.printServiceTypes.createSimplePrintGlobals,t.printLocalsGrid=n.printServiceTypes.printLocalsGrid,t.printLocalsName=n.printServiceTypes.printLocalsName},85337:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.relabelFormula=void 0;const n=r(81836);t.relabelFormula=n.relabel.relabelFormula},97865:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canDenoteCellRef=t.canDenoteUserDefinedFunc=t.canDenoteLocalName=t.resolveGridRef=t.createResolver=void 0;const n=r(81836);t.createResolver=n.resolveService.createResolver,t.resolveGridRef=n.resolveService.resolveGridRef,t.canDenoteLocalName=n.resolveService.canDenoteLocalName,t.canDenoteUserDefinedFunc=n.resolveService.canDenoteUserDefinedFunc,t.canDenoteCellRef=n.resolveService.canDenoteCellRef},71948:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedUserDefinedFunc=t.resolvedStructRef=t.resolvedNever=t.resolvedName=t.resolvedWorksheetFunc=t.resolvedLocalName=t.resolvedDottedName=t.resolvedCellRef=t.resolveLocalsGrid=t.noOriginSheet=t.invalidStructRef=t.invalidQualifier=t.invalidCellRef=t.emptyIntersection=t.ResolvedKind=t.ResolveReasonKind=t.InvalidStructRefReason=t.InvalidQualifierReason=t.InvalidCellRefReason=void 0;const n=r(81836);t.InvalidCellRefReason=n.resolveServiceTypes.InvalidCellRefReason,t.InvalidQualifierReason=n.resolveServiceTypes.InvalidQualifierReason,t.InvalidStructRefReason=n.resolveServiceTypes.InvalidStructRefReason,t.ResolveReasonKind=n.resolveServiceTypes.ResolveReasonKind,t.ResolvedKind=n.resolveServiceTypes.ResolvedKind,t.emptyIntersection=n.resolveServiceTypes.emptyIntersection,t.invalidCellRef=n.resolveServiceTypes.invalidCellRef,t.invalidQualifier=n.resolveServiceTypes.invalidQualifier,t.invalidStructRef=n.resolveServiceTypes.invalidStructRef,t.noOriginSheet=n.resolveServiceTypes.noOriginSheet,t.resolveLocalsGrid=n.resolveServiceTypes.resolveLocalsGrid,t.resolvedCellRef=n.resolveServiceTypes.resolvedCellRef,t.resolvedDottedName=n.resolveServiceTypes.resolvedDottedName,t.resolvedLocalName=n.resolveServiceTypes.resolvedLocalName,t.resolvedWorksheetFunc=n.resolveServiceTypes.resolvedWorksheetFunc,t.resolvedName=n.resolveServiceTypes.resolvedName,t.resolvedNever=n.resolveServiceTypes.resolvedNever,t.resolvedStructRef=n.resolveServiceTypes.resolvedStructRef,t.resolvedUserDefinedFunc=n.resolveServiceTypes.resolvedUserDefinedFunc},96438:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unknownFunctionType=t.operatorStrings=t.higherOrderFunctionType=t.isVolatileFunc=t.getWorksheetFuncType=t.getWorksheetFuncEnglishName=t.getOperatorType=t.WorksheetFuncId=t.OperatorId=void 0;const n=r(81836);t.OperatorId=n.signature.OperatorId,t.WorksheetFuncId=n.signature.WorksheetFuncId,t.getOperatorType=n.signature.getOperatorType,t.getWorksheetFuncEnglishName=n.signature.getWorksheetFuncEnglishName,t.getWorksheetFuncType=n.signature.getWorksheetFuncType,t.isVolatileFunc=n.signature.isVolatileFunc,t.higherOrderFunctionType=n.signature.higherOrderFunctionType,t.operatorStrings=n.signature.operatorStrings,t.unknownFunctionType=n.signature.unknownFunctionType},73693:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.SpecialPrecs=t.SignatureType=t.OperKind=t.FunctionFlags=void 0;const n=r(81836);t.FunctionFlags=n.types.FunctionFlags,t.OperKind=n.types.OperKind,t.SignatureType=n.types.SignatureType,t.SpecialPrecs=n.types.SpecialPrecs,t.functionType=n.types.functionType},50338:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridRangeEqual=t.isSheetGridRange=t.isSheetGridCellEqual=t.isSheetGridCell=t.isRichOper=t.isReadOperEqual=t.isRangeOper=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isPrimitiveOper=t.isOperatorNode=t.isNumberOper=t.isNumberLiteralNode=t.isNameScopeEqual=t.isMissingOper=t.isMissingNode=t.isGridRangeEqual=t.isGridCellEqual=t.isGridCell=t.isErrorOper=t.isDocumentLocEqual=t.isCommaOpRefWellFormed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isBooleanOper=t.isBooleanLiteralNode=t.isBlankOper=t.isArrayOper=t.internal=t.gridRangesJoin=t.gridRangeSize=t.gridRangeJoinOpt=t.gridRangeJoin=t.gridRangeIsects=t.gridRangeIsect=t.gridRangeExcept=t.gridRangeCompare=t.gridRangeAnchor=t.gridCellRange=t.gridCellImplicitIsect=t.getWorksheetFuncId=t.getUserDefinedFuncName=t.getBoundName=t.getArguments=t.getArgType=t.forEachTileInRange=t.forEachCellInRange=t.createFailureErrorClass=t.ReasonKind=t.LangReasonKind=void 0,t.unavailable=t.shouldFieldRefBeBracketed=t.sheetGridRangeAnchor=t.notImplemented=t.normalizeCommaOpRef=t.isWriteOper=t.isWellFormed=t.isWSFNode=t.isValidArgsLength=t.isUnqualifiedNameNode=t.isStringOper=t.sheetRangeToSheetIndex=t.isSheetIndexEqual=t.isSheetIndex=void 0;const n=r(81836);t.LangReasonKind=n.util.LangReasonKind,t.ReasonKind=n.util.ReasonKind,t.createFailureErrorClass=n.util.createFailureErrorClass,t.forEachCellInRange=n.util.forEachCellInRange,t.forEachTileInRange=n.util.forEachTileInRange,t.getArgType=n.util.getArgType,t.getArguments=n.util.getArguments,t.getBoundName=n.util.getBoundName,t.getUserDefinedFuncName=n.util.getUserDefinedFuncName,t.getWorksheetFuncId=n.util.getWorksheetFuncId,t.gridCellImplicitIsect=n.util.gridCellImplicitIsect,t.gridCellRange=n.util.gridCellRange,t.gridRangeAnchor=n.util.gridRangeAnchor,t.gridRangeCompare=n.util.gridRangeCompare,t.gridRangeExcept=n.util.gridRangeExcept,t.gridRangeIsect=n.util.gridRangeIsect,t.gridRangeIsects=n.util.gridRangeIsects,t.gridRangeJoin=n.util.gridRangeJoin,t.gridRangeJoinOpt=n.util.gridRangeJoinOpt,t.gridRangeSize=n.util.gridRangeSize,t.gridRangesJoin=n.util.gridRangesJoin,t.internal=n.util.internal,t.isArrayOper=n.util.isArrayOper,t.isBlankOper=n.util.isBlankOper,t.isBooleanLiteralNode=n.util.isBooleanLiteralNode,t.isBooleanOper=n.util.isBooleanOper,t.isCommaOpClosed=n.util.isCommaOpClosed,t.isCommaOpNoBadOrMissing=n.util.isCommaOpNoBadOrMissing,t.isCommaOpRefWellFormed=n.util.isCommaOpRefWellFormed,t.isDocumentLocEqual=n.util.isDocumentLocEqual,t.isErrorOper=n.util.isErrorOper,t.isGridCell=n.util.isGridCell,t.isGridCellEqual=n.util.isGridCellEqual,t.isGridRangeEqual=n.util.isGridRangeEqual,t.isMissingNode=n.util.isMissingNode,t.isMissingOper=n.util.isMissingOper,t.isNameScopeEqual=n.util.isNameScopeEqual,t.isNumberLiteralNode=n.util.isNumberLiteralNode,t.isNumberOper=n.util.isNumberOper,t.isOperatorNode=n.util.isOperatorNode,t.isPrimitiveOper=n.util.isPrimitiveOper,t.isRangeOpClosed=n.util.isRangeOpClosed,t.isRangeOpNoMissing=n.util.isRangeOpNoMissing,t.isRangeOper=n.util.isRangeOper,t.isReadOperEqual=n.util.isReadOperEqual,t.isRichOper=n.util.isRichOper,t.isSheetGridCell=n.util.isSheetGridCell,t.isSheetGridCellEqual=n.util.isSheetGridCellEqual,t.isSheetGridRange=n.util.isSheetGridRange,t.isSheetGridRangeEqual=n.util.isSheetGridRangeEqual,t.isSheetIndex=n.util.isSheetIndex,t.isSheetIndexEqual=n.util.isSheetIndexEqual,t.sheetRangeToSheetIndex=n.util.sheetRangeToSheetIndex,t.isStringOper=n.util.isStringOper,t.isUnqualifiedNameNode=n.util.isUnqualifiedNameNode,t.isValidArgsLength=n.util.isValidArgsLength,t.isWSFNode=n.util.isWSFNode,t.isWellFormed=n.util.isWellFormed,t.isWriteOper=n.util.isWriteOper,t.normalizeCommaOpRef=n.util.normalizeCommaOpRef,t.notImplemented=n.util.notImplemented,t.sheetGridRangeAnchor=n.util.sheetGridRangeAnchor,t.shouldFieldRefBeBracketed=n.util.shouldFieldRefBeBracketed,t.unavailable=n.util.unavailable},30333:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valueErrorOper=t.trueOper=t.stringOper=t.refErrorOper=t.rangeSeqOper=t.range3DOper=t.precedents=t.numErrorOper=t.nullErrorOper=t.nameErrorOper=t.naErrorOper=t.missingOper=t.externalErrorOper=t.busyErrorOper=t.calcErrorOper=t.fieldErrorOper=t.unknownErrorOper=t.blockedErrorOper=t.connectErrorOper=t.spillErrorOper=t.gettingDataErrorOper=t.falseOper=t.errorOper=t.div0ErrorOper=t.cellStringLimit=t.booleanOper=t.blankOper=t.arrayOper=t.PrecsBound=t.ErrorType=void 0;const n=r(81836);t.ErrorType=n.value.ErrorType,t.PrecsBound=n.value.PrecsBound,t.arrayOper=n.value.arrayOper,t.blankOper=n.value.blankOper,t.booleanOper=n.value.booleanOper,t.cellStringLimit=n.value.cellStringLimit,t.div0ErrorOper=n.value.div0ErrorOper,t.errorOper=n.value.errorOper,t.falseOper=n.value.falseOper,t.gettingDataErrorOper=n.value.gettingDataErrorOper,t.spillErrorOper=n.value.spillErrorOper,t.connectErrorOper=n.value.connectErrorOper,t.blockedErrorOper=n.value.blockedErrorOper,t.unknownErrorOper=n.value.unknownErrorOper,t.fieldErrorOper=n.value.fieldErrorOper,t.calcErrorOper=n.value.calcErrorOper,t.busyErrorOper=n.value.busyErrorOper,t.externalErrorOper=n.value.externalErrorOper,t.missingOper=n.value.missingOper,t.naErrorOper=n.value.naErrorOper,t.nameErrorOper=n.value.nameErrorOper,t.nullErrorOper=n.value.nullErrorOper,t.numErrorOper=n.value.numErrorOper,t.precedents=n.value.precedents,t.range3DOper=n.value.range3DOper,t.rangeSeqOper=n.value.rangeSeqOper,t.refErrorOper=n.value.refErrorOper,t.stringOper=n.value.stringOper,t.trueOper=n.value.trueOper,t.valueErrorOper=n.value.valueErrorOper},39986:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zipVisitor=t.voidVisitor=t.visitWSFNode=t.visitQualifier=t.visitOperatorNode=t.visitFormulaNode=t.visitCellRef=t.visitAppHeadNode=t.reduceTopDown_Pledge=t.reducePledge=t.reduceBottomUp_Recursive=t.reduceBottomUp_Pledge=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_CPS=t.reduceBottomUp=t.identityVisitor=t.depthVisitor=t.constVisitor=t.composeVisitor=t.bindVisitor=t.binaryVisitor=t.ZipVisitor=t.PledgeReducer=t.IdentityVisitor=t.DelegatingVisitor=t.ConstVisitor=t.ComposeVisitor=t.BinaryVisitor=void 0;const n=r(81836);t.BinaryVisitor=n.visitor.BinaryVisitor,t.ComposeVisitor=n.visitor.ComposeVisitor,t.ConstVisitor=n.visitor.ConstVisitor,t.DelegatingVisitor=n.visitor.DelegatingVisitor,t.IdentityVisitor=n.visitor.IdentityVisitor,t.PledgeReducer=n.visitor.PledgeReducer,t.ZipVisitor=n.visitor.ZipVisitor,t.binaryVisitor=n.visitor.binaryVisitor,t.bindVisitor=n.visitor.bindVisitor,t.composeVisitor=n.visitor.composeVisitor,t.constVisitor=n.visitor.constVisitor,t.depthVisitor=n.visitor.depthVisitor,t.identityVisitor=n.visitor.identityVisitor,t.reduceBottomUp=n.visitor.reduceBottomUp,t.reduceBottomUp_CPS=n.visitor.reduceBottomUp_CPS,t.reduceBottomUp_MaxDepth=n.visitor.reduceBottomUp_MaxDepth,t.reduceBottomUp_Pledge=n.visitor.reduceBottomUp_Pledge,t.reduceBottomUp_Recursive=n.visitor.reduceBottomUp_Recursive,t.reducePledge=n.visitor.reducePledge,t.reduceTopDown_Pledge=n.visitor.reduceTopDown_Pledge,t.visitAppHeadNode=n.visitor.visitAppHeadNode,t.visitCellRef=n.visitor.visitCellRef,t.visitFormulaNode=n.visitor.visitFormulaNode,t.visitOperatorNode=n.visitor.visitOperatorNode,t.visitQualifier=n.visitor.visitQualifier,t.visitWSFNode=n.visitor.visitWSFNode,t.voidVisitor=n.visitor.voidVisitor,t.zipVisitor=n.visitor.zipVisitor},38057:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userDefinedFuncLoc=t.nameScope=t.nameLoc=t.documentScope=t.originCell=t.sheetGridCube=t.sheetGridRange=t.sheetGridCell=t.sheetRangeIndexes=t.allSheetsRange=t.gridRange=t.gridCell=t.sheetRange=t.sheetIndex=t.structRefColumnLoc=t.documentLoc=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceRange=t.lexicalSourceCell=t.sheetCols=t.sheetRows=t.NameSource=t.LexicalKind=void 0;const n=r(19181).__importStar(r(7793));t.LexicalKind=n.LexicalKind,t.NameSource=n.NameSource,t.sheetRows=n.sheetRows,t.sheetCols=n.sheetCols,t.lexicalSourceCell=n.lexicalSourceCell,t.lexicalSourceRange=n.lexicalSourceRange,t.lexicalSourceGrid=n.lexicalSourceGrid,t.lexicalSourceName=n.lexicalSourceName,t.lexicalSourceWSF=n.lexicalSourceWSF,t.lexicalSourceUDF=n.lexicalSourceUDF,t.documentLoc=n.documentLoc,t.structRefColumnLoc=n.structRefColumnLoc,t.sheetIndex=n.sheetIndex,t.sheetRange=n.sheetRange,t.gridCell=n.gridCell,t.gridRange=n.gridRange,t.allSheetsRange=n.allSheetsRange,t.sheetRangeIndexes=n.sheetRangeIndexes,t.sheetGridCell=n.sheetGridCell,t.sheetGridRange=n.sheetGridRange,t.sheetGridCube=n.sheetGridCube,t.originCell=n.originCell,t.documentScope=n.documentScope,t.nameLoc=n.nameLoc,t.nameScope=n.nameScope,t.userDefinedFuncLoc=n.userDefinedFuncLoc},15770:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatScientificLeft=t.xlMathpack=t.ieeeMathpack=t.numberComponents=void 0;const n=r(19181),i=n.__importStar(r(39973)),o=n.__importStar(r(67589)),a=n.__importStar(r(77497));t.numberComponents=i.numberComponents,t.ieeeMathpack=o.ieeeMathpack,t.xlMathpack=a.xlMathpack,t.formatScientificLeft=i.formatScientificLeft},82659:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldInstallFormat=t.parseEdit=void 0;const n=r(40535);t.parseEdit=n.edit.parseEdit,t.shouldInstallFormat=n.edit.shouldInstallFormat},88449:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNumberFormatter=void 0;const n=r(40535);t.createNumberFormatter=n.formatService.createNumberFormatter},90823:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isKnownFormatDefined=t.getSpecial=t.getSingle=t.getKnownFormat=t.getColor=t.englishXLSXKnownFormat=t.buildSingle=t.buildScientificFormat=t.buildPercentFormat=t.buildNumberFormat=t.buildMMDDYYFormat=t.buildFractionFormat=t.buildCurrencyFormat=void 0;const n=r(40535);t.buildCurrencyFormat=n.knownFormat.buildCurrencyFormat,t.buildFractionFormat=n.knownFormat.buildFractionFormat,t.buildMMDDYYFormat=n.knownFormat.buildMMDDYYFormat,t.buildNumberFormat=n.knownFormat.buildNumberFormat,t.buildPercentFormat=n.knownFormat.buildPercentFormat,t.buildScientificFormat=n.knownFormat.buildScientificFormat,t.buildSingle=n.knownFormat.buildSingle,t.englishXLSXKnownFormat=n.knownFormat.englishXLSXKnownFormat,t.getColor=n.knownFormat.getColor,t.getKnownFormat=n.knownFormat.getKnownFormat,t.getSingle=n.knownFormat.getSingle,t.getSpecial=n.knownFormat.getSpecial,t.isKnownFormatDefined=n.knownFormat.isKnownFormatDefined},32861:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBundledLocaleInfo=t.convertKnownLCID=void 0;const n=r(40535);t.convertKnownLCID=n.localeData.convertKnownLCID,t.getBundledLocaleInfo=n.localeData.getBundledLocaleInfo},25856:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRibbonFormat=t.RibbonFormat=void 0;const n=r(40535);t.RibbonFormat=n.ribbonFormat.RibbonFormat,t.getRibbonFormat=n.ribbonFormat.getRibbonFormat},94591:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tooWide=t.stringEdit=t.renderedValueToString=t.renderedValue=t.renderInfiniteWidth=t.renderCallback=t.formatLocIFormat=t.formatLocKnownFormat=t.FormatLocKind=t.previousFormatFailure=t.otherEdit=t.numberEdit=t.notValueString=t.notFormatString=t.noFormatPart=t.memoizedRenderCallback=t.isSystemCultureTag=t.isHashesValue=t.isFormatCultureEqual=t.hashesValue=t.fractionOverflow=t.formulaEdit=t.formattedValue=t.formattedUnitString=t.formattedUnitGeneral=t.formattedUnitFlexible=t.formattedUnitBlank=t.evalFormatLocalsGrid=t.dateOverflow=t.createFormatGlobals=t.aggregationError=t.ReasonKind=t.NumberFormatSource=t.NamedColor=t.GetTimeKind=t.FormattedUnitKind=t.FormatValueType=t.FormatReasonKind=t.FormatCurrency=t.EditKind=t.CultureTag=t.Clip=t.BidiDate=t.Alignment=void 0;const n=r(40535);t.Alignment=n.serviceTypes.Alignment,t.BidiDate=n.serviceTypes.BidiDate,t.Clip=n.serviceTypes.Clip,t.CultureTag=n.serviceTypes.CultureTag,t.EditKind=n.serviceTypes.EditKind,t.FormatCurrency=n.serviceTypes.FormatCurrency,t.FormatReasonKind=n.serviceTypes.FormatReasonKind,t.FormatValueType=n.serviceTypes.FormatValueType,t.FormattedUnitKind=n.serviceTypes.FormattedUnitKind,t.GetTimeKind=n.serviceTypes.GetTimeKind,t.NamedColor=n.serviceTypes.NamedColor,t.NumberFormatSource=n.serviceTypes.NumberFormatSource,t.ReasonKind=n.serviceTypes.ReasonKind,t.aggregationError=n.serviceTypes.aggregationError,t.createFormatGlobals=n.serviceTypes.createFormatGlobals,t.dateOverflow=n.serviceTypes.dateOverflow,t.evalFormatLocalsGrid=n.serviceTypes.evalFormatLocalsGrid,t.formattedUnitBlank=n.serviceTypes.formattedUnitBlank,t.formattedUnitFlexible=n.serviceTypes.formattedUnitFlexible,t.formattedUnitGeneral=n.serviceTypes.formattedUnitGeneral,t.formattedUnitString=n.serviceTypes.formattedUnitString,t.formattedValue=n.serviceTypes.formattedValue,t.formulaEdit=n.serviceTypes.formulaEdit,t.fractionOverflow=n.serviceTypes.fractionOverflow,t.hashesValue=n.serviceTypes.hashesValue,t.isFormatCultureEqual=n.serviceTypes.isFormatCultureEqual,t.isHashesValue=n.serviceTypes.isHashesValue,t.isSystemCultureTag=n.serviceTypes.isSystemCultureTag,t.memoizedRenderCallback=n.serviceTypes.memoizedRenderCallback,t.noFormatPart=n.serviceTypes.noFormatPart,t.notFormatString=n.serviceTypes.notFormatString,t.notValueString=n.serviceTypes.notValueString,t.numberEdit=n.serviceTypes.numberEdit,t.otherEdit=n.serviceTypes.otherEdit,t.previousFormatFailure=n.serviceTypes.previousFormatFailure,t.FormatLocKind=n.serviceTypes.FormatLocKind,t.formatLocKnownFormat=n.serviceTypes.formatLocKnownFormat,t.formatLocIFormat=n.serviceTypes.formatLocIFormat,t.renderCallback=n.serviceTypes.renderCallback,t.renderInfiniteWidth=n.serviceTypes.renderInfiniteWidth,t.renderedValue=n.serviceTypes.renderedValue,t.renderedValueToString=n.serviceTypes.renderedValueToString,t.stringEdit=n.serviceTypes.stringEdit,t.tooWide=n.serviceTypes.tooWide},77531:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toXLNumber=t.renderFormat=t.initUtilGlobals=t.getValueEditOperKind=t.getFormatString=t.applyValueEdit=void 0;const n=r(40535);t.applyValueEdit=n.util.applyValueEdit,t.getFormatString=n.util.getFormatString,t.getValueEditOperKind=n.util.getValueEditOperKind,t.initUtilGlobals=n.util.initUtilGlobals,t.renderFormat=n.util.renderFormat,t.toXLNumber=n.util.toXLNumber},20429:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.englishXLSXKnownFormat=t.isKnownFormatDefined=t.getKnownFormat=t.Calendar=t.NumberShape=t.DateOrder=t.CurrencyFormat=t.KnownFormat=t.evalFormatLocalsGrid=t.createFormatGlobals=t.NumberFormatSource=t.otherEdit=t.numberEdit=t.stringEdit=t.formulaEdit=t.EditKind=t.renderedValueToString=t.renderInfiniteWidth=t.memoizedRenderCallback=t.renderCallback=t.isHashesValue=t.hashesValue=t.renderedValue=t.formattedValue=t.formattedUnitFlexible=t.formattedUnitBlank=t.formattedUnitString=t.formattedUnitGeneral=t.FormattedUnitKind=t.Clip=t.GetTimeKind=t.Alignment=t.NamedColor=t.FormatCurrency=t.CultureTag=t.BidiDate=t.FormatValueType=t.formatLocIFormat=t.formatLocKnownFormat=t.FormatLocKind=t.previousFormatFailure=t.fractionOverflow=t.dateOverflow=t.aggregationError=t.tooWide=t.noFormatPart=t.notFormatString=t.notValueString=t.ReasonKind=t.FormatReasonKind=void 0,t.toXLNumber=t.applyValueEdit=t.getValueEditOperKind=t.createNumberFormatter=t.shouldInstallFormat=t.getRibbonFormat=t.RibbonFormat=void 0;const n=r(19181),i=n.__importStar(r(94591)),o=n.__importStar(r(71273)),a=n.__importStar(r(90823)),s=n.__importStar(r(25856)),l=n.__importStar(r(82659)),u=n.__importStar(r(88449)),c=n.__importStar(r(77531));t.FormatReasonKind=i.FormatReasonKind,t.ReasonKind=i.ReasonKind,t.notValueString=i.notValueString,t.notFormatString=i.notFormatString,t.noFormatPart=i.noFormatPart,t.tooWide=i.tooWide,t.aggregationError=i.aggregationError,t.dateOverflow=i.dateOverflow,t.fractionOverflow=i.fractionOverflow,t.previousFormatFailure=i.previousFormatFailure,t.FormatLocKind=i.FormatLocKind,t.formatLocKnownFormat=i.formatLocKnownFormat,t.formatLocIFormat=i.formatLocIFormat,t.FormatValueType=i.FormatValueType,t.BidiDate=i.BidiDate,t.CultureTag=i.CultureTag,t.FormatCurrency=i.FormatCurrency,t.NamedColor=i.NamedColor,t.Alignment=i.Alignment,t.GetTimeKind=i.GetTimeKind,t.Clip=i.Clip,t.FormattedUnitKind=i.FormattedUnitKind,t.formattedUnitGeneral=i.formattedUnitGeneral,t.formattedUnitString=i.formattedUnitString,t.formattedUnitBlank=i.formattedUnitBlank,t.formattedUnitFlexible=i.formattedUnitFlexible,t.formattedValue=i.formattedValue,t.renderedValue=i.renderedValue,t.hashesValue=i.hashesValue,t.isHashesValue=i.isHashesValue,t.renderCallback=i.renderCallback,t.memoizedRenderCallback=i.memoizedRenderCallback,t.renderInfiniteWidth=i.renderInfiniteWidth,t.renderedValueToString=i.renderedValueToString,t.EditKind=i.EditKind,t.formulaEdit=i.formulaEdit,t.stringEdit=i.stringEdit,t.numberEdit=i.numberEdit,t.otherEdit=i.otherEdit,t.NumberFormatSource=i.NumberFormatSource,t.createFormatGlobals=i.createFormatGlobals,t.evalFormatLocalsGrid=i.evalFormatLocalsGrid,t.KnownFormat=o.KnownFormat,t.CurrencyFormat=o.CurrencyFormat,t.DateOrder=o.DateOrder,t.NumberShape=o.NumberShape,t.Calendar=o.Calendar,t.getKnownFormat=a.getKnownFormat,t.isKnownFormatDefined=a.isKnownFormatDefined,t.englishXLSXKnownFormat=a.englishXLSXKnownFormat,t.RibbonFormat=s.RibbonFormat,t.getRibbonFormat=s.getRibbonFormat,t.shouldInstallFormat=l.shouldInstallFormat,t.createNumberFormatter=u.createNumberFormatter,t.getValueEditOperKind=c.getValueEditOperKind,t.applyValueEdit=c.applyValueEdit,t.toXLNumber=c.toXLNumber},25005:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFieldRef=t.isUnbracketedField=void 0;const n=r(37883);t.isUnbracketedField=n.parseFieldRefModule.isUnbracketedField,t.parseFieldRef=n.parseFieldRefModule.parseFieldRef},31873:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseResultHelper=t.CaretInsideArrayNodeIdentityVisitor=t.ExtractLetVisitor=void 0;const n=r(37883);t.ExtractLetVisitor=n.parseResultHelperModule.ExtractLetVisitor,t.CaretInsideArrayNodeIdentityVisitor=n.parseResultHelperModule.CaretInsideArrayNodeIdentityVisitor,t.parseResultHelper=n.parseResultHelperModule.parseResultHelper},77721:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createParser=void 0;const n=r(37883);t.createParser=n.parserService.createParser},96547:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseLocals=t.notFormulaString=t.createParseGlobals=t.ReasonKind=void 0;const n=r(37883);t.ReasonKind=n.parseServiceTypes.ReasonKind,t.createParseGlobals=n.parseServiceTypes.createParseGlobals,t.notFormulaString=n.parseServiceTypes.notFormulaString,t.parseLocals=n.parseServiceTypes.parseLocals},65538:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.subOperatorToken=t.specialRefToken=t.spacesToken=t.rowSepToken=t.rightSQuoteToken=t.rightParenToken=t.rightBracketToken=t.rightBraceToken=t.rangeOperatorToken=t.qualSepToken=t.powOperatorToken=t.poundOperatorToken=t.percentOperatorToken=t.operatorToken=t.neOperatorToken=t.mulOperatorToken=t.ltOperatorToken=t.literalToken=t.listSepToken=t.leftSQuoteToken=t.leftParenToken=t.leftBracketToken=t.leftBraceToken=t.leOperatorToken=t.isNumberLikeOper=t.isBadNumberOper=t.isBadErrorOper=t.identToken=t.identOrBooleanToken=t.gtOperatorToken=t.geOperatorToken=t.escapeToken=t.eqOperatorToken=t.endToken=t.dotSepToken=t.divOperatorToken=t.concatOperatorToken=t.colSepToken=t.cellRefR1C1Token=t.cellRefA1Token=t.badNumberOper=t.badErrorOper=t.atOperatorToken=t.assignSepToken=t.appendToken=t.addOperatorToken=t.TokenOperKind=t.TokenKind=t.SepId=t.DelimId=void 0,t.multiLineCommentToken=t.singleLineCommentToken=t.unexpectedToken=void 0;const n=r(37883);t.DelimId=n.token.DelimId,t.SepId=n.token.SepId,t.TokenKind=n.token.TokenKind,t.TokenOperKind=n.token.TokenOperKind,t.addOperatorToken=n.token.addOperatorToken,t.appendToken=n.token.appendToken,t.assignSepToken=n.token.assignSepToken,t.atOperatorToken=n.token.atOperatorToken,t.badErrorOper=n.token.badErrorOper,t.badNumberOper=n.token.badNumberOper,t.cellRefA1Token=n.token.cellRefA1Token,t.cellRefR1C1Token=n.token.cellRefR1C1Token,t.colSepToken=n.token.colSepToken,t.concatOperatorToken=n.token.concatOperatorToken,t.divOperatorToken=n.token.divOperatorToken,t.dotSepToken=n.token.dotSepToken,t.endToken=n.token.endToken,t.eqOperatorToken=n.token.eqOperatorToken,t.escapeToken=n.token.escapeToken,t.geOperatorToken=n.token.geOperatorToken,t.gtOperatorToken=n.token.gtOperatorToken,t.identOrBooleanToken=n.token.identOrBooleanToken,t.identToken=n.token.identToken,t.isBadErrorOper=n.token.isBadErrorOper,t.isBadNumberOper=n.token.isBadNumberOper,t.isNumberLikeOper=n.token.isNumberLikeOper,t.leOperatorToken=n.token.leOperatorToken,t.leftBraceToken=n.token.leftBraceToken,t.leftBracketToken=n.token.leftBracketToken,t.leftParenToken=n.token.leftParenToken,t.leftSQuoteToken=n.token.leftSQuoteToken,t.listSepToken=n.token.listSepToken,t.literalToken=n.token.literalToken,t.ltOperatorToken=n.token.ltOperatorToken,t.mulOperatorToken=n.token.mulOperatorToken,t.neOperatorToken=n.token.neOperatorToken,t.operatorToken=n.token.operatorToken,t.percentOperatorToken=n.token.percentOperatorToken,t.poundOperatorToken=n.token.poundOperatorToken,t.powOperatorToken=n.token.powOperatorToken,t.qualSepToken=n.token.qualSepToken,t.rangeOperatorToken=n.token.rangeOperatorToken,t.rightBraceToken=n.token.rightBraceToken,t.rightBracketToken=n.token.rightBracketToken,t.rightParenToken=n.token.rightParenToken,t.rightSQuoteToken=n.token.rightSQuoteToken,t.rowSepToken=n.token.rowSepToken,t.spacesToken=n.token.spacesToken,t.specialRefToken=n.token.specialRefToken,t.subOperatorToken=n.token.subOperatorToken,t.unexpectedToken=n.token.unexpectedToken,t.singleLineCommentToken=n.token.singleLineCommentToken,t.multiLineCommentToken=n.token.multiLineCommentToken},52578:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tokenizeFormula=void 0;const n=r(37883);t.tokenizeFormula=n.tokenizeFormulaModule.tokenizeFormula},23169:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseResultHelper=t.createParser=t.notFormulaString=t.parseLocals=t.ReasonKind=t.createParseGlobals=void 0;const n=r(19181),i=n.__importStar(r(96547)),o=n.__importStar(r(77721)),a=n.__importStar(r(31873));t.createParseGlobals=i.createParseGlobals,t.ReasonKind=i.ReasonKind,t.parseLocals=i.parseLocals,t.notFormulaString=i.notFormulaString,t.createParser=o.createParser,t.parseResultHelper=a.parseResultHelper},65524:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCompiler=t.compiledFormulaTerm=t.compiledFormula=void 0;const n=r(53698);t.compiledFormula=n.compilerService.compiledFormula,t.compiledFormulaTerm=n.compilerService.compiledFormulaTerm,t.createCompiler=n.compilerService.createCompiler},74226:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEvaluator=void 0;const n=r(53698);t.createEvaluator=n.evaluatorService.createEvaluator},83056:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rangeValues=t.machine=t.isRangeValues=t.DerefOperKind=void 0;const n=r(53698);t.DerefOperKind=n.extensionTypes.DerefOperKind,t.isRangeValues=n.extensionTypes.isRangeValues,t.machine=n.extensionTypes.machine,t.rangeValues=n.extensionTypes.rangeValues},20665:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.earlyReturn=t.EarlyReturnKind=t.singleReadOperType=t.refToVal=t.readOperType=t.MachineRuntime=t.breakTransition=t.nextTransition=t.callMachineTransition=t.nextOnSuccessReceiver=t.machineCall=t.isMachineCall=t.ThenMachine=t.MachineCallKind=t.ArrayMachine=void 0;const n=r(53698);t.ArrayMachine=n.machine.ArrayMachine,t.MachineCallKind=n.machine.MachineCallKind,t.ThenMachine=n.machine.ThenMachine,t.isMachineCall=n.machine.isMachineCall,t.machineCall=n.machine.machineCall,t.nextOnSuccessReceiver=n.machine.nextOnSuccessReceiver,t.callMachineTransition=n.machine.callMachineTransition,t.nextTransition=n.machine.nextTransition,t.breakTransition=n.machine.breakTransition,t.MachineRuntime=n.machine.MachineRuntime,t.readOperType=n.machine.readOperType,t.refToVal=n.machine.refToVal,t.singleReadOperType=n.machine.singleReadOperType,t.EarlyReturnKind=n.machine.EarlyReturnKind,t.earlyReturn=n.machine.earlyReturn},48262:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGridRangeTable=t.gridRangeDistance=void 0;const n=r(53698);t.gridRangeDistance=n.rtree.gridRangeDistance,t.makeGridRangeTable=n.rtree.makeGridRangeTable},53750:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userDefinedFunc=t.stopped=t.previousNameFailure=t.previousFailure=t.pendingValue=t.breaked=t.paused=t.nameCycle=t.limitExceeded=t.interval=t.illFormedFormula=t.finalValue=t.evalLocals=t.evalGlobals=t.createCompileGlobals=t.compileLocalsName=t.compileLocalsGrid=t.cellWellFormedFormula=t.cellFormula=t.cellCycle=t.runtimePositionFirstOrderFunc=t.runtimePositionFormulaRoot=t.runtimePositionEtaLambdaBody=t.runtimePositionLambdaParam=t.runtimePositionLambdaRoot=t.runtimePositionLetVal=t.RuntimePositionKind=t.StepAction=t.ReasonKind=t.LimitKind=t.Interrupt=t.CellKind=void 0;const n=r(53698);t.CellKind=n.serviceTypes.CellKind,t.Interrupt=n.serviceTypes.Interrupt,t.LimitKind=n.serviceTypes.LimitKind,t.ReasonKind=n.serviceTypes.ReasonKind,t.StepAction=n.serviceTypes.StepAction,t.RuntimePositionKind=n.serviceTypes.RuntimePositionKind,t.runtimePositionLetVal=n.serviceTypes.runtimePositionLetVal,t.runtimePositionLambdaRoot=n.serviceTypes.runtimePositionLambdaRoot,t.runtimePositionLambdaParam=n.serviceTypes.runtimePositionLambdaParam,t.runtimePositionEtaLambdaBody=n.serviceTypes.runtimePositionEtaLambdaBody,t.runtimePositionFormulaRoot=n.serviceTypes.runtimePositionFormulaRoot,t.runtimePositionFirstOrderFunc=n.serviceTypes.runtimePositionFirstOrderFunc,t.cellCycle=n.serviceTypes.cellCycle,t.cellFormula=n.serviceTypes.cellFormula,t.cellWellFormedFormula=n.serviceTypes.cellWellFormedFormula,t.compileLocalsGrid=n.serviceTypes.compileLocalsGrid,t.compileLocalsName=n.serviceTypes.compileLocalsName,t.createCompileGlobals=n.serviceTypes.createCompileGlobals,t.evalGlobals=n.serviceTypes.evalGlobals,t.evalLocals=n.serviceTypes.evalLocals,t.finalValue=n.serviceTypes.finalValue,t.illFormedFormula=n.serviceTypes.illFormedFormula,t.interval=n.serviceTypes.interval,t.limitExceeded=n.serviceTypes.limitExceeded,t.nameCycle=n.serviceTypes.nameCycle,t.paused=n.serviceTypes.paused,t.breaked=n.serviceTypes.breaked,t.pendingValue=n.serviceTypes.pendingValue,t.previousFailure=n.serviceTypes.previousFailure,t.previousNameFailure=n.serviceTypes.previousNameFailure,t.stopped=n.serviceTypes.stopped,t.userDefinedFunc=n.serviceTypes.userDefinedFunc},36837:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecordOper=t.LambdaOper=void 0;const n=r(53698);t.LambdaOper=n.value.LambdaOper,t.RecordOper=n.value.RecordOper},47644:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extension=t.createEvaluator=t.createCompiler=t.RecordOper=t.LambdaOper=t.LimitKind=t.limitExceeded=t.createCompileGlobals=t.illFormedFormula=t.compileLocalsName=t.compileLocalsGrid=t.evalLocals=t.evalGlobals=t.previousNameFailure=t.previousFailure=t.breaked=t.paused=t.cellCycle=t.nameCycle=t.stopped=t.userDefinedFunc=t.cellFormula=t.cellWellFormedFormula=t.pendingValue=t.finalValue=t.runtimePositionFirstOrderFunc=t.runtimePositionFormulaRoot=t.runtimePositionEtaLambdaBody=t.runtimePositionLambdaParam=t.runtimePositionLambdaRoot=t.runtimePositionLetVal=t.RuntimePositionKind=t.StepAction=t.Interrupt=t.CellKind=t.interval=t.ReasonKind=void 0;const n=r(19181),i=n.__importStar(r(53750)),o=n.__importStar(r(65524)),a=n.__importStar(r(74226)),s=n.__importStar(r(36837)),l=n.__importStar(r(98451));t.ReasonKind=i.ReasonKind,t.interval=i.interval,t.CellKind=i.CellKind,t.Interrupt=i.Interrupt,t.StepAction=i.StepAction,t.RuntimePositionKind=i.RuntimePositionKind,t.runtimePositionLetVal=i.runtimePositionLetVal,t.runtimePositionLambdaRoot=i.runtimePositionLambdaRoot,t.runtimePositionLambdaParam=i.runtimePositionLambdaParam,t.runtimePositionEtaLambdaBody=i.runtimePositionEtaLambdaBody,t.runtimePositionFormulaRoot=i.runtimePositionFormulaRoot,t.runtimePositionFirstOrderFunc=i.runtimePositionFirstOrderFunc,t.finalValue=i.finalValue,t.pendingValue=i.pendingValue,t.cellWellFormedFormula=i.cellWellFormedFormula,t.cellFormula=i.cellFormula,t.userDefinedFunc=i.userDefinedFunc,t.stopped=i.stopped,t.nameCycle=i.nameCycle,t.cellCycle=i.cellCycle,t.paused=i.paused,t.breaked=i.breaked,t.previousFailure=i.previousFailure,t.previousNameFailure=i.previousNameFailure,t.evalGlobals=i.evalGlobals,t.evalLocals=i.evalLocals,t.compileLocalsGrid=i.compileLocalsGrid,t.compileLocalsName=i.compileLocalsName,t.illFormedFormula=i.illFormedFormula,t.createCompileGlobals=i.createCompileGlobals,t.limitExceeded=i.limitExceeded,t.LimitKind=i.LimitKind,t.LambdaOper=s.LambdaOper,t.RecordOper=s.RecordOper,t.createCompiler=o.createCompiler,t.createEvaluator=a.createEvaluator,t.extension=l},75350:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFuncType=t.getOperatorType=t.unknownFunctionType=t.functionType=t.SpecialPrecs=t.WorksheetFuncId=t.OperatorId=t.FunctionFlags=t.SignatureType=void 0;const n=r(19181),i=n.__importStar(r(96438)),o=n.__importStar(r(73693));t.SignatureType=o.SignatureType,t.FunctionFlags=o.FunctionFlags,t.OperatorId=i.OperatorId,t.WorksheetFuncId=i.WorksheetFuncId,t.SpecialPrecs=o.SpecialPrecs,t.functionType=o.functionType,t.unknownFunctionType=i.unknownFunctionType,t.getOperatorType=i.getOperatorType,t.getWorksheetFuncType=i.getWorksheetFuncType},92217:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VerticalAlignment=t.PatternType=t.HorizontalAlignment=t.FontVerticalAlignment=t.FontUnderline=t.FillKind=t.BorderLineType=void 0;const n=r(81836);t.BorderLineType=n.styleServiceTypes.BorderLineType,t.FillKind=n.styleServiceTypes.FillKind,t.FontUnderline=n.styleServiceTypes.FontUnderline,t.FontVerticalAlignment=n.styleServiceTypes.FontVerticalAlignment,t.HorizontalAlignment=n.styleServiceTypes.HorizontalAlignment,t.PatternType=n.styleServiceTypes.PatternType,t.VerticalAlignment=n.styleServiceTypes.VerticalAlignment},97083:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VerticalAlignment=t.HorizontalAlignment=t.BorderLineType=t.PatternType=t.FillKind=t.FontVerticalAlignment=t.FontUnderline=void 0;const n=r(19181).__importStar(r(92217));t.FontUnderline=n.FontUnderline,t.FontVerticalAlignment=n.FontVerticalAlignment,t.FillKind=n.FillKind,t.PatternType=n.PatternType,t.BorderLineType=n.BorderLineType,t.HorizontalAlignment=n.HorizontalAlignment,t.VerticalAlignment=n.VerticalAlignment},3686:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runSmokeTest=t.cancelSmokeTest=void 0,t.cancelSmokeTest=function(){},t.runSmokeTest=function(){return Promise.resolve()}},1396:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReasonKind=t.isSuccess=t.successUndefined=t.failure=t.success=t.ResultKind=t.isReadOperEqual=t.isWriteOper=t.isPrimitiveOper=t.isRichOper=t.isBlankOper=t.isMissingOper=t.isArrayOper=t.isRangeOper=t.isErrorOper=t.isBooleanOper=t.isStringOper=t.isNumberOper=t.isValidArgsLength=t.getArgType=t.getArguments=t.gridCellRange=t.sheetGridRangeAnchor=t.gridRangeAnchor=t.isWSFNode=t.isOperatorNode=t.isUnqualifiedNameNode=t.isWellFormed=t.isSheetGridRangeEqual=t.isSheetGridCellEqual=t.isGridRangeEqual=t.isGridCellEqual=t.isNameScopeEqual=t.isSheetIndexEqual=t.isDocumentLocEqual=t.gridRangeSize=t.gridRangeExcept=t.gridRangeCompare=t.gridCellImplicitIsect=t.gridRangeIsects=t.gridRangeIsect=t.gridRangesJoin=t.gridRangeJoinOpt=t.gridRangeJoin=t.forEachTileInRange=t.forEachCellInRange=t.isSheetGridCell=t.isGridCell=t.isSheetGridRange=t.isSheetIndex=void 0,t.ConstVisitor=t.identityVisitor=t.IdentityVisitor=t.visitCellRef=t.visitQualifier=t.visitAppHeadNode=t.visitWSFNode=t.visitOperatorNode=t.visitFormulaNode=t.resolveGridRef=t.createResolver=t.resolvedDottedName=t.resolvedNever=t.resolvedStructRef=t.resolvedWorksheetFunc=t.resolvedLocalName=t.resolvedUserDefinedFunc=t.resolvedCellRef=t.resolvedName=t.ResolvedKind=t.emptyIntersection=t.InvalidStructRefReason=t.invalidStructRef=t.InvalidCellRefReason=t.invalidCellRef=t.InvalidQualifierReason=t.invalidQualifier=t.noOriginSheet=t.ResolveReasonKind=t.resolveLocalsGrid=t.wrapPosition=t.parseQualifier=t.parseGridRangeA1=t.parseGridCellA1=t.formatName=t.formatGridRange=t.formatQualifier=t.formatRangePos=t.formatCellPos=t.formatColRange=t.formatRowRange=t.formatCol=t.formatRow=t.resolvePosition=t.columnName=t.createFailureErrorClass=t.javaScriptError=t.internal=t.unavailable=t.notImplemented=void 0,t.relabelFormula=t.createPrinter=t.printLocalsName=t.printLocalsGrid=t.createSimplePrintGlobals=t.buildAnnotations=t.reducePledge=t.reduceBottomUp=t.composeVisitor=t.ComposeVisitor=t.binaryVisitor=t.BinaryVisitor=t.DelegatingVisitor=t.voidVisitor=t.constVisitor=void 0;const n=r(19181),i=n.__importStar(r(75653)),o=n.__importStar(r(48339)),a=n.__importStar(r(50338)),s=n.__importStar(r(71948)),l=n.__importStar(r(33436)),u=n.__importStar(r(97865)),c=n.__importStar(r(39986)),d=n.__importStar(r(4210)),m=n.__importStar(r(85337)),g=n.__importStar(r(30007)),p=n.__importStar(r(57296));t.isSheetIndex=a.isSheetIndex,t.isSheetGridRange=a.isSheetGridRange,t.isGridCell=a.isGridCell,t.isSheetGridCell=a.isSheetGridCell,t.forEachCellInRange=a.forEachCellInRange,t.forEachTileInRange=a.forEachTileInRange,t.gridRangeJoin=a.gridRangeJoin,t.gridRangeJoinOpt=a.gridRangeJoinOpt,t.gridRangesJoin=a.gridRangesJoin,t.gridRangeIsect=a.gridRangeIsect,t.gridRangeIsects=a.gridRangeIsects,t.gridCellImplicitIsect=a.gridCellImplicitIsect,t.gridRangeCompare=a.gridRangeCompare,t.gridRangeExcept=a.gridRangeExcept,t.gridRangeSize=a.gridRangeSize,t.isDocumentLocEqual=a.isDocumentLocEqual,t.isSheetIndexEqual=a.isSheetIndexEqual,t.isNameScopeEqual=a.isNameScopeEqual,t.isGridCellEqual=a.isGridCellEqual,t.isGridRangeEqual=a.isGridRangeEqual,t.isSheetGridCellEqual=a.isSheetGridCellEqual,t.isSheetGridRangeEqual=a.isSheetGridRangeEqual,t.isWellFormed=a.isWellFormed,t.isUnqualifiedNameNode=a.isUnqualifiedNameNode,t.isOperatorNode=a.isOperatorNode,t.isWSFNode=a.isWSFNode,t.gridRangeAnchor=a.gridRangeAnchor,t.sheetGridRangeAnchor=a.sheetGridRangeAnchor,t.gridCellRange=a.gridCellRange,t.getArguments=a.getArguments,t.getArgType=a.getArgType,t.isValidArgsLength=a.isValidArgsLength,t.isNumberOper=a.isNumberOper,t.isStringOper=a.isStringOper,t.isBooleanOper=a.isBooleanOper,t.isErrorOper=a.isErrorOper,t.isRangeOper=a.isRangeOper,t.isArrayOper=a.isArrayOper,t.isMissingOper=a.isMissingOper,t.isBlankOper=a.isBlankOper,t.isRichOper=a.isRichOper,t.isPrimitiveOper=a.isPrimitiveOper,t.isWriteOper=a.isWriteOper,t.isReadOperEqual=a.isReadOperEqual,t.ResultKind=l.ResultKind,t.success=l.success,t.failure=l.failure,t.successUndefined=l.successUndefined,t.isSuccess=l.isSuccess,t.ReasonKind=a.ReasonKind,t.notImplemented=a.notImplemented,t.unavailable=a.unavailable,t.internal=a.internal,t.javaScriptError=l.javaScriptError,t.createFailureErrorClass=a.createFailureErrorClass,t.columnName=i.columnName,t.resolvePosition=i.resolvePosition,t.formatRow=i.formatRow,t.formatCol=i.formatCol,t.formatRowRange=i.formatRowRange,t.formatColRange=i.formatColRange,t.formatCellPos=i.formatCellPos,t.formatRangePos=i.formatRangePos,t.formatQualifier=i.formatQualifier,t.formatGridRange=i.formatGridRange,t.formatName=i.formatName,t.parseGridCellA1=o.parseGridCellA1,t.parseGridRangeA1=o.parseGridRangeA1,t.parseQualifier=o.parseQualifier,t.wrapPosition=o.wrapPosition,t.resolveLocalsGrid=s.resolveLocalsGrid,t.ResolveReasonKind=s.ResolveReasonKind,t.noOriginSheet=s.noOriginSheet,t.invalidQualifier=s.invalidQualifier,t.InvalidQualifierReason=s.InvalidQualifierReason,t.invalidCellRef=s.invalidCellRef,t.InvalidCellRefReason=s.InvalidCellRefReason,t.invalidStructRef=s.invalidStructRef,t.InvalidStructRefReason=s.InvalidStructRefReason,t.emptyIntersection=s.emptyIntersection,t.ResolvedKind=s.ResolvedKind,t.resolvedName=s.resolvedName,t.resolvedCellRef=s.resolvedCellRef,t.resolvedUserDefinedFunc=s.resolvedUserDefinedFunc,t.resolvedLocalName=s.resolvedLocalName,t.resolvedWorksheetFunc=s.resolvedWorksheetFunc,t.resolvedStructRef=s.resolvedStructRef,t.resolvedNever=s.resolvedNever,t.resolvedDottedName=s.resolvedDottedName,t.createResolver=u.createResolver,t.resolveGridRef=u.resolveGridRef,t.visitFormulaNode=c.visitFormulaNode,t.visitOperatorNode=c.visitOperatorNode,t.visitWSFNode=c.visitWSFNode,t.visitAppHeadNode=c.visitAppHeadNode,t.visitQualifier=c.visitQualifier,t.visitCellRef=c.visitCellRef,t.IdentityVisitor=c.IdentityVisitor,t.identityVisitor=c.identityVisitor,t.ConstVisitor=c.ConstVisitor,t.constVisitor=c.constVisitor,t.voidVisitor=c.voidVisitor,t.DelegatingVisitor=c.DelegatingVisitor,t.BinaryVisitor=c.BinaryVisitor,t.binaryVisitor=c.binaryVisitor,t.ComposeVisitor=c.ComposeVisitor,t.composeVisitor=c.composeVisitor,t.reduceBottomUp=c.reduceBottomUp,t.reducePledge=c.reducePledge,t.buildAnnotations=d.buildAnnotations,t.createSimplePrintGlobals=g.createSimplePrintGlobals,t.printLocalsGrid=g.printLocalsGrid,t.printLocalsName=g.printLocalsName,t.createPrinter=p.createPrinter,t.relabelFormula=m.relabelFormula},3895:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.blankOper=t.missingOper=t.range3DOper=t.rangeSeqOper=t.arrayOper=t.externalErrorOper=t.busyErrorOper=t.calcErrorOper=t.fieldErrorOper=t.unknownErrorOper=t.blockedErrorOper=t.connectErrorOper=t.spillErrorOper=t.gettingDataErrorOper=t.naErrorOper=t.numErrorOper=t.nameErrorOper=t.refErrorOper=t.valueErrorOper=t.div0ErrorOper=t.nullErrorOper=t.errorOper=t.booleanOper=t.stringOper=t.precedents=t.ErrorType=t.falseOper=t.trueOper=t.OperKind=t.PrecsBound=t.SpecialPrecs=void 0;const n=r(19181),i=n.__importStar(r(30333)),o=n.__importStar(r(73693));t.SpecialPrecs=o.SpecialPrecs,t.PrecsBound=i.PrecsBound,t.OperKind=o.OperKind,t.trueOper=i.trueOper,t.falseOper=i.falseOper,t.ErrorType=i.ErrorType,t.precedents=i.precedents,t.stringOper=i.stringOper,t.booleanOper=i.booleanOper,t.errorOper=i.errorOper,t.nullErrorOper=i.nullErrorOper,t.div0ErrorOper=i.div0ErrorOper,t.valueErrorOper=i.valueErrorOper,t.refErrorOper=i.refErrorOper,t.nameErrorOper=i.nameErrorOper,t.numErrorOper=i.numErrorOper,t.naErrorOper=i.naErrorOper,t.gettingDataErrorOper=i.gettingDataErrorOper,t.spillErrorOper=i.spillErrorOper,t.connectErrorOper=i.connectErrorOper,t.blockedErrorOper=i.blockedErrorOper,t.unknownErrorOper=i.unknownErrorOper,t.fieldErrorOper=i.fieldErrorOper,t.calcErrorOper=i.calcErrorOper,t.busyErrorOper=i.busyErrorOper,t.externalErrorOper=i.externalErrorOper,t.arrayOper=i.arrayOper,t.rangeSeqOper=i.rangeSeqOper,t.range3DOper=i.range3DOper,t.missingOper=i.missingOper,t.blankOper=i.blankOper},89786:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cancelSmokeTest=t.runSmokeTest=void 0;const n=r(19181).__importStar(r(3686));t.runSmokeTest=n.runSmokeTest,t.cancelSmokeTest=n.cancelSmokeTest},77114:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.argumentAssistancePluginDependenciesResolved=t.ArgumentAssistancePluginFactory=void 0;const n=r(19181),i=r(50111),o=r(78469),a=r(39986),s=r(69001),l=r(55340),u=r(33436),c=r(94591),d=r(83781),m=r(70731),g=r(96264),p=r(81476),h=r(60111),f=r(57814),S=r(42549),v=r(18538),y=r(12367),F=r(71510),C=r(53507);class R{create(){return new b}constructor(){this.factoryName=v.PluginFactoryName.ArgumentAssistancePlugin}}t.ArgumentAssistancePluginFactory=R;class b{*run(e){this.lastRunTime=this.timer.now(),this.runStartTime=this.timer.now(),this.timeStamps=new Map;const t=yield{kind:i.ComputationRequestKind.GetActiveCell};if(t.kind!==i.ComputationRequestKind.GetActiveCell)return this.logFailure("failed to get active cell"),null;this.addTimeStamp("GetActiveCell");let r=yield{kind:i.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(this.addTimeStamp("ParseCellContentSync"),!(void 0!==r&&r.kind===i.ComputationRequestKind.ParseActiveCell&&(0,u.isSuccess)(r.result)||(r=yield{kind:i.ComputationRequestKind.ParseEdit,cell:t.activeCell,formulaBarText:e.content},this.addTimeStamp("ParseCellContentAsync"),r.kind===i.ComputationRequestKind.ParseEdit&&(0,u.isSuccess)(r.result))))return null;if(r.result.value.kind!==c.EditKind.Formula)return null;const{formula:n}=r.result.value,o=new m.ArgumentAssistanceVisitor(n,e.caretPosition,this.newNamedObjectsEnabled);if((0,a.reduceBottomUp)(o,n),this.addTimeStamp("ArgumentAssistanceVisitor"),void 0===o.assistedFunctionHead)return this.logTimeStamp(),null;const h=yield{kind:i.ComputationRequestKind.GetConfig};this.addTimeStamp("GetConfig");const f=h.kind===i.ComputationRequestKind.GetConfig?h.config.localeInfo.listSeparator:",",S=o.assistedFunctionHead;if(S.kind===F.NodeKind.Name){if(!this.newNamedObjectsEnabled)return null;const t=yield{kind:i.ComputationRequestKind.GetDefinedNamesInfo};if(t.kind!==i.ComputationRequestKind.GetDefinedNamesInfo)return this.logFailure("failed to get named objects info"),null;const r=t.definedNamesInfo.find((e=>e.name===S.whole));if(null==(null==r?void 0:r.reference))return null;const a=yield{kind:i.ComputationRequestKind.ParseActiveCell,formulaText:r.reference};if(a.kind!==i.ComputationRequestKind.ParseActiveCell||!(0,u.isSuccess)(a.result)||a.result.value.kind!==c.EditKind.Formula)return null;const{formula:s}=a.result.value;if(!s.isWellFormed||"Lambda"!==s.node.kind||!s.node.isClosed)return null;const l=[];for(const e of s.node.params){const{name:t,isBracketed:r}=e.name.arg.name;if("Ident"!==t.kind)return this.logFailure(`unexpected parameter in lambda function: ${t.kind}`),null;const n=r?`[${t.whole}]`:t.whole;l.push(n)}const d=(0,g.getActiveParamIndex)(n,o.assistedFunctionArgs,e.caretPosition,this.fixHandlingWhiteSpace);return{kind:"Minimal",functionName:S.whole,listSeparator:f,parameters:{params:l,activeParam:d}}}const v=yield{kind:i.ComputationRequestKind.GetFunctionInfo,functionName:S.whole};if(this.addTimeStamp("GetFunctionInfo"),v.kind!==i.ComputationRequestKind.GetFunctionInfo)return this.logFailure(`failed to get function info for ${S.whole}`),null;const y=new p.ResettableLazy((()=>(0,g.createFunctionRenderingInfo)(v.functionInfo,n,o.assistedFunctionArgs,e.caretPosition,S.id,f,this.fixHandlingWhiteSpace))),C=s.functionExamples.getValue()[S.id];if(this.addTimeStamp("GetExampleString"),void 0===C)return this.logFailure(`no example found for function: ${S.whole}, id: ${S.id}`),this.addTimeStampAndLog("createFunctionRenderingInfoNoExample"),y.getValue();const R=yield{kind:i.ComputationRequestKind.ParseCellFormula,cell:t.activeCell,formula:{formulaBarText:C,kind:d.FormulaKind.CellFormula},useEnglishLocaleInfo:!0};if(this.addTimeStamp("ParseExample"),R.kind!==i.ComputationRequestKind.ParseCellFormula||!(0,u.isSuccess)(R.result)){this.logFailure(`failed to parse example for function: ${S.whole}`);const e=y.getValue();return this.addTimeStampAndLog("createFunctionRenderingInfoFailedToParseExample"),e}if(h.kind===i.ComputationRequestKind.GetConfig&&h.config.localeInfo.lcid===l.LCID.USA){const t=(0,g.createFunctionRenderingInfo)(v.functionInfo,n,o.assistedFunctionArgs,e.caretPosition,S.id,f,this.fixHandlingWhiteSpace,C,R.result.value);return this.addTimeStampAndLog("createFunctionRenderingInfoEnUs"),t}const b=yield{kind:i.ComputationRequestKind.PrintFormula,formula:R.result.value,origin:t.activeCell};if(this.addTimeStamp("localize example string"),b.kind!==i.ComputationRequestKind.PrintFormula||!(0,u.isSuccess)(b.result)){this.logFailure(`failed to pretty print localized example for function: ${S.whole}`);const e=y.getValue();return this.addTimeStampAndLog("createFunctionRenderingInfoFailedToPrintLocalizedExample"),e}const E=yield{kind:i.ComputationRequestKind.ParseCellFormula,cell:t.activeCell,formula:{formulaBarText:b.result.value,kind:d.FormulaKind.CellFormula},useEnglishLocaleInfo:!1};if(this.addTimeStamp("parse localized example string"),E.kind!==i.ComputationRequestKind.ParseCellFormula||!(0,u.isSuccess)(E.result)){this.logFailure(`failed to parse localized example for function: ${S.whole}`);const e=y.getValue();return this.addTimeStampAndLog("createFunctionRenderingInfoFailedToParseLocalizedExample"),e}const T=(0,g.createFunctionRenderingInfo)(v.functionInfo,n,o.assistedFunctionArgs,e.caretPosition,S.id,f,this.fixHandlingWhiteSpace,b.result.value,E.result.value);return this.addTimeStampAndLog("createFunctionRenderingInfoWithLocalizedExample"),T}logFailure(e){l.ulsLogger.ULS.traceTag(545388683,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Warning,`ArgumentAssistancePlugin encountered a failure with msg ${e}`)}addTimeStampAndLog(e){this.addTimeStamp(e),this.logTimeStamp()}logTimeStamp(){this.timeStamps.set("Overall",this.timer.now()-this.runStartTime);const e={};this.timeStamps.forEach(((t,r)=>{e[r]=t})),l.ulsLogger.ULS.traceTag(540377222,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,`${JSON.stringify(e)}`)}addTimeStamp(e){this.timeStamps.set(e,this.timer.now()-this.lastRunTime),this.lastRunTime=this.timer.now()}constructor(){this.timer=f.defaultTimerInterface,this.lastRunTime=0,this.runStartTime=0,this.timeStamps=new Map,this.fixHandlingWhiteSpace=(0,S.isTypedChangeGateEnabled)("OfficeVSO:7920319_fixArgumentAssistanceHandlingWhitespaces"),this.newNamedObjectsEnabled=(0,y.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAuthoringWithNameManager",!1)&&(0,y.getBooleanFeatureGate)("Microsoft.Office.Excel.XLONameManager",!1)}}(0,o.registerPluginFactory)(new R),t.argumentAssistancePluginDependenciesResolved=(0,C.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){let e;e=(0,S.getTypedFeatureGate)("Microsoft.Office.Excel.ArgumentAssistanceOnMainThread")?yield h.dynamicPluginLoaderCreated.getValue():yield h.workerThreadSpread.getValue(),yield e.loadPluginScript("formula-authoring-strings",!0),yield e.createAndAttachPlugin(v.PluginFactoryName.ArgumentAssistancePlugin),yield h.schedulerWithRecalcServiceAttached.getValue()}))),"argumentAssistancePluginDependenciesResolved")},96264:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBaseParamName=t.getParamNumberSuffix=t.getParamIndexToHighlight=t.getActiveParamIndex=t.createFunctionRenderingInfo=void 0;const n=r(96438);function i(e,t,r,n){var i;let o=0;if(n)for(let n=0;n<t.length;n++){const i=e.spans[t[n].label];if(i&&i.start-i.pre.length<=r&&r<=i.end+i.post.length){o=n;break}}else for(let n=t.length-1;n>=0;n-=1){const a=null===(i=e.spans[t[n].label])||void 0===i?void 0:i.end;void 0!==a&&r<=a&&(o=n)}return o}function o(e,t,r,n=!1,i=!1){const o=t-1,a=r.restTypes.length,s=r.headTypes.length;if(e<s+a)return e;if(e>=s&&0===a)return-1;const l=(e-s)%a;return n?e<=o-r.tailTypes.length?e:o-r.tailTypes.length-(a-1)+l:s+(i&&0===l&&r.tailTypes.length>0?a:l)}function a(e,t,r){let n=o(e,t,r);return l(e,r)&&(n+=1),n}function s(e,t,r){return 1+Math.max(Math.floor((e-t)/r),0)}function l(e,t){return t.restTypes.length>0&&e>=t.headTypes.length+t.restTypes.length}function u(e){return e.match(/[^0-9\[\]]+/)}function c(e,t){return{params:e,activeParam:Math.min(t,e.length-1)}}t.createFunctionRenderingInfo=function(e,t,r,d,m,g,p,h,f){const S=i(t,r,d,p),v=e.Params.split("!");return{kind:"Full",functionName:e.NameDataStrings,functionDescription:e.Help,signatures:v.map(((t,r)=>function(e,t,r,i,d,m,g,p){const h=(0,n.getWorksheetFuncType)(d),f=""!==t?t.split(m+" ").filter((e=>"..."!==e)):[],S=function(e,t,r){const n=e.slice(),i=t.headTypes.length,o=t.restTypes.length;if(o>0){let e=s(r,i,o);for(let t=i;t<n.length;t+=o){for(let r=0;r<o;r+=1){const i=u(n[t+r]),a=e>1&&r%o==0?"[":"",s=e>1&&r%o==o-1?"]":"";n[t+r]=`${a}${i}${e}${s}`}e+=1}n.push("..."),l(r,t)&&n.splice(i,0,"...")}return n}(f,h,i),v=function(e,t){return void 0===e||void 0===t?null:t.node.args.map((r=>{const n=t.spans[r.label];return n?e.substring(n.start,n.end):""}))}(g,p),y=function(e,t,r,n){let i=e.split("!");if(i=0===n?i.slice(0,t.length):i.slice(-1*t.length),r.restTypes.length>0){for(let e=r.headTypes.length;e<i.length;e+=1){const r=u(t[e]),n=`${r}1,${r}2,... `;i[e]=n+i[e]}1===r.restTypes.length&&i.push(i[r.headTypes.length])}return i}(e.ParamsHelp,f,h,r),F=function(e,t){return e.filter((e=>"..."!==e)).slice(0,t.length).map((e=>function(e){return e.startsWith("[")&&!e.endsWith("]")?e+"]":!e.startsWith("[")&&e.endsWith("]")?"["+e:e}(e)))}(S,y);return{signatureParams:c(S,a(i,f.length,h)),descriptions:y,descriptionParams:c(F,o(i,F.length,h)),exampleParams:null!==v?c(v,o(i,v.length,h,!0)):null,exampleDescription:""}}(e,t,r,S,m,g,h,f))),activeSignature:0,listSeparator:g,isUDF:e.IsDynamicUdf,helpID:e.HelpId}},t.getActiveParamIndex=i,t.getParamIndexToHighlight=o,t.getParamNumberSuffix=s,t.getBaseParamName=u},70731:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArgumentAssistanceVisitor=void 0;const n=r(42549),i=r(71510),o=r(39986);class a extends o.IdentityVisitor{appNode(e,t,r,n){return(e.kind===i.NodeKind.WSF||this.newNamedObjectsEnabled&&e.kind===i.NodeKind.Name)&&this.updateAssistedFunction(e,t),super.appNode(e,t,r,n)}letNode(e,t,r,n,i,o){const a=super.letNode(e,t,r,n,i,o);return this.updateAssistedFunction(e,a.args),a}lambdaNode(e,t,r,n,i,o){const a=super.lambdaNode(e,t,r,n,i,o);return this.updateAssistedFunction(e,a.args),a}updateAssistedFunction(e,t){const r=this.parsedFormulaTree.spans[t[0].label],n=this.parsedFormulaTree.spans[t[t.length-1].label];let i=r.start,o=n.end;this.fixHandlingWhiteSpace&&(i-=r.pre.length,o+=n.post.length),this.caretPosition<=o&&this.caretPosition>=i&&(void 0===this.assistedFunctionHead||i>this.assistedFunctionScopeStart)&&(this.assistedFunctionHead=e,this.assistedFunctionArgs=t,this.assistedFunctionScopeStart=i)}constructor(e,t,r){super(),this.parsedFormulaTree=e,this.caretPosition=t,this.newNamedObjectsEnabled=r,this.assistedFunctionScopeStart=0,this.fixHandlingWhiteSpace=!1,this.fixHandlingWhiteSpace=(0,n.isTypedChangeGateEnabled)("OfficeVSO:7920319_fixArgumentAssistanceHandlingWhitespaces")}}t.ArgumentAssistanceVisitor=a},69001:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionExamples=void 0;const n=r(96438),i=r(81476);t.functionExamples=new i.ResettableLazy((()=>({[n.WorksheetFuncId.ABS]:"=ABS(2)",[n.WorksheetFuncId.CUBEMEMBERPROPERTY]:`=CUBEMEMBERPROPERTY("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}","[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Time)}].[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Fiscal)}].[2014]",$A$3)`,[n.WorksheetFuncId.CUBERANKEDMEMBER]:`=CUBERANKEDMEMBER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}",$D$4,1,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TopMonth)}")`,[n.WorksheetFuncId.BINOM_DIST_RANGE]:"=BINOM.DIST.RANGE(60,0.75,48)",[n.WorksheetFuncId.NETWORKDAYS_INTL]:"=NETWORKDAYS.INTL(DATE(2006,1,1),DATE(2006,1,31))",[n.WorksheetFuncId.AVERAGE_WEIGHTED]:"=AVERAGE.WEIGHTED(A1:A10, B1:B10, 5, 0.5)",[n.WorksheetFuncId.GAMMALN_PRECISE]:"=GAMMALN.PRECISE(4)",[n.WorksheetFuncId.CONFIDENCE_NORM]:"=CONFIDENCE.NORM(0.05,2.5,50)",[n.WorksheetFuncId.CEILING_PRECISE]:"=CEILING.PRECISE(4.3)",[n.WorksheetFuncId.FORECAST_LINEAR]:"=FORECAST.LINEAR(30,A2:A6,B2:B6)",[n.WorksheetFuncId.PERCENTRANK_EXC]:"=PERCENTRANK.EXC(A2:A11,2)",[n.WorksheetFuncId.PERCENTRANK_INC]:"=PERCENTRANK.INC(A2:A11,2)",[n.WorksheetFuncId.PERCENTILE_EXC]:"=PERCENTILE.EXC(B2:B10,0.25)",[n.WorksheetFuncId.PERCENTILE_INC]:"=PERCENTILE.INC(A2:A5,0.3)",[n.WorksheetFuncId.CUBEKPIMEMBER]:`=CUBEKPIMEMBER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MySalesKPI)}",1)`,[n.WorksheetFuncId.CHISQ_DIST_RT]:"=CHISQ.DIST.RT(18.307,10)",[n.WorksheetFuncId.FLOOR_PRECISE]:"=FLOOR.PRECISE(-3.2,-1)",[n.WorksheetFuncId.NEGBINOM_DIST]:"=NEGBINOM.DIST(10,5,0.25,TRUE)",[n.WorksheetFuncId.GETPIVOTDATA]:`=GETPIVOTDATA("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}", $A$3, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Region)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.South)}")`,[n.WorksheetFuncId.CUBESETCOUNT]:"=CUBESETCOUNT(A3)",[n.WorksheetFuncId.ERFC_PRECISE]:"=ERFC.PRECISE(1)",[n.WorksheetFuncId.CHISQ_INV_RT]:"=CHISQ.INV.RT(0.3, 2)",[n.WorksheetFuncId.CONFIDENCE_T]:"=CONFIDENCE.T(0.05,1,50)",[n.WorksheetFuncId.CEILING_MATH]:"=CEILING.MATH(24.3,5)",[n.WorksheetFuncId.HYPGEOM_DIST]:"=HYPGEOM.DIST(1,4,8,20,TRUE)",[n.WorksheetFuncId.LOGNORM_DIST]:"=LOGNORM.DIST(4,3.5,1.2,TRUE)",[n.WorksheetFuncId.NEGBINOMDIST]:"=NEGBINOMDIST(10,5,0.25)",[n.WorksheetFuncId.PERMUTATIONA]:"=PERMUTATIONA(3,2)",[n.WorksheetFuncId.POISSON_DIST]:"=POISSON.DIST(1, 2, TRUE)",[n.WorksheetFuncId.WEIBULL_DIST]:"=WEIBULL.DIST(105,20,100,TRUE)",[n.WorksheetFuncId.COVARIANCE_P]:"=COVARIANCE.P(A2:A6, B2:B6)",[n.WorksheetFuncId.COVARIANCE_S]:"=COVARIANCE.S(A3:A5,B3:B5)",[n.WorksheetFuncId.QUARTILE_EXC]:"=QUARTILE.EXC(A2:A12,1)",[n.WorksheetFuncId.QUARTILE_INC]:"=QUARTILE.INC(A2:A9,1)",[n.WorksheetFuncId.ECMA_CEILING]:"=ECMA.CEILING(1.5, 0.1)",[n.WorksheetFuncId.WORKDAY_INTL]:"=WORKDAY.INTL(DATE(2012,1,1),30,0)",[n.WorksheetFuncId.STOCKHISTORY]:"=STOCKHISTORY(MSFT,1-1-2020)",[n.WorksheetFuncId.ERF_PRECISE]:"=ERF.PRECISE(0.745)",[n.WorksheetFuncId.NUMBERVALUE]:"=NUMBERVALUE(0.035)",[n.WorksheetFuncId.HYPGEOMDIST]:"=HYPGEOMDIST(1,4,8,20)",[n.WorksheetFuncId.LOGNORMDIST]:"=LOGNORMDIST(4,3.5,1.2)",[n.WorksheetFuncId.LOGNORM_INV]:"=LOGNORM.INV(0.039084, 3.5, 1.2)",[n.WorksheetFuncId.NORM_S_DIST]:"=NORM.S.DIST(1.33, TRUE)",[n.WorksheetFuncId.STANDARDIZE]:"=STANDARDIZE(42,40,1.5)",[n.WorksheetFuncId.FORMULATEXT]:"=FORMULATEXT(A2)",[n.WorksheetFuncId.PERCENTRANK]:"=PERCENTRANK(A2:A11,2)",[n.WorksheetFuncId.CONCATENATE]:`=CONCATENATE("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Andreas)}", " ", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hauser)}")`,[n.WorksheetFuncId.ISO_CEILING]:"=ISO.CEILING(4.3)",[n.WorksheetFuncId.VALUETOTEXT]:`=VALUETOTEXT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SomeText)}")`,[n.WorksheetFuncId.ARRAYTOTEXT]:"=ARRAYTOTEXT(B1:B3)",[n.WorksheetFuncId.AVERAGEIFS]:'=AVERAGEIFS(B2:B5, B2:B5, ">70", B2:B5, "<90")',[n.WorksheetFuncId.COUNTBLANK]:"=COUNTBLANK(A2:B5)",[n.WorksheetFuncId.ERROR_TYPE]:"=ERROR.TYPE(#NULL!)",[n.WorksheetFuncId.CUBEMEMBER]:`=CUBEMEMBER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}",(B4, C6, D5),"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalesFor2004)}")`,[n.WorksheetFuncId.ISOWEEKNUM]:"=ISOWEEKNUM(40977)",[n.WorksheetFuncId.SUBSTITUTE]:`=SUBSTITUTE("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalesData)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Cost)}")`,[n.WorksheetFuncId.SUMPRODUCT]:"=SUMPRODUCT(C2:C5,D2:D5)",[n.WorksheetFuncId.WEBSERVICE]:`=WEBSERVICE(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WebServiceLink)})`,[n.WorksheetFuncId.BINOM_DIST]:"=BINOM.DIST(6,10,0.5,FALSE)",[n.WorksheetFuncId.CHISQ_DIST]:"=CHISQ.DIST(0.5,1,TRUE)",[n.WorksheetFuncId.CONFIDENCE]:"=CONFIDENCE(0.05,2.5,50)",[n.WorksheetFuncId.EXPON_DIST]:"=EXPON.DIST(0.2,10,TRUE)",[n.WorksheetFuncId.FLOOR_MATH]:"=FLOOR.MATH(24.3,5)",[n.WorksheetFuncId.GAMMA_DIST]:"=GAMMA.DIST(4.79, 1.234, 7, TRUE)",[n.WorksheetFuncId.NORM_S_INV]:"=NORM.S.INV(0.908789)",[n.WorksheetFuncId.CHISQ_TEST]:"=CHISQ.TEST(A2:B4,A6:B8)",[n.WorksheetFuncId.PERCENTILE]:"=PERCENTILE(E2:E5,0.3)",[n.WorksheetFuncId.FIELDVALUE]:`=FIELDVALUE(A2, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Price)}")`,[n.WorksheetFuncId.AVERAGEIF]:'=AVERAGEIF(B2:B5,"<23000")',[n.WorksheetFuncId.BITLSHIFT]:"=BITLSHIFT(4,2)",[n.WorksheetFuncId.BITRSHIFT]:"=BITRSHIFT(13,2)",[n.WorksheetFuncId.DATEVALUE]:'=DATEVALUE("1/1/2008")',[n.WorksheetFuncId.FILTERXML]:'=FILTERXML(B3,"//rc/@title")',[n.WorksheetFuncId.CUBEVALUE]:`=CUBEVALUE(Sales,"[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Measures)}].[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit)}]","[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Time)}].[2004]","[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AllProduct)}].[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Beverages)}]")`,[n.WorksheetFuncId.ENCODEURL]:`=ENCODEURL("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EncodeURLExmapleLink)}")`,[n.WorksheetFuncId.HYPERLINK]:`=HYPERLINK("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HyperlinkExampleLink)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ClickForReport)}")`,[n.WorksheetFuncId.ISLOGICAL]:"=ISLOGICAL(TRUE)",[n.WorksheetFuncId.ISNONTEXT]:"=ISNONTEXT(A2)",[n.WorksheetFuncId.ISFORMULA]:"=ISFORMULA(A2)",[n.WorksheetFuncId.PDURATION]:"=PDURATION(2.5%,2000,2200)",[n.WorksheetFuncId.TIMEVALUE]:"=TIMEVALUE(0.1)",[n.WorksheetFuncId.TRANSPOSE]:"=TRANSPOSE(A2:F9)",[n.WorksheetFuncId.FREQUENCY]:"=FREQUENCY(A2:A20, B2:B5)",[n.WorksheetFuncId.BETA_DIST]:"=BETA.DIST(2,8,10,TRUE,1,3)",[n.WorksheetFuncId.BINOMDIST]:"=BINOMDIST(6,10,0.5,FALSE)",[n.WorksheetFuncId.BINOM_INV]:"=BINOM.INV(6,0.5,0.75)",[n.WorksheetFuncId.CHISQ_INV]:"=CHISQ.INV(0.3, 2)",[n.WorksheetFuncId.CRITBINOM]:"=CRITBINOM(6,0.5,0.75)",[n.WorksheetFuncId.EXPONDIST]:"=EXPONDIST(0.2,10,TRUE)",[n.WorksheetFuncId.F_DIST_RT]:"=F.DIST.RT(15.2069,6,4)",[n.WorksheetFuncId.FISHERINV]:"=FISHERINV(0.972955)",[n.WorksheetFuncId.GAMMADIST]:"=GAMMADIST(10.00001131,9,2,FALSE)",[n.WorksheetFuncId.GAMMA_INV]:"=GAMMA.INV(0.068094,9,2)",[n.WorksheetFuncId.NORM_DIST]:"=NORM.DIST(1, 0, 1, TRUE)",[n.WorksheetFuncId.T_DIST_2T]:"=T.DIST.2T(1.959999998,60)",[n.WorksheetFuncId.T_DIST_RT]:"=T.DIST.RT(1.959999998,60)",[n.WorksheetFuncId.INTERCEPT]:"=INTERCEPT(A2:A6, B2:B6)",[n.WorksheetFuncId.MODE_MULT]:"=MODE.MULT(A2:A13)",[n.WorksheetFuncId.MODE_SNGL]:"=MODE.SNGL(A2:A7)",[n.WorksheetFuncId.AGGREGATE]:"=AGGREGATE(12, 6, A1:A11, B1:B11)",[n.WorksheetFuncId.RANDARRAY]:"=RANDARRAY(5,3,1,100)",[n.WorksheetFuncId.COUNTIFS]:'=COUNTIFS(A2:A7,"<6",A2:A7,">1")',[n.WorksheetFuncId.DAVERAGE]:`=DAVERAGE(A4:E10, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:B2)`,[n.WorksheetFuncId.BAHTTEXT]:"=BAHTTEXT(1234)",[n.WorksheetFuncId.DPRODUCT]:`=DPRODUCT(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:F3)`,[n.WorksheetFuncId.INDIRECT]:"=INDIRECT(B&A)",[n.WorksheetFuncId.ISNUMBER]:"=ISNUMBER(A2)",[n.WorksheetFuncId.MINVERSE]:"=MINVERSE(A1:D4)",[n.WorksheetFuncId.RANK_AVG]:"=RANK.AVG(94,B2:B8)",[n.WorksheetFuncId.SUBTOTAL]:"=SUBTOTAL(9,A2:A5)",[n.WorksheetFuncId.BETADIST]:"=BETADIST(2,8,10,1,3)",[n.WorksheetFuncId.BETA_INV]:"=BETA.INV(0.685470581,8,10,1,3)",[n.WorksheetFuncId.F_INV_RT]:"=F.INV.RT(0.01,6,4)",[n.WorksheetFuncId.GAMMAINV]:"=GAMMAINV(0.65, 4, 2)",[n.WorksheetFuncId.NORMDIST]:"=NORMDIST(42,40,1.5,TRUE)",[n.WorksheetFuncId.NORM_INV]:"=NORM.INV(0.908789,40,1.5)",[n.WorksheetFuncId.NORMSINV]:"=NORMSINV(0.9088)",[n.WorksheetFuncId.SUMX2MY2]:"=SUMX2MY2(A3:A9,B3:B9)",[n.WorksheetFuncId.SUMX2PY2]:"=SUMX2PY2(A3:A9,B3:B9)",[n.WorksheetFuncId.FORECAST]:"=FORECAST(30,A2:A6,B2:B6)",[n.WorksheetFuncId.QUARTILE]:"=QUARTILE(A2:A9,1)",[n.WorksheetFuncId.TRIMMEAN]:"=TRIMMEAN(A2:A12,0.2)",[n.WorksheetFuncId.T_INV_2T]:"=T.INV.2T(0.546449,60)",[n.WorksheetFuncId.AVERAGEA]:"=AVERAGEA(A2:A6)",[n.WorksheetFuncId.TEXTJOIN]:"=TEXTJOIN(, , TRUE, A2:A8)",[n.WorksheetFuncId.SEQUENCE]:"=SEQUENCE(4,5)",[n.WorksheetFuncId.ADDRESS]:`=ADDRESS(2,3,1,FALSE,"[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Book1)}]${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sheet1)}")`,[n.WorksheetFuncId.AVERAGE]:"=AVERAGE(A2:A6)",[n.WorksheetFuncId.COLUMNS]:"=COLUMNS(C1:E4)",[n.WorksheetFuncId.COUNTIF]:'=COUNTIF(B2:B5,">55")',[n.WorksheetFuncId.DAYS360]:"=DAYS360(30-Jan-11,1-Feb-11)",[n.WorksheetFuncId.DCOUNTA]:`=DCOUNTA(A4:E10, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit)}", A1:F2)`,[n.WorksheetFuncId.DECIMAL]:"=DECIMAL(FF,16)",[n.WorksheetFuncId.DEGREES]:"=DEGREES(PI())",[n.WorksheetFuncId.DSTDEVP]:`=DSTDEVP(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:A3)`,[n.WorksheetFuncId.CUBESET]:`=CUBESET("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}","[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Product)}].[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AllProducts)}].${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Children)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Products)}",1,"[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Measures)}].[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalesAmount)}]")`,[n.WorksheetFuncId.HLOOKUP]:`=HLOOKUP("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Axles)}", A1:C4, 2, TRUE)`,[n.WorksheetFuncId.IFERROR]:`=IFERROR(55/0, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ErrorInCalculation)}")`,[n.WorksheetFuncId.ISBLANK]:"=ISBLANK(A2)",[n.WorksheetFuncId.ISERROR]:"=ISERROR(#REF!)",[n.WorksheetFuncId.XLOOKUP]:`=XLOOKUP("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tom)}",A2:A9,C2:C9,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NotFound)}",0,1)`,[n.WorksheetFuncId.MDETERM]:"=MDETERM(A2:D5)",[n.WorksheetFuncId.PRODUCT]:"=PRODUCT(A2:A4)",[n.WorksheetFuncId.RADIANS]:"=RADIANS(270)",[n.WorksheetFuncId.RANK_EQ]:"=RANK.EQ(7,A2:A6,1)",[n.WorksheetFuncId.REPLACE]:'=REPLACE(2009,3,2,"10")',[n.WorksheetFuncId.STDEV_S]:"=STDEV.S(A2:A11)",[n.WorksheetFuncId.STDEV_P]:"=STDEV.P(A3:A12)",[n.WorksheetFuncId.UNICODE]:"=UNICODE(B)",[n.WorksheetFuncId.UNICHAR]:"=UNICHAR(66)",[n.WorksheetFuncId.VLOOKUP]:"=VLOOKUP(103, A2:B26, 2, FALSE)",[n.WorksheetFuncId.WEEKDAY]:"=WEEKDAY(39492)",[n.WorksheetFuncId.GAMMALN]:"=GAMMALN(4)",[n.WorksheetFuncId.BETAINV]:"=BETAINV(0.685470581,8,10,1,3)",[n.WorksheetFuncId.CHIDIST]:"=CHIDIST(18.307,10)",[n.WorksheetFuncId.COMBINA]:"=COMBINA(4,3)",[n.WorksheetFuncId.CEILING]:"=CEILING(2.5, 1)",[n.WorksheetFuncId.NORMINV]:"=NORMINV(0.908789,40,1.5)",[n.WorksheetFuncId.POISSON]:"=POISSON(1, 2, TRUE)",[n.WorksheetFuncId.WEIBULL]:"=WEIBULL(105,20,100,TRUE)",[n.WorksheetFuncId.SUMXMY2]:"=SUMXMY2(A3:A9,B3:B9)",[n.WorksheetFuncId.CHITEST]:"=CHITEST(A2:B4,A6:B8)",[n.WorksheetFuncId.PEARSON]:"=PEARSON(A3:A7,B3:B7)",[n.WorksheetFuncId.GEOMEAN]:"=GEOMEAN(A2:A8)",[n.WorksheetFuncId.HARMEAN]:"=HARMEAN(A2:A8)",[n.WorksheetFuncId.STDEVPA]:"=STDEVPA(A3:A12)",[n.WorksheetFuncId.DATEDIF]:'=DATEDIF(1/1/2001,1/1/2003,"Y")',[n.WorksheetFuncId.ARABIC]:"=ARABIC(LVII)",[n.WorksheetFuncId.CHOOSE]:`=CHOOSE(3,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Wide)}",115,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.World)}",8)`,[n.WorksheetFuncId.COLUMN]:"=COLUMN(C9)",[n.WorksheetFuncId.COUNTA]:"=COUNTA(B2:B6)",[n.WorksheetFuncId.DCOUNT]:`=DCOUNT(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Age)}", A1:F2)`,[n.WorksheetFuncId.DOLLAR]:"=DOLLAR(1.2351, 4)",[n.WorksheetFuncId.DSTDEV]:`=DSTDEV(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:A3)`,[n.WorksheetFuncId.GROWTH]:"=GROWTH(#VALUE!)",[n.WorksheetFuncId.IMCOSH]:'=IMCOSH("4+3i")',[n.WorksheetFuncId.IMCSCH]:'=IMCSCH("4+3i")',[n.WorksheetFuncId.IMSECH]:'=IMSECH("4+3i")',[n.WorksheetFuncId.IMSINH]:'=IMSINH("4+3i")',[n.WorksheetFuncId.ISTEXT]:`=ISTEXT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Region1)}")`,[n.WorksheetFuncId.LINEST]:"=LINEST(B2:B10, A2:A10, FALSE, TRUE)",[n.WorksheetFuncId.LOGEST]:"=LOGEST(B2:B10, A2:A10, TRUE, TRUE)",[n.WorksheetFuncId.LOOKUP]:"=LOOKUP(4.19, A2:A6, B2:B6)",[n.WorksheetFuncId.XMATCH]:"=XMATCH(F2,C3:C9,1)",[n.WorksheetFuncId.MEDIAN]:"=MEDIAN(A2:A6)",[n.WorksheetFuncId.MINUTE]:"=MINUTE(0.53125)",[n.WorksheetFuncId.OFFSET]:"=OFFSET(D3,3,-2,1,1)",[n.WorksheetFuncId.PROPER]:`=PROPER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThisIsATITLE)}")`,[n.WorksheetFuncId.SEARCH]:`=SEARCH("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.E)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Statements)}",6)`,[n.WorksheetFuncId.SECOND]:"=SECOND(0.700208333333333)",[n.WorksheetFuncId.SHEETS]:`=SHEETS(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.My3DRef)})`,[n.WorksheetFuncId.STDEVP]:"=STDEVP(A3:A12)",[n.WorksheetFuncId.SUMIFS]:`=SUMIFS(A2:A9, B2:B9, "<>${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Bananas)}", C2:C9, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tom)}")`,[n.WorksheetFuncId.AVEDEV]:"=AVEDEV(A2:A8)",[n.WorksheetFuncId.CHIINV]:"=CHIINV(0.3, 2)",[n.WorksheetFuncId.COMBIN]:"=COMBIN(8,2)",[n.WorksheetFuncId.F_DIST]:"=F.DIST(15.2069,6,4,TRUE)",[n.WorksheetFuncId.FISHER]:"=FISHER(0.75)",[n.WorksheetFuncId.LOGINV]:"=LOGINV(0.039084, 3.5, 1.2)",[n.WorksheetFuncId.PERMUT]:"=PERMUT(100,3)",[n.WorksheetFuncId.T_DIST]:"=T.DIST(60,1,TRUE)",[n.WorksheetFuncId.CORREL]:"=CORREL(A2:A6, B2:B6)",[n.WorksheetFuncId.F_TEST]:"=F.TEST(A2:A6,B2:B6)",[n.WorksheetFuncId.T_TEST]:"=T.TEST(A2:A10,B2:B10,2,1)",[n.WorksheetFuncId.SKEW_P]:"=SKEW.P(A2:A11)",[n.WorksheetFuncId.Z_TEST]:"=Z.TEST(A2:A11,4)",[n.WorksheetFuncId.STDEVA]:"=STDEVA(A3:A12)",[n.WorksheetFuncId.MAXIFS]:`=MAXIFS(A2:A7,B2:B7,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsB)}",D2:D7,">100")`,[n.WorksheetFuncId.MINIFS]:`=MINIFS(A2:A7,B2:B7,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsB)}",D2:D7,">100")`,[n.WorksheetFuncId.CONCAT]:`=CONCAT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Andreas)}"," ", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hauser)}")`,[n.WorksheetFuncId.SWITCH]:`=SWITCH(WEEKDAY(10/10/2016),1,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sunday)}",2,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday)}",3,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tuesday)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NoMatch)}")`,[n.WorksheetFuncId.FILTER]:`=FILTER(A5:D20,(C5:C20="${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Apple)}")*(A5:A20="${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.East)}"),"")`,[n.WorksheetFuncId.UNIQUE]:"=UNIQUE(A2:A12)",[n.WorksheetFuncId.SORTBY]:"=SORTBY(D2:D9,E2:E9,1)",[n.WorksheetFuncId.BITAND]:"=BITAND(1,5)",[n.WorksheetFuncId.BITXOR]:"=BITXOR(5,3)",[n.WorksheetFuncId.ACOSH]:"=ACOSH(10)",[n.WorksheetFuncId.ACOTH]:"=ACOTH(6)",[n.WorksheetFuncId.ATANH]:"=ATANH(-0.1)",[n.WorksheetFuncId.ATAN2]:"=ATAN2(4,0)",[n.WorksheetFuncId.CLEAN]:"=CLEAN(A2)",[n.WorksheetFuncId.COUNT]:"=COUNT(A2:A7)",[n.WorksheetFuncId.DVARP]:`=DVARP(A4:E10, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:A3)`,[n.WorksheetFuncId.EXACT]:`=EXACT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hello)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Goodbye)}")`,[n.WorksheetFuncId.FALSE]:"=FALSE()",[n.WorksheetFuncId.FIXED]:"=FIXED(-1234.567, -1, TRUE)",[n.WorksheetFuncId.IMCOT]:'=IMCOT("4+3i")',[n.WorksheetFuncId.IMCSC]:'=IMCSC("4+3i")',[n.WorksheetFuncId.IMSEC]:'=IMSEC("4+3i")',[n.WorksheetFuncId.IMTAN]:'=IMTAN("4+3i")',[n.WorksheetFuncId.INDEX]:"=INDEX(A2:B3,2,1)",[n.WorksheetFuncId.ISERR]:"=ISERR(#N/A)",[n.WorksheetFuncId.ISREF]:"=ISREF(A2)",[n.WorksheetFuncId.LOWER]:`=LOWER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EECummings)}")`,[n.WorksheetFuncId.MATCH]:"=MATCH(39,B2:B5,1)",[n.WorksheetFuncId.MMULT]:"=MMULT(A1:B3, C1:F2)",[n.WorksheetFuncId.MONTH]:"=MONTH(40648)",[n.WorksheetFuncId.RIGHT]:`=RIGHT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalePrice)}",5)`,[n.WorksheetFuncId.ROUND]:"=ROUND(2.149, 1)",[n.WorksheetFuncId.SHEET]:`=SHEET(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Table1)})`,[n.WorksheetFuncId.STDEV]:"=STDEV(A3:A12)",[n.WorksheetFuncId.SUMIF]:'=SUMIF(A2:A5,">160000")',[n.WorksheetFuncId.TODAY]:"=TODAY()",[n.WorksheetFuncId.TREND]:"=TREND(B2:B10, A2:A10, A11:A13, TRUE)",[n.WorksheetFuncId.TRUNC]:"=TRUNC(8.9)",[n.WorksheetFuncId.UPPER]:`=UPPER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.KelliXu)}")`,[n.WorksheetFuncId.VALUE]:"=VALUE(1000)",[n.WorksheetFuncId.VAR_S]:"=VAR.S(A2:A11)",[n.WorksheetFuncId.VAR_P]:"=VAR.P(A2:A11)",[n.WorksheetFuncId.GAMMA]:"=GAMMA(-3.75)",[n.WorksheetFuncId.GAUSS]:"=GAUSS(2)",[n.WorksheetFuncId.FDIST]:"=FDIST(15.20686486,6,4)",[n.WorksheetFuncId.F_INV]:"=F.INV(0.01,6,4)",[n.WorksheetFuncId.FLOOR]:"=FLOOR(23.25, 0.1)",[n.WorksheetFuncId.TDIST]:"=TDIST(60, 1, 1)",[n.WorksheetFuncId.COVAR]:"=COVAR(A2:A6, B2:B6)",[n.WorksheetFuncId.FTEST]:"=FTEST(A2:A6,B2:B6)",[n.WorksheetFuncId.STEYX]:"=STEYX(A3:A9,B3:B9)",[n.WorksheetFuncId.SLOPE]:"=SLOPE(A3:A9,B3:B9)",[n.WorksheetFuncId.TTEST]:"=TTEST(A2:A10,B2:B10,2,1)",[n.WorksheetFuncId.DEVSQ]:"=DEVSQ(A2:A8)",[n.WorksheetFuncId.SUMSQ]:"=SUMSQ(3, 4)",[n.WorksheetFuncId.ZTEST]:"=ZTEST(A2:A11,6)",[n.WorksheetFuncId.LARGE]:"=LARGE(A2:B6,7)",[n.WorksheetFuncId.SMALL]:"=SMALL(A2:A10,4)",[n.WorksheetFuncId.MUNIT]:"=MUNIT(2)",[n.WorksheetFuncId.T_INV]:"=T.INV(0.75,2)",[n.WorksheetFuncId.ROMAN]:"=ROMAN(499,0)",[n.WorksheetFuncId.POWER]:"=POWER(5,2)",[n.WorksheetFuncId.ISPMT]:"=ISPMT(10%, 2, 5, 1000)",[n.WorksheetFuncId.VARPA]:"=VARPA(1, 2)",[n.WorksheetFuncId.AREAS]:"=AREAS(B2:D4)",[n.WorksheetFuncId.ASINH]:"=ASINH(10)",[n.WorksheetFuncId.BITOR]:"=BITOR(23,10)",[n.WorksheetFuncId.ACOS]:"=ACOS(-0.5)",[n.WorksheetFuncId.ACOT]:"=ACOT(2)",[n.WorksheetFuncId.ATAN]:"=ATAN(1)",[n.WorksheetFuncId.CELL]:`=CELL("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Address)}", C2)`,[n.WorksheetFuncId.CHAR]:"=CHAR(65)",[n.WorksheetFuncId.COSH]:"=COSH(EXP(1))",[n.WorksheetFuncId.COTH]:"=COTH(2)",[n.WorksheetFuncId.CSCH]:"=CSCH(2)",[n.WorksheetFuncId.DATE]:"=DATE(2008,1,2)",[n.WorksheetFuncId.DAYS]:"=DAYS(3/15/11,2/1/11)",[n.WorksheetFuncId.DGET]:`=DGET(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:A3)`,[n.WorksheetFuncId.DMAX]:`=DMAX(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit)}", A1:F3)`,[n.WorksheetFuncId.DMIN]:`=DMIN(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit)}", A1:F3)`,[n.WorksheetFuncId.DSUM]:`=DSUM(A4:E10,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit)}", A1:F3)`,[n.WorksheetFuncId.DVAR]:`=DVAR(A4:E10, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:A3)`,[n.WorksheetFuncId.FACT]:"=FACT(5)",[n.WorksheetFuncId.FIND]:`=FIND("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.M)}",A2)`,[n.WorksheetFuncId.HOUR]:"=HOUR(0.75)",[n.WorksheetFuncId.IFNA]:`=IFNA("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NoNAError)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Error)}")`,[n.WorksheetFuncId.IPMT]:"=IPMT(10%, 3, 3, 8000)",[n.WorksheetFuncId.ISNA]:"=ISNA(#REF!)",[n.WorksheetFuncId.LEFT]:`=LEFT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalePrice)}",4)`,[n.WorksheetFuncId.MIRR]:"=MIRR(A2:A7, 0.1, 0.12)",[n.WorksheetFuncId.NPER]:"=NPER(0.12/12, -100, -1000, 10000, 1)",[n.WorksheetFuncId.PPMT]:"=PPMT(0.08, 10, 10, 200000)",[n.WorksheetFuncId.RAND]:"=RAND()",[n.WorksheetFuncId.RANK]:"=RANK(3.5,A2:A6,1)",[n.WorksheetFuncId.RATE]:"=RATE(4*12, -200, 8000)",[n.WorksheetFuncId.REPT]:'=REPT("*-", 3)',[n.WorksheetFuncId.ROWS]:"=ROWS(C1:E4)",[n.WorksheetFuncId.SECH]:"=SECH(0)",[n.WorksheetFuncId.SIGN]:"=SIGN(10)",[n.WorksheetFuncId.SINH]:"=SINH(2)",[n.WorksheetFuncId.SQRT]:"=SQRT(16)",[n.WorksheetFuncId.TANH]:"=TANH(0.5)",[n.WorksheetFuncId.TEXT]:'=TEXT(1234.567,"$#,##0.00")',[n.WorksheetFuncId.TIME]:"=TIME(16,48,10)",[n.WorksheetFuncId.TRIM]:`=TRIM("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuarterEarnings)}")`,[n.WorksheetFuncId.TRUE]:"=TRUE()",[n.WorksheetFuncId.TYPE]:`=TYPE("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Smith)}")`,[n.WorksheetFuncId.VARP]:"=VARP(A2:A11)",[n.WorksheetFuncId.YEAR]:"=YEAR(39634)",[n.WorksheetFuncId.INFO]:`=INFO("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numfile)}")`,[n.WorksheetFuncId.EVEN]:"=EVEN(1.5)",[n.WorksheetFuncId.FINV]:"=FINV(0.42, 2, 3)",[n.WorksheetFuncId.PROB]:"=PROB(A3:A6,B3:B6,2)",[n.WorksheetFuncId.KURT]:"=KURT(A2:A11)",[n.WorksheetFuncId.SKEW]:"=SKEW(A2:A11)",[n.WorksheetFuncId.MODE]:"=MODE(A2:A7)",[n.WorksheetFuncId.MINA]:"=MINA(A2:A6)",[n.WorksheetFuncId.MAXA]:"=MAXA(A2:A6)",[n.WorksheetFuncId.VARA]:"=VARA(1, 2)",[n.WorksheetFuncId.SORT]:"=SORT(A2:A17)",[n.WorksheetFuncId.ASIN]:"=ASIN(-0.5)",[n.WorksheetFuncId.BASE]:"=BASE(7,2)",[n.WorksheetFuncId.CODE]:`=CODE("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CodeA)}")`,[n.WorksheetFuncId.AND]:"=AND(A2>1,A2<100)",[n.WorksheetFuncId.COS]:"=COS(1.047)",[n.WorksheetFuncId.COT]:"=COT(30)",[n.WorksheetFuncId.CSC]:"=CSC(15)",[n.WorksheetFuncId.DAY]:"=DAY(40648)",[n.WorksheetFuncId.DDB]:"=DDB(2400,300,10*365,1)",[n.WorksheetFuncId.RTD]:`=RTD(mycomaddin.progid,,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ServerName)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Price)}")`,[n.WorksheetFuncId.EXP]:"=EXP(1)",[n.WorksheetFuncId.INT]:"=INT(8.9)",[n.WorksheetFuncId.IRR]:"=IRR(A2:A4,-10%)",[n.WorksheetFuncId.LEN]:`=LEN("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Excel)}")`,[n.WorksheetFuncId.LOG]:"=LOG(10)",[n.WorksheetFuncId.MAX]:"=MAX(A2:A6)",[n.WorksheetFuncId.MID]:`=MID("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FluidFlow)}",1,5)`,[n.WorksheetFuncId.MIN]:"=MIN(A2:A6)",[n.WorksheetFuncId.MOD]:"=MOD(3, 2)",[n.WorksheetFuncId.NOT]:"=NOT(A2>100)",[n.WorksheetFuncId.NPV]:"=NPV(0.1, -10000, 3000, 4200, 6800)",[n.WorksheetFuncId.PMT]:"=PMT(0.08/12,10,10000)",[n.WorksheetFuncId.ROW]:"=ROW(C10)",[n.WorksheetFuncId.RRI]:"=RRI(96,10000,11000)",[n.WorksheetFuncId.SEC]:"=SEC(30)",[n.WorksheetFuncId.SIN]:"=SIN(PI())",[n.WorksheetFuncId.SLN]:"=SLN(30000, 7500, 10)",[n.WorksheetFuncId.SUM]:"=SUM(A1:A3)",[n.WorksheetFuncId.SYD]:"=SYD(30000,7500,10,1)",[n.WorksheetFuncId.TAN]:"=TAN(0.785)",[n.WorksheetFuncId.VAR]:"=VAR(A2:A11)",[n.WorksheetFuncId.VDB]:"=VDB(2400, 300, 10*365, 0, 1)",[n.WorksheetFuncId.XOR]:"=XOR(3>0,2<9)",[n.WorksheetFuncId.ODD]:"=ODD(1.5)",[n.WorksheetFuncId.PHI]:"=PHI(0.75)",[n.WorksheetFuncId.RSQ]:"=RSQ(A3:A9, B3:B9)",[n.WorksheetFuncId.IFS]:`=IFS(A2>89,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsA)}",A2>79,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsB)}",A2>69,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsC)}",A2>59,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsD)}",TRUE,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsF)}")`,[n.WorksheetFuncId.DB]:"=DB(1000000,100000,6,1,7)",[n.WorksheetFuncId.FV]:"=FV(0.06/12, 10, -200, -500, 1)",[n.WorksheetFuncId.IF]:`=IF(C2>B2,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OverBudget)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WithinBudget)}")`,[n.WorksheetFuncId.LN]:"=LN(86)",[n.WorksheetFuncId.NA]:"=NA()",[n.WorksheetFuncId.OR]:"=OR(A2>1,A2<100)",[n.WorksheetFuncId.PV]:"=PV(0.08/12, 12*20, 500, , 0)",[n.WorksheetFuncId.N]:`=N(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Even)})`,[n.WorksheetFuncId.T]:`=T("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hello)}")`,[n.WorksheetFuncId.ACCRINT]:"=ACCRINT(39508,39691,39569,0.1,1000,2,0)",[n.WorksheetFuncId.ACCRINTM]:"=ACCRINTM(39539,39614,0.1,1000,3)",[n.WorksheetFuncId.AMORDEGRC]:"=AMORDEGRC(2400,39679,39813,300,1,0.15,1)",[n.WorksheetFuncId.AMORLINC]:"=AMORLINC(2400,39679,39813,300,1,0.15,1)",[n.WorksheetFuncId.BESSELI]:"=BESSELI(1.5,1)",[n.WorksheetFuncId.BESSELJ]:"=BESSELJ(1.9,2)",[n.WorksheetFuncId.BESSELK]:"=BESSELK(1.5,1)",[n.WorksheetFuncId.BESSELY]:"=BESSELY(2.5,1)",[n.WorksheetFuncId.BIN2DEC]:"=BIN2DEC(1100100)",[n.WorksheetFuncId.BIN2HEX]:"=BIN2HEX(11111011, 4)",[n.WorksheetFuncId.BIN2OCT]:"=BIN2OCT(1001, 3)",[n.WorksheetFuncId.COMPLEX]:'=COMPLEX(3,4,"j")',[n.WorksheetFuncId.CONVERT]:'=CONVERT(1,"lbm","kg")',[n.WorksheetFuncId.COUPDAYBS]:"=COUPDAYBS(25-Jan-11,15-Nov-11,2,1)",[n.WorksheetFuncId.COUPDAYS]:"=COUPDAYS(25-Jan-11,15-Nov-11,2,1)",[n.WorksheetFuncId.COUPDAYSNC]:"=COUPDAYSNC(25-Jan-11,15-Nov-11,2,1)",[n.WorksheetFuncId.COUPNCD]:"=COUPNCD(25-Jan-11,15-Nov-11,2,1)",[n.WorksheetFuncId.COUPNUM]:"=COUPNUM(25-Jan-11,15-Nov-12,2,1)",[n.WorksheetFuncId.COUPPCD]:"=COUPPCD(25-Jan-11,15-Nov-11,2,1)",[n.WorksheetFuncId.CUMIPMT]:"=CUMIPMT(A2/12,A3*12,A4,13,24,0)",[n.WorksheetFuncId.CUMPRINC]:"=CUMPRINC(A2/12,A3*12,A4,13,24,0)",[n.WorksheetFuncId.DEC2BIN]:"=DEC2BIN(9, 4)",[n.WorksheetFuncId.DEC2HEX]:"=DEC2HEX(100,4)",[n.WorksheetFuncId.DEC2OCT]:"=DEC2OCT(58,3)",[n.WorksheetFuncId.DELTA]:"=DELTA(5,4)",[n.WorksheetFuncId.DISC]:"=DISC(7/1/2018,1/1/2048,97.975,100,1)",[n.WorksheetFuncId.DOLLARDE]:"=DOLLARDE(1.02,16)",[n.WorksheetFuncId.DOLLARFR]:"=DOLLARFR(1.125,16)",[n.WorksheetFuncId.DURATION]:"=DURATION(7/1/2018,1/1/2048,8%,9%,2,1)",[n.WorksheetFuncId.EDATE]:"=EDATE(15-Jan-11,1)",[n.WorksheetFuncId.EFFECT]:"=EFFECT(0.0525,4)",[n.WorksheetFuncId.EOMONTH]:"=EOMONTH(1-Jan-11,1)",[n.WorksheetFuncId.ERF]:"=ERF(0.745)",[n.WorksheetFuncId.ERFC]:"=ERFC(1)",[n.WorksheetFuncId.FACTDOUBLE]:"=FACTDOUBLE(6)",[n.WorksheetFuncId.FORECAST_ETS]:"=FORECAST.ETS(A62,$B$4:$B$60,$A$4:$A$60,1,1)",[n.WorksheetFuncId.FORECAST_ETS_CONFINT]:"=FORECAST.ETS.CONFINT(A62,$B$4:$B$60,$A$4:$A$60,0.95,1,1)",[n.WorksheetFuncId.FORECAST_ETS_SEASONALITY]:"=FORECAST.ETS.SEASONALITY($B$4:$B$60,$A$4:$A$60,1,1)",[n.WorksheetFuncId.FORECAST_ETS_STAT]:"=FORECAST.ETS.STAT($B$4:$B$60,$A$4:$A$60,1,J48,1,1)",[n.WorksheetFuncId.FVSCHEDULE]:"=FVSCHEDULE(1,{0.09,0.11,0.1})",[n.WorksheetFuncId.GCD]:"=GCD(24,36)",[n.WorksheetFuncId.GESTEP]:"=GESTEP(5,4)",[n.WorksheetFuncId.HEX2BIN]:"=HEX2BIN(F,8)",[n.WorksheetFuncId.HEX2DEC]:"=HEX2DEC(FFFFFFFF5B)",[n.WorksheetFuncId.HEX2OCT]:"=HEX2OCT(F, 3)",[n.WorksheetFuncId.IMABS]:'=IMABS("5+12i")',[n.WorksheetFuncId.IMAGE]:'=IMAGE("https://microsoft.com/abc.jpg", "Microsoft", 0)',[n.WorksheetFuncId.IMAGINARY]:'=IMAGINARY("3+4i")',[n.WorksheetFuncId.IMARGUMENT]:'=IMARGUMENT("3+4i")',[n.WorksheetFuncId.IMCONJUGATE]:'=IMCONJUGATE("3+4i")',[n.WorksheetFuncId.IMCOS]:'=IMCOS("1+i")',[n.WorksheetFuncId.IMDIV]:'=IMDIV("-238+240i","10+24i")',[n.WorksheetFuncId.IMEXP]:'=IMEXP("1+i")',[n.WorksheetFuncId.IMLN]:'=IMLN("3+4i")',[n.WorksheetFuncId.IMLOG10]:'=IMLOG10("3+4i")',[n.WorksheetFuncId.IMLOG2]:'=IMLOG2("3+4i")',[n.WorksheetFuncId.IMPOWER]:'=IMPOWER("2+3i", 3)',[n.WorksheetFuncId.IMPRODUCT]:'=IMPRODUCT("3+4i","5-3i")',[n.WorksheetFuncId.IMREAL]:'=IMREAL("6-9i")',[n.WorksheetFuncId.IMSIN]:'=IMSIN("4+3i")',[n.WorksheetFuncId.IMSQRT]:'=IMSQRT("1+i")',[n.WorksheetFuncId.IMSUB]:'=IMSUB("13+4i","5+3i")',[n.WorksheetFuncId.IMSUM]:'=IMSUM("3+4i","5-3i")',[n.WorksheetFuncId.INTRATE]:"=INTRATE(2/15/2008,5/15/2008,1000000,1014420,2)",[n.WorksheetFuncId.ISEVEN]:"=ISEVEN(2.5)",[n.WorksheetFuncId.ISODD]:"=ISODD(2.5)",[n.WorksheetFuncId.LAMBDA]:"=LAMBDA(a, b, SQRT((a^2+b^2)))",[n.WorksheetFuncId.LET]:`=LET(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Total)}, SUM(A1:A10), ${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Count)}, COUNT(A1:A10), ${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Total)} / ${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Count)})`,[n.WorksheetFuncId.LCM]:"=LCM(5,2)",[n.WorksheetFuncId.LOG10]:"=LOG10(86)",[n.WorksheetFuncId.MDURATION]:"=MDURATION(1/1/2008,1/1/2016,8%,9%,2,1)",[n.WorksheetFuncId.MROUND]:"=MROUND(10,3)",[n.WorksheetFuncId.MULTINOMIAL]:"=MULTINOMIAL(2,3,4)",[n.WorksheetFuncId.NETWORKDAYS]:"=NETWORKDAYS(10/1/2012,3/1/2013)",[n.WorksheetFuncId.NOMINAL]:"=NOMINAL(0.053543, 4)",[n.WorksheetFuncId.NOW]:"=NOW()",[n.WorksheetFuncId.OCT2BIN]:"=OCT2BIN(3,3)",[n.WorksheetFuncId.OCT2DEC]:"=OCT2DEC(54)",[n.WorksheetFuncId.OCT2HEX]:"=OCT2HEX(100,4)",[n.WorksheetFuncId.ODDFPRICE]:"=ODDFPRICE(11/11/2008,3/1/2021,10/15/2008,3/1/2009,7.85%,6.25%,100,2,1)",[n.WorksheetFuncId.ODDFYIELD]:"=ODDFYIELD(11/11/2008,3/1/2021,10/15/2008,3/1/2009,5.75%,84.5,100,2,0)",[n.WorksheetFuncId.ODDLPRICE]:"=ODDLPRICE(2/7/2008,6/15/2008,10/15/2007,3.75%,4.05%,100,2,0)",[n.WorksheetFuncId.ODDLYIELD]:"=ODDLYIELD(4/20/2008,6/15/2008,12/24/2007,3.75%,99.875,100,2,0)",[n.WorksheetFuncId.PI]:"=PI()",[n.WorksheetFuncId.PRICE]:"=PRICE(2/15/2008,11/15/2017,5.75%,6.5%,100,2,0)",[n.WorksheetFuncId.PRICEDISC]:"=PRICEDISC(2/16/2008,3/1/2008,5.25%,100,2)",[n.WorksheetFuncId.PRICEMAT]:"=PRICEMAT(2/15/2008,4/13/2008,11/11/2007,6.1%,6.1%,0)",[n.WorksheetFuncId.QUOTIENT]:"=QUOTIENT(5,2)",[n.WorksheetFuncId.RANDBETWEEN]:"=RANDBETWEEN(1,100)",[n.WorksheetFuncId.RECEIVED]:"=RECEIVED(2/15/2008,5/15/2008,1000000,5.75%,2)",[n.WorksheetFuncId.RECURSE]:"=RECURSE()",[n.WorksheetFuncId.ROUNDDOWN]:"=ROUNDDOWN(3.14159,3)",[n.WorksheetFuncId.ROUNDUP]:"=ROUNDUP(3.14159,3)",[n.WorksheetFuncId.SERIESSUM]:"=SERIESSUM(0.785398163,0,2,A4:A7)",[n.WorksheetFuncId.SQRTPI]:"=SQRTPI(1)",[n.WorksheetFuncId.TBILLEQ]:"=TBILLEQ(3/31/2008,6/1/2008,9.14%)",[n.WorksheetFuncId.TBILLPRICE]:"=TBILLPRICE(3/31/2008,6/1/2008,9%)",[n.WorksheetFuncId.TBILLYIELD]:"=TBILLYIELD(3/31/2008,6/1/2008,98.45%)",[n.WorksheetFuncId.TINV]:"=TINV(0.05464,60)",[n.WorksheetFuncId.WEEKNUM]:"=WEEKNUM(3/9/2012,2)",[n.WorksheetFuncId.WORKDAY]:"=WORKDAY(10/1/2008,151)",[n.WorksheetFuncId.XIRR]:"=XIRR(A3:A7, B3:B7, 0.1)",[n.WorksheetFuncId.XNPV]:"=XNPV(0.09, A2:A6, B2:B6)",[n.WorksheetFuncId.YEARFRAC]:"=YEARFRAC(1/1/2012,7/30/2012)",[n.WorksheetFuncId.YIELD]:"=YIELD(2/15/2008,11/15/2016,5.75%,95.04287,100,2,0)",[n.WorksheetFuncId.YIELDDISC]:"=YIELDDISC(2/16/2008,3/1/2008,99.795,100,2)",[n.WorksheetFuncId.YIELDMAT]:"=YIELDMAT(3/15/2008,11/3/2008,11/8/2007,6.25%,100.0123,0)",[n.WorksheetFuncId.TEXTSPLIT]:'=TEXTSPLIT("1,2,3;4,5,6",",",";")',[n.WorksheetFuncId.TEXTBEFORE]:'=TEXTBEFORE("Red riding hood\'s, red hood", "hood")',[n.WorksheetFuncId.TEXTAFTER]:'=TEXTAFTER("Red riding hood\'s, red hood", "hood")',[n.WorksheetFuncId.VSTACK]:"=VSTACK({1,2},{3,4},5)",[n.WorksheetFuncId.HSTACK]:"=HSTACK({1;2},{3;4},5)",[n.WorksheetFuncId.MAP]:"=MAP(A1:C2, LAMBDA(a, IF(a>4,a*a,a)))",[n.WorksheetFuncId.WRAPROWS]:"=WRAPROWS(A2:G2,3)",[n.WorksheetFuncId.SCAN]:"=SCAN(1, A1:C2, LAMBDA(a,b,a*b))",[n.WorksheetFuncId.MAKEARRAY]:"=MAKEARRAY(3, 3, LAMBDA(row,col, row*col))",[n.WorksheetFuncId.REDUCE]:"=REDUCE(, A1:C2, LAMBDA(a,b,a+b^2))",[n.WorksheetFuncId.NORMSDIST]:"=NORMDIST(A2,A3,A4,TRUE)",[n.WorksheetFuncId.CHOOSEROWS]:"=CHOOSEROWS(A2:B7,1,3,5,1)",[n.WorksheetFuncId.CHOOSECOLS]:"=CHOOSECOLS(A2:E7,1,3,5,1)",[n.WorksheetFuncId.DROP]:"=DROP(A2:C4,2)",[n.WorksheetFuncId.WRAPCOLS]:"=WRAPCOLS(A2:F2,3)",[n.WorksheetFuncId.TOCOL]:"=TOCOL(A2:D4)",[n.WorksheetFuncId.TAKE]:"=TAKE(A2:C4,2)",[n.WorksheetFuncId.TOROW]:"=TOROW(A2:D4)",[n.WorksheetFuncId.BYCOL]:`=BYCOL(A1:C2, LAMBDA(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array)}, MAX(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array)})))`,[n.WorksheetFuncId.BYROW]:`=BYROW(A1:C2, LAMBDA(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array)}, MAX(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array)})))`,[n.WorksheetFuncId.EXPAND]:"=EXPAND(A2:B3,3,3)",[n.WorksheetFuncId.DBCS]:'=DBCS("EXCEL")',[n.WorksheetFuncId.ASC]:'=ASC("EXCEL")',[n.WorksheetFuncId.LENB]:'=LENB("EXCEL")',[n.WorksheetFuncId.FURIGANA]:"=PHONETIC(C4)",[n.WorksheetFuncId.ISOMITTED]:`=LAMBDA(x,y, IF(ISOMITTED(y),"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingSecondArgument)}",x+y))(1,)`,[n.WorksheetFuncId.MIDB]:"=MIDB(A2,7,20)",[n.WorksheetFuncId.RIGHTB]:"=RIGHTB(A2,7)"})))},13581:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationDefinitionsMap=t.RegisterAnnotation=t.alFeatureNamePrefix=void 0;const n=r(92582),i=r(12450),o=r(90154),a=r(84565);t.alFeatureNamePrefix="x10";const s={[o.ALAnnotationKind.FormulaByExample]:{annotationType:n.FormulaByExampleAnnotation,isModelRequired:!1}};t.RegisterAnnotation={[o.ALAnnotationKind.FormulaByExample]:!0},t.AnnotationDefinitionsMap=(0,a.mapFromArrayOfDependantPairs)((0,i.strEnumArray)(o.ALAnnotationKind).map((e=>[e,{annotationName:s[e].annotationType.getTypeName(),featureName:`${t.alFeatureNamePrefix}_${e}`,isModelRequired:s[e].isModelRequired}])))},14862:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AugLoopService=void 0;const n=r(19181),i=r(33436),o=r(12450),a=r(18538),s=r(13581),l=r(90154),u=r(84565),c=r(81476);t.AugLoopService=class{registerALAnnotation(e){return n.__awaiter(this,void 0,void 0,(function*(){const t=this.registerAnnotationCallbacks[e].getValue();return"Failure"===(yield t).kind&&this.registerAnnotationCallbacks[e].reset(),t}))}sendSignal(e,t){return n.__awaiter(this,void 0,void 0,(function*(){try{const r=yield this.augLoopInterop.sendSignal(e,`${s.alFeatureNamePrefix}_${a.PluginFactoryName[t]}`);return(0,o.isDefined)(r)?(0,i.success)(r):(0,i.failure)(r)}catch(e){return(0,i.failure)(e)}}))}constructor(e){this.augLoopInterop=e,this.registerAnnotationCallbacks=(0,u.mapFromArrayOfDependantPairs)((0,o.strEnumArray)(l.ALAnnotationKind).map((e=>[e,new c.ResettableLazy((()=>n.__awaiter(this,void 0,void 0,(function*(){try{const t=s.AnnotationDefinitionsMap[e],r=yield this.augLoopInterop.registerOnAnnotation(l.ALAnnotationKind[e],t.annotationName,t.featureName,t.isModelRequired);return(0,i.success)(r)}catch(e){return(0,i.failure)(e)}}))))])))}}},79126:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getConvertEnum=t.speedUnitTypeEnums=t.informationUnitTypeEnums=t.areaUnitTypeEnums=t.volumeUnitTypeEnums=t.temperatureUnitTypeEnums=t.magnetismUnitTypeEnums=t.powerUnitTypeEnums=t.energyUnitTypeEnums=t.forceUnitTypeEnums=t.pressureUnitTypeEnums=t.timeUnitTypeEnums=t.distanceUnitTypeEnums=t.massUnitTypeEnums=void 0;const n=r(81476);t.massUnitTypeEnums=new n.ResettableLazy((()=>[{value:"g",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Gram)},{value:"sg",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Slug)},{value:"lbm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PoundM)},{value:"u",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Atomic)},{value:"ozm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ozm)},{value:"grain",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Grain)},{value:"cwt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CWeight)},{value:"uk_cwt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CWeightUk)},{value:"stone",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Stone)},{value:"ton",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ton)},{value:"uk_ton",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TonUk)}])),t.distanceUnitTypeEnums=new n.ResettableLazy((()=>[{value:"m",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Meter)},{value:"mi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMile)},{value:"Nmi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NMile)},{value:"in",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Inch)},{value:"ft",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ft)},{value:"yd",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yd)},{value:"ang",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Angs)},{value:"Pica",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Pica)},{value:"ell",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ell)},{value:"ly",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LightYr)},{value:"parsec",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Parsec)},{value:"survey_mi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MileUs)}])),t.timeUnitTypeEnums=new n.ResettableLazy((()=>[{value:"yr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yr)},{value:"day",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Day)},{value:"hr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hour)},{value:"mn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Minute)},{value:"sec",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sec)}])),t.pressureUnitTypeEnums=new n.ResettableLazy((()=>[{value:"Pa",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Pascal)},{value:"atm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Atmos)},{value:"mmHg",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Merc)},{value:"psi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Psi)},{value:"Torr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Torr)}])),t.forceUnitTypeEnums=new n.ResettableLazy((()=>[{value:"N",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Newton)},{value:"dyn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Dyne)},{value:"lbf",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PoundF)},{value:"pond",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Pond)}])),t.energyUnitTypeEnums=new n.ResettableLazy((()=>[{value:"J",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Joule)},{value:"e",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Erg)},{value:"cal",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ItCal)},{value:"eV",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volt)},{value:"HPh",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HorsePwHr)},{value:"Wh",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WattHr)},{value:"flb",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FtPound)},{value:"BTU",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Btu)},{value:"c",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThermCal)}])),t.powerUnitTypeEnums=new n.ResettableLazy((()=>[{value:"HP",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HorsePw)},{value:"W",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Watt)},{value:"PS",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HorseStr)}])),t.magnetismUnitTypeEnums=new n.ResettableLazy((()=>[{value:"T",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tessla)},{value:"ga",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Gauss)}])),t.temperatureUnitTypeEnums=new n.ResettableLazy((()=>[{value:"C",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Cels)},{value:"F",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Fahr)},{value:"K",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Kelv)},{value:"Rank",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Rankine)},{value:"Reau",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Reaumur)}])),t.volumeUnitTypeEnums=new n.ResettableLazy((()=>[{value:"tsp",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tsp)},{value:"tbs",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tbs)},{value:"oz",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Oz)},{value:"cup",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Cup)},{value:"qt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.QuartUs)},{value:"gal",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Gal)},{value:"l",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Liter)},{value:"uk_pt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PintUk)},{value:"us_pt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PintUs)},{value:"ang^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AngsPow3)},{value:"barrel",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Barrel)},{value:"bushel",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Bushel)},{value:"ft^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FootPow3)},{value:"GRT",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegTon)},{value:"in^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.InchPow3)},{value:"ly^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LightYrPow3)},{value:"mi^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMilePow3)},{value:"MTON",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MeasTon)},{value:"Nmi^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NMilePow3)},{value:"Pica^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PicaPow3)},{value:"tspm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MdnTsp)},{value:"uk_gal",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.GalUk)},{value:"yd^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.YdPow3)},{value:"uk_qt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.QuartUk)}])),t.areaUnitTypeEnums=new n.ResettableLazy((()=>[{value:"uk_acre",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AcreUk)},{value:"us_acre",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AcreUs)},{value:"ang^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AngsPow2)},{value:"ar",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Are)},{value:"ft^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FootPow2)},{value:"ha",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hectare)},{value:"in^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.InchPow2)},{value:"ly^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LightYrPow2)},{value:"m^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MeterPow2)},{value:"Morgen",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Morgen)},{value:"mi^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMilePow2)},{value:"Nmi^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NMilePow2)},{value:"Pica^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PicaPow2)},{value:"yd^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.YdPow2)}])),t.informationUnitTypeEnums=new n.ResettableLazy((()=>[{value:"bit",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Bit)},{value:"byte",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Byte)}])),t.speedUnitTypeEnums=new n.ResettableLazy((()=>[{value:"admkn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AdmKnot)},{value:"kn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Knot)},{value:"m/hr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MSlashHr)},{value:"m/sec",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MSlashSec)},{value:"mph",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MPH)}]));const i=new n.ResettableLazy((()=>[t.massUnitTypeEnums,t.distanceUnitTypeEnums,t.timeUnitTypeEnums,t.pressureUnitTypeEnums,t.forceUnitTypeEnums,t.energyUnitTypeEnums,t.powerUnitTypeEnums,t.magnetismUnitTypeEnums,t.temperatureUnitTypeEnums,t.volumeUnitTypeEnums,t.areaUnitTypeEnums,t.informationUnitTypeEnums,t.speedUnitTypeEnums]));t.getConvertEnum=function(e,t,r,n){const o=i.getValue().map((e=>e.getValue())),a=[].concat(...o);if(2===e)return a;if(3===e){const e=function(e,t,r){var n;const o=e.spans[r[1].label].start,a=e.spans[r[1].label].end,s=null!==(n=t.substring(o,a).replace(/^"|"$/g,""))&&void 0!==n?n:"";if(""===s)return[];for(const e of i.getValue())if(e.getValue().find((e=>e.value===s)))return e.getValue();return[]}(t,r,n);return e.length>0?e:a}return[]}},67031:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteEnumPluginDependenciesResolved=t.AutocompleteEnumPluginFactory=void 0;const n=r(19181),i=r(50111),o=r(78469),a=r(55340),s=r(33436),l=r(94591),u=r(60111),c=r(39986),d=r(48071),m=r(94776),g=r(12450),p=r(439),h=r(79126),f=r(96438),S=r(18538),v=r(53507);class y{create(){return new F}constructor(){this.factoryName=S.PluginFactoryName.AutocompleteEnumPlugin}}t.AutocompleteEnumPluginFactory=y;class F{*run(e){const t=yield{kind:i.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(t.kind!==i.ComputationRequestKind.ParseActiveCell||!(0,s.isSuccess)(t.result))return null;if(t.result.value.kind!==l.EditKind.Formula)return null;const{formula:r}=t.result.value,n=new m.AutoCompleteEnumVisitor(r,e.caretPosition);if((0,c.reduceBottomUp)(n,r),void 0===n.stringStartPosition||void 0===n.stringEndPosition||void 0===n.functionHead||void 0===n.argIndex||void 0===n.functionArgs||n.isInsideArrayNode)return null;const o=n.argIndex+1,{stringStartPosition:a,stringEndPosition:u,functionHead:d}=n,S=e.caretPosition===u?e.content.substring(a,u).toUpperCase():"";let v;if(d.id===f.WorksheetFuncId.CONVERT)v=(0,h.getConvertEnum)(o,r,e.content,n.functionArgs);else{const e=p.functionEnums.getValue();v=this.getEnumInfoByArg(o,e,d.id)}if((0,g.isNone)(v))return null;const y=yield{kind:i.ComputationRequestKind.GetConfig};if(y.kind!==i.ComputationRequestKind.GetConfig)return this.logFailure("failed to get config"),null;const F=y.config.localeInfo,C=this.getLocalizedEnumInfo(v,F);if(0===C.length)return this.logFailure("failed to get enum info for values/descriptions"),null;const{prefixedEnumInfo:R,notPrefixedEnumInfo:b}=this.getFilteredEnumInfo(S,d.id,C),E=this.shouldAddDoubleQuotes(d.id);return{items:[...this.generateCompletionItems(R,a,u,!0,E),...this.generateCompletionItems(b,a,u,!1,E)]}}generateCompletionItems(e,t,r,n,i){return e.map((e=>{const o=i?`"${e.value}"`:e.value;return{label:o,kind:S.CompletionItemKind.Enum,detail:e.description,textEdit:{newText:o,range:{start:{line:0,character:t},end:{line:0,character:r}}},isPrefixed:n}}))}getFilteredEnumInfo(e,t,r){let n=[],i=[];const o=e.replace(/^"|"$/g,"");if(this.shouldAddDoubleQuotes(t)&&e.endsWith('"')&&e.startsWith('"'))n=r.filter((e=>e.value.toUpperCase()===o));else{const e=(0,d.filterSuggestionsAccordingToPrefix)(o,r,(e=>e.value));n=e.prefixedSuggestions,i=e.notPrefixedSuggestions}return 0===n.length&&0===i.length&&i.push(...r),{prefixedEnumInfo:n,notPrefixedEnumInfo:i}}getEnumInfoByArg(e,t,r){const n=t[r];if(!(0,g.isNone)(n))return n[e]}getLocalizedEnumInfo(e,t){const r=e.map((e=>({value:"function"==typeof e.value?e.value(t):e.value,description:"function"==typeof e.description?e.description(t):e.description}))),n=r.length,i=r.filter((e=>{const{value:t,description:r}=e;return void 0!==t&&void 0!==r&&""!==t&&"undefined"!==t}));return e.length!==n&&this.logFailure("failed to get enum info for some values"),i}shouldAddDoubleQuotes(e){return e===f.WorksheetFuncId.COMPLEX||e===f.WorksheetFuncId.INFO||e===f.WorksheetFuncId.CONVERT||e===f.WorksheetFuncId.CELL}logFailure(e){a.ulsLogger.ULS.traceTag(508350686,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,`AutocompleteEnumPlugin encountered a failure with msg ${e}`)}}(0,o.registerPluginFactory)(new y),t.autocompleteEnumPluginDependenciesResolved=(0,v.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield u.autoCompletePluginsThread.getValue();yield e.loadPluginScript("formula-authoring-strings",!0),yield e.createAndAttachPlugin(S.PluginFactoryName.AutocompleteEnumPlugin),yield u.schedulerWithRecalcServiceAttached.getValue()}))),"autocompleteEnumPluginDependenciesResolved")},94776:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutoCompleteEnumVisitor=void 0;const n=r(71510),i=r(31873);class o extends i.CaretInsideArrayNodeIdentityVisitor{appNode(e,t,r,i){return e.kind===n.NodeKind.WSF&&this.updateAssistedFunctionAndArgIndex(e,t),super.appNode(e,t,r,i)}updateAssistedFunctionAndArgIndex(e,t){for(let r=0;r<t.length;r++){const n=this.parsedFormulaTree.spans[t[r].label];if(n&&n.start-n.pre.length<=this.caretPosition&&this.caretPosition<=n.end+n.post.length&&void 0===this.functionHead){this.functionHead=e,this.argIndex=r,this.functionArgs=t,this.stringStartPosition=n.start,this.stringEndPosition=n.end;break}}}constructor(e,t){super(e,t)}}t.AutoCompleteEnumVisitor=o},439:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionEnums=void 0;const n=r(96438),i=r(81476),o=r(30333);t.functionEnums=new i.ResettableLazy((()=>({[n.WorksheetFuncId.ERROR_TYPE]:{1:[{value:e=>{var t;return null!==(t=e.errorNames[o.ErrorType.NULL])&&void 0!==t?t:""},description:o.ErrorType.NULL.toString()},{value:e=>{var t;return null!==(t=e.errorNames[o.ErrorType.DIV0])&&void 0!==t?t:""},description:o.ErrorType.DIV0.toString()},{value:e=>{var t;return null!==(t=e.errorNames[o.ErrorType.VALUE])&&void 0!==t?t:""},description:o.ErrorType.VALUE.toString()},{value:e=>{var t;return null!==(t=e.errorNames[o.ErrorType.REF])&&void 0!==t?t:""},description:o.ErrorType.REF.toString()},{value:e=>{var t;return null!==(t=e.errorNames[o.ErrorType.NAME])&&void 0!==t?t:""},description:o.ErrorType.NAME.toString()},{value:e=>{var t;return null!==(t=e.errorNames[o.ErrorType.NUM])&&void 0!==t?t:""},description:o.ErrorType.NUM.toString()},{value:e=>{var t;return null!==(t=e.errorNames[o.ErrorType.NA])&&void 0!==t?t:""},description:o.ErrorType.NA.toString()}]},[n.WorksheetFuncId.SUBTOTAL]:{1:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.PRODUCT)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEV)},{value:"8",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEVP)},{value:"9",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)},{value:"10",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VAR)},{value:"11",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VARP)},{value:"101",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"102",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"103",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"104",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"105",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"106",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.PRODUCT)},{value:"107",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEV)},{value:"108",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEVP)},{value:"109",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)},{value:"110",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VAR)},{value:"111",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VARP)}]},[n.WorksheetFuncId.AGGREGATE]:{1:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.PRODUCT)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEV)},{value:"8",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEVP)},{value:"9",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)},{value:"10",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VAR)},{value:"11",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VARP)},{value:"12",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)},{value:"13",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MODE_SNGL)},{value:"14",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.LARGE)},{value:"15",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SMALL)},{value:"16",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.PERCENTILE_INC)},{value:"17",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.QUARTILE_INC)},{value:"18",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.PERCENTILE_EXC)},{value:"19",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.QUARTILE_EXC)}],2:[{value:"0",description:e=>FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",e.getWorksheetFuncName(n.WorksheetFuncId.SUBTOTAL)).replace("{1}",e.getWorksheetFuncName(n.WorksheetFuncId.AGGREGATE))},{value:"1",description:e=>FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRowsNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",e.getWorksheetFuncName(n.WorksheetFuncId.SUBTOTAL)).replace("{1}",e.getWorksheetFuncName(n.WorksheetFuncId.AGGREGATE))},{value:"2",description:e=>FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrorValuesNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",e.getWorksheetFuncName(n.WorksheetFuncId.SUBTOTAL)).replace("{1}",e.getWorksheetFuncName(n.WorksheetFuncId.AGGREGATE))},{value:"3",description:e=>FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRowsErrorValuesNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",e.getWorksheetFuncName(n.WorksheetFuncId.SUBTOTAL)).replace("{1}",e.getWorksheetFuncName(n.WorksheetFuncId.AGGREGATE))},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreNothing)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRows)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrorValues)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRowsErrorValues)}]},[n.WorksheetFuncId.CUBESET]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.None)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AlphaAscending)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AlphaDescending)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NaturalAscending)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NaturalDescending)}]},[n.WorksheetFuncId.VLOOKUP]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ApproximateMatch)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)}]},[n.WorksheetFuncId.HLOOKUP]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ApproximateMatch)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)}]},[n.WorksheetFuncId.XLOOKUP]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextSmallerItem)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextLargerItem)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WildcardCharacterMatch)}],6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchFirstToLast)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchLastToFirst)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchAscending)},{value:"-2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchDescending)}]},[n.WorksheetFuncId.RANK]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)}]},[n.WorksheetFuncId.RANK_AVG]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)}]},[n.WorksheetFuncId.RANK_EQ]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)}]},[n.WorksheetFuncId.MATCH]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LessThan)},{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.GreaterThan)}]},[n.WorksheetFuncId.XMATCH]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextSmallerItem)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextLargerItem)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WildcardCharacterMatch)}],4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchFirstToLast)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchLastToFirst)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchAscending)},{value:"-2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchDescending)}]},[n.WorksheetFuncId.FINDN]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DontMatchToEnd)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MatchToEnd)}],7:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnsTheFirstCharacterPositionOfTheString)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnsTheLastCharacterPositionOfTheString)}]},[n.WorksheetFuncId.TEXTBEFORE]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DontMatchToEnd)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MatchToEnd)}]},[n.WorksheetFuncId.TEXTAFTER]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DontMatchToEnd)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MatchToEnd)}]},[n.WorksheetFuncId.TEXTSPLIT]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreEmptyCells)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IncludeEmptyCells)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}]},[n.WorksheetFuncId.ACCRINT]:{6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.ACCRINTM]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.ADDRESS]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.R1C1Style)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.A1Style)}],3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Absolute)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AbsoluteRowRelativeColumn)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RelativeRowAbsoluteColumn)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Relative)}]},[n.WorksheetFuncId.AMORDEGRC]:{7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.AMORLINC]:{7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.BETA_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.BINOMDIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.BINOM_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.CHISQ_DIST]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.COMPLEX]:{3:[{value:"i",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ISuffixDescriptionForComplexNumber)},{value:"j",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.JSuffixDescriptionForComplexNumber)}]},[n.WorksheetFuncId.COUPDAYBS]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.COUPDAYS]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.COUPDAYSNC]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.COUPNCD]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.COUPNUM]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.COUPPCD]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.CUMIPMT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.CUMPRINC]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.DAYS360]:{3:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASDMethod)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EuropeanMethod)}]},[n.WorksheetFuncId.DISC]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.DURATION]:{5:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.EXPONDIST]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.EXPON_DIST]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.F_DIST]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.FIXED]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PreventCommas)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotPreventCommas)}]},[n.WorksheetFuncId.FV]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.GAMMADIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.GAMMA_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.HYPGEOM_DIST]:{5:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.INDIRECT]:{2:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.A1Style)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.R1C1Style)}]},[n.WorksheetFuncId.INTRATE]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.IPMT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.LINEST]:{3:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}],4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnAdditionalRegressionStatistics)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotReturnAdditionalRegressionStatistics)}]},[n.WorksheetFuncId.LOGEST]:{3:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}],4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnAdditionalRegressionStatistics)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotReturnAdditionalRegressionStatistics)}]},[n.WorksheetFuncId.LOGNORM_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.MDURATION]:{5:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.NEGBINOM_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.NORM_S_DIST]:{2:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.NORMDIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.NORM_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.NPER]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.ODDFPRICE]:{8:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],9:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.ODDFYIELD]:{8:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],9:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.ODDLPRICE]:{7:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],8:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.ODDLYIELD]:{7:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],8:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.PMT]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.POISSON]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.POISSON_DIST]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.PPMT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.PRICE]:{6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.PRICEDISC]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.PRICEMAT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.QUARTILE]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MinimumValue)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuartile)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MedianValue)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThirdQuartile)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MaximumValue)}]},[n.WorksheetFuncId.QUARTILE_INC]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MinimumValue)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuartile)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MedianValue)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThirdQuartile)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MaximumValue)}]},[n.WorksheetFuncId.QUARTILE_EXC]:{2:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuartile)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MedianValue)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThirdQuartile)}]},[n.WorksheetFuncId.RATE]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.RECEIVED]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.ROMAN]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Classic)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MoreConcise)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MoreConcise)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MoreConcise)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Simplified)}]},[n.WorksheetFuncId.STOCKHISTORY]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Daily)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Weekly)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monthly)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NoHeader)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Showheader)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ShowInstrumentIdentifierAndHeader)}],6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],8:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],9:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],10:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],11:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}]},[n.WorksheetFuncId.TREND]:{4:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}]},[n.WorksheetFuncId.TTEST]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OneTailedDistribution)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoTailedDistribution)}],4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Paired)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleEqualVariance)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleUnequalVariance)}]},[n.WorksheetFuncId.T_TEST]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OneTailedDistribution)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoTailedDistribution)}],4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Paired)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleEqualVariance)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleUnequalVariance)}]},[n.WorksheetFuncId.VDB]:{7:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SwitchToStraightLineDepreciation)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotSwitchToStraightLineDepreciation)}]},[n.WorksheetFuncId.WEEKDAY]:{2:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Sundaythrough7Saturday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Mondaythrough7Sunday)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers0Mondaythrough6Sunday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Mondaythrough7Sunday)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Tuesdaythrough7Monday)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Wednesdaythrough7Tuesday)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Thursdaythrough7Wednesday)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Fridaythrough7Thursday)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Saturdaythrough7Friday)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Sundaythrough7Saturday)}]},[n.WorksheetFuncId.WEIBULL]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.WEIBULL_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.YEARFRAC]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.YIELD]:{6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.YIELDDISC]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.YIELDMAT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.GROWTH]:{4:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}]},[n.WorksheetFuncId.PV]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.TDIST]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OneTailedDistribution)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoTailedDistribution)}]},[n.WorksheetFuncId.T_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.WEEKNUM]:{2:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sunday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tuesday)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Wednesday)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Thursday)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Friday)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Saturday)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sunday)},{value:"21",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday)}]},[n.WorksheetFuncId.NETWORKDAYS_INTL]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdaySunday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayMonday)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayTuesday)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayWednesday)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayThursday)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayFriday)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridaySaturday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayOnly)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayOnly)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayOnly)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayOnly)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayOnly)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridayOnly)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdayOnly)}]},[n.WorksheetFuncId.WORKDAY_INTL]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdaySunday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayMonday)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayTuesday)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayWednesday)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayThursday)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayFriday)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridaySaturday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayOnly)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayOnly)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayOnly)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayOnly)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayOnly)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridayOnly)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdayOnly)}]},[n.WorksheetFuncId.FORECAST_ETS]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],6:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)}]},[n.WorksheetFuncId.FORECAST_ETS_CONFINT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],7:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)}]},[n.WorksheetFuncId.FORECAST_ETS_SEASONALITY]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],4:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)}]},[n.WorksheetFuncId.FORECAST_ETS_STAT]:{4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AlphaParameterOfETSalgorithm)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BetaParameterOfETSalgorithm)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.GammaParameterOfETSalgorithm)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MASEMetric)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMAPEMetric)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MAEMetric)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RMSEMetric)},{value:"8",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.StepSizeDetected)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],6:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)}]},[n.WorksheetFuncId.TEXTJOIN]:{2:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreEmptyCells)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IncludeEmptyCells)}]},[n.WorksheetFuncId.SORT]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)}],4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SortByColumn)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SortByRow)}]},[n.WorksheetFuncId.UNIQUE]:{2:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnUniqueColumns)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnUniqueRows)}],3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnitemsthatAppearExactlyOnce)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnEveryDistinctItem)}]},[n.WorksheetFuncId.SORTBY]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)}]},[n.WorksheetFuncId.RANDARRAY]:{5:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Integer)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Decimal)}]},[n.WorksheetFuncId.VALUETOTEXT]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Concise)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Strict)}]},[n.WorksheetFuncId.ARRAYTOTEXT]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Concise)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Strict)}]},[n.WorksheetFuncId.TOCOL]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.KeepAllValues)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanks)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrors)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanksAndErrors)}],3:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByRow)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByColumn)}]},[n.WorksheetFuncId.TOROW]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.KeepAllValues)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanks)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrors)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanksAndErrors)}],3:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByRow)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByColumn)}]},[n.WorksheetFuncId.IMAGE]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FitCell)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FillCell)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OriginalSize)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CustomSize)}]}})))},24226:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteBaseVisitor=void 0;const n=r(71510),i=r(31873);class o extends i.CaretInsideArrayNodeIdentityVisitor{nameNode(e,t,r){return e.kind!==n.NamePartKind.IdentNamePart&&e.kind!==n.NamePartKind.FieldRefNamePart||this.updateAutocompleteString(r,e.asWhole),super.nameNode(e,t,r)}appNode(e,t,r,i){return this.autoCompleteForCellRefEnabled&&e.kind===n.NodeKind.WSF&&this.updateAutocompleteString(i,e.whole),super.appNode(e,t,r,i)}cellRefNode(e,t,r){const i=this.parsedFormulaTree.spans[r];if(e.kind===n.CellRefKind.Single&&i){const e=this.formulaString.substring(i.start,i.end);this.updateAutocompleteString(r,e)}return super.cellRefNode(e,t,r)}updateAutocompleteString(e,t){const r=this.parsedFormulaTree.spans[e].start,n=r+t.length;this.caretPosition===n&&(this.autocompleteString=t,this.stringEndPosition=n,this.stringStartPosition=r)}constructor(e,t,r,n){super(e,t),this.formulaString=r,this.autoCompleteForCellRefEnabled=n}}t.AutocompleteBaseVisitor=o},29712:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteFunctionPluginDependenciesResolved=t.AutocompleteFunctionPluginFactory=void 0;const n=r(19181),i=r(50111),o=r(78469),a=r(55340),s=r(33436),l=r(94591),u=r(60111),c=r(39986),d=r(33058),m=r(18538),g=r(18538),p=r(48071),h=r(24226),f=r(12367),S=r(12450),v=r(42549),y=r(53507);class F{create(){return new C}constructor(){this.factoryName=g.PluginFactoryName.AutocompleteFunctionPlugin}}t.AutocompleteFunctionPluginFactory=F;class C{*run(e){const t=yield{kind:i.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(t.kind!==i.ComputationRequestKind.ParseActiveCell||!(0,s.isSuccess)(t.result))return null;if(t.result.value.kind!==l.EditKind.Formula)return null;const{formula:r}=t.result.value,n=new h.AutocompleteBaseVisitor(r,e.caretPosition,e.content,this.autoCompleteForCellRefEnabled);if((0,c.reduceBottomUp)(n,r),void 0===n.autocompleteString||void 0===n.stringStartPosition||void 0===n.stringEndPosition||n.isInsideArrayNode)return null;const o=n.autocompleteString.toUpperCase(),a=n.stringStartPosition,u=n.stringEndPosition,m=yield{kind:i.ComputationRequestKind.GetFunctionsInfo};if(m.kind!==i.ComputationRequestKind.GetFunctionsInfo)return this.logFailure("failed to get functions info"),null;const g=m.functionsInfo,{prefixedSuggestions:f,notPrefixedSuggestions:S}=(0,p.filterSuggestionsAccordingToPrefix)(o,g,(e=>e.NameDataStrings)),v=d.functionShortDescriptions.getValue();null!==v&&null!==v.descriptionMap||this.logFailure("failed to get short descriptions, will show function info help description");const y=(0,p.getCompletedFunctionSuffix)(e.content,u);return{items:[...this.generateCompletionItems(f,v,a,u,!0,y),...this.generateCompletionItems(S,v,a,u,!1,y)]}}generateCompletionItems(e,t,r,n,i,o){const s=[],l=e.map((e=>{var a,l;const u=e.FunctionIndexInServer.toString();let c=(0,v.isTypedChangeGateEnabled)("Microsoft.Office.Excel.UseObjectInsteadOfMapForFunctionShortDescriptions")?null===(a=t.descriptionMap)||void 0===a?void 0:a[u]:null===(l=t.descriptionMap)||void 0===l?void 0:l.get(u);return(0,S.isNone)(c)&&(s.push(e.FunctionIndexInServer),c=e.Help),{label:e.NameDataStrings,kind:m.CompletionItemKind.Function,detail:c,textEdit:{newText:e.NameDataStrings+o,range:{start:{line:0,character:r},end:{line:0,character:n}}},isPrefixed:i,shouldRequestAutocompleteOnCommit:this.isEnumAutoCompleteFixEnabled}}));return s.length>0&&a.ulsLogger.ULS.traceTag(508871621,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,`AutocompleteFunctionPlugin missing short descriptions for func IDs: ${JSON.stringify(s)}`),l}logFailure(e){a.ulsLogger.ULS.traceTag(539083013,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,`AutocompleteFunctionPlugin encountered a failure with msg ${e}`)}constructor(){this.autoCompleteForCellRefEnabled=(0,f.isChangeGateEnabled)("OfficeVSO:6212698_fixFunctionAutoCompleteForCellRef"),this.isEnumAutoCompleteFixEnabled=(0,f.isChangeGateEnabled)("OfficeVSO:8593118_AutoCompleteEnumDescriptions")}}(0,o.registerPluginFactory)(new F),t.autocompleteFunctionPluginDependenciesResolved=(0,y.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield u.autoCompletePluginsThread.getValue();yield e.loadPluginScript("formula-authoring-strings",!0),yield e.createAndAttachPlugin(g.PluginFactoryName.AutocompleteFunctionPlugin),yield u.schedulerWithRecalcServiceAttached.getValue()}))),"autocompleteFunctionPluginDependenciesResolved")},48071:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCompletedFunctionSuffix=t.getStructRefCompletionItemRank=t.endOf=t.verifyTextAndRange=t.filterSuggestionsAccordingToPrefix=void 0;const n=r(43512),i=r(57264),o=r(12450),a=r(18538);t.filterSuggestionsAccordingToPrefix=function(e,t,r,n=!1){const i=[],a=[],s=e.toLocaleLowerCase();return""===e?{prefixedSuggestions:t,notPrefixedSuggestions:a}:(t.forEach((e=>{const t=r?r(e).toLocaleLowerCase():"string"==typeof e?e.toLocaleLowerCase():void 0;if(void 0!==t)if(!t.startsWith(s)||n&&t===s)if(n){const r=t.split(" ");(0,o.isDefined)(r.find((e=>e.startsWith(s))))&&a.push(e)}else s.length>2&&t.includes(s)&&a.push(e);else i.push(e)})),{prefixedSuggestions:i,notPrefixedSuggestions:a})},t.verifyTextAndRange=(e,t,r,n,i)=>{var o,a,s,l,u,c,d;expect(null==e?void 0:e.label).toEqual(t),expect(null===(o=null==e?void 0:e.textEdit)||void 0===o?void 0:o.newText).toEqual(null!=i?i:t),expect(null===(l=null===(s=null===(a=null==e?void 0:e.textEdit)||void 0===a?void 0:a.range)||void 0===s?void 0:s.start)||void 0===l?void 0:l.character).toEqual(r),expect(null===(d=null===(c=null===(u=null==e?void 0:e.textEdit)||void 0===u?void 0:u.range)||void 0===c?void 0:c.end)||void 0===d?void 0:d.character).toEqual(n)},t.endOf=e=>e.length,t.getStructRefCompletionItemRank=e=>{var t,r,s,l;const u=e.kind===a.CompletionItemKind.TableHeader?1:null!==(r=null===(t=e.label)||void 0===t?void 0:t.startsWith("#"))&&void 0!==r&&r?0:null!==(l=null===(s=e.label)||void 0===s?void 0:s.startsWith("@"))&&void 0!==l&&l?2:void 0;return(0,o.isNone)(u)?(i.ulsLogger.ULS.traceTag(526411872,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,`conflictResolver: trying to rank a structRef completion item with unexpected fields. item = ${JSON.stringify(e)}`),0):u},t.getCompletedFunctionSuffix=function(e,t){return"("===(null==e?void 0:e.charAt(t))?"":"("}},40541:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteLetPluginDependenciesResolved=t.AutocompleteLetPluginFactory=void 0;const n=r(19181),i=r(50111),o=r(78469),a=r(33436),s=r(94591),l=r(60111),u=r(39986),c=r(20570),d=r(48071),m=r(12367),g=r(18538),p=r(53507);class h{create(){return new f}constructor(){this.factoryName=g.PluginFactoryName.AutocompleteLetPlugin}}t.AutocompleteLetPluginFactory=h;class f{*run(e){const t=yield{kind:i.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(t.kind!==i.ComputationRequestKind.ParseActiveCell||!(0,a.isSuccess)(t.result))return null;if(t.result.value.kind!==s.EditKind.Formula)return null;const{formula:r}=t.result.value,n=e.caretPosition,o=new c.AutocompleteLetVisitor(this.autoCompleteForCellRefEnabled,e.content,r,n);(0,u.reduceBottomUp)(o,r);const l=o.references.reverse(),m=Array.from(new Set(l)),g=o.caretNodeText;if(void 0===g||o.isInsideArrayNode)return null;const p=n,h=p-g.length,{prefixedSuggestions:f,notPrefixedSuggestions:S}=(0,d.filterSuggestionsAccordingToPrefix)(g,m);return{items:[...this.stringsToCompletionItems(f,h,p,!0),...this.stringsToCompletionItems(S,h,p,!1)]}}stringsToCompletionItems(e,t,r,n){return e.map((e=>({label:e,kind:g.CompletionItemKind.LetVariable,type:g.SuggestionKind.Simple,textEdit:{newText:e,range:{start:{line:0,character:t},end:{line:0,character:r}}},isPrefixed:n})))}constructor(){this.autoCompleteForCellRefEnabled=(0,m.isChangeGateEnabled)("OfficeVSO:6212698_fixFunctionAutoCompleteForCellRef")}}(0,o.registerPluginFactory)(new h),t.autocompleteLetPluginDependenciesResolved=(0,p.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield l.autoCompletePluginsThread.getValue();yield e.createAndAttachPlugin(g.PluginFactoryName.AutocompleteLetPlugin),yield l.schedulerWithRecalcServiceAttached.getValue()}))),"autocompleteLetPluginDependenciesResolved")},20570:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteLetVisitor=void 0;const n=r(71510),i=r(31873);class o extends i.ExtractLetVisitor{nameNode(e,t,r){return this.updateCaretNodeText(r,e.asWhole),super.nameNode(e,t,r)}cellRefNode(e,t,r){const i=this.parsedFormulaTree.spans[r];if(this.autoCompleteForCellRefEnabled&&e.kind===n.CellRefKind.Single&&i){const e=this.formulaString.substring(i.start,i.end);this.updateCaretNodeText(r,e)}return super.cellRefNode(e,t,r)}updateCaretNodeText(e,t){var r;const n=null===(r=this.parsedFormulaTree.spans[e])||void 0===r?void 0:r.end;void 0!==n&&this.caretPosition===n&&t.length>0&&(this.caretNodeText=t)}constructor(e,t,r,n){super(r,n),this.autoCompleteForCellRefEnabled=e,this.formulaString=t}}t.AutocompleteLetVisitor=o},30887:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteNamedObjectsPluginDependenciesResolved=t.AutocompleteNamedObjectsPluginFactory=void 0;const n=r(19181),i=r(50111),o=r(78469),a=r(55340),s=r(33436),l=r(94591),u=r(60111),c=r(18538),d=r(24226),m=r(39986),g=r(48071),p=r(12450),h=r(18538),f=r(12367),S=r(18538),v=r(53507);class y{create(){return new F}constructor(){this.factoryName=S.PluginFactoryName.AutocompleteNamedObjectsPlugin}}t.AutocompleteNamedObjectsPluginFactory=y;class F{*run(e){const t=yield{kind:i.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(t.kind!==i.ComputationRequestKind.ParseActiveCell||!(0,s.isSuccess)(t.result))return null;if(t.result.value.kind!==l.EditKind.Formula)return null;const{formula:r}=t.result.value,n=yield{kind:i.ComputationRequestKind.GetDefinedNamesInfo};if(n.kind!==i.ComputationRequestKind.GetDefinedNamesInfo)return this.logFailure("failed to get named objects info"),null;const o=n.definedNamesInfo,a=new d.AutocompleteBaseVisitor(r,e.caretPosition,e.content,this.autoCompleteForCellRefEnabled);(0,m.reduceBottomUp)(a,r);const{autocompleteString:u,stringStartPosition:c,stringEndPosition:f,isInsideArrayNode:S}=a;if(!(0,p.isDefined)(u)||!(0,p.isDefined)(f)||!(0,p.isDefined)(c)||S)return null;const{prefixedSuggestions:v,notPrefixedSuggestions:y}=(0,g.filterSuggestionsAccordingToPrefix)(u,o,(e=>e.name));if(this.newNamedObjectsEnabled){const t=[...v.map((e=>Object.assign(Object.assign({},e),{isPrefixed:!0}))),...y.map((e=>Object.assign(Object.assign({},e),{isPrefixed:!1})))];for(const e of t){if((0,p.isNone)(e.reference)||e.type!==h.DefinedNameInfoType.Other)continue;const t=yield{kind:i.ComputationRequestKind.ParseActiveCell,formulaText:e.reference};if(t.kind!==i.ComputationRequestKind.ParseActiveCell||!(0,s.isSuccess)(t.result)||t.result.value.kind!==l.EditKind.Formula)return null;const{formula:r}=t.result.value;r.isWellFormed&&"Lambda"===r.node.kind&&r.node.isClosed&&(e.type=h.DefinedNameInfoType.Lambda)}const r=(0,g.getCompletedFunctionSuffix)(e.content,f);return{items:this.namesToCompletionItems(t,c,f,r)}}return{items:[...this.namesToCompletionItemsOld(v,c,f,!0),...this.namesToCompletionItemsOld(y,c,f,!1)]}}namesToCompletionItemsOld(e,t,r,n){return e.filter((e=>e.type!==h.DefinedNameInfoType.Invalid)).map((e=>({label:e.name,kind:e.type===h.DefinedNameInfoType.NamedRange?c.CompletionItemKind.NamedRange:c.CompletionItemKind.Table,type:c.SuggestionKind.Simple,textEdit:{newText:e.name,range:{start:{line:0,character:t},end:{line:0,character:r}}},detail:e.tooltip,isPrefixed:n})))}namesToCompletionItems(e,t,r,n){return e.filter((e=>e.type!==h.DefinedNameInfoType.Invalid)).map((e=>{const i=function(e){switch(e.type){case h.DefinedNameInfoType.NamedRange:return c.CompletionItemKind.NamedRange;case h.DefinedNameInfoType.Table:return c.CompletionItemKind.Table;case h.DefinedNameInfoType.Lambda:return c.CompletionItemKind.Lambda;default:return c.CompletionItemKind.NamedOther}}(e);let o=e.name;return i===c.CompletionItemKind.Lambda&&(o+=n),{label:e.name,kind:i,type:c.SuggestionKind.Simple,textEdit:{newText:o,range:{start:{line:0,character:t},end:{line:0,character:r}}},detail:e.tooltip,isPrefixed:e.isPrefixed}}))}logFailure(e){a.ulsLogger.ULS.traceTag(528562134,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,`AutocompleteNamedObjectPlugin encountered a failure with msg ${e}`)}constructor(){this.autoCompleteForCellRefEnabled=(0,f.isChangeGateEnabled)("OfficeVSO:6212698_fixFunctionAutoCompleteForCellRef"),this.newNamedObjectsEnabled=(0,f.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAuthoringWithNameManager",!1)&&(0,f.getBooleanFeatureGate)("Microsoft.Office.Excel.XLONameManager",!1)}}(0,o.registerPluginFactory)(new y),t.autocompleteNamedObjectsPluginDependenciesResolved=(0,v.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield u.autoCompletePluginsThread.getValue();yield e.createAndAttachPlugin(S.PluginFactoryName.AutocompleteNamedObjectsPlugin),yield u.schedulerWithRecalcServiceAttached.getValue()}))),"autocompleteNamedObjectsPluginDependenciesResolved")},34059:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteRichValuePluginDependenciesResolved=t.AutocompleteRichValuePluginFactory=void 0;const n=r(19181),i=r(50111),o=r(78469),a=r(60111),s=r(18538),l=r(10828),u=r(33436),c=r(94591),d=r(39986),m=r(50338),g=r(12450),p=r(57264),h=r(28118),f=r(48071),S=r(71948),v=r(18538),y=r(25005),F=r(12367),C=r(53507);class R{create(){return new b}constructor(){this.factoryName=v.PluginFactoryName.AutocompleteRichValuePlugin}}t.AutocompleteRichValuePluginFactory=R;class b{*run(e){var t,r,n;if((0,g.isNone)(e.content)||(0,g.isNone)(e.caretPosition))return E("missing request arguments"),null;const o=yield{kind:i.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(o.kind!==i.ComputationRequestKind.ParseActiveCell||!(0,u.isSuccess)(o.result))return null;if(o.result.value.kind!==c.EditKind.Formula)return null;const{formula:a}=o.result.value,p=yield{kind:i.ComputationRequestKind.GetDefinedNamesInfo};if(p.kind!==i.ComputationRequestKind.GetDefinedNamesInfo)return E("failed to get named objects info"),null;const h=yield{kind:i.ComputationRequestKind.GetActiveCell};if(h.kind!==i.ComputationRequestKind.GetActiveCell)return E("failed to get active cell"),null;const v=h.activeCell,y=new l.AutocompleteRichValueVisitor(a,e.caretPosition,e.content,p.definedNamesInfo,v.range);if((0,d.reduceBottomUp)(y,a),y.isInsideArrayNode)return null;let F,C;if((0,g.isDefined)(y.cellRef))F=y.cellRef,C=v.sheet.index;else if((0,g.isDefined)(y.namedRangeNode)){const e={originGridCell:(0,u.success)(v.range),originSheet:(0,u.success)(v.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0},t=yield{kind:i.ComputationRequestKind.ResolveReferences,nodes:[y.namedRangeNode],locals:e};if(t.kind===i.ComputationRequestKind.ResolveReferences){const e=t.resolverResults[0];if(e.kind===S.ResolvedKind.ResolvedStructRef&&(0,u.isSuccess)(e.resolution)&&void 0!==e.resolution.value){const t=e.resolution.value.range;F={firstRow:t.row,firstColumn:t.col,lastRow:t.row+t.rows-1,lastColumn:t.col+t.cols-1},C=e.resolution.value.sheet.index}}}if(!(0,g.isDefined)(F))return null;const R=y.dotNotationPath;if((0,g.isNone)(R))return E("failed to parse cellRef"),null;let b="";if((0,g.isDefined)(y.sheetName))b=y.sheetName;else{const e=yield{kind:i.ComputationRequestKind.GetSheetNames};if(e.kind!==i.ComputationRequestKind.GetSheetNames)return E("failed to get sheet names"),null;if(!(0,m.isDocumentLocEqual)(v.sheet.document,e.document))return E("sheet names document is different than that of active cell"),null;if(!(0,g.isDefined)(C))return E("sheet index is undefined"),null;b=e.sheets[e.idToIndex[C]].sheetName}const T=Object.assign(Object.assign({},F),{sheetName:b,namedObjectName:""}),k=yield{kind:i.ComputationRequestKind.GetRichValueFieldListContext,rangeToQuery:T,dotNotationPath:R,singleColumn:!1,findRange:!1};if(k.kind!==i.ComputationRequestKind.GetRichValueFieldListContext)return E("failed to get field list context data"),null;if((0,g.isNone)(k.result)||0===k.result.length)return null;k.result.length>1&&E("fieldListContextRequest results length greater than 1");const{prefixedSuggestions:P,notPrefixedSuggestions:N}=(0,f.filterSuggestionsAccordingToPrefix)(y.richValueItemPrefix,k.result[0].FieldInfoDataList,(e=>e.Name),!0),A=yield{kind:i.ComputationRequestKind.GetConfig};let I=[...this.resultsToCompletionItems(P,!0,y.dotNotationIndex,null!==(t=y.fieldRefChainEndIndex)&&void 0!==t?t:e.caretPosition,A,!!y.namedRangeNode),...this.resultsToCompletionItems(N,!1,y.dotNotationIndex,null!==(r=y.fieldRefChainEndIndex)&&void 0!==r?r:e.caretPosition,A,!!y.namedRangeNode)];var O,_;return y.shouldAddEmptySuggestion&&(I=[(O=y.dotNotationIndex,_=null!==(n=y.fieldRefChainEndIndex)&&void 0!==n?n:e.caretPosition,{label:"",kind:s.CompletionItemKind.RichEntityEmptyCellRef,detail:"",textEdit:{newText:"",range:{start:{line:0,character:O},end:{line:0,character:_}}},isPrefixed:!0}),...I]),{items:I}}static getTextToCommit(e,t,r,n){let o=e.Name;if(o=o.replace("'","''"),o=o.replace("[","'["),o=o.replace("]","']"),e.RefersToDotFunction)return`.${o}`;if(r){if(n)return`.[${o}]`;const e=t.kind===i.ComputationRequestKind.GetConfig?t.config.localeInfo:void 0;return e&&!(0,y.isUnbracketedField)(e,o)?`.[${o}]`:`.${o}`}return`.[${o}]`}resultsToCompletionItems(e,t,r,n,i,o){return e.map((e=>({label:e.Name,kind:s.CompletionItemKind.RichEntity,detail:"",textEdit:{newText:b.getTextToCommit(e,i,this.dontAlwaysAddBracketsEnabled,o),range:{start:{line:0,character:r},end:{line:0,character:n}}},isPrefixed:t})))}constructor(){this.dontAlwaysAddBracketsEnabled=(0,F.isChangeGateEnabled)("OfficeVSO:7765276_RichValueAutoCompleteDontAlwayAddBrackets")}}function E(e){p.ulsLogger.ULS.traceTag(529056660,h.LogCategory.msoulscat_ES_EWAJS,h.TraceLevel.Warning,`AutocompleteRichValuePlugin encountered a failure with msg ${e}`)}(0,o.registerPluginFactory)(new R),t.autocompleteRichValuePluginDependenciesResolved=(0,C.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield a.dynamicPluginLoaderCreated.getValue();yield e.createAndAttachPlugin(v.PluginFactoryName.AutocompleteRichValuePlugin),yield a.schedulerWithRecalcServiceAttached.getValue()}))),"autocompleteRichValuePluginDependenciesResolved")},10828:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteRichValueVisitor=void 0;const n=r(12450),i=r(55340),o=r(71510),a=r(18538),s=r(12367),l=r(42549),u=r(65290),c=r(31873);class d extends c.CaretInsideArrayNodeIdentityVisitor{nameNode(e,t,r){var i,a;const s=null===(i=this.parsedFormulaTree.spans[r])||void 0===i?void 0:i.end;if(s===this.caretPosition&&e.kind===o.NamePartKind.IdentNamePart&&this.trySetDefinedName(e)&&(this.dotNotationIndex=s,this.childFieldRefLabel=r),e.kind===o.NamePartKind.FieldRefNamePart){const r=null===(a=this.parsedFormulaTree.spans[e.lhs.label])||void 0===a?void 0:a.end;if((0,n.isDefined)(r)&&(this.caretPosition===s||this.isCaretAfterDotBeforeStartOfFieldRef(r,e.rhs)&&e.lhs.kind!==o.NamePartKind.FieldRefNamePart)){let n=!1;e.lhs.kind===o.NamePartKind.CellRefNamePart?(this.setCellRef(e.lhs.ref,t),n=!0):e.lhs.kind===o.NamePartKind.IdentNamePart&&this.trySetDefinedName(e.lhs)&&(n=!0),n&&(this.dotNotationIndex=r,e.rhs.field.kind===o.NodeKind.Ident&&(this.caretPosition===s?this.richValueItemPrefix=e.rhs.field.whole:this.fieldRefChainEndIndex=s))}}return super.nameNode(e,t,r)}cellRefNode(e,t,r){var n;const i=null===(n=this.parsedFormulaTree.spans[r])||void 0===n?void 0:n.end;return void 0!==i&&this.caretPosition===i&&(this.setCellRef(e,t),this.dotNotationIndex=i,this.childFieldRefLabel=r,this.shouldAddEmptySuggestion=!0),super.cellRefNode(e,t,r)}fieldRefNode(e,t,r){var n,i;const o=null===(n=this.parsedFormulaTree.spans[r])||void 0===n?void 0:n.end,a=null===(i=this.parsedFormulaTree.spans[e.label])||void 0===i?void 0:i.end;return void 0===o||void 0===a||(this.isCaretAtEndOfFieldRefNode(o,t)?(this.initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath(e,r),this.dotNotationIndex=a,this.richValueItemPrefix=m(t)):this.isCaretAfterDotBeforeStartOfFieldRef(a,t)?(this.initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath(e,r),this.dotNotationIndex=a,this.fieldRefChainEndIndex=o):e.label===this.childFieldRefLabel&&(this.fieldRefChainEndIndex=o,this.childFieldRefLabel=r)),super.fieldRefNode(e,t,r)}structRefNode(e,t,r){var i;const s=super.structRefNode(e,t,r),l=null===(i=this.parsedFormulaTree.spans[r])||void 0===i?void 0:i.end;return this.caretPosition===l&&(0,n.isDefined)(e)&&t.isClosed&&s.kind===o.NodeKind.StructRef&&this.definedNames.some((t=>t.type===a.DefinedNameInfoType.Table&&(0,n.isDefined)(t.name)&&t.name.toLowerCase()===e.whole.toLowerCase()))&&(this.setNamedNodeRef(s),this.dotNotationIndex=l),s}initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath(e,t){let r=e;for(;r.kind===o.NodeKind.FieldRef;)this.dotNotationPath="["+m(r.rhs)+"]."+this.dotNotationPath,r=r.lhs;r.kind===o.NodeKind.CellRef&&this.setCellRef(r.ref,r.qualifier),r.kind===o.NodeKind.StructRef&&this.setNamedNodeRef(r),r.kind===o.NodeKind.Name&&this.trySetDefinedName(r.parts),this.childFieldRefLabel=t}getRefString(e){var t,r;const i=null===(t=this.parsedFormulaTree.spans[e])||void 0===t?void 0:t.start,o=null===(r=this.parsedFormulaTree.spans[e])||void 0===r?void 0:r.end;return(0,n.isDefined)(i)&&(0,n.isDefined)(o)&&i>=0&&o<this.formulaText.length?this.formulaText.substring(i,o):""}setCellRef(e,t){e.kind!==o.CellRefKind.Single&&e.kind!==o.CellRefKind.Range||(this.cellRef=(0,u.getRangeFromCellRef)(e,this.activeCell,this.passLogFunctionToGetRangeFromCellRef?g:void 0)),(0,n.isDefined)(t)&&(this.sheetName=(0,u.getSheetNameFromQualifier)(t,g)),this.trySetDotNotationPathOrigin((()=>this.getRefString(e.label)))}setNamedNodeRef(e){this.namedRangeNode=e,this.trySetDotNotationPathOrigin((()=>this.getRefString(e.label)))}isCaretAfterDotBeforeStartOfFieldRef(e,t){var r;if(!(0,n.isDefined)(t))return!1;const i=null===(r=this.parsedFormulaTree.spans[t.field.label])||void 0===r?void 0:r.start;return void 0!==i&&this.caretPosition>e&&(this.caretPosition<i||!t.isBracketed&&this.caretPosition===i)}isCaretAtEndOfFieldRefNode(e,t){var r;if(this.caretPosition===e)return!0;const i=null===(r=this.parsedFormulaTree.spans[t.field.label])||void 0===r?void 0:r.end;return!(!(0,n.isDefined)(i)||this.caretPosition!==i)}trySetDefinedName(e){if(e.canDenoteNamedObject){const t=this.definedNames.find((t=>{var r;return(null===(r=t.name)||void 0===r?void 0:r.toLowerCase())===e.asWhole.toLowerCase()}));if((0,n.isDefined)(t))return this.setDefinedName(t),!0}return!1}setDefinedName(e){var t;const r=e.namedRange;if(!(0,n.isDefined)(r))return;const i=null!==(t=e.sheetName)&&void 0!==t?t:r.sheetName;(0,n.isDefined)(i)&&(this.sheetName=i),this.cellRef={firstRow:r.top-1,firstColumn:r.left-1,lastRow:r.bottom-1,lastColumn:r.right-1},this.trySetDotNotationPathOrigin((()=>e.name))}trySetDotNotationPathOrigin(e){if(this.onlySendNestedDotNotationPathEnabled){if(this.dotNotationPath.length>0){const t=e();(0,n.isDefined)(t)?this.dotNotationPath=t+"."+this.dotNotationPath:g("tryUpdateDotNotationPath with undefined name")}}else this.dotNotationPath=e()+(this.dotNotationPath.length>0?"."+this.dotNotationPath:"")}constructor(e,t,r,n,i){super(e,t),this.formulaText=r,this.definedNames=n,this.activeCell=i,this.dotNotationPath="",this.richValueItemPrefix="",this.dotNotationIndex=0,this.shouldAddEmptySuggestion=!1,this.onlySendNestedDotNotationPathEnabled=(0,l.isTypedChangeGateEnabled)("OfficeVSO:6476056_OnlySendNestedDotNotationPath"),this.passLogFunctionToGetRangeFromCellRef=(0,s.isChangeGateEnabled)("OfficeVSO:7251290_PassLogFunctionToGetRangeFromCellRef")}}function m(e){return e.field.kind!==o.NodeKind.Ident?"":e.field.whole}function g(e){i.ulsLogger.ULS.traceTag(523257827,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`AutocompleteRichValueVisitor failed with msg: ${e}`)}t.AutocompleteRichValueVisitor=d},45642:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteTableHeadersPluginDependenciesResolved=t.AutocompleteTableHeadersPluginFactory=void 0;const n=r(19181),i=r(50111),o=r(78469),a=r(55340),s=r(33436),l=r(94591),u=r(81476),c=r(60111),d=r(18538),m=r(39986),g=r(12450),p=r(18538),h=r(78587),f=r(48071),S=r(71510),v=r(18538),y=r(42549),F=r(12367),C=r(72658),R=r(53507);class b{create(){return new E}constructor(){this.factoryName=v.PluginFactoryName.AutocompleteTableHeadersPlugin}}t.AutocompleteTableHeadersPluginFactory=b;class E{*run(e){var t;const{content:r,caretPosition:n}=e;if((0,g.isNone)(r)||(0,g.isNone)(n))return null;const o=yield{kind:i.ComputationRequestKind.ParseActiveCell,formulaText:r};if(o.kind!==i.ComputationRequestKind.ParseActiveCell||!(0,s.isSuccess)(o.result))return null;if(o.result.value.kind!==l.EditKind.Formula)return null;const{formula:u}=o.result.value,c=yield{kind:i.ComputationRequestKind.GetDefinedNamesInfo};if(c.kind!==i.ComputationRequestKind.GetDefinedNamesInfo)return this.logFailure("failed to get named objects info"),null;const d=c.definedNamesInfo.filter((e=>e.type===p.DefinedNameInfoType.Table)).map((e=>e.name)).filter(g.isDefined);if(0===d.length)return null;let f;f=this.fixAutocompleteTableHeadersBugEnabled?new h.AutocompleteTableHeadersVisitor(u,n,d):new C.AutocompleteTableHeadersVisitorOld(u,n,d),(0,m.reduceBottomUp)(f,u);let{tableName:S}=f;const{containingNode:v,isInsideArrayNode:y,isNodeClosed:F}=f;if((0,g.isNone)(v)||y)return null;if((0,g.isNone)(S)){const e=yield{kind:i.ComputationRequestKind.GetActiveCell};if(e.kind!==i.ComputationRequestKind.GetActiveCell)return this.logFailure("Couldn't get active cell"),null;const r=yield{kind:i.ComputationRequestKind.GetContainingTable,cell:e.activeCell};if(r.kind!==i.ComputationRequestKind.GetContainingTable||!(0,s.isSuccess)(r.result))return this.logFailure(`GetContainingTable request failed. result kind = ${JSON.stringify(r)}`),null;if(S=null===(t=r.result.value)||void 0===t?void 0:t.name,(0,g.isNone)(S))return null}let{start:R,end:b}=v;const E=r.charAt(b-1);if("]"!==E&&")"!==E||b--,"["===r.charAt(R)&&R++,!(n===b||this.fixAutocompleteTableHeadersBugEnabled&&this.caretIsInTheBeginning(r,R,n)))return null;const T=yield{kind:i.ComputationRequestKind.GetAvailableTableHeaders,tableName:S};let k;if(T.kind!==i.ComputationRequestKind.GetAvailableTableHeaders||!(0,s.isSuccess)(T.result)||(0,g.isNone)(T.result.value)||this.getTableHeadersFromServerEnabled&&T.result.value.isPartial){if(this.getTableHeadersFromServerEnabled){a.ulsLogger.ULS.traceTag(509682331,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"AutocompleteTableHeadersPlugin getting col headers from server");const e=yield{kind:i.ComputationRequestKind.GetFullTableHeadersFromServer,tableName:S};if(e.kind!==i.ComputationRequestKind.GetFullTableHeadersFromServer||!(0,g.isDefined)(e.result))return this.logFailure("Failed to get header names from server"),null;k=e.result}}else k=T.result.value.cols;if(!(0,g.isDefined)(k)||0===k.length)return null;let P="";this.fixAutocompleteTableHeadersBugEnabled&&this.caretIsInTheBeginning(r,R,n)?b=F?b:R:P=r.substring(R,b);const N=yield{kind:i.ComputationRequestKind.GetConfig};return N.kind!==i.ComputationRequestKind.GetConfig?(this.logFailure("getConfig request failed"),null):{items:this.getCompletionItems(k,P,R,b,f.isWithinThisRowOp,N.config.localeInfo.specialRefNames)}}caretIsInTheBeginning(e,t,r){return 0===e.substring(t,r).trim().length}generateCompletionItems(e,t,r,n,i,o){const a=[];return e.forEach((e=>{const s="string"==typeof e,l=s?e:e.name,u=s?void 0:e.description;a.push({label:l,kind:i,type:d.SuggestionKind.Simple,textEdit:{newText:(0,g.isDefined)(o)?o(l):l,range:{start:{line:0,character:t},end:{line:0,character:r}}},detail:u,isPrefixed:n})})),a}generateHeadersCompletionItems(e,t,r,n,i=!1){const{prefixedSuggestions:o,notPrefixedSuggestions:a}=(0,f.filterSuggestionsAccordingToPrefix)(e,t),s=this.getHeaderTextEditCallback(i);return[...this.generateCompletionItems(o,r,n,!0,d.CompletionItemKind.TableHeader,s),...this.generateCompletionItems(a,r,n,!1,d.CompletionItemKind.TableHeader,s)]}generateSpecialCaseCompletionItems(e,t,r,n){const i=[S.SpecialRefId.All,S.SpecialRefId.Data,S.SpecialRefId.Headers,S.SpecialRefId.Totals].map((e=>{var t;return{name:null!==(t=n[e])&&void 0!==t?t:"",description:T.getValue()[e]}})),{prefixedSuggestions:o,notPrefixedSuggestions:a}=(0,f.filterSuggestionsAccordingToPrefix)(r,i,(e=>e.name));return[...this.generateCompletionItems(o,e,t,!0,d.CompletionItemKind.TableSpecialStructRef),...this.generateCompletionItems(a,e,t,!1,d.CompletionItemKind.TableSpecialStructRef)]}generateThisRowOpCompletionItem(e,t,r){return{label:`@ - ${r}`,kind:d.CompletionItemKind.TableSpecialStructRef,type:d.SuggestionKind.Simple,textEdit:{newText:"@",range:{start:{line:0,character:e},end:{line:0,character:t}}},detail:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThisRowOpDescription),shouldRequestAutocompleteOnCommit:!0}}logFailure(e){a.ulsLogger.ULS.traceTag(526508764,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,`AutocompleteTableHeadersPlugin encountered a failure with msg ${e}`)}constructor(){this.getTableHeadersFromServerEnabled=(0,y.isTypedChangeGateEnabled)("OfficeVSO:7396249_getTableHeadersFromServer"),this.fixAutocompleteTableHeadersBugEnabled=(0,F.isChangeGateEnabled)("OfficeVSO:7899833_fixAutocompleteTableHeadersBug"),this.getCompletionItems=(e,t,r,n,i,o)=>{var a;const s="@"===t.charAt(0);if(s||i){const i=s?r+1:r,o=s?t.substring(1):t;return this.generateHeadersCompletionItems(o,e,i,n,!0)}const l=[];if(""===t){const e=null===(a=o[S.SpecialRefId.ThisRow])||void 0===a?void 0:a.substring(1);this.fixAutocompleteTableHeadersBugEnabled?l.push(this.generateThisRowOpCompletionItem(r,r,e)):l.push(this.generateThisRowOpCompletionItem(r,n,e))}return l.push(...this.generateSpecialCaseCompletionItems(r,n,t,o)),l.push(...this.generateHeadersCompletionItems(t,e,r,n)),l},this.getHeaderTextEditCallback=e=>t=>{const r=k(t);return e&&this.hasSpecialChars(r)?`[${r}]`:r},this.hasSpecialChars=e=>{try{return new RegExp("(?=\\P{L})(?=\\P{M})(?=\\P{N})","u").test(e)}catch(e){return this.logFailure(`hasSpecialChars method, error: ${e}.`),!0}}}}(0,o.registerPluginFactory)(new b),t.autocompleteTableHeadersPluginDependenciesResolved=(0,R.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=(0,y.isTypedChangeGateEnabled)("OfficeVSO:7396249_getTableHeadersFromServer")?yield c.dynamicPluginLoaderCreated.getValue():yield c.autoCompletePluginsThread.getValue();yield e.createAndAttachPlugin(v.PluginFactoryName.AutocompleteTableHeadersPlugin),yield c.schedulerWithRecalcServiceAttached.getValue()}))),"autocompleteTableHeadersPluginDependenciesResolved");const T=new u.ResettableLazy((()=>({[S.SpecialRefId.All]:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefAllDescription),[S.SpecialRefId.Data]:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefDataDescription),[S.SpecialRefId.Headers]:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefHeadersDescription),[S.SpecialRefId.Totals]:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefTotalsDescription),[S.SpecialRefId.ThisRow]:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThisRowOpDescription)}))),k=e=>e.replace(/\[|\]|\'|\@|\#/g,"'$&")},78587:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteTableHeadersVisitor=void 0;const n=r(12450),i=r(71510),o=r(31873);class a extends o.CaretInsideArrayNodeIdentityVisitor{structRefNode(e,t,r){if(this.isCaretInNode(t)){e&&this.tableNames.forEach((t=>{t.toLocaleLowerCase()===e.whole.toLocaleLowerCase()&&(this.tableName=t)}));const r=this.parsedFormulaTree.spans[t.label];this.isNodeClosed=this.isStructRefClosed=t.isClosed,this.containingNode=r,void 0!==t.innerRef&&this.findContainingNode(t.innerRef)}return super.structRefNode(e,t,r)}getIsNodeClosed(e){return e.isBracketed?e.isClosed:this.isStructRefClosed}isCaretInNode(e){const t=this.parsedFormulaTree.spans[e.label];return(0,n.isDefined)(t)&&this.caretPosition<=t.end&&this.caretPosition>=t.start}isCaretInBeginningOfNode(e){return(0,n.isDefined)(e)&&this.caretPosition===e.start}constructor(e,t,r){super(e,t),this.tableNames=r,this.isWithinThisRowOp=!1,this.isStructRefClosed=!1,this.isNodeClosed=!1,this.findContainingNode=e=>{const t=this.parsedFormulaTree.spans[e.label];if(this.isCaretInNode(e))switch(e.kind){case i.StructRefKind.SpecialRef:case i.StructRefKind.ColumnRef:case i.StructRefKind.BadRef:this.isTighterThanCurrent(t)&&(this.containingNode=t,this.isNodeClosed=this.getIsNodeClosed(e));break;case i.StructRefKind.ThisRowOpRef:const r=e.ref;if(this.isCaretInBeginningOfNode(t))break;this.isWithinThisRowOp=!0,(0,n.isDefined)(r)?this.findContainingNode(r):this.isTighterThanCurrent(t)&&(this.containingNode=t,this.isNodeClosed=this.isStructRefClosed);break;case i.StructRefKind.CommaOpRef:if(this.isCaretInBeginningOfNode(t))break;e.refs.map(this.findContainingNode);break;case i.StructRefKind.RangeOpRef:if(this.isCaretInBeginningOfNode(t))break;const o=e;this.findContainingNode(o.lhs),this.findContainingNode(o.rhs);break;case i.StructRefKind.MissingRef:this.containingNode=void 0}},this.isTighterThanCurrent=e=>(0,n.isDefined)(e)&&((0,n.isNone)(this.containingNode)||e.end<this.containingNode.end||e.start>this.containingNode.start)}}t.AutocompleteTableHeadersVisitor=a},72658:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteTableHeadersVisitorOld=void 0;const n=r(12450),i=r(71510),o=r(31873);class a extends o.CaretInsideArrayNodeIdentityVisitor{structRefNode(e,t,r){return this.isCaretInNode(t)&&(e&&this.tableNames.forEach((t=>{t.toLocaleLowerCase()===e.whole.toLocaleLowerCase()&&(this.tableName=t)})),void 0===t.innerRef?this.containingNode=this.parsedFormulaTree.spans[t.label]:this.findContainingNode(t.innerRef)),super.structRefNode(e,t,r)}isCaretInNode(e){const t=this.parsedFormulaTree.spans[e.label];return(0,n.isDefined)(t)&&this.caretPosition<=t.end&&this.caretPosition>=t.start}constructor(e,t,r){super(e,t),this.tableNames=r,this.isWithinThisRowOp=!1,this.isNodeClosed=!1,this.findContainingNode=e=>{const t=this.parsedFormulaTree.spans[e.label];if(this.isCaretInNode(e))switch(e.kind){case i.StructRefKind.SpecialRef:case i.StructRefKind.ColumnRef:case i.StructRefKind.BadRef:this.isTighterThanCurrent(t)&&(this.containingNode=t);break;case i.StructRefKind.ThisRowOpRef:const r=e.ref;this.isWithinThisRowOp=!0,(0,n.isDefined)(r)?this.findContainingNode(r):this.isTighterThanCurrent(t)&&(this.containingNode=t);break;case i.StructRefKind.CommaOpRef:e.refs.map(this.findContainingNode);break;case i.StructRefKind.RangeOpRef:const o=e;this.findContainingNode(o.lhs),this.findContainingNode(o.rhs);break;case i.StructRefKind.MissingRef:this.containingNode=void 0}},this.isTighterThanCurrent=e=>(0,n.isDefined)(e)&&((0,n.isNone)(this.containingNode)||e.end<this.containingNode.end||e.start>this.containingNode.start)}}t.AutocompleteTableHeadersVisitorOld=a},33058:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionShortDescriptions=void 0;const n=r(96438),i=r(81476),o=r(57264),a=r(43512),s=r(42549);t.functionShortDescriptions=new i.ResettableLazy((()=>{try{const e=new Map,t={};for(const r of Object.keys(n.WorksheetFuncId)){const i=Number(r);if(!isNaN(Number(i))){const r=FormulaAuthoringStrings[n.WorksheetFuncId[i]+"ShortDescription"];e.set(i.toString(),r),t[i.toString()]=r}}return(0,s.isTypedChangeGateEnabled)("Microsoft.Office.Excel.UseObjectInsteadOfMapForFunctionShortDescriptions")?{descriptionMap:t}:{descriptionMap:e}}catch(e){return o.ulsLogger.ULS.traceTag(538792415,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,`failed to get functionShortDescriptionsMap with exception ${e}`),{}}}))},95486:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeEventCallbacksManager=t.makeALAnnotationNotifier=t.makeEventEmitter=t.isALAnnotationEventKind=t.ALAnnotationKinds=t.ExternallyHandledEventKinds=t.ExternallyTriggeredEventKinds=t.ALAnnotationKind=t.EventKind=void 0;const n=r(19181),i=r(12450),o=r(84565);var a,s;!function(e){e.InternalTestEvent="InternalTestEvent",e.TestEvent="TestEvent",e.FBECacheUpdateEvent="FBECacheUpdateEvent",e.FBESendSignal="FBESendSignal",e.FBEOutcomeUpdate="FBEOutcomeUpdate",e.FBECacheUpdateEventDeprecated="FBECacheUpdateEventDeprecated",e.FormulaTranspilerInitEvent="FormulaTranspilerInitEvent"}(a||(t.EventKind=a={})),function(e){e.FormulaByExample="FormulaByExample"}(s||(t.ALAnnotationKind=s={})),t.ExternallyTriggeredEventKinds=[a.TestEvent,a.FBEOutcomeUpdate,a.FormulaTranspilerInitEvent],t.ExternallyHandledEventKinds=[a.TestEvent],t.ALAnnotationKinds=(0,i.strEnumArray)(s),t.isALAnnotationEventKind=e=>t.ALAnnotationKinds.findIndex((t=>e===t))>=0,(0,i.staticAssertSame)(),(0,i.staticAssertSame)(),(0,i.staticAssertSame)(),(0,i.staticAssertSame)(),(0,i.staticAssertSame)(),(0,i.staticAssertSame)(),t.makeEventEmitter=function(e){return(0,o.mapFromArrayOfDependantPairs)(t.ExternallyTriggeredEventKinds.map((t=>[t,r=>e.triggerEvent(t,r).then((()=>{}))])))},t.makeALAnnotationNotifier=function(e){const r=t=>r=>(0,i.isNone)(r)?Promise.resolve(null):Promise.resolve(e.triggerEvent(t,r));(0,i.staticAssertExtends)();const n={};for(const e of t.ALAnnotationKinds)n[e]=r(e);return n},t.makeEventCallbacksManager=function(){return n.__awaiter(this,void 0,void 0,(function*(){const e=(0,o.mapFromArrayOfDependantPairs)(t.ExternallyHandledEventKinds.map((e=>[e,[]]))),r=t=>r=>{for(const n of e[t])n(r)};return Object.assign({registerEventCallback:(t,r)=>e[t].push(r)},(0,o.mapFromArrayOfDependantPairs)(t.ExternallyHandledEventKinds.map((e=>[e,r(e)]))))}))}},90154:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ALAnnotationKind=t.EventKind=void 0;var n=r(95486);Object.defineProperty(t,"EventKind",{enumerable:!0,get:function(){return n.EventKind}}),Object.defineProperty(t,"ALAnnotationKind",{enumerable:!0,get:function(){return n.ALAnnotationKind}})},16447:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComputationKinds=t.ComputationType=void 0;const n=r(12450),i=r(50111),o=r(95486);var a;!function(e){e.UIMessage="UIMessage",e.Event="Event"}(a||(t.ComputationType=a={})),t.ComputationKinds={[a.UIMessage]:i.RequestKind,[a.Event]:Object.assign(Object.assign({},o.EventKind),o.ALAnnotationKind)},(0,n.staticAssertSame)(),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)()},66154:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getShouldRunComputationPredicate=t.computationRegistry=t.registerComputation=t.wrapRegistration=void 0;const n=r(12450),i=r(16447),o=r(84565),a=r(78469),s=r(86506);class l{push(e,t){this.registeredComputations.get(t)?s.ulsLogger.ULS.traceTag(507330770,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,`Computation '${t.computationIdentifier}' already registered`):(this.byFactoryName.get(e).push(t),this.registeredComputations.set(t,!0))}getRegistrationsByPluginIdentifier(e){return this.byFactoryName.get(e)}getRegistrationsByComputationIdentifier(e){return this.getRegistrationsByPluginIdentifier(e).find((t=>t.computationIdentifier.computationName===e.computationName))}constructor(){this.registeredComputations=new o.DefaultMap({getKey:e=>`${e.computationIdentifier.factoryName}.${e.computationIdentifier.pluginName}.${e.computationIdentifier.computationName}`,getDefault:()=>!1}),this.byFactoryName=new o.DefaultMap({getKey:e=>`${e.factoryName}.${e.pluginName}`,getDefault:()=>[]})}}const u=(0,o.mapFromArrayOfDependantPairs)((0,n.strEnumArray)(i.ComputationType).map((e=>[e,new l])));function c(e,t){return function(r,n){for(const t of d)if(!t({registration:e,input:r,pluginGroup:n}))return!1;return void 0===t||t(r,n)}}t.wrapRegistration=(e,t,r,n,i,o,a,s)=>{const l=c({type:e,kind:t,pluginGroup:n,modifiers:o},s);return{type:e,kind:t,execution:r,pluginGroup:n,computationIdentifier:i,modifiers:o,registrationMethod:(n,o)=>([s,u])=>{if(!l(s.computationInput,u))return void n.addResult({type:e,computationKind:t,computationIdentifier:i,computationGroup:s.computationGroup,correlationId:s.correlationId},{kind:"Skipped"});const c=a.bind(o);n.startComputation(e,t,r,i,c(s.computationInput),s)}}},t.registerComputation=(e,r,n,i,o,a,s,l)=>{const c=(0,t.wrapRegistration)(e,r,n,i,o,a,s,l);u[e].push(o,c)},t.computationRegistry=u,t.getShouldRunComputationPredicate=c;const d=[({registration:e,pluginGroup:t})=>void 0===t||t===e.pluginGroup,({registration:e,input:t})=>{if(e.type!==i.ComputationType.UIMessage||e.modifiers.runOnNonFormula)return!0;if((0,o.staticTypeHint)(e.kind),!(0,a.isFormulaRequest)(e.kind))return!0;const r=[e.kind,t];(0,o.staticTypeHint)(r);const n=(0,a.getFormulaContent)(r);return-1!==["=","+","-"].indexOf(n[0])}]},65248:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ExecutionType=void 0,function(e){e.Sync="Sync",e.Async="Async"}(r||(t.ExecutionType=r={}))},96532:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormulaAuthoringHelperSingleton=void 0;const n=r(12450),i=r(36641);t.FormulaAuthoringHelperSingleton=(0,n.singleton)((()=>new i.FormulaAuthoringHelper))},36641:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormulaAuthoringHelper=void 0;const n=r(12450),i=r(55340),o=r(96264),a=r(86251),s=r(41930);t.FormulaAuthoringHelper=class{getMinimalParamArray(e,t){var r;if((0,n.isNone)(t))return;const{minArgs:i,restTypes:o}=(0,s.getWorksheetFuncTypeWrapper)(t),a=o.length>0?Math.max(i,2):null!==(r=null==e?void 0:e.length)&&void 0!==r?r:0,l=[];for(let r=0;r<a;r+=1){const i=this.getFunctionParamByIndex(e,t,r);(0,n.isDefined)(i)&&l.push(i)}return l}getFunctionParamByIndex(e,t,r){if((0,n.isNone)(t))return;const i=(0,s.getWorksheetFuncTypeWrapper)(t),a=i.headTypes.length,l=t.ParamsHelp.split("!"),u=(0,o.getParamIndexToHighlight)(r,e.length,i,!1,!0);if(-1===u)return void this.logError("Trying to get param by index that is out of bounds");if(u>=e.length)return void this.logError("Trying to add param for a signature that doesn't have rest params.");const c=r<a?e[u].match(/[^\[\]]+/).toString():`${(0,o.getBaseParamName)(e[u])}${(0,o.getParamNumberSuffix)(r,a,i.restTypes.length)}`,d=l[(0,o.getParamIndexToHighlight)(r,t.ParamsHelp.split("!").length,i)];return{name:c,isOptional:r>=i.minArgs,description:d,type:"TO DO"}}getFormulaAnonymizer(e){const t=new a.ConsistentAnonymizer;return{anonymize:(r,i)=>{try{return o=r,(0,n.isDefined)(o)&&"string"==typeof o?function(e){return(0,n.isDefined)(e)&&"object"==typeof e&&"localeInfo"in e&&"mathpack"in e&&"refStyle"in e}(e)?function(e){return(0,n.isDefined)(e)&&"object"==typeof e&&"row"in e&&"col"in e&&1===e.rows&&1===e.cols}(i)?t.anonymize(r,e,i):(this.logError("getFormulaAnonymizer: Origin"),null):(this.logError("getFormulaAnonymizer: Config"),null):(this.logError("getFormulaAnonymizer: Formula"),null)}catch(e){return this.logError(`getFormulaAnonymizer: ${e}`),null}var o}}}logError(e){i.ulsLogger.ULS.traceTag(512331973,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,`FormulaAuthoringHelper error: ${e}`)}constructor(){this.hasRepeatingParams=e=>(0,n.isNone)(e)?(this.logError("hasRepeatingParams: funcInfo is null or undefined"),!1):(0,s.getWorksheetFuncTypeWrapper)(e).restTypes.length>0}}},41930:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFuncTypeWrapper=void 0;const n=r(96438),i=r(96438);t.getWorksheetFuncTypeWrapper=function(e){return o(e)?a[e.FunctionIndexInServer][e.signatureIndex]:(0,i.getWorksheetFuncType)(e.FunctionIndexInServer)};const o=e=>{if(void 0===e)return!1;const{FunctionIndexInServer:t,signatureIndex:r}=e;return!(0!==r&&1!==r||t!==n.WorksheetFuncId.AGGREGATE&&t!==n.WorksheetFuncId.INDEX&&t!==n.WorksheetFuncId.LOOKUP)},a={[n.WorksheetFuncId.AGGREGATE]:[{headTypes:[1,1,48,17],restTypes:[],tailTypes:[],minArgs:3,maxArgs:4},{headTypes:[1,1],restTypes:[16],tailTypes:[],minArgs:3,maxArgs:255}],[n.WorksheetFuncId.INDEX]:[{headTypes:[48,1,1],restTypes:[],tailTypes:[],minArgs:2,maxArgs:3},{headTypes:[48,1,1,1],restTypes:[],tailTypes:[],minArgs:2,maxArgs:4}],[n.WorksheetFuncId.LOOKUP]:[{headTypes:[263,48,48],restTypes:[],tailTypes:[],minArgs:2,maxArgs:3},{headTypes:[263,48],restTypes:[],tailTypes:[],minArgs:2,maxArgs:2}]}},86251:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConsistentAnonymizer=void 0;const n=r(52578),i=r(65538),o=r(71510),a=r(73693),s=r(57264);class l{get(e,t,r){var n,o;if(e===i.TokenKind.Literal){if(void 0===r)throw new Error("Expected subkind");return null===(n=this.literalStore.get(r))||void 0===n?void 0:n.get(t)}return null===(o=this.nonLiteralStore.get(e))||void 0===o?void 0:o.get(t)}set(e,t,r,n){var o,a;if(e===i.TokenKind.Literal){if(void 0===n)throw new Error("Expected subkind");const e=null!==(o=this.literalStore.get(n))&&void 0!==o?o:new Map;e.set(t,r),this.literalStore.set(n,e)}else{const n=null!==(a=this.nonLiteralStore.get(e))&&void 0!==a?a:new Map;n.set(t,r),this.nonLiteralStore.set(e,n)}}constructor(){this.nonLiteralStore=new Map,this.literalStore=new Map}}t.ConsistentAnonymizer=class{getAnonymization(e,t,r,n){const i=this.store.get(e,r,t);if(void 0!==i)return i;const o=n(this.counter);return this.counter+=1,this.store.set(e,r,o,t),o}anonymizeIdent(e,t,r,n){const o=null!=t?t:e.start;if(void 0!==(null==r?void 0:r.localeInfo.getWorksheetFuncId(e.chars))&&function(e){return void 0!==e&&e.kind===i.TokenKind.Left&&e.value===i.DelimId.Paren}(n))return(0,i.identToken)(o,e.chars);const a=this.getAnonymization(e.kind,void 0,e.chars,(e=>`ident${e}`));return(0,i.identToken)(o,a)}anonymizeA1CellRef(e,t){if(e.refStyle!==o.RefStyle.A1)throw new Error("Expected RefStyle.A1");const r=null!=t?t:e.start,n=this.getAnonymization(e.kind,void 0,e.chars,(e=>`A${e}`));return(0,i.cellRefA1Token)(r,n,void 0,void 0)}anonymizeR1C1CellRef(e,t){if(e.refStyle!==o.RefStyle.R1C1)throw new Error("Expected RefStyle.R1C1");const r=null!=t?t:e.start,n=this.getAnonymization(e.kind,void 0,e.chars,(e=>`R${e}C${e}`));return(0,i.cellRefR1C1Token)(r,n,void 0,void 0)}anonymizeCellRef(e,t){return e.refStyle===o.RefStyle.A1?this.anonymizeA1CellRef(e,t):this.anonymizeR1C1CellRef(e,t)}anonymizeLiteral(e,t){const r=null!=t?t:e.start;let n;switch(e.oper.kind){case a.OperKind.Number:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(e=>`${e}`));break;case a.OperKind.String:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(e=>`"s${e}"`));break;case i.TokenOperKind.BadNumber:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(e=>`1e${e}000`));break;case i.TokenOperKind.BadError:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(e=>{const t=["a"],r="a".charCodeAt(0);let n=e;for(;n>0;){const i=e%10,o=String.fromCharCode(r+i);t.push(o),n=Math.floor(n/10)}return`#${t.join("")}`}));break;case a.OperKind.Boolean:case a.OperKind.Error:n=e.chars;break;default:(0,s.assertNever)("error",e.oper)}const o=e.oper,l=e.hasRight;return(0,i.literalToken)(r,n,o,l)}anonymizeToken(e,t,r,n){switch(e.kind){case i.TokenKind.Ident:return this.anonymizeIdent(e,t,r,n);case i.TokenKind.CellRef:return this.anonymizeCellRef(e,t);case i.TokenKind.Literal:return this.anonymizeLiteral(e,t);case i.TokenKind.Unexpected:return function(e,t){const r=null!=t?t:e.start;return"\t"===e.chars||";"===e.chars?(0,i.unexpectedToken)(r,e.chars):(0,i.unexpectedToken)(r,"\t")}(e,t);case i.TokenKind.SingleLineComment:return(0,i.singleLineCommentToken)(t,"redacted");case i.TokenKind.MultiLineComment:return(0,i.multiLineCommentToken)(t,"redacted",e.isClosed);case i.TokenKind.End:case i.TokenKind.Left:case i.TokenKind.Right:case i.TokenKind.Sep:case i.TokenKind.Operator:case i.TokenKind.Spaces:case i.TokenKind.SpecialRef:case i.TokenKind.Escape:return Object.assign(Object.assign({},e),{start:t});default:return(0,s.assertNever)("ConsistentAnonymizer.anonymizeToken",e)}}anonymize(e,t,r){const i=(0,n.tokenizeFormula)(t.localeInfo,t.mathpack,t.refStyle,r,e,0,{}),o=[];let a=0;for(let e=0;e<i.length;e+=1){const r=i[e],n=e+1<i.length?i[e+1]:void 0,s=this.anonymizeToken(r,a,t,n);a+=s.chars.length,o.push(s)}return o.map((e=>e.chars)).join("")}constructor(){this.store=new l,this.counter=1}}},88470:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formulaCollectionPluginDependenciesResolved=t.combineSplitCollectedFormulaLogs=t.deserializeSplitCollectedFormulaLog=t.FormulaCollectionPlugin=t.FormulaCollectionPluginFactory=void 0;const n=r(19181),i=r(50111),o=r(78469),a=r(55340),s=r(33436),l=r(94591),u=r(7793),c=r(43512),d=r(86251),m=r(30006),g=r(91889),p=r(50338),h=r(60111),f=r(18538),S=r(53507);function v(e){a.ulsLogger.ULS.traceTag(537962337,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Verbose,e)}class y{create(){return new F}constructor(){this.factoryName=f.PluginFactoryName.FormulaCollectionPlugin}}t.FormulaCollectionPluginFactory=y;class F{getEditEntry(e,t){const r={content:e,cell:t};if(void 0===this.lastEdit||!(0,p.isSheetGridCellEqual)(this.lastEdit.cell,t)||this.lastEdit.content!==e)return this.lastEdit=r,r}anonymizeSheetId(e){if(this.sheetIdAnonymization.has(e))return this.sheetIdAnonymization.get(e);const t=(0,c.getNewGuid)()[0];return this.sheetIdAnonymization.set(e,t),t}*run(e){const t=yield{kind:i.ComputationRequestKind.GetActiveCell};if(t.kind!==i.ComputationRequestKind.GetActiveCell)return v(E.GetActiveCell),null;const r=t.activeCell;if(null==e.content)return v(E.EmptyContent),null;if(!e.content.trimLeft().startsWith("="))return null;const n=this.getEditEntry(e.content,r);if(void 0===n)return null;const o=yield{kind:i.ComputationRequestKind.GetConfig};if(o.kind!==i.ComputationRequestKind.GetConfig)return v(E.GetConfig),null;const c=o.config,d=(0,m.createAnalyzeGlobals)(c),p=(0,u.lexicalSourceCell)(n.cell),h=(0,m.analyzeLocalsGrid)(p.kind,p.range),f=(0,g.createAnalyzer)(d),S=this.consistentAnonymizer.anonymize(n.content,c,r.range),y=yield{kind:i.ComputationRequestKind.ParseEdit,cell:n.cell,formulaBarText:S};if(y.kind!==i.ComputationRequestKind.ParseEdit||!(0,s.isSuccess)(y.result))return v(E.ParseEdit),null;if(y.result.value.kind!==l.EditKind.Formula)return null;const C=y.result.value.formula,T=C.isWellFormed;let k;if(!T){const e=f.checkFormulaWithDiagnostics(h,C);if((0,s.isSuccess)(e)){const t=null==e?void 0:e.value[1];void 0!==t&&(k=function(e,t){const r={},n={};return Object.keys(e).forEach((i=>{const o=Number(i),a=e[o];void 0!==a&&(r[i]=a);const s=t.spans[o];void 0!==s&&(n[i]=s)})),{spanDiagnostics:r,spans:n}}(t,C))}}const P=yield{kind:i.ComputationRequestKind.GetCorrelationId};if("GetCorrelationId"!==P.kind)return null;const N=P.correlationId;return function(e){const t=function(e){let t=JSON.stringify(e),r=0;const n=[];for(;t.length>0;){const[i,o]=b(t,r,e.i);t=o,r+=1,n.push(i)}return n}(e);for(const e of t){const t=R(e);a.ulsLogger.ULS.dnmTraceTag(537962336,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,t)}}({v:F.formulaCollectionVersion,f:S,ok:T,d:k,c:{s:this.anonymizeSheetId(n.cell.sheet.index),c:n.cell.range.col,r:n.cell.range.row},i:N}),null}constructor(){this.lastEdit=void 0,this.consistentAnonymizer=new d.ConsistentAnonymizer,this.sheetIdAnonymization=new Map}}t.FormulaCollectionPlugin=F,F.factoryName=f.PluginFactoryName.FormulaCollectionPlugin,F.formulaCollectionVersion=1;const C=2300;function R(e){return e.correlationId.toString()+","+e.logPartId.toString()+","+e.partialMessage}function b(e,t,r){const n=r.toString().length+t.toString().length+2,i=C-n;return[{correlationId:r,logPartId:t,partialMessage:e.slice(0,i)},e.slice(i)]}var E;t.deserializeSplitCollectedFormulaLog=function(e){let t=e,r=t.indexOf(",");const n=Number(t.slice(0,r));return t=t.slice(r+1),r=t.indexOf(","),{correlationId:n,logPartId:Number(t.slice(0,r)),partialMessage:t.slice(r+1)}},t.combineSplitCollectedFormulaLogs=function(e){const t=e.sort((e=>e.logPartId)).map((e=>e.partialMessage)).join("");return JSON.parse(t)},function(e){e.GetActiveCell="GetActiveCell failed",e.GetConfig="GetConfig failed",e.ParseEdit="ParseEdit failed",e.EmptyContent="empty content"}(E||(E={})),(0,o.registerPluginFactory)(new y),t.formulaCollectionPluginDependenciesResolved=(0,S.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield h.workerThreadSpread.getValue();yield e.createAndAttachPlugin(f.PluginFactoryName.FormulaCollectionPlugin),yield h.schedulerWithRecalcServiceAttached.getValue()}))),"formulaCollectionPluginDependenciesResolved")},17366:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coloredReferencesPluginDependenciesResolved=t.ColoredReferencesPluginFactory=void 0;const n=r(19181),i=r(55340),o=r(33436),a=r(39986),s=r(94591),l=r(78469),u=r(60111),c=r(50111),d=r(44727),m=r(12450),g=r(74897),p=r(50338),h=r(18538),f=r(53507);class S{create(){return new v}constructor(){this.factoryName=h.PluginFactoryName.ColoredReferencesPlugin}}t.ColoredReferencesPluginFactory=S;class v{*run(e){const t=e.content,r=yield{kind:c.ComputationRequestKind.ParseActiveCell,formulaText:t};if(r.kind!==c.ComputationRequestKind.ParseActiveCell||!(0,o.isSuccess)(r.result))return null;if(r.result.value.kind!==s.EditKind.Formula)return null;const n=yield{kind:c.ComputationRequestKind.GetActiveCell};if(n.kind!==c.ComputationRequestKind.GetActiveCell)return y("failed to get active cell"),null;let i;const l=yield{kind:c.ComputationRequestKind.GetSheetNames};let u;l.kind===c.ComputationRequestKind.GetSheetNames?i=l:y("failed to get sheet names");const f=yield{kind:c.ComputationRequestKind.GetDefinedNamesInfo};f.kind===c.ComputationRequestKind.GetDefinedNamesInfo?u=f.definedNamesInfo:y("failed to get defined names");const S=n.activeCell,{formula:v}=r.result.value,F=new d.ColoredReferencesVisitor(S,v,t,i,u);(0,a.reduceBottomUp)(F,v);let C=F.formulaHighlights;if(0!==F.structRefNodes.length){const e={originGridCell:(0,o.success)(S.range),originSheet:(0,o.success)(S.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0},t=yield{kind:c.ComputationRequestKind.ResolveReferences,nodes:F.structRefNodes,locals:e};t.kind===c.ComputationRequestKind.ResolveReferences?C=C.concat(function(e,t,r){const n=[];return r.forEach((r=>{var i;const a=e.spans[r.node.label];if(!a)return void y("failed to resolve StructRef, formulaSpan null");if(!(0,o.isSuccess)(r.resolution))return void y(`failed to resolve StructRef, reason: ${null===(i=r.resolution)||void 0===i?void 0:i.reason.kind}`);if(void 0===r.resolution.value)return void y("failed to resolve StructRef, resolution value undefined");const s=r.resolution.value,l=(0,p.sheetRangeToSheetIndex)(s.sheet);if(!(0,m.isDefined)(l)||!(0,p.isSheetIndexEqual)(l,t.sheet))return;const u=(0,g.gridRangeToRange)(s.range),c={kind:h.HighlightKind.StructRef,span:a,rangeInfo:{range:u}};n.push(c)})),n}(v,S,t.resolverResults)):y("failed to resolve node references")}return{formulaHighlights:C}}}function y(e){i.ulsLogger.ULS.traceTag(525133647,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`ColoredReferencesPlugin encountered a failure with msg ${e}`)}(0,l.registerPluginFactory)(new S),t.coloredReferencesPluginDependenciesResolved=(0,f.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield u.dynamicPluginLoaderCreated.getValue();yield e.createAndAttachSyncPlugin(h.PluginFactoryName.ColoredReferencesPlugin),yield u.schedulerWithRecalcServiceAttached.getValue()}))),"coloredReferencesPluginDependenciesResolved")},44727:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColoredReferencesVisitor=void 0;const n=r(12450),i=r(55340),o=r(96438),a=r(18538),s=r(71510),l=r(71510),u=r(39986),c=r(65290),d=r(50338),m=r(74897),g=r(42399),p=r(18538);class h extends u.IdentityVisitor{structRefNode(e,t,r){const n=super.structRefNode(e,t,r);return this.structRefNodes.push(n),n}nameNode(e,t,r){const i=super.nameNode(e,t,r);if(!this.isRefInActiveSheet(t))return i;if(i.parts.kind===s.NamePartKind.FieldRefNamePart)return this.createAndAppendFieldRefHighlight(i.parts.lhs),i;if(!(0,n.isDefined)(this.namedObjectsMap))return i;const o=this.namedObjectsMap.get(e.asWhole.toLocaleLowerCase());return void 0!==o&&o.type!==p.DefinedNameInfoType.Invalid&&this.createAndAppendNamedRefHighlight(r,o),i}cellRefNode(e,t,r){const n=super.cellRefNode(e,t,r);if(!(0,c.isValidCellRef)(e)||!this.isRefInActiveSheet(t))return n;const i=this.parsedFormulaTree.spans[r];if(i){const t=this.createRangeInfoFromCellRef(e),r=this.formulaSpanToHighlightingSpan(i,l.NodeKind.CellRef);this.formulaHighlights.push(f(a.HighlightKind.CellRef,r,t))}return n}get namedObjectsMap(){return(0,n.isDefined)(this._namedObjectsMap)||(0,n.isDefined)(this.definedNameInfoList)&&(this._namedObjectsMap=(0,c.createNameToDefinedNameInfoMapping)(this.definedNameInfoList)),this._namedObjectsMap}createAndAppendNamedRefHighlight(e,t){const r=this.parsedFormulaTree.spans[e];if(!(0,n.isDefined)(r)||!(0,n.isDefined)(this.sheetNames))return;const i=t.sheetName;if(!(0,n.isDefined)(i))return void S(`createAndAppendNamedRef - sheetName undefined, DefinedNameInfo type: ${t.type}`);const o=(0,c.getSheetIndexFromSheetName)(i,this.sheetNames);if(!(0,n.isDefined)(o))return void S(`createAndAppendNamedRef: sheetIndex undefined, DefinedNameInfo type: ${t.type}`);if(!(0,d.isSheetIndexEqual)(o,this.activeCell.sheet))return;const s=(0,g.getRangeFromDefinedName)(t);void 0!==s&&this.formulaHighlights.push(f(a.HighlightKind.NamedRange,r,{range:s}))}createAndAppendFieldRefHighlight(e){switch(e.kind){case s.NamePartKind.CellRefNamePart:this.createAndAppendCellRefPartHighlight(e);break;case s.NamePartKind.IdentNamePart:{if(!(0,n.isDefined)(this.namedObjectsMap))return;const t=this.namedObjectsMap.get(e.asWhole.toLocaleLowerCase());void 0!==t&&t.type!==p.DefinedNameInfoType.Invalid&&this.createAndAppendNamedRefHighlight(e.label,t);break}case s.NamePartKind.FieldRefNamePart:this.createAndAppendFieldRefHighlight(e.lhs)}}createAndAppendCellRefPartHighlight(e){const t=this.parsedFormulaTree.spans[e.label];if(!(0,n.isDefined)(t))return;const r=this.createRangeInfoFromCellRef(e.ref),i=this.formulaSpanToHighlightingSpan(t,l.NodeKind.CellRef),o=f(a.HighlightKind.CellRef,i,r);this.formulaHighlights.push(o)}formulaSpanToHighlightingSpan(e,t){const r=Object.assign({},e);var n,i;return t===l.NodeKind.CellRef&&(n=e,(i=this.formulaString).length>n.end&&i.charAt(n.end)===o.operatorStrings[o.OperatorId.Pound]&&(r.end+=1)),r}createRangeInfoFromCellRef(e){return{range:(0,c.getRangeFromCellRef)(e,this.activeCell.range,S),positionKindInfo:(0,m.getPositionKindInfoFromCellRef)(e)}}isRefInActiveSheet(e){var t;if(!(0,n.isDefined)(e))return!0;if(!(0,n.isDefined)(this.sheetNames))return!1;const r=(0,c.getSheetIndexFromQualifier)(e,this.sheetNames,this.failureCallback);return(0,n.isDefined)(r)?(0,d.isSheetIndexEqual)(r,this.activeCell.sheet):(null===(t=this.failureCallback)||void 0===t||t.call(this,"CellRefHighlightCreator.isRefInActiveSheet: sheetIndex is undefined"),!1)}constructor(e,t,r,n,i,o){super(),this.activeCell=e,this.parsedFormulaTree=t,this.formulaString=r,this.sheetNames=n,this.definedNameInfoList=i,this.failureCallback=o,this.structRefNodes=[],this.formulaHighlights=[],this.activeCellSheetName=void 0,this._namedObjectsMap=void 0}}function f(e,t,r){return{kind:e,span:t,rangeInfo:r}}function S(e){i.ulsLogger.ULS.traceTag(520935561,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`ColoredReferencesVisitor encountered a failure with msg ${e}`)}t.ColoredReferencesVisitor=h},48006:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parenthesesCouplingPluginDependenciesResolved=t.ParenthesesCouplingPluginFactory=void 0;const n=r(19181),i=r(12450),o=r(33436),a=r(39986),s=r(94591),l=r(78469),u=r(60111),c=r(50111),d=r(32263),m=r(18538),g=r(53507);class p{create(){return new h}constructor(){this.factoryName=m.PluginFactoryName.ParenthesesCouplingPlugin}}t.ParenthesesCouplingPluginFactory=p;class h{*run(e){if(null!=e.selectionLength&&e.selectionLength>0)return null;const t=yield{kind:c.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(t.kind!==c.ComputationRequestKind.ParseActiveCell||!(0,o.isSuccess)(t.result))return null;if(t.result.value.kind!==s.EditKind.Formula)return null;const{formula:r}=t.result.value,n=new d.ParenthesesCouplingVisitor(r,e.caretPosition);return(0,a.reduceBottomUp)(n,r),(0,i.isDefined)(n.parenthesesSpan)?this.getParenthesesHighlights(n.parenthesesSpan):{formulaHighlights:void 0}}getParenthesesHighlights(e){const t=e.start,r=e.end,n={kind:m.HighlightKind.Parentheses,span:{start:t,end:t+1}};return{formulaHighlights:[{kind:m.HighlightKind.Parentheses,span:{start:r,end:r+1}},n]}}}(0,l.registerPluginFactory)(new p),t.parenthesesCouplingPluginDependenciesResolved=(0,g.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield u.dynamicPluginLoaderCreated.getValue();yield e.createAndAttachSyncPlugin(m.PluginFactoryName.ParenthesesCouplingPlugin),yield u.schedulerWithRecalcServiceAttached.getValue()}))),"parenthesesCouplingPluginDependenciesResolved")},32263:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParenthesesCouplingVisitor=void 0;const n=r(71510),i=r(39986);class o extends i.IdentityVisitor{appNode(e,t,r,i){return e.kind!==n.NodeKind.Operator&&this.matchFormula(e,r,i),super.appNode(e,t,r,i)}parenNode(e,t,r){const n=this.formula.spans[r];return t&&n&&this.matchParentheses(n.start,n.end-1),super.parenNode(e,t,r)}letNode(e,t,r,n,i,o){return this.matchFormula(e,i,o),super.letNode(e,t,r,n,i,o)}lambdaNode(e,t,r,n,i,o){return this.matchFormula(e,i,o),super.lambdaNode(e,t,r,n,i,o)}matchFormula(e,t,r){const n=this.formula.spans[r],i=this.formula.spans[e.label];t&&n&&i&&this.matchParentheses(i.end,n.end-1)}matchParentheses(e,t){e===this.caretPosition&&(this.checkRight=!0),t===this.caretPosition-1&&(this.checkLeft=!0),this.checkRight&&this.shouldUpdateLocation(e,t,this.caretPosition+1)||this.shouldUpdateLocation(e,t,this.caretPosition)?(this.parenthesesSpan={start:e,end:t},this.areParenthesesLeftOfCaret=!1):this.checkLeft&&this.shouldUpdateLocation(e,t,this.caretPosition-1)&&(this.parenthesesSpan={start:e,end:t},this.areParenthesesLeftOfCaret=!0)}shouldUpdateLocation(e,t,r){return e<r&&r<=t&&(void 0===this.parenthesesSpan||this.areParenthesesLeftOfCaret&&e<=this.parenthesesSpan.start||e>this.parenthesesSpan.start)}constructor(e,t){super(),this.formula=e,this.caretPosition=t,this.parenthesesSpan=void 0,this.checkLeft=!1,this.checkRight=!1,this.areParenthesesLeftOfCaret=!1}}t.ParenthesesCouplingVisitor=o},74897:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPositionKindInfoFromCellRef=t.spanCompare=t.gridRangeToRange=void 0;const n=r(71510),i=r(18538),o={Abs:i.PositionKind.Absolute,Rel:i.PositionKind.Relative};t.gridRangeToRange=function(e){const t=e.row,r=e.col;return{firstRow:t,firstColumn:r,lastRow:t+e.rows-1,lastColumn:r+e.cols-1}},t.spanCompare=function(e,t){let r;return 0!=(r=e.start-t.start)||0!=(r=t.end-e.end)?r:0},t.getPositionKindInfoFromCellRef=function(e){switch(e.kind){case n.CellRefKind.Col:return function(e){return{firstRow:i.PositionKind.Relative,firstColumn:o[e.col1.kind],secondRow:i.PositionKind.Relative,secondColumn:o[e.col2.kind]}}(e);case n.CellRefKind.Row:return function(e){return{firstRow:o[e.row1.kind],firstColumn:i.PositionKind.Relative,secondRow:o[e.row2.kind],secondColumn:i.PositionKind.Relative}}(e);case n.CellRefKind.Single:return function(e){let t,r;return{firstRow:t=o[e.row.kind],firstColumn:r=o[e.col.kind],secondRow:t,secondColumn:r}}(e);case n.CellRefKind.Range:return function(e){return{firstRow:o[e.ref1.row.kind],firstColumn:o[e.ref1.col.kind],secondRow:o[e.ref2.row.kind],secondColumn:o[e.ref2.col.kind]}}(e)}}},7782:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.gotoCtrlClickPluginDependenciesResolved=void 0;const n=r(19181),i=r(55340),o=r(12450),a=r(33436),s=r(18538),l=r(60111),u=r(42399),c=r(50111),d=r(11367),m=r(39986),g=r(94591),p=r(53507),h=r(8792),f=r(78469),S=h.PluginRegistry.create(s.PluginFactoryName.GotoCtrlClickPlugin,s.PluginGroup.Excel);let v=(()=>{let e,t,r,i=[S.x10Plugin()],l=[],p=[];return t=class{*run({text:e,index:t}){const r=e;if(t<0||t>=r.length)return y("caret out of formula scope"),{kind:s.GotoCtrlClickResultKind.NoReferenceFound};const n=yield{kind:c.ComputationRequestKind.ParseActiveCell,formulaText:r};if(n.kind!==c.ComputationRequestKind.ParseActiveCell||!(0,a.isSuccess)(n.result))return y("failed to parse active cell"),{kind:s.GotoCtrlClickResultKind.Failure};if(n.result.value.kind!==g.EditKind.Formula)return y("Not a formula cell"),{kind:s.GotoCtrlClickResultKind.NotAFormula};const i=yield{kind:c.ComputationRequestKind.GetActiveCell};if(i.kind!==c.ComputationRequestKind.GetActiveCell)return y("failed to get active cell"),null;let l;const p=yield{kind:c.ComputationRequestKind.GetDefinedNamesInfo};p.kind===c.ComputationRequestKind.GetDefinedNamesInfo?l=p.definedNamesInfo:y("failed to get defined names");const h=i.activeCell,{formula:f}=n.result.value,S=new d.GotoCtrlClickVisitor(f,h.range,l,t);if((0,m.reduceBottomUp)(S,f),!S.referenceFound)return{kind:s.GotoCtrlClickResultKind.NoReferenceFound};let v=S.sheetRange;if((0,o.isDefined)(S.structRefNodeToResolve)){let e;const t=yield{kind:c.ComputationRequestKind.GetSheetNames};if(t.kind!==c.ComputationRequestKind.GetSheetNames)return y("failed to get sheet names"),{kind:s.GotoCtrlClickResultKind.RangeResolutionFailure,span:S.span};e=t;const r=yield{kind:c.ComputationRequestKind.ResolveReferences,nodes:[S.structRefNodeToResolve],locals:{originGridCell:(0,a.success)(h.range),originSheet:(0,a.success)(h.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0}};r.kind===c.ComputationRequestKind.ResolveReferences?v=(0,u.getSheetRangeFromResolvedRef)(e,r.resolverResults[0],y):y("failed to resolve node references")}return(0,o.isDefined)(v)?{kind:s.GotoCtrlClickResultKind.ReferenceFound,sheetRange:v,span:S.span}:{kind:s.GotoCtrlClickResultKind.RangeResolutionFailure,span:S.span}}constructor(){n.__runInitializers(this,p)}},n.__setFunctionName(t,"GotoCtrlClickPlugin"),(()=>{const o="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[S.uiMessageHandler({kind:c.RequestKind.gotoCtrlClick})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:o},null,p),n.__esDecorate(null,e={value:t},i,{kind:"class",name:t.name,metadata:o},null,l),t=e.value,o&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:o})})(),t.factory=S.injectPluginFactory(),n.__runInitializers(t,l),t})();function y(e){i.ulsLogger.ULS.traceTag(508687389,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`GotoCtrlClickPlugin encountered a failure with msg ${e}`)}(0,f.registerPluginFactory)(v.factory),t.gotoCtrlClickPluginDependenciesResolved=(0,p.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield l.workerThreadSpread.getValue();yield e.createAndAttachPlugin(s.PluginFactoryName.GotoCtrlClickPlugin),yield l.schedulerWithRecalcServiceAttached.getValue()}))),"gotoCtrlClickPluginDependenciesResolved")},11367:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GotoCtrlClickVisitor=void 0;const n=r(55340),i=r(12450),o=r(71510),a=r(39986),s=r(18538),l=r(65290),u=r(42399);class c extends a.IdentityVisitor{get namedObjectsMap(){return(0,i.isDefined)(this._namedObjectsMap)?this._namedObjectsMap:(0,i.isDefined)(this.definedNameInfoList)?(this._namedObjectsMap=(0,l.createNameToDefinedNameInfoMapping)(this.definedNameInfoList),this._namedObjectsMap):void d("namedObjectsMap: was called but definedNameInfoList is undefined")}structRefNode(e,t,r){const n=super.structRefNode(e,t,r);if(this.referenceFound)return n;const i=this.parsedFormulaTree.spans[r];return(0,l.caretInSpanScope)(this.caretPosition,i)&&(this.referenceFound=!0,this.span=i,this.structRefNodeToResolve=n),n}cellRefNode(e,t,r){const n=super.cellRefNode(e,t,r);if(this.referenceFound)return n;const i=this.parsedFormulaTree.spans[r];return(0,l.caretInSpanScope)(this.caretPosition,i)&&(this.referenceFound=!0,this.span=i,this.sheetRange=(0,u.sheetRangeFromCellRef)(e,t,this.activeCell,d)),n}nameNode(e,t,r){var n;const i=super.nameNode(e,t,r);if(this.referenceFound)return i;const a=this.parsedFormulaTree.spans[r];if(!(0,l.caretInSpanScope)(this.caretPosition,a))return i;if(i.parts.kind===o.NamePartKind.FieldRefNamePart)this.tryFindFieldRefGotoReference(i.parts,t);else{const r=null===(n=this.namedObjectsMap)||void 0===n?void 0:n.get(e.asWhole.toLocaleLowerCase());void 0!==r&&r.type!==s.DefinedNameInfoType.Invalid&&(this.referenceFound=!0,this.span=a,this.sheetRange=(0,u.getSheetRangeFromDefinedNameInfo)(r,t))}return i}tryFindFieldRefGotoReference(e,t){const r=(0,l.findFieldRefSourceLhs)(e);switch(r.kind){case o.NamePartKind.CellRefNamePart:{const e=this.parsedFormulaTree.spans[r.label];return void((0,l.caretInSpanScope)(this.caretPosition,e)&&(this.referenceFound=!0,this.span=e,this.sheetRange=(0,u.sheetRangeFromCellRef)(r.ref,void 0,this.activeCell,d)))}case o.NamePartKind.IdentNamePart:{const e=this.parsedFormulaTree.spans[r.label];if((0,i.isDefined)(this.namedObjectsMap)&&(0,l.caretInSpanScope)(this.caretPosition,e)){this.referenceFound=!0,this.span=e;const n=(0,l.getNamePartIfExists)(r,this.namedObjectsMap);if(!(0,i.isDefined)(n))return;this.sheetRange=(0,u.getSheetRangeFromDefinedNameInfo)(n,t)}return}default:d("tryFindFieldRefGotoReference: Was not able to parse a left-most NamePart")}}constructor(e,t,r,n){super(),this.parsedFormulaTree=e,this.activeCell=t,this.definedNameInfoList=r,this.caretPosition=n,this.structRefNodeToResolve=void 0,this.span=void 0,this.sheetRange=void 0,this.referenceFound=!1,this._namedObjectsMap=void 0}}function d(e){n.ulsLogger.ULS.traceTag(508687388,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,`GotoCtrlClickVisitor encountered a failure with msg ${e}`)}t.GotoCtrlClickVisitor=c},88124:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComputationFinalizer=void 0;const n=r(55340),i=r(35524),o=r(58821),a=r(57264),s=r(83567),l=r(50111);t.ComputationFinalizer=class{subscribe(e){if(!this.isClosed)return this.subject.subscribe(e);s.x10Logger.log({kind:"failure",payload:{failureKind:s.X10FailureKind.AssertionFailure,failureLevel:n.TraceLevel.Warning,path:"PluginFinalizer.subscribe",description:"subscription for a closed finalizer was requested"}})}finalize(e,t){const r=this.extractComputationInfo(e);t===l.ExecutionStopReason.Unknown&&s.x10Logger.log({kind:"failure",payload:{failureKind:s.X10FailureKind.AssertionFailure,failureLevel:n.TraceLevel.Warning,path:"PluginFinalizer.finalize",description:"finalize was invoked with an unknown stop reason",data:r}}),this.isClosed?s.x10Logger.log({kind:"failure",payload:{failureKind:s.X10FailureKind.AssertionFailure,failureLevel:n.TraceLevel.Warning,path:"PluginFinalizer.finalize",description:"finalizer was invoked more than once",data:Object.assign({stopReason:t},r)}}):(this.isClosed=!0,this.finalizeComputationGeneratorExecution(e,t),this.subject.next({computationInfo:r,stopReason:t}))}finalizeComputationGeneratorExecution(e,t){switch(t){case l.ExecutionStopReason.Unknown:case l.ExecutionStopReason.Frame.Timeout:case l.ExecutionStopReason.Frame.Superseded:case l.ExecutionStopReason.Frame.ConflictResolverEarlyTermination:let r=!1;try{e.generator.throw(new o.X10ExceptionComputationTermination(t))}catch(i){r=!0,i instanceof o.X10ExceptionComputationTermination&&i.stopReason&&(null==i?void 0:i.stopReason)!==t&&n.ulsLogger.ULS.traceTag(508903693,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,s.x10Logger.formatLogMessage("finalizeComputationGeneratorExecution",{description:"computation threw an exception during execution",data:e.info}))}finally{r||s.x10Logger.log({kind:"failure",payload:{failureKind:s.X10FailureKind.AssertionFailure,failureLevel:n.TraceLevel.Warning,path:"ComputationFinalizer.finalizeComputationGeneratorExecution",description:"computation terminated by x10 with exception but did not threw the exception back",data:e.info}})}break;case l.ExecutionStopReason.Computation.Done:case l.ExecutionStopReason.Computation.Skipped:case l.ExecutionStopReason.Computation.Exception:break;default:(0,a.assertNever)("Unknown stopReason",t)}}extractComputationInfo(e){var t,r;const n=e.info;n.totalRuntime=e.info.computationTime;for(const i in e.info.requestTimes)n.totalRuntime+=null!==(r=null===(t=e.info.requestTimes[i])||void 0===t?void 0:t.requestDuration)&&void 0!==r?r:0;return n}constructor(...e){this.subject=new i.Subject,this.isClosed=!1;for(const t of e)this.subscribe(t)}}},42399:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uniteIntersectingRangeObjects=t.uniteIntersectingGridRanges=t.gridRangesIntersects=t.rangesIntersects=t.getSheetGridCellFromRangeObject=t.rangeToGridRange=t.toSharedSheetRange=t.getSheetRangeFromResolvedRef=t.sheetRangeFromCellRef=t.getSheetRangeFromDefinedNameInfo=t.getRangeFromDefinedName=void 0;const n=r(12450),i=r(65290),o=r(33436),a=r(18538),s=r(74897),l=r(7793);function u(e){const t=e.namedRange;if(null==t||e.type===a.DefinedNameInfoType.Invalid)return;const r=e.type===a.DefinedNameInfoType.Table?1:0;return t.bottom&&t.top&&t.right&&t.left?{firstRow:t.top+r-1,firstColumn:t.left-1,lastRow:t.bottom-1,lastColumn:t.right-1}:void 0}function c(e,t){return(0,n.fastMin)(e.lastColumn,t.lastColumn)>=(0,n.fastMax)(e.firstColumn,t.firstColumn)&&(0,n.fastMin)(e.lastRow,t.lastRow)>=(0,n.fastMax)(e.firstRow,t.firstRow)}function d(e,t){return(0,n.fastMin)(e.col+e.cols-1,t.col+t.cols-1)>=(0,n.fastMax)(e.col,t.col)&&(0,n.fastMin)(e.row+e.rows-1,t.row+t.rows-1)>=(0,n.fastMax)(e.row,t.row)}t.getRangeFromDefinedName=u,t.getSheetRangeFromDefinedNameInfo=function(e,t){const r=u(e);if(!(0,n.isDefined)(r))return;const o=(0,n.isDefined)(e.sheetName)?e.sheetName:t?(0,i.getSheetNameFromQualifier)(t):"";return Object.assign(Object.assign({},r),{sheetName:o,namedObjectName:(0,n.isDefined)(e.name)?e.name:""})},t.sheetRangeFromCellRef=function(e,t,r,o){const a=(0,i.getRangeFromCellRef)(e,r,o);if((0,n.isDefined)(a))return Object.assign(Object.assign({},a),{sheetName:t?(0,i.getSheetNameFromQualifier)(t):"",namedObjectName:""})},t.getSheetRangeFromResolvedRef=function(e,t,r){var n;if(!(0,o.isSuccess)(t.resolution))return void(null==r||r(`failed to resolve StructRef, reason: ${t.resolution.reason}`));if(void 0===t.resolution.value)return void(null==r||r("failed to resolve StructRef, resolution value undefined"));const a=t.resolution.value,l=null!==(n=(0,i.sheetIndexToSheetName)(a.sheet,e))&&void 0!==n?n:"";return Object.assign(Object.assign({},(0,s.gridRangeToRange)(a.range)),{sheetName:l,namedObjectName:t.node.lhs?t.node.lhs.whole:""})},t.toSharedSheetRange=function(e){return{FirstColumn:e.firstColumn,FirstRow:e.firstRow,LastColumn:e.lastColumn,LastRow:e.lastRow,NamedObjectName:e.namedObjectName,SheetName:e.sheetName}},t.rangeToGridRange=function(e){const t=e.firstRow,r=e.firstColumn;return(0,l.gridRange)(t,r,e.lastRow-t+1,e.lastColumn-r+1)},t.getSheetGridCellFromRangeObject=function(e,t){return(0,l.sheetGridCell)(t,{row:e.firstRow,col:e.firstColumn,rows:1,cols:1})},t.rangesIntersects=c,t.gridRangesIntersects=d,t.uniteIntersectingGridRanges=function(e,t){return d(e,t)?(0,l.gridRange)((0,n.fastMin)(e.row,t.row),(0,n.fastMin)(e.col,t.col),(0,n.fastMax)(e.row+e.rows,t.row+t.rows)-(0,n.fastMin)(e.row,t.row),(0,n.fastMax)(e.col+e.cols,t.col+t.cols)-(0,n.fastMin)(e.col,t.col)):null},t.uniteIntersectingRangeObjects=function(e,t){return c(e,t)?{firstRow:(0,n.fastMin)(e.firstRow,t.firstRow),firstColumn:(0,n.fastMin)(e.firstColumn,t.firstColumn),lastRow:(0,n.fastMax)(e.lastRow,t.lastRow),lastColumn:(0,n.fastMax)(e.lastColumn,t.lastColumn)}:null}},35524:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.X10TaskInternal=t.Ref=t.InitializingSubject=t.Subject=void 0;const n=r(43512),i=r(83567);class o{next(e){for(const[t,r]of this.subscribers)r(e)}subscribe(e){return this.subscribers.push([++this.currentSubscription,e]),this.currentSubscription}unsubscribe(e){this.subscribers=this.subscribers.filter((([t,r])=>t!==e))}constructor(){this.subscribers=[],this.currentSubscription=0}}t.Subject=o,t.InitializingSubject=class extends o{subscribe(e){const t=super.subscribe(e);return this.initializeSubscriber().map(e),t}constructor(e){super(),this.initializeSubscriber=e}},t.Ref=class{constructor(e){this.value=e}},t.X10TaskInternal=class{static createToken(){return"Do not use outside of x10 scheduler. Resovle by yielding with an 'AwaitTask' / 'AwaitAll' request"}resolve(e){return e!==this.token&&i.x10Logger.log({kind:"failure",payload:{failureKind:i.X10FailureKind.AssertionFailure,failureLevel:n.TraceLevel.Warning,path:"X10TaskInternal.resolve",description:"Task is resolving with an invalid token"}}),this.maybeThenable}constructor(e,t){this.maybeThenable=e,this.token=t}}},65290:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findFieldRefSourceLhs=t.caretInSpanScope=t.sheetIndexToSheetName=t.getAbsolutePosition=t.getNamePartIfExists=t.createNameToDefinedNameInfoMapping=t.getRangeFromCellRef=t.getSheetNameFromQualifier=t.getSheetIndexFromQualifier=t.getSheetIndexFromSheetName=t.isValidCellRef=void 0;const n=r(71510),i=r(71510),o=r(71510),a=r(71510),s=r(12450),l=r(12367),u=r(18538),c=r(50338);class d{}function m(e,t){const r=t.nameToIndex.getValue(e);if((0,s.isDefined)(r))return t.sheets[r].sheetIndex}function g(e,t){return e.kind===i.QualifierKind.Sheet?e.sheet:e.kind===i.QualifierKind.Ident?e.name:((0,s.isDefined)(t)&&t(`getSheetNameFromQualifier unexpected qualifier kind: ${e.kind}`),"")}function p(e,t){return e.index+(e.kind===a.PosKind.Rel?t:0)}d.MaxRow=1048575,d.MaxColumn=16383,t.isValidCellRef=function(e){return!(0,l.isChangeGateEnabled)("OfficeVSO:7898117_addValidityCheckBeforeConstructingRange")||e.kind!==o.CellRefKind.Bad&&e.kind!==o.CellRefKind.Error},t.getSheetIndexFromSheetName=m,t.getSheetIndexFromQualifier=function(e,t,r){return m(g(e,r),t)},t.getSheetNameFromQualifier=g,t.getRangeFromCellRef=function(e,t,r){switch(e.kind){case o.CellRefKind.Single:{const r=p(e.row,t.row),n=p(e.col,t.col);return{firstRow:r,firstColumn:n,lastRow:r,lastColumn:n}}case o.CellRefKind.Range:return{firstRow:p(e.ref1.row,t.row),firstColumn:p(e.ref1.col,t.col),lastRow:p(e.ref2.row,t.row),lastColumn:p(e.ref2.col,t.col)};case o.CellRefKind.Col:return{firstRow:0,firstColumn:p(e.col1,t.col),lastRow:d.MaxRow,lastColumn:p(e.col2,t.col)};case o.CellRefKind.Row:return{firstRow:p(e.row1,t.row),firstColumn:0,lastRow:p(e.row2,t.row),lastColumn:d.MaxColumn};default:(0,s.isDefined)(r)&&r(`getRangeFromCellRef unexpected CellRefKind: ${e.kind}`)}},t.createNameToDefinedNameInfoMapping=function(e){const t=new Map;return e.forEach((e=>{(0,s.isDefined)(e.name)&&t.set(e.name.toLocaleLowerCase(),e)})),t},t.getNamePartIfExists=function(e,t){const r=t.get(e.asWhole.toLocaleLowerCase());if(void 0!==r&&r.type!==u.DefinedNameInfoType.Invalid)return r},t.getAbsolutePosition=p,t.sheetIndexToSheetName=function(e,t){const r=t.sheets.findIndex((t=>(0,c.isSheetIndexEqual)(t.sheetIndex,e)));if(-1!==r)return t.sheets[r].sheetName},t.caretInSpanScope=function(e,t){return(0,s.isDefined)(t)&&e.valueOf()>=t.start&&e.valueOf()<t.end},t.findFieldRefSourceLhs=function e(t){switch(t.kind){case n.NamePartKind.CellRefNamePart:case n.NamePartKind.IdentNamePart:return t;case n.NamePartKind.FieldRefNamePart:return e(t.lhs)}}},8792:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PluginRegistry=void 0;var n=r(35450);Object.defineProperty(t,"PluginRegistry",{enumerable:!0,get:function(){return n.PluginRegistry}})},35450:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PluginRegistry=void 0;const n=r(16447),i=r(66154),o=r(69711),a=r(65248),s=r(42549);class l{static creator(){return(e,t,r)=>new l(e,t,r)}static get create(){return l.creator()}x10Plugin(e){return(t,r)=>{const a=String(r.name),l={registryInitialized:()=>!this.gate||(0,s.isTypedChangeGateEnabled)(this.gate),factoryName:this.factoryName,pluginName:a,pluginGroup:this.pluginGroup,create:r=>new t(...e?e(r):[])};(0,o.assertTrue)(`Registry object cannot be used on '${l.pluginName}' class. 'x10Plugin' decorator must be called only once on plugin class`,void 0===this.factory),this.factory=l;for(const e of this.registeredUIHandlers)(0,i.registerComputation)(n.ComputationType.UIMessage,e.kind,e.executionType,this.pluginGroup,{factoryName:this.factoryName,pluginName:a,computationName:e.name},e.modifiers,e.computationGenerator,e.predicate);for(const e of this.registeredEventHandlers)(0,i.registerComputation)(n.ComputationType.Event,e.kind,e.executionType,this.pluginGroup,{factoryName:this.factoryName,pluginName:a,computationName:e.name},e.modifiers,e.computationGenerator,e.predicate)}}uiMessageHandler(e){return(t,r)=>{var i,o,s;this.registeredUIHandlers.push({type:n.ComputationType.UIMessage,kind:e.kind,name:String(r.name),executionType:null!==(o=null===(i=e.modifiers)||void 0===i?void 0:i.executionType)&&void 0!==o?o:a.ExecutionType.Async,modifiers:null!==(s=e.modifiers)&&void 0!==s?s:{},computationGenerator:t,predicate:e.predicate})}}eventHandler(e){return(t,r)=>{var i,o,s;this.registeredEventHandlers.push({type:n.ComputationType.Event,kind:e.kind,name:String(r.name),executionType:null!==(o=null===(i=e.modifiers)||void 0===i?void 0:i.executionType)&&void 0!==o?o:a.ExecutionType.Async,modifiers:null!==(s=e.modifiers)&&void 0!==s?s:{},computationGenerator:t,predicate:e.predicate})}}injectPluginFactory(){return(0,o.assertTrue)("Plugin factory not initialized. `x10Plugin` decorator must be called on plugin class",void 0!==this.factory),this.factory}constructor(e,t,r){this.factoryName=e,this.pluginGroup=t,this.gate=r,this.factory=void 0,this.registeredUIHandlers=[],this.registeredEventHandlers=[]}}t.PluginRegistry=l},86857:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.X10TableIntelligenceService=void 0;const n=r(19181),i=r(12450),o=r(33436),a=r(55340),s=r(83567);t.X10TableIntelligenceService=class{getRecognizedRangeTablesInfo(...e){return n.__awaiter(this,void 0,void 0,(function*(){try{const t=yield this.tableIntelligenceProvider.getRecognizedRangeTablesInfo(...e);return(0,i.isDefined)(t)?(0,o.success)(t.filter(i.isDefined)):(0,o.failure)(void 0)}catch(e){return"getRecognizedRangeTablesInfo",t=`failed to get recognized range tables info: ${e}`,s.x10Logger.log({kind:"failure",payload:{failureKind:s.X10FailureKind.TableIntelligenceFailure,failureLevel:a.TraceLevel.Warning,path:"X10TableIntelligenceService.getRecognizedRangeTablesInfo",description:t}}),(0,o.failure)(e)}var t}))}constructor(e){this.tableIntelligenceProvider=e}}},93197:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Types=t.flaky=t.skip=t.each=t.test=void 0;const n=r(19181),i=n.__importStar(r(24180)),o=n.__importStar(r(70548));t.test=i.test,t.each=i.each,t.skip=i.skip,t.flaky=i.flaky,t.Types=o},70548:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RangeInterface=t.SheetInterface=t.GridInterface=void 0;const n=r(19181).__importStar(r(15152));t.GridInterface=n.GridInterface,t.SheetInterface=n.SheetInterface,t.RangeInterface=n.RangeInterface},24180:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.x10Test=t.flaky=t.skip=t.each=t.test=void 0;const n=r(19181),i=r(69711),o=r(32612),a=r(14865),s=r(59416),l=r(15152);class u{static get instance(){return(0,i.isDefined)(this._instance)||(this._instance=new u),this._instance}constructor(){var e,t;this.args=[],this.args=null!==(t=JSON.parse(null!==(e={NODE_ENV:"production"}.npm_config_argv)&&void 0!==e?e:"{}").original)&&void 0!==t?t:[]}}u.has=e=>u.instance.args.findIndex((t=>t===e))>=0;class c{get startTime(){return this.timer.startTime}get preciseNow(){return this.timer.preciseNow()}jolt(){return new Promise((e=>setImmediate((()=>e()))))}runUntilResolved(e){return n.__awaiter(this,void 0,void 0,(function*(){let t=!1;const r=Promise.resolve(e);return r.then((()=>t=!0)),yield this.runMacrotasksWhile((()=>!t)),r}))}constructor(e){this.timer=e,this.runMacrotasksWhile=(...e)=>this.timer.runMacrotasksWhile(...e),this.runMacrotasksFor=e=>{const t=this.preciseNow;return this.runMacrotasksWhile((()=>this.preciseNow<t+e))}}}function d(){const e=(0,o.createMockAsyncGrid)(),t=new a.MockTimerImmediate,r=(0,s.getSchedulerFactories)().createFormulaBarScheduler((0,o.createMockGridProvider)(e),void 0,t),n=new l.GridInterface(e,r);return r.registerAsyncGrid(),{scheduler:r,grid:n,timer:new c(t)}}function m(e,t,r){it(e,((...e)=>t(d(),...e)),r)}function g(e){return function(t,r,n){it.each(e)(t,((...e)=>r(d(),...e)),n)}}function p(e,t,r){it.skip(e,((...e)=>t(d(),...e)),r)}function h(e){return u.has("--flaky")?m:p}t.test=m,t.each=g,t.skip=p,t.flaky=h,t.x10Test={test:m,each:g,skip:p,flaky:h}},15152:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GridInterface=t.SheetInterface=t.RangeInterface=void 0;const n=r(19181),i=r(38057),o=r(85304),a=r(88131),s=r(15770),l=r(86506),u=r(23169),c=r(65290);function d(e){return void 0!==e&&e.hasOwnProperty("value")}class m{set(e,t,r){e in this.map||(this.map[e]={}),this.map[e][t]=r}get(e,t){if(e in this.map&&t in this.map[e])return this.map[e][t]}constructor(){this.map={}}}class g{setRange(e){const t=e.map((e=>e.map((e=>d(e)?e.value:e)))),r=e.map((e=>e.map((e=>d(e)?e.format:void 0)))),n=e.map((e=>e.map((e=>d(e)?e.formulaBarText:void 0))));this.grid.setRange(this.sheetId,this,t,r,n)}setTable(e,t,r){var n,i;const[s,l]=[!(null!==(n=null==e?void 0:e.hideHeadersRow)&&void 0!==n&&n),null!==(i=null==e?void 0:e.hasTotalsRow)&&void 0!==i&&i];this.setRange(s?[t,...r]:r);const u=[(0,a.namedObjectsWrite)(void 0,[(0,a.namedObject)(e.name,(0,a.namedTableData)((0,a.sheetRangeLocation)(this.sheetId,this.firstRow+(s?1:0),this.firstColumn,this.firstRow+r.length-(l?1:0),this.firstColumn+t.length-1),s,l,t.map(((e,t)=>(0,a.columnData)(this.firstColumn+t,e)))))])];this.grid.setNamedObjects(u),this.scheduler.doNotify(o.NotificationKind.updateNamedObjects,[0,u])}get topLeft(){return{row:this.firstRow,col:this.firstColumn,rows:1,cols:1}}get firstRow(){return this.row}get firstColumn(){return this.col}get lastRow(){return this.row+this.rows-1}get lastColumn(){return this.col+this.cols-1}get range(){return this}get sheet(){return{document:{name:"",path:void 0},index:this.sheetId,index2:this.sheetId}}get rowIndex(){return this.firstRow}get colIndex(){return this.firstColumn}get sheetIndex(){return this.sheet.index}get docPath(){var e;return null!==(e=this.sheet.document.path)&&void 0!==e?e:null}get docName(){return this.sheet.document.name}get tables(){const e=this;return this.grid.getIntersectingTables(0,this).then((t=>n.__awaiter(this,void 0,void 0,(function*(){return yield e.grid.discardSnapshot(0),"Success"===t.kind?t.value.tables:[]}))))}get cellValues(){return this.cells.then((e=>e.map((e=>e.map((e=>e.value))))))}get cellFormats(){return this.cells.then((e=>e.map((e=>e.map((e=>e.format))))))}get cells(){const e=this;return e.grid.getRangeValues(0,e).then((t=>e.grid.getRangeFormats(0,e).then((r=>n.__awaiter(this,void 0,void 0,(function*(){return e.grid.getRangeFormulae(0,e).then((i=>n.__awaiter(this,void 0,void 0,(function*(){var n;const o=h("Success"===t.kind?t.value.nonEmptyCells:[],(e=>(0,a.readOperToCellValue)(s.xlMathpack,e))),l=h("Success"===r.kind?r.value.nonEmptyCells:[],(e=>Number(e))),u=h("Success"===i.kind?i.value.nonEmptyCells:[],(e=>e)),c=[];for(let t=e.firstRow;t<=e.lastRow;t++){c.push([]);for(let r=e.firstColumn;r<=e.lastColumn;r++)c[t-e.firstRow].push({value:o.get(t,r),formulaBarText:null===(n=u.get(t,r))||void 0===n?void 0:n.formulaBarText,format:l.get(t,r)})}return yield e.grid.discardSnapshot(0),c}))))}))))))}constructor(e,t,r,n,i,o,a){this.grid=e,this.scheduler=t,this.sheetId=r,this.row=n,this.col=i,this.rows=o,this.cols=a}}t.RangeInterface=g;class p{get(e){const t=this.parseRangeIndex(e);return this.getCoordinates(t.firstRow,t.firstColumn,t.lastRow,t.lastColumn)}getCoordinates(e,t,r,n){return new g(this.grid,this.scheduler,this.id,e,t,(null!=r?r:e)-e+1,(null!=n?n:t)-t+1)}parseRangeIndex(e){const t={col:0,row:0,cols:1,rows:1},r=this.parser.parseFormulaExpression((0,u.parseLocals)(i.LexicalKind.Range,t),e);if("Success"!==r.kind||"CellRef"!==r.value.node.kind)throw`Could not parse range: ${e}`;const n=(0,c.getRangeFromCellRef)(r.value.node.ref,t,(e=>{throw e}));if(void 0===n)throw`Could not parse range: ${e}`;return n}constructor(e,t,r){this.grid=e,this.scheduler=t,this.id=r;const n={config:(0,l.calcConfig)((0,l.getEnglishLocaleInfo)(),void 0,s.xlMathpack)};this.parser=(0,u.createParser)(n)}}function h(e,t){var r,n;const i=new m;for(const o of e){const e=o[0],a=e[0],s=e[1],l=null!==(r=e[2])&&void 0!==r?r:1,u=null!==(n=e[3])&&void 0!==n?n:1,c=o[1];for(let e=a;e<a+l;e++)for(let r=s;r<s+u;r++)i.set(e,r,t(c))}return i}t.SheetInterface=p,t.GridInterface=class{createSheet(e){const t=new p(this.grid,this.scheduler,e);return this.grid.setSheet(e,e,[[]]),this.sheets[e]=t,this.scheduler.doNotify(o.NotificationKind.updateSheetNames,[0,[{sheetId:e,sheetName:e}]]),t}constructor(e,t){this.grid=e,this.scheduler=t,this.sheets={}}}},15281:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logSafeFailure=void 0;const n=r(33436);t.logSafeFailure={failure:e=>Object.assign(Object.assign({},(0,n.failure)(e)),{logSafe:!0}),isSafe:e=>!0===e.logSafe,censored:e=>!0===e.logSafe?e:(0,n.failure)(void 0)}},73586:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valuePreviewPluginDependenciesResolved=t.ValuePreviewPluginFactory=void 0;const n=r(19181),i=r(50111),o=r(78469),a=r(60111),s=r(33436),l=r(94591),u=r(12450),c=r(57264),d=r(43512),m=r(7827),g=r(39986),p=r(77226),h=r(18538),f=r(90277),S=r(12367);var v=f.types.SpecialFormat;const y=r(83781),F=r(7793),C=r(53507);class R{create(){return new b}constructor(){this.factoryName=h.PluginFactoryName.ValuePreviewPlugin}}t.ValuePreviewPluginFactory=R;class b{*run({text:e,index:t,length:r,activeCell:n}){if((0,u.isNone)(e)||(0,u.isNone)(t)||(0,u.isNone)(r))return E("missing request arguments"),null;if(t<0||t+r>e.length)return E(`invalid selection, ${e.length}, ${t}, ${r}`),null;const o=yield{kind:i.ComputationRequestKind.GetActiveCell};if(o.kind!==i.ComputationRequestKind.GetActiveCell)return this.isRelabelPluginFailuresEnabled?{kind:"Failure",index:t,length:r,reason:"GetActiveCell failed"}:(E("GetActiveCell fail"),null);let a,h=o.activeCell;if(!this.isSnapshotActiveCellEnabled||(0,u.isNone)(n)||(0,u.isNone)(n.sheetName)||function(e,t){const r=[];return e.sheet.index!==t.sheetName&&r.push("sheet"),e.range.col!==t.firstColumn&&r.push("col"),e.range.row!==t.firstRow&&r.push("row"),r.length>0&&c.ulsLogger.ULS.traceTag(507777486,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,`ValuePreviewPlugin.areCellsEqual - active cell diff: ${r.join(",")}`),0===r.length}(h,n)){const t=yield{kind:i.ComputationRequestKind.ParseActiveCell,formulaText:e};if(t.kind!==i.ComputationRequestKind.ParseActiveCell||!(0,s.isSuccess)(t.result))return null;if(t.result.value.kind!==l.EditKind.Formula)return null;a=t.result.value.formula}else{const t=(0,F.unsafeGridRange)(n.firstRow,n.firstColumn,1,1);h=(0,F.sheetGridCell)((0,F.sheetIndex)(h.sheet.document,n.sheetName),t);const r=yield{kind:i.ComputationRequestKind.ParseCellFormula,cell:h,formula:{formulaBarText:e,kind:y.FormulaKind.CellFormula},useEnglishLocaleInfo:!1};if(r.kind!==i.ComputationRequestKind.ParseCellFormula||!(0,s.isSuccess)(r.result))return null;a=r.result.value}const f=function(e,t,r,n){let i;i=0===t?{start:1,end:r>0?r:e.length}:{start:t,end:t+r};const o=new m.ValuePreviewVisitor(n,i.start,i.end,e);let a;if((0,g.reduceBottomUp)(o,n),a=0===r?{start:0===t?t:o.subFormulaStart,end:o.subFormulaEnd}:{start:t,end:t+r},-1===a.start||a.end===a.start||o.isBadSelection||r>0&&!function(e,t){const r=0===t.start||Object.keys(e.spans).some((r=>{var n;return(null===(n=e.spans[Number(r)])||void 0===n?void 0:n.start)===t.start})),n=Object.keys(e.spans).some((r=>{var n;return(null===(n=e.spans[Number(r)])||void 0===n?void 0:n.end)===t.end}));return r&&n}(n,a))return(0,s.failure)("invalid selection");const l=e.substring(a.start,a.end);return(0,s.success)({subFormula:l,subFormulaSpan:a,isVolatile:o.isVolatile,hasCrossWorkbookRef:o.hasCrossWorkbookRef,letDefinitions:o.letDefinitions})}(e,t,r,a);if("Success"!==f.kind)return null;let{subFormula:S}=f.value;const{subFormulaSpan:C,isVolatile:R,letDefinitions:b,hasCrossWorkbookRef:T}=f.value,k={index:C.start,length:C.end-C.start};!this.isLocalizedLetEnabled&&(0,u.isDefined)(b)&&(S=b+", "+S+")");const P=yield{kind:i.ComputationRequestKind.GetConfig};if(P.kind!==i.ComputationRequestKind.GetConfig)return this.isRelabelPluginFailuresEnabled?Object.assign(Object.assign({kind:"Failure"},k),{reason:"GetConfig failed"}):(E("GetConfig fail"),null);this.isLocalizedLetEnabled&&(0,u.isDefined)(b)&&(S=b+P.config.localeInfo.listSeparator+S+")");const N=(S.startsWith("=")?"":"=")+S;if(this.isFailOnEmptyFormulaEnabled&&"="===N)return Object.assign(Object.assign({kind:"Failure"},k),{reason:"Empty formula"});if(T)return Object.assign(Object.assign({kind:"Failure",evaluatedFormula:N},k),{reason:"Cross workbook reference"});const A=yield{kind:i.ComputationRequestKind.GetActiveCellFormat};if(A.kind!==i.ComputationRequestKind.GetActiveCellFormat)return E("GetActiveCellFormat failed"),Object.assign(Object.assign({kind:"Unavailable",evaluatedFormula:N},k),{isVolatile:R,reason:"GetActiveCellFormat failed"});if(!(0,s.isSuccess)(A.result)||(0,u.isNone)(A.result.value))return E("Empty cell format"),Object.assign(Object.assign({kind:"Unavailable",evaluatedFormula:N},k),{isVolatile:R,reason:"Empty cell format"});const I={kind:v.Edit,renderBlanksAsZeros:!0,isWholeFormula:N===e},O=yield{kind:i.ComputationRequestKind.EvalFormula,formula:N,origin:{sheet:h.sheet,range:{col:h.range.col,row:h.range.row,rows:1,cols:1}},format:I};if(O.kind!==i.ComputationRequestKind.EvalFormula)return this.isRelabelPluginFailuresEnabled?Object.assign(Object.assign({kind:"Failure",evaluatedFormula:N},k),{reason:"EvalFormula failed"}):(E("EvalFormula failed"),null);const _=new p.ValuePreviewResultExtractor(P.config).fromEvalFormulaOutput(O.result);switch(_.kind){case"Success":return Object.assign(Object.assign(Object.assign(Object.assign({},_),{evaluatedFormula:N}),k),{isVolatile:R});case"Unavailable":return Object.assign(Object.assign({kind:_.kind,evaluatedFormula:N},k),{isVolatile:R,reason:_.reason});case"Failure":return Object.assign(Object.assign({kind:_.kind,evaluatedFormula:N},k),{reason:_.reason})}}constructor(){this.isLocalizedLetEnabled=(0,S.isChangeGateEnabled)("OfficeVSO:8549693_ValuePreviewLocalizedLet"),this.isRelabelPluginFailuresEnabled=(0,S.isChangeGateEnabled)("OfficeVSO:8544629_ValuePreviewFailureCaching"),this.isSnapshotActiveCellEnabled=(0,S.isChangeGateEnabled)("OfficeVSO:8561808_ValuePreviewSnapshotActiveCell"),this.isFailOnEmptyFormulaEnabled=(0,S.isChangeGateEnabled)("OfficeVSO:8983026_ValuePreviewEmptyFormula")}}function E(e){c.ulsLogger.ULS.traceTag(521692767,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Warning,`ValuePreviewPlugin encountered a failure with msg ${e}`)}(0,o.registerPluginFactory)(new R),t.valuePreviewPluginDependenciesResolved=(0,C.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield a.workerThreadSpread.getValue();yield e.createAndAttachPlugin(h.PluginFactoryName.ValuePreviewPlugin),yield a.schedulerWithRecalcServiceAttached.getValue()}))),"valuePreviewPluginDependenciesResolved")},77226:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ValuePreviewResultExtractor=void 0;const n=r(12450),i=r(33436),o=r(73693),a=r(30333),s=r(94591),l=r(53750),u=r(40535),c=r(57264),d=r(28118),m=r(12367);t.ValuePreviewResultExtractor=class{fromEvalFormulaOutput({value:e,formatted:t}){switch(e.kind){case i.ResultKind.Success:return this.resultFromSuccess(e.value,t);case i.ResultKind.Failure:return this.resultFromFailureReason(e.reason);default:return e}}resultFromSuccess(e,t){let r;switch(e.kind){case o.OperKind.String:case o.OperKind.Array:case o.OperKind.Blank:case o.OperKind.Number:r=this.resultFromFormatted(t);break;case o.OperKind.Boolean:r=this.isBooleanFixEnabled?this.resultFromBoolean(e):this.resultFromFormatted(t);break;case o.OperKind.Error:r=this.resultFromError(e,t);break;default:return{kind:"Failure",reason:`Unsupported operKind: ${e.kind}`}}if("Success"!==r.kind)return r;const n=this.getUnformattedValue(e,r);return Object.assign(Object.assign({},r),{unformattedValue:n,operKind:e.kind})}resultFromFormatted(e){if((0,n.isNone)(e))return{kind:"Failure",reason:"No formatted value"};switch(e.kind){case i.ResultKind.Success:if((0,s.isHashesValue)(e.value)){const r=e.value.units;return t=`Evaluate HashesValue: ${r.kind}`,c.ulsLogger.ULS.traceTag(520680450,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Warning,`ValuePreviewResultExtractor encountered a failure with msg ${t}`),{kind:"Failure",reason:`HashesValue: ${r.kind}`}}return this.resultFromFormattedValue(e.value);case i.ResultKind.Failure:return this.resultFromFailureReason(e.reason);default:return e}var t}resultFromFormattedValue(e){const t=u.render.renderValue(this.mathpack,e,s.renderInfiniteWidth);return t.kind===i.ResultKind.Failure?{kind:"Failure",reason:"renderValue fail"}:(0,s.isHashesValue)(t.value)?{kind:"Failure",reason:`Render HashesValue: ${t.value.units.kind}`}:{kind:"Success",value:(0,s.renderedValueToString)(t.value),color:e.color}}resultFromFailureReason(e){if(!this.isUnavailableDetailedReasonEnabled)return this.resultFromFailureReasonOld(e);const t=function(e){switch(e.kind){case l.ReasonKind.Unavailable:return`Unavailable - [${e.objects.map((e=>"kind"in e?e.kind:"")).join(",")}]`;case l.ReasonKind.NotImplemented:return`NotImplemented - [${e.features.join(",")}]`;case l.ReasonKind.PreviousFailure:return"PreviousFailure";default:return`${e.kind}`}}(e);switch(e.kind){case l.ReasonKind.Unavailable:case l.ReasonKind.NotImplemented:case l.ReasonKind.PreviousFailure:return{kind:"Unavailable",reason:`FailureReason: ${t}`};default:return{kind:"Failure",reason:`Unsupported FailureReason: ${t}`}}}resultFromFailureReasonOld(e){switch(e.kind){case l.ReasonKind.Unavailable:case l.ReasonKind.NotImplemented:case l.ReasonKind.PreviousFailure:return{kind:"Unavailable",reason:`FailureReason: ${e.kind}`};default:return{kind:"Failure",reason:`Unsupported FailureReason: ${e.kind}`}}}resultFromError(e,t){if(!this.onlyFallbackToServerOnSpecificErrorsEnabled)return{kind:"Unavailable",reason:`Unsupported error: ${e.type}`};switch(e.type){case a.ErrorType.NAME:case a.ErrorType.VALUE:case a.ErrorType.FIELD:return{kind:"Unavailable",reason:`Unsupported error: ${e.type}`}}return this.resultFromFormatted(t)}getUnformattedValue(e,t){let r=t.value;return e.kind===o.OperKind.String&&(t.value=`"${t.value}"`,this.isUnformattedStringFixEnabled&&(r=e.value)),e.kind===o.OperKind.Number&&(r=this.mathpack.toNumber(e).toString()),e.kind===o.OperKind.Blank&&this.isUnformattedBlankFixEnabled&&(r=this.mathpack.toNumber(this.mathpack.zero).toString()),r}resultFromBoolean(e){const t=e.value?this.localeInfo.trueName:this.localeInfo.falseName;return{kind:"Success",value:t,unformattedValue:t,operKind:o.OperKind.Boolean}}constructor(e){this.onlyFallbackToServerOnSpecificErrorsEnabled=(0,m.isChangeGateEnabled)("OfficeVSO:8501092_ValuePreviewSpecificErrorFallback"),this.isUnavailableDetailedReasonEnabled=(0,m.isChangeGateEnabled)("OfficeVSO:8545001_ValuePreviewUnavailableReason"),this.isUnformattedStringFixEnabled=(0,m.isChangeGateEnabled)("OfficeVSO:8524802_ValuePreviewUnformattedString"),this.isBooleanFixEnabled=(0,m.isChangeGateEnabled)("OfficeVSO:8561267_ValuePreviewUnformattedBoolean"),this.isUnformattedBlankFixEnabled=(0,m.isChangeGateEnabled)("OfficeVSO:8554558_ValuePreviewUnformattedBlank"),this.mathpack=e.mathpack,this.localeInfo=e.localeInfo}}},7827:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ValuePreviewVisitor=void 0;const n=r(57264),i=r(43512),o=r(12450),a=r(71510),s=r(96438),l=r(39986),u=r(12367);class c extends l.IdentityVisitor{appNode(e,t,r,n){const i=super.appNode(e,t,r,n);return this.tryUpdateAppNodeAsSubFormula(e,i),i}literalNode(e,t,r){const n=super.literalNode(e,t,r);return this.tryUpdateNodeAsSubFormula(n),n}missingNode(e,t){const r=super.missingNode(e,t);return this.tryUpdateNodeAsSubFormula(r),r}arrayNode(e,t,r){const n=super.arrayNode(e,t,r);return this.tryUpdateNodeAsSubFormula(n),n}cellRefNode(e,t,r){const n=super.cellRefNode(e,t,r);return this.validateSelection(r,"whole"),this.tryAddCrossWorkbookRef(t,r),this.tryUpdateNodeAsSubFormula(n)&&(this.isRefNode=!0),n}fieldRefNode(e,t,r){const n=super.fieldRefNode(e,t,r);return this.validateSelection(r,"prefix"),this.tryUpdateNodeAsSubFormula(n),n}structRefNode(e,t,r){const n=super.structRefNode(e,t,r);return this.validateSelection(r,"prefix"),this.tryUpdateNodeAsSubFormula(n)&&(this.isRefNode=!0),n}nameNode(e,t,r){const n=super.nameNode(e,t,r);return this.validateSelection(r,"prefix"),this.tryUpdateNodeAsSubFormula(n)&&(this.isRefNode=!0),n}badSequenceNode(e,t,r){const n=super.badSequenceNode(e,t,r);return t.some((e=>e.label===this.nodeLabel))&&(this.updateNodeAsSubFormula(n),this.isBadSelection=!0),n}parenNode(e,t,r){const n=super.parenNode(e,t,r);return t&&this.tryUpdateNodeAsSubFormula(n),n}letNode(e,t,r,n,i,o){const a=super.letNode(e,t,r,n,i,o),s=this.parsedFormulaTree.spans[o];return this.isMatchingArg(s,!0)&&this.updateLetNodeAsSubFormula(a),a}wsfNode(e,t,r){const n=super.wsfNode(e,t,r);return this.validateSelection(r,"none"),n}operatorNode(e,t){const r=super.operatorNode(e,t);return this.validateSelection(t,"none"),r}tryUpdateNodeAsSubFormula(e){return!!this.isMinimalMatchingSpan(this.parsedFormulaTree.spans[e.label])&&(this.updateNodeAsSubFormula(e),!0)}tryUpdateAppNodeAsSubFormula(e,t){if(e.kind!==a.NodeKind.WSF&&e.kind!==a.NodeKind.Operator)return void n.ulsLogger.ULS.traceTag(509347166,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`ValuePreviewVisitor - visitor encountered higher order function, kind: ${e.kind}`);const r=this.parsedFormulaTree.spans[e.label],o=this.parsedFormulaTree.spans[t.label];this.tryAddVolatileFunction(e,t),this.isMatchingAppNode(r,o,e.kind,t.isClosed)&&this.updateNodeAsSubFormula(t)}updateLetNodeAsSubFormula(e){const t=this.parsedFormulaTree.spans[e.head.label],r=this.parsedFormulaTree.spans[e.label];if(this.isMatchingAppNode(t,r,a.NodeKind.WSF,e.isClosed))this.updateNodeAsSubFormula(e);else for(let t=0;t<e.args.length;t++){const n=e.args[t],i=this.parsedFormulaTree.spans[n.label];if(!(0,o.isDefined)(i))return;if(this.isMatchingArg(i,!0)){if(1===t)return;const a=t%2==0,s=e.args.length-2,l=a?Math.min(s,t+1):t-2,u=this.parsedFormulaTree.spans[e.args[l].label];if(!(0,o.isDefined)(u))return;const c=this.formula.substring(r.start,u.end);this.letDefinitions=c,this.isVolatile=this.checkIntersectionWithVolatileFunction(r),this.hasCrossWorkbookRef=this.checkIntersectionWithCrossWorkbookRef(r),this.isMinimalMatchingSpan(i)&&(this.subFormulaStart=i.start,this.subFormulaEnd=i.end,this.nodeLabel=n.label)}}}updateNodeAsSubFormula(e){const t=this.parsedFormulaTree.spans[e.label];this.subFormulaStart=t.start,this.subFormulaEnd=t.end,this.nodeLabel=e.label,this.isVolatile=this.checkIntersectionWithVolatileFunction(t),this.hasCrossWorkbookRef=this.checkIntersectionWithCrossWorkbookRef(t)}isMinimalMatchingSpan(e){return-1===this.nodeLabel&&this.isMatchingArg(e)}isMatchingArg(e,t=!1){return!!(0,o.isDefined)(e)&&(this.selectionStart===this.selectionEnd?this.selectionStart>=e.start&&this.selectionEnd<e.end:t?this.selectionStart>=e.start&&this.selectionEnd<=e.end:this.selectionStart===e.start&&this.selectionEnd===e.end)}isMatchingAppNode(e,t,r,n){if(!(0,o.isDefined)(e)||!(0,o.isDefined)(t)||!n)return!1;if(this.selectionStart===this.selectionEnd)switch(r){case a.NodeKind.WSF:return this.selectionStart===e.end||this.selectionStart===t.end-1||this.selectionStart>=e.start&&this.selectionStart<e.end;case a.NodeKind.Operator:return this.selectionStart>=e.start-e.pre.length&&this.selectionStart<e.end+e.post.length}else if(this.isBadSelectionValidationEnabled&&e.start<=this.selectionStart&&this.selectionEnd<=e.end)return this.isBadSelection=!0,!1;return this.selectionStart===t.start&&this.selectionEnd===t.end}tryAddVolatileFunction(e,t){if(e.kind!==a.NodeKind.WSF)return;if(!t.isClosed)return;const r=this.parsedFormulaTree.spans[t.label];(0,o.isNone)(r)||(0,s.isVolatileFunc)(e.id)&&this.volatileFunctions.push({start:r.start,end:r.end})}checkIntersectionWithVolatileFunction(e){return this.volatileFunctions.some((t=>e.start<=t.start&&e.end>=t.end))}tryAddCrossWorkbookRef(e,t){if(!this.isCrossWorkbookRefDetectionEnabled)return;if(!e||e.kind!==a.QualifierKind.Sheet&&e.kind!==a.QualifierKind.SheetRange&&e.kind!==a.QualifierKind.Document)return;if((0,o.isNone)(e.document))return;const r=this.parsedFormulaTree.spans[t];(0,o.isNone)(r)||this.crossWorkbookRefs.push({start:r.start,end:r.end})}checkIntersectionWithCrossWorkbookRef(e){return!!this.isCrossWorkbookRefDetectionEnabled&&this.crossWorkbookRefs.some((t=>e.start<=t.start&&e.end>=t.end))}validateSelection(e,t){if(!this.isBadSelectionValidationEnabled)return;if(this.selectionStart===this.selectionEnd)return;const r=this.parsedFormulaTree.spans[e];if((0,o.isDefined)(r)&&!(this.selectionStart<r.start||this.selectionEnd>r.end))switch(t){case"prefix":return void(this.selectionStart!==r.start&&(this.isBadSelection=!0));case"suffix":return void(this.selectionEnd!==r.end&&(this.isBadSelection=!0));case"whole":return void(this.selectionStart===r.start&&this.selectionEnd===r.end||(this.isBadSelection=!0));case"none":return void(this.isBadSelection=!0)}}constructor(e,t,r,n){super(),this.parsedFormulaTree=e,this.selectionStart=t,this.selectionEnd=r,this.formula=n,this.subFormulaStart=-1,this.subFormulaEnd=-1,this.isBadSelection=!1,this.isRefNode=!1,this.isVolatile=!1,this.hasCrossWorkbookRef=!1,this.letDefinitions=void 0,this.volatileFunctions=[],this.crossWorkbookRefs=[],this.nodeLabel=-1,this.isBadSelectionValidationEnabled=(0,u.isChangeGateEnabled)("OfficeVSO:8549607_ValuePreviewBadSelection"),this.isCrossWorkbookRefDetectionEnabled=(0,u.getBooleanFeatureGate)("Microsoft.Office.Excel.ValuePreviewDisableCrossWorkbookRefs",!1)}}t.ValuePreviewVisitor=c},20191:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.chatGPTPluginAttach=t.parserPerformanceMeasurementsAttach=t.autocompleteBinaryModelExperimentPluginAttach=t.autocompleteRangeSuggestionPluginAttach=t.autocompleteWrapperPluginAttach=t.autocompletePluginDependenciesResolved=void 0;const n=r(19181),i=r(18538),o=r(60111),a=r(53507),s=r(42549),l=(0,a.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield o.workerThreadSpread.getValue();return yield e.loadPluginScript((0,s.isTypedChangeGateEnabled)("OfficeVSO:8927842_CalcWP5ES6")?"excelOnlineAutocompleteWP5":"excelOnlineAutocomplete",!1),e}))),"threadWithExcelOnlineAutocompleteScriptLoaded");t.autocompletePluginDependenciesResolved=(0,a.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield l.getValue();yield e.createAndAttachPlugin(i.PluginFactoryName.AutocompletePlugin),yield o.schedulerWithRecalcServiceAttached.getValue()}))),"autocompletePluginDependenciesResolved"),t.autocompleteWrapperPluginAttach=(0,a.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield l.getValue();yield e.createAndAttachPlugin(i.PluginFactoryName.AutocompleteWrapperPlugin)}))),"autocompleteWrapperPluginAttach"),t.autocompleteRangeSuggestionPluginAttach=(0,a.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield l.getValue();yield e.createAndAttachPlugin(i.PluginFactoryName.AutocompleteRangeSuggestionPlugin)}))),"autocompleteRangeSuggestionPluginAttach"),t.autocompleteBinaryModelExperimentPluginAttach=(0,a.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield l.getValue();yield e.createAndAttachPlugin(i.PluginFactoryName.AutocompleteBinaryModelExperimentPlugin)}))),"autocompleteBinaryModelExperimentPluginAttach"),t.parserPerformanceMeasurementsAttach=(0,a.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield l.getValue();yield e.createAndAttachPlugin(i.PluginFactoryName.ParserPerformanceMeasurements)}))),"parserPerformanceMeasurementsAttach"),t.chatGPTPluginAttach=(0,a.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield l.getValue();yield e.createAndAttachPlugin(i.PluginFactoryName.ChatGPTPlugin)}))),"chatGPTPluginAttach")},46580:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CacheGrid=void 0;const n=r(19181),i=r(58293),o=r(55195),a=r(94746),s=r(83079),l=r(38057),u=r(40088),c=r(69711),d=r(42399),m=r(83102),g=r(3895),p=r(20456),h=r(25201),f=r(81836);function S(e){var t;switch(e.kind){case"number":return f.mathpackXL.xlMathpack.fromNumber(e.value);case"string":return(0,g.stringOper)(e.stringValue);case"bool":return(0,g.booleanOper)(e.boolValue);case"error":return(0,g.errorOper)(null!==(t=e.errorKind)&&void 0!==t?t:g.ErrorType.UNKNOWN);case"rich":return{kind:g.OperKind.Rich,getFallback:()=>(0,g.errorOper)(g.ErrorType.FIELD),getField(){}};case"blank":return g.blankOper}}t.CacheGrid=class{get readonlyDataModel(){return this.calcGrid.dataModel.getDocs()}writeRange(e,t){const r=this.sheetRangeToSheetGridRange(t.range);if(void 0===r)return;const{hiddenRowSet:n,hiddenColSet:i}=this.populateHiddenCells(t,r,e),o=(0,s.sheetCellSet)(r.sheet,(0,m.createFromProduct)({row:n,col:i}));this.calcGrid.dataModel.writeCellContents(e,o,"",!1,(0,l.gridCell)(r.range.row,r.range.col),g.blankOper,void 0,void 0);const{visibleRows:a,visibleCols:u}=function(e,t,r){const{row:n,col:i,rows:o,cols:a}=e.range,l=(0,p.except)(s.bspFactory.row([n,n+o]),t),u=(0,p.except)(s.bspFactory.col([i,i+a]),r),c=[];(0,h.forEachRow)(l,(([e,t])=>{for(let r=e;r<t;r++)c.push(r);return!0}));const d=[];return(0,h.forEachCol)(u,(([e,t])=>{for(let r=e;r<t;r++)d.push(r);return!0})),{visibleRows:c,visibleCols:d}}(r,n,i);for(let n=0;n<t.values.length;n++){const i=t.values[n],o=a[n];for(let a=0;a<i.length;a++){const c=i[a],d=u[a],m=(0,l.gridCell)(o,d);this.calcGrid.dataModel.writeCellContents(e,(0,s.sheetCellSet)(r.sheet,(0,h.createCellSetFromRange)(m)),t.formulae[n][a].formulaText,t.formulae[n][a].isFormula,m,S(c),t.iformats[n][a],void 0)}}}get sheets(){var e;return null===(e=this.readonlyDataModel.getSingleReadonlyDocument())||void 0===e?void 0:e.getReadonlySheets()}get nameManager(){var e;return null===(e=this.readonlyDataModel.getSingleReadonlyDocument())||void 0===e?void 0:e.getReadonlyNameManager()}get config(){return this.readonlyDataModel.config}consumePartialWorkbookMessages(){for(;!this.calcGrid.dataModel.step().queueEmpty;);}populateHiddenCells(e,t,r){const n=e.hiddenRows.reduce(((e,{startInclusive:t,endExclusive:r})=>(0,s.union)(e,s.bspFactory.row([t,r]))),s.empty),o=e.hiddenCols.reduce(((e,{startInclusive:t,endExclusive:r})=>(0,s.union)(e,s.bspFactory.col([t,r]))),s.empty),a=(0,i.sheetGridRangeToHiddenRows)(t,n),l=(0,i.sheetGridRangeToHiddenCols)(t,o);return this.calcGrid.dataModel.writeHiddenRows(r,a),this.calcGrid.dataModel.writeHiddenCols(r,l),{hiddenRowSet:n,hiddenColSet:o}}sheetRangeToSheetGridRange(e){const t=this.calcGrid.dataModel.getDocs().getSheetIndex(this.calcGrid.document,e.sheetName);if(t.kind!==c.ResultKind.Failure&&(0,c.isDefined)(t.value))return(0,l.sheetGridRange)((0,l.sheetIndex)(this.calcGrid.document,t.value),(0,d.rangeToGridRange)(e))}constructor(){this.calcGrid=(0,u.makeCalcGrid)(),this.recalcSideGrid=new a.RecalcSideGrid(this.calcGrid),this.schedulerFeatures=[],this.setSchedulerFeatures=e=>{this.schedulerFeatures=e},this.setA1ReferenceStyle=(...e)=>{this.calcGrid.setA1ReferenceStyle(...e),this.consumePartialWorkbookMessages()},this.setLocale=(...e)=>{this.calcGrid.setLocale(...e),this.consumePartialWorkbookMessages()},this.setWorkbookProps=(...e)=>{this.calcGrid.setWorkbookProps(...e),this.consumePartialWorkbookMessages()},this.updateSheetNames=(...e)=>{this.calcGrid.updateSheetNames(...e),this.consumePartialWorkbookMessages()},this.updateNamedObjects=(...e)=>{this.calcGrid.updateNamedObjects(...e),this.consumePartialWorkbookMessages()},this.setNumberFormats=(...e)=>{this.calcGrid.setNumberFormats(...e),this.consumePartialWorkbookMessages()},this.getStateAsNotifications=()=>[],this.getDocumentLoc=(...e)=>this.readonlyDataModel.getDocumentLoc(...e),this.getSheetIndex=(...e)=>this.readonlyDataModel.getSheetIndex(...e),this.getSheetName=(...e)=>this.readonlyDataModel.getSheetName(...e),this.getNameLoc=(...e)=>this.readonlyDataModel.getNameLoc(...e),this.getUserDefinedFuncLoc=(...e)=>this.readonlyDataModel.getUserDefinedFuncLoc(...e),this.getSheetRangeIndexes=(...e)=>this.readonlyDataModel.getSheetRangeIndexes(...e),this.getContainingTable=(...e)=>this.readonlyDataModel.getContainingTable(...e),this.getStructRefSpecialRef=(...e)=>this.readonlyDataModel.getStructRefSpecialRef(...e),this.getStructRefColumn=(...e)=>this.readonlyDataModel.getStructRefColumn(...e),this.getRangeValues=(...e)=>this.recalcSideGrid.getRangeValues(...e),this.getRangeFormulae=(...e)=>this.recalcSideGrid.getRangeFormulae(...e),this.getRangeFormats=(...e)=>this.recalcSideGrid.getRangeFormats(...e),this.getSheetNames=(...e)=>this.recalcSideGrid.getSheetNames(...e),this.getIntersectingTables=(...e)=>this.recalcSideGrid.getIntersectingTables(...e),this.getIformats=(...e)=>this.recalcSideGrid.getIformats(...e),this.getHiddenRows=(...e)=>this.recalcSideGrid.getHiddenRows(...e),this.getHiddenCols=(...e)=>this.recalcSideGrid.getHiddenCols(...e),this.discardSnapshot=(...e)=>n.__awaiter(this,void 0,void 0,(function*(){return this.recalcSideGrid.discardSnapshot(...e)})),this.evalClonedModelOnSnapshot=(...e)=>this.recalcSideGrid.evalClonedModelOnSnapshot(...e),this.evalFormulaOnSnapshot=(...e)=>this.recalcSideGrid.evalFormulaOnSnapshot(...e),this.getCorrespondingSnapshotID=(...e)=>this.recalcSideGrid.getCorrespondingSnapshotID(...e),this.calcGrid.dataModel.setNumberFormats(this.calcGrid.document,o.knownFormatData,!1,-1/0)}}},81466:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChatGPTPlugin=t.ChatGPTPluginFactory=void 0;const n=r(18538),i=r(12450),o=r(78469),a=r(50111);class s{create(){return new l}constructor(){this.factoryName=n.PluginFactoryName.ChatGPTPlugin}}t.ChatGPTPluginFactory=s;class l{*run(e){const t=e.query;if(!(0,i.isDefined)(t))return null;const r=yield{kind:a.ComputationRequestKind.CreateChatGPTSession,options:e.context};if(r.kind!==a.ComputationRequestKind.CreateChatGPTSession)throw new Error("Inconsistent yield request response type");const n=yield{kind:a.ComputationRequestKind.SendChatGPTQuery,session:r.result,request:t};if(n.kind!==a.ComputationRequestKind.SendChatGPTQuery)throw new Error("Inconsistent yield request response type");const o=yield{kind:a.ComputationRequestKind.SendChatGPTQuery,session:r.result,request:"Explain your answer"};if(o.kind!==a.ComputationRequestKind.SendChatGPTQuery)throw new Error("Inconsistent yield request response type");return{result:n.result,details:o.result}}}t.ChatGPTPlugin=l,(0,o.registerPluginFactory)(new s)},28414:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChatGPTService=void 0;const n=r(19181),i=r(12450),o=r(33436);t.ChatGPTService=class{createSession(e){return n.__awaiter(this,void 0,void 0,(function*(){const t=yield this.provider.openChat(e);return(0,i.isDefined)(t)?(this.set.add(t),(0,o.success)(t)):(0,o.failure)(void 0)}))}closeSession(e){return n.__awaiter(this,void 0,void 0,(function*(){if(!this.set.has(e))return(0,o.failure)(void 0);try{return yield this.provider.close(e),this.set.delete(e),(0,o.success)(void 0)}catch(e){return(0,o.failure)(void 0)}}))}request(e,t){return n.__awaiter(this,void 0,void 0,(function*(){if(!this.set.has(e))return(0,o.failure)(void 0);try{const r=yield this.provider.send(e,t);return(0,o.success)(r)}catch(e){return(0,o.failure)(void 0)}}))}constructor(e){this.provider=e,this.set=new Set}}},27584:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.conflictResolver=void 0;const n=r(12450),i=r(78469),o=r(18538),a=r(18538),s=r(57264),l=r(48071),u=r(11351);t.conflictResolver={runTest:d,runExperiment:d,runAuthoringExperiment:d,runPerCharacterExperiment:d,argumentAssistance:m,valuePreview:m,gotoCtrlClick:m,formulaRepair:m,chatGPTQuery:m,columnFormulaSuggestion:m,setCellPrefetch:m,getTranspiledFormulas:m,inCellSuggestion(e){for(const[{factoryName:t},r]of e)if(t===a.PluginFactoryName.AutocompleteRangeSuggestionPlugin&&(0,n.isDefined)(r))return r;return null},formulaHighlighting(e){var t;if(e.length>0){let r=[];for(const[i,o]of e){const e=null===(t=o.formulaHighlights)||void 0===t?void 0:t.filter(n.isDefined);void 0!==e&&(r=r.concat(e))}const i=(e,t)=>(0,n.isDefined)(e.span)&&(0,n.isDefined)(t.span)?(0,u.spanCompare)(e.span,t.span):(0,n.isDefined)(e)?1:(0,n.isDefined)(t)?-1:0;return r.sort(i),{formulaHighlights:r}}return null},functionSuggestion(e){const t=[],r=[],i=[];let u;if(e.filter((([{factoryName:e}])=>"enum"===d(e))).forEach((([e,t])=>{(0,n.isDefined)(t.items)&&t.items.filter(n.isDefined).filter((e=>(0,n.isDefined)(e.textEdit)||(0,n.isDefined)(e.label))).forEach((e=>i.push(Object.assign(Object.assign({},e),{type:o.SuggestionKind.Simple}))))})),i.length>0)return{items:[...i],data:u};for(const[{factoryName:i},a]of e)d(i)===o.SuggestionKind.Smart?((0,n.isDefined)(a.items)&&a.items.filter(n.isDefined).filter((e=>(0,n.isDefined)(e.textEdit)||(0,n.isDefined)(e.label))).forEach((e=>t.push(Object.assign(Object.assign({},e),{type:o.SuggestionKind.Smart})))),(0,n.isDefined)(a.data)&&(u=a.data)):(0,n.isDefined)(a.items)&&a.items.filter(n.isDefined).filter((e=>(0,n.isDefined)(e.textEdit)||(0,n.isDefined)(e.label))).forEach((e=>r.push(Object.assign(Object.assign({},e),{type:o.SuggestionKind.Simple}))));return{items:[...t,...r.sort((function(e,t){if((0,n.isDefined)(e.label)&&(0,n.isDefined)(t.label)){if((0,n.isDefined)(e.isPrefixed)&&(0,n.isDefined)(t.isPrefixed)&&e.isPrefixed!==t.isPrefixed)return e.isPrefixed?-1:1;if(c.includes(e.kind)&&c.includes(t.kind)){const r=(0,l.getStructRefCompletionItemRank)(e),n=(0,l.getStructRefCompletionItemRank)(t);if(r!==n)return n-r}return e.label.toLocaleLowerCase()>t.label.toLocaleLowerCase()?1:-1}return(0,n.isDefined)(e.label)?1:(0,n.isDefined)(t.label)?-1:0}))],data:u};function d(e){switch(e){case a.PluginFactoryName.AutocompletePlugin:case a.PluginFactoryName.FormulaCollectionPlugin:return o.SuggestionKind.Smart;case a.PluginFactoryName.DragPlugin:case a.PluginFactoryName.SlowTestPlugin:case a.PluginFactoryName.AutocompleteFunctionPlugin:case a.PluginFactoryName.AutocompleteLetPlugin:case a.PluginFactoryName.AutocompleteRichValuePlugin:case a.PluginFactoryName.AutocompleteNamedObjectsPlugin:case a.PluginFactoryName.AutocompleteTableHeadersPlugin:case a.PluginFactoryName.PythonAutocompletePlugin:return o.SuggestionKind.Simple;case a.PluginFactoryName.AutocompleteEnumPlugin:return"enum";default:(0,s.assertNever)(`unknown plugin factory name: ${e}`,e)}}}};const c=[o.CompletionItemKind.TableHeader,o.CompletionItemKind.TableSpecialStructRef];function d(e){const t=[];for(const[r,{results:i}]of e)(0,n.isDefined)(i)&&t.push(...i.filter(n.isDefined));return{results:t}}function m(e){if(0===e.length)return null;const[{factoryName:t},r]=e[0];if(1===e.length)return r;const n=i.pluginFactoryKindMap[t];throw new Error(`Conflict resolver: ${n}: ${e.length} results received, while only one active plugin is currently supported`)}(0,n.staticAssertExtends)()},8707:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.customConflictResolverFactories=t.FunctionSuggestionAndArgumentAssistanceConflictResolver=void 0;const n=r(83118),i=r(12450),o=r(82751),a=r(50111),s=r(57264),l=r(12367),u=r(18538);class c{consumeResult(e){var t;if((0,l.isChangeGateEnabled)("OfficeVSO:7640530_InCellSuggestionRequestResolverEnabledV2"))switch(e.kind){case a.RequestKind.functionSuggestion:(0,s.assertTrue)("functionSuggestionSet should be false when receiving functionSuggestion request",!this.functionSuggestionSet),this.functionSuggestionResult=e.result,this.functionSuggestionSet=!0,this.resolvePromiseIfPossible();break;case a.RequestKind.argumentAssistance:(0,s.assertTrue)("argumentAssistanceSet should be false when receiving argumentAssistance request",!this.argumentAssistanceSet),this.argumentAssistanceResult=e.result,this.argumentAssistanceSet=!0,this.resolvePromiseIfPossible();break;case a.RequestKind.inCellSuggestion:(0,s.assertTrue)("inCellSuggestionSet should be false when receiving inCellSuggestion request",!this.inCellSuggestionSet),this.inCellSuggestionResult=e.result,this.inCellSuggestionSet=!0,this.resolvePromiseIfPossible();break;default:(0,s.assertNever)(`unknown result: ${e}`,e)}else switch(e.kind){case a.RequestKind.functionSuggestion:if((0,s.assertTrue)("functionSuggestionSet should be false when receiving functionSuggestion request",!this.functionSuggestionSet),(0,i.isDefined)(e.result)&&(0,i.isDefined)(e.result.items)&&e.result.items.length>0&&(null===(t=e.result.items[e.result.items.length-1])||void 0===t?void 0:t.type)===u.SuggestionKind.Simple)return this.promise.resolve({functionSuggestion:e.result,argumentAssistance:null,inCellSuggestion:null});if(this.argumentAssistanceSet)return null!==this.argumentAssistanceResult?this.promise.resolve({functionSuggestion:null,argumentAssistance:this.argumentAssistanceResult,inCellSuggestion:null}):this.promise.resolve({functionSuggestion:e.result,argumentAssistance:null,inCellSuggestion:null});this.functionSuggestionResult=e.result,this.functionSuggestionSet=!0;break;case a.RequestKind.argumentAssistance:if((0,s.assertTrue)("argumentAssistanceSet should be false when receiving argumentAssistance request",!this.argumentAssistanceSet),this.functionSuggestionSet)return null!==e.result?this.promise.resolve({functionSuggestion:null,argumentAssistance:e.result,inCellSuggestion:null}):this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:null,inCellSuggestion:null});this.argumentAssistanceResult=e.result,this.argumentAssistanceSet=!0;break;case a.RequestKind.inCellSuggestion:break;default:(0,s.assertNever)(`unknown result: ${e}`,e)}}static create(){return new c}resolvePromiseIfPossible(){var e,t;if(this.functionSuggestionSet){if((0,i.isDefined)(this.functionSuggestionResult)&&(0,i.isDefined)(this.functionSuggestionResult.items)&&this.functionSuggestionResult.items.length>0)return(null===(e=this.functionSuggestionResult.items[length-1])||void 0===e?void 0:e.type)===u.SuggestionKind.Smart&&((0,s.assertTrue)("can't get argument assistance and smart suggestion at the same time",!this.argumentAssistanceSet||null==this.argumentAssistanceResult),(0,s.assertTrue)("can't get in cell suggestion and smart suggestion at the same time",!this.inCellSuggestionSet||null==(null===(t=this.inCellSuggestionResult)||void 0===t?void 0:t.completionItem))),this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:null,inCellSuggestion:null});if(this.argumentAssistanceSet&&this.inCellSuggestionSet)return this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:this.argumentAssistanceResult,inCellSuggestion:this.inCellSuggestionResult})}}constructor(){this.argumentAssistanceResult=null,this.functionSuggestionResult=null,this.inCellSuggestionResult=null,this.argumentAssistanceSet=!1,this.functionSuggestionSet=!1,this.inCellSuggestionSet=!1,this.promise=new o.ResolvablePromise}}t.FunctionSuggestionAndArgumentAssistanceConflictResolver=c,(0,i.staticAssertExtends)(),t.customConflictResolverFactories={[n.CustomConflictResolverStrategy.FunctionSuggestionAndArgumentAssistance]:c},(0,i.staticAssertExtends)()},83118:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeBatchRequester=t.customConflictResolverPluginKinds=t.CustomConflictResolverStrategy=void 0;const n=r(50111),i=r(50111),o=r(12450);var a;!function(e){e.FunctionSuggestionAndArgumentAssistance="FunctionSuggestionAndArgumentAssistance"}(a||(t.CustomConflictResolverStrategy=a={})),t.customConflictResolverPluginKinds={[a.FunctionSuggestionAndArgumentAssistance]:[i.RequestKind.functionSuggestion,i.RequestKind.argumentAssistance,i.RequestKind.inCellSuggestion]},t.makeBatchRequester=function(e){return{functionSuggestionAndArgumentAssistance(t,r,i){if((0,o.isNone)(t))return Promise.resolve(null);const{functionSuggestion:s,argumentAssistance:l,inCellSuggestion:u}=t;return(0,o.isNone)(s)||(0,o.isNone)(l)||(0,o.isNone)(u)?Promise.resolve(null):e.doBatchRequest({strategy:a.FunctionSuggestionAndArgumentAssistance,functionSuggestion:s,argumentAssistance:l,inCellSuggestion:u},r,null!=i?i:n.DefaultComputationGroup)}}},(0,o.staticAssertExtends)(),(0,o.staticAssertExtends)(),(0,o.staticAssertExtends)(),(0,o.staticAssertExtends)(),(0,o.staticAssertExtends)()},9707:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dynamicPluginLoaderInsideInit=t.timelineQueueProcessorFactory=t.createPrefetchingCacheFactory=t.DynamicPluginLoader=void 0;const n=r(19181),i=n.__importStar(r(66932)),o=r(43512),a=r(37462),s=r(37462),l=r(93087),u=r(57264),c=r(78469),d=r(12450),m=r(57814),g=r(57814),p=r(38869),h=r(84565),f=r(81476),S=r(83567),v=r(32973);class y{loadPluginScriptTrace(e,t){u.ulsLogger.ULS.traceTag(553734797,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,S.x10Logger.formatLogMessage("loadPluginScript",{description:`${e} loaded, time to load ${t}`}))}createAndAttachPlugin(e,t){return n.__awaiter(this,void 0,void 0,(function*(){const r=(0,c.getPluginFactory)(e);this.scheduler.createAndAttachPlugin(r,t)}))}createAndAttachSyncPlugin(e,t){return n.__awaiter(this,void 0,void 0,(function*(){const r=(0,c.getPluginFactory)(e);this.scheduler.createAndAttachSyncPlugin(r,t)}))}constructor(e,t){if(!(t instanceof s.FormulaBarScheduler))throw new TypeError(`DynamicPluginLoaderBase.constructor: unknown IFormulaBarScheduler class: ${JSON.stringify(t)}`);this.scheduler=t,S.x10Logger.threadId=e}}class F extends y{loadPluginScript(e,t){return n.__awaiter(this,void 0,void 0,(function*(){if((0,d.isNone)(e)||(0,d.isNone)(t))return;const r=g.defaultTimerInterface,n=r.now();yield this.loader.loadScript(e);const i=r.now()-n;this.loadPluginScriptTrace(e,i)}))}isThreadingSupported(){return i.isThreadingSupported()&&void 0!==(0,l.getCalcAbsUrl)()}createPluginThread(e){return n.__awaiter(this,void 0,void 0,(function*(){const t=`DynamicPluginLoaderThread-${F.lastThreadNum+=1}-${e}`,r=`${t}-IGrid`;yield l.initCalcCalled;const n=yield i.createWorker({createMode:"Thread",id:t},i.paramInsideDef({scriptUrl:(0,l.getCalcAbsUrlOrThrow)(),insideInitName:this.threadEntryPoint},{pluginResponseWindows:this.scheduler.getPluginResponseWindows()}),(()=>Object.assign(Object.assign({},(0,h.bindMethods)(this.scheduler,[...a.parentMethodsCall,...a.parentMethodsPost])),{resolveScript:this.resolveScript})));try{let e=()=>{};n.onClose=()=>{e(),u.ulsLogger.ULS.traceTag(553734798,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,S.x10Logger.formatLogMessage("DynamicPluginLoader",{description:"Thread closed"}))};const t=yield(0,l.initCalcThread)(n);e=()=>t.close(),this.scheduler.doNotifyStatelessSubject.subscribe((e=>n.post.processNotification(e))),this.scheduler.requestWithCorrelationIdSubject.subscribe((e=>n.post.requestWithCorrelationId(...e))),this.scheduler.doNotifyStatefulSubject.subscribe((e=>n.post.processNotification(e)));const i={createIGridImportEndpoint:e=>n.call.createIGridImportEndpoint.transfer([e.port],e),onGridExporterClosed:n.post.onGridExporterClosed};return this.gridManager.onGridImporterCreated(i,r),new C(n)}catch(e){throw n.close(),e}}))}constructor(e,t,r,n){super("Main",r),this.threadEntryPoint=e,this.gridManager=t,this.loader=n;const i=n.getConfig();this.resolveScript=i.resolveScript}}t.DynamicPluginLoader=F,F.lastThreadNum=0;class C{loadPluginScript(e,t){return this.outside.call.loadPluginScript(e,t)}createAndAttachPlugin(e,t){return this.outside.call.createAndAttachPlugin(e,t)}createAndAttachSyncPlugin(e,t){return this.outside.call.createAndAttachSyncPlugin(e,t)}recalcServiceAttached(){return this.outside.call.recalcServiceAttached()}close(){this.outside.close()}constructor(e){this.outside=e}}t.createPrefetchingCacheFactory=e=>(...t)=>{const r=e.getGrid();if(void 0!==r)return v.PrefetchingCache.create(r,...t)},t.timelineQueueProcessorFactory=e=>t=>new m.TimelineQueueProcessor(((e,t)=>e.kind-t.kind),t,void 0,e),t.dynamicPluginLoaderInsideInit=(e,t)=>({config:r,connection:o},{pluginResponseWindows:l})=>n.__awaiter(void 0,void 0,void 0,(function*(){return i.Endpoint.createInside(o,(n=>{const i=Object.assign(Object.assign({},(0,h.bindLazyMethods)(new f.ResettableLazy((()=>n.call)),a.parentMethodsCall)),(0,h.bindLazyMethods)(new f.ResettableLazy((()=>n.post)),a.parentMethodsPost)),u=void 0,c=new p.GridProvider((()=>d.registerAsyncGrid())),d=new s.FormulaBarScheduler(e(u),t(c),l,c.getGridDataSink(),c.getSyncDataModel(),u,i);return new R(String(o.options.id),c,d,r,n)}))}));class R extends y{loadPluginScript(e,t){return n.__awaiter(this,void 0,void 0,(function*(){if((0,d.isNone)(e)||(0,d.isNone)(t))return;if(!0===this.loadedScripts[e])return;const r=g.defaultTimerInterface,n=r.now();i.importScriptsWithRetry([yield this.inside.call.resolveScript({identifier:e,isLocalized:t})],l.maxRetriesForLoadingScript);const o=r.now()-n;this.loadedScripts[e]=!0,this.loadPluginScriptTrace(e,o)}))}recalcServiceAttached(){return this.scheduler.recalcServiceAttached()}constructor(e,t,r,i,o){super(e,r),this.gridImporter=t,this.twConfig=i,this.inside=o,this.loadedScripts=(0,d.makeStringMap)(),this.initCalcThreadInside=(e,t,r)=>n.__awaiter(this,void 0,void 0,(function*(){yield(0,l.initCalcInThread)(e,t,r,this.twConfig)})),this.createIGridImportEndpoint=this.gridImporter.createIGridImportEndpoint.bind(this.gridImporter),this.onGridExporterClosed=this.gridImporter.onGridExporterClosed.bind(this.gridImporter),this.processNotification=this.scheduler.processNotification.bind(this.scheduler),this.requestWithCorrelationId=this.scheduler.requestWithCorrelationId.bind(this.scheduler)}}},98094:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.experimentQueueProcessorFactory=t.ExperimentQueueProcessor=void 0;const n=r(12450),i=r(21620),o=r(50111);class a{enqueue(e,t,r){(0,n.isDefined)(r)&&e.kind===o.SchedulerTimelineQueueMessageKind.StopComputationFrame||this.queue.enqueue(e)}step(){const e=this.queue.pop();(0,n.isDefined)(e)&&this.consumeMessage(e)}get done(){return 0===this.queue.getCount()}constructor(e){this.consumeMessage=e,this.queue=new i.PriorityQueue((()=>0))}}t.ExperimentQueueProcessor=a,t.experimentQueueProcessorFactory=e=>new a(e),(0,n.staticAssertExtends)()},84565:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultMap=t.functionMapToGenericFunction1stArg=t.mapFromArrayOfDependantPairs=t.asReadonly=t.bindMethodsNullCheck=t.bindMethodsUnbox=t.bindLazyMethods=t.bindMethods=t.functionMapFromDUFunction=t.staticTypeHint=void 0;const n=r(12450);t.staticTypeHint=function(e){},n.staticAssertSame,n.staticAssertSame,n.staticAssertSame,n.staticAssertSame,t.functionMapFromDUFunction=function(e,t){const r={};for(const n of t)r[n]=(...t)=>e(n,...t);return r},t.bindMethods=function(e,t){const r={};for(const n of t){const t=(...t)=>e[n](...t);r[n]=t}return r},t.bindLazyMethods=function(e,t){const r={};for(const n of t){const t=(...t)=>e.getValue()[n](...t);r[n]=t}return r},n.staticAssertSame,n.staticAssertSame,n.staticAssertSame,n.staticAssertSame;class i{unbox(e){return(...t)=>e(t)}nullcheck(e){return(...t)=>{for(const e of t)if((0,n.isNone)(e))return null;return e(...t)}}}function o(e){const t=new i,r=t[e].bind(t);return function(e,t){const n={};for(const i of t){const t=e[i].bind(e);n[i]=r(t)}return n}}t.bindMethodsUnbox=o("unbox"),t.bindMethodsNullCheck=o("nullcheck");{const e={methodF:e=>e+1,methodG:([e])=>e+1},r=(0,t.bindMethodsUnbox)(e,["methodG"]);n.staticAssertSame,(0,t.bindMethodsNullCheck)(e,["methodG"]),n.staticAssertSame,(0,t.bindMethodsNullCheck)(r,["methodG"]),n.staticAssertSame}function a(e){return e.reduce(((e,[t,r])=>(e[t]=r,e)),{})}t.asReadonly=function(e){return e},t.mapFromArrayOfDependantPairs=a,a([["a",1],["b",2]]),n.staticAssertSame,t.functionMapToGenericFunction1stArg=function(e){return(t,r,...n)=>e[t].call(e,r,...n)},t.DefaultMap=class{get(e){const t=this.operations.getKey(e),r=this.map.get(t);if(void 0!==r)return r;const n=this.operations.getDefault();return this.map.set(t,n),n}set(e,t){this.map.set(this.operations.getKey(e),t)}constructor(e){this.operations=e,this.map=new Map}}},37462:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldRunComputation=t.FormulaBarScheduler=t.parentMethodsPost=t.parentMethodsCall=void 0;const n=r(19181),i=r(7793),o=r(18538),a=r(12450),s=r(12450),l=r(12450),u=r(57264),c=r(55340),d=r(50111),m=r(50111),g=r(24002),p=r(85304),h=r(78469),f=r(33436),S=r(57814),v=r(28196),y=r(27584),F=r(82751),C=r(8707),R=r(83118),b=r(1508),E=r(33058),T=r(91709),k=r(47455),P=r(64411),N=r(21620),A=r(81476),I=r(42549),O=r(29174),_=r(83567),M=r(28414),D=r(35524),w=r(88124),L=r(84565),x=r(65248),K=r(16447),U=r(66154),B=r(66154),G=r(95486),W=r(95486),V=r(95486),j=r(14862),q=r(86857),H=r(15281);class z{create(){return this.current+=1}constructor(){this.current=0}}const $=(0,L.mapFromArrayOfDependantPairs)((0,a.numEnumArray)(o.PluginFactoryName).map((e=>[e,o.PluginFactoryName[e]])));t.parentMethodsCall=["createChatGPTSession","closeChatGPTSession","sendChatGPTQuery","sendAugLoopSignal","registerALAnnotation","getRecognizedTablesInfo"],t.parentMethodsCall,t.parentMethodsPost=["addResult","addToComputationCount","triggerEventImmediate"],(0,s.staticAssertSame)();const Q={kind:k.InternalSchedulerResponseKind.FirstStep},Y={[p.NotificationKind.setActiveCell]:!0,[p.NotificationKind.setActiveCellFormat]:!0,[p.NotificationKind.doNothing]:!0},J=(0,I.getTypedFeatureGate)("Microsoft.Office.Excel.PluginResponseWindowDebugTimeExtension");class X{setFunctionInfo(e){if((0,l.isNone)(e))return void u.ulsLogger.ULS.traceTag(512274762,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,_.x10Logger.formatLogMessage("setFunctionInfo",{description:"functionsInfo was none"}));const t={};for(const r of e)(0,l.isDefined)(r)&&(t[r.NameDataStrings]=r);this.state=Object.assign(Object.assign({},this.state),{functionsInfoMap:t}),u.ulsLogger.ULS.traceTag(512274761,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,_.x10Logger.formatLogMessage("setFunctionInfo",{description:"set functionsInfoMap"}))}setDefinedNamesInfo(e){if((0,l.isNone)(e))return void u.ulsLogger.ULS.traceTag(512274760,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,_.x10Logger.formatLogMessage("setDefinedNamesInfo",{description:"definedNamesInfo was none"}));const t={};for(const r of e)(0,l.isDefined)(r)&&(0,l.isDefined)(r.name)&&(t[r.name.toUpperCase()]=r);this.state=Object.assign(Object.assign({},this.state),{definedNamesInfoMap:t}),u.ulsLogger.ULS.traceTag(512274759,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,_.x10Logger.formatLogMessage("setDefinedNamesInfo",{description:"set definedNamesInfoMap"}))}onWorkbookClosing(){_.x10Logger.flush()}getPluginResponseWindows(){return this.pluginResultWindows}setPluginResponseWindow(e,t,r){this.pluginResultWindows[e]={startDelta:t,stopDelta:r}}consumeMessage(e){switch(e.kind){case m.SchedulerTimelineQueueMessageKind.StepComputation:this.stepComputation(e.computation,e.payload);break;case m.SchedulerTimelineQueueMessageKind.NoOpRequest:case m.SchedulerTimelineQueueMessageKind.SyncRequest:case m.SchedulerTimelineQueueMessageKind.AsyncRequest:const t=this.timer.now();this.processRequest(e.computation,e.request,{onFulfilled:t=>{if(t.kind===f.ResultKind.Success)return this.enqueueMessage({kind:m.SchedulerTimelineQueueMessageKind.StepComputation,computation:e.computation,payload:{kind:k.InternalSchedulerResponseKind.NormalResponse,response:t.value}}),t.value;const r=H.logSafeFailure.censored(t);return this.enqueueMessage({kind:m.SchedulerTimelineQueueMessageKind.StepComputation,computation:e.computation,payload:{kind:k.InternalSchedulerResponseKind.RequestFailure,request:e.request.kind,failure:r}}),r},onRejected:()=>{const t=(0,f.failure)(void 0);return this.enqueueMessage({kind:m.SchedulerTimelineQueueMessageKind.StepComputation,computation:e.computation,payload:{kind:k.InternalSchedulerResponseKind.RequestFailure,request:e.request.kind,failure:t}}),t}}),e.computation.info.schedulerTime+=this.timer.now()-t;break;case m.SchedulerTimelineQueueMessageKind.StopComputationFrame:this.stopComputationFrame(e.correlationId,e.computationGroup,e.type,e.computationKind,m.ExecutionStopReason.Frame.Timeout);break;case m.SchedulerTimelineQueueMessageKind.Timeout:e.callback();break;default:(0,u.assertNever)(`unknown message: ${e}`,e)}}enqueueMessage(e,t){const r=X.abstractStepCosts[e.kind];this.processor.enqueue(e,r,t)}stepComputation(e,t){const r=this.responseStates[e.info.type][e.info.computationKind].computationFrame(e.info.computationGroup);if(e.info.correlationId===(null==r?void 0:r.correlationId))try{const r=this.timer.now(),n=Z(e.generator,t);if(e.info.computationTime+=this.timer.now()-r,!0!==n.done){const t=n.value;this.enqueueMessage((0,k.wrapRequest)(t,e))}else this.addResultAndFinalizeComputationFrame(e,{kind:"Successful",message:n.value},m.ExecutionStopReason.Computation.Done)}catch(t){this.addResultAndFinalizeComputationFrame(e,{kind:"Exception"},m.ExecutionStopReason.Computation.Exception),_.x10Logger.log({kind:"failure",payload:{failureKind:_.X10FailureKind.PluginFailure,failureLevel:c.TraceLevel.Warning,path:"FormulaBarScheduler.stepComputation",description:`plugin threw exception: ${t} during computation`,data:e.info}})}else e.finalizer.finalize(e,e.stopReasonRef.value)}addResultAndFinalizeComputationFrame(e,t,r){return e.finalizer.finalize(e,r),this.addResult(e.info,t)}addResult(e,t,r){const n=this.responseStates[e.type][e.computationKind].computationFrame(e.computationGroup);if(this.parent||null==r||r.forEach((e=>_.x10Logger.log(...e))),void 0===n||n.correlationId>e.correlationId)return;if(n.correlationId<e.correlationId&&_.x10Logger.log({kind:"failure",payload:{failureKind:_.X10FailureKind.AssertionFailure,failureLevel:c.TraceLevel.Warning,path:"FormulaBarScheduler.addResult",description:`main scheduler corelationID (${n.correlationId}) is less than the child one (${e.correlationId})`}}),this.parent){const n=[...null!=r?r:[],..._.x10Logger.flushBufferedMessages()];this.parent.addResult(e,t,n)}switch(t.kind){case"Successful":n.successfulResults.results.push([e.computationIdentifier,t.message]);break;case"Exception":n.numFailures+=1;break;case"Skipped":n.numSkippedComputations+=1;break;default:(0,u.assertNever)("unknown result",t)}const i=this.x10GetNumOfComputationsFromFrameEnabled?function(e){switch(!0){case e.numFailures+e.numSkippedComputations+e.successfulResults.results.length!==e.numOfComputations:return;case e.numFailures===e.numOfComputations:return m.ExecutionStopReason.Computation.Exception;case e.numSkippedComputations===e.numOfComputations:return m.ExecutionStopReason.Computation.Skipped;default:return m.ExecutionStopReason.Computation.Done}}(n):function(e){return e.numFailures+e.numSkippedComputations+e.successfulResults.results.length}(n)===this.responseStates[e.type][e.computationKind].numComputations?m.ExecutionStopReason.Computation.Done:void 0;void 0!==i&&this.stopComputationFrame(n.correlationId,e.computationGroup,e.type,e.computationKind,i)}processRequest(e,t,{onFulfilled:r,onRejected:n}){var i,o;const a=this.responseStates[e.info.type][e.info.computationKind],s=a.computationFrame(e.info.computationGroup);if(e.info.correlationId!==(null==s?void 0:s.correlationId))return e.finalizer.finalize(e,e.stopReasonRef.value),n(H.logSafeFailure.failure("Computation timed out"));const l=this.timer.now(),u=(0,P.processRequest)(P.requestProcessorMap,t,e,null===(i=a.computationFrame(e.info.computationGroup))||void 0===i?void 0:i.cache,null===(o=a.computationFrame(e.info.computationGroup))||void 0===o?void 0:o.config);return(0,v.bindMaybeThenable)(u,(n=>(this.addProcessingTime(e,t.kind,l),n.kind!==f.ResultKind.Success&&_.x10Logger.log({kind:"failure",payload:{failureKind:_.X10FailureKind.RequestProcessorFailure,failureLevel:c.TraceLevel.Warning,path:"FormulaBarScheduler.processRequest",description:"request returned a scheduler-side failure",data:Object.assign(Object.assign({},e.info),{failedRequest:t.kind,failedReason:H.logSafeFailure.censored(n)})}}),r(n))),(r=>(this.addProcessingTime(e,t.kind,l),_.x10Logger.log({kind:"failure",payload:{failureKind:_.X10FailureKind.RequestProcessorFailure,failureLevel:c.TraceLevel.Error,path:"FormulaBarScheduler.processRequest",description:"request processor threw",data:Object.assign(Object.assign({},e.info),{failedRequest:t.kind,error:(0,T.messageFromError)(r)})}}),n(r))))}addProcessingTime(e,t,r){const n=this.timer.now(),i=e.info.requestTimes[t];return i?(i.requestDuration=i.requestDuration+n-r,i.numberOfRequests+=1,i.timeSinceLastRequest=n-e.lastTimestamp):e.info.requestTimes[t]={requestDuration:n-r,numberOfRequests:1,timeSinceLastRequest:n-e.lastTimestamp},e.lastTimestamp=n,n}stopComputationFrame(e,t,r,n,i){var o;const a=this.responseStates[r][n];e===(null===(o=a.computationFrame(t))||void 0===o?void 0:o.correlationId)&&a.stop(t,i,this.timer.now())}recalcServiceAttached(){return this.recalcServiceAttachedPromise.toPromise()}chatGPTProviderAttached(){return this.chatGPTProviderAttachedPromise.toPromise()}tableIntelligenceServiceAttached(){return this.tableIntelligenceServiceAttachedPromise.toPromise()}getFunctionsShortDescriptions(){return E.functionShortDescriptions.getValue()}getSchedulerFeatures(){return(0,L.asReadonly)(this.syncDataModel.schedulerFeatures)}isSchedulerFeatureEnabled(e){return-1!==this.getSchedulerFeatures().indexOf(e)}doNotify(...e){u.ulsLogger.ULS.traceTag(512274758,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,_.x10Logger.formatLogMessage("FormulaBarScheduler.doNotify",{description:`received notification of kind:\n       ${e[0]}\n      `})),this.enqueueNotification(e),e[0]!==p.NotificationKind.setSchedulerFeatures&&e[0]!==p.NotificationKind.notifyWorkbookClosing||this.processNotifications()}enqueueNotification(e){const t=this.notificationQueue.length-1,r=this.notificationQueue[t];if(void 0===r)this.notificationQueue.push(e),u.ulsLogger.ULS.traceTag(512274757,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,_.x10Logger.formatLogMessage("FormulaBarScheduler.enqueueNotification",{description:`queue empty, notification of kind:\n         ${e[0]} pushed to queue\n        `}));else{const[n]=r,[i]=e;n===i&&!0===Y[n]?(this.notificationQueue[t]=e,u.ulsLogger.ULS.traceTag(512274756,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,_.x10Logger.formatLogMessage("FormulaBarScheduler.enqueueNotification",{description:`notification of kind:\n           ${e[0]} overrode previous notification\n          `}))):(this.notificationQueue.push(e),u.ulsLogger.ULS.traceTag(512274755,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,_.x10Logger.formatLogMessage("FormulaBarScheduler.enqueueNotification",{description:`couldn't coalesce, notification of kind:\n           ${e[0]} pushed to queue\n          `})))}}processNotifications(){for(const e of this.notificationQueue)u.ulsLogger.ULS.traceTag(512274754,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,_.x10Logger.formatLogMessage("FormulaBarScheduler.processNotifications",{description:`processing notification of kind:\n         ${e[0]}\n        `})),this.processNotification(e);this.notificationQueue.length=0}processNotification(e){const[t,r]=e;switch(this.notificationProcessorMap[t](...r),t){case p.NotificationKind.setA1ReferenceStyle:case p.NotificationKind.setLocale:case p.NotificationKind.setWorkbookProps:case p.NotificationKind.updateSheetNames:case p.NotificationKind.updateNamedObjects:case p.NotificationKind.setSchedulerFeatures:this.doNotifyStatefulSubject.next(e);break;default:this.doNotifyStatelessSubject.next(e)}}requestWithCorrelationId(...[e,t,r,n,i,o,a]){const s=this.timer.now(),l=this.responseStates[e][t];l.closeFrame(a,m.ExecutionStopReason.Frame.Superseded,s);const c=this.createPrefetchingCache(this.syncDataModel,i),d=this.computationResultWindows[e][t],g=l.createFrame(i,a,x.ExecutionType.Async,n,c,this.syncDataModel.config,s,d);0===this.responseStates[e][t].numComputations?(_.x10Logger.log({kind:"requestSkipped",payload:{computationKind:t,computationGroup:a}}),g.resolve({kind:"Done",payload:{kind:t,results:[]}})):_.x10Logger.log({kind:"beginRequest",payload:{correlationId:i,computationKind:t,computationGroup:a}});const p=l.computationFrame(a);return(0,u.assertTrue)("`frame` should be always defined at this point",void 0!==p),this.computationSubjects[e][r][t].next([p,o]),d.stopDelta<1/0&&this.enqueueMessage({kind:m.SchedulerTimelineQueueMessageKind.StopComputationFrame,correlationId:i,computationGroup:a,type:e,computationKind:t},s+d.stopDelta+J),this.requestWithCorrelationIdSubject.next([e,t,r,n,i,o,a]),g}syncRequestWithCorrelationId(e,t,r,n,i,o,a){const s=this.timer.now(),l=this.responseStates[e][t];l.closeFrame(a,m.ExecutionStopReason.Frame.Superseded,s);const c=this.createPrefetchingCache(this.syncDataModel,i),d=this.computationResultWindows[e][t],g=l.createFrame(i,a,x.ExecutionType.Sync,n,c,this.syncDataModel.config,s,d);_.x10Logger.log({kind:"beginRequest",payload:{correlationId:i,computationKind:t,computationGroup:a}});const p=l.computationFrame(a);(0,u.assertTrue)("`frame` should be always defined at this point",void 0!==p),this.computationSubjects[e][r][t].next([p,o]);const h=s+d.stopDelta+J,[f,S]=this.runToCompletion(c,this.syncDataModel.config,h);return l.closeFrame(a,f,this.timer.now()),g.resolve({kind:"Done",payload:{kind:t,results:[]}}),{kind:t,results:S}}runToCompletion(e,t,r){const n=[];let i=this.timer.now();for(let o=this.syncMessageQueue.pop();void 0!==o;o=this.syncMessageQueue.pop(),i=this.timer.now()){if(i>=r){o.computation.finalizer.finalize(o.computation,m.ExecutionStopReason.Frame.Timeout);break}let a;switch(o.kind){case m.SchedulerTimelineQueueMessageKind.StepComputation:{const{computation:e,payload:t}=o;try{const r=Z(e.generator,t);if(e.info.computationTime+=this.timer.now()-i,!0!==r.done){const t=r.value;this.syncMessageQueue.enqueue((0,k.wrapSyncRequest)(t,e))}else this.addResult(e.info,{kind:"Successful",message:r.value}),e.finalizer.finalize(e,m.ExecutionStopReason.Computation.Done),n.push([e.info.computationIdentifier,r.value])}catch(t){u.ulsLogger.ULS.traceTag(538581056,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Warning,_.x10Logger.formatLogMessage("FormulaBarScheduler.runToCompletion",{description:"plugin threw exception during computation",data:e.info})),e.finalizer.finalize(e,m.ExecutionStopReason.Computation.Exception)}}break;case m.SchedulerTimelineQueueMessageKind.NoOpRequest:case m.SchedulerTimelineQueueMessageKind.SyncRequest:const r=(0,P.processSyncRequest)(P.requestProcessorMap,o.request,o.computation,e,t);a=this.addProcessingTime(o.computation,o.request.kind,i),o.computation.info.schedulerTime+=a-i,r.kind===f.ResultKind.Success?this.syncMessageQueue.enqueue({kind:m.SchedulerTimelineQueueMessageKind.StepComputation,computation:o.computation,payload:{kind:k.InternalSchedulerResponseKind.NormalResponse,response:r.value}}):(_.x10Logger.log({kind:"failure",payload:{failureKind:_.X10FailureKind.RequestProcessorFailure,failureLevel:c.TraceLevel.Warning,path:"FormulaBarScheduler.runToCompletion",description:"request returned a scheduler-side failure",data:Object.assign(Object.assign({},o.computation.info),{failedRequest:o.request.kind})}}),this.syncMessageQueue.enqueue({kind:m.SchedulerTimelineQueueMessageKind.StepComputation,computation:o.computation,payload:{kind:k.InternalSchedulerResponseKind.RequestFailure,request:o.request.kind,failure:H.logSafeFailure.censored(r)}}));break;default:(0,u.assertNever)(`unknown message: ${o}`,o)}}return this.syncMessageQueue.clear(),[!(0,l.isDefined)(r)||i<r?m.ExecutionStopReason.Computation.Done:m.ExecutionStopReason.Frame.Timeout,n]}triggerEventImmediate(e,t){if(this.parent)return this.parent.triggerEventImmediate(e,t);this.triggerEvent(e,t)}triggerEvent(e,t){return this.processNotifications(),this.doRequestUntyped(K.ComputationType.Event,e,t,void 0,this.eventComputationGroupFactory.create().toString())}doRequest(e,t,r,n){return this.isEnabledProcessNotificationsAfterShouldRunPlugin&&!this.shouldRunRequest(K.ComputationType.UIMessage,e,t,r,x.ExecutionType.Async)?this.wrapResults(K.ComputationType.UIMessage,this.skippedRequest(e,n)):(this.processNotifications(),this.doRequestUntyped(K.ComputationType.UIMessage,e,t,r,n))}skippedRequest(e,t){_.x10Logger.log({kind:"requestSkipped",payload:{computationKind:e,computationGroup:t}});const r=new F.ResolvablePromise;return r.resolve({kind:"Done",payload:{kind:e,results:[]}}),r}wrapResults(e,t){return n.__awaiter(this,void 0,void 0,(function*(){const r=yield this.resolveConflicts(e,t);return"Superseded"===r.kind?r:Object.assign(Object.assign({},r),{payload:r.payload.result})}))}doRequestUntyped(e,t,r,i,o){return n.__awaiter(this,void 0,void 0,(function*(){const n=this.requestWithCorrelationId(e,t,x.ExecutionType.Async,r,this.idFactory.create(),i,o);return this.wrapResults(e,n)}))}doSyncRequest(e,t,r,n){return this.isEnabledProcessNotificationsAfterShouldRunPlugin&&!this.shouldRunRequest(K.ComputationType.UIMessage,e,t,r,x.ExecutionType.Sync)?this.wrapSyncResponse(K.ComputationType.UIMessage,this.skippedSyncRequest(e,n)):(this.processNotifications(),this.doSyncRequestUntyped(K.ComputationType.UIMessage,e,t,r,n))}skippedSyncRequest(e,t){return _.x10Logger.log({kind:"requestSkipped",payload:{computationKind:e,computationGroup:t}}),{kind:e,results:[]}}wrapSyncResponse(e,t){return this.syncResolveConflicts(e,t).result}doSyncRequestUntyped(e,t,r,n,i){let o;if(0===this.responseStates[e][t].numSyncComputations)o=this.skippedSyncRequest(t,i);else{const a=this.idFactory.create();o=this.syncRequestWithCorrelationId(e,t,x.ExecutionType.Sync,r,a,n,i)}return this.wrapSyncResponse(e,o)}resolveConflicts(e,t){return n.__awaiter(this,void 0,void 0,(function*(){const r=yield t;return"Superseded"===r.kind?r:{kind:"Done",payload:this.syncResolveConflicts(e,r.payload)}}))}syncResolveConflicts(e,t){const r=t.results.filter((([,e])=>(0,l.isDefined)(e)));return{kind:t.kind,result:this.conflictResolvers[e][t.kind](r)}}doBatchRequest(e,t,r){return n.__awaiter(this,void 0,void 0,(function*(){this.isEnabledProcessNotificationsAfterShouldRunPlugin||this.processNotifications();const n=this.idFactory.create(),i=R.customConflictResolverPluginKinds[e.strategy],o=C.customConflictResolverFactories[e.strategy].create(),a=i.map((()=>!0)),s=new F.ResolvablePromise;for(let l=0;l<i.length;l+=1){const u=i[l],m=e[u];let g;this.isEnabledProcessNotificationsAfterShouldRunPlugin&&!this.shouldRunRequest(K.ComputationType.UIMessage,u,m,t,x.ExecutionType.Async)?g=this.skippedRequest(u,null!=r?r:d.DefaultComputationGroup):(this.processNotifications(),g=this.requestWithCorrelationId(K.ComputationType.UIMessage,u,x.ExecutionType.Async,m,n,t,null!=r?r:d.DefaultComputationGroup)),this.resolveConflicts(K.ComputationType.UIMessage,g).then((e=>{if(a[l]=!1,"Superseded"===e.kind)s.resolve({kind:"Superseded"});else{const t=e.payload;o.consumeResult(t)}}),(()=>{_.x10Logger.log({kind:"failure",payload:{failureKind:_.X10FailureKind.CustomConflictResolverFailure,failureLevel:c.TraceLevel.Error,path:"FormulaBarScheduler.doBatchRequest",description:`Custom conflict resolver "${e.strategy}" got an exception for plugin kind "${u}". Skipping kind`}}),a[l]=!1,o.consumeResult({kind:u,result:null})}))}const l=(0,v.bindMaybeThenable)(o.promise,(e=>({kind:"Done",payload:e}))),u=yield Promise.race([s,l]);for(let e=0;e<i.length;e+=1){const t=i[e];a[e]&&(this.doNotify(p.NotificationKind.conflictResolverEarlyTermination,[n,null!=r?r:d.DefaultComputationGroup,t]),this.processNotifications())}return u}))}updatePrefetchingCache(e){var t;return n.__awaiter(this,void 0,void 0,(function*(){const r=this.createPrefetchingCache(this.syncDataModel,this.idFactory.create()),n=yield null===(t=e.cache)||void 0===t?void 0:t.getCorrespondingSnapshotID(),i=yield null==r?void 0:r.getCorrespondingSnapshotID();return i!==n?(e.cache=r,i):n}))}notifier(){return this.notifierObject}eventEmitter(){return this.eventEmitterObject}alAnnotationNotifier(){return this.alAnnotationNotifierObject}requester(){return this.requesterObject}syncRequester(){return this.syncRequesterObject}batchRequester(){return this.batchRequesterObject}setServerDataProvider(e){(0,l.isNone)(e)||(this.state=Object.assign(Object.assign({},this.state),{serverDataProvider:e}))}setActiveCellImpl(e){if((0,l.isNone)(e.docName)||(0,l.isNone)(e.sheetIndex))return void _.x10Logger.log({kind:"failure",payload:{failureKind:_.X10FailureKind.NotificationProcessorFailure,failureLevel:c.TraceLevel.Warning,path:"FormulaBarScheduler.setActiveCellImpl",description:"early exit, some of the arguments is None"}});const t=(0,i.documentLoc)(void 0,""),r=(0,i.unsafeGridRange)(e.rowIndex,e.colIndex,1,1),n=(0,i.sheetGridCell)((0,i.sheetIndex)(t,e.sheetIndex),r),o=re(e);this.state=Object.assign(Object.assign({},this.state),{activeCell:n,activeCellFormat:o}),u.ulsLogger.ULS.traceTag(512274752,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,_.x10Logger.formatLogMessage("setActiveCellImpl",{description:`updated activeCell to col: ${n.range.col}, row: ${n.range.row}`}))}setActiveCellFormatImpl(e){const t=re(e);this.state=Object.assign(Object.assign({},this.state),{activeCellFormat:t})}getConfig(){return this.syncDataModel.config}startComputation(e,t,r,n,i,o){switch(r){case x.ExecutionType.Async:this.enqueueMessage({kind:m.SchedulerTimelineQueueMessageKind.StepComputation,computation:Object.assign(Object.assign({},this.generateNewComputationInfo(e,t,n,o)),{generator:i}),payload:Q},o.startTime+o.timeWindow.startDelta);break;case x.ExecutionType.Sync:this.syncMessageQueue.enqueue({kind:m.SchedulerTimelineQueueMessageKind.StepComputation,computation:Object.assign(Object.assign({},this.generateNewComputationInfo(e,t,n,o)),{generator:i}),payload:Q});break;default:(0,u.assertNever)(`${r}`,r)}}generateNewComputationInfo(e,t,r,n){return{info:{correlationId:n.correlationId,computationGroup:n.computationGroup,type:e,computationKind:t,computationIdentifier:r,pluginFactoryNameString:$[r.factoryName],computationTime:0,schedulerTime:0,requestTimes:{}},cache:n.cache,finalizer:new w.ComputationFinalizer(...this.computationFinalizerHandlers),stopReasonRef:n.stopReasonRef,schedulerState:this.state,lastTimestamp:this.timer.now()}}getPluginComputations(e,t,r){var n,i,a;const s=h.pluginFactoryKindMap[t.factoryName],l={factoryName:t.factoryName,pluginName:null!==(n=t.pluginName)&&void 0!==n?n:o.PluginFactoryName[t.factoryName]},u=Object.assign(Object.assign({},l),{computationName:"run"}),c=h.pluginGroupMap[o.PluginGroup.Python][t.factoryName]?o.PluginGroup.Python:o.PluginGroup.Excel;return[...!0!==(null===(i=t.registryInitialized)||void 0===i?void 0:i.call(t))?[(0,B.wrapRegistration)(K.ComputationType.UIMessage,s,r,c,u,{},e.run.bind(e),((e,t)=>ee(K.ComputationType.UIMessage,s,u,t,e)))]:[],...!0===(null===(a=t.registryInitialized)||void 0===a?void 0:a.call(t))?U.computationRegistry.UIMessage.getRegistrationsByPluginIdentifier(l):[],...U.computationRegistry.Event.getRegistrationsByPluginIdentifier(l)]}createAndAttachPlugin(e,t){this.parent&&this.warmupParse.force();const r=e.create(t);for(const t of this.getPluginComputations(r,e,x.ExecutionType.Async))switch(t.type){case K.ComputationType.UIMessage:this.computationSubjects[t.type][t.execution][t.kind].subscribe(t.registrationMethod(this,r)),this.addToComputationCount(t);break;case K.ComputationType.Event:(0,G.isALAnnotationEventKind)(t.kind)&&this.registerALAnnotation(t.kind).catch((e=>{_.x10Logger.log({kind:"failure",payload:{failureKind:_.X10FailureKind.ALFailure,failureLevel:c.TraceLevel.Error,path:"FormulaBarScheduler.createAndAttachPlugin",description:`Failed to register on ${t.kind} AL annotation: ${e}`}})})),this.computationSubjects[t.type][t.execution][t.kind].subscribe(t.registrationMethod(this,r)),this.addToComputationCount(t);break;default:(0,u.assertNever)(`${t}`,t)}u.ulsLogger.ULS.traceTag(545378970,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,`x10arch.FormulaBarScheduler.createAndAttachPlugin: ${o.PluginFactoryName[e.factoryName]} was attached.`)}createAndAttachSyncPlugin(e,t){const r=e.create(t);for(const t of this.getPluginComputations(r,e,x.ExecutionType.Sync))switch(t.type){case K.ComputationType.UIMessage:this.computationSubjects[t.type][t.execution][t.kind].subscribe(t.registrationMethod(this,r)),this.responseStates[t.type][t.kind].attachSyncComputation(t.computationIdentifier);break;case K.ComputationType.Event:(0,G.isALAnnotationEventKind)(t.kind)&&this.registerALAnnotation(t.kind).catch((e=>{u.ulsLogger.ULS.traceTag(507802140,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Error,`x10arch.FormulaBarScheduler.createAndAttachSyncPlugin: Failed to register on ${t.kind} AL annotation: ${e}`)})),this.computationSubjects[t.type][t.execution][t.kind].subscribe(t.registrationMethod(this,r)),this.responseStates[t.type][t.kind].attachSyncComputation(t.computationIdentifier);break;default:(0,u.assertNever)(`${t}`,t)}u.ulsLogger.ULS.traceTag(538581058,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,`x10arch.FormulaBarScheduler.createAndAttachSyncPlugin: ${o.PluginFactoryName[e.factoryName]} was attached.`)}addToComputationCount(e){switch(this.parent&&this.parent.addToComputationCount({type:e.type,kind:e.kind,execution:e.execution,computationIdentifier:e.computationIdentifier}),e.execution){case x.ExecutionType.Async:this.responseStates[e.type][e.kind].attachComputation(e.computationIdentifier);break;case x.ExecutionType.Sync:this.responseStates[e.type][e.kind].attachSyncComputation(e.computationIdentifier)}}attachEventCallbacksManager(e){for(const t of G.ExternallyHandledEventKinds)(0,l.isDefined)(e[t])&&this.computationSubjects[K.ComputationType.Event][x.ExecutionType.Async][t].subscribe((([r,n])=>{try{e[t](r.computationInput)}catch(e){_.x10Logger.log({kind:"failure",payload:{failureKind:_.X10FailureKind.EventCallbacksManagerFailure,failureLevel:c.TraceLevel.Error,path:"FormulaBarScheduler.attachEventCallbacksManager",description:`Failed to call eventCallbacksManager.${t}: ${e}`}})}}))}registerEventCallback(e,t){return n.__awaiter(this,void 0,void 0,(function*(){const r=yield this.eventCallbackManagerCreated.getValue();(0,l.isDefined)(this.eventCallbackManagerAttachedPromise.getCurrentValue())||(this.eventCallbackManagerAttachedPromise.resolve(r),this.attachEventCallbacksManager(r)),r.registerEventCallback(e,t)}))}catchEvent(e){return new Promise(((t,r)=>{const n=this.computationSubjects[K.ComputationType.Event][x.ExecutionType.Async][e.eventKind].subscribe((([r,i])=>{(0,l.isDefined)(e.predicate)&&!e.predicate(r.computationInput)||(this.computationSubjects[K.ComputationType.Event][x.ExecutionType.Async][e.eventKind].unsubscribe(n),t((0,f.success)(r.computationInput)))}));this.enqueueMessage({kind:m.SchedulerTimelineQueueMessageKind.Timeout,type:K.ComputationType.Event,callback:()=>{this.computationSubjects[K.ComputationType.Event][x.ExecutionType.Async][e.eventKind].unsubscribe(n),t((0,f.failure)("Timeout"))}},this.timer.now()+e.timeout)}))}registerAsyncGrid(){this.recalcServiceAttachedPromise.resolve(void 0)}registerChatGPTProvider(e){const t=new M.ChatGPTService(e);return this.chatGPTProviderAttachedPromise.resolve(t)}registerALProvider(e){const t=new j.AugLoopService(e);return this.alManagerAttachedPromise.resolve(t)}registerALAnnotation(e){return n.__awaiter(this,void 0,void 0,(function*(){if(void 0!==this.parent)return this.parent.registerALAnnotation(e);let t;try{t=yield this.alManagerAttachedPromise}catch(e){return _.x10Logger.log({kind:"failure",payload:{failureKind:_.X10FailureKind.ALFailure,failureLevel:c.TraceLevel.Warning,path:"FormulaBarScheduler.registerALAnnotation",description:`Error getting AugLoopService: ${e}`}}),(0,f.failure)(e)}return t.registerALAnnotation(e)}))}registerTableIntelligenceProvider(e){this.tableIntelligenceServiceAttachedPromise.resolve(new q.X10TableIntelligenceService(e))}getRecognizedTablesInfo(...e){return n.__awaiter(this,void 0,void 0,(function*(){if((0,l.isDefined)(this.parent))return this.parent.getRecognizedTablesInfo(...e);const t=this.tableIntelligenceServiceAttachedPromise.getCurrentValue();return(0,l.isDefined)(t)?t.getRecognizedRangeTablesInfo(...e):(_.x10Logger.log({kind:"failure",payload:{failureKind:_.X10FailureKind.TableIntelligenceFailure,failureLevel:c.TraceLevel.Warning,path:"FormulaBarScheduler.getRecognizedTablesInfo",description:"tableIntelligenceService is not attached yet"}}),(0,f.failure)(void 0))}))}sendAugLoopSignal(e,t){return n.__awaiter(this,void 0,void 0,(function*(){if(void 0===this.parent){let r;try{r=yield this.alManagerAttachedPromise.toPromise()}catch(e){return _.x10Logger.log({kind:"failure",payload:{failureKind:_.X10FailureKind.ALFailure,failureLevel:c.TraceLevel.Warning,path:"FormulaBarScheduler.sendAugLoopSignal",description:`Error getting AugLoopService: ${e}`}}),(0,f.failure)(e)}return r.sendSignal(e,t)}return this.parent.sendAugLoopSignal(e,t)}))}augloopCloseCallback(){u.ulsLogger.ULS.traceTag(508629987,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"x10arch.FormulaBarScheduler.augloopCloseCallback: Got close callback from AugLoop Manager")}createChatGPTSession(e){return n.__awaiter(this,void 0,void 0,(function*(){return void 0===this.parent?(yield this.chatGPTProviderAttached()).createSession(e):this.parent.createChatGPTSession(e)}))}closeChatGPTSession(e){return n.__awaiter(this,void 0,void 0,(function*(){return void 0===this.parent?(yield this.chatGPTProviderAttached()).closeSession(e):this.parent.closeChatGPTSession(e)}))}sendChatGPTQuery(e,t){return n.__awaiter(this,void 0,void 0,(function*(){if(void 0===this.parent){const r=yield this.chatGPTProviderAttached(),n=yield r.request(e,t);return n.kind!==f.ResultKind.Success||(0,l.isDefined)(n.value)?((0,L.staticTypeHint)(n),n):(0,f.failure)(void 0)}return this.parent.sendChatGPTQuery(e,t)}))}shouldRunRequest(e,t,r,n,i){const o=this.responseStates[e][t],a=i===x.ExecutionType.Async?o.attachedComputations:o.attachedSyncComputations;for(const i of a)if(e!==K.ComputationType.UIMessage||ee(e,t,i,n,r))return!0;return!1}constructor(e,t,r=Object.assign({},b.defaultPluginResponseWindows),o,a,s=S.defaultTimerInterface,d){this.createPrefetchingCache=t,this.pluginResultWindows=r,this.gridDataSink=o,this.syncDataModel=a,this.timer=s,this.parent=d,this.responseStates=(0,L.mapFromArrayOfDependantPairs)((0,l.strEnumArray)(K.ComputationType).map((e=>[e,(0,L.mapFromArrayOfDependantPairs)((0,l.strEnumArray)(K.ComputationKinds[e]).map((t=>[t,new m.ResponseState(e,t)])))]))),this.uiMessages=(0,L.mapFromArrayOfDependantPairs)((0,l.strEnumArray)(K.ComputationKinds[K.ComputationType.UIMessage]).map((e=>[e,new D.Subject]))),this.syncUIMessages=(0,L.mapFromArrayOfDependantPairs)((0,l.strEnumArray)(K.ComputationKinds[K.ComputationType.UIMessage]).map((e=>[e,new D.Subject]))),this.eventHandlers=(0,L.mapFromArrayOfDependantPairs)((0,l.strEnumArray)(K.ComputationKinds[K.ComputationType.Event]).map((e=>[e,new D.Subject]))),this.conflictResolvers={[K.ComputationType.UIMessage]:y.conflictResolver,[K.ComputationType.Event]:(0,l.mapFromArrayOfPairs)((0,l.strEnumArray)(K.ComputationKinds[K.ComputationType.Event]).map((e=>[e,()=>{}])))},this.computationSubjects={[K.ComputationType.UIMessage]:{[x.ExecutionType.Async]:this.uiMessages,[x.ExecutionType.Sync]:this.syncUIMessages},[K.ComputationType.Event]:{[x.ExecutionType.Async]:this.eventHandlers}},this.syncMessageQueue=new N.PriorityQueue((()=>0)),this.doNotifyStatelessSubject=new D.Subject,this.doNotifyStatefulSubject=new D.InitializingSubject((()=>this.syncDataModel.getStateAsNotifications())),this.requestWithCorrelationIdSubject=new D.Subject,this.idFactory=new z,this.eventComputationGroupFactory=new z,this.state={scheduler:this},this.notificationProcessorMap={[p.NotificationKind.setActiveCell]:this.setActiveCellImpl.bind(this),[p.NotificationKind.setActiveCellFormat]:this.setActiveCellFormatImpl.bind(this),[p.NotificationKind.setA1ReferenceStyle]:this.syncDataModel.setA1ReferenceStyle.bind(this.syncDataModel),[p.NotificationKind.setLocale]:this.syncDataModel.setLocale.bind(this.syncDataModel),[p.NotificationKind.setWorkbookProps]:this.syncDataModel.setWorkbookProps.bind(this.syncDataModel),[p.NotificationKind.updateSheetNames]:this.syncDataModel.updateSheetNames.bind(this.syncDataModel),[p.NotificationKind.updateNamedObjects]:this.syncDataModel.updateNamedObjects.bind(this.syncDataModel),[p.NotificationKind.doNothing]:()=>{},[p.NotificationKind.writeRange]:(...e)=>{var t;return null===(t=this.gridDataSink)||void 0===t?void 0:t.writeRange(...e)},[p.NotificationKind.setNumberFormats]:(...e)=>{var t;return null===(t=this.gridDataSink)||void 0===t?void 0:t.setNumberFormats(...e)},[p.NotificationKind.setFunctionsInfo]:this.setFunctionInfo.bind(this),[p.NotificationKind.conflictResolverEarlyTermination]:(e,t,r)=>this.stopComputationFrame(e,t,K.ComputationType.UIMessage,r,m.ExecutionStopReason.Frame.ConflictResolverEarlyTermination),[p.NotificationKind.setDefinedNamesInfo]:this.setDefinedNamesInfo.bind(this),[p.NotificationKind.notifyWorkbookClosing]:this.onWorkbookClosing.bind(this),[p.NotificationKind.setSchedulerFeatures]:this.syncDataModel.setSchedulerFeatures.bind(this.syncDataModel)},this.notifierObject=(0,g.makeNotifier)(this),this.eventEmitterObject=(0,V.makeEventEmitter)(this),this.alAnnotationNotifierObject=(0,W.makeALAnnotationNotifier)(this),this.requesterObject=(0,m.makeRequester)(this),this.syncRequesterObject=(0,m.makeSyncRequester)(this),this.batchRequesterObject=(0,R.makeBatchRequester)(this),this.notificationQueue=[],this.isEnabledProcessNotificationsAfterShouldRunPlugin=(0,I.isTypedChangeGateEnabled)("OfficeVSO:8579351_x10ProcessNotificationsAfterShouldRunPlugin"),this.x10GetNumOfComputationsFromFrameEnabled=(0,I.isTypedChangeGateEnabled)("OfficeVSO:8557722_x10GetNumOfComputationsFromFrame"),this.eventResultWindows=(0,l.mapFromArrayOfPairs)((0,l.strEnumArray)(K.ComputationKinds[K.ComputationType.Event]).map((e=>[e,{startDelta:0,stopDelta:1/0}]))),this.computationResultWindows={[K.ComputationType.UIMessage]:this.pluginResultWindows,[K.ComputationType.Event]:this.eventResultWindows},this.recalcServiceAttachedPromise=new F.ResolvablePromise,this.chatGPTProviderAttachedPromise=new F.ResolvablePromise,this.alManagerAttachedPromise=new F.ResolvablePromiseWithTimeout(3e5,this.timer),this.tableIntelligenceServiceAttachedPromise=new F.ResolvablePromiseWithSyncValue,this.eventCallbackManagerAttachedPromise=new F.ResolvablePromiseWithSyncValue,this.eventCallbackManagerCreated=(0,A.asyncLazy)(G.makeEventCallbacksManager),this.computationFinalizerHandlers=[te],this.warmupParse=(0,A.asyncLazy)((()=>n.__awaiter(this,void 0,void 0,(function*(){const e=this.createPrefetchingCache(this.syncDataModel,-1);if(e){const t=(0,i.documentLoc)(void 0,""),r=(0,i.sheetGridCell)((0,i.sheetIndex)(t,0),(0,i.gridCell)(1,1));e.parseEditSync(r,"=sum(5,7)",{formatString:"'GENERAL",builtIn:!0})}})))),u.ulsLogger.ULS.traceTag(537796811,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,_.x10Logger.formatLogMessage("excelOnlineCalcPackages",{description:`${(0,O.getExcelOnlineCalcNewPackagesNames)()}`})),this.processor=e(this.consumeMessage.bind(this)),this.alManagerAttachedPromise.toPromise().catch((()=>{}))}}function Z(e,t){switch(t.kind){case k.InternalSchedulerResponseKind.FirstStep:return e.next();case k.InternalSchedulerResponseKind.NormalResponse:return e.next(t.response);case k.InternalSchedulerResponseKind.RequestFailure:return e.throw({kind:t.failure.kind,request:t.request,reason:t.failure.reason});default:(0,u.assertNever)("x10arch: FormulaBarScheduler.stepPlugin: unknown payload",t)}}function ee(e,t,r,n,i){var a;const s=null!==(a=U.computationRegistry[e].getRegistrationsByComputationIdentifier(r))&&void 0!==a?a:{type:e,kind:t,modifiers:{},pluginGroup:n&&!0===h.pluginGroupMap[n][r.factoryName]?n:o.PluginGroup.Excel};return(0,U.getShouldRunComputationPredicate)(s)(i,n)}function te(e){_.x10Logger.log({kind:"computationStoppedExecution",payload:{computationName:`${e.computationInfo.pluginFactoryNameString}.${e.computationInfo.computationIdentifier.computationName}`,stopReason:e.stopReason,logInfo:e.computationInfo}}),e.stopReason===m.ExecutionStopReason.Computation.Done&&_.x10Logger.log({kind:"pluginCompletedInTime",payload:{pluginName:e.computationInfo.pluginFactoryNameString,logInfo:e.computationInfo}})}function re(e){let t=null;return(0,l.isNone)(e.formatString)||(0,l.isNone)(e.builtIn)||(t={formatString:e.formatString,builtIn:e.builtIn}),t}t.FormulaBarScheduler=X,X.abstractStepCosts={[m.SchedulerTimelineQueueMessageKind.NoOpRequest]:.01,[m.SchedulerTimelineQueueMessageKind.AsyncRequest]:.1,[m.SchedulerTimelineQueueMessageKind.SyncRequest]:.5,[m.SchedulerTimelineQueueMessageKind.StepComputation]:1,[m.SchedulerTimelineQueueMessageKind.StopComputationFrame]:.01,[m.SchedulerTimelineQueueMessageKind.Timeout]:.01},t.shouldRunComputation=ee},40088:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeCalcGrid=void 0;const n=r(63019),i=r(17338),o=r(92383),a=()=>{};t.makeCalcGrid=function(e=n.defaultSetTimeoutInterface){return new i.RecalcServiceImpl(a,a,a,a,(0,o.asyncLoopFactory)((0,o.delayPromiseImpl)(e)))}},38869:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GridImportManager=t.GridProvider=void 0;const n=r(19181),i=n.__importStar(r(66932)),o=r(91709),a=r(43512),s=r(83567),l=r(85270);function u(e,t,r){const{port1:n,port2:i}=new MessageChannel;Promise.all([e.createIGridImportEndpoint({port:i,options:r}),t.createIGridExportEndpoint({port:n,options:r},(()=>e.onGridExporterClosed()))]).catch((t=>{s.x10Logger.log({kind:"failure",payload:{failureKind:s.X10FailureKind.GridFailure,failureLevel:a.TraceLevel.Warning,path:"gridProvider.connectGridImporterExporter",description:(0,o.messageFromError)(t)}});try{e.onGridExporterClosed()}catch(t){s.x10Logger.log({kind:"failure",payload:{failureKind:s.X10FailureKind.GridFailure,failureLevel:a.TraceLevel.Warning,path:"gridProvider.connectGridImporterExporter",description:`${s.X10FailureKind.GridFailure}: importer threw ${(0,o.messageFromError)(t)}`}})}}))}t.GridProvider=class{getGrid(){var e;return null===(e=this.gridService)||void 0===e?void 0:e.call}createIGridImportEndpoint(e){return n.__awaiter(this,void 0,void 0,(function*(){this.onGridExporterClosed();const t=yield i.Endpoint.createOutside(e,(e=>{this.gridService={call:void 0,close:()=>e.close("Force")}}));t.hasBeenClosed()||(this.gridService=t,this.onGridReady(this.gridService.call))}))}onGridExporterClosed(){if(!this.gridService)return;const e=this.gridService;this.gridService=void 0,e.close()}constructor(e){this.onGridReady=e,this.gridService=void 0,this.syncDataModel=new l.SyncDataModel,this.getGridDataSink=()=>{},this.getSyncDataModel=()=>this.syncDataModel}},t.GridImportManager=class{onGridExporterCreated(e){this.exporter=e;for(const{importer:t,id:r}of this.importers)u(t,e,{id:r,createTimeout:this.timeout})}onGridImporterCreated(e,t){this.importers.push({importer:e,id:t}),this.exporter&&u(e,this.exporter,{id:t,createTimeout:this.timeout})}constructor(e){this.timeout=e,this.exporter=void 0,this.importers=[]}}},83781:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapIntoResumeRecalc=t.emptyRangeValue=t.emptyRangeFormula=t.emptyRangeFormat=t.FormulaKind=void 0;const n=r(90277);t.FormulaKind=n.gridinterface.FormulaKind,t.emptyRangeFormat=n.gridinterface.emptyRangeFormat,t.emptyRangeFormula=n.gridinterface.emptyRangeFormula,t.emptyRangeValue=n.gridinterface.emptyRangeValue,t.wrapIntoResumeRecalc=n.gridinterface.wrapIntoResumeRecalc},11351:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.spanCompare=t.spanToLSPRange=t.indexToLSPPosition=t.Timeline=void 0;const n=r(90277);t.Timeline=n.helpers.Timeline,t.indexToLSPPosition=n.helpers.indexToLSPPosition,t.spanToLSPRange=n.helpers.spanToLSPRange,t.spanCompare=n.helpers.spanCompare},6529:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createIEEE754Double=void 0;const r=new ArrayBuffer(8),n=new Uint32Array(r),i=new Float64Array(r),o=1===new Uint8Array(new Uint16Array([1]).buffer)[0],[a,s]=o?[0,1]:[1,0];t.createIEEE754Double=function({lowDword:e,highDword:t}){return n[a]=e,n[s]=t,i[0]}},32612:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setMockGridSheetAndNotify=t.createMockGridExporter=t.createMockGridProvider=t.createConstGridProvider=t.createMockAsyncGrid=t.MockAsyncGrid=void 0;const n=r(19181),i=r(40088),o=n.__importStar(r(7793)),a=r(72959),s=r(31053),l=r(83781),u=r(55340),c=n.__importStar(r(66932)),d=r(57264),m=r(85304),g=r(94746),p=r(83079),h=r(20429),f=r(85270);function S(e){if("object"==typeof e)switch(e.kind){case"Blank":return"";case"Error":return(0,u.getEnglishLocaleInfo)().errorNames[e.type];case"Rich":return"rich value formulaBarText"}return e.toString()}class v extends((0,a.wrapIntoAsyncClass)()(["getRangeFormats","getRangeFormulae","getRangeValues","getSheetNames","getIformats","discardSnapshot","getHiddenRows","getHiddenCols","evalClonedModelOnSnapshot","evalFormulaOnSnapshot","getCorrespondingSnapshotID","getIntersectingTables"])){get calcConfig(){return this.calcGrid.dataModel.getDocs().config}reconfigure(e){return this.calcGrid.reconfigure(e)}setRange(e,t,r,n,i){var a,l,u,c;const d=o.documentLoc(void 0,""),m=o.sheetIndex(d,e),g=[];for(let e=0;e<r.length;e+=1){const o=r[e];if(void 0!==o)for(let r=0;r<o.length;r+=1){const d=o[r];if(void 0===d)continue;const p=(0,s.sheetRangeLocation)(m.index,t.firstRow+e,t.firstColumn+r),f=null!==(l=null===(a=null==i?void 0:i[e])||void 0===a?void 0:a[r])&&void 0!==l?l:S(d),v=null!==(c=null===(u=null==n?void 0:n[e])||void 0===u?void 0:u[r])&&void 0!==c?c:h.KnownFormat.General;f.startsWith("=")?g.push((0,s.rangeWrite)(p,(0,s.cellFormulaCellData)(f,d,v))):g.push((0,s.rangeWrite)(p,(0,s.valueCellData)(f,d,v)))}}this.calcGrid.updateRanges(0,[(0,s.rangeWrite)((0,s.sheetRangeLocation)(m.index,t.firstRow,t.firstColumn,t.lastRow,t.lastColumn)),...g]),this.runTasks()}setSheet(e,t,r,n){const i=o.documentLoc(void 0,""),a=o.sheetIndex(i,e);(0,d.assertTrue)(`Sheet having sheetId ${e} is already in the mock workbook`,!this.sheetNames.some((({sheetId:t})=>t===e))),this.sheetNames.push((0,s.sheetName)(a.index,t)),this.calcGrid.updateSheetNames(0,this.sheetNames),this.setRange(e,{firstRow:0,firstColumn:0,lastRow:0,lastColumn:0},r,n)}setNamedObjects(e){this.calcGrid.updateNamedObjects(0,e),this.runTasks()}runTasks(){for(;!this.calcGrid.dataModel.step().queueEmpty;);}constructor(){const e=(0,i.makeCalcGrid)();e.dataModel.setNumberFormats(e.document,p.knownFormatData,!1,-1/0),super(new g.RecalcSideGrid(e)),this.sheetNames=[],this.calcGrid=e,this.document=e.document}}function y(e,t,r){return{getGrid:()=>e,getGridDataSink:()=>t,getSyncDataModel:()=>r}}t.MockAsyncGrid=v,t.createMockAsyncGrid=function(){const e=new v;return Object.assign(Object.assign({},(0,l.wrapIntoResumeRecalc)(e,(()=>e.calcGrid.resumeRecalc()))),{setSheet:e.setSheet.bind(e),setRange:e.setRange.bind(e),setNamedObjects:e.setNamedObjects.bind(e),document:e.document,reconfigure:e.reconfigure.bind(e),calcConfig:e.calcConfig})},t.createConstGridProvider=y,t.createMockGridProvider=e=>y(e,void 0,new f.SyncDataModel),t.createMockGridExporter=function(e){return{createIGridExportEndpoint(t){return n.__awaiter(this,void 0,void 0,(function*(){yield c.Endpoint.createInside(t,(()=>e))}))}}},t.setMockGridSheetAndNotify=function(e,t,r,n,i,o=0){r.setSheet(e,t,n);const a={sheetId:e,sheetName:t};i.doNotify(m.NotificationKind.updateSheetNames,[o,[a]])}},14865:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MockTimerImmediate=t.MockTimer=void 0;const n=r(90277);t.MockTimer=n.mockTimer.MockTimer,t.MockTimerImmediate=n.mockTimer.MockTimerImmediate},68485:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NaiveLocalSheetGrid=void 0;const n=r(12450),i=r(33436),o=r(7793),a=r(50338),s=r(83781),l=r(25201),u=r(83102),c=r(20456),d=r(73693),m=r(57264);class g{static buildSparseMatrix(e,t){const r=[];for(const[[n,i,o=1,a=1],...s]of e){const e=s.length;for(let l=i,u=0;l<i+a;l+=1)for(let i=n;i<n+o;i+=1,u=(u+1)%e)void 0===r[i]&&(r[i]=[]),r[i][l]=t(s[u],i,l)}return r}static forEachInSparseMatrix(e,t,r=(()=>!1)){let n=!0;return e.forEach(((e,i)=>{n&&e.forEach(((e,a)=>{n&&!r(e)&&(t((0,o.gridCell)(i,a),e)||(n=!1))}))})),n}static unionRanges(e){return e.map(l.createCellSetFromRange).reduce(u.unionProduct,c.empty)}getCellValue(e,t){return this.isAvailable(e,t,"value")?void 0!==this.values&&void 0!==this.values[e]&&void 0!==this.values[e][t]?(0,i.success)(this.values[e][t]):(0,i.success)(s.emptyRangeValue):(0,i.failure)((0,a.unavailable)(["getCellValue"]))}getCellFormat(e,t){return this.isAvailable(e,t,"format")?void 0!==this.formats&&void 0!==this.formats[e]&&void 0!==this.formats[e][t]?(0,i.success)(this.formats[e][t]):(0,i.success)(s.emptyRangeFormat):(0,i.failure)((0,a.unavailable)(["getCellFormat"]))}getCellFormula(e,t){return this.isAvailable(e,t,"formula")?void 0!==this.formulae&&void 0!==this.formulae[e]&&void 0!==this.formulae[e][t]?(0,i.success)(this.formulae[e][t]):(0,i.success)(s.emptyRangeFormula):(0,i.failure)((0,a.unavailable)(["getCellFormula"]))}foreachNonBlankCellValue(e){return void 0===this.values||g.forEachInSparseMatrix(this.values,e,(e=>e.kind===d.OperKind.Blank))}foreachNonBlankCellFormula(e){return void 0===this.formulae||g.forEachInSparseMatrix(this.formulae,e,(e=>e.kind===s.emptyRangeFormula.kind&&e.formulaBarText===s.emptyRangeFormula.formulaBarText))}isAvailable(e,t,r){var n;let i;switch(r){case"value":i=this.valueAvailabilitySet;break;case"formula":i=this.formulaAvailabilitySet;break;case"format":i=this.formatAvailabilitySet;break;default:(0,m.assertNever)("isAvailable",r)}return void 0!==i&&(null!==(n=(0,u.compareProduct)((0,l.createCellSetFromRange)((0,o.gridCell)(e,t)),i))&&void 0!==n?n:1)<=0}constructor(e,t,r,n){this.formats=void 0,this.values=void 0,this.formulae=void 0,this.valueAvailabilitySet=void 0,this.formatAvailabilitySet=void 0,this.formulaAvailabilitySet=void 0,(0,i.isSuccess)(t)&&(this.values=g.buildSparseMatrix(t.value.nonEmptyCells,(e=>e)),this.valueAvailabilitySet=g.unionRanges(t.value.availableRanges)),(0,i.isSuccess)(n)&&(this.formats=g.buildSparseMatrix(n.value.nonEmptyCells,(e=>e)),this.formatAvailabilitySet=g.unionRanges(n.value.availableRanges)),(0,i.isSuccess)(r)&&(this.formulae=g.buildSparseMatrix(r.value.nonEmptyCells,(e=>e)),this.formulaAvailabilitySet=g.unionRanges(r.value.availableRanges))}}t.NaiveLocalSheetGrid=g,(0,n.staticAssertExtends)()},85304:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationKind=void 0;const n=r(90277);t.NotificationKind=n.notificationKinds.NotificationKind},24002:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeNotifier=void 0;const n=r(12450),i=r(12450),o=r(85304),a=r(84565),s=r(84565),l=r(92637);(0,i.staticAssertExtends)(),(0,i.staticAssertExtends)(),(0,i.staticAssertExtends)();const u=[o.NotificationKind.conflictResolverEarlyTermination],c=(0,n.strEnumArray)(o.NotificationKind).filter((function(e){return u.findIndex((t=>t===e))<0}));t.makeNotifier=function(e){const t=e.doNotify.bind(e),r=(0,s.functionMapFromDUFunction)(t,c),n=(0,s.bindMethodsUnbox)(r,c),i=(0,s.bindMethodsNullCheck)(n,c),u=Object.assign(Object.assign({},i),{[o.NotificationKind.notifyWorkbookClosing]:()=>n.notifyWorkbookClosing()});return d=u,m=l.notificationMethodArgumentsConvertorsMap,(0,a.mapFromArrayOfDependantPairs)(c.map((e=>[e,(...t)=>d[e](...m[e](...t))])));var d,m}},92637:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notificationMethodArgumentsConvertorsMap=void 0;const n=r(85304),i=r(94470),o=r(20429),a=r(91709),s=r(3895),l=r(12450),u=r(6529),c=(...e)=>e,d=e=>{if("NamedValue"===(null==e?void 0:e.kind))switch(e.value.kind){case"Number":return Object.assign(Object.assign({},e),{value:e.value.numberValue});case"String":return Object.assign(Object.assign({},e),{value:e.value.stringValue});case"Boolean":return Object.assign(Object.assign({},e),{value:e.value.booleanValue});case"Error":return Object.assign(Object.assign({},e),{value:e.value})}return e},m=[[s.ErrorType.NULL,e=>0===e],[s.ErrorType.DIV0,e=>7===e],[s.ErrorType.VALUE,e=>15===e||53===e],[s.ErrorType.REF,e=>23===e],[s.ErrorType.NAME,e=>29===e],[s.ErrorType.NUM,e=>36===e],[s.ErrorType.NA,e=>42===e],[s.ErrorType.GETTING_DATA,e=>43===e],[s.ErrorType.SPILL,e=>45===e],[s.ErrorType.CONNECT,e=>46===e],[s.ErrorType.BLOCKED,e=>47===e],[s.ErrorType.UNKNOWN,e=>48===e],[s.ErrorType.FIELD,e=>49===e],[s.ErrorType.CALC,e=>50===e],[s.ErrorType.BUSY,e=>51===e||52===e||54===e],[s.ErrorType.EXTERNAL,()=>!1]];function g(e){switch(e.kind){case"error":for(const[t,r]of m)if(r(e.errorValue))return{kind:"error",errorKind:t};return{kind:"error",errorKind:void 0};case"number":return{kind:"number",value:(0,u.createIEEE754Double)(e)};default:return e}}(0,l.staticAssertSame)(),t.notificationMethodArgumentsConvertorsMap={[n.NotificationKind.doNothing]:c,[n.NotificationKind.setActiveCell]:c,[n.NotificationKind.setActiveCellFormat]:c,[n.NotificationKind.setFunctionsInfo]:c,[n.NotificationKind.setDefinedNamesInfo]:c,[n.NotificationKind.notifyWorkbookClosing]:c,[n.NotificationKind.setSchedulerFeatures]:c,[n.NotificationKind.setA1ReferenceStyle]:c,[n.NotificationKind.setWorkbookProps]:c,[n.NotificationKind.updateSheetNames]:c,[n.NotificationKind.writeRange]:(e,t)=>[e,Object.assign(Object.assign({},t),{values:t.values.map((e=>e.map(g)))})],[n.NotificationKind.setLocale]:(...e)=>{const[t]=e;return[Object.assign(Object.assign({},t),{specialRefNames:(0,a.partialArray)({[i.SpecialRefId.All]:t.specialRefNames.All,[i.SpecialRefId.Data]:t.specialRefNames.Data,[i.SpecialRefId.Headers]:t.specialRefNames.Headers,[i.SpecialRefId.ThisRow]:t.specialRefNames.ThisRow,[i.SpecialRefId.Totals]:t.specialRefNames.Totals}),currencyFormat:o.CurrencyFormat[t.currencyFormat],dateOrder:o.DateOrder[t.dateOrder],timeAltSeparator:t.timeAltSeparator,ampmSymbols:[t.ampmSymbols.first,t.ampmSymbols.second]})]},[n.NotificationKind.updateNamedObjects]:(...e)=>{const[t,r]=e;return[t,r.map((e=>{var t;return Object.assign(Object.assign({},e),{scope:e.scope,objects:null===(t=e.objects)||void 0===t?void 0:t.map((e=>{var t;return Object.assign(Object.assign({},e),{data:d(null!==(t=e.data)&&void 0!==t?t:void 0)})})),fromStateId:e.fromStateId})}))]},[n.NotificationKind.setNumberFormats]:c}},58535:function(e,t){"use strict";var r;if(Object.defineProperty(t,"__esModule",{value:!0}),t.platform=void 0,t.platform=null!==(r=globalThis.__x10_target_platform)&&void 0!==r?r:"Web",["Web","Win32"].indexOf(t.platform)<0)throw new Error(`Wrong platform id ${t.platform}`);globalThis.__x10_target_platform=t.platform},78469:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProcessNonFormulaCells=t.getFormulaContent=t.isFormulaRequest=t.pluginGroupMap=t.pluginGroupOptInDefault=t.registerPluginFactory=t.getPluginFactory=t.pluginFactoryKindMap=void 0;const n=r(18538),i=r(55340),o=r(12450),a=r(12450),s=r(50111),l=r(42549),u=r(83567),c=r(84565);t.pluginFactoryKindMap={[n.PluginFactoryName.TestPlugin]:s.RequestKind.runTest,[n.PluginFactoryName.PythonTestPlugin]:s.RequestKind.runTest,[n.PluginFactoryName.AutocompletePlugin]:s.RequestKind.functionSuggestion,[n.PluginFactoryName.AutocompleteRangeSuggestionPlugin]:s.RequestKind.inCellSuggestion,[n.PluginFactoryName.DragPlugin]:s.RequestKind.functionSuggestion,[n.PluginFactoryName.ConfigTestPlugin]:s.RequestKind.runTest,[n.PluginFactoryName.FeatureGateTestPlugin]:s.RequestKind.runTest,[n.PluginFactoryName.ChangeGateTestPlugin]:s.RequestKind.runTest,[n.PluginFactoryName.ArgumentAssistancePlugin]:s.RequestKind.argumentAssistance,[n.PluginFactoryName.FormulaRepairShadowEvalPlugin]:s.RequestKind.runAuthoringExperiment,[n.PluginFactoryName.FormulaCollectionPlugin]:s.RequestKind.functionSuggestion,[n.PluginFactoryName.DNMTraceTagTestPlugin]:s.RequestKind.runTest,[n.PluginFactoryName.AutocompleteWrapperPlugin]:s.RequestKind.runPerCharacterExperiment,[n.PluginFactoryName.AutocompleteBinaryModelExperimentPlugin]:s.RequestKind.runAuthoringExperiment,[n.PluginFactoryName.ParenthesesCouplingPlugin]:s.RequestKind.formulaHighlighting,[n.PluginFactoryName.ColoredReferencesPlugin]:s.RequestKind.formulaHighlighting,[n.PluginFactoryName.SlowTestPlugin]:s.RequestKind.functionSuggestion,[n.PluginFactoryName.EvalOnCloneTestPlugin]:s.RequestKind.runTest,[n.PluginFactoryName.EvalFormulaTestPlugin]:s.RequestKind.runTest,[n.PluginFactoryName.AutocompleteFunctionPlugin]:s.RequestKind.functionSuggestion,[n.PluginFactoryName.AutocompleteEnumPlugin]:s.RequestKind.functionSuggestion,[n.PluginFactoryName.AutocompleteLetPlugin]:s.RequestKind.functionSuggestion,[n.PluginFactoryName.AutocompleteRichValuePlugin]:s.RequestKind.functionSuggestion,[n.PluginFactoryName.AutocompleteNamedObjectsPlugin]:s.RequestKind.functionSuggestion,[n.PluginFactoryName.ParserPerformanceMeasurements]:s.RequestKind.runExperiment,[n.PluginFactoryName.AutocompleteTableHeadersPlugin]:s.RequestKind.functionSuggestion,[n.PluginFactoryName.PythonAutocompletePlugin]:s.RequestKind.functionSuggestion,[n.PluginFactoryName.ValuePreviewPlugin]:s.RequestKind.valuePreview,[n.PluginFactoryName.GotoCtrlClickPlugin]:s.RequestKind.gotoCtrlClick,[n.PluginFactoryName.SyntaxErrorsPlugin]:s.RequestKind.formulaRepair,[n.PluginFactoryName.ChatGPTPlugin]:s.RequestKind.chatGPTQuery,[n.PluginFactoryName.EventsTestPlugin]:s.RequestKind.runTest,[n.PluginFactoryName.FormulaByExamplePlugin]:s.RequestKind.columnFormulaSuggestion,[n.PluginFactoryName.SetCellPrefetchPlugin]:s.RequestKind.setCellPrefetch,[n.PluginFactoryName.FormulaTranspilerPlugin]:s.RequestKind.getTranspiledFormulas},(0,a.staticAssertExtends)(),(0,a.staticAssertExtends)(),(0,a.staticAssertExtends)(),n.PluginFactoryName.ParenthesesCouplingPlugin,s.SchedulerVersionCompatibility.SyncOnly,n.PluginFactoryName.ColoredReferencesPlugin,s.SchedulerVersionCompatibility.SyncOnly,(0,a.staticAssertExtends)(),(0,o.staticAssertSame)(),(0,a.staticAssertExtends)();const d=(0,a.makeStringMap)();t.getPluginFactory=function(e){const t=d[e];if(!t){const t=u.x10Logger.formatLogMessage("getPluginFactory",{description:`${n.PluginFactoryName[e]} has not been registered`});throw u.x10Logger.log({kind:"failure",payload:{failureKind:u.X10FailureKind.PluginAttachmentFailure,failureLevel:i.TraceLevel.Error,path:"pluginFactory.getPluginFactory",description:`${n.PluginFactoryName[e]} has not been registered`}}),new Error(t)}return t},t.registerPluginFactory=function(e){const t=e.factoryName,r=d[t];if(void 0!==r&&r!==e){const e=u.x10Logger.formatLogMessage("registerPluginFactory",{description:`${n.PluginFactoryName[t]} is already registered`});if(u.x10Logger.log({kind:"failure",payload:{failureKind:u.X10FailureKind.PluginAttachmentFailure,failureLevel:i.TraceLevel.Error,path:"pluginFactory.registerPluginFactory",description:`${n.PluginFactoryName[t]} is already registered`}}),!(0,l.getTypedFeatureGate)("Microsoft.Office.Excel.x10DoNotThrowOnDoublePluginRegistration"))throw new Error(e)}d[t]=e,u.x10Logger.log({kind:"registerPluginFactory",payload:{factoryName:t}})},t.pluginGroupOptInDefault={[n.PluginGroup.Excel]:!0,[n.PluginGroup.Python]:!1},(0,a.staticAssertExtends)(),t.pluginGroupMap={[n.PluginGroup.Excel]:{[n.PluginFactoryName.PythonTestPlugin]:!1,[n.PluginFactoryName.PythonAutocompletePlugin]:!1},[n.PluginGroup.Python]:{[n.PluginFactoryName.PythonTestPlugin]:!0,[n.PluginFactoryName.PythonAutocompletePlugin]:!0}},o.staticAssertSame;const m={[s.RequestKind.functionSuggestion]:"content",[s.RequestKind.inCellSuggestion]:"content",[s.RequestKind.formulaHighlighting]:"content",[s.RequestKind.argumentAssistance]:"content",[s.RequestKind.valuePreview]:"text",[s.RequestKind.runAuthoringExperiment]:"content",[s.RequestKind.runPerCharacterExperiment]:"content",[s.RequestKind.formulaRepair]:"formula",[s.RequestKind.gotoCtrlClick]:"text",[s.RequestKind.columnFormulaSuggestion]:void 0,[s.RequestKind.setCellPrefetch]:void 0,[s.RequestKind.runExperiment]:void 0,[s.RequestKind.runTest]:void 0,[s.RequestKind.chatGPTQuery]:void 0,[s.RequestKind.getTranspiledFormulas]:void 0};t.isFormulaRequest=function(e){return void 0!==m[e]},t.getFormulaContent=function(e){const t=m[e[0]];(0,c.staticTypeHint)(t);const r=e[1][t];return(0,c.staticTypeHint)(r),r},t.ProcessNonFormulaCells={[n.PluginFactoryName.TestPlugin]:!0,[n.PluginFactoryName.ParserPerformanceMeasurements]:!0,[n.PluginFactoryName.ConfigTestPlugin]:!0,[n.PluginFactoryName.FeatureGateTestPlugin]:!0,[n.PluginFactoryName.DNMTraceTagTestPlugin]:!0,[n.PluginFactoryName.ChangeGateTestPlugin]:!0,[n.PluginFactoryName.SlowTestPlugin]:!0,[n.PluginFactoryName.EvalOnCloneTestPlugin]:!0,[n.PluginFactoryName.EvalFormulaTestPlugin]:!0,[n.PluginFactoryName.PythonTestPlugin]:!0,[n.PluginFactoryName.ChatGPTPlugin]:!0,[n.PluginFactoryName.EventsTestPlugin]:!0,[n.PluginFactoryName.FormulaByExamplePlugin]:!0,[n.PluginFactoryName.SetCellPrefetchPlugin]:!0,[n.PluginFactoryName.FormulaTranspilerPlugin]:!0}},59898:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensureGroupAttachedLegacy=t.ensureGroupAttached=t.ensurePluginAttached=t.setX10Features=t.ensurePluginAttachedLegacy=t.resolveScriptLoaderPromise=void 0;const n=r(19181),i=r(42549),o=r(77114),a=r(20191),s=r(60111),l=r(29712),u=r(67031),c=r(48006),d=r(17366),m=r(7782),g=r(40541),p=r(34059),h=r(88470),f=r(30887),S=r(45642),v=r(73586),y=r(18368),F=r(55340),C=r(12450),R=r(83567),b=r(59416),E=r(85304),T=r(18538),k=r(80773),P=r(58535),N={Web:{[T.PluginFactoryName.ArgumentAssistancePlugin]:[o.argumentAssistancePluginDependenciesResolved,void 0,void 0,"ArgumentAssistance"],[T.PluginFactoryName.AutocompletePlugin]:[a.autocompletePluginDependenciesResolved,void 0,void 0,"SmartSuggestionsAutoComplete"],[T.PluginFactoryName.AutocompleteFunctionPlugin]:[l.autocompleteFunctionPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],[T.PluginFactoryName.ParenthesesCouplingPlugin]:[c.parenthesesCouplingPluginDependenciesResolved,void 0,void 0,"ParenthesisCoupling"],[T.PluginFactoryName.ColoredReferencesPlugin]:[d.coloredReferencesPluginDependenciesResolved,void 0,void 0,"ColoredReferences"],[T.PluginFactoryName.GotoCtrlClickPlugin]:[m.gotoCtrlClickPluginDependenciesResolved,void 0,void 0,"GotoCtrlClick"],[T.PluginFactoryName.AutocompleteLetPlugin]:[g.autocompleteLetPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],[T.PluginFactoryName.AutocompleteRichValuePlugin]:[p.autocompleteRichValuePluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],[T.PluginFactoryName.FormulaCollectionPlugin]:[h.formulaCollectionPluginDependenciesResolved,"Microsoft.Office.Excel.FormulaCollection"],[T.PluginFactoryName.AutocompleteNamedObjectsPlugin]:[f.autocompleteNamedObjectsPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],[T.PluginFactoryName.ParserPerformanceMeasurements]:[a.parserPerformanceMeasurementsAttach,"Microsoft.Office.Excel.x10ParserPerformanceMeasurements"],[T.PluginFactoryName.AutocompleteTableHeadersPlugin]:[S.autocompleteTableHeadersPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],[T.PluginFactoryName.ValuePreviewPlugin]:[v.valuePreviewPluginDependenciesResolved,void 0,void 0,"ValuePreview"],[T.PluginFactoryName.SyntaxErrorsPlugin]:[k.syntaxErrorsPluginDependenciesResolved,void 0,void 0,"SyntaxErrors"],[T.PluginFactoryName.AutocompleteRangeSuggestionPlugin]:[a.autocompleteRangeSuggestionPluginAttach,"Microsoft.Office.Excel.AutocompleteRangeSuggestionPlugin"],[T.PluginFactoryName.AutocompleteWrapperPlugin]:[a.autocompleteWrapperPluginAttach,"Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled"],[T.PluginFactoryName.AutocompleteBinaryModelExperimentPlugin]:[a.autocompleteBinaryModelExperimentPluginAttach,"Microsoft.Office.Excel.x10AutocompleteBinaryModelExperimentPlugin"],[T.PluginFactoryName.FormulaRepairShadowEvalPlugin]:[k.formulaRepairShadowEvalPluginDependenciesResolved,"Microsoft.Office.Excel.ProseFormulaRepairExperimentIsEnabled"],[T.PluginFactoryName.PythonAutocompletePlugin]:[y.pythonAutocompletePluginAttach,"Microsoft.Office.Excel.x10PythonAutocompletionEnabled"],[T.PluginFactoryName.ChatGPTPlugin]:[a.chatGPTPluginAttach,"Microsoft.Office.Excel.ChatGPTPluginEnabled"],[T.PluginFactoryName.FormulaByExamplePlugin]:[k.formulaByExamplePluginAttach,"Microsoft.Office.Excel.FormulaByExamplePluginSuggestionShowing"],[T.PluginFactoryName.TestPlugin]:[s.workerThreadInitialized,"Microsoft.Office.Excel.MockWorkerThreadPlugin"],[T.PluginFactoryName.AutocompleteEnumPlugin]:[u.autocompleteEnumPluginDependenciesResolved,void 0,void 0,"EnumAutoComplete"],[T.PluginFactoryName.SetCellPrefetchPlugin]:[k.setCellPreftechPluginAttach,"Microsoft.Office.Excel.SetCellPrefetchPluginEnabled"],[T.PluginFactoryName.FormulaTranspilerPlugin]:[k.formulaTranspilerPluginAttach,"Microsoft.Office.Excel.FormulaRemediation"]},Win32:{}},A={[T.PluginAttachGroup.Core]:!0,[T.PluginAttachGroup.Python]:!1,[T.PluginAttachGroup.SmartSuggestionsAutoComplete]:!1};(0,C.staticAssertExtends)();const I={[T.PluginAttachGroup.Core]:{[T.PluginFactoryName.AutocompletePlugin]:!1},[T.PluginAttachGroup.Python]:{},[T.PluginAttachGroup.SmartSuggestionsAutoComplete]:{[T.PluginFactoryName.AutocompletePlugin]:!0}};function O(e,t,r=[]){return n.__awaiter(this,void 0,void 0,(function*(){(0,i.isTypedChangeGateEnabled)("OfficeVSO:7903424_Microsoft.Office.Excel.ProvideX10FeaturesFromSchedulerFeatures")&&b.PluginSchedulerSingleton.instance().doNotify(E.NotificationKind.setSchedulerFeatures,[r.map((e=>T.SchedulerFeature[e]))]),s.scriptLoaderPromise.resolve(t);const n=N.Web[e];if(void 0===n)return!1;const[o,a,l,u]=n;if((void 0===a||(0,i.getTypedFeatureGate)(a))&&(void 0===l||(0,i.isTypedChangeGateEnabled)(l))&&(void 0===u||-1!==r.indexOf(u)))try{return yield o.getValue(),!0}catch(t){R.x10Logger.log({kind:"failure",payload:{failureKind:R.X10FailureKind.PluginAttachmentFailure,failureLevel:F.TraceLevel.Error,path:"ensurePluginAttachedLegacy",description:`Failed to ensure plugin "${T.PluginFactoryName[e]}" is attached with exception`,data:t}})}return!1}))}function _(e){return n.__awaiter(this,void 0,void 0,(function*(){const t=N[P.platform][e];if(void 0===t)return!1;const r=b.PluginSchedulerSingleton.instance().getSchedulerFeatures(),[n,o,a,s]=t;if((void 0===o||(0,i.getTypedFeatureGate)(o))&&(void 0===a||(0,i.isTypedChangeGateEnabled)(a))&&(void 0===s||-1!==r.indexOf(T.SchedulerFeature[s])))try{return yield n.getValue(),!0}catch(t){R.x10Logger.log({kind:"failure",payload:{failureKind:R.X10FailureKind.PluginAttachmentFailure,failureLevel:F.TraceLevel.Error,path:"ensurePluginAttached",description:`Failed to ensure plugin "${T.PluginFactoryName[e]}" is attached with exception`,data:t}})}return!1}))}function M(e){return Object.keys(e).map((e=>parseInt(e,10)))}function D(e,t){var r;return null!==(r=I[t][e])&&void 0!==r?r:A[t]}t.resolveScriptLoaderPromise=function(e){s.scriptLoaderPromise.resolve(e)},t.ensurePluginAttachedLegacy=O,t.setX10Features=function(e){b.PluginSchedulerSingleton.instance().doNotify(E.NotificationKind.setSchedulerFeatures,[e.map((e=>T.SchedulerFeature[e]))])},t.ensurePluginAttached=_,t.ensureGroupAttached=function(e){return n.__awaiter(this,void 0,void 0,(function*(){let t=0;for(const r of M(N[P.platform]))D(r,e)&&(yield _(r))&&(t+=1);return t}))},t.ensureGroupAttachedLegacy=function(e,t,r=[]){return n.__awaiter(this,void 0,void 0,(function*(){let n=0;for(const i of M(N.Web))D(i,t)&&(yield O(i,e,r))&&(n+=1);return n}))}},60111:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autoCompletePluginsThread=t.workerThreadInitialized=t.workerThreadSpread=t.dynamicPluginLoaderCreated=t.schedulerWithTableIntelligenceServiceAttached=t.schedulerWithRecalcServiceAttached=t.scriptLoaderPromise=t.FormulaAuthoringStringsOnMainThread=void 0;const n=r(19181),i=r(59416),o=r(81476),a=r(82751),s=r(42549),l=r(18538),u=r(53507);t.FormulaAuthoringStringsOnMainThread=(0,u.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield t.dynamicPluginLoaderCreated.getValue();yield e.loadPluginScript("formula-authoring-strings",!0)}))),"FormulaAuthoringStringsOnMainThread"),t.scriptLoaderPromise=new a.ResolvablePromise,t.schedulerWithRecalcServiceAttached=(0,u.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=i.PluginSchedulerSingleton.instance();return c.getValue()&&(yield t.FormulaAuthoringStringsOnMainThread.getValue()),yield e.recalcServiceAttached(),e}))),"schedulerWithRecalcServiceAttached"),t.schedulerWithTableIntelligenceServiceAttached=(0,u.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=i.PluginSchedulerSingleton.instance();return yield e.tableIntelligenceServiceAttached(),e}))),"schedulerWithTableIntelligenceServiceAttached"),t.dynamicPluginLoaderCreated=(0,u.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield t.scriptLoaderPromise;return(0,i.createDynamicPluginLoader)(e)}))),"dynamicPluginLoaderCreated"),t.workerThreadSpread=(0,u.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){return(yield t.dynamicPluginLoaderCreated.getValue()).createPluginThread("worker")}))),"workerThreadSpread"),t.workerThreadInitialized=(0,u.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){yield t.workerThreadSpread.getValue()}))),"workerThreadInitialized"),t.autoCompletePluginsThread=(0,u.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){let e;return e=(0,s.getTypedFeatureGate)("Microsoft.Office.Excel.AutoCompleteOnMainThread")?yield t.dynamicPluginLoaderCreated.getValue():yield t.workerThreadSpread.getValue(),e}))),"autoCompletePluginsThread");const c=new o.ResettableLazy((()=>{const e=i.PluginSchedulerSingleton.instance();return!e.isSchedulerFeatureEnabled(l.SchedulerFeature.SimpleAutoComplete)&&e.isSchedulerFeatureEnabled(l.SchedulerFeature.ArgumentAssistance)}))},80773:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formulaTranspilerPluginAttach=t.setCellPreftechPluginAttach=t.formulaByExamplePluginAttach=t.formulaRepairShadowEvalPluginDependenciesResolved=t.syntaxErrorsPluginDependenciesResolved=void 0;const n=r(19181),i=r(18538),o=r(60111),a=r(53507),s=(0,a.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield o.workerThreadSpread.getValue();return yield e.loadPluginScript("excelOnlineX10Plugins",!1),e}))),"threadWithExcelOnlineX10PluginsScriptLoaded");t.syntaxErrorsPluginDependenciesResolved=(0,a.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield s.getValue();yield o.schedulerWithRecalcServiceAttached.getValue(),yield e.createAndAttachPlugin(i.PluginFactoryName.SyntaxErrorsPlugin)}))),"syntaxErrorsPluginDependenciesResolved"),t.formulaRepairShadowEvalPluginDependenciesResolved=(0,a.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield s.getValue();yield o.schedulerWithRecalcServiceAttached.getValue(),yield e.createAndAttachPlugin(i.PluginFactoryName.FormulaRepairShadowEvalPlugin)}))),"formulaRepairShadowEvalPluginDependenciesResolved"),t.formulaByExamplePluginAttach=(0,a.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield s.getValue();yield o.schedulerWithRecalcServiceAttached.getValue(),yield e.createAndAttachPlugin(i.PluginFactoryName.FormulaByExamplePlugin)}))),"formulaByExamplePluginAttach"),t.setCellPreftechPluginAttach=(0,a.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield s.getValue();yield o.schedulerWithRecalcServiceAttached.getValue(),yield e.createAndAttachPlugin(i.PluginFactoryName.SetCellPrefetchPlugin)}))),"setCellPreftechPluginAttach"),t.formulaTranspilerPluginAttach=(0,a.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield o.workerThreadSpread.getValue();yield e.loadPluginScript("excelOnlineFormulaTranspiler",!1),yield e.createAndAttachPlugin(i.PluginFactoryName.FormulaTranspilerPlugin)}))),"formulaTranspilerPluginAttach")},50111:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResponseState=t.ExecutionStopReason=t.FrameExecutionStopReason=t.SchedulerVersionCompatibility=t.SchedulerTimelineQueueMessageKind=t.delay=t.awaitPromise=t.typedRequest=t.makeSyncRequester=t.makeRequester=t.RequestKind=t.recalcNotificationKinds=t.ComputationRequestKind=t.DefaultComputationGroup=void 0;const n=r(12450),i=r(57264),o=r(85304),a=r(65248),s=r(82751),l=r(35524),u=r(83567),c=r(84565),d=r(20210);var m,g,p,h,f;t.DefaultComputationGroup="",t.ComputationRequestKind={GetSheetNames:"GetSheetNames",GetRange:"GetRange",Delay:"Delay",GetCell:"GetCell",GetContainingTable:"GetContainingTable",UnsafeGetContainingTableName:"UnsafeGetContainingTableName",GetAvailableTableHeaders:"GetAvailableTableHeaders",GetIntersectingTables:"GetIntersectingTables",UnsafeGetIntersectingTableNames:"UnsafeGetIntersectingTableNames",GetStructRefColumn:"GetStructRefColumn",GetStructRefSpecialRef:"GetStructRefSpecialRef",GetIformat:"GetIformat",ParseCellFormula:"ParseCellFormula",ParseEdit:"ParseEdit",ParseNumberFormat:"ParseNumberFormat",PrintFormula:"PrintFormula",GetActiveCell:"GetActiveCell",GetActiveCellFormat:"GetActiveCellFormat",GetConfig:"GetConfig",GetCultureTag:"GetCultureTag",AwaitPromise:"AwaitPromise",CreateTask:"CreateTask",PromiseToTask:"PromiseToTask",AwaitTask:"AwaitTask",AwaitBatch:"AwaitBatch",AwaitAll:"AwaitAll",AwaitAny:"AwaitAny",GetFunctionsInfo:"GetFunctionsInfo",GetFunctionInfo:"GetFunctionInfo",GetCorrelationId:"GetCorrelationId",SetActiveCell:"SetActiveCell",ParseActiveCell:"ParseActiveCell",GetRichValueFieldListContext:"GetRichValueFieldListContext",GetHiddenRows:"GetHiddenRows",GetHiddenCols:"GetHiddenCols",GetDefinedNamesInfo:"GetDefinedNamesInfo",GetDefinedNameInfo:"GetDefinedNameInfo",ResolveReferences:"ResolveReferences",EvalOnClonedModel:"EvalOnClonedModel",EvalFormula:"EvalFormula",GetCorrespondingSnapshotID:"GetCorrespondingSnapshotID",GetEditFormat:"GetEditFormat",GetFullTableHeadersFromServer:"GetFullTableHeadersFromServer",CreateChatGPTSession:"CreateChatGPTSession",CloseChatGPTSession:"CloseChatGPTSession",SendChatGPTQuery:"SendChatGPTQuery",IsSchedulerFeatureEnabled:"IsSchedulerFeatureEnabled",SendAugLoopSignal:"SendAugLoopSignal",TriggerEvent:"TriggerEvent",AwaitEvent:"AwaitEvent",GetRecognizedRangeTables:"GetRecognizedRangeTables",UpdateSnapshot:"UpdateSnapshot"},(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),t.recalcNotificationKinds=[o.NotificationKind.setA1ReferenceStyle,o.NotificationKind.setLocale,o.NotificationKind.setWorkbookProps,o.NotificationKind.updateSheetNames,o.NotificationKind.updateNamedObjects],function(e){e.functionSuggestion="functionSuggestion",e.inCellSuggestion="inCellSuggestion",e.formulaHighlighting="formulaHighlighting",e.argumentAssistance="argumentAssistance",e.valuePreview="valuePreview",e.gotoCtrlClick="gotoCtrlClick",e.runExperiment="runExperiment",e.runAuthoringExperiment="runAuthoringExperiment",e.runPerCharacterExperiment="runPerCharacterExperiment",e.runTest="runTest",e.formulaRepair="formulaRepair",e.chatGPTQuery="chatGPTQuery",e.columnFormulaSuggestion="columnFormulaSuggestion",e.setCellPrefetch="setCellPrefetch",e.getTranspiledFormulas="getTranspiledFormulas"}(m||(t.RequestKind=m={})),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),t.makeRequester=function(e){const r=r=>(...[i,o,a])=>(0,n.isNone)(i)?Promise.resolve(null):Promise.resolve(e.doRequest(r,i,o,null!=a?a:t.DefaultComputationGroup));return{argumentAssistance:r(m.argumentAssistance),chatGPTQuery:r(m.chatGPTQuery),columnFormulaSuggestion:r(m.columnFormulaSuggestion),formulaHighlighting:r(m.formulaHighlighting),formulaRepair:r(m.formulaRepair),functionSuggestion:r(m.functionSuggestion),gotoCtrlClick:r(m.gotoCtrlClick),inCellSuggestion:r(m.inCellSuggestion),runAuthoringExperiment:r(m.runAuthoringExperiment),runExperiment:r(m.runExperiment),runPerCharacterExperiment:r(m.runPerCharacterExperiment),runTest:r(m.runTest),valuePreview:r(m.valuePreview),setCellPrefetch:r(m.setCellPrefetch),getTranspiledFormulas:r(m.getTranspiledFormulas)}},t.makeSyncRequester=function(e){return{formulaHighlighting:(r,i,o)=>(0,n.isNone)(r)?null:e.doSyncRequest(m.formulaHighlighting,r,i,null!=o?o:t.DefaultComputationGroup)}},t.typedRequest=function*(e,t){const r=yield Object.assign({kind:e},t);return(0,i.assertTrue)("Response kind coincides with request kind",r.kind===e),(0,c.staticTypeHint)(r),r},t.awaitPromise=function*(e){const r=yield{kind:t.ComputationRequestKind.AwaitPromise,promise:e};return(0,i.assertTrue)("Response kind coincides with request kind",r.kind===t.ComputationRequestKind.AwaitPromise),r.result},t.delay={kind:t.ComputationRequestKind.Delay},function(e){e[e.NoOpRequest=0]="NoOpRequest",e[e.AsyncRequest=1]="AsyncRequest",e[e.SyncRequest=2]="SyncRequest",e[e.StepComputation=3]="StepComputation",e[e.StopComputationFrame=4]="StopComputationFrame",e[e.Timeout=5]="Timeout"}(g||(t.SchedulerTimelineQueueMessageKind=g={})),function(e){e.Both="Both",e.SyncOnly="SyncOnly"}(p||(t.SchedulerVersionCompatibility=p={})),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),function(e){e.Superseded="Superseded",e.Timeout="Timeout",e.ConflictResolverEarlyTermination="ConflictResolverEarlyTermination"}(h||(t.FrameExecutionStopReason=h={})),function(e){e.Done="Done",e.Skipped="Skipped",e.Exception="Exception"}(f||(f={})),t.ExecutionStopReason={Unknown:"Unknown",Frame:h,Computation:f},t.ResponseState=class{computationFrame(e){return this._computationFrames.get(e)}get attachedComputations(){return[...this._attachedComputations]}get attachedSyncComputations(){return[...this._attachedSyncComputations]}get numComputations(){return this._attachedComputations.length}get numSyncComputations(){return this._attachedSyncComputations.length}attachComputation(e){this._attachedComputations.push(e)}attachSyncComputation(e){this._attachedSyncComputations.push(e)}createFrame(e,r,n,i,o,u,c,d){const m=new s.ResolvablePromise,g=this.computationKind,p={type:this.computationType,correlationId:e,computationGroup:r,computationInput:i,cache:o,config:u,startTime:c,timeWindow:d,successfulResults:{kind:g,results:[]},resolvable:m,stopReasonRef:new l.Ref(t.ExecutionStopReason.Unknown),numOfComputations:n===a.ExecutionType.Async?this.numComputations:this.numSyncComputations,numFailures:0,numSkippedComputations:0};return this._computationFrames.set(r,p),m}closeFrame(e,r,n){var i;const o=this.computationFrame(e);if(!o)return;this._computationFrames.delete(e),o.stopReasonRef.value=r,o.resolvable.resolve(r===t.ExecutionStopReason.Frame.Superseded?{kind:"Superseded"}:{kind:"Done",payload:o.successfulResults}),null===(i=o.cache)||void 0===i||i.close();const{computationKind:a,numComputations:s,numSyncComputations:l}=this,{correlationId:c,startTime:m,numSkippedComputations:g,successfulResults:p}=o,h=p.results.length,f={correlationId:c,type:this.computationType,computationKind:a,computationGroup:e,numComputations:s,numSyncComputations:l,numSent:h,numSkippedComputations:g,stopReason:r,startTime:m,stopTime:n};u.x10Logger.log({kind:"closeComputationFrame",payload:f}),(0,d.sendX10UsedTelemetryEvent)()}stop(e,t,r){void 0!==this.computationFrame(e)&&this.closeFrame(e,t,r)}constructor(e,t){this.computationType=e,this.computationKind=t,this._attachedComputations=[],this._attachedSyncComputations=[],this._computationFrames=new Map}}},32973:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrefetchingCache=void 0;const n=r(19181),i=r(7793),o=r(68485),a=r(50338),s=r(33436),l=r(33436),u=r(55340),c=r(91709),d=r(28196),m=r(12450),g=r(48262),p=r(25201),h=r(20456),f=r(83102),S=r(94297),v=r(94591),y=r(94591),F=r(88449),C=r(96547),R=r(30006),b=r(77721),E=r(91889),T=r(53750),k=r(71510),P=r(97865),N=r(83567);function A({hasHeadersRow:e,hasTotalsRow:t,dataRange:r}){return(0,i.gridRange)(r.row-Number(e),r.col,r.rows+Number(e)+Number(t),r.cols)}function I(e,t,r,n){const{name:o,hasHeadersRow:a,hasTotalsRow:s,dataRange:l,columns:u}=t,c=a?(0,i.gridRange)(l.row-1,l.col,1,l.cols):void 0,d=s?(0,i.gridRange)(l.row+l.rows,l.col,1,l.cols):void 0,m={};let g=S.RedBlackMapTree.create(e.stringCompareCI);for(const e of u)m[e.column]=e,g=g.setValue(e.name,e);return{name:o,sheet:r,dataRange:l,headersRange:c,totalsRange:d,allRange:n,indexToColumn:m,nameToColumn:g,allColumnNamesAvailable:u.length===l.cols}}function O(e,t){var r;return(null!==(r=(0,f.compareProduct)((0,p.createCellSetFromRange)(t),e))&&void 0!==r?r:1)<=0}const _=(0,l.failure)((0,a.unavailable)(["getCell"])),M=(0,l.failure)((0,a.unavailable)(["getContainingTable"])),D=(0,l.failure)((0,a.unavailable)(["getIntersectingTables"])),w=(0,l.failure)((0,a.unavailable)(["getIntersectingTableNames"])),L=(0,l.failure)((0,a.unavailable)(["getIformats"])),x=(0,l.failure)((0,a.unavailable)(["GetAvailableTableHeaders"]));class K{static getOrFetchTile(e,t,r){const n=t.range.row>>>K.tileHeightPow,o=t.range.col>>>K.tileWidthPow;void 0===e[n]&&(e[n]=[]);const a=e[n][o];return void 0===a?r((0,i.sheetGridRange)(t.sheet,(0,i.gridRange)(n<<K.tileHeightPow,o<<K.tileWidthPow,1<<K.tileHeightPow,1<<K.tileWidthPow))).then((t=>e[n][o]=t)):a}static create(e,t,r){return new K(e,t,r)}getSheetContents(e){var t;return null!==(t=this.sheet2contents[e])&&void 0!==t?t:this.sheet2contents[e]={cellTiles:[],tables:(0,g.makeGridRangeTable)(),tableTiles:[],hiddenRows:h.empty,hiddenRowsAvailability:h.empty,hiddenCols:h.empty,hiddenColsAvailability:h.empty}}getCurrentDocumentLoc(){return this.currentDocumentLoc}getSheetNames(){var e;if(void 0===this.sheetNames){const t=[];null===(e=this.syncDataStore.sheets)||void 0===e||e.forEachSheet((e=>{t.push({sheetIndex:e.sheetIndex,sheetName:e.name})}));const r={};let n=S.RedBlackMapTree.create(this.syncDataStore.config.localeInfo.stringCompareCI);for(let e=0;e<t.length;e+=1){const{sheetIndex:i,sheetName:o}=t[e];r[i.index]=e,n=n.setValue(o,e)}const i=this.getCurrentDocumentLoc();this.sheetNames={document:i,sheets:t,idToIndex:r,nameToIndex:n}}return(0,l.success)(this.sheetNames)}getRangeValues(e){return this.grid.getRangeValues(this.correlationId,e)}getRangeFormulae(e){return this.grid.getRangeFormulae(this.correlationId,e)}getRangeFormats(e){return this.grid.getRangeFormats(this.correlationId,e)}getHiddenRows(e,t,r){return n.__awaiter(this,void 0,void 0,(function*(){const n=this.getSheetContents(e.index),o=p.bspFactory.row([t,r]),a=(0,h.compare)(o,n.hiddenRowsAvailability);if(0!==a&&-1!==a){const o=yield this.grid.getHiddenRows(this.correlationId,e,(0,m.fastMax)(0,t-10),(0,m.fastMin)(i.sheetRows,r+10));n.hiddenRows=o.hidden.reduce(((e,{start:t,end:r})=>(0,h.union)(e,p.bspFactory.row([t,r]))),n.hiddenRows),n.hiddenRowsAvailability=o.available.reduce(((e,{start:t,end:r})=>(0,h.union)(e,p.bspFactory.row([t,r]))),n.hiddenRowsAvailability)}const s=[];(0,p.forEachRow)((0,h.intersect)(n.hiddenRowsAvailability,o),(([e,t])=>(s.push((0,T.interval)(e,t)),!0)));const l=[];return(0,p.forEachRow)((0,h.intersect)(n.hiddenRows,o),(([e,t])=>(l.push((0,T.interval)(e,t)),!0))),{available:s,hidden:l}}))}getHiddenCols(e,t,r){return n.__awaiter(this,void 0,void 0,(function*(){const n=this.getSheetContents(e.index),o=p.bspFactory.col([t,r]),a=(0,h.compare)(o,n.hiddenColsAvailability);if(0!==a&&-1!==a){const o=yield this.grid.getHiddenCols(this.correlationId,e,(0,m.fastMax)(0,t-10),(0,m.fastMin)(i.sheetCols,r+10));n.hiddenCols=o.hidden.reduce(((e,{start:t,end:r})=>(0,h.union)(e,p.bspFactory.col([t,r]))),n.hiddenCols),n.hiddenColsAvailability=o.available.reduce(((e,{start:t,end:r})=>(0,h.union)(e,p.bspFactory.col([t,r]))),n.hiddenColsAvailability)}const s=[];(0,p.forEachCol)((0,h.intersect)(n.hiddenColsAvailability,o),(([e,t])=>(s.push((0,T.interval)(e,t)),!0)));const l=[];return(0,p.forEachCol)((0,h.intersect)(n.hiddenCols,o),(([e,t])=>(l.push((0,T.interval)(e,t)),!0))),{available:s,hidden:l}}))}getRange(e,t){return n.__awaiter(this,void 0,void 0,(function*(){const r=void 0===t||t.indexOf("values")>-1,n=void 0===t||t.indexOf("formulae")>-1,i=void 0===t||t.indexOf("formats")>-1,s=(0,l.failure)((0,a.unavailable)(["getRange"])),[u,c,d]=yield Promise.all([r?this.getRangeValues(e):s,n?this.getRangeFormulae(e):s,i?this.getRangeFormats(e):s]);return new o.NaiveLocalSheetGrid(e.sheet,u,c,d)}))}getCell(e){const t=this.getSheetContents(e.sheet.index),r=K.getOrFetchTile(t.cellTiles,e,(t=>n.__awaiter(this,void 0,void 0,(function*(){const[r,n,i]=[yield this.grid.getRangeValues(this.correlationId,t),yield this.grid.getRangeFormulae(this.correlationId,t),yield this.grid.getRangeFormats(this.correlationId,t)];return(0,l.isSuccess)(r)&&(0,l.isSuccess)(n)&&(0,l.isSuccess)(i)?new o.NaiveLocalSheetGrid(e.sheet,r,n,i):"unavailable"}))));return(0,d.bindMaybeThenable)(r,(t=>{if("unavailable"===t)return _;const r=t.getCellValue(e.range.row,e.range.col),n=t.getCellFormula(e.range.row,e.range.col),i=t.getCellFormat(e.range.row,e.range.col);return(0,l.isSuccess)(r)&&(0,l.isSuccess)(n)&&(0,l.isSuccess)(i)?(0,l.success)({value:r.value,formula:n.value,format:i.value}):_}))}getAvailableTableHeaders(e){const t=this.syncDataStore.nameManager;if(!t)return x;const r=t.getAllDocumentNames().find((t=>t.name===e));if(!r)return x;const n=t.getAvailableTableColumns(r);return(0,l.success)(n)}getStructRefColumn(e,t){const r=this.syncDataStore.getStructRefColumn(e,t);return r.kind===s.ResultKind.Failure?(0,l.failure)((0,a.unavailable)(["getStructRefColumn"])):r}getStructRefSpecialRef(e,t){const r=this.syncDataStore.getStructRefSpecialRef(e,t);return r.kind===s.ResultKind.Failure?(0,l.failure)((0,a.unavailable)(["getStructRefSpecialRef"])):r}getContainingTableName(e){const t=this.syncDataStore.getContainingTable(e);return t.kind===s.ResultKind.Failure?(0,l.failure)((0,a.unavailable)(["getContainingTableName"])):t}getContainingTable(e){return n.__awaiter(this,void 0,void 0,(function*(){const t=this.getSheetContents(e.sheet.index),r=K.getOrFetchTile(t.tableTiles,e,(r=>n.__awaiter(this,void 0,void 0,(function*(){const n=yield this.grid.getIntersectingTables(this.correlationId,r);if(!(0,l.isSuccess)(n))return"unavailable";const i=n.value.availableRanges.map(p.createCellSetFromRange).reduce(f.unionProduct,h.empty);for(const r of n.value.tables){const n=A(r);t.tables.getValue(n)||(t.tables=t.tables.setValue(n,I(this.syncDataStore.config.localeInfo,r,e.sheet,n)))}return i}))));return(0,d.bindMaybeThenable)(r,(r=>{if("unavailable"===r)return M;let n;return t.tables.forEachGe(e.range,((e,t)=>(n=t,!1))),void 0!==n||O(r,e.range)?(0,l.success)(n):M}))}))}getIntersectingTables(e){return n.__awaiter(this,void 0,void 0,(function*(){const t=this.getSheetContents(e.sheet.index);let r=h.empty;for(let n=e.range.row,o=e.range.row+e.range.rows;n<o;n+=1<<K.tileHeightPow)for(let o=e.range.col,a=e.range.col+e.range.cols;o<a;o+=1<<K.tileWidthPow){const a=K.getOrFetchTile(t.tableTiles,(0,i.sheetGridCell)(e.sheet,(0,i.gridCell)(n,o)),(e=>this.fetchTableTile(e.sheet,t,e))),s=(0,d.isThenable)(a)?yield a:a;if("unavailable"===s)return D;r=(0,f.unionProduct)(r,s)}const n=[];return t.tables.forEachMeets(e.range,((e,t)=>(n.push(t),r=(0,f.unionProduct)(r,(0,p.createCellSetFromRange)(e)),!0))),O(r,e.range)?(0,l.success)(n):D}))}getIntersectingTableNames(e){if(void 0===this.syncDataStore.nameManager)return w;const t=this.syncDataStore.nameManager.getIntersectingTables(e);return t.kind===s.ResultKind.Failure?w:t}fetchTableTile(e,t,r){return n.__awaiter(this,void 0,void 0,(function*(){const n=yield this.grid.getIntersectingTables(this.correlationId,r);if(!(0,l.isSuccess)(n))return"unavailable";const i=n.value.availableRanges.map(p.createCellSetFromRange).reduce(f.unionProduct,h.empty);for(const r of n.value.tables){const n=A(r);t.tables.getValue(n)||(t.tables=t.tables.setValue(n,I(this.syncDataStore.config.localeInfo,r,e,n)))}return i}))}getIformat(e,t){return n.__awaiter(this,void 0,void 0,(function*(){const r=t>>>K.formatPagePow,n=r<<K.formatPagePow,i=n+(1<<K.formatPagePow);let o=this.formatPages[r];if(void 0===o){const t=yield this.grid.getIformats(this.correlationId,e,n,i);if((0,l.isSuccess)(t)){const e=[];for(const r of t.value.availableFormats)r.iformat<n||r.iformat>=i||(e[r.iformat-n]=r);o=this.formatPages[r]=e}else o=this.formatPages[r]="unavailable"}if("unavailable"===o)return L;const a=o[t-n];return void 0===a?L:(0,l.success)(a)}))}parseCellFormula(e,t,r){return{result:K.cachedParseFormula(r?this.englishFormulaCache:this.formulaCache,r?this.englishParser:this.parser,r?this.englishAnalyzer:this.analyzer,e,t)}}parseEdit(e,t){var r;return n.__awaiter(this,void 0,void 0,(function*(){const n=null!==(r=yield this.getEditFormat(e))&&void 0!==r?r:{valueType:y.FormatValueType.General,bidiDate:void 0,culture:void 0};return this.parseEditInternal(e,t,n)}))}parseEditSync(e,t,r){const n=this.parseNumberFormat(r.formatString,r.builtIn).result;let i;return i=(0,l.isSuccess)(n)?n.value:{valueType:y.FormatValueType.General,bidiDate:void 0,culture:void 0},this.parseEditInternal(e,t,i)}resolveReferences(e,t){return t.map((t=>{switch(t.kind){case k.NodeKind.StructRef:return this.resolveStructRefSync(e,t).result;case k.NodeKind.CellRef:return this.resolveCellRefNodeSync(e,t).result}}))}getCorrespondingSnapshotID(){return n.__awaiter(this,void 0,void 0,(function*(){return-1===this.correspondingSnapshotID&&(this.correspondingSnapshotID=yield this.grid.getCorrespondingSnapshotID(this.correlationId)),this.correspondingSnapshotID}))}getEditFormat(e){return n.__awaiter(this,void 0,void 0,(function*(){const t=yield this.getCell(e);if(!(0,l.isSuccess)(t))return;let r;if("string"==typeof t.value.format)r=this.parseNumberFormat(t.value.format,!1).result;else{const n=yield this.getIformat(e.sheet.document,t.value.format);if(!(0,l.isSuccess)(n))return;const{formatString:i,builtIn:o}=n.value;r=this.parseNumberFormat(i,o).result}return(0,l.isSuccess)(r)?r.value:void 0}))}parseEditInternal(e,t,r){let n=this.formatter.parseEdit(t,r);if(!(0,l.isSuccess)(n))return{result:n};if(n.value.kind===y.EditKind.String&&"="===t&&r.valueType!==y.FormatValueType.Text&&(n=(0,l.success)((0,v.formulaEdit)(t))),n.value.kind!==y.EditKind.Formula)return{result:(0,l.success)(n.value)};const i=K.parseCheckedFormula(this.parser,this.analyzer,e,n.value.fmla,e.range);return(0,l.isSuccess)(i)?{result:(0,l.success)({kind:y.EditKind.Formula,fmla:n.value.fmla,formula:i.value})}:{result:i}}static cachedParseFormula(e,t,r,n,i){var o;const a=e.get(i);if(void 0!==a)return a;const s=K.parseWellFormedFormula(t,r,n,i.formulaBarText,null!==(o=i.origin)&&void 0!==o?o:n.range);return e.set(i,s),s}static parseWellFormedFormula(e,t,r,n,i){const o=K.parseCheckedFormula(e,t,r,n,i);return(0,l.isSuccess)(o)?(0,a.isWellFormed)(o.value)?(0,l.success)(o.value):(0,l.failure)((0,T.illFormedFormula)("ill-formed formula")):o}static parseCheckedFormula(e,t,r,n,o){const a=e.parseFormula((0,C.parseLocals)(i.LexicalKind.Cell,o),n);if(!(0,l.isSuccess)(a))return a;const s=t.checkFormula((0,R.analyzeLocalsGrid)(i.LexicalKind.Cell,(0,i.sheetGridCell)(r.sheet,o)),a.value);return(0,l.isSuccess)(s)?(0,l.success)(s.value):s}parseNumberFormat(e,t){return{result:this.cachedParseNumberFormat(e,t)}}evalOnClonedModel(e,t,r){return this.grid.evalClonedModelOnSnapshot(this.correlationId,e,t,r)}evalFormula(e,t,r){return this.grid.evalFormulaOnSnapshot(this.correlationId,e,t,r)}cachedParseNumberFormat(e,t){const r=t?this.builtInFormatCache.get(e):this.customFormatCache.get(e);if(void 0!==r)return r;const n=this.formatter.createFormat(e,t);return t?this.builtInFormatCache.set(e,n):this.customFormatCache.set(e,n),n}resolveStructRefSync(e,t){return{result:this.resolver.resolveStructRef(e,t)}}resolveCellRefNodeSync(e,t){return{result:this.resolver.resolveCellRef(e,t)}}close(){this.grid.discardSnapshot(this.correlationId).catch((e=>{N.x10Logger.log({kind:"failure",payload:{failureKind:N.X10FailureKind.GridFailure,failureLevel:u.TraceLevel.Warning,path:"PrefetchingCache.close",description:(0,c.messageFromError)(e)}})}))}constructor(e,t,r){this.grid=e,this.syncDataStore=t,this.correlationId=r,this.correspondingSnapshotID=-1,this.sheet2contents=(0,m.makeStringMap)(),this.currentDocumentLoc=(0,i.documentLoc)(void 0,""),this.formatPages=[],this.formulaCache=new Map,this.englishFormulaCache=new Map,this.builtInFormatCache=new Map,this.customFormatCache=new Map,this.parser=(0,b.createParser)(t),this.analyzer=(0,E.createAnalyzer)(t),this.formatter=(0,F.createNumberFormatter)(t),this.resolver=(0,P.createResolver)(t);const n={config:{localeInfo:(0,u.getEnglishLocaleInfo)(),get date1904(){return t.config.date1904},get dateCompatibility(){return t.config.dateCompatibility},get datepack(){return t.config.datepack},get mathpack(){return t.config.mathpack},get refStyle(){return t.config.refStyle},get timezone(){return t.config.timezone}},getSheetName:(...e)=>t.getSheetName(...e),getContainingTable:(...e)=>t.getContainingTable(...e),getDocumentLoc:(...e)=>t.getDocumentLoc(...e),getNameLoc:(...e)=>t.getNameLoc(...e),getSheetIndex:(...e)=>t.getSheetIndex(...e),getSheetRangeIndexes:(...e)=>t.getSheetRangeIndexes(...e),getStructRefColumn:(...e)=>t.getStructRefColumn(...e),getStructRefSpecialRef:(...e)=>t.getStructRefSpecialRef(...e),getUserDefinedFuncLoc:(...e)=>t.getUserDefinedFuncLoc(...e)};this.englishParser=(0,b.createParser)(n),this.englishAnalyzer=(0,E.createAnalyzer)(n)}}t.PrefetchingCache=K,K.tileWidthPow=2,K.tileHeightPow=4,K.formatPagePow=6},18368:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pythonAutocompletePluginAttach=void 0;const n=r(19181),i=r(60111),o=r(42549),a=r(18538),s=r(53507),l=(0,s.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield i.workerThreadSpread.getValue();return yield e.loadPluginScript((0,o.isTypedChangeGateEnabled)("Microsoft.Office.Excel.X10IntelligentPythonWP5")?"pythonIntelliSenseWP5":"pythonIntelliSense",!1),e}))),"threadWithExcelOnlinePythonPluginScriptLoaded");t.pythonAutocompletePluginAttach=(0,s.trackableAsyncLazy)((()=>n.__awaiter(void 0,void 0,void 0,(function*(){const e=yield l.getValue();yield e.createAndAttachPlugin(a.PluginFactoryName.PythonAutocompletePlugin)}))),"pythonAutocompletePluginAttach")},64411:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processSyncRequest=t.processRequest=t.requestProcessorMap=void 0;const n=r(19181),i=r(12450),o=r(28196),a=r(28196),s=r(33436),l=r(55340),u=r(7793),c=r(57296),d=r(30007),m=r(50111),g=r(50338),p=r(83567),h=r(35524),f=r(42549),S=r(95486),v=r(32861),y=r(15281),F=h.X10TaskInternal.createToken();function C(e,t){return e.kind===s.ResultKind.Failure?e:(0,s.success)(t(e.value))}function R(e){return n.__awaiter(this,void 0,void 0,(function*(){try{return(0,s.success)(yield e)}catch(e){return(0,s.failure)(e)}}))}t.requestProcessorMap={[m.ComputationRequestKind.Delay]:()=>(0,s.success)({}),[m.ComputationRequestKind.AwaitPromise]:({request:{promise:e}})=>n.__awaiter(void 0,void 0,void 0,(function*(){try{const t=yield e;return(0,s.success)({result:t})}catch(e){return(0,s.failure)(e)}})),[m.ComputationRequestKind.CreateTask]:({request:{request:e},handle:t,schedulerState:r})=>{const n=new h.X10TaskInternal(r.scheduler.processRequest(t,e,{onFulfilled:e=>{if(e.kind!==s.ResultKind.Success)throw{kind:"RequestFailure"};return e.value},onRejected:e=>{throw e}}),F);return(0,s.success)({task:n})},[m.ComputationRequestKind.PromiseToTask]:({request:{promise:e}})=>(0,s.success)({task:new h.X10TaskInternal(e,F)}),[m.ComputationRequestKind.AwaitTask]:({request:{task:e}})=>n.__awaiter(void 0,void 0,void 0,(function*(){return(0,s.success)({result:yield R(e.resolve(F))})})),[m.ComputationRequestKind.AwaitBatch]:({request:{tasks:e}})=>n.__awaiter(void 0,void 0,void 0,(function*(){const t=[];for(const r of e)t.push(yield R(r.resolve(F)));return(0,s.success)({results:t})})),[m.ComputationRequestKind.AwaitAll]:({request:{tasks:e}})=>n.__awaiter(void 0,void 0,void 0,(function*(){const t=o.MaybeThenable.all(e.map((e=>e.resolve(F))));return(0,s.success)({result:yield R(t)})})),[m.ComputationRequestKind.AwaitAny]:({request:{tasks:e}})=>n.__awaiter(void 0,void 0,void 0,(function*(){const t=o.MaybeThenable.any(e.map((e=>e.resolve(F))));return(0,s.success)({result:yield R(t)})})),[m.ComputationRequestKind.GetCell]:({request:{cell:e},cache:t})=>n.__awaiter(void 0,void 0,void 0,(function*(){if(void 0===t)return y.logSafeFailure.failure("Cache is undefined");const r=yield t.getCell(e);return(0,s.success)({result:r})})),[m.ComputationRequestKind.GetContainingTable]:({request:{cell:e},cache:t})=>n.__awaiter(void 0,void 0,void 0,(function*(){if(void 0===t)return y.logSafeFailure.failure("Cache is undefined");const r=yield t.getContainingTable(e);return(0,s.success)({result:r})})),[m.ComputationRequestKind.UnsafeGetContainingTableName]:({request:{cell:e},cache:t})=>{if(void 0===t)return y.logSafeFailure.failure("Cache is undefined");const r=t.getContainingTableName(e);return(0,s.success)({result:r})},[m.ComputationRequestKind.GetAvailableTableHeaders]:({request:{tableName:e},cache:t})=>{if(void 0===t)return y.logSafeFailure.failure("Cache is undefined");const r=t.getAvailableTableHeaders(e);return(0,s.success)({result:r})},[m.ComputationRequestKind.GetIntersectingTables]:({request:{range:e},cache:t})=>n.__awaiter(void 0,void 0,void 0,(function*(){if(void 0===t)return y.logSafeFailure.failure("Cache is undefined");const r=yield t.getIntersectingTables(e);return(0,s.success)({result:r})})),[m.ComputationRequestKind.UnsafeGetIntersectingTableNames]:({request:{range:e},cache:t})=>{if(void 0===t)return y.logSafeFailure.failure("Cache is undefined");const r=t.getIntersectingTableNames(e);return(0,s.success)({result:r})},[m.ComputationRequestKind.GetRange]:({request:{range:e,layers:t},cache:r})=>n.__awaiter(void 0,void 0,void 0,(function*(){if(void 0===r)return y.logSafeFailure.failure("Cache is undefined");const n=yield r.getRange(e,t);return(0,s.success)({localSheetGrid:n})})),[m.ComputationRequestKind.GetSheetNames]:({cache:e})=>void 0===e?y.logSafeFailure.failure("Cache is undefined"):e.getSheetNames(),[m.ComputationRequestKind.GetStructRefColumn]:({request:{table:e,nameOrCol:t},cache:r})=>{if(void 0===r)return y.logSafeFailure.failure("Cache is undefined");const n=r.getStructRefColumn(e,t);return(0,s.success)({result:n})},[m.ComputationRequestKind.GetStructRefSpecialRef]:({request:{table:e,id:t},cache:r})=>{if(void 0===r)return y.logSafeFailure.failure("Cache is undefined");const n=r.getStructRefSpecialRef(e,t);return(0,s.success)({result:n})},[m.ComputationRequestKind.GetIformat]:({request:{document:e,iformat:t},cache:r})=>n.__awaiter(void 0,void 0,void 0,(function*(){if(void 0===r)return y.logSafeFailure.failure("Cache is undefined");const n=yield r.getIformat(e,t);return(0,s.success)({result:n})})),[m.ComputationRequestKind.ParseCellFormula]:({request:{cell:e,formula:t,useEnglishLocaleInfo:r},cache:n})=>void 0===n?y.logSafeFailure.failure("Cache is undefined"):(0,s.success)(n.parseCellFormula(e,t,r)),[m.ComputationRequestKind.ParseEdit]:({request:{cell:e,formulaBarText:t},cache:r})=>n.__awaiter(void 0,void 0,void 0,(function*(){return void 0===r?y.logSafeFailure.failure("Cache is undefined"):(0,s.success)(yield r.parseEdit(e,t))})),[m.ComputationRequestKind.ParseActiveCell]:({request:{formulaText:e},schedulerState:{activeCell:t,activeCellFormat:r},cache:n})=>{if(void 0===n)return y.logSafeFailure.failure("Cache is undefined");if((0,i.isNone)(t))return y.logSafeFailure.failure("Active Cell is undefined");if(void 0===r)return y.logSafeFailure.failure("Active Cell Format is undefined");const o=null!=r?r:{formatString:"General",builtIn:!0};return(0,s.success)(n.parseEditSync(t,e,o))},[m.ComputationRequestKind.ParseNumberFormat]:({request:{formatString:e,builtIn:t},cache:r})=>void 0===r?y.logSafeFailure.failure("Cache is undefined"):(0,s.success)(r.parseNumberFormat(e,t)),[m.ComputationRequestKind.PrintFormula]:({request:{formula:e,origin:t},config:r})=>{if(void 0===r)return(0,s.failure)([]);const n=(0,c.createPrinter)((0,d.createSimplePrintGlobals)(r)).printFormula((0,d.printLocalsGrid)((0,u.lexicalSourceGrid)(u.LexicalKind.Cell,t),t),e);return(0,s.success)({result:n})},[m.ComputationRequestKind.GetActiveCell]:({schedulerState:{activeCell:e}})=>void 0===e?(l.ulsLogger.ULS.traceTag(512274723,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,p.x10Logger.formatLogMessage("GetActiveCell",{description:"failed because activeCell was undefined"})),y.logSafeFailure.failure("Active Cell is undefined")):(0,s.success)({activeCell:e}),[m.ComputationRequestKind.GetActiveCellFormat]:({schedulerState:{activeCellFormat:e}})=>void 0===e?y.logSafeFailure.failure("Active Cell Format is undefined"):null===e?(0,s.success)({result:(0,s.failure)((0,g.unavailable)(["unavailableFormat"]))}):(0,s.success)({result:(0,s.success)(e)}),[m.ComputationRequestKind.GetConfig]:({config:e})=>void 0===e?y.logSafeFailure.failure("Config is undefined"):(0,s.success)({config:e}),[m.ComputationRequestKind.GetCultureTag]:({request:{lcid:e}})=>{const t=(0,v.convertKnownLCID)(e).toString();return-1===t.indexOf("-")?y.logSafeFailure.failure(`Culture-Tag '${t}' from LCID '${e}' has an unknown format`):(0,s.success)({cultureTag:t})},[m.ComputationRequestKind.GetFunctionsInfo]:({schedulerState:e})=>{const t=e.functionsInfoMap;if(void 0===t)return l.ulsLogger.ULS.traceTag(512274722,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,p.x10Logger.formatLogMessage("GetFunctionsInfo",{description:"failed because functionsInfoMap was undefined"})),y.logSafeFailure.failure("functionsInfoMap is undefined");const r=Object.keys(t).map((e=>t[e]));return(0,s.success)({functionsInfo:r})},[m.ComputationRequestKind.GetFunctionInfo]:({request:{functionName:e},schedulerState:t})=>{if(void 0===t.functionsInfoMap)return l.ulsLogger.ULS.traceTag(512274721,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,p.x10Logger.formatLogMessage("GetFunctionInfo",{description:"failed because functionsInfoMap was undefined"})),y.logSafeFailure.failure("functionsInfoMap is undefined");const r=t.functionsInfoMap[e.toUpperCase()];return void 0===r?y.logSafeFailure.failure("functionsInfo is undefined"):(0,s.success)({functionInfo:r})},[m.ComputationRequestKind.GetDefinedNamesInfo]:({schedulerState:e})=>{const t=e.definedNamesInfoMap;if(void 0===t)return l.ulsLogger.ULS.traceTag(512274720,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,p.x10Logger.formatLogMessage("GetDefinedNamesInfo",{description:"failed because definedNamesInfoMap was undefined"})),y.logSafeFailure.failure("definedNamesInfoMap is undefined");const r=Object.keys(t).map((e=>t[e]));return(0,s.success)({definedNamesInfo:r})},[m.ComputationRequestKind.GetDefinedNameInfo]:({request:{definedName:e},schedulerState:t})=>{if(void 0===t.definedNamesInfoMap)return y.logSafeFailure.failure("definedNamesInfoMap is undefined");const r=t.definedNamesInfoMap[e.toUpperCase()];return(0,s.success)({definedNameInfo:r})},[m.ComputationRequestKind.EvalOnClonedModel]:({cache:e,request:t})=>n.__awaiter(void 0,void 0,void 0,(function*(){const r=yield null==e?void 0:e.evalOnClonedModel(t.updates,t.edits,t.formatResults);return void 0===r?y.logSafeFailure.failure("Operation did not return a result"):r.kind!==s.ResultKind.Success?y.logSafeFailure.failure("Operation returned an unsuccessful result"):(0,s.success)({result:r.value})})),[m.ComputationRequestKind.EvalFormula]:({cache:e,request:t})=>n.__awaiter(void 0,void 0,void 0,(function*(){const r=yield null==e?void 0:e.evalFormula(t.formula,t.origin,t.format);return void 0===r?y.logSafeFailure.failure("Operation did not return a result"):r.kind!==s.ResultKind.Success?y.logSafeFailure.failure("Operation returned an unsuccessful result"):(0,s.success)({result:r.value})})),[m.ComputationRequestKind.GetCorrelationId]:({correlationId:e})=>(0,s.success)({correlationId:e}),[m.ComputationRequestKind.SetActiveCell]:e=>(e.schedulerState=Object.assign(Object.assign({},e.schedulerState),{activeCell:e.request.activeCell,activeCellFormat:e.request.activeCellFormat}),(0,s.success)({})),[m.ComputationRequestKind.GetRichValueFieldListContext]:({schedulerState:e,request:{rangeToQuery:t,dotNotationPath:r,singleColumn:o,findRange:a}})=>n.__awaiter(void 0,void 0,void 0,(function*(){const n=e.serverDataProvider;if((0,i.isNone)(n))return y.logSafeFailure.failure("serverDataProvider is undefined");const l=yield n.getRichValueFieldListContext(t,r,o,a);return(0,f.isTypedChangeGateEnabled)("OfficeVSO:8575821_x10MapGetRichValueFieldListContext")||(0,s.success)({result:l}),(0,s.success)({result:l})})),[m.ComputationRequestKind.GetHiddenRows]:({cache:e,request:t})=>n.__awaiter(void 0,void 0,void 0,(function*(){if(void 0===e)return(0,s.failure)([]);const r=yield e.getHiddenRows(t.sheet,t.start,t.endExclusive);return(0,s.success)({result:r})})),[m.ComputationRequestKind.GetHiddenCols]:({cache:e,request:t})=>n.__awaiter(void 0,void 0,void 0,(function*(){if(void 0===e)return(0,s.failure)([]);const r=yield e.getHiddenCols(t.sheet,t.start,t.endExclusive);return(0,s.success)({result:r})})),[m.ComputationRequestKind.ResolveReferences]:({cache:e,request:{locals:t,nodes:r}})=>{if(void 0===e)return y.logSafeFailure.failure("Cache is undefined");if(void 0===t)return y.logSafeFailure.failure("Locals is undefined");if(void 0===r)return y.logSafeFailure.failure("Nodes is undefined");const n=e.resolveReferences(t,r);return(0,s.success)({resolverResults:n})},[m.ComputationRequestKind.GetCorrespondingSnapshotID]:({cache:e})=>n.__awaiter(void 0,void 0,void 0,(function*(){if(void 0===e)return y.logSafeFailure.failure("Cache is undefined");const t=yield e.getCorrespondingSnapshotID();return(0,s.success)({snapshotID:t})})),[m.ComputationRequestKind.GetEditFormat]:({cache:e,request:{cell:t}})=>n.__awaiter(void 0,void 0,void 0,(function*(){if(void 0===e)return y.logSafeFailure.failure("Cache is undefined");const r=yield e.getEditFormat(t);return(0,s.success)({result:void 0===r?(0,s.failure)((0,g.unavailable)(["Unavailable Format"])):(0,s.success)(r)})})),[m.ComputationRequestKind.UpdateSnapshot]:({handle:e,schedulerState:t})=>n.__awaiter(void 0,void 0,void 0,(function*(){const r=yield t.scheduler.updatePrefetchingCache(e);return void 0===r?y.logSafeFailure.failure("Cache is undefined"):(0,s.success)({snapshotID:r})})),[m.ComputationRequestKind.GetFullTableHeadersFromServer]:({schedulerState:e,request:{tableName:t}})=>n.__awaiter(void 0,void 0,void 0,(function*(){const r=e.serverDataProvider;if((0,i.isNone)(r))return y.logSafeFailure.failure("serverDataProvider is undefined");const n=yield r.getTableColHeaders(t);return(0,i.isNone)(n)?(0,s.success)({result:[]}):(0,s.success)({result:n.filter(i.isDefined)})})),[m.ComputationRequestKind.CreateChatGPTSession]:({schedulerState:{scheduler:e},finalizer:t,request:{options:r}})=>n.__awaiter(void 0,void 0,void 0,(function*(){if(void 0===r)return y.logSafeFailure.failure("Request contained undefined 'options'");const n=yield e.createChatGPTSession(r);return n.kind===s.ResultKind.Success&&t.subscribe((()=>e.closeChatGPTSession(n.value))),C(n,(e=>({result:e})))})),[m.ComputationRequestKind.CloseChatGPTSession]:({schedulerState:{scheduler:e},request:{session:t}})=>n.__awaiter(void 0,void 0,void 0,(function*(){return C(yield e.closeChatGPTSession(t),(()=>({result:void 0})))})),[m.ComputationRequestKind.SendChatGPTQuery]:({schedulerState:{scheduler:e},request:{session:t,request:r}})=>n.__awaiter(void 0,void 0,void 0,(function*(){return C(yield e.sendChatGPTQuery(t,r),(e=>({result:e})))})),[m.ComputationRequestKind.IsSchedulerFeatureEnabled]:({schedulerState:{scheduler:e},request:{feature:t}})=>{const r=e.isSchedulerFeatureEnabled(t);return(0,s.success)({isFeatureEnabled:r})},[m.ComputationRequestKind.SendAugLoopSignal]:({schedulerState:{scheduler:e},handle:t,request:{signal:r}})=>n.__awaiter(void 0,void 0,void 0,(function*(){return C(yield e.sendAugLoopSignal(r,t.info.computationIdentifier.factoryName),(e=>({result:e})))})),[m.ComputationRequestKind.TriggerEvent]:({schedulerState:{scheduler:e},request:{eventKind:t,event:r}})=>(e.triggerEventImmediate(t,r),(0,s.success)({})),[m.ComputationRequestKind.AwaitEvent]:({schedulerState:{scheduler:e},request:t})=>n.__awaiter(void 0,void 0,void 0,(function*(){if((0,S.isALAnnotationEventKind)(t.eventKind)){const r=yield e.registerALAnnotation(t.eventKind);if(r.kind!==s.ResultKind.Success)return r}const r=yield e.catchEvent(t);return(0,s.success)({result:r})})),[m.ComputationRequestKind.GetRecognizedRangeTables]:({schedulerState:{scheduler:e},handle:t,request:{sheetId:r,range:i,metadataStates:o,maxRevisions:a}})=>n.__awaiter(void 0,void 0,void 0,(function*(){return C(yield e.getRecognizedTablesInfo(r,i,o,t.info.computationIdentifier.factoryName,a),(e=>({result:e})))}))},t.processRequest=function(e,t,r,n,i){const{info:{correlationId:o},schedulerState:l,finalizer:u}=r,c=e[t.kind],d={request:t,correlationId:o,cache:n,config:i,schedulerState:l,finalizer:u,handle:r},m=c(d);return(0,a.bindMaybeThenable)(m,(e=>e.kind!==s.ResultKind.Success?y.logSafeFailure.censored(e):(r.schedulerState=d.schedulerState,(0,s.success)(Object.assign({kind:t.kind},e.value)))))},t.processSyncRequest=function(e,t,r,n,i){const{info:{correlationId:o},schedulerState:a,finalizer:l}=r,u={request:t,correlationId:o,cache:n,config:i,schedulerState:a,finalizer:l,handle:r},c=(0,e[t.kind])(u);return c.kind!==s.ResultKind.Success?y.logSafeFailure.censored(c):(r.schedulerState=u.schedulerState,(0,s.success)(Object.assign({kind:t.kind},c.value)))}},59416:function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.getSchedulerFactories=t.dynamicPluginLoaderInsideInit=t.createDynamicPluginLoader=t.PluginSchedulerSingleton=t.GridImportManagerSingleton=void 0;const i=r(42549),o=r(12450),a=r(38869),s=r(37462),l=r(98094),u=r(9707),c=r(58535),d=r(46580),m=(0,o.singleton)((()=>{const e=f().createGridProvider((()=>t.PluginSchedulerSingleton.instance().registerAsyncGrid()));return t.GridImportManagerSingleton.instance().onGridImporterCreated(e,"Main-IGrid"),e}));t.GridImportManagerSingleton=(0,o.singleton)((()=>f().createGridImportManager())),t.PluginSchedulerSingleton=(0,o.singleton)((()=>f().createFormulaBarScheduler(m.instance()))),(0,o.staticAssertExtends)(),t.createDynamicPluginLoader=function(e){return f().createDynamicPluginLoader(t.GridImportManagerSingleton.instance(),t.PluginSchedulerSingleton.instance(),e)};const g=(e,t,...r)=>new s.FormulaBarScheduler((0,u.timelineQueueProcessorFactory)(r[0]),(0,u.createPrefetchingCacheFactory)(e),t,e.getGridDataSink(),e.getSyncDataModel(),...r);t.dynamicPluginLoaderInsideInit=(0,u.dynamicPluginLoaderInsideInit)(u.timelineQueueProcessorFactory,u.createPrefetchingCacheFactory);class p extends s.FormulaBarScheduler{set ComputationFinalizerHandlers(e){this.computationFinalizerHandlers=e}get ComputationFinalizerHandlers(){return this.computationFinalizerHandlers}}const h={Win32:{createFormulaBarScheduler:g,createExperimentFormulaBarScheduler(){throw new Error("Cannot use Experiment Formula Bar Scheduler in win32 context")},createTestableFormulaBarScheduler(){throw new Error("Cannot use Testable Formula Bar Scheduler in win32 context")},createDynamicPluginLoader(){throw new Error("Cannot use Dynamic Plugin Loader in win32 context")},createGridImportManager:()=>({onGridExporterCreated(){},onGridImporterCreated(){}}),createGridProvider(){const e=new d.CacheGrid;return{getGrid:()=>e,getGridDataSink:()=>e,getSyncDataModel:()=>e,createIGridImportEndpoint(){throw new Error("Cannot use createIGridImportEndpoint in win32 context")},onGridExporterClosed(){throw new Error("Cannot use onGridExporterClosed in win32 context")}}}},Web:{createFormulaBarScheduler:g,createDynamicPluginLoader:(...e)=>((e,...t)=>new u.DynamicPluginLoader(e,...t))("excelOnlineCalc.x10.stableDynamicPluginLoaderInsideInit",...e),createGridImportManager:e=>new a.GridImportManager(e),createGridProvider:e=>new a.GridProvider(e),createExperimentFormulaBarScheduler:(e,t,...r)=>{let n;const i=new s.FormulaBarScheduler((e=>(n=new l.ExperimentQueueProcessor(e),n)),(0,u.createPrefetchingCacheFactory)(e),t,e.getGridDataSink(),e.getSyncDataModel(),...r);if(void 0===n)throw"not initialized";return[i,n]},createTestableFormulaBarScheduler:(e,t,...r)=>new p((0,u.timelineQueueProcessorFactory)(r[0]),(0,u.createPrefetchingCacheFactory)(e),t,e.getGridDataSink(),e.getSyncDataModel(),...r)}};function f(){return h[c.platform]}if(t.getSchedulerFactories=f,(0,i.getTypedFeatureGate)("TESTING_ONLY_SCHEDULER_IMPORTSCRIPTS_FAIL")&&(self.__retries=(null!==(n=self.__retries)&&void 0!==n?n:-1)+1,0===self.__retries))throw""},1508:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultPluginResponseWindows=void 0;const n=r(50111),i=r(12450);t.defaultPluginResponseWindows={[n.RequestKind.functionSuggestion]:{startDelta:5,stopDelta:2e3},[n.RequestKind.inCellSuggestion]:{startDelta:5,stopDelta:2e3},[n.RequestKind.formulaHighlighting]:{startDelta:5,stopDelta:2e3},[n.RequestKind.argumentAssistance]:{startDelta:5,stopDelta:2e3},[n.RequestKind.valuePreview]:{startDelta:5,stopDelta:2e3},[n.RequestKind.gotoCtrlClick]:{startDelta:5,stopDelta:2e3},[n.RequestKind.formulaRepair]:{startDelta:5,stopDelta:2e3},[n.RequestKind.runExperiment]:{startDelta:0,stopDelta:15e3},[n.RequestKind.runAuthoringExperiment]:{startDelta:0,stopDelta:15e3},[n.RequestKind.runPerCharacterExperiment]:{startDelta:5,stopDelta:2e3},[n.RequestKind.runTest]:{startDelta:0,stopDelta:15e3},[n.RequestKind.chatGPTQuery]:{startDelta:0,stopDelta:15e3},[n.RequestKind.columnFormulaSuggestion]:{startDelta:0,stopDelta:2e4},[n.RequestKind.setCellPrefetch]:{startDelta:5,stopDelta:2e3},[n.RequestKind.getTranspiledFormulas]:{startDelta:0,stopDelta:5e3}},(0,i.staticAssertExtends)(),(0,i.staticAssertExtends)(),(0,i.staticAssertExtends)()},47455:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapRequest=t.wrapSyncRequest=t.InternalSchedulerResponseKind=void 0;const n=r(57264),i=r(12450),o=r(50111);var a;function s(e,t){switch(e.kind){case o.ComputationRequestKind.Delay:case o.ComputationRequestKind.CreateTask:case o.ComputationRequestKind.PromiseToTask:case o.ComputationRequestKind.GetActiveCell:case o.ComputationRequestKind.GetActiveCellFormat:case o.ComputationRequestKind.GetConfig:case o.ComputationRequestKind.GetCultureTag:case o.ComputationRequestKind.GetCorrelationId:case o.ComputationRequestKind.GetFunctionInfo:case o.ComputationRequestKind.GetFunctionsInfo:case o.ComputationRequestKind.GetDefinedNameInfo:case o.ComputationRequestKind.GetDefinedNamesInfo:case o.ComputationRequestKind.SetActiveCell:case o.ComputationRequestKind.IsSchedulerFeatureEnabled:case o.ComputationRequestKind.TriggerEvent:return{kind:o.SchedulerTimelineQueueMessageKind.NoOpRequest,request:e,computation:t};case o.ComputationRequestKind.GetSheetNames:case o.ComputationRequestKind.GetAvailableTableHeaders:case o.ComputationRequestKind.ParseCellFormula:case o.ComputationRequestKind.ParseNumberFormat:case o.ComputationRequestKind.PrintFormula:case o.ComputationRequestKind.ParseActiveCell:case o.ComputationRequestKind.ResolveReferences:case o.ComputationRequestKind.UnsafeGetContainingTableName:case o.ComputationRequestKind.UnsafeGetIntersectingTableNames:case o.ComputationRequestKind.GetStructRefColumn:case o.ComputationRequestKind.GetStructRefSpecialRef:return{kind:o.SchedulerTimelineQueueMessageKind.SyncRequest,request:e,computation:t};default:(0,n.assertNever)(`unknown request: ${e}`,e)}}!function(e){e[e.FirstStep=0]="FirstStep",e[e.NormalResponse=1]="NormalResponse",e[e.RequestFailure=2]="RequestFailure"}(a||(t.InternalSchedulerResponseKind=a={})),(0,i.staticAssertExtends)(),t.wrapSyncRequest=s,t.wrapRequest=function(e,t){switch(e.kind){case o.ComputationRequestKind.GetRange:case o.ComputationRequestKind.GetCell:case o.ComputationRequestKind.GetContainingTable:case o.ComputationRequestKind.GetIntersectingTables:case o.ComputationRequestKind.GetIformat:case o.ComputationRequestKind.AwaitPromise:case o.ComputationRequestKind.AwaitTask:case o.ComputationRequestKind.AwaitBatch:case o.ComputationRequestKind.AwaitAll:case o.ComputationRequestKind.AwaitAny:case o.ComputationRequestKind.ParseEdit:case o.ComputationRequestKind.GetRichValueFieldListContext:case o.ComputationRequestKind.GetHiddenRows:case o.ComputationRequestKind.GetHiddenCols:case o.ComputationRequestKind.EvalOnClonedModel:case o.ComputationRequestKind.EvalFormula:case o.ComputationRequestKind.GetCorrespondingSnapshotID:case o.ComputationRequestKind.GetEditFormat:case o.ComputationRequestKind.UpdateSnapshot:case o.ComputationRequestKind.GetFullTableHeadersFromServer:case o.ComputationRequestKind.CreateChatGPTSession:case o.ComputationRequestKind.CloseChatGPTSession:case o.ComputationRequestKind.SendChatGPTQuery:case o.ComputationRequestKind.SendAugLoopSignal:case o.ComputationRequestKind.AwaitEvent:case o.ComputationRequestKind.GetRecognizedRangeTables:return{kind:o.SchedulerTimelineQueueMessageKind.AsyncRequest,request:e,computation:t};default:return s(e,t)}},(0,i.staticAssertExtends)(),(0,i.staticAssertExtends)(),(0,i.staticAssertExtends)(),(0,i.staticAssertExtends)()},85270:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncDataModel=t.MaxStateIdDifferenceForGC=void 0;const n=r(23623),i=r(58293),o=r(31053),a=r(67396),s=r(43364),l=r(7793),u=r(33436),c=r(50338),d=r(85304),m=()=>{};t.MaxStateIdDifferenceForGC=17,t.SyncDataModel=class{get document(){return this.dataTransformer.document}getStateAsNotifications(){return[...this.configNotifications,...this.getSheetStateAsNotifications(),...this.getNameStateAsNotifications(),...this.getSchedulerFeaturesAsNotifications()]}getSchedulerFeaturesAsNotifications(){return[[d.NotificationKind.setSchedulerFeatures,[this.schedulerFeatures]]]}getSheetStateAsNotifications(){const e=[];return this.sheets.forEachSheet(((t,r)=>{e.push((0,o.sheetName)(r,t.name))})),e.length>0?[[d.NotificationKind.updateSheetNames,[this.stateId,e]]]:[]}getNameStateAsNotifications(){const e=[],t=t=>{const r=[];t.forEachAvailableName(((e,t)=>{const n=(0,i.namedObjectToNamedObjectData)(this.config.mathpack,this.dataTransformer.document,null==t?void 0:t.obj);return r.push((0,o.namedObject)(e,n)),!0})),r.length>0&&e.push((0,o.namedObjectsWrite)(t.scope.index,r)),t.allAvailable()&&e.push((0,o.undefinedNamesWrite)(t.scope.index))},r=this.nameManager.getNamesBySheetId(void 0);return(0,u.isSuccess)(r)&&t(r.value),this.nameManager.forEachSheetScope((e=>{t(e)})),e.length>0?[[d.NotificationKind.updateNamedObjects,[this.stateId,e]]]:[]}trySetStateId(e,r){if(r<this.stateId)return!1;if(r>this.stateId){const e=this.stateId;if(this.stateId=r,this.sheets.advanceState(e),this.nameManager.advanceState(e),this.stateChangesSinceLastGC+=1,this.stateChangesSinceLastGC>=t.MaxStateIdDifferenceForGC){this.stateChangesSinceLastGC=0;const e=this.stateId-t.MaxStateIdDifferenceForGC;this.nameManager.collectGarbage(e)}}return!0}clearCompiledFormulas(){this.nameManager.resetLazyData()}clearCompiledNumberFormats(){}setA1ReferenceStyle(e){this.configNotifications.push([d.NotificationKind.setA1ReferenceStyle,[e]]),this.dataTransformer.setA1ReferenceStyle(this,this.stateId,e)}setLocale(e){this.configNotifications.push([d.NotificationKind.setLocale,[e]]),this.dataTransformer.setLocaleInfo(this,this.stateId,e,{})}setWorkbookProps(e){this.configNotifications.push([d.NotificationKind.setWorkbookProps,[e]]),this.dataTransformer.setWorkbookProps(this,this.stateId,e,{})}updateSheetNames(e,t){this.dataTransformer.updateSheetNames(this,e,t,{})}updateNamedObjects(e,t){this.dataTransformer.updateNamedObjects(this,e,t,{})}setSchedulerFeatures(e){this.schedulerFeatures=e}setLangConfig(e,t){if(!this.trySetStateId(!0,e))return;const r=this.config.localeInfo!==t.localeInfo,n=this.config.refStyle!==t.refStyle;this.config=t,r&&this.clearCompiledNumberFormats(),(r||n)&&this.clearCompiledFormulas()}setSheetNames(e,t,r){this.trySetStateId(!0,r)&&(this.sheets=this.sheets.setSheetNames(t),this.nameManager=this.nameManager.setSheetNames(t))}writeNamedObject(e,t,r,n){if(!this.trySetStateId(!0,e))return;const i=this.nameManager.setNamedObject(!0,(0,l.nameLoc)(t,r),n,m);(0,u.isSuccess)(i)}writeUndefinedNames(e,t){if(!this.trySetStateId(!0,e))return;const r=this.nameManager.setUndefinedNames(t);(0,u.isSuccess)(r)}promoteNamedObjects(e,t,r){if(!this.trySetStateId(!0,e))return;const n=this.nameManager.promoteNamedObjects(t,r);(0,u.isSuccess)(n)&&n.value}getDocumentLoc(e,t){const r=this.dataTransformer.document;return void 0!==e&&e!==r.path||0!==this.config.localeInfo.stringCompareCI(t,r.name)?(0,u.failure)((0,c.unavailable)([(0,l.documentLoc)(e,t)])):(0,u.success)(r)}getSheetIndex(e,t){const r=this.sheets.getSheetByName(t);return(0,u.isSuccess)(r)?void 0===r.value?r:(0,u.success)(r.value.sheetIndex.index):r}getSheetName(e,t){const r=this.sheets.getSheetById(t);return(0,u.isSuccess)(r)?(0,u.success)(r.value.name):r}getNameLoc(e,t,r){return this.nameManager.getNameLoc(e.index,t,r)}getUserDefinedFuncLoc(e,t){return(0,u.failure)((0,c.notImplemented)(["call UDF"]))}getSheetRangeIndexes(e){return this.sheets.getSheetRangeIds(e)}getContainingTable(e){return this.nameManager.getContainingTable(e)}getStructRefColumn(e,t){return this.nameManager.getStructRefColumn(e,t)}getStructRefSpecialRef(e,t){return this.nameManager.getStructRefSpecialRef(e,t)}getTime(){return(0,u.failure)((0,c.unavailable)(["getTime"]))}constructor(){this.dataTransformer=new n.RecalcServiceDataTransformer,this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.config=this.dataTransformer.getLangConfig(),this.configNotifications=[],this.sheets=new a.PartialWorkbookSheets(this.dataTransformer.document,this.config.localeInfo.stringCompareCI),this.nameManager=new s.PartialWorkbookNameManager(this.dataTransformer.document,this.config.localeInfo.stringCompareCI),this.schedulerFeatures=[]}}},59059:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runQueueProcessorUntil=void 0;const n=r(90277);t.runQueueProcessorUntil=n.testUtils.runQueueProcessorUntil},11137:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flaky=t.YarnExecutionArgs=t.GateOverrideManager=t.testingCGOverrides=void 0;const n=r(42549),i=r(12367),o=r(12367),a=r(12450),s=[];t.testingCGOverrides=[],0===s.length?t.testingCGOverrides.push(void 0):s.forEach((e=>t.testingCGOverrides.push({[e]:!0},{[e]:!1}))),t.GateOverrideManager=class{override(e){return{changeGates:(0,a.isDefined)(e.changeGates)?(0,o.overrideTypedChangeGates)(n.isTypedChangeGateEnabled,e.changeGates):void 0,featureGates:(0,a.isDefined)(e.featureGates)?(0,n.overrideTypedFeatureGates)(n.getTypedFeatureGate,e.featureGates):void 0}}revert(e){(0,i.setChangeGateDictionaryGetter)(e.changeGates),(0,n.setFeatureGateDictionaryGetter)(e.featureGates)}};class l{static get instance(){return(0,a.isDefined)(this._instance)||(this._instance=new l),this._instance}constructor(){var e,t;this.args=[],this.args=null!==(t=JSON.parse(null!==(e={NODE_ENV:"production"}.npm_config_argv)&&void 0!==e?e:"{}").original)&&void 0!==t?t:[]}}t.YarnExecutionArgs=l,l.has=e=>l.instance.args.findIndex((t=>t===e))>=0,t.flaky=()=>l.has("--flaky")?it:it.skip},57814:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultTimerInterface=t.TimelineQueueProcessor=void 0;const n=r(90277);t.TimelineQueueProcessor=n.timelineQueueProcessor.TimelineQueueProcessor,t.defaultTimerInterface=n.timelineQueueProcessor.defaultTimerInterface},53507:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.trackableAsyncLazy=t.TrackableAsyncLazy=void 0;const n=r(19181),i=r(81476),o=r(83567),a=r(12450);class s extends i.ResettableLazy{reset(){throw new Error("Resetting a TrackableAsyncLazy is not allowed")}constructor(e,t,r=a.now){super((()=>n.__awaiter(this,void 0,void 0,(function*(){const t=r(),n=e(),i=r()-t,a=yield n,s=r()-t-i;return o.x10Logger.log({kind:"trackableAsyncLazy",payload:{name:this.name,syncTime:i,asyncTime:s}}),a})))),this.name=t}}t.TrackableAsyncLazy=s,t.trackableAsyncLazy=function(e,t,r=a.now){return new s(e,t,r)}},20210:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendX10UsedTelemetryEvent=t.createX10RequestPerformanceEvent=t.createX10AggregatedTelemetryEvent=t.addSampleWithProbability=t.getHistogramBinIndexForDuration=t.updateDurationHistogramsWithRequestTimes=t.histogramBinCount=t.REQUEST_DURATION_THRESHOLDS=void 0;const n=r(12450),i=r(83611),o=r(45851),a=r(33393);t.REQUEST_DURATION_THRESHOLDS=[5,10,20,50,100,200],t.histogramBinCount=t.REQUEST_DURATION_THRESHOLDS.length+1;const s=new i.JSF32(0);let l=!1;function u(e){for(let r=0;r<t.REQUEST_DURATION_THRESHOLDS.length;r++)if(e<t.REQUEST_DURATION_THRESHOLDS[r])return r;return t.REQUEST_DURATION_THRESHOLDS.length}function c(){return{dataCategories:o.EnumObjects.DataCategories.ProductServiceUsage,samplingPolicy:o.EnumObjects.SamplingPolicy.Measure,diagnosticLevel:o.EnumObjects.DiagnosticLevel.Optional}}t.updateDurationHistogramsWithRequestTimes=function(e,r){var i;return(i=r,Object.entries(i)).forEach((([r,i])=>{var o;if((0,n.isDefined)(i)&&i.numberOfRequests>0){const n=u(i.requestDuration/i.numberOfRequests),a=null!==(o=e[r])&&void 0!==o?o:Array(t.histogramBinCount).fill(0);a[n]+=i.numberOfRequests,e[r]=a}})),e},t.getHistogramBinIndexForDuration=u,t.addSampleWithProbability=function(e,t,r){return function(e){return e>=0&&e<=1}(r)&&s.next()<r&&e.push(t),e},t.createX10AggregatedTelemetryEvent=function(e){return{eventName:"Office.Excel.Client.X10.AggregatedTelemetry",eventFlags:c(),dataFields:[(0,o.makeStringDataField)("X10AggregatedTelemetryObject",e)]}},t.createX10RequestPerformanceEvent=function(e){return{eventName:"Office.Excel.Client.X10.RequestPerformance",eventFlags:c(),dataFields:[(0,o.makeStringDataField)("X10RequestPerformanceTelemetryObject",e)]}},t.sendX10UsedTelemetryEvent=function(){l||((0,a.getTelemetryLogger)().sendTelemetryEvent({eventName:"Office.Excel.Client.X10.X10UsedEvent",eventFlags:c()}),l=!0)}},58821:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.X10ExceptionComputationTermination=t.X10Exception=void 0;class r extends Error{}t.X10Exception=r,t.X10ExceptionComputationTermination=class extends r{constructor(e){super(`Computation execution was terminated with '${e}'.`),this.stopReason=e}}},83567:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.x10Logger=t.CombinedLogger=t.ImmediateLogger=t.X10FailureKind=t.LoggerKind=void 0;const n=r(12450),i=r(57264),o=r(55340),a=r(18538),s=r(42549),l=r(20210),u=r(84565),c=r(33393),d="Main",m=(0,s.isTypedChangeGateEnabled)("OfficeVSO:8786821_x10SendLoggerMessagesToMainThread"),g=(0,s.isTypedChangeGateEnabled)("OfficeVSO:8846142_x10SendTelemetryWithUTel");var p,h;!function(e){e.Immediate="Immediate",e.Aggregating="Aggregating"}(p||(t.LoggerKind=p={})),function(e){e.ALFailure="ALFailure",e.AssertionFailure="AssertionFailure",e.CustomConflictResolverFailure="CustomConflictResolverFailure",e.EventCallbacksManagerFailure="EventCallbacksManagerFailure",e.GridFailure="GridFailure",e.NotificationProcessorFailure="NotificationProcessorFailure",e.PluginAttachmentFailure="PluginAttachmentFailure",e.PluginFailure="PluginFailure",e.RequestProcessorFailure="RequestProcessorFailure",e.TableIntelligenceFailure="TableIntelligenceFailure"}(h||(t.X10FailureKind=h={}));const f=(e,t,r)=>`x10arch.[${e}].${t}: ${(0,n.isDefined)(r.description)&&r.description.length?`${r.description}. `:""}${(0,n.isDefined)(r.data)?JSON.stringify(r.data):""}`;(0,n.staticAssertSame)();const S={trackableAsyncLazy:(e,t)=>i.ulsLogger.ULS.traceTag(507316304,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,f(e,"trackableAsyncLazy",{data:t})),snapshotCreation:(e,t)=>i.ulsLogger.ULS.traceTag(512305240,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,f(e,"snapshotCreation",{data:t})),beginRequest:(e,t)=>i.ulsLogger.ULS.traceTag(553734792,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,f(e,"beginRequest",{data:t})),requestSkipped:(e,t)=>i.ulsLogger.ULS.traceTag(553734793,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,f(e,"requestSkipped",{data:t})),registerPluginFactory:(e,{factoryName:t})=>i.ulsLogger.ULS.traceTag(571246212,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,f(e,"registerPluginFactory",{description:`registered ${a.PluginFactoryName[t]}`})),pluginCompletedInTime:(e,{pluginName:t,logInfo:r})=>i.ulsLogger.ULS.traceTag(553734790,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,f(e,"pluginCompletedInTime",{description:`plugin completed in time. plugin name:${t}`,data:r})),computationStoppedExecution:(e,{computationName:t,stopReason:r,logInfo:n})=>i.ulsLogger.ULS.traceTag(509109120,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,f(e,"pluginStoppedExecution",{data:Object.assign({computationName:t,stopReason:r},n)})),closeComputationFrame:(e,t)=>i.ulsLogger.ULS.traceTag(553734789,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,f(e,"closeUIMessageFrame",{data:t})),nullCheckViolation:(e,t)=>i.ulsLogger.ULS.traceTag(507803776,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,f(e,"nullCheckViolation",{data:t})),failure:(e,{failureKind:t,failureLevel:r,path:n,description:a,data:s})=>i.ulsLogger.ULS.traceTag(507322970,o.LogCategory.msoulscat_ES_EWAJS,r,f(e,n,{description:a,data:Object.assign({failureKind:t,failureLevel:r},s)}))},v={trackableAsyncLazy:{},snapshotCreation:{numSnapshots:0,numFreshSnapshots:0},beginRequest:{},requestSkipped:{},registerPluginFactory:{factories:[]},pluginCompletedInTime:{},computationStoppedExecution:{computationsStopReason:{},requestDurationHistograms:{},requestDurationHistogramByComputationKind:{},schedulerTimeSamples:[],computationTimeSamples:[]},closeComputationFrame:{},nullCheckViolation:{},failure:{}},y={trackableAsyncLazy:(e,{name:t,syncTime:r,asyncTime:n})=>{var i,o,a,s,l,u;return Object.assign(Object.assign({},e),{[t]:{numCalls:(null!==(o=null===(i=e[t])||void 0===i?void 0:i.numCalls)&&void 0!==o?o:0)+1,totalSyncTime:(null!==(s=null===(a=e[t])||void 0===a?void 0:a.totalSyncTime)&&void 0!==s?s:0)+r,totalAsyncTime:(null!==(u=null===(l=e[t])||void 0===l?void 0:l.totalAsyncTime)&&void 0!==u?u:0)+n}})},snapshotCreation:({numSnapshots:e,numFreshSnapshots:t},r)=>({numSnapshots:e+1,numFreshSnapshots:t+(r?1:0)}),beginRequest:(e,{computationKind:t})=>{var r;return Object.assign(Object.assign({},e),{[t]:(null!==(r=e[t])&&void 0!==r?r:0)+1})},requestSkipped:(e,{computationKind:t})=>{var r;return Object.assign(Object.assign({},e),{[t]:(null!==(r=e[t])&&void 0!==r?r:0)+1})},registerPluginFactory:({factories:e},{factoryName:t})=>({factories:[...e,a.PluginFactoryName[t]]}),pluginCompletedInTime:(e,{pluginName:t})=>{var r;return Object.assign(Object.assign({},e),{[t]:(null!==(r=e[t])&&void 0!==r?r:0)+1})},computationStoppedExecution:({computationsStopReason:e,requestDurationHistograms:t,requestDurationHistogramByComputationKind:r,schedulerTimeSamples:n,computationTimeSamples:i},{computationName:o,stopReason:a,logInfo:{requestTimes:s,computationTime:u,schedulerTime:c}})=>{var d,m,g;return{computationsStopReason:Object.assign(Object.assign({},e),{[o]:Object.assign(Object.assign({},e[o]),{[a]:(null!==(m=null===(d=e[o])||void 0===d?void 0:d[a])&&void 0!==m?m:0)+1})}),requestDurationHistograms:(0,l.updateDurationHistogramsWithRequestTimes)(t,s),requestDurationHistogramByComputationKind:Object.assign(Object.assign({},r),{[o]:(0,l.updateDurationHistogramsWithRequestTimes)(null!==(g=r[o])&&void 0!==g?g:{},s)}),schedulerTimeSamples:(0,l.addSampleWithProbability)(n,c,5e-4),computationTimeSamples:(0,l.addSampleWithProbability)(i,u,5e-4)}},closeComputationFrame:(e,t)=>{var r,n;return Object.assign(Object.assign({},e),{[t.computationKind]:Object.assign(Object.assign({},e[t.computationKind]),{[t.stopReason]:(null!==(n=null===(r=e[t.computationKind])||void 0===r?void 0:r[t.stopReason])&&void 0!==n?n:0)+1})})},nullCheckViolation:(e,{requestKind:t,violations:r})=>{var n,i;return Object.assign(Object.assign({},e),{[t]:Object.assign(Object.assign({},e[t]),{[r.join(";")]:(null!==(i=null===(n=e[t])||void 0===n?void 0:n[r.join(";")])&&void 0!==i?i:0)+1})})},failure:(e,{failureKind:t,failureLevel:r})=>{var n,i;return Object.assign(Object.assign({},e),{[t]:Object.assign(Object.assign({},e[t]),{[r]:(null!==(i=null===(n=e[t])||void 0===n?void 0:n[r])&&void 0!==i?i:0)+1})})}};class F{log(e,t){this.isMessageForAnotherLogger(t)||((0,s.getTypedFeatureGate)("Microsoft.Office.Excel.EnableFullSessionLogging")||"failure"===e.kind)&&S[e.kind](this.threadId,e.payload)}flush(){}flushBufferedMessages(){return[]}get threadId(){return this._threadId}set threadId(e){this._threadId=e}isMessageForAnotherLogger(e){return(0,n.isDefined)(e)&&e!==p.Immediate}constructor(){this._threadId=d,this.formatLogMessage=(e,t)=>f(this.threadId,e,t)}}t.ImmediateLogger=F;class C{log(e,t){this.isMessageForAnotherLogger(t)||(this.shouldBufferLogMessages()?((0,u.staticTypeHint)(e),this.logMessageBuffer.push([e,p.Aggregating])):(this.loggingStates[e.kind]=y[e.kind](this.loggingStates[e.kind],e.payload),this.periodicFlush(e.kind)))}flush(){if(this.shouldBufferLogMessages())return;const{requestDurationHistogramByComputationKind:e}=this.loggingStates.computationStoppedExecution;this.loggingStates.computationStoppedExecution.requestDurationHistogramByComputationKind={};const t=this.formatLogMessage("AgggregationLogger.flush",{description:"summary logs for session",data:this.loggingStates}),r=this.formatLogMessage("AgggregationLogger.flush",{description:"request duration histogram by computation kind",data:e});if(i.ulsLogger.ULS.traceTag(512274703,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,t),g&&this.threadId===d){const e=(0,c.getTelemetryLogger)();e.sendTelemetryEvent((0,l.createX10AggregatedTelemetryEvent)(t)),e.sendTelemetryEvent((0,l.createX10RequestPerformanceEvent)(r))}}periodicFlush(e){"closeComputationFrame"===e&&(this.closeComputationFrameCount++,this.closeComputationFrameCount>=this.nextFlushThreshold&&(this.nextFlushThreshold*=1.33,this.flush()))}flushBufferedMessages(){const e=this.logMessageBuffer;return this.logMessageBuffer=[],e}get threadId(){return this._threadId}set threadId(e){this._threadId=e}shouldBufferLogMessages(){return m&&this.threadId!==d}isMessageForAnotherLogger(e){return(0,n.isDefined)(e)&&e!==p.Aggregating}constructor(){this.loggingStates=Object.assign({},v),this._threadId=d,this.logMessageBuffer=[],this.closeComputationFrameCount=0,this.nextFlushThreshold=4,this.formatLogMessage=(e,t)=>f(this.threadId,e,t)}}class R{log(e,t){this.immediateLogger.log(e,t),this.aggregatingLogger.log(e,t)}flush(){this.immediateLogger.flush(),this.aggregatingLogger.flush()}flushBufferedMessages(){return[...this.immediateLogger.flushBufferedMessages(),...this.aggregatingLogger.flushBufferedMessages()]}get threadId(){return this._threadId}set threadId(e){this._threadId=e,this.immediateLogger.threadId=e,this.aggregatingLogger.threadId=e}constructor(){this._threadId=d,this.immediateLogger=new F,this.aggregatingLogger=new C,this.formatLogMessage=(e,t)=>f(this.threadId,e,t)}}t.CombinedLogger=R,t.x10Logger=new R},7863:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setX10Features=t.ensurePluginAttached=t.ensureGroupAttachedLegacy=t.ensureGroupAttached=t.spanToLSPRange=t.ValuePreviewResultExtractor=t.ValuePreviewPluginFactory=t.ColoredReferencesPluginFactory=t.ParenthesesCouplingPluginFactory=t.AutocompleteTableHeadersPluginFactory=t.AutocompleteNamedObjectsPluginFactory=t.AutocompleteRichValuePluginFactory=t.AutocompleteLetPluginFactory=t.AutocompleteEnumPluginFactory=t.AutocompleteFunctionPluginFactory=t.ArgumentAssistancePluginFactory=t.PluginRegistry=t.ALAnnotationKind=t.EventKind=t.ExecutionType=t.ComputationType=t.NotificationKind=t.RequestKind=t.delay=t.wrapIntoAsync=t.awaitPromise=t.typedRequest=t.PluginRequestKind=t.ComputationRequestKind=t.stableDynamicPluginLoaderInsideInit=t.DefaultComputationGroup=t.registerPluginFactory=t.PluginFactoryName=t.PluginGroup=t.MockTimerImmediate=t.setMockGridSheetAndNotify=t.createMockGridExporter=t.createMockGridProvider=t.createMockAsyncGrid=t.RecalcSideGrid=t.SchedulerVersionCompatibility=t.FormulaKind=t.GridImportManagerSingleton=t.PluginSchedulerSingleton=t.getSchedulerFactories=t.defaultPluginResponseWindows=t.ChatGPTPlugin=t.staticTypeHint=t.core=t.platform=void 0,t.Test=t.TestGateOverrideManager=t.runQueueProcessorUntil=t.VisitorHelpers=t.RangeHelpers=t.TimelineQueueProcessor=t.defaultTimerInterface=t.resolveScriptLoaderPromise=void 0;const n=r(19181),i=n.__importStar(r(12450)),o=n.__importStar(r(84565)),a=n.__importStar(r(1508)),s=n.__importStar(r(59416)),l=n.__importStar(r(32612)),u=n.__importStar(r(14865)),c=n.__importStar(r(78469)),d=n.__importStar(r(50111)),m=n.__importStar(r(85304)),g=n.__importStar(r(83781)),p=n.__importStar(r(77114)),h=n.__importStar(r(29712)),f=n.__importStar(r(67031)),S=n.__importStar(r(40541)),v=n.__importStar(r(34059)),y=n.__importStar(r(30887)),F=n.__importStar(r(45642)),C=n.__importStar(r(48006)),R=n.__importStar(r(17366)),b=n.__importStar(r(11351)),E=n.__importStar(r(59898)),T=n.__importStar(r(72959)),k=n.__importStar(r(94746)),P=n.__importStar(r(73586)),N=n.__importStar(r(77226)),A=n.__importStar(r(57814)),I=n.__importStar(r(81466)),O=n.__importStar(r(90154)),_=n.__importStar(r(8792)),M=n.__importStar(r(16447)),D=n.__importStar(r(65248)),w=n.__importStar(r(18538)),L=n.__importStar(r(42399)),x=n.__importStar(r(65290)),K=n.__importStar(r(59059)),U=n.__importStar(r(11137)),B=n.__importStar(r(93197));var G=r(58535);Object.defineProperty(t,"platform",{enumerable:!0,get:function(){return G.platform}}),t.core=i,t.staticTypeHint=o.staticTypeHint,t.ChatGPTPlugin=I.ChatGPTPlugin,t.defaultPluginResponseWindows=a.defaultPluginResponseWindows,t.getSchedulerFactories=s.getSchedulerFactories,t.PluginSchedulerSingleton=s.PluginSchedulerSingleton,t.GridImportManagerSingleton=s.GridImportManagerSingleton,t.FormulaKind=g.FormulaKind,t.SchedulerVersionCompatibility=d.SchedulerVersionCompatibility,t.RecalcSideGrid=k.RecalcSideGrid,t.createMockAsyncGrid=l.createMockAsyncGrid,t.createMockGridProvider=l.createMockGridProvider,t.createMockGridExporter=l.createMockGridExporter,t.setMockGridSheetAndNotify=l.setMockGridSheetAndNotify,t.MockTimerImmediate=u.MockTimerImmediate,t.PluginGroup=w.PluginGroup,t.PluginFactoryName=w.PluginFactoryName,t.registerPluginFactory=c.registerPluginFactory,t.DefaultComputationGroup=d.DefaultComputationGroup,t.stableDynamicPluginLoaderInsideInit=s.dynamicPluginLoaderInsideInit,t.ComputationRequestKind=d.ComputationRequestKind,t.PluginRequestKind=d.ComputationRequestKind,t.typedRequest=d.typedRequest,t.awaitPromise=d.awaitPromise,t.wrapIntoAsync=T.wrapIntoAsync,t.delay=d.delay,t.RequestKind=d.RequestKind,t.NotificationKind=m.NotificationKind,t.ComputationType=M.ComputationType,t.ExecutionType=D.ExecutionType,t.EventKind=O.EventKind,t.ALAnnotationKind=O.ALAnnotationKind,t.PluginRegistry=_.PluginRegistry,t.ArgumentAssistancePluginFactory=p.ArgumentAssistancePluginFactory,t.AutocompleteFunctionPluginFactory=h.AutocompleteFunctionPluginFactory,t.AutocompleteEnumPluginFactory=f.AutocompleteEnumPluginFactory,t.AutocompleteLetPluginFactory=S.AutocompleteLetPluginFactory,t.AutocompleteRichValuePluginFactory=v.AutocompleteRichValuePluginFactory,t.AutocompleteNamedObjectsPluginFactory=y.AutocompleteNamedObjectsPluginFactory,t.AutocompleteTableHeadersPluginFactory=F.AutocompleteTableHeadersPluginFactory,t.ParenthesesCouplingPluginFactory=C.ParenthesesCouplingPluginFactory,t.ColoredReferencesPluginFactory=R.ColoredReferencesPluginFactory,t.ValuePreviewPluginFactory=P.ValuePreviewPluginFactory,t.ValuePreviewResultExtractor=N.ValuePreviewResultExtractor,t.spanToLSPRange=b.spanToLSPRange,t.ensureGroupAttached=E.ensureGroupAttached,t.ensureGroupAttachedLegacy=E.ensureGroupAttachedLegacy,t.ensurePluginAttached=E.ensurePluginAttached,t.setX10Features=E.setX10Features,t.resolveScriptLoaderPromise=E.resolveScriptLoaderPromise,t.defaultTimerInterface=A.defaultTimerInterface,t.TimelineQueueProcessor=A.TimelineQueueProcessor,t.RangeHelpers=L,t.VisitorHelpers=x,t.runQueueProcessorUntil=K.runQueueProcessorUntil,t.TestGateOverrideManager=U.GateOverrideManager,t.Test=B},59349:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=void 0;var r={},n="promises";t.promises=function(){return void 0===r[n]&&(r[n]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&"function"==typeof Promise.resolve(0).then),r[n]}},39267:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=void 0,t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof self?self:window,n=r.crypto||r.msCrypto;if(n){t.crypto=!0;try{return n.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: ".concat(JSON.stringify(e)))}}var i=!1,o=r.performance;try{o&&o.now&&o.now()!==1/0&&(i=!0)}catch(e){t.exceptions.push("perfNow: ".concat(JSON.stringify(e)))}for(var a=0;a<e.length;a+=1){try{if(i){t.perfNow=!0;var s=Math.floor(100*o.now())%10;(s<0||s>9)&&(s=0);for(var l=0;l<s;l+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: ".concat(JSON.stringify(e)))}e[a]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[r];return r+=1,("x"===t?n:3&n|8).toString(16)})),t]}},12293:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReplaceChildrenSupported=t.replaceChildren=void 0,t.replaceChildren=function(e){if(e)if((0,t.isReplaceChildrenSupported)(e))e.replaceChildren();else for(;e.lastChild;)e.removeChild(e.lastChild)},t.isReplaceChildrenSupported=function(e){return!!e.replaceChildren}},43512:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=t.initStopwatchFactory=t.ConsoleLogger=t.NulLogger=t.perfWatch=t.browserSupport=t.LogCategory=t.TraceLevel=t.ULS=t.utils=t.replaceChildren=t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=t.getNewGuid=void 0;var n=r(24289);t.utils=n;var i=r(28118);Object.defineProperty(t,"ULS",{enumerable:!0,get:function(){return i.ULS}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return i.TraceLevel}}),Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return i.LogCategory}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return i.NulLogger}}),Object.defineProperty(t,"ConsoleLogger",{enumerable:!0,get:function(){return i.ConsoleLogger}});var o=r(59349);t.browserSupport=o;var a=r(46742);t.perfWatch=a;var s=r(60471);Object.defineProperty(t,"initStopwatchFactory",{enumerable:!0,get:function(){return s.initStopwatchFactory}});var l=r(80908);Object.defineProperty(t,"TelemetryCollector",{enumerable:!0,get:function(){return l.TelemetryCollector}});var u=r(39267);Object.defineProperty(t,"getNewGuid",{enumerable:!0,get:function(){return u.getNewGuid}});var c=r(46478);Object.defineProperty(t,"TextAreaVirtualKeyboardPolicy",{enumerable:!0,get:function(){return c.TextAreaVirtualKeyboardPolicy}}),Object.defineProperty(t,"TextAreaInputMode",{enumerable:!0,get:function(){return c.TextAreaInputMode}});var d=r(12293);Object.defineProperty(t,"replaceChildren",{enumerable:!0,get:function(){return d.replaceChildren}})},28118:function(e,t){"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(t.TraceLevel=r={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(n||(t.LogCategory=n={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,n){return t.traceTag(0,e,r,n)},traceTag:function(e,r,n,i){return t.traceTag(e,r,n,i)},debugTrace:function(e,r,n){return t.debugTraceTag(0,e,r,n)},debugTraceTag:function(e,r,n,i){return t.debugTraceTag(e,r,n,i)},assert:function(e,r,n){return t.assertTag(0,e,r,n)},assertTag:function(e,r,n,i){return t.assertTag(e,r,n,i)},shipAssert:function(e,r,n){return t.shipAssertTag(0,e,r,n)},shipAssertTag:function(e,r,n,i){return t.shipAssertTag(e,r,n,i)},dnmTrace:function(e,r,n){return t.dnmTraceTag(0,e,r,n)},dnmTraceTag:function(e,r,n,i){return t.dnmTraceTag(e,r,n,i)}}}}};var i=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){console.assert(r,"shipAssertTag:",e,t,n)},e.prototype.assertTag=function(e,t,r,n){console.assert(r,"assertTag",e,t,n)},e.prototype.traceTag=function(e,t,r,n){console.log("traceTag",e,n,t,r)},e.prototype.dnmTraceTag=function(e,t,r,n){console.log("dnmTraceTag",e,n,t,r)},e.prototype.debugTraceTag=function(e,t,r,n){console.log("debugTraceTag",e,n,t,r)},e}();t.ConsoleLogger=i;var o=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e.prototype.dnmTraceTag=function(){},e}();t.NulLogger=o},46742:function(e,t){"use strict";function r(){var e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function n(e,t,n){e[t]=r()-n}Object.defineProperty(t,"__esModule",{value:!0}),t.timeStamp=t.failure=t.success=t.end=t.mark=t.start=void 0,t.start=function(e){var t=r(),i=e,o=t,a={},s=function(e,t,r){return function(e,t,r,i,o,a){n(e,"end",r);var s={sessionName:t,result:i?"success":"failure",message:a,marks:e};o(JSON.stringify(s))}(a,i,o,e,t,r)};return a.start=0,{mark:function(e){return function(e){return n(a,e,o)}(e)},end:function(e){return s(!0,e)},success:function(e,t){return s(!0,e,t)},failure:function(e,t){return s(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=r},46478:function(e,t){"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(r||(t.TextAreaVirtualKeyboardPolicy=r={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(n||(t.TextAreaInputMode=n={}))},60471:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=void 0;var r=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(r=function(){return self.performance.now()}),function(n){var i=r(),o=n;return{reset:function(e){null!=e&&(o=e),i=r()},stop:function(n){var a=r()-i,s=JSON.stringify({Target:o,Duration:a.toFixed(t),StopInfo:n});e(s)}}}}},80908:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0;var r=function(){function e(){this.counters={},this.timers={},this.events={}}return e.prototype.getJsonForLogging=function(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"},e.prototype.addEvent=function(e,t){null!=e&&null!=t&&(this.events[e]=t)},e.prototype.clearEvents=function(){this.events={}},e.prototype.getEventsLoggableString=function(){return JSON.stringify(this.events)},e.prototype.incrementCounter=function(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)},e.prototype.getCountersLoggableString=function(){return JSON.stringify(this.counters)},e.prototype.clearCounters=function(){this.counters={}},e.prototype.startTimer=function(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})},e.prototype.endTimer=function(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)},e.prototype.getTimerDuration=function(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"},e.prototype.getTimersLoggableString=function(){return JSON.stringify(this.timers)},e}();t.TelemetryCollector=r},24289:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calcHashCode=t.decodeHtml=t.getQueryParameterByName=t.chainFallbackPromises=t.retry=t.getPerfWatchMarkName=t.getStringifiedError=t.defaultToJSONResultWhenStringifyFails=t.forEachPromise=void 0,t.forEachPromise=function(e,t,r){return e.reduce((function(e,n){return e.then((function(){return r&&r.stop?Promise.resolve(void 0):t(n,r)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(n(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var r=5;function n(e,t){if(void 0===t&&(t=0),t<0||t>r)return e;if(null==e||"object"!=typeof e)return e;var i={};Object.getOwnPropertyNames(e).forEach((function(t){"stack"!==t&&t.toUpperCase()!==t&&(i[t]=e[t])}));var o=Object.getPrototypeOf(e);o&&"object"==typeof o&&Object.keys(o).forEach((function(t){"stack"!==t&&t.toUpperCase()!==t&&(i[t]=e[t])}));var a={};return Object.keys(i).forEach((function(e){a[e]=n(i[e],t+1)})),a}var i=new RegExp("".concat("\\W","+"),"g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(i,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got ".concat(t)));for(var r=Promise.reject(),n=function(t){r=r.catch((function(r){return e(t,r)}))},i=1;i<=t;i+=1)n(i);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();for(var r=t(e[0]),n=function(n){var i=e[n];r=r.catch((function(){return t(i)}))},i=1;i<e.length;i+=1)n(i);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]".concat(t,"(=([^&#]*)|&|#|$)")).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,n=e.length,i=0;i<n&&(t=4294967295&((t<<5)+t^e.charCodeAt(i)),i!==n-1);i+=2)r=4294967295&((r<<5)+r^e.charCodeAt(i+1));var o=t+35685*r+(23896*r<<16)&4294967295;return o<0&&(o+=4294967296),o}},21991:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stackSave=t.stackRestore=t.stackAlloc=t.setThrew=t.memory=t._start=t.__growWasmMemory=t.__errno_location=t.Mathpack_Zero=t.Mathpack_ViewRound=t.Mathpack_Trunc=t.Mathpack_TenTo=t.Mathpack_Tan=t.Mathpack_TakeMathError=t.Mathpack_Sub=t.Mathpack_Sqrt=t.Mathpack_Sin=t.Mathpack_SFloat=t.Mathpack_SFix=t.Mathpack_RoundUp=t.Mathpack_RoundDown=t.Mathpack_Round=t.Mathpack_Power=t.Mathpack_Pi=t.Mathpack_Pack=t.Mathpack_One=t.Mathpack_Neg=t.Mathpack_Mul=t.Mathpack_Mod=t.Mathpack_Log=t.Mathpack_Ln=t.Mathpack_LFix=t.Mathpack_GetExp32=t.Mathpack_FormatScientific=t.Mathpack_FormatGetSign=t.Mathpack_FormatGetExponent=t.Mathpack_FormatGeneral=t.Mathpack_FormatFixed=t.Mathpack_Floor=t.Mathpack_Float=t.Mathpack_Fix=t.Mathpack_Exp=t.Mathpack_Equal=t.Mathpack_Div=t.Mathpack_Cos=t.Mathpack_Cond2=t.Mathpack_Cond=t.Mathpack_Compare=t.Mathpack_Ceil=t.Mathpack_Atan2=t.Mathpack_Atan=t.Mathpack_Asin=t.Mathpack_Add=t.Mathpack_Acos=t.Mathpack_Abs=t.Dtr_Yr=t.Dtr_Write=t.Dtr_Wdy=t.Dtr_UtcToLocal=t.Dtr_ToTime=t.Dtr_ToNumWithDuration=t.Dtr_ToNum=t.Dtr_ToDays=t.Dtr_Sec=t.Dtr_Rounding=t.Dtr_Mon=t.Dtr_Min=t.Dtr_Hour=t.Dtr_FromNum=t.Dtr_FracSec=t.Dtr_DaysPerMonth=t.Dtr_Days=t.Dtr_DOM=t.Base_StrBufSize=t.Base_StrBuf=void 0;var n=r(6598),i=r(25777),o=r(54137),a=new ArrayBuffer(8),s=new Int32Array(a),l=(new Float32Array(a),new Float64Array(a));function u(e){return s[e]}function c(e,t){s[e]=t}function d(){return l[0]}function m(e){l[0]=e}var g,p=new ArrayBuffer(65536),h=(g=new Uint8Array(p),function(e,t){var r,n;if("undefined"==typeof Buffer)for(r=atob(t),n=0;n<r.length;n++)g[e+n]=r.charCodeAt(n);else for(r=Buffer.from(t,"base64"),n=0;n<r.length;n++)g[e+n]=r[n]});h(1024,"yAwAAAEAAAACAAAAAwAAAAAAAAAE"),h(1056,"AQAAAAsAAAANAAAABwAAAAkAAAADAAAABQAAAA8AAAAAAAEAMAACADkAMQAcAAMAPQA6ADIAKgAmAB0AEQAEAD4ANwA7ACQANQAzACsAFgAtACcAIQAeABgAEgAMAAUAPwAvADgAGwA8ACkAJQAQADYAIwA0ABUALAAgABcACwAuABoAKAAPACIAFAAfAAoAGQAOABMACQANAAgABwAGAJAMAACYDAAAoAwAAKgMAAAfHR8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHR8eHx4fHx4fHh8="),h(1312,"WAwAAHAMAABoDAAAeAw="),h(1359,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsAAAAAHwA8AFsAeQCYALYA1QD0ABIBMQFPAW4B"),h(1759,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwAAAAAAHwA7AFoAeACXALUA1ADzABEBMAFOAW0B"),h(2135,"oAQ="),h(2151,"yAc="),h(2167,"+go="),h(2182,"QJwO"),h(2198,"UMMR"),h(2214,"JPQU"),h(2229,"gJaYGA=="),h(2245,"ILy+Gw=="),h(2261,"KGvuHg=="),h(2277,"+QKVIg=="),h(2292,"QLdDuiU="),h(2308,"EKXU6Cg="),h(2324,"KueEkSw="),h(2339,"gPQg5rUv"),h(2355,"oDGpX+My"),h(2371,"BL/JG442AAAAAAAAAJ61cCuorcWdawAAAAAAAADXlUMOBY0pr6AAAAAAAAAA1abP/0kfeMLVAAAAAAAAAPz32oePeufXCgEAAAAAAACjFJvFFquz7z8BAAAAAAAAnjIjmcCtD4V1AQAAAAAAAOCM6YDJR7qTqgEAAAAAAADnptOoxbkCpN8BAAAAAAAAqhfmfyuhFrYUAgAAAAAAAJO/m4WRoijKSQIAAAAAAABrVSc5jfdw4H4CAAAAAAAARmGCNzUMLvmzAgAAAAAAADDJPOP/llKK6QIAAAAAAABmF7/W86aRmR4DAAAAAAAAjt75nfvrfqpTAwAAAAAAAM3MzMzMzMzM/f///wAAAAAK16NwPQrXo/r///8AAAAAO99PjZduEoP3////AAAAACxlGeJYF7fR8////wAAAAAjhEcbR6zFp/D///8AAAAAtmlsrwW9N4bt////AAAAALxCeuXVlL/W6f///wAAAAD9zmGEEXfMq+b///8AAAAAl6W0NkFfcInj////AAAAAL/V7b3O/ubb3////wAAAAD/qiTLC//rr9z///8AAAAAzIhQbwnMvIzZ////AAAAABMOtEtCEy7h1f///wAAAAAP2FwJNdwktNL///8AAAAA2aywOvd8HZDP////AAAAAFvhTcS+lJXmy////wAAAAC6lDlFrR6xz5b///8AAAAAWcF+sVN8Erth////AAAAAKXpOaUn6n+oLP///wAAAACmGQlrumDFl/f+//8AAAAAm1N1/fcCtIjC/v//AAAAAH3TZfC8NUP2jP7//wAAAACh5LxkfEbQ3Vf+//8AAAAAyYJTfG66ysci/v//AAAAAJOgc9uT4PSz7f3//wAAAAAwAMs42ycXorj9//8AAAAABswjVHeD/5GD/f//AAAAAGC8pD2p3oCDTv3//wAAAAC+TjFK7Dzl7Bj9//8AAAAA1+Eyz81fYNXj/P//AAAAADoZemMlQzHArvz//w=="),h(3126,"kEEYLURU+yEJQAAAAAAAAOA/AAAAAAAAAEAYLURU+yH5PwAAAAAAAPA/"),h(3182,"WUAAAAAAAAAkQAAAAAAAQI9AAAAAAAAAOEAAAAAAAABOQClRzqDIRdg+IXQL5wZroz41IN+kpBFvPvZNfx3q2jg+AADA////30EAAAAAAADgwQAAsOlNYnBCBAQAABAE"),h(3904,"4E8=");var f=function(e,t,r){var n=new e.Int8Array(r),i=new e.Int16Array(r),o=new e.Int32Array(r),a=new e.Uint8Array(r),l=new e.Uint16Array(r),g=new e.Uint32Array(r),p=(new e.Float32Array(r),new e.Float64Array(r)),h=e.Math.imul,f=(e.Math.fround,e.Math.abs),S=e.Math.clz32,v=e.Math.min,y=(e.Math.max,e.Math.floor),F=e.Math.ceil,C=e.Math.sqrt,R=t.abort,b=(e.NaN,e.Infinity,t.Base_LocaleIsNumeral),E=t.Base_LocaleGetOrdinal,T=t.Base_LocaleDecimalSeparator,k=t.Math_log10,P=t.Math_log,N=(C=t.Math_sqrt,t.Math_sin),A=t.Math_cos,I=t.Math_tan,O=t.Math_atan,_=t.Math_exp,M=t.proc_exit,D=t.getTempRet0,w=20288,L=0;function x(){}function K(e,t,r){e:if(e>>>0<=t>>>0){if(!r)break e;for(;n[0|e]=a[0|t],e=e+1|0,t=t+1|0,r=r+-1|0;);}else if(r)for(e=e+r|0,t=t+r|0;t=t+-1|0,n[0|(e=e+-1|0)]=a[0|t],r=r+-1|0;);}function U(e,t){var r,s,c=0,d=0,g=0,h=0;if(d=3856,w=r=w-48|0,o[r+40>>2]=0,i[r+30>>1]=0,i[r+32>>1]=0,p[482]=e,s=z(e),p[482]=s,Fe(s,r+40|0,r,15),l[r+42>>1]){c=(0|(c=me(t)<<16))<0?100:c>>16,m(+t),g=0|u(1),u(0),(h=-65536&g)&&(2146435072!=(2146435072&g)?c=(0|h)<1?0-c|0:c:o[966]=1);e:{if(!((0|(c=i[r+40>>1]+c|0))>=i[r+42>>1])){if((0|c)<1){d=3168;break e}(255&c)>>>0>=a[r+30|0]||(n[r+30|0]=c)}ye(3276,3856,r)}e=p[d>>3]}return w=r+48|0,e}function B(e,t){var r,n=0,i=0,a=0;if(p[482]=e,m(+e),i=0|u(1),u(0),a=i,i=0,(n=-65536&a)&&(2146435072!=(2146435072&a)?i=(0|n)<1:(o[966]=1,i=0)),o[965]=2147483647&a,re(p[395]),n=-65536&(a=o[965]))if(2146435072!=(2146435072&a)){if(!((0|n)<1))return $(8),0}else o[966]=1;r=ne(p[395],e),be(p[393],r),ie(r),he();e:{t:{if((n=o[965])>>>0>=65536){if(2146435072!=(2146435072&n))break t;o[966]=1}if(t){if(o[964]=0,o[965]=0,!i)break e;return t=o[783],o[964]=o[782],o[965]=t,p[482]}if(n=o[789],o[964]=o[788],o[965]=n,t=n,1^i|n>>>0<65536)break e;return o[965]=-2147483648^t,p[482]}ke(e),fe(),t&&(p[482]=ne(p[394],p[482]))}return p[482]}function G(e,t,r,n){var s,u=0,c=0,d=0,m=0,g=0,p=0,f=0;if(u=o[e+4>>2],g=-2146827284,!((0|(s=(c=l[e>>1])+(e=(0|(d=i[e+2>>1]))>=1?(d+-1|0)/12|0:(0|d)/-12^-1)<<16>>16))>9999|((r?1900:-9999)+(t?4:0)|0)>(0|s)||((d=d+h(e,-12)<<16>>16)-1&65535)>>>0>11|(!u|1900==(0|s)&2==(0|d)&29==(0|u)?!r:0))){if(p=(0|(e=(m=(0|(c=s+1e4|0))/4|0)<<2))%100|0,f=(0|e)%400|0,u=(((m=h(m,1461)+u|0)+((0|(u=e+-1|0))/-100|0)|0)+((0|u)/400|0)|0)-1|0,c=(h(c-e|0,12)+d|0)-1|0)for(c=c+(e=f?p?0:12:0)|0;u=a[e+1232|0]+u|0,(0|c)!=(0|(e=e+1|0)););e:if(r||t){if(e=u+-4346385|0,!((0|s)>1900|(0|d)>=3))break e;e=u+-4346384|0}else e=u+-4346384|0;e>>>0>2958465||(o[n>>2]=e,g=0)}return g}function W(e,t,r){var n,s,l,u=0,c=0,d=0;c=d=Oe(e,t,711573504,201),o[r+28>>2]=(c+1>>>0)%7,u=c+h(n=(c>>>0)/146097|0,-146097)|0,s=(h(u,100)+75>>>0)/3652425|0,u=((l=h(s,-36524)+u|0)>>>0)/1461|0,c=(((c+(((u=((h(s,100)+h(n,400)|0)+(u<<2)|0)+((h(l+h(u,-1461)|0,100)+75>>>0)/36525|0)|0)>>>0)/100|0)|0)-(u>>>2)|0)-((u>>>0)/400|0)|0)+h(u,-365)|0,d=Ie(d,L,-864e5,-1),e=Oe(e,t,1e4,0)+d|0,d=!(((t=u+1|0)>>>0)%100)|3&t&&(t>>>0)%400|0?2096+((t=a[c+1728|0])<<1)|0:1696+((t=a[c+1328|0])<<1)|0,o[r+12>>2]=(e>>>0)/36e5,o[r+4>>2]=t+1,o[r>>2]=u+1601,t=(e>>>0)/1e3|0,o[r+20>>2]=(t>>>0)%60,o[r+16>>2]=((e>>>0)/6e4>>>0)%60,o[r+24>>2]=e-h(t,1e3),o[r+8>>2]=1+(c-i[d>>1]|0)}function V(e,t){var r=0,n=0,a=0,s=0,l=0,u=0,c=0,d=0,m=0,g=0,p=0,f=0;return(0|(s=o[e+4>>2]))<1||(d=s+-1|0)>>>0>11||(n=(r=o[e>>2])+-1601|0)>>>0>29226||(0|(l=o[e+8>>2]))<1||(a=1696,((u=65535&r)>>>0)%400&&(a=3&r?2096:(u>>>0)%100|0?1696:2096),(m=o[e+24>>2])>>>0>999||(u=o[e+20>>2])>>>0>59||(g=o[e+16>>2])>>>0>59||(p=o[e+12>>2])>>>0>23||(l=l+-1|0)>>>0>=i[a+(s<<1)>>1]-i[a+(d<<1)>>1]>>>0||(a=n>>>2,s=h(n,365),n=((e=65535&n)>>>0)/400|0,f=(e>>>0)/100|0,((c=65535&(r=r+-1600|0))>>>0)%400&&(e=2096,!((c>>>0)%100)|3&r)||(e=1696),c=1,r=(r=h(h(h(p,60)+g|0,60)+u|0,1e3)+m|0)+(n=Ie(e=i[(d<<1)+e>>1]+(n+((l+(s+a|0)|0)-f|0)|0)|0,e>>31,864e5,0))|0,e=L,o[t>>2]=Ie(r,r>>>0<n>>>0?e+1|0:e,1e4,0),o[t+4>>2]=L)),c}function j(e,t,r,n){var i,a=0,s=0,l=0,u=0;w=i=w-112|0,W(r,n,i+80|0);e:{if(o[e>>2]){if(!V(e,t))break e}else{if((0|(s=o[e+8>>2]))>5|!s)break e;if(r=o[e+4>>2],n=o[e+28>>2],a=o[i+80>>2],o[i+56>>2]=1,o[i+52>>2]=r,o[i+48>>2]=a,o[i+60>>2]=o[e+12>>2],o[i+64>>2]=o[e+16>>2],o[i+68>>2]=o[e+20>>2],e=o[e+24>>2],o[i+76>>2]=0,o[i+72>>2]=e,!V(i+48|0,i+8|0)){a=0;break e}e=n+8|0,r=n+1|0,l=(0|s)<2,W(o[i+8>>2],o[i+12>>2],i+16|0),u=i;t:{if((0|n)<(0|(a=o[i+44>>2])))e=e-a|0;else{if(e=1,(0|n)<=(0|a))break t;e=r-a|0}o[u+56>>2]=e}t:if(!l&&(r=e+7|0,o[i+56>>2]=r,a=1,V(i+48|0,i+8|0)))for(;;){if(W(o[i+8>>2],o[i+12>>2],i+16|0),e=o[i+24>>2],(0|s)==(0|(a=a+1|0)))break t;if(r=r+7|0,o[i+56>>2]=r,!V(i+48|0,i+8|0))break}if(o[i+56>>2]=e,!V(i+48|0,i+8|0)){a=0;break e}e=o[i+12>>2],o[t>>2]=o[i+8>>2],o[t+4>>2]=e}a=1}return w=i+112|0,a}function q(e,t,r){var n,a=0,s=0,u=0,c=0,d=0;if(w=n=w-16|0,r&&(u=r>>31,u^=u+r))for(r=(0|r)>0?2112:2608;(a=15&u)&&(s=i[8+(a=(a<<4)+r|0)>>1],d=H(p[e>>3],p[a>>3],n),t=t+s|0,i[n+14>>1]<=0?(a=l[n+6>>1],s=l[n+8>>1]):(s=o[n+4>>2],a=l[n+6>>1]<<1,i[n+6>>1]=a,c=o[n+8>>2],o[n+12>>2]=o[n+12>>2]<<1|c>>>31,s=c<<1|s>>>31,o[n+8>>2]=s,t=t+-1|0),(65535&a|1&s|0!=(0|d))>>>0<32769||(s=(a=o[n+8>>2])+1|0,o[n+8>>2]=s,s>>>0>=a>>>0||(s=(a=o[n+12>>2])+1|0,o[n+12>>2]=s,s>>>0>=a>>>0||(o[n+12>>2]=-2147483648,t=t+1|0))),a=o[n+12>>2],o[e>>2]=o[n+8>>2],o[e+4>>2]=a),r=r+240|0,u>>=4;);return w=n+16|0,t}function H(e,t,r){var n,o,a,s=0,l=0,c=0,d=0,g=0,p=0,f=0,S=0,v=0,y=0,F=0,C=0;return m(+t),d=0|u(1),g=65535&(l=0|u(0)),m(+e),y=0|u(1),s=0|u(0),c=y,o=h(S=65535&s,g),i[r>>1]=o,a=((65535&(F=h(v=s>>>16,g)))+(o>>>16)|0)+(65535&(f=h(l>>>=16,S)))|0,i[r+2>>1]=a,F=(((p=((65535&(s=h(n=65535&c,g)))+(F>>>16)|0)+(f>>>16)|0)+(65535&(f=h(l,v)))|0)+(65535&(C=h(y=65535&d,S)))|0)+(a>>>16)|0,i[r+4>>1]=F,f=(((((((65535&(p=h(d>>>=16,S)))+(s>>>16)|0)+(65535&(c=h(s=c>>>16,g)))|0)+(f>>>16)|0)+(C>>>16)|0)+(65535&(g=h(y,v)))|0)+(65535&(S=h(l,n)))|0)+(F>>>16)|0,i[r+6>>1]=f,v=((((((C=(c>>>16)+(p>>>16)|0)+(65535&(c=h(d,v)))|0)+(g>>>16)|0)+(S>>>16)|0)+(65535&(p=h(s,l)))|0)+(65535&(l=h(y,n)))|0)+(f>>>16)|0,i[r+8>>1]=v,p=((l=(((65535&(g=h(d,n)))+(c>>>16)|0)+(p>>>16)|0)+(l>>>16)|0)+(65535&(c=h(s,y)))|0)+(v>>>16)|0,i[r+10>>1]=p,s=(((65535&(d=h(s,d)))+(g>>>16)|0)+(c>>>16)|0)+(p>>>16)|0,i[r+12>>1]=s,i[r+14>>1]=(s>>>16)+(d>>>16),65535&(o|a|F)}function z(e){var t,r,n=0,i=0,a=0,s=0,l=0,c=0;return w=t=w-16|0,p[t+8>>3]=e,m(+e),n=0|u(1),i=0|u(0),r=n,(n&=2146435072)&&(o[t+8>>2]=i<<11,o[t+12>>2]=r<<11|i>>>21|-2147483648,s=(n=h(i=(n>>>20)-1022|0,39457)>>17)-14|0,a=q(t+8|0,i,14-n|0),i=o[t+8>>2],(0|a)>=(0|(g[t+12>>2]<(i>>>0<2147477094?-1243209483:-1243209484)>>>0?48:47))||(a=q(t+8|0,a,1),i=o[t+8>>2],s=n+-15|0),n=s,s=(s=i)+(i=-2147483648>>>(31&a))|0,o[t+8>>2]=s,s>>>0>=i>>>0||(c=(l=o[t+12>>2])+1|0,o[t+12>>2]=c,c>>>0>=l>>>0||(o[t+12>>2]=-2147483648,a=a+1|0)),o[t+8>>2]=s&0-(i<<1),a=q(t+8|0,a,n),3071&(n=o[t+8>>2])?(i=n+1024|0,o[t+8>>2]=i,n>>>0<4294966272||(s=(n=o[t+12>>2])+1|0,o[t+12>>2]=s,a=(s>>>0<n>>>0)+a|0)):i=n,(0|a)<=-1023?(o[t+8>>2]=0,o[t+12>>2]=0):(0|(n=1071644672+(a<<20)|0))<=-1||(a=o[t+12>>2],o[t+8>>2]=a<<21|i>>>11,o[t+12>>2]=a>>>11&1048575|n|-2147483648&r),e=p[t+8>>3]),w=t+16|0,e}function $(e){var t;return t=o[966],o[966]=e,t}function Q(){var e,t,r;return e=o[964],t=o[965],ee(1048576),ee(2146435072),i[1931]<0?(o[964]=e,o[965]=t,-2147483648):(r=de(),o[964]=e,o[965]=t,-2147483648^r)}function Y(e){var t,r=0,n=0,i=0,o=0;if(m(+e),r=0|u(1),t=0|u(0),o=r,i=0,!((r=2047&(n=r>>>20))>>>0<1023||(i=e,r>>>0>1075))){if(n=-1<<(19-n&31),r>>>0>=1044)return c(0,n&t),c(1,0|o),+d();o&=n,c(0,0),c(1,0|o),i=+d()}return i}function J(e){var t=0,r=0,n=0;if(e+307>>>0<=615)return o[964]=0,o[965]=-2147483648,n=q(3856,1,e),r=o[964],e=o[965],3071&r&&(t=o[965],(e=o[964]+1024|0)>>>0<1024&&(t=t+1|0),o[964]=e,o[965]=t,r=e,e=t),o[964]=e<<21|r>>>11,void(o[965]=1071644672+(e>>>11&1048575|n<<20));(0|e)>=309&&(o[966]=1),o[964]=0,o[965]=0}function X(e,t,r,n){var a=0,s=0,u=0;e:{t:{r:{n:{if(!n){if(l[e>>1]<=52)break n;break t}if(!((0|n)<1)&&(0|n)<15)break r}return o[t>>2]=1,void(o[r>>2]=0)}if(l[(n<<1)+e>>1]<=52)break e;for(;;){if(u=l[(s=((a=n+-1|0)<<1)+e|0)>>1]+1|0,i[s>>1]=u,58!=(65535&u))break e;if(!(n=a))break}}return i[e>>1]=49,o[t>>2]=o[t>>2]+1,void(o[r>>2]=1)}for(;t=n,(0|n)>=2&&48==l[((n=t+-1|0)<<1)+e>>1];);o[r>>2]=t}function Z(){var e=0,t=0,r=0;e:{if(r=o[964],t=-65536&(e=o[965])){if(2146435072==(2146435072&e))return o[966]=1,void Se();if((0|t)<1)break e}return void Se()}Se(),(0|r)==o[964]&&o[965]==(0|e)||re(1)}function ee(e){p[482]=te(p[482],e)}function te(e,t){var r;return m(+(e+=t)),r=0|u(1),u(0),2146435072==(2146435072&r)&&(o[966]=1,e=p[396]),e}function re(e){p[482]=ne(p[482],e)}function ne(e,t){var r;return m(+(e-=t)),r=0|u(1),u(0),2146435072==(2146435072&r)&&(o[966]=1,e=p[396]),e}function ie(e){p[482]=oe(p[482],e)}function oe(e,t){var r,n=0,i=0,a=0;return m(+e*t),n=0|u(1),r=0|u(0),0|2146435072!=(0|(i=2146435072&n))?(a=(i=!(i|a))?o[792]:r,n=i?o[793]:n,c(0,0|a),c(1,0|n),+d()):(o[966]=1,n=o[793],c(0,o[792]),c(1,0|n),+d())}function ae(e){p[482]=se(p[482],e)}function se(e,t){var r=0,n=0,i=0,a=0;if(m(+t),r=0|u(1),u(0),2146435072&r){if(n=1,m(+e/t),r=0|u(1),i=0|u(0),!(!0&2146435072==(0|(a=2146435072&r))))return i=(n=!(0|a))?o[792]:i,r=n?o[793]:r,c(0,0|i),c(1,0|r),+d()}else n=4;return o[966]=n,r=o[793],c(0,o[792]),c(1,0|r),+d()}function le(e){p[482]=e>>>0}function ue(e){p[482]=0|e}function ce(){var e,t;e=+P(+p[482]),p[482]=e,m(+e),t=0|u(1),u(0),2146435072==(2146435072&t)&&(o[966]=8)}function de(){return me(p[482])}function me(e){var t,r=0,n=0,i=0,o=0;return m(+e),o=1106247680==(0|(i=2146435072&(r=0|u(1))))&o>>>0<0|i>>>0<1106247680,t=r&=2147483647,c(0,0|(n=0|u(0))),c(1,0|r),(e=+d())<0x10000000000000000&e>=0?(i=f(e)>=1?e>0?~~v(y(e/4294967296),4294967295)>>>0:~~F((e-+(~~e>>>0>>>0))/4294967296)>>>0:0,r=~~e>>>0):(i=0,r=0),n=o?r:n,!(r=o?i:t)&n>>>0<4294967295|r>>>0<0?n:-1}function ge(){return pe(p[482])}function pe(e){var t=0,r=0;return m(+e),t=0|u(1),u(0),r=1105199104==(0|(t&=2145386496))&r>>>0<0|t>>>0<1105199104,t=f(e)<2147483648?~~e:-2147483648,r?t:-2147483648}function he(){var e,t;e=+C(+p[482]),p[482]=e,m(+e),t=0|u(1),u(0),2146435072==(2146435072&t)&&(o[966]=8)}function fe(){var e,t;e=+O(+p[482]),p[482]=e,m(+e),t=0|u(1),u(0),2146435072==(2146435072&t)&&(o[966]=8)}function Se(){p[482]=Y(p[482])}function ve(){var e,t;e=+_(+p[482]),p[482]=e,m(+e),t=0|u(1),u(0),2146435072==(2146435072&t)&&(o[966]=1)}function ye(e,t,r){return function(e,t,r){var n=0,s=0,c=0,d=0;if(n=a[r+30|0]){for(s=r;d=10*d+ +(0|De[o[o[e>>2]+4>>2]](e,l[s>>1])),s=s+2|0,c=(0|n)>1,n=n+-1|0,c;);if(m(+d),n=0|u(1),e=0|u(0),o[t>>2]=e<<11,o[t+4>>2]=2147481600&((2097151&n)<<11|e>>>21)|e>>>21|-2147483648,n=q(t,(n>>>20&2047)-1022|0,((32767&l[r+32>>1])-a[r+30|0]|0)-16384|0),3071&(s=o[t>>2])?(e=s+1024|0,o[t>>2]=e,s>>>0<4294966272||(c=(s=o[t+4>>2])+1|0,o[t+4>>2]=c,n=(c>>>0<s>>>0)+n|0)):e=s,!((0|n)<=-1022))return(0|(s=1071644672+(n<<20)|0))<0?1:(n=o[t+4>>2],o[t>>2]=n<<21|e>>>11,o[t+4>>2]=-2147483648&i[r+32>>1]|s|n>>>11&1048575,0)}return o[t>>2]=0,o[t+4>>2]=0,0}(e,t,r)}function Fe(e,t,r,a){!function(e,t,r,a){var s,c,d=0,g=0,f=0,S=0,v=0,y=0,F=0,C=0,R=0,b=0;w=s=w-16|0,p[s+8>>3]=e,c=t,m(+e),g=0|u(1),f=0|u(0),S=d=g;e:if(g=2146435072&d){if(g=h(v=(g>>>20)-1022|0,39457)>>17,i[r+32>>1]=g+16385|d>>>16&32768,(0|a)<=14){if((0|(a=1+(a+g|0)|0))<=-1){n[r+30|0]=0,i[r+32>>1]=0,i[t+2>>1]=0,t=0;break e}a=(0|a)<15?a:15}if(o[s+8>>2]=f<<11,o[s+12>>2]=S<<11|f>>>21|-2147483648,(0|(d=q(s+8|0,v,-1^g)))>=1)for(f=r+32|0;g=l[f>>1],i[f>>1]=g+1&32767|32768&g,(0|(d=q(s+8|0,d,-1)))>0;);if(d?(g=(f=o[s+12>>2])>>>(S=0-d|0),o[s+12>>2]=g,d=f<<d+32|o[s+8>>2]>>>S,o[s+8>>2]=d):(d=o[s+8>>2],g=o[s+12>>2]),d=(f=g>>>0<(d>>>0<2576980377?429496730:429496729)>>>0?922:9223)+d|0,o[s+8>>2]=d,d>>>0<f>>>0&&(g=g+1|0,o[s+12>>2]=g),(0|a)<1)f=r;else{for(y=d>>>16,F=l[s+14>>1],C=r+32|0,b=15==(0|a),f=r,S=1;;){v=a;t:{r:{for(;;){if(a=h(y,10)+(h(65535&d,10)>>>16)>>>16,R=h(F,10)+(a+h(65535&g,10)>>>16)>>>16|48,i[f>>1]=R,F=(g=a+h(g,10)|0)>>>16,y=(d=h(d,10))>>>16,1&(-1^S|48!=(0|R)))break r;if(a=l[C>>1],i[C>>1]=a+-1&32767|32768&a,!b)break}S=1;break t}f=f+2|0,S=0}if(a=v+-1|0,!((0|v)>1))break}o[s+12>>2]=g,o[s+8>>2]=d}d=(a=f-r|0)>>1;t:{if((0|a)<=29){if((0|g)<=-1){i[f>>1]=57,g=d+1|0;break t}i[f>>1]=48}for(;;){if(g=d,(0|d)<1)break t;if(d=g+-1|0,48!=l[(f=f+-2|0)>>1])break}}n[r+30|0]=g,i[t+2>>1]=g,t=(32767&l[r+32>>1])-16384|0}else n[r+30|0]=0,i[r+32>>1]=0,i[t+2>>1]=0,t=0;i[c>>1]=t,w=s+16|0}(e,t,r,a)}function Ce(e,t,r,n){var i,a=0,s=0,l=0,u=0,c=0,d=0,m=0;c=o[t+4>>2],i=o[t>>2],u=l,l=o[e>>2],e=Ie(i,u,a=o[e+4>>2],t=0),s=L,a=Ie(u=c,c=0,a,t),t=L+d|0,t=(s=s+a|0)>>>0<a>>>0?t+1|0:t,a=s,d=t,t=Ie(u,c,s=l,0),u=(l=a)+(a=L)|0,l=d,l=u>>>0<a>>>0?l+1|0:l,a=0,d=Ie(i,m,s,c),e=(s=(m=L)+e|0)>>>0<m>>>0?a+1|0:a,c=t,s=t+s|0,t=e,e=u,u=t=s>>>0<c>>>0?t+1|0:t,(t=e+t|0)>>>0<u>>>0&&(l=l+1|0),o[r>>2]=t,o[r+4>>2]=l,o[n>>2]=d,o[n+4>>2]=s}function Re(e){return ne(p[482],e)}function be(e,t){p[482]=ne(e,t)}function Ee(e){return oe(p[482],e)}function Te(e){return se(p[482],e)}function ke(e){p[482]=se(e,p[482])}function Pe(e,t){p[482]=se(e,t)}function R(){M(1),R()}function Ne(e,t){var r,n;r=0|e,n=0|t,s[0]=r,s[1]=n}function Ae(e,t,r,n){var i=0,o=0,a=0,s=0,l=0,u=0,c=0,d=0,m=0,g=0;e:{t:{r:{n:{i:{o:{a:{s:{l:{u:{if(a=t){if(!(i=r))break u;if(!(o=n))break l;if((i=S(o)-S(a)|0)>>>0<=31)break s;break t}if(1==(0|n)&r>>>0>=0|n>>>0>1)break t;return Ne(e-h(t=(e>>>0)/(r>>>0)|0,r)|0,0),L=0,t}if(i=n,!e)break a;if(!i)break o;if((o=i+-1|0)&i)break o;return Ne(e,a&o),e=a>>>(31&Me(i)),L=0,e}if(!((o=i+-1|0)&i))break i;u=0-(l=(S(i)+33|0)-S(a)|0)|0;break r}l=i+1|0,u=63-i|0;break r}return Ne(0,a-h(e=(a>>>0)/(i>>>0)|0,i)|0),L=0,e}if((i=S(i)-S(a)|0)>>>0<31)break n;break t}if(Ne(e&o,0),1==(0|i))break e;return n=e,e=31&(r=Me(i)),32<=(63&r)>>>0?(i=0,e=t>>>e):(i=t>>>e,e=((1<<e)-1&t)<<32-e|n>>>e),L=i,e}l=i+1|0,u=63-i|0}if(o=t,m=e,a=31&(i=63&l),32<=(63&i)>>>0?(i=0,s=o>>>a):(i=o>>>a,s=((1<<a)-1&o)<<32-a|m>>>a),o=i,a=e,e=31&(i=63&u),32<=(63&i)>>>0?(i=a<<e,e=0):(i=(1<<e)-1&a>>>32-e|t<<e,e=a<<e),t=i,l)for(i=n+-1|0,(a=r+-1|0)>>>0<4294967295&&(i=i+1|0),u=i;i=o<<1|s>>>31,o=s<<1,m=i,i=(s=u-((a>>>0<(o|=t>>>31)>>>0)+i|0)|0)>>31,s=(d=o)-(o=r&(c=s>>31))|0,o=m-((n&i)+(d>>>0<o>>>0)|0)|0,i=t<<1|e>>>31,e=g|e<<1,t=0|i,d=0,g=c&=1,l=l+-1|0;);return Ne(s,o),L=(i=t<<1|e>>>31)|d,c|e<<1}Ne(e,t),e=0,t=0}return L=t,e}function Ie(e,t,r,n){return e=function(e,t,r,n){var i,o,a,s,l=0,u=0;return s=h(l=r>>>16,u=e>>>16),l=(65535&(u=((a=h(i=65535&r,o=65535&e))>>>16)+h(u,i)|0))+h(l,o)|0,e=(((h(t,r)+s|0)+h(e,n)|0)+(u>>>16)|0)+(l>>>16)|0,L=e,65535&a|l<<16}(e,t,r,n),e}function Oe(e,t,r,n){return e=function(e,t,r,n){var i=0,o=0;return r=Ae((e^=i=t>>31)-i|0,o=((o=t>>31)^t)-((e>>>0<i>>>0)+o|0)|0,(r^=e=n>>31)-e|0,((i=n>>31)^n)-((r>>>0<e>>>0)+i|0)|0),L=((e=(t^=n)>>31)^L)-(((r^=t>>=31)>>>0<t>>>0)+e|0)|0,r-t|0}(e,t,r,n),e}function _e(e,t,r,n){return Ae(e,t,r,n),t=0|("function"==typeof setTempRet0&&setTempRet0(s[1]),s[0]),e=0|D(),L=e,0|t}function Me(e){return e?31-S(e+-1^e)|0:32}var De=[null,function(e,t){return 0!=(0|b(0|(t|=0)))|0},function(e,t){return 0|E(0|(t|=0))},function(e){return 0|T()},function(e,t){return(t|=0)-48|0},x];return{memory:Object.create(Object.prototype,{grow:{},buffer:{get:function(){return r}}}),Base_StrBuf:function(){return 3280},Base_StrBufSize:function(){return 255},Dtr_DaysPerMonth:function(e,t,r){return 0|function(e,t,r){var n=0;n=3&t;e:if(r){if(n|(0|t)<2100)break e;n=!((t>>>0)%100)&0!=((t>>>0)%400|0)}else n||(n=!((0|t)%100)&0!=((0|t)%400|0));return a[1232+(((h(n,12)+e|0)-1|0)%48|0)|0]}(e|=0,t|=0,0!=(0|(r|=0)))},Dtr_FromNum:function(e,t,r,n,s){return e=+e,t|=0,n|=0,s|=0,r=h(r|=0,20)+3792|0,i[r>>1]=0,t=function(e,t,r,n,s){var g=0,f=0,S=0,v=0,y=0,F=0,C=0,R=0,b=0;e:if(!l[e>>1]){if(p[482]=t,m(+t),g=0|u(1),S=0|u(0),F=g,b=-65536&g)if(2146435072!=(2146435072&g)){if(!((0|b)>=1))return-2147467259}else o[966]=1;y=o[812],v=-1;t:{if(!((0|g)<(0|(f=C=o[813]))||(v=1,(0|g)>(0|f)))){if((0|y)==(0|(f=S)))break t;v=f>>>0<y>>>0?-1:1}if(f=-2147467259,1==(0|((F&C)>-1?v:0-v|0)))break e}t:{if(y=o[814],C=f=o[815],v=-1,!((0|g)<(0|f)||(v=1,(0|g)>(0|C)))){if((0|S)==(0|y))break t;v=S>>>0<y>>>0?-1:1}if(y=v,-1==(0|((f&F)>-1?y:0-y|0)))return-2147467259}t:{r:{if(!(s|!b))if(2146435072!=(2146435072&g)){if((0|b)<1)break r}else o[966]=1;ee(p[o[1216+(r<<2)>>2]>>3]),R=p[482];break t}Z(),re(t),S=F=o[965],c(0,0|(g=o[964])),c(1,0|S),R=+d(),o[792]==(0|g)&&o[793]==(0|S)||(f=o[965])>>>0<65536||(o[965]=-2147483648^f,m(+(R=p[482])),S=0|u(1),g=0|u(0)),F=S,y=S,S=o[1216+(r<<2)>>2],C=o[S+4>>2],f=o[S>>2],v=-1;r:{if(!((0|y)<(0|(S=C))||(v=1,(0|y)>(0|S)))){if((0|g)==(0|f)){p[482]=t;break r}v=g>>>0<f>>>0?-1:1}if(y=v,p[482]=t,-1==(0|((F&C)>-1?y:0-y|0)))break t}re(p[395])}if(i[e+18>>1]=r,g=ge(),f=-2147467259,!$(0)){if(n){if((0|g)>2957003)break e;g=g+1462|0}else if(g+4346018>>>0>7304483)break e;if(i[e+14>>1]=1+((g+6|0)%7|0),!s|g)if(g){if((0|g)<=-1?(S=-4-((n=(-1^g)/1461|0)<<2)|0,f=1461+(h(n,1461)+g|0)|0):(S=(n=(g+-1|0)/1461|0)<<2,f=h(n,-1461)+g|0),!(s&&(0|S)<=199))if((0|(f=(((0|(n=S+-101|0))/100|0)-((0|n)/400|0)|0)+f|0))>=1462){g=3&(n=S+1900|0);t:if(s){if(g|(0|S)<200)break t;g=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else g||(g=!((0|n)%100)&0!=((0|n)%400|0));S=S+4|0,f=(12==(0|h(g,12))?-1460:-1461)+f|0}else(0|f)>0||(S=S+-4|0,f=f+1461|0);g=3&(n=S+1900|0);t:if(s){if(g|(0|S)<200)break t;g=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else g||(g=!((0|n)%100)&0!=((0|n)%400|0));for(g=F=h(g,12);s=g,g=g+1|0,(0|(f=(n=f)-a[s+1232|0]|0))>0;);s=((f=s)-((0|F)<(0|(s=s+-11|0))?F:s)>>>0)/12|0,i[e>>1]=1900+(s+S|0),i[e+2>>1]=(h(s,-12)+g|0)-F}else o[e>>2]=788331,n=30;else o[e>>2]=67436;if(o[e+4>>2]=n,p[482]=R,Se(),(n=o[965])>>>0>=65536&&(o[965]=-2147483648^n),ee(R),ie(p[400]),t=p[482],n=de(),i[e+8>>1]=n,le(n<<16>>16),(n=o[965])>>>0>=65536&&(o[965]=-2147483648^n),ee(t),ie(p[401]),t=p[482],n=de(),i[e+10>>1]=n,le(n<<16>>16),(n=o[965])>>>0>=65536&&(o[965]=-2147483648^n),ee(t),ie(p[401]),!r)return r=de(),i[e+16>>1]=0,i[e+12>>1]=r,0;t=p[482],n=de(),i[e+12>>1]=n,le(n<<16>>16),(n=o[965])>>>0>=65536&&(o[965]=-2147483648^n),ee(t),ie(p[o[1312+(r<<2)>>2]>>3]),p[482]=z(p[482]),i[e+16>>1]=de(),f=0}}return f}(r,e,t,0!=(0|n),0!=(0|s)),o[966]=0,0|t},Dtr_Yr:function(e){return i[h(e|=0,20)+3792>>1]},Dtr_Mon:function(e){return i[h(e|=0,20)+3794>>1]},Dtr_DOM:function(e){return o[h(e|=0,20)+3796>>2]},Dtr_Hour:function(e){return i[h(e|=0,20)+3800>>1]},Dtr_Min:function(e){return i[h(e|=0,20)+3802>>1]},Dtr_Sec:function(e){return i[h(e|=0,20)+3804>>1]},Dtr_Wdy:function(e){return i[h(e|=0,20)+3806>>1]},Dtr_FracSec:function(e){return i[h(e|=0,20)+3808>>1]},Dtr_Rounding:function(e){return i[h(e|=0,20)+3810>>1]},Dtr_Write:function(e,t,r,n,a,s,l,u,c,d){e|=0,t|=0,r|=0,n|=0,a|=0,s|=0,l|=0,u|=0,c|=0,d=h(d|=0,20),i[d+3810>>1]=c,i[d+3808>>1]=u,i[d+3806>>1]=l,i[d+3804>>1]=s,i[d+3802>>1]=a,i[d+3800>>1]=n,o[d+3796>>2]=r,i[d+3794>>1]=t,i[d+3792>>1]=e},Dtr_ToNum:function(e,t,r){return e|=0,t|=0,r|=0,o[964]=0,o[965]=0,function(e,t,r){var n,a=0;w=n=w-16|0;e:{t:{r:{if((l[e+2>>1]+-32767&65535)>>>0>1){if(i[e+18>>1]>=1?(ue(i[e+16>>1]),a=Te(p[o[1312+(i[e+18>>1]<<2)>>2]>>3]),ue(i[e+12>>1]),ee(a)):ue(i[e+12>>1]),a=Te(p[401]),ue(i[e+10>>1]),ee(a),a=Te(p[401]),ue(i[e+8>>1]),ee(a),a=Te(p[400]),!((0|G(e,t,r,n+12|0))<0)){if(e=o[n+12>>2],!t)break r;if(ue(e+-1462|0),!((0|e)<1462)){if(!(t=-65536&(e=o[965])))break t;if(2146435072==(2146435072&e)){o[966]=1;break t}if((0|t)>=1)break t}}o[964]=0,o[965]=0}o[964]=0,o[965]=0,$(8);break e}le(e)}ee(a)}w=n+16|0}(h(e,20)+3792|0,0!=(0|t),0!=(0|r)),+p[482]},Dtr_ToNumWithDuration:function(e,t,r,n,a){return e|=0,t|=0,r|=0,n|=0,a|=0,o[964]=0,o[965]=0,function(e,t,r,n,a){var s,u=0;w=s=w-16|0;e:{t:{r:{if((l[e+2>>1]+-32767&65535)>>>0>1){n:if(i[e+18>>1]>=1){if(ue(i[e+16>>1]),ae(p[o[1312+(i[e+18>>1]<<2)>>2]>>3]),u=p[482],2==(0|a)){p[482]=n,ee(u);break n}ue(i[e+12>>1]),ee(u)}else 2!=(0|a)?ue(i[e+12>>1]):p[482]=n;if(ae(p[401]),u=p[482],1!=(0|a)?ue(i[e+10>>1]):p[482]=n,ee(u),ae(p[401]),u=p[482],a?ue(i[e+8>>1]):p[482]=n,ee(u),ae(p[400]),n=p[482],!((0|G(e,t,r,s+12|0))<0)){if(e=o[s+12>>2],!t)break r;if(ue(e+-1462|0),!((0|e)<1462)){if(!(t=-65536&(e=o[965])))break t;if(2146435072==(2146435072&e)){o[966]=1;break t}if((0|t)>=1)break t}}o[964]=0,o[965]=0}o[964]=0,o[965]=0,$(8);break e}le(e)}ee(n)}w=s+16|0}(h(e,20)+3792|0,0!=(0|t),0!=(0|r),+(0|a),n),+p[482]},Dtr_Days:function(){return o[963]},Dtr_ToDays:function(e,t,r){return t|=0,r|=0,0|G(h(e|=0,20)+3792|0,0!=(0|t),0!=(0|r),3852)},Dtr_ToTime:function(e,t,r){return function(e,t,r){p[482]=e,ee(p[o[1216+(r<<2)>>2]>>3]);e:{if(t>>>0<=1){if(t-1)break e}else ie(p[401]);ie(p[401])}ie(p[400]),Se()}(e=+e,t|=0,r|=0),+p[482]},Dtr_UtcToLocal:function(e,t,r,n,a,s,u,c){var d;return e|=0,t|=0,r|=0,n|=0,a|=0,s|=0,u|=0,c|=0,w=d=w-32|0,o[d+24>>2]=s,o[d+16>>2]=n,o[d+8>>2]=t,o[d+20>>2]=(0|a)>-1?h(a,20)+3792|0:0,o[d+12>>2]=(0|r)>-1?h(r,20)+3792|0:0,e=function(e,t,r,n){var a,s=0;return w=a=w-32|0,function(e,t,r){var n,a=0,s=0,u=0,c=0,d=0,m=0,g=0,p=0,f=0,S=0,v=0,y=0;if(w=n=w-96|0,o[n+64>>2]=i[t>>1],o[n+68>>2]=i[t+2>>1],o[n+72>>2]=o[t+4>>2],o[n+76>>2]=i[t+8>>1],o[n+80>>2]=i[t+10>>1],o[n+84>>2]=i[t+12>>1],o[n+92>>2]=i[t+14>>1]+-1,(a=i[t+18>>1])>>>0<=3){e:{t:switch(a-1|0){case 0:a=h(i[t+16>>1],100);break e;case 1:a=h(i[t+16>>1],10);break e;case 2:break t;default:break e}a=i[t+16>>1]}o[n+88>>2]=a}t=0;e:if(V(n- -64|0,n+40|0)){if(u=Ie(u=h(o[e>>2],60),u>>31,1e7,0),d=L,(s=o[e+4>>2])&&(c=o[e+12>>2])){if(o[n+64>>2]=i[s>>1],o[n+68>>2]=i[s+2>>1],o[n+72>>2]=o[s+4>>2],o[n+76>>2]=i[s+8>>1],o[n+80>>2]=i[s+10>>1],o[n+84>>2]=i[s+12>>1],o[n+92>>2]=i[s+14>>1]+-1,(a=i[s+18>>1])>>>0<=3){t:{r:switch(a-1|0){case 0:a=h(i[s+16>>1],100);break t;case 1:a=h(i[s+16>>1],10);break t;case 2:break r;default:break t}a=i[s+16>>1]}o[n+88>>2]=a}if(o[n+8>>2]=i[c>>1],o[n+12>>2]=i[c+2>>1],o[n+16>>2]=o[c+4>>2],o[n+20>>2]=i[c+8>>1],o[n+24>>2]=i[c+10>>1],o[n+28>>2]=i[c+12>>1],o[n+36>>2]=i[c+14>>1]+-1,(a=i[c+18>>1])>>>0<=3){t:{r:switch(a-1|0){case 0:a=h(i[c+16>>1],100);break t;case 1:a=h(i[c+16>>1],10);break t;case 2:break r;default:break t}a=i[c+16>>1]}o[n+32>>2]=a}if(c=s=o[n+44>>2],!j(n- -64|0,n+56|0,a=o[n+40>>2],s))break e;if(!j(n+8|0,n+48|0,a,c))break e;f=o[n+40>>2],g=o[n+44>>2],S=u,v=e+16|0,y=e+8|0,p=(c=d)+o[n+52>>2]|0,(m=(a=u)+o[n+48>>2]|0)>>>0<a>>>0&&(p=p+1|0),s=m,m=Ie(a=h(o[e+8>>2],60),a>>31,1e7,0),a=L+p|0,p=s=s+m|0,m=a=s>>>0<m>>>0?a+1|0:a,s=d+o[n+60>>2]|0,(d=u+o[n+56>>2]|0)>>>0<u>>>0&&(s=s+1|0),u=Ie(e=h(o[e+16>>2],60),e>>31,1e7,0),e=L+s|0,e=(d=u+d|0)>>>0<u>>>0?e+1|0:e,u=d,e=Ie(e=h(o[((e=(0|a)<(0|e)||(0|a)<=(0|e)&&!(p>>>0>=u>>>0)?((0|g)<(0|e)?1:(0|g)<=(0|e)?f>>>0>=u>>>0?0:1:0)&((0|g)>(0|m)?1:(0|g)>=(0|m)?f>>>0<p>>>0?0:1:0):((0|g)<(0|e)?1:(0|g)<=(0|e)?f>>>0>=u>>>0?0:1:0)|((0|g)>(0|m)?1:(0|g)>=(0|m)?f>>>0<p>>>0?0:1:0))?v:y)>>2],60),e>>31,1e7,0),a=L+c|0,d=a=(u=S+e|0)>>>0<e>>>0?a+1|0:a}e=o[n+40>>2],a=o[n+44>>2]-(d+(e>>>0<u>>>0)|0)|0,u=e-u|0,(0|(e=a))<0||(0|e)<=0&&!(u>>>0>=0)||(W(u,e,n- -64|0),i[r>>1]=o[n+64>>2],i[r+2>>1]=o[n+68>>2],o[r+4>>2]=o[n+72>>2],t=1,i[r+14>>1]=l[n+92>>1]+1,i[r+8>>1]=o[n+76>>2],i[r+10>>1]=o[n+80>>2],i[r+12>>1]=o[n+84>>2],e=o[n+88>>2],i[r+18>>1]=3,i[r+16>>1]=e)}return w=n+96|0,t}(n,e,a+8|0)&&(n=o[a+12>>2],o[e>>2]=o[a+8>>2],o[e+4>>2]=n,o[e+16>>2]=o[a+24>>2],n=o[a+20>>2],o[e+8>>2]=o[a+16>>2],o[e+12>>2]=n,n=e,(0|G(e,t,r,a+28|0))>=0?e=1+((o[a+28>>2]+6|0)%7|0)|0:(o[a+28>>2]=-1,e=6),i[n+14>>1]=e,s=1),w=a+32|0,s}(h(e,20)+3792|0,0!=(0|u),0!=(0|c),d+8|0),w=d+32|0,0|e},Mathpack_Zero:function(){return+p[396]},Mathpack_One:function(){return+p[395]},Mathpack_Pi:function(){return+p[391]},Mathpack_Div:function(e,t){return+se(e=+e,t=+t)},Mathpack_Mul:function(e,t){return+oe(e=+e,t=+t)},Mathpack_Sub:function(e,t){return+ne(e=+e,t=+t)},Mathpack_Add:function(e,t){return+te(e=+e,t=+t)},Mathpack_Power:function(e,t){return+function(e,t){var r=0,n=0,a=0,s=0;p[482]=t,m(+t),r=0|u(1),u(0),a=r,o[965]=2147483647&r,t=p[482];e:{if(m(+Re(p[392])),65535==(0|(r=0|u(1)))&(n=0|u(0))>>>0<=4294967295|r>>>0<65535)p[482]=e,he();else if(Se(),m(+Re(t)),65535==(0|(r=0|u(1)))&(n=0|u(0))>>>0>4294967295|r>>>0>65535||-1==(0|(r=de()))){if(p[482]=e,m(+e),n=0|u(1),u(0),(0|(n=(r=n)>>>16<<16))>=1)ce(),ie(t),ve();else if(!((0|n)>-1)){if(Pe(p[395],t),s=z(p[482]),p[482]=s,Se(),m(+Re(s)),65535==(0|(n=0|u(1)))&u(0)>>>0>4294967295|n>>>0>65535)break e;if(2147483647==(0|(n=ge()))|!(1&n))break e;p[482]=e,o[965]=2147483647&r,ce(),ie(t),ve(),(r=o[965])>>>0<65536||(o[965]=-2147483648^r)}}else p[482]=e,function(e){var t,r=0;if((t=i[1931])|e){if(!((0|t)<1)&&10==(0|de())){if(r=p[482],Se(),re(r),!l[1931])return void J(e);p[482]=r}for(r=1;1&e&&(r=Ee(r)),e>>>=1;)ie(p[482]);p[482]=r}else o[966]=4&o[966]?4:64}(r);if(a>>>16<<16>>16<=-1){if(1&(a=o[966]))return o[964]=0,o[965]=0,o[966]=-2&a,p[482];ke(p[395])}return p[482]}return o[966]=8,p[482]}(e=+e,t=+t)},Mathpack_Cond:function(e){var t,r;return m(+(e=+e)),t=0|u(1),u(0),(r=-65536&t)?2146435072==(2146435072&t)?(o[966]=1,0):0|((0|r)<1?-1:1):0},Mathpack_Cond2:function(e,t){t=+t;var r,n,i,o,a=0,s=0,l=0;m(+(e=+e)),a=0|u(1),r=0|u(0),n=a,o=a,m(+t),i=0|u(1),a=0|u(0),l=-1;e:{if(!((0|n)<(0|(s=i))||(l=1,(0|o)>(0|s)))){if(s=0,(0|a)==(0|r))break e;l=r>>>0<a>>>0?-1:1}a=l,s=(i&n)>-1?a:0-a|0}return 0|s},Mathpack_TakeMathError:function(){var e;return e=o[966],o[966]=0,0|e},Mathpack_Trunc:function(e){return+Y(e=+e)},Mathpack_Ceil:function(e){return e=+e,p[482]=e,function(){var e=0,t=0,r=0;e:{if(r=o[964],t=-65536&(e=o[965])){if(2146435072==(2146435072&e))return o[966]=1,void Se();if((0|t)>0)break e}return void Se()}Se(),(0|r)==o[964]&&o[965]==(0|e)||ee(1)}(),+p[482]},Mathpack_Floor:function(e){return e=+e,p[482]=e,Z(),+p[482]},Mathpack_Abs:function(e){var t=0;return m(+(e=+e)),t=0|u(1),t&=2147483647,c(0,0|u(0)),c(1,0|t),+d()},Mathpack_Neg:function(e){var t,r,n,i;return m(+(e=+e)),n=-2147483648^(t=0|u(1)),c(0,0|(r=0|u(0))),c(1,0|n),i=+d(),+(65535==(0|t)&r>>>0>4294967295|t>>>0>65535?i:e)},Mathpack_Float:function(e){return+((e|=0)>>>0)},Mathpack_SFloat:function(e){return+(0|(e|=0))},Mathpack_Fix:function(e){return 0|me(e=+e)},Mathpack_LFix:function(e){return 0|pe(e=+e)},Mathpack_SFix:function(e){return e=+e,p[482]=e,0|Q()},Mathpack_Round:function(e,t){return+function(e,t){var r,a=0,s=0,c=0,d=0;w=r=w+-64|0,o[r+56>>2]=0,i[r+46>>1]=0,i[r+48>>1]=0,p[482]=e,m(+e),a=0|u(1),u(0);e:if(s=-65536&a)if(2146435072!=(2146435072&a)){(0|s)>0||(d=32768,a>>>0<65536||(o[965]=-2147483648^a,e=p[482])),Fe(e,r+56|0,r+16|0,15),l[r+58>>1]||(i[r+56>>1]=1),p[482]=t,a=(0|(a=Q()))<0?100:a;t:{if(c=-65536&(s=o[965]))if(2146435072!=(2146435072&s)){if(!((0|c)>0)){if((a=o[965])>>>0>=65536&&(o[965]=-2147483648^a),(0|(a=Q()))<=-1)break t;a=0-a|0}}else o[966]=1;(0|(c=a+(s=i[r+56>>1])|0))<(0|(a=i[r+58>>1]))&&(o[r+12>>2]=a,o[r+8>>2]=s,X(r+16|0,r+8|0,r+12|0,c),a=o[r+12>>2],i[r+58>>1]=a,s=o[r+8>>2],i[r+56>>1]=s),n[r+46|0]=a,i[r+48>>1]=s+16384&32767|d,ye(3276,3856,r+16|0),e=p[482];break e}e=p[396]}else o[966]=1;return w=r- -64|0,e}(e=+e,t=+t)},Mathpack_RoundUp:function(e,t){return+function(e,t){var r=0,n=0,i=0,a=0,s=0;if(m(+e),r=0|u(1),u(0),(n=-65536&r)&&(2146435072!=(2146435072&r)?s=(0|n)<1?-1:1:o[966]=1),i=U(e,t),p[482]=e,p[482]=z(e),re(i),(r=o[965])>>>0>=65536){if(2146435072==(2146435072&r))return o[966]=1,i;if(r=(0|(r=me(t)<<16))<0?309:r>>16,m(+t),n=0|u(1),u(0),(a=-65536&n)&&(2146435072!=(2146435072&n)?r=(0|a)<1?0-r|0:r:o[966]=1),(0|r)<=-309)return $(8),0;J(0-r|0),(0|s)>-1||(r=o[965])>>>0<65536||(o[965]=-2147483648^r),ee(i),i=p[482]}return i}(e=+e,t=+t)},Mathpack_RoundDown:function(e,t){var r;return m(+(e=U(e=+e,t=+t))),r=0|u(1),u(0),2146435072==(2146435072&r)&&(o[966]=1,e=-1),+e},Mathpack_TenTo:function(e){return J(e|=0),+p[482]},Mathpack_Compare:function(e,t){return+(0|function(e,t){var r,n=0,i=0,a=0,s=0,l=0;w=r=w-16|0,p[r+8>>3]=e,p[r>>3]=t,m(+e),n=0|u(1),i=0|u(0),a=n,m(+t),l=n=0|u(1);e:{if((0|i)!=(0|(s=0|u(0)))||(0|a)!=(0|n)){if((l+2097152&2146435072)-(2146435072&a)>>>0<=5242879&&(e=z(e),p[r+8>>3]=e,m(+e),n=0|u(1),u(0),a=n,e=z(t),p[r>>3]=e,m(+e),n=0|u(1),u(0),l=n),n=1,(0|(a=o[(s=(i=(l&a)>-1)?r+8|0:r)+4>>2]))>(0|(l=o[(i=i?r:r+8|0)+4>>2])))break e;if((0|a)<(0|l)){n=-1;break e}if((s=o[s>>2])>>>0>(i=o[i>>2])>>>0)break e;if(n=-1,s>>>0<i>>>0)break e}n=0}return w=r+16|0,n}(e=+e,t=+t))},Mathpack_GetExp32:function(e){var t;return m(+(e=+e)),t=0|u(1),u(0),2146435072&t},Mathpack_Equal:function(e,t){t=+t;var r,n,i=0;return m(+(e=+e)),i=0|u(1),r=0|u(0),m(+t),n=0|u(1),0|((0|r)==(0|u(0))?(0|i)==(0|n):0)},Mathpack_ViewRound:function(e){var t;return m(+(e=+e)),t=0|u(1),u(0),2146435072==(2146435072&t)?(o[966]=1,-1):+z(e)},Mathpack_Sqrt:function(e){return e=+e,p[482]=e,he(),+p[482]},Mathpack_Exp:function(e){return e=+e,p[482]=e,ve(),+p[482]},Mathpack_Ln:function(e){return e=+e,p[482]=e,ce(),+p[482]},Mathpack_Log:function(e){return e=+e,p[482]=e,function(){var e,t;e=+k(+p[482]),p[482]=e,m(+e),t=0|u(1),u(0),2146435072==(2146435072&t)&&(o[966]=8)}(),+p[482]},Mathpack_Sin:function(e){return e=+e,p[482]=e,function(){var e=0,t=0;m(+(t=p[482])),e=0|u(1),u(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+N(+t),p[482]=t,m(+t),e=0|u(1),u(0),2146435072!=(2146435072&e))||(o[966]=8)}(),+p[482]},Mathpack_Cos:function(e){return e=+e,p[482]=e,function(){var e=0,t=0;m(+(t=p[482])),e=0|u(1),u(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+A(+t),p[482]=t,m(+t),e=0|u(1),u(0),2146435072!=(2146435072&e))||(o[966]=8)}(),+p[482]},Mathpack_Tan:function(e){return e=+e,p[482]=e,function(){var e=0,t=0,r=0;r=8,m(+(t=p[482])),e=0|u(1),u(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+I(+t),p[482]=t,r=4,m(+t),e=0|u(1),u(0),2146435072!=(2146435072&e))||(o[966]=r)}(),+p[482]},Mathpack_Asin:function(e){return+B(e=+e,0)},Mathpack_Acos:function(e){return+B(e=+e,1)},Mathpack_Atan:function(e){return e=+e,p[482]=e,fe(),+p[482]},Mathpack_Atan2:function(e,t){return+function(e,t){var r=0,n=0,i=0,a=0,s=0;p[482]=e;e:{if(m(+e),r=0|u(1),u(0),r>>>0>=65536){if(2146435072!=(2146435072&r))break e;o[966]=1}p[482]=t;t:{if(m(+t),r=0|u(1),u(0),n=-65536&r){if(2146435072!=(2146435072&r))break t;o[966]=1}return $(4),0}return ue((0|n)<1?-1:1),ie(p[391]),ae(p[393]),p[482]}e:if((0|r)<=-1){m(+t),r=0|u(1),u(0);t:{if(n=-65536&r)if(2146435072!=(2146435072&r)){if((0|n)<1)break t}else o[966]=1;i=p[391];break e}m(+(i=p[391])),a=-2147483648^(r=0|u(1)),c(0,0|(n=0|u(0))),c(1,0|a),s=+d(),i=65535==(0|r)&n>>>0>4294967295|r>>>0>65535?s:i}else i=p[396];return Pe(t,e),fe(),ee(i),p[482]}(e=+e,t=+t)},Mathpack_Mod:function(e,t){return+function(e,t){var r,n=0,i=0,a=0,s=0,g=0,f=0,S=0,v=0,y=0,F=0,C=0,R=0,b=0,E=0,T=0,k=0,P=0,N=0,A=0,I=0,O=0,_=0,M=0,D=0,x=0,K=0,U=0,B=0;w=r=w+-64|0,p[482]=e,m(+e),n=0|u(1),u(0),(E=-65536&n)&&(2146435072!=(2146435072&n)?U=(0|E)<1?-1:1:o[966]=1),o[965]=2147483647&n,m(+t),n=0|u(1),E=0|u(0),a=n;e:{t:{if(I=-65536&n){if(2146435072!=(2146435072&n))break t;o[966]=1}$(4),e=0;break e}g=n=2147483647&a,c(0,0|E),c(1,0|n),e=+d(),m(+(t=p[482])),n=0|u(1),i=0|u(0),C=n;t:{r:{f=n,M=g;n:if(!((0|n)<(0|g))){i:{if((0|f)<=(0|M)){if((0|(n=i))==(0|(f=E)))break i;if(n>>>0<f>>>0)break n}if(be(O=Y(Te(e)),p[390]),(f=-65536&(n=o[965]))&&(2146435072!=(2146435072&n)?s=(0|f)<1:o[966]=1),o[966]){$(0);break r}if(!s)break r;if(n=2147483647&a,c(0,-134217728&E),c(1,0|n),be(e,D=+d()),(n=o[965])|o[964]&&!(2146435072&n))break r;B=Ee(O),p[482]=oe(O,D),(n=o[965])>>>0>=65536&&(o[965]=-2147483648^n),ee(t),re(B);break n}o[964]=0,o[965]=0}if(n=o[964],a=o[792],v=s=o[965],i=-1,!((0|s)<(0|(g=f=o[793]))||(i=1,(0|v)>(0|g)))){if((0|n)==(0|a))break t;i=n>>>0<a>>>0?-1:1}if(-1!=(0|((s&f)>-1?i:0-i|0)))break t;ee(e);break t}Pe(t,e),o[965]=2147483647&o[965];r:{if(n=o[964],f=o[816],k=F=o[965],y=v=o[817],s=-1,!((0|F)<(0|v)||(s=1,(0|k)>(0|y)))){if((0|n)==(0|f))break r;s=n>>>0<f>>>0?-1:1}if(-1==(0|((v&F)>-1?s:0-s|0))){if(f=0,s=0,F=n=E,Ie(0-n&n,0-((0<n>>>0)+(a=v=1048575&a|1048576)|0)&a,-1261761911,66559345),v=31&(n=k=l[1088+(L>>>26<<1)>>1]),32<=(63&n)>>>0?(n=0,v=a>>>v):(n=a>>>v,v=((1<<v)-1&a)<<32-v|F>>>v),F=n,a=i,n=1048575&C|1048576,(0|(P=k-(R=(C>>>20&2047)-(x=g>>>20)|0)|0))>=1&&(y=31&(i=64-P|0),C=a,32<=(63&i)>>>0?(i=0,y=-1>>>y):(i=-1>>>y,y=(1<<y)-1<<32-y|-1>>>y),a=(T=a)-(y=N=y&a)|0,n=(g=n)-((_=n&i)+(C>>>0<y>>>0)|0)|0),C=r,T=r,g=i=(g=(g=o[1056+((i=v)<<1&28)>>2])-h(g,h(i,g)+-1&240)&255)|0-h(g,h(i,g)+-1&65280)&65280,y=Ie(v,F,i,0),S=L+-1|0,(y=y+-1|0)>>>0<4294967295&&(S=S+1|0),g=Ie(-65536&y,S,i=0-i|0,i>>31)|g,S=Ie(g,y=L,v,F),i=L+-1|0,A=(i=Ie(0,S+-1>>>0<4294967295?i+1|0:i,g,y))-g|0,o[T+56>>2]=A,y=L-((i>>>0<g>>>0)+y|0)|0,o[C+60>>2]=y,o[r+48>>2]=v,o[r+52>>2]=F,Ce(r+56|0,r+48|0,r+8|0,r+40|0),S=o[r+12>>2],(g=o[r+8>>2]+1|0)>>>0<1&&(S=S+1|0),o[r+8>>2]=g,o[r+12>>2]=S,g=_e(0-(i=v)|0,0-((0<i>>>0)+F|0)|0,i,F),C=L,S=31&(i=(0|(R=(R-k|0)- -64|0))%64|0),32<=(63&i)>>>0?(i=1<<S,T=0):(i=(1<<S)-1&1>>>32-S,T=1<<S),S=i,o[r+32>>2]=a,o[r+36>>2]=n,n|a)for(;o[r+56>>2]=a,o[r+60>>2]=n,o[r+48>>2]=g,o[r+52>>2]=C,Ce(r+56|0,r+48|0,r+32|0,r+40|0),a=o[r+32>>2],n=o[r+36>>2],i=s+(b=o[r+44>>2])|0,(s=f+(K=o[r+40>>2])|0)>>>0<f>>>0&&(i=i+1|0),f=s,s=i,(0|b)==(0|i)&f>>>0<K>>>0|i>>>0<b>>>0&&((a=a+1|0)>>>0<1&&(n=n+1|0),o[r+32>>2]=a,o[r+36>>2]=n),a|n;);if(o[r+56>>2]=_e(f,s,v,F),o[r+60>>2]=L,o[r+48>>2]=T,o[r+52>>2]=S,Ce(r+56|0,r+48|0,r+16|0,r+40|0),a=o[r+44>>2],i=o[r+40>>2],o[r+56>>2]=i,o[r+60>>2]=a,o[r+48>>2]=A,o[r+52>>2]=y,Ce(r+56|0,r+48|0,r+24|0,r+40|0),n=o[r+44>>2],o[r+56>>2]=o[r+40>>2],o[r+60>>2]=n,o[r+48>>2]=v,o[r+52>>2]=F,f=0,s=0,Ce(r+56|0,r+48|0,r+32|0,r+40|0),b=o[r+36>>2],S=o[r+20>>2],(i=(a=0!=(0|i)|0!=(0|a))+o[r+16>>2]|0)>>>0<a>>>0&&(S=S+1|0),T=i,a=i+o[r+32>>2]|0,i=S+b|0,o[r>>2]=a,o[r+4>>2]=a>>>0<T>>>0?i+1|0:i,o[r+32>>2]=g,o[r+36>>2]=C,g|C)for(a=g,n=C;o[r+56>>2]=a,o[r+60>>2]=n,o[r+48>>2]=g,o[r+52>>2]=C,Ce(r+56|0,r+48|0,r+32|0,r+40|0),a=o[r+32>>2],n=o[r+36>>2],i=s+(S=o[r+44>>2])|0,(s=f+(b=o[r+40>>2])|0)>>>0<f>>>0&&(i=i+1|0),f=s,s=i,(0|S)==(0|i)&f>>>0<b>>>0|i>>>0<S>>>0&&((a=a+1|0)>>>0<1&&(n=n+1|0),o[r+32>>2]=a,o[r+36>>2]=n),a|n;);if((0|R)>=64)for(a=_e(f,s,v,F),n=L,s=R>>>6;1&s&&(i=o[r+4>>2],o[r+56>>2]=o[r>>2],o[r+60>>2]=i,o[r+48>>2]=a,o[r+52>>2]=n,Ce(r+56|0,r+48|0,r+16|0,r+40|0),S=i=o[r+44>>2],R=o[r+40>>2],o[r+56>>2]=R,o[r+60>>2]=i,o[r+48>>2]=A,o[r+52>>2]=y,Ce(r+56|0,r+48|0,r+24|0,r+40|0),i=o[r+44>>2],o[r+56>>2]=o[r+40>>2],o[r+60>>2]=i,o[r+48>>2]=v,o[r+52>>2]=F,Ce(r+56|0,r+48|0,r+32|0,r+40|0),b=o[r+36>>2],i=o[r+20>>2],(R=(S=0!=(0|R)|0!=(0|S))+o[r+16>>2]|0)>>>0<S>>>0&&(i=i+1|0),S=R+o[r+32>>2]|0,i=i+b|0,o[r>>2]=S,o[r+4>>2]=S>>>0<R>>>0?i+1|0:i),o[r+56>>2]=a,o[r+60>>2]=n,o[r+48>>2]=a,o[r+52>>2]=n,Ce(r+56|0,r+48|0,r+16|0,r+40|0),a=o[r+44>>2],i=o[r+40>>2],o[r+56>>2]=i,o[r+60>>2]=a,o[r+48>>2]=A,o[r+52>>2]=y,Ce(r+56|0,r+48|0,r+24|0,r+40|0),n=o[r+44>>2],o[r+56>>2]=o[r+40>>2],o[r+60>>2]=n,o[r+48>>2]=v,o[r+52>>2]=F,Ce(r+56|0,r+48|0,r+32|0,r+40|0),f=o[r+36>>2],n=o[r+20>>2],(i=(a=0!=(0|i)|0!=(0|a))+o[r+16>>2]|0)>>>0<a>>>0&&(n=n+1|0),n=n+f|0,n=(a=i+o[r+32>>2]|0)>>>0<i>>>0?n+1|0:n,s>>>=1;);if(n=o[r+8>>2],a=o[r+12>>2],i=o[r+4>>2],o[r+56>>2]=o[r>>2],o[r+60>>2]=i,o[r+48>>2]=n,o[r+52>>2]=a,Ce(r+56|0,r+48|0,r,r+40|0),f=o[r+40>>2],s=o[r+44>>2],n=o[r+4>>2],a=o[r>>2],o[r+32>>2]=a,o[r+36>>2]=n,n|a)for(;o[r+56>>2]=a,o[r+60>>2]=n,o[r+48>>2]=g,o[r+52>>2]=C,Ce(r+56|0,r+48|0,r+32|0,r+40|0),a=o[r+32>>2],n=o[r+36>>2],i=s+(y=o[r+44>>2])|0,(s=f+(S=o[r+40>>2])|0)>>>0<f>>>0&&(i=i+1|0),f=s,s=i,(0|y)==(0|i)&f>>>0<S>>>0|i>>>0<y>>>0&&(i=n,(n=a+1|0)>>>0<1&&(i=i+1|0),a=n,o[r+32>>2]=n,n=i,o[r+36>>2]=n),a|n;);if(a=_e(f,s,v,F),n=i=L,o[r>>2]=a,o[r+4>>2]=n,s=(k+x|0)-52|0,N|_&&(g=a,v=31&(a=P),32<=(63&a)>>>0?(i=g<<v,n=0):(i=(1<<v)-1&g>>>32-v|n<<v,n=g<<v),i=i+_|0,a=n=n+N|0,o[r>>2]=n,n=n>>>0<N>>>0?i+1|0:i,o[r+4>>2]=n,s=s-P|0),!(n|a)){o[964]=0,o[965]=0;break t}if((0|n)>=1?(le(n),n=o[964],f=o[965],le(a),i=f+33554432|0,i=2146435072&(n>>>0<0?i+1|0:i)|-2146435073&f,c(0,n|(a=0)),c(1,0|i),ee(+d())):le(a),a=n=o[965],i=o[964],(0|(n=(n>>>20&2047)+s|0))<=1023){o[964]=0,o[965]=0,o[966]=2;break t}o[964]=i,o[965]=-2146435073&a|(n+1025&2047)<<20;break t}}$(2),e=0;break e}(((0|I)<1?-2147483648:1)^U)>-1||((n=o[965])>>>0>=65536&&(o[965]=-2147483648^n),ee(e),o[965]!=(0|M)|(0|E)!=o[964]||(o[964]=0,o[965]=0)),(0|I)>=1?s=o[965]:(s=o[965])>>>0<65536||(s^=-2147483648,o[965]=s),!(o[964]|s)|2146435072&s||(o[966]=2),e=p[482]}return w=r- -64|0,e}(e=+e,t=+t)},Mathpack_FormatGeneral:function(e,t){t|=0;var r,n,a,s=0,c=0;return m(+(e=+e)),r=0|u(1),a=0|u(0),2146435072==(2146435072&r)?(o[966]=1,-1):(p[482]=e,s=3280,(n=-65536&(c=r))&&(2146435072!=(2146435072&c)?(s=3280,(0|n)>0||(c>>>0>=65536&&(o[965]=-2147483648^c),s=3280,!a&-2147483648==(0|r)||(i[1640]=45,s=3282))):(o[966]=1,s=3280)),c=s,t=(0|t)<255?t:255,t=function(e,t,r,n){var a;w=a=w-16|0,e=0|De[o[o[e>>2]+8>>2]](e),o[a+8>>2]=0;e:if(r<<1>>>0<=33){if((0|r)<1)break e;i[t>>1]=0}else Fe(p[482],a+8|0,t,15),t=function(e,t,r,n,a,s){var u,c,d,m=0,g=0,p=0,f=0,S=0;w=c=w-16|0,u=(t<<1)+e|0,d=c+12|0;t:{r:{n:{i:if(!(p=(0|r)<5&(g=a?n:1)+3>>>0<8)){o:if(!((0|g)>(0|r))){if((0|(n=r+g|0))>=3){if((0|r)<5|(0|g)>-4)break i;if((n+-2|0)<(0|a))break o;break i}if((0|r)<5)break i}if(f=1,n=1,(0|r)<7)break n;n=r-(g+97>>>0>196?6:5)|0;break n}(1!=(0|r)||(n=0,g))&&(n=r-((0|g)<(0|r)?(0|g)<1?2-g|0:1:0)|0)}n:{if((0|n)<(0|a)){m=1,a=0;i:if(!((0|t)<1)){o:{a:{if(!n){if(l[e>>1]>52)break a;break i}if((0|n)<1|(0|n)>=(0|t))break i;if(l[(n<<1)+e>>1]<=52)break o;for(;;){if(S=l[(m=((a=n+-1|0)<<1)+e|0)>>1]+1|0,i[m>>1]=S,58!=(65535&S))break o;if(n=a,!a)break}}i[e>>1]=49,a=1,m=g+1|0;break i}for(;(0|(a=n))>=2&&48==l[((n=a+-1|0)<<1)+e>>1];);m=g}if((-1^p)&(0|m)>(0|r)|f)break n;break r}if(m=g,!f)break r}if(o[d>>2]=32768,r=e+2|0,(0|a)<2||(n=r+(a<<1)|0)>>>0>=u>>>0?n=r:(a=a+-1|0,o[d>>2]=32768|a,e=e+4|0,(t<<1)-4>>1>>>0<a>>>0&&R(),K(e,r,a<<1),i[r>>1]=s),n>>>0<u>>>0&&(i[n>>1]=69,n=n+2|0),n>>>0>=u>>>0?a=n:(a=n+2|0,(0|m)<=0?(i[n>>1]=45,m=1-m|0):(i[n>>1]=43,m=m+-1|0)),(0|m)<100|a>>>0>=u>>>0||(e=(m>>>0)/100|0,i[a>>1]=e+48,m=m-h(e,100)|0,a=a+2|0),a>>>0<u>>>0&&(i[a>>1]=48+((0|m)/10|0),a=a+2|0),a>>>0>=u>>>0)break t;i[a>>1]=48+((0|m)%10|0),a=a+2|0;break t}if((0|a)<0|(0|a)>(0|m))if(r=a-m|0,o[d>>2]=r,(0|m)>=1){if(!((r=(n=((p=(r=(g=(0|m)>(0|t)?t:m)<<1)+e|0)+(a<<1)|0)-r|0)-2|0)>>>0<e>>>0|n>>>0>=u>>>0))for(;i[n>>1]=l[r>>1],n=n+-2|0,(r=r+-2|0)>>>0>=p>>>0;);(0|m)<(0|t)&&(i[p>>1]=s),a=p+(((0|(e=u-p>>1))>(0|(t=a-g|0))?t+1|0:e)<<1)|0}else{if(!((n=2+((e-(m<<1)|0)+(a<<1)|0)|0)>>>0>=u>>>0||(a=((a<<1)+e|0)-2|0)>>>0<e>>>0))for(;i[n>>1]=l[a>>1],n=n+-2|0,(a=a+-2|0)>>>0>=e>>>0;);if((0|t)>=1&&(i[e>>1]=48,e=e+2|0),e>>>0<u>>>0&&(i[e>>1]=s,e=e+2|0),n=u-e>>1,m&&(t=(0|n)<(0|(t=0-m|0))?n:t))for(a=0;i[(a<<1)+e>>1]=48,(0|t)!=(0|(a=a+1|0)););a=(((0|n)<(0|r)?n:r)<<1)+e|0}else{if(r=(n=(0|m)>(0|t)?t:m)-a|0)for(t=(a<<1)+e|0,a=0;i[t+(a<<1)>>1]=48,(0|r)!=(0|(a=a+1|0)););a=(n<<1)+e|0}}return w=c+16|0,a}(t,r,n,i[a+8>>1],i[a+10>>1],e);return w=a+16|0,t}(o[256],c,3790-c>>1,(0|t)>0?t:0),o[964]=0,o[965]=0,t-3280>>1)},Mathpack_FormatGetExponent:function(){return o[968]},Mathpack_FormatGetSign:function(){return o[969]},Mathpack_FormatFixed:function(e,t,r){t|=0,r|=0;var n,a=0,s=0;return w=n=w+-64|0,m(+(e=+e)),a=0|u(1),u(0),2146435072!=(2146435072&a)?(o[n+56>>2]=0,i[n+46>>1]=0,i[n+48>>1]=0,Fe(e,n+56|0,n+16|0,(a=t+r|0)>>>0<15?a:15),s=i[n+56>>1],a=i[n+58>>1],o[n+8>>2]=a,t=t+s|0,o[n+12>>2]=t,(0|(t=t+r|0))<(0|a)&&(X(n+16|0,n+12|0,n+8|0,t),a=o[n+8>>2]),a?((0|(r=r+(t=o[n+12>>2])|0))<(0|a)&&(o[n+8>>2]=r,a=r),(0|a)>-1||(o[966]=1)):(a=0,o[n+12>>2]=0,t=0),o[968]=t,o[969]=l[n+48>>1]>>>15^1,r=a,a>>>0>=256&&(R(),r=o[n+8>>2]),K(3280,n+16|0,a<<1)):(o[966]=1,r=-1),w=n- -64|0,0|r},Mathpack_FormatScientific:function(e,t,r){t|=0,r|=0;var n,a=0,s=0,c=0;if(w=n=w+-64|0,m(+(e=+e)),s=0|u(1),u(0),2146435072!=(2146435072&s)){if(o[n+56>>2]=0,i[n+46>>1]=0,i[n+48>>1]=0,Fe(e,n+56|0,n+16|0,15),c=i[n+56>>1],o[n+12>>2]=c,s=i[n+58>>1],o[n+8>>2]=s,(0|(a=t))>=2&&(a=(0|c)%(0|t)|0,a=((0|c)<1?t:a?0:t)+a|0),!((0|(a=r+a|0))>=(0|s))){for(X(n+16|0,n+12|0,n+8|0,a),a=(0|a)<(0|(s=o[n+8>>2]))?a:s;s=a,(0|a)>=1&&48==l[(n+16|0)+((a=s+-1|0)<<1)>>1];);o[n+8>>2]=s,(0|t)<2||(0|(a=o[n+12>>2]))!=(0|c)&&((((c=r)+(r=(0|a)%(0|t)|0)|0)+((0|a)<1?t:r?0:t)|0)>=(0|s)||(R(),s=o[n+8>>2]))}(0|s)<=-1&&(o[966]=1),o[968]=o[n+12>>2],o[969]=l[n+48>>1]>>>15^1,(a=s)>>>0>=256&&(R(),a=o[n+8>>2]),K(3280,n+16|0,s<<1)}else o[966]=1,a=-1;return w=n- -64|0,0|a},Mathpack_Pack:function(e,t,r){var a;return e|=0,t|=0,r|=0,w=a=w-48|0,n[a+39|0]=0,K(a+8|0,3280,(r=(0|r)<15?r:15)<<1),i[a+40>>1]=t+16384&32767|!e<<15,n[a+38|0]=r,o[a>>2]=0,o[a+4>>2]=0,ye(o[256],a,a+8|0)&&(o[966]=1),w=a+48|0,+p[a>>3]},_start:x,__errno_location:function(){return 3888},setThrew:function(e,t){e|=0,t|=0,o[970]||(o[971]=t,o[970]=e)},stackSave:function(){return 0|w},stackAlloc:function(e){return w=e=w-(e|=0)&-16,0|e},stackRestore:function(e){w=e|=0},__growWasmMemory:function(e){return 0|R()}}}({Math:n.Math,Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,NaN:NaN,Infinity:1/0},{abort:function(){throw new Error("abort")},Base_LocaleIsNumeral:i.Base_LocaleIsNumeral,Base_LocaleGetOrdinal:i.Base_LocaleGetOrdinal,Base_LocaleDecimalSeparator:i.Base_LocaleDecimalSeparator,Math_log10:i.Math_log10,Math_log:i.Math_log,Math_sqrt:i.Math_sqrt,Math_sin:i.Math_sin,Math_cos:i.Math_cos,Math_tan:i.Math_tan,Math_atan:i.Math_atan,Math_exp:i.Math_exp,proc_exit:o.proc_exit,getTempRet0:i.getTempRet0},p),S=f.memory;t.memory=S;var v=f.Base_StrBuf;t.Base_StrBuf=v;var y=f.Base_StrBufSize;t.Base_StrBufSize=y;var F=f.Dtr_DaysPerMonth;t.Dtr_DaysPerMonth=F;var C=f.Dtr_FromNum;t.Dtr_FromNum=C;var R=f.Dtr_Yr;t.Dtr_Yr=R;var b=f.Dtr_Mon;t.Dtr_Mon=b;var E=f.Dtr_DOM;t.Dtr_DOM=E;var T=f.Dtr_Hour;t.Dtr_Hour=T;var k=f.Dtr_Min;t.Dtr_Min=k;var P=f.Dtr_Sec;t.Dtr_Sec=P;var N=f.Dtr_Wdy;t.Dtr_Wdy=N;var A=f.Dtr_FracSec;t.Dtr_FracSec=A;var I=f.Dtr_Rounding;t.Dtr_Rounding=I;var O=f.Dtr_Write;t.Dtr_Write=O;var _=f.Dtr_ToNum;t.Dtr_ToNum=_;var M=f.Dtr_ToNumWithDuration;t.Dtr_ToNumWithDuration=M;var D=f.Dtr_Days;t.Dtr_Days=D;var w=f.Dtr_ToDays;t.Dtr_ToDays=w;var L=f.Dtr_ToTime;t.Dtr_ToTime=L;var x=f.Dtr_UtcToLocal;t.Dtr_UtcToLocal=x;var K=f.Mathpack_Zero;t.Mathpack_Zero=K;var U=f.Mathpack_One;t.Mathpack_One=U;var B=f.Mathpack_Pi;t.Mathpack_Pi=B;var G=f.Mathpack_Div;t.Mathpack_Div=G;var W=f.Mathpack_Mul;t.Mathpack_Mul=W;var V=f.Mathpack_Sub;t.Mathpack_Sub=V;var j=f.Mathpack_Add;t.Mathpack_Add=j;var q=f.Mathpack_Power;t.Mathpack_Power=q;var H=f.Mathpack_Cond;t.Mathpack_Cond=H;var z=f.Mathpack_Cond2;t.Mathpack_Cond2=z;var $=f.Mathpack_TakeMathError;t.Mathpack_TakeMathError=$;var Q=f.Mathpack_Trunc;t.Mathpack_Trunc=Q;var Y=f.Mathpack_Ceil;t.Mathpack_Ceil=Y;var J=f.Mathpack_Floor;t.Mathpack_Floor=J;var X=f.Mathpack_Abs;t.Mathpack_Abs=X;var Z=f.Mathpack_Neg;t.Mathpack_Neg=Z;var ee=f.Mathpack_Float;t.Mathpack_Float=ee;var te=f.Mathpack_SFloat;t.Mathpack_SFloat=te;var re=f.Mathpack_Fix;t.Mathpack_Fix=re;var ne=f.Mathpack_LFix;t.Mathpack_LFix=ne;var ie=f.Mathpack_SFix;t.Mathpack_SFix=ie;var oe=f.Mathpack_Round;t.Mathpack_Round=oe;var ae=f.Mathpack_RoundUp;t.Mathpack_RoundUp=ae;var se=f.Mathpack_RoundDown;t.Mathpack_RoundDown=se;var le=f.Mathpack_TenTo;t.Mathpack_TenTo=le;var ue=f.Mathpack_Compare;t.Mathpack_Compare=ue;var ce=f.Mathpack_GetExp32;t.Mathpack_GetExp32=ce;var de=f.Mathpack_Equal;t.Mathpack_Equal=de;var me=f.Mathpack_ViewRound;t.Mathpack_ViewRound=me;var ge=f.Mathpack_Sqrt;t.Mathpack_Sqrt=ge;var pe=f.Mathpack_Exp;t.Mathpack_Exp=pe;var he=f.Mathpack_Ln;t.Mathpack_Ln=he;var fe=f.Mathpack_Log;t.Mathpack_Log=fe;var Se=f.Mathpack_Sin;t.Mathpack_Sin=Se;var ve=f.Mathpack_Cos;t.Mathpack_Cos=ve;var ye=f.Mathpack_Tan;t.Mathpack_Tan=ye;var Fe=f.Mathpack_Asin;t.Mathpack_Asin=Fe;var Ce=f.Mathpack_Acos;t.Mathpack_Acos=Ce;var Re=f.Mathpack_Atan;t.Mathpack_Atan=Re;var be=f.Mathpack_Atan2;t.Mathpack_Atan2=be;var Ee=f.Mathpack_Mod;t.Mathpack_Mod=Ee;var Te=f.Mathpack_FormatGeneral;t.Mathpack_FormatGeneral=Te;var ke=f.Mathpack_FormatGetExponent;t.Mathpack_FormatGetExponent=ke;var Pe=f.Mathpack_FormatGetSign;t.Mathpack_FormatGetSign=Pe;var Ne=f.Mathpack_FormatFixed;t.Mathpack_FormatFixed=Ne;var Ae=f.Mathpack_FormatScientific;t.Mathpack_FormatScientific=Ae;var Ie=f.Mathpack_Pack;t.Mathpack_Pack=Ie;var Oe=f._start;t._start=Oe;var _e=f.__errno_location;t.__errno_location=_e;var Me=f.setThrew;t.setThrew=Me;var De=f.stackSave;t.stackSave=De;var we=f.stackAlloc;t.stackAlloc=we;var Le=f.stackRestore;t.stackRestore=Le;var xe=f.__growWasmMemory;t.__growWasmMemory=xe},25777:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Base_LocaleDecimalSeparator",{enumerable:!0,get:function(){return n.Base_LocaleDecimalSeparator}}),Object.defineProperty(t,"Base_LocaleGetOrdinal",{enumerable:!0,get:function(){return n.Base_LocaleGetOrdinal}}),Object.defineProperty(t,"Base_LocaleIsNumeral",{enumerable:!0,get:function(){return n.Base_LocaleIsNumeral}}),t.Math_tan=t.Math_sqrt=t.Math_sin=t.Math_log10=t.Math_log=t.Math_exp=t.Math_cos=t.Math_atan=void 0,t.getTempRet0=function(){return m},t.setTempRet0=function(e){m=e};var n=r(55435);const i=Math.sqrt;t.Math_sqrt=i;const o=Math.log10||function(e){return Math.log(e)*Math.LOG10E};t.Math_log10=o;const a=Math.log;t.Math_log=a;const s=Math.exp;t.Math_exp=s;const l=Math.sin;t.Math_sin=l;const u=Math.cos;t.Math_cos=u;const c=Math.tan;t.Math_tan=c;const d=Math.atan;t.Math_atan=d;let m=0},6598:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Math=void 0;const r=function(e){if(e.imul&&e.fround&&e.clz32)return e;const t=new Float32Array(1);return Object.create(e,{imul:{value:function(e,t){var r=(4194303&e)*(t|=0);return 4290772992&e&&(r+=(4290772992&e)*t|0),0|r}},fround:{value:function(e){return t[0]=e,t[0]}},clz32:{value:function(t){var r=t>>>0;return 0===r?32:31-(e.log(r)/e.LN2|0)|0}}})}(Math);t.Math=r},54137:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.proc_exit=function(e){throw new Error("unexpected process termination: "+e)}},6481:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.utcToLocal=t.toTime=t.TimeDivision=t.toDays=t.toNumWithDuration=t.toNum=t.fromNum=t.dtr=t.Rounding=t.daysPerMonth=void 0;var n,i,o=r(21991),a=r(9220);function s(e,t,r,n,i,o,a,s,l){return{yr:e,mon:t,dom:r,hour:n,min:i,sec:o,wdy:a,fracSec:s,rounding:l}}function l(e){return s((0,o.Dtr_Yr)(e),(0,o.Dtr_Mon)(e),(0,o.Dtr_DOM)(e),(0,o.Dtr_Hour)(e),(0,o.Dtr_Min)(e),(0,o.Dtr_Sec)(e),(0,o.Dtr_Wdy)(e),(0,o.Dtr_FracSec)(e),(0,o.Dtr_Rounding)(e))}function u(e,t){(0,o.Dtr_Write)(t.yr,t.mon,t.dom,t.hour,t.min,t.sec,t.wdy,t.fracSec,t.rounding,e)}t.daysPerMonth=function(e,t,r){return(0,o.Dtr_DaysPerMonth)(e,t,r?1:0)},function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(n||(t.Rounding=n={})),t.dtr=s,t.fromNum=function(e,t,r,n){var i=t;return 0===(0,o.Dtr_FromNum)(e,i,0,r?1:0,n?1:0)&&l(0)},t.toNum=function(e,t,r){u(0,e);var n=(0,o.Dtr_ToNum)(0,t?1:0,r?1:0),i=(0,o.Mathpack_TakeMathError)();return i===a.MathErrorNum.None?n:(0,a.mathError)(i)},t.toNumWithDuration=function(e,t,r,n,i){u(0,e);var s=n,l=(0,o.Dtr_ToNumWithDuration)(0,t?1:0,r?1:0,s,i),c=(0,o.Mathpack_TakeMathError)();return c===a.MathErrorNum.None?l:(0,a.mathError)(c)},t.toDays=function(e,t,r){return u(0,e),0===(0,o.Dtr_ToDays)(0,t?1:0,r?1:0)&&(0,o.Dtr_Days)()},function(e){e[e.Hour=0]="Hour",e[e.Minute=1]="Minute",e[e.Second=2]="Second"}(i||(t.TimeDivision=i={})),t.toTime=function(e,t,r){var n=t,i=r,s=(0,o.Dtr_ToTime)(e,n,i);return(0,o.Mathpack_TakeMathError)()===a.MathErrorNum.None&&s},t.utcToLocal=function(e,t,r,n){return u(0,e),null!=t.standardDate&&u(1,t.standardDate),null!=t.daylightDate&&u(2,t.daylightDate),0!==(0,o.Dtr_UtcToLocal)(0,t.bias,null!=t.standardDate?1:-1,t.standardBias,null!=t.daylightDate?2:-1,t.daylightBias,r?1:0,n?1:0)&&l(0)}},55843:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSupported=t.dtr=t.mathpack=void 0;var n=r(9220);t.mathpack=n;var i=r(6481);t.dtr=i;var o=r(55435);Object.defineProperty(t,"isSupported",{enumerable:!0,get:function(){return o.isSupported}}),(0,r(21991)._start)()},9220:function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.pack=t.formatScientific=t.formatFixed=t.formatGeneral=t.mod=t.atan2=t.atan=t.acos=t.asin=t.tan=t.cos=t.sin=t.log=t.ln=t.exp=t.sqrt=t.viewRound=t.cond2=t.cond=t.power=t.add=t.sub=t.mul=t.div=t.compare=t.tenTo=t.roundDown=t.roundUp=t.round=t.sfix=t.lfix=t.fix=t.float=t.neg=t.abs=t.floor=t.ceil=t.trunc=t.equal=t.exp32=t.pi=t.one=t.zero=t.mathError=t.MathErrorNum=void 0;var i,o=r(21991),a=r(55435),s=r(21991);function l(e,t){for(var r=new Uint16Array(s.memory.buffer),n="",i=0;i<t;i+=1)n+=String.fromCharCode(r[e+(i<<1)>>1]);return n}function u(e){return{num:e}}!function(e){e[e.None=0]="None",e[e.Over=1]="Over",e[e.Under=2]="Under",e[e.DivBy0=4]="DivBy0",e[e.Trans=8]="Trans",e[e._NA=16]="_NA",e[e._Val=32]="_Val",e[e._Num=64]="_Num"}(i||(t.MathErrorNum=i={}));var c=((n={})[i.Over]=u(i.Over),n[i.Under]=u(i.Under),n[i.DivBy0]=u(i.DivBy0),n[i.Trans]=u(i.Trans),n);function d(e){var t;return null!==(t=c[e])&&void 0!==t?t:u(e)}function m(e){return function(t){var r=e(t),n=(0,o.Mathpack_TakeMathError)();return n===i.None?r:d(n)}}function g(e){return function(t,r){var n=e(t,r),a=(0,o.Mathpack_TakeMathError)();return a===i.None?n:d(a)}}t.mathError=d,t.zero=o.Mathpack_Zero,t.one=o.Mathpack_One,t.pi=o.Mathpack_Pi,t.exp32=o.Mathpack_GetExp32,t.equal=function(e,t){return 0!==(0,o.Mathpack_Equal)(e,t)},t.trunc=o.Mathpack_Trunc,t.ceil=m(o.Mathpack_Ceil),t.floor=m(o.Mathpack_Floor),t.abs=o.Mathpack_Abs,t.neg=o.Mathpack_Neg,t.float=function(e){return e<0?(0,o.Mathpack_SFloat)(e):(0,o.Mathpack_Float)(e)},t.fix=function(e){return(0,o.Mathpack_Fix)(e)>>>0},t.lfix=o.Mathpack_LFix,t.sfix=m(o.Mathpack_SFix),t.round=g(o.Mathpack_Round),t.roundUp=g(o.Mathpack_RoundUp),t.roundDown=g(o.Mathpack_RoundDown),t.tenTo=function(e){if(e<-1e3)return 0;if(e>1e3)return d(i.Over);if(!isFinite(e))return d(i.Over);var t=(0,o.Mathpack_TenTo)(e),r=(0,o.Mathpack_TakeMathError)();return r===i.None?t:d(r)},t.compare=o.Mathpack_Compare,t.div=g(o.Mathpack_Div),t.mul=g(o.Mathpack_Mul),t.sub=g(o.Mathpack_Sub),t.add=g(o.Mathpack_Add),t.power=g(o.Mathpack_Power),t.cond=function(e){var t=(0,o.Mathpack_Cond)(e),r=(0,o.Mathpack_TakeMathError)();return r===i.None?t:d(r)},t.cond2=o.Mathpack_Cond2,t.viewRound=m(o.Mathpack_ViewRound),t.sqrt=m(o.Mathpack_Sqrt),t.exp=m(o.Mathpack_Exp),t.ln=m(o.Mathpack_Ln),t.log=m(o.Mathpack_Log),t.sin=m(o.Mathpack_Sin),t.cos=m(o.Mathpack_Cos),t.tan=m(o.Mathpack_Tan),t.asin=m(o.Mathpack_Asin),t.acos=m(o.Mathpack_Acos),t.atan=m(o.Mathpack_Atan),t.atan2=g(o.Mathpack_Atan2),t.mod=g(o.Mathpack_Mod),t.formatGeneral=function(e,t,r){try{(0,a.setLocale)(e);var n=(0,o.Mathpack_FormatGeneral)(t,r);return n<0?d((0,o.Mathpack_TakeMathError)()):l((0,o.Base_StrBuf)(),n)}finally{(0,a.setLocale)(void 0)}},t.formatFixed=function(e,t,r){var n=(0,o.Mathpack_FormatFixed)(e,t,r);if(n<0)return(0,o.Mathpack_TakeMathError)();var i=l((0,o.Base_StrBuf)(),n),a=(0,o.Mathpack_FormatGetExponent)();return{sign:0!==(0,o.Mathpack_FormatGetSign)(),mantissa:i,exponent:a}},t.formatScientific=function(e,t,r){var n=(0,o.Mathpack_FormatScientific)(e,t,r);if(n<0)return(0,o.Mathpack_TakeMathError)();var i=l((0,o.Base_StrBuf)(),n),a=(0,o.Mathpack_FormatGetExponent)();return{sign:0!==(0,o.Mathpack_FormatGetSign)(),mantissa:i,exponent:a}},t.pack=function(e,t,r,n){try{(0,a.setLocale)(e);var l=(0,a.fastMin)(n.length,(0,o.Base_StrBufSize)());!function(e,t){for(var r=new Uint16Array(s.memory.buffer),n=0;n<t.length;n+=1)r[e+(n<<1)>>1]=t.charCodeAt(n)}((0,o.Base_StrBuf)(),n.substring(0,l));var u=(0,o.Mathpack_Pack)(!!t,r,l),c=(0,o.Mathpack_TakeMathError)();return c!==i.None?d(c):isNaN(u)?d(i.Over):u}finally{(0,a.setLocale)(void 0)}}},55435:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSupported=t.fastMin=t.Base_LocaleDecimalSeparator=t.Base_LocaleGetOrdinal=t.Base_LocaleIsNumeral=t.setLocale=void 0;var r=void 0;t.setLocale=function(e){r=e},t.Base_LocaleIsNumeral=function(e){return r.isNumeral(e)?1:0},t.Base_LocaleGetOrdinal=function(e){return r.getOrdinal(e)},t.Base_LocaleDecimalSeparator=function(){var e=r.decimalSeparator;return 0===e.length?46:e.charCodeAt(0)},t.fastMin=function(e,t){return e<t?e:t},t.isSupported=function(){var e=new ArrayBuffer(2);return new Uint16Array(e)[0]=1,1===new Uint8Array(e)[0]}},49143:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},11641:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(19181).__exportStar(r(49143),t)},93154:function(e,t){"use strict";var r,n,i,o,a;Object.defineProperty(t,"__esModule",{value:!0}),t.PictureDbnum=t.PictureColor=t.PictureSpecial=t.PictureSingle=t.Rounding=void 0,function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(r||(t.Rounding=r={})),function(e){e[e.Sep=1]="Sep",e[e.Hash=2]="Hash",e[e.Zero=3]="Zero",e[e.Decimal=4]="Decimal",e[e.Percent=5]="Percent",e[e.Comma=6]="Comma",e[e.Colon=7]="Colon",e[e.DateSep=8]="DateSep",e[e.Slash=9]="Slash",e[e.Space=10]="Space",e[e.Minus=11]="Minus",e[e.Plus=12]="Plus",e[e.OpenParen=13]="OpenParen",e[e.CloseParen=14]="CloseParen",e[e.Extra=15]="Extra",e[e.Backslash=16]="Backslash",e[e.Star=17]="Star",e[e.Year=18]="Year",e[e.Month=19]="Month",e[e.Day=20]="Day",e[e.Hour=21]="Hour",e[e.Minute=22]="Minute",e[e.Second=23]="Second",e[e.E=24]="E",e[e.APDelim=25]="APDelim",e[e.Quote=26]="Quote",e[e.ColorStart=27]="ColorStart",e[e.ColorEnd=28]="ColorEnd",e[e.Text=29]="Text",e[e.Question=30]="Question",e[e.Underscore=31]="Underscore",e[e.Reign=32]="Reign",e[e.LocDay=33]="LocDay",e[e.Era=34]="Era",e[e.EraYear=35]="EraYear",e[e.Nen1=36]="Nen1",e[e.Gatsu1=37]="Gatsu1",e[e.Nichi1=38]="Nichi1",e[e.Nen2=39]="Nen2",e[e.Gatsu2=40]="Gatsu2",e[e.Nichi2=41]="Nichi2",e[e.BidiDate=42]="BidiDate",e[e.BidiNum=43]="BidiNum",e[e.DayTh=44]="DayTh",e[e.MonthTh=45]="MonthTh",e[e.YearTh=46]="YearTh",e[e.EngYearTh=47]="EngYearTh",e[e.ThYear=48]="ThYear",e[e.HourTh=49]="HourTh",e[e.MinuteTh=50]="MinuteTh",e[e.SecondTh=51]="SecondTh",e[e.ZeroTh=52]="ZeroTh"}(n||(t.PictureSingle=n={})),function(e){e[e.AP1=0]="AP1",e[e.AP2=1]="AP2",e[e.AP3=2]="AP3",e[e.GeneralOldMAC=3]="GeneralOldMAC",e[e.General=4]="General",e[e.Currency=5]="Currency"}(i||(t.PictureSpecial=i={})),function(e){e[e.Black=0]="Black",e[e.White=1]="White",e[e.Red=2]="Red",e[e.Green=3]="Green",e[e.Blue=4]="Blue",e[e.Yellow=5]="Yellow",e[e.Magenta=6]="Magenta",e[e.Cyan=7]="Cyan",e[e.Color=8]="Color"}(o||(t.PictureColor=o={})),function(e){e[e.DBNUM1=0]="DBNUM1",e[e.DBNUM2=1]="DBNUM2",e[e.DBNUM3=2]="DBNUM3",e[e.DBNUM4=3]="DBNUM4"}(a||(t.PictureDbnum=a={}))},42733:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},83239:function(e,t){"use strict";var r,n,i,o,a;Object.defineProperty(t,"__esModule",{value:!0}),t.PictureDbnum=t.PictureColor=t.PictureSpecial=t.PictureSingle=t.Rounding=void 0,function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(r||(t.Rounding=r={})),function(e){e[e.Sep=1]="Sep",e[e.Hash=2]="Hash",e[e.Zero=3]="Zero",e[e.Decimal=4]="Decimal",e[e.Percent=5]="Percent",e[e.Comma=6]="Comma",e[e.Colon=7]="Colon",e[e.DateSep=8]="DateSep",e[e.Slash=9]="Slash",e[e.Space=10]="Space",e[e.Minus=11]="Minus",e[e.Plus=12]="Plus",e[e.OpenParen=13]="OpenParen",e[e.CloseParen=14]="CloseParen",e[e.Extra=15]="Extra",e[e.Backslash=16]="Backslash",e[e.Star=17]="Star",e[e.Year=18]="Year",e[e.Month=19]="Month",e[e.Day=20]="Day",e[e.Hour=21]="Hour",e[e.Minute=22]="Minute",e[e.Second=23]="Second",e[e.E=24]="E",e[e.APDelim=25]="APDelim",e[e.Quote=26]="Quote",e[e.ColorStart=27]="ColorStart",e[e.ColorEnd=28]="ColorEnd",e[e.Text=29]="Text",e[e.Question=30]="Question",e[e.Underscore=31]="Underscore",e[e.Reign=32]="Reign",e[e.LocDay=33]="LocDay",e[e.Era=34]="Era",e[e.EraYear=35]="EraYear",e[e.Nen1=36]="Nen1",e[e.Gatsu1=37]="Gatsu1",e[e.Nichi1=38]="Nichi1",e[e.Nen2=39]="Nen2",e[e.Gatsu2=40]="Gatsu2",e[e.Nichi2=41]="Nichi2",e[e.BidiDate=42]="BidiDate",e[e.BidiNum=43]="BidiNum",e[e.DayTh=44]="DayTh",e[e.MonthTh=45]="MonthTh",e[e.YearTh=46]="YearTh",e[e.EngYearTh=47]="EngYearTh",e[e.ThYear=48]="ThYear",e[e.HourTh=49]="HourTh",e[e.MinuteTh=50]="MinuteTh",e[e.SecondTh=51]="SecondTh",e[e.ZeroTh=52]="ZeroTh"}(n||(t.PictureSingle=n={})),function(e){e[e.AP1=0]="AP1",e[e.AP2=1]="AP2",e[e.AP3=2]="AP3",e[e.GeneralOldMAC=3]="GeneralOldMAC",e[e.General=4]="General",e[e.Currency=5]="Currency"}(i||(t.PictureSpecial=i={})),function(e){e[e.Black=0]="Black",e[e.White=1]="White",e[e.Red=2]="Red",e[e.Green=3]="Green",e[e.Blue=4]="Blue",e[e.Yellow=5]="Yellow",e[e.Magenta=6]="Magenta",e[e.Cyan=7]="Cyan",e[e.Color=8]="Color"}(o||(t.PictureColor=o={})),function(e){e[e.DBNUM1=0]="DBNUM1",e[e.DBNUM2=1]="DBNUM2",e[e.DBNUM3=2]="DBNUM3",e[e.DBNUM4=3]="DBNUM4"}(a||(t.PictureDbnum=a={}))},70005:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},97896:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.DefinedNameInfoType=void 0,function(e){e[e.Invalid=-1]="Invalid",e[e.Table=0]="Table",e[e.NamedRange=1]="NamedRange",e[e.Lambda=2]="Lambda",e[e.Other=3]="Other"}(r||(t.DefinedNameInfoType=r={}))},94214:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.MajorityDataType=void 0,function(e){e[e.Text=0]="Text",e[e.Number=1]="Number",e[e.Date=2]="Date",e[e.Max=3]="Max"}(r||(t.MajorityDataType=r={}))},40971:function(e,t){"use strict";var r,n,i,o,a,s;Object.defineProperty(t,"__esModule",{value:!0}),t.RepairItemPartType=t.CodeActionKind=t.DiagnosticTag=t.DiagnosticSeverity=t.SuggestionKind=t.CompletionItemKind=void 0,function(e){e[e.Function=3]="Function",e[e.Enum=13]="Enum",e[e.NamedRange=100]="NamedRange",e[e.TableHeader=101]="TableHeader",e[e.LetVariable=102]="LetVariable",e[e.RichEntity=103]="RichEntity",e[e.Lambda=104]="Lambda",e[e.CustomFunction=105]="CustomFunction",e[e.Table=106]="Table",e[e.TableSpecialStructRef=107]="TableSpecialStructRef",e[e.RichEntityEmptyCellRef=108]="RichEntityEmptyCellRef",e[e.RangeRef=109]="RangeRef",e[e.NamedOther=110]="NamedOther"}(r||(t.CompletionItemKind=r={})),function(e){e[e.Simple=0]="Simple",e[e.Smart=1]="Smart"}(n||(t.SuggestionKind=n={})),function(e){e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Hint=4]="Hint"}(i||(t.DiagnosticSeverity=i={})),function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"}(o||(t.DiagnosticTag=o={})),function(e){e[e.Empty=0]="Empty",e[e.QuickFix=1]="QuickFix",e[e.Refactor=2]="Refactor",e[e.RefactorExtract=3]="RefactorExtract",e[e.RefactorInline=4]="RefactorInline",e[e.RefactorRewrite=5]="RefactorRewrite",e[e.Source=6]="Source",e[e.SourceOrganizeImports=7]="SourceOrganizeImports",e[e.SourceFixAll=8]="SourceFixAll"}(a||(t.CodeActionKind=a={})),function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.Removed=2]="Removed",e[e.Replaced=3]="Replaced"}(s||(t.RepairItemPartType=s={}))},60387:function(e,t){"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.ReferenceMode=t.IncompatibilityType=void 0,function(e){e[e.gMove=1]="gMove"}(r||(t.IncompatibilityType=r={})),function(e){e[e.R1C1=0]="R1C1",e[e.A1=1]="A1"}(n||(t.ReferenceMode=n={}))},19272:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3559:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6766:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},15584:function(e,t){"use strict";var r,n,i,o,a,s,l,u,c,d,m,g,p,h;Object.defineProperty(t,"__esModule",{value:!0}),t.TableOrientation=t.RecognizedTablesMetadataState=t.ColumnFormulaSuggestionUpdateKind=t.SchedulerFeature=t.GotoCtrlClickResultKind=t.ValuePreviewResultKind=t.PositionKind=t.HighlightKind=t.PerCharacterExperimentResultKind=t.PluginAttachGroup=t.PluginGroup=t.PluginFactoryName=t.MessageType=t.EditorMessageType=void 0,function(e){e[e.FunctionMessage=0]="FunctionMessage"}(r||(t.EditorMessageType=r={})),function(e){e[e.Insert=0]="Insert",e[e.Delete=1]="Delete",e[e.Replace=2]="Replace"}(n||(t.MessageType=n={})),function(e){e[e.TestPlugin=0]="TestPlugin",e[e.AutocompletePlugin=1]="AutocompletePlugin",e[e.DragPlugin=2]="DragPlugin",e[e.ConfigTestPlugin=3]="ConfigTestPlugin",e[e.ArgumentAssistancePlugin=4]="ArgumentAssistancePlugin",e[e.FeatureGateTestPlugin=5]="FeatureGateTestPlugin",e[e.DNMTraceTagTestPlugin=7]="DNMTraceTagTestPlugin",e[e.ParenthesesCouplingPlugin=8]="ParenthesesCouplingPlugin",e[e.AutocompleteFunctionPlugin=9]="AutocompleteFunctionPlugin",e[e.AutocompleteLetPlugin=10]="AutocompleteLetPlugin",e[e.AutocompleteRichValuePlugin=11]="AutocompleteRichValuePlugin",e[e.AutocompleteNamedObjectsPlugin=12]="AutocompleteNamedObjectsPlugin",e[e.AutocompleteTableHeadersPlugin=13]="AutocompleteTableHeadersPlugin",e[e.ColoredReferencesPlugin=14]="ColoredReferencesPlugin",e[e.ValuePreviewPlugin=15]="ValuePreviewPlugin",e[e.AutocompleteRangeSuggestionPlugin=16]="AutocompleteRangeSuggestionPlugin",e[e.SyntaxErrorsPlugin=17]="SyntaxErrorsPlugin",e[e.GotoCtrlClickPlugin=18]="GotoCtrlClickPlugin",e[e.AutocompleteEnumPlugin=19]="AutocompleteEnumPlugin",e[e.FormulaByExamplePlugin=20]="FormulaByExamplePlugin",e[e.SetCellPrefetchPlugin=21]="SetCellPrefetchPlugin",e[e.FormulaTranspilerPlugin=22]="FormulaTranspilerPlugin",e[e.FormulaCollectionPlugin=1004]="FormulaCollectionPlugin",e[e.ParserPerformanceMeasurements=1005]="ParserPerformanceMeasurements",e[e.FormulaRepairShadowEvalPlugin=1007]="FormulaRepairShadowEvalPlugin",e[e.PythonAutocompletePlugin=1008]="PythonAutocompletePlugin",e[e.AutocompleteWrapperPlugin=1009]="AutocompleteWrapperPlugin",e[e.AutocompleteBinaryModelExperimentPlugin=1010]="AutocompleteBinaryModelExperimentPlugin",e[e.ChangeGateTestPlugin=2e3]="ChangeGateTestPlugin",e[e.SlowTestPlugin=2001]="SlowTestPlugin",e[e.EvalOnCloneTestPlugin=2002]="EvalOnCloneTestPlugin",e[e.EvalFormulaTestPlugin=2003]="EvalFormulaTestPlugin",e[e.PythonTestPlugin=2004]="PythonTestPlugin",e[e.ChatGPTPlugin=2005]="ChatGPTPlugin",e[e.EventsTestPlugin=2006]="EventsTestPlugin"}(i||(t.PluginFactoryName=i={})),function(e){e[e.Excel=0]="Excel",e[e.Python=1]="Python"}(o||(t.PluginGroup=o={})),function(e){e[e.Core=0]="Core",e[e.Python=1]="Python",e[e.SmartSuggestionsAutoComplete=2]="SmartSuggestionsAutoComplete"}(a||(t.PluginAttachGroup=a={})),function(e){e[e.AutocompleteWrapperPluginResult=0]="AutocompleteWrapperPluginResult"}(s||(t.PerCharacterExperimentResultKind=s={})),function(e){e[e.CellRef=0]="CellRef",e[e.StructRef=1]="StructRef",e[e.NamedRange=2]="NamedRange",e[e.Parentheses=3]="Parentheses"}(l||(t.HighlightKind=l={})),function(e){e[e.Absolute=0]="Absolute",e[e.Relative=1]="Relative"}(u||(t.PositionKind=u={})),function(e){e[e.Failure=0]="Failure",e[e.Success=1]="Success",e[e.Unavailable=2]="Unavailable"}(c||(t.ValuePreviewResultKind=c={})),function(e){e[e.ReferenceFound=0]="ReferenceFound",e[e.NoReferenceFound=1]="NoReferenceFound",e[e.Failure=2]="Failure",e[e.RangeResolutionFailure=3]="RangeResolutionFailure",e[e.NotAFormula=4]="NotAFormula"}(d||(t.GotoCtrlClickResultKind=d={})),function(e){e[e.ArgumentAssistance=0]="ArgumentAssistance",e[e.SimpleAutoComplete=1]="SimpleAutoComplete",e[e.SmartSuggestionsAutoComplete=2]="SmartSuggestionsAutoComplete",e[e.ValuePreview=3]="ValuePreview",e[e.ColoredReferences=4]="ColoredReferences",e[e.ParenthesisCoupling=5]="ParenthesisCoupling",e[e.SyntaxErrors=6]="SyntaxErrors",e[e.GotoCtrlClick=7]="GotoCtrlClick",e[e.EnumAutoComplete=8]="EnumAutoComplete"}(m||(t.SchedulerFeature=m={})),function(e){e[e.Accept=0]="Accept",e[e.Decline=1]="Decline",e[e.Ignore=2]="Ignore"}(g||(t.ColumnFormulaSuggestionUpdateKind=g={})),function(e){e[e.Valid=2]="Valid",e[e.Invalid=4]="Invalid",e[e.All=6]="All"}(p||(t.RecognizedTablesMetadataState=p={})),function(e){e[e.none=0]="none",e[e.rowMajor=1]="rowMajor",e[e.columnMajor=2]="columnMajor"}(h||(t.TableOrientation=h={}))},18538:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PictureSpecial=t.PictureSingle=t.PictureDbnum=t.PictureColor=void 0;const n=r(19181);n.__exportStar(r(97896),t),n.__exportStar(r(94214),t),n.__exportStar(r(40971),t),n.__exportStar(r(70005),t),n.__exportStar(r(60387),t),n.__exportStar(r(6766),t),n.__exportStar(r(19272),t),n.__exportStar(r(83239),t),n.__exportStar(r(15584),t),n.__exportStar(r(3559),t);var i=r(93154);Object.defineProperty(t,"PictureColor",{enumerable:!0,get:function(){return i.PictureColor}}),Object.defineProperty(t,"PictureDbnum",{enumerable:!0,get:function(){return i.PictureDbnum}}),Object.defineProperty(t,"PictureSingle",{enumerable:!0,get:function(){return i.PictureSingle}}),Object.defineProperty(t,"PictureSpecial",{enumerable:!0,get:function(){return i.PictureSpecial}}),n.__exportStar(r(84705),t),n.__exportStar(r(42733),t),n.__exportStar(r(11641),t)},84705:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},17654:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;const n=r(57777);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},77876:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;const n=r(57777);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},71750:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PriorityQueue=void 0;const n=r(57777);t.PriorityQueue=n.priorityQueue.PriorityQueue},22266:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promiseLoop=t.promiseFinally=t.newPromise=t.isThenable=t.collapseThenable=t.bindMaybeThenable=t.MaybeThenable=void 0;const n=r(57777);t.MaybeThenable=n.promise.MaybeThenable,t.bindMaybeThenable=n.promise.bindMaybeThenable,t.collapseThenable=n.promise.collapseThenable,t.isThenable=n.promise.isThenable,t.newPromise=n.promise.newPromise,t.promiseFinally=n.promise.promiseFinally,t.promiseLoop=n.promise.promiseLoop},14122:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;const n=r(57777);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},82989:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSetTimeoutInterface=t.clearTimerUnified=t.setImmediateUnified=void 0;const n=r(57777);t.setImmediateUnified=n.setTimeoutInterfaceModule.setImmediateUnified,t.clearTimerUnified=n.setTimeoutInterfaceModule.clearTimerUnified,t.defaultSetTimeoutInterface=n.setTimeoutInterfaceModule.defaultSetTimeoutInterface},95395:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;const n=r(57777);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},36702:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapIntoResumeRecalc=t.emptyRangeFormat=t.emptyRangeFormula=t.emptyRangeValue=t.FormulaKind=void 0;const n=r(30095),i=r(29555),o=r(77876);var a;!function(e){e.Value="Value",e.CellFormula="CellFormula"}(a||(t.FormulaKind=a={})),t.emptyRangeValue=i.blankOper,t.emptyRangeFormula={kind:a.Value,formulaBarText:"",origin:(0,n.gridCell)(0,0)},(0,o.staticAssertExtends)(),t.emptyRangeFormat=0,t.wrapIntoResumeRecalc=function(e,t){return{evalClonedModelOnSnapshot:(r,...n)=>{const i=e.evalClonedModelOnSnapshot(r,...n);return t(r),i},discardSnapshot:e.discardSnapshot.bind(e),getRangeFormats:(r,...n)=>{const i=e.getRangeFormats(r,...n);return t(r),i},getRangeValues:(r,...n)=>{const i=e.getRangeValues(r,...n);return t(r),i},getRangeFormulae:(r,...n)=>{const i=e.getRangeFormulae(r,...n);return t(r),i},getSheetNames:(r,...n)=>{const i=e.getSheetNames(r,...n);return t(r),i},getIntersectingTables:(r,...n)=>{const i=e.getIntersectingTables(r,...n);return t(r),i},getIformats:(r,...n)=>{const i=e.getIformats(r,...n);return t(r),i},getHiddenRows:(r,...n)=>{const i=e.getHiddenRows(r,...n);return t(r),i},getHiddenCols:(r,...n)=>{const i=e.getHiddenCols(r,...n);return t(r),i},evalFormulaOnSnapshot:(r,...n)=>{const i=e.evalFormulaOnSnapshot(r,...n);return t(r),i},getCorrespondingSnapshotID:t=>e.getCorrespondingSnapshotID(t)}}},26128:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.spanCompare=t.Timeline=t.spanToLSPRange=t.indexToLSPPosition=void 0;const n=r(77876),i=r(28947),o=r(43512),a=r(17654),s=r(66932);function l(e,t){let r=0,i=0;for(;i<t;){const o=e.indexOf("\n",i),a=e.indexOf("\r",i),s=o<0?a:a<0?o:(0,n.fastMin)(o,a);if(s<0||s>=t)break;r+=1,i=s+1+(s===a&&s+1<t&&10===e.charCodeAt(s+1)?1:0)}return{line:r,character:t-i}}t.indexToLSPPosition=l,t.spanToLSPRange=function(e,t,r){return{start:l(e,t),end:l(e,r)}},t.Timeline=class{stamp(e){this.enabled&&!this.timestamps.has(e)&&this.timestamps.set(e,this.timer.now())}log(e){if(this.enabled){this.stamp(e);const t={};let r=this.timer.now(),n=0;this.timestamps.forEach(((e,i)=>{r=Math.min(r,e),n=Math.max(n,e),t[i]=e})),n-r>this.logThreshold&&a.ulsLogger.ULS.traceTag(526234881,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`Timeline[${this.name}]: ${JSON.stringify(Object.assign(Object.assign({},t),this.workerInfo))}`),this.timestamps.clear()}}constructor(e,t,r=!0){this.name=e,this.logThreshold=t,this.enabled=r,this.timestamps=new Map,this.timer=i.defaultTimerInterface,this.workerInfo={isWorkerThread:(0,s.isWorkerThread)(),workerName:(0,s.workerName)()},a.ulsLogger.ULS.traceTag(526223315,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`Timeline[${this.name}]: Initializing, ${JSON.stringify(this.workerInfo)}`)}},t.spanCompare=function(e,t){let r;return 0!=(r=e.start-t.start)||0!=(r=t.end-e.end)?r:0}},90277:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.gridinterface=t.helpers=t.mockGlobals=t.notificationKinds=t.testUtils=t.mockTimer=t.timelineQueueProcessor=t.repeatedTaskScheduler=t.types=t.PackageName=void 0;const n=r(19181);t.PackageName="excel-online-x10-types",t.types=n.__importStar(r(73132)),t.repeatedTaskScheduler=n.__importStar(r(20693)),t.timelineQueueProcessor=n.__importStar(r(28947)),t.mockTimer=n.__importStar(r(76338)),t.testUtils=n.__importStar(r(3872)),t.notificationKinds=n.__importStar(r(98687)),t.mockGlobals=n.__importStar(r(88275)),t.helpers=n.__importStar(r(26128)),t.gridinterface=n.__importStar(r(36702))},30095:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userDefinedFuncLoc=t.unsafeGridRange=t.structRefColumnLoc=t.sheetRows=t.sheetRangeIndexes=t.sheetRange=t.sheetIndex=t.sheetGridRange=t.sheetGridCube=t.sheetGridCell=t.sheetCols=t.originCell=t.nameScope=t.nameLoc=t.lexicalSourceRange=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceCell=t.isSheetIndex=t.isSheetGridRange=t.isSheetGridCell=t.isGridCell=t.gridRange=t.gridCell=t.documentScope=t.documentLoc=t.allSheetsRange=t.NameSource=t.LexicalKind=void 0;const n=r(81836);t.LexicalKind=n.location.LexicalKind,t.NameSource=n.location.NameSource,t.allSheetsRange=n.location.allSheetsRange,t.documentLoc=n.location.documentLoc,t.documentScope=n.location.documentScope,t.gridCell=n.location.gridCell,t.gridRange=n.location.gridRange,t.isGridCell=n.location.isGridCell,t.isSheetGridCell=n.location.isSheetGridCell,t.isSheetGridRange=n.location.isSheetGridRange,t.isSheetIndex=n.location.isSheetIndex,t.lexicalSourceCell=n.location.lexicalSourceCell,t.lexicalSourceGrid=n.location.lexicalSourceGrid,t.lexicalSourceName=n.location.lexicalSourceName,t.lexicalSourceWSF=n.location.lexicalSourceWSF,t.lexicalSourceUDF=n.location.lexicalSourceUDF,t.lexicalSourceRange=n.location.lexicalSourceRange,t.nameLoc=n.location.nameLoc,t.nameScope=n.location.nameScope,t.originCell=n.location.originCell,t.sheetCols=n.location.sheetCols,t.sheetGridCell=n.location.sheetGridCell,t.sheetGridCube=n.location.sheetGridCube,t.sheetGridRange=n.location.sheetGridRange,t.sheetIndex=n.location.sheetIndex,t.sheetRange=n.location.sheetRange,t.sheetRangeIndexes=n.location.sheetRangeIndexes,t.sheetRows=n.location.sheetRows,t.structRefColumnLoc=n.location.structRefColumnLoc,t.unsafeGridRange=n.location.unsafeGridRange,t.userDefinedFuncLoc=n.location.userDefinedFuncLoc},42408:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridRangeEqual=t.isSheetGridRange=t.isSheetGridCellEqual=t.isSheetGridCell=t.isRichOper=t.isReadOperEqual=t.isRangeOper=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isPrimitiveOper=t.isOperatorNode=t.isNumberOper=t.isNumberLiteralNode=t.isNameScopeEqual=t.isMissingOper=t.isMissingNode=t.isGridRangeEqual=t.isGridCellEqual=t.isGridCell=t.isErrorOper=t.isDocumentLocEqual=t.isCommaOpRefWellFormed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isBooleanOper=t.isBooleanLiteralNode=t.isBlankOper=t.isArrayOper=t.internal=t.gridRangesJoin=t.gridRangeSize=t.gridRangeJoinOpt=t.gridRangeJoin=t.gridRangeIsects=t.gridRangeIsect=t.gridRangeExcept=t.gridRangeCompare=t.gridRangeAnchor=t.gridCellRange=t.gridCellImplicitIsect=t.getWorksheetFuncId=t.getUserDefinedFuncName=t.getBoundName=t.getArguments=t.getArgType=t.forEachTileInRange=t.forEachCellInRange=t.createFailureErrorClass=t.ReasonKind=t.LangReasonKind=void 0,t.unavailable=t.shouldFieldRefBeBracketed=t.sheetGridRangeAnchor=t.notImplemented=t.normalizeCommaOpRef=t.isWriteOper=t.isWellFormed=t.isWSFNode=t.isValidArgsLength=t.isUnqualifiedNameNode=t.isStringOper=t.isSheetIndexEqual=t.isSheetIndex=void 0;const n=r(81836);t.LangReasonKind=n.util.LangReasonKind,t.ReasonKind=n.util.ReasonKind,t.createFailureErrorClass=n.util.createFailureErrorClass,t.forEachCellInRange=n.util.forEachCellInRange,t.forEachTileInRange=n.util.forEachTileInRange,t.getArgType=n.util.getArgType,t.getArguments=n.util.getArguments,t.getBoundName=n.util.getBoundName,t.getUserDefinedFuncName=n.util.getUserDefinedFuncName,t.getWorksheetFuncId=n.util.getWorksheetFuncId,t.gridCellImplicitIsect=n.util.gridCellImplicitIsect,t.gridCellRange=n.util.gridCellRange,t.gridRangeAnchor=n.util.gridRangeAnchor,t.gridRangeCompare=n.util.gridRangeCompare,t.gridRangeExcept=n.util.gridRangeExcept,t.gridRangeIsect=n.util.gridRangeIsect,t.gridRangeIsects=n.util.gridRangeIsects,t.gridRangeJoin=n.util.gridRangeJoin,t.gridRangeJoinOpt=n.util.gridRangeJoinOpt,t.gridRangeSize=n.util.gridRangeSize,t.gridRangesJoin=n.util.gridRangesJoin,t.internal=n.util.internal,t.isArrayOper=n.util.isArrayOper,t.isBlankOper=n.util.isBlankOper,t.isBooleanLiteralNode=n.util.isBooleanLiteralNode,t.isBooleanOper=n.util.isBooleanOper,t.isCommaOpClosed=n.util.isCommaOpClosed,t.isCommaOpNoBadOrMissing=n.util.isCommaOpNoBadOrMissing,t.isCommaOpRefWellFormed=n.util.isCommaOpRefWellFormed,t.isDocumentLocEqual=n.util.isDocumentLocEqual,t.isErrorOper=n.util.isErrorOper,t.isGridCell=n.util.isGridCell,t.isGridCellEqual=n.util.isGridCellEqual,t.isGridRangeEqual=n.util.isGridRangeEqual,t.isMissingNode=n.util.isMissingNode,t.isMissingOper=n.util.isMissingOper,t.isNameScopeEqual=n.util.isNameScopeEqual,t.isNumberLiteralNode=n.util.isNumberLiteralNode,t.isNumberOper=n.util.isNumberOper,t.isOperatorNode=n.util.isOperatorNode,t.isPrimitiveOper=n.util.isPrimitiveOper,t.isRangeOpClosed=n.util.isRangeOpClosed,t.isRangeOpNoMissing=n.util.isRangeOpNoMissing,t.isRangeOper=n.util.isRangeOper,t.isReadOperEqual=n.util.isReadOperEqual,t.isRichOper=n.util.isRichOper,t.isSheetGridCell=n.util.isSheetGridCell,t.isSheetGridCellEqual=n.util.isSheetGridCellEqual,t.isSheetGridRange=n.util.isSheetGridRange,t.isSheetGridRangeEqual=n.util.isSheetGridRangeEqual,t.isSheetIndex=n.util.isSheetIndex,t.isSheetIndexEqual=n.util.isSheetIndexEqual,t.isStringOper=n.util.isStringOper,t.isUnqualifiedNameNode=n.util.isUnqualifiedNameNode,t.isValidArgsLength=n.util.isValidArgsLength,t.isWSFNode=n.util.isWSFNode,t.isWellFormed=n.util.isWellFormed,t.isWriteOper=n.util.isWriteOper,t.normalizeCommaOpRef=n.util.normalizeCommaOpRef,t.notImplemented=n.util.notImplemented,t.sheetGridRangeAnchor=n.util.sheetGridRangeAnchor,t.shouldFieldRefBeBracketed=n.util.shouldFieldRefBeBracketed,t.unavailable=n.util.unavailable},29555:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valueErrorOper=t.trueOper=t.stringOper=t.refErrorOper=t.rangeSeqOper=t.range3DOper=t.precedents=t.numErrorOper=t.nullErrorOper=t.nameErrorOper=t.naErrorOper=t.missingOper=t.gettingDataErrorOper=t.fieldErrorOper=t.falseOper=t.errorOper=t.div0ErrorOper=t.cellStringLimit=t.booleanOper=t.blankOper=t.arrayOper=t.PrecsBound=t.ErrorType=void 0;const n=r(81836);t.ErrorType=n.value.ErrorType,t.PrecsBound=n.value.PrecsBound,t.arrayOper=n.value.arrayOper,t.blankOper=n.value.blankOper,t.booleanOper=n.value.booleanOper,t.cellStringLimit=n.value.cellStringLimit,t.div0ErrorOper=n.value.div0ErrorOper,t.errorOper=n.value.errorOper,t.falseOper=n.value.falseOper,t.fieldErrorOper=n.value.fieldErrorOper,t.gettingDataErrorOper=n.value.gettingDataErrorOper,t.missingOper=n.value.missingOper,t.naErrorOper=n.value.naErrorOper,t.nameErrorOper=n.value.nameErrorOper,t.nullErrorOper=n.value.nullErrorOper,t.numErrorOper=n.value.numErrorOper,t.precedents=n.value.precedents,t.range3DOper=n.value.range3DOper,t.rangeSeqOper=n.value.rangeSeqOper,t.refErrorOper=n.value.refErrorOper,t.stringOper=n.value.stringOper,t.trueOper=n.value.trueOper,t.valueErrorOper=n.value.valueErrorOper},88275:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MockGlobals=void 0;const n=r(14122),i=r(42408);t.MockGlobals=class{getDocumentLoc(){return(0,n.failure)((0,i.notImplemented)(["getDocumentLoc"]))}getSheetIndex(){return(0,n.failure)((0,i.notImplemented)(["getSheetIndex"]))}getSheetName(){return(0,n.failure)((0,i.notImplemented)(["getSheetName"]))}getNameLoc(){return(0,n.failure)((0,i.notImplemented)(["getNameLoc"]))}getUserDefinedFuncLoc(){return(0,n.failure)((0,i.notImplemented)(["getUserDefinedFuncLoc"]))}getSheetRangeIndexes(){return(0,n.failure)((0,i.notImplemented)(["getSheetRangeIndexes"]))}getContainingTable(){return(0,n.failure)((0,i.notImplemented)(["getContainingTable"]))}getStructRefColumn(){return(0,n.failure)((0,i.notImplemented)(["getStructRefColumn"]))}getStructRefSpecialRef(){return(0,n.failure)((0,i.notImplemented)(["getStructRefSpecialRef"]))}getTime(){return(0,n.failure)((0,i.unavailable)(["getTime"]))}constructor(e){this.config=e}}},76338:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MockTimerImmediate=t.MockTimer=void 0;const n=r(19181),i=r(71750),o=r(95395),a=r(82989);t.MockTimer=class{now(){const e=this.nowTimes.shift();if(void 0===e)throw"now was called too many times";return e}constructor(e){this.nowTimes=e,this.setImmediateCalls=[],this.setTimeoutCalls=[],this.clearImmediateCalls=[],this.clearTimeoutCalls=[],this.setImmediate=(e,...t)=>{if(void 0!==this.handle)throw"setImmediate called, even though we already have a callback";return this.setImmediateCalls.push([e,...t]),this.handle=(0,a.setImmediateUnified)((()=>(this.handle=void 0,e(...t))))},this.clearImmediate=e=>{if(this.handle!==e)throw"clearImmediate called with a different handle than the one supplied";(0,a.clearTimerUnified)(this.handle),this.clearImmediateCalls.push([e]),this.handle=void 0},this.setTimeout=(e,t,...r)=>{if(void 0!==this.handle)throw"setTimeout called, even though we already have a callback";return this.setTimeoutCalls.push([e,t,...r]),this.handle=(0,a.setImmediateUnified)((()=>(this.handle=void 0,e(...r))))},this.clearTimeout=e=>{if(this.handle!==e)throw"clearTimeout called with a different handle than the one supplied";(0,a.clearTimerUnified)(this.handle),this.clearTimeoutCalls.push([e]),this.handle=void 0}}};class s{preciseNow(){return this.time}now(){return Math.floor(this.time/this.precisionMs)*this.precisionMs}busyWait(e){this.time+=e>0?e:0}busyWaitUntil(e){this.time=this.time<e?e:this.time}runMacrotasksWhile(e){return n.__awaiter(this,void 0,void 0,(function*(){for(;;){if(yield new Promise((e=>setImmediate((()=>e())))),!e())return;const t=this.queue.pop();if(!t)return;if(this.busyWaitUntil(t.delayUntil),t.isValid)try{t.callback(...t.args)}catch(e){dispatchEvent(new ErrorEvent("error",{error:e,message:(0,o.messageFromError)(e),filename:"",lineno:0,colno:0}))}}}))}constructor(e=1,t=0){this.precisionMs=e,this.startTime=t,this.setImmediate=(e,...t)=>{const r={delayUntil:-1,callback:e,args:t,isValid:!0};return this.queue.enqueue(r),new s.Immediate(r)},this.clearImmediate=e=>{if(!(e instanceof s.Immediate))throw new TypeError("handle is not a MockFullTimer.Immediate");(0,a.clearTimerUnified)(e)},this.setTimeout=(e,t,...r)=>{const n={delayUntil:this.time+(t>4?t:4),callback:e,args:r,isValid:!0};return this.queue.enqueue(n),new s.Timeout(n)},this.clearTimeout=e=>{if(!(e instanceof s.Timeout))throw new TypeError("handle is not a MockFullTimer.Timeout");(0,a.clearTimerUnified)(e)},this.time=t>0?t:0,this.queue=new i.PriorityQueue(((e,t)=>e.delayUntil-t.delayUntil))}}t.MockTimerImmediate=s,s.Immediate=class{constructor(e){this.delayedCallback=e,this.kind="Mocking"}},s.Timeout=class{constructor(e){this.delayedCallback=e,this.kind="Mocking"}}},98687:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationKind=void 0,function(e){e.doNothing="doNothing",e.setActiveCell="setActiveCell",e.setActiveCellFormat="setActiveCellFormat",e.setFunctionsInfo="setFunctionsInfo",e.setDefinedNamesInfo="setDefinedNamesInfo",e.notifyWorkbookClosing="notifyWorkbookClosing",e.setSchedulerFeatures="setSchedulerFeatures",e.setA1ReferenceStyle="setA1ReferenceStyle",e.setLocale="setLocale",e.setWorkbookProps="setWorkbookProps",e.updateSheetNames="updateSheetNames",e.updateNamedObjects="updateNamedObjects",e.conflictResolverEarlyTermination="conflictResolverEarlyTermination",e.writeRange="writeRange",e.setNumberFormats="setNumberFormats"}(r||(t.NotificationKind=r={}))},20693:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RepeatedTaskScheduler=t.TaskKind=void 0;const n=r(17654),i=r(77876),o=r(82989);var a,s;function l(e,t){return{kind:e,handle:t}}function u(e){return void 0!==e?(e.kind=a.NoWorkScheduled,e.handle=void 0,e):l(a.NoWorkScheduled,void 0)}!function(e){e[e.NoWorkScheduled=0]="NoWorkScheduled",e[e.PromiseScheduled=1]="PromiseScheduled",e[e.ImmediateScheduled=2]="ImmediateScheduled",e[e.FutureScheduled=3]="FutureScheduled"}(a||(a={})),(0,i.staticAssertExtends)(),function(e){e.Sync="Sync",e.MicroTask="MicroTask",e.MacroTask="MacroTask"}(s||(t.TaskKind=s={}));const c=Promise.resolve();t.RepeatedTaskScheduler=class{runNextSynchronously(){switch(this.handleState.kind){case a.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break;case a.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}this.clearHandleClosureAndRunBody()}runNextAsMicrotask(){switch(this.handleState.kind){case a.PromiseScheduled:return;case a.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break;case a.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}var e;this.handleState=void 0!==(e=this.handleState)?(e.kind=a.PromiseScheduled,e.handle=void 0,e):l(a.PromiseScheduled,void 0),c.then(this.promiseClosure)}runNextAsMacrotask(){switch(this.handleState.kind){case a.ImmediateScheduled:return;case a.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}var e,t;this.handleState=(e=this.timer.setImmediate(this.clearHandleClosureAndRunBody),void 0!==(t=this.handleState)?(t.kind=a.ImmediateScheduled,t.handle=e,t):l(a.ImmediateScheduled,e))}runNextInFuture(e){switch(this.handleState.kind){case a.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break;case a.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle)}var t,r;this.handleState=(t=this.timer.setTimeout(this.clearHandleClosureAndRunBody,e),void 0!==(r=this.handleState)?(r.kind=a.FutureScheduled,r.handle=t,r):l(a.FutureScheduled,t))}clear(){switch(this.handleState.kind){case a.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break;case a.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle)}this.handleState=u(this.handleState)}constructor(e,t=o.defaultSetTimeoutInterface){this.timer=t,this.handleState=u(),this.clearHandleClosureAndRunBody=()=>{let t;switch(this.handleState.kind){case a.NoWorkScheduled:t=s.Sync;break;case a.PromiseScheduled:t=s.MicroTask;break;case a.ImmediateScheduled:case a.FutureScheduled:t=s.MacroTask;break;default:(0,n.assertNever)("Unknown handle state",this.handleState)}this.handleState=u(this.handleState),e(t)},this.promiseClosure=()=>{this.handleState.kind===a.PromiseScheduled&&this.clearHandleClosureAndRunBody()}}}},3872:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runQueueProcessorUntil=void 0;const n=r(19181),i=r(22266);t.runQueueProcessorUntil=function(e,t){return n.__awaiter(this,void 0,void 0,(function*(){let r=!1;const o=Promise.resolve(t);o.then((()=>r=!0));let a=0;return yield(0,i.promiseLoop)((()=>n.__awaiter(this,void 0,void 0,(function*(){if(++a%100==0&&(yield new Promise((e=>setTimeout(e,1)))),!r)return e.step(),!0}))),!0),o}))}},28947:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimelineQueueProcessor=t.defaultTimerInterface=void 0;const n=r(77876),i=r(71750),o=r(82989),a=r(20693);t.defaultTimerInterface=Object.assign(Object.assign({},o.defaultSetTimeoutInterface),{now:n.now}),t.TimelineQueueProcessor=class{enqueue(e,t,r=this.maxWitnessedNow){this.queue.enqueue({delayUntil:r,payload:e,abstractCost:t}),this.continue()}push(e,t,r=this.maxWitnessedNow){this.queue.push({delayUntil:r,payload:e,abstractCost:t}),this.continue()}pop(){var e;return 1===this.queue.getCount()&&this.scheduler.clear(),null===(e=this.queue.pop())||void 0===e?void 0:e.payload}peek(){return this.queue.peek()}getCount(){return this.queue.getCount()}continue(){var e;for(this.startTime=null!==(e=this.startTime)&&void 0!==e?e:this.now();this.totalSyncCost<this.costThreshold;){const e=this.queue.peek();if(void 0===e)return;if(e.delayUntil>this.maxWitnessedNow&&this.tryRunNextInFuture(e.delayUntil,this.now()))return;this.queue.pop(),this.totalSyncCost+=e.abstractCost,this.consumeMessage(e.payload)}const t=this.queue.peek();if(void 0===t)return;const r=this.now();r-this.startTime<this.timeThreshold&&t.delayUntil<=r?this.scheduler.runNextAsMicrotask():this.tryRunNextInFuture(t.delayUntil,r)||this.scheduler.runNextAsMacrotask()}tryRunNextInFuture(e,t){return e>t&&(this.lastFutureAbsoluteTime!==e&&(this.lastFutureAbsoluteTime=e,this.scheduler.runNextInFuture(e-t)),!0)}now(){return this.maxWitnessedNow=this.timer.now()}constructor(e,r,n,o=t.defaultTimerInterface){var s,l;this.cmp=e,this.consumeMessage=r,this.timer=o,this.startTime=void 0,this.totalSyncCost=0,this.maxWitnessedNow=0,this.lastFutureAbsoluteTime=void 0,this.queue=new i.PriorityQueue(((t,r)=>{const n=t.delayUntil-r.delayUntil;return 0!==n?n:e(t.payload,r.payload)})),this.costThreshold=null!==(s=null==n?void 0:n.costThreshold)&&void 0!==s?s:1,this.timeThreshold=null!==(l=null==n?void 0:n.timeThreshold)&&void 0!==l?l:10,this.scheduler=new a.RepeatedTaskScheduler((e=>{this.totalSyncCost=0,this.lastFutureAbsoluteTime=void 0,e===a.TaskKind.MacroTask&&(this.startTime=void 0),this.continue()}),o)}}},73132:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.SpecialFormat=void 0,function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.ClientValueUnknown="ClientValueUnknown",e.Origin="Origin",e.Aggregate="Aggregate",e.Inferred="Inferred",e.Known="Known",e.Edit="Edit"}(r||(t.SpecialFormat=r={}))},167:function(e,t){"use strict";function r(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0,t.getChangeGateDictionary=r,t.isChangeGateEnabled=function(e){var t;return null===(t=r()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},68877:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var r={};function n(){return void 0===globalThis.__get_feature_gate_dictionary_variable?r:globalThis.__get_feature_gate_dictionary_variable()}function i(e,t){var r;return null!==(r=n()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=n,t.getStringFeatureGate=i,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=i(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=i(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=i(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t}},12367:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(19181);n.__exportStar(r(68877),t),n.__exportStar(r(33160),t),n.__exportStar(r(167),t),n.__exportStar(r(32869),t),n.__exportStar(r(76919),t),n.__exportStar(r(56157),t)},33160:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(68877);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},32869:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(167);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},76919:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(19181),i=r(167);function o(e){var t=(0,i.setChangeGateDictionaryGetter)(void 0);return(0,i.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=o,t.overrideTypedChangeGates=function(e,t){return o(t)}},56157:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(19181),i=r(68877);function o(e){for(var t,r,o={},a=0,s=Object.keys(e);a<s.length;a++){var l=s[a];o[l]=null===(t=e[l])||void 0===t?void 0:t.toString()}var u=null!==(r=(0,i.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,i.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},u()),o)})),u}t.overrideFeatureGates=o,t.overrideTypedFeatureGates=function(e,t){return o(t)}},33393:function(e,t,r){"use strict";r.r(t),r.d(t,{convertDataFields:function(){return i},getTelemetryLogger:function(){return s},setTelemetryLogger:function(){return a}});var n=r(54930);function i(e){var t=!0,r=[];return e.forEach((function(e){var i,o=e.classification;if(o===n.o.DataClassification.SystemMetadata||o===n.o.DataClassification.EssentialServiceMetadata){var a=((i={}).name=e.name,i.bool=null,i.string=null,i.double=null,i.int64=null,i.date=null,i.contract=null,i);switch(e.dataType){case n.o.DataFieldType.Boolean:a.bool=e.value;break;case n.o.DataFieldType.Double:a.double=e.value;break;case n.o.DataFieldType.Int64:a.int64=e.value;break;case n.o.DataFieldType.String:a.string=e.value;break;case n.o.DataFieldType.Guid:default:return}r.push(a)}else t=!1})),t?r:[]}var o=r(27328);function a(e){globalThis.__otel_util_telemetry_logger__=e}function s(){return void 0===globalThis.__otel_util_telemetry_logger__&&(globalThis.__otel_util_telemetry_logger__=new o.M),globalThis.__otel_util_telemetry_logger__}},66932:function(e,t,r){"use strict";r.r(t),r.d(t,{Endpoint:function(){return U},WorkerError:function(){return c},createWorker:function(){return oe},dispatchWorkerError:function(){return b},importScriptsWithRetry:function(){return W},isThreadingSupported:function(){return S},isWorkerThread:function(){return V},paramInsideDef:function(){return k},setConfig:function(){return v},workerName:function(){return j}});var n={};r.r(n),r.d(n,{Endpoint:function(){return U},WorkerError:function(){return c},dispatchWorkerError:function(){return b},importScriptsWithRetry:function(){return W},isThreadingSupported:function(){return S},isWorkerThread:function(){return V},paramInsideDef:function(){return k},setConfig:function(){return v},workerName:function(){return j}});var i=r(19181);function o(e){return a(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function a(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function s(e){return a(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function l(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,(0,i.__assign)((0,i.__assign)({},t),{error:t.error?l(t.error):void 0})):void 0};var t}function u(e){return a(e)?{isError:!0,value:l(e)}:{isError:!1,value:e}}var c=function(e){function t(t,r){var n,o=this.constructor,a=e.call(this,"".concat(t,"; info = ").concat(JSON.stringify((0,i.__assign)((0,i.__assign)({},r),{error:null===(n=r.error)||void 0===n?void 0:n.message}))))||this;a.baseMessage=t,a.info=r,a.name="WorkerError";var s=o.prototype;return Object.getPrototypeOf(a)!==s&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(a,s):a.__proto__=s),a}return(0,i.__extends)(t,e),t.isWorkerError=o,t}(Error),d={Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError};function m(e){var t;if("WorkerError"===e.name)t=new c(e.message,function(e){return(0,i.__assign)((0,i.__assign)({},e),{error:e.error?m(e.error):void 0})}(e.info));else{var r=d[e.name];r?t=new r(e.message):(t=new Error(e.message)).name=e.name}return null!=e.stack&&(t.stack=e.stack),t}function g(e){return e.isError?m(e.value):e.value}var p,h,f="Thread";function S(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}function v(e){if(h)throw new TypeError("setConfig has already been called");h=e}function y(){var e=null!=h?h:{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?(0,i.__spreadArray)([],e.importScriptUrls,!0):void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName,importScriptsMaxRetries:e.importScriptsMaxRetries}}function F(e){setTimeout((function(){throw e}))}function C(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function R(e){var t=C();if(void 0!==t){var r={kind:p.WorkerError,error:u(e)};t.postMessage(r)}else console.warn(e)}function b(e){var t;try{(null!==(t=null==h?void 0:h.onWorkerError)&&void 0!==t?t:R)(e)}catch(t){console.warn(e),F(t)}}function E(e){var t=C();if(void 0!==t){var r={kind:p.CreateWorker,stats:e};t.postMessage(r)}}function T(e){var t;try{(null!==(t=null==h?void 0:h.onCreateWorker)&&void 0!==t?t:E)(e)}catch(e){F(e)}}!function(e){e[e.InitResult=0]="InitResult",e[e.WorkerError=1]="WorkerError",e[e.CreateWorker=2]="CreateWorker"}(p||(p={}));var k=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return k.transfer.apply(k,(0,i.__spreadArray)([e,void 0],t,!1))};k.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var P=r(12367),N=(0,P.makeTypedIsChangeGateEnabled)(["OfficeVSO:WINum_CGExample","OfficeVSO:5592319_TypedWorkersProxyPromiseFix"]);function A(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))}(0,P.makeGetTypedFeatureGate)({"Microsoft.Office.Shared.FGExample":!0});var I,O,_=1<<30;function M(e,t,r){if(e>_)return r;var n=setTimeout(t,Math.max(0,e));return{resolve:function(e){clearTimeout(n),r.resolve(e)},reject:function(e){clearTimeout(n),r.reject(e)}}}function D(){var e=Object.create(null);return e.key=void 0,delete e.key,e}function w(e,t){var r=D(),n=N("OfficeVSO:5592319_TypedWorkersProxyPromiseFix")?function(t,r){var n;return"then"===r?void 0:null!==(n=t[r])&&void 0!==n?n:t[r]=e(r)}:function(t,r){var n;return null!==(n=t[r])&&void 0!==n?n:t[r]=e(r)};return t?(t.forEach((function(e){return n(r,e)})),r):new Proxy(r,{get:n})}function L(e){throw e}!function(e){e[e.Invoke=0]="Invoke",e[e.Result=1]="Result",e[e.Names=2]="Names",e[e.Close=3]="Close"}(O||(O={}));var x=-1,K=function(){function e(e,t){var r,n,i=this;this.idInfo=e,this.port=t,this.isClosed=!1,this.exports={},this.unresolvedCalls=D();var o=function(){var e;return null===(e=i.onClose)||void 0===e?void 0:e.call(i)},a=((r={})[O.Invoke]=this.onInvoke.bind(this),r[O.Result]=this.onResult.bind(this),r[O.Names]=function(e){var t,r=e.funcNames;null===(t=i.onImports)||void 0===t||t.call(i,w(i.createPostProxy.bind(i),r),w(i.createCallProxy.bind(i),r))},r[O.Close]=o,r),s=((n={})[O.Invoke]=this.onSendInvokeFailed.bind(this),n[O.Result]=this.onSendResultFailed.bind(this),n[O.Names]=o,n[O.Close]=o,n);this.port.onmessage=function(e){var t=e.data;return a[t.kind](t)},this.port.onmessageerror=function(e){var t=e.data;return s[t.kind](t)}}return e.prototype.setExports=function(e){this.exports=e;var t=(null!=I?I:I=function(){try{return"function"==typeof Proxy&&!0===new Proxy({},{get:function(){return!0}}).k}catch(e){return!1}}())?void 0:function(e){for(var t=D();null!=e;){for(var r=0,n=Object.getOwnPropertyNames(e);r<n.length;r++){var i=n[r];try{"function"==typeof e[i]&&(t[i]=!0)}catch(e){}}e=Object.getPrototypeOf(e)}return Object.getOwnPropertyNames(t)}(e),r={kind:O.Names,funcNames:t};this.port.postMessage(r)},e.prototype.close=function(){if(!this.isClosed){this.isClosed=!0;var e={kind:O.Close};for(var t in this.port.postMessage(e),this.port.close(),this.unresolvedCalls){var r=this.unresolvedCalls[t],n=r.reject,i=r.funcName,o={cause:"Connection",idInfo:this.idInfo,funcName:i};n(new c("Importing Endpoint closed while waiting for ".concat(i," result"),o))}}},e.prototype.onInvoke=function(e){var t=this,r=e.callId,n=e.funcName,i=e.args,o=Promise.resolve().then((function(){var e=t.exports[n];if(e)return e.apply(t.exports,i);var o=r>=0?"call":"post",a={cause:"Connection",idInfo:t.idInfo,callId:r,funcName:n};throw new c("Exporting Endpoint received a ".concat(o," to unknown function ").concat(n),a)}));r>=0?o.then((function(e){return t.sendResult(r,n,!0,e)}),(function(e){return t.sendResult(r,n,!1,e)})):o.catch((function(e){var i=s(e),o={cause:"UnhandledError",idInfo:t.idInfo,error:i,callId:r,funcName:n};b(new c("Exporting Endpoint's ".concat(n," implementation threw or rejected"),o))}))},e.prototype.sendResult=function(e,t,r,n){var i=u(n),o={kind:O.Result,callId:e,funcName:t,isFulfilled:r,resultValue:i};try{this.port.postMessage(o,void 0)}catch(e){this.onSendResultFailed(o,s(e))}},e.prototype.onSendResultFailed=function(e,t){var r=e.callId,n=e.funcName,i=e.resultValue,o=t?"Exporting Endpoint failed to send ".concat(n," result"):"Importing Endpoint failed to deserialize ".concat(n," result"),a={cause:"MessageError",idInfo:this.idInfo,error:t,callId:r,funcName:n},s=new c(o,a);i.isError?b(s):this.sendResult(r,n,!1,s)},e.prototype.takeCallbacks=function(e){var t=this.unresolvedCalls[e];return t&&delete this.unresolvedCalls[e],t},e.prototype.setCallTimeout=function(e,t,r,n){var i=this;return r>_?n:M(r,(function(){var n=i.takeCallbacks(e);if(n){var o={cause:"Timeout",idInfo:i.idInfo,timeout:r,callId:e,funcName:t};n.reject(new c("Importing Endpoint's call to ".concat(t," timed out"),o))}}),n)},e.prototype.sendCall=function(e,t,r,n){var o=this;return new Promise((function(a,l){var u=x+=1,d={kind:O.Invoke,callId:u,funcName:e,args:t};o.unresolvedCalls[u]=(0,i.__assign)((0,i.__assign)({},o.setCallTimeout(u,e,r,{resolve:a,reject:l})),{funcName:e});try{o.port.postMessage(d,n)}catch(t){var m=o.takeCallbacks(u);if(m){var g=s(t),p={cause:"MessageError",idInfo:o.idInfo,error:g,callId:u,funcName:e};m.reject(new c("Importing Endpoint failed to send call to ".concat(e),p))}}}))},e.prototype.sendPost=function(e,t,r,n){var i={kind:O.Invoke,callId:-1,funcName:e,args:t};try{this.port.postMessage(i,n)}catch(t){var o=s(t),a={cause:"MessageError",idInfo:this.idInfo,error:o,callId:-1,funcName:e};r(new c("Importing Endpoint failed to post to ".concat(e),a))}},e.prototype.onSendInvokeFailed=function(e){var t,r=e.callId,n=e.funcName,i=r>=0?"call":"post",o={cause:"MessageError",idInfo:this.idInfo,callId:r,funcName:n},a=new c("Exporting Endpoint failed to deserialize ".concat(i," to ").concat(n),o),s=r>=0?this.takeCallbacks(r):void 0;(null!==(t=null==s?void 0:s.reject)&&void 0!==t?t:b)(a)},e.prototype.onResult=function(e){var t=e.callId,r=e.funcName,n=e.isFulfilled,i=e.resultValue;if(t>=0){var o=this.takeCallbacks(t);o&&(n?o.resolve:o.reject)(g(i))}else{var a={cause:"InternalError",idInfo:this.idInfo,callId:t,funcName:r};b(new c("Exporting Endpoint sent a result for a post to ".concat(r),a))}},e.prototype.createPostProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,(0,i.__spreadArray)([void 0],e,!1))};return r.transfer=function(n){for(var i,o,a,s=[],l=1;l<arguments.length;l++)s[l-1]=arguments[l];if(!t.isClosed){var u=null!==(a=null!==(i=r.onPostMessageError)&&void 0!==i?i:null===(o=t.getOnPostMessageError)||void 0===o?void 0:o.call(t))&&void 0!==a?a:L;t.sendPost(e,s,u,n)}},r},e.prototype.createCallProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,(0,i.__spreadArray)([void 0],e,!1))};return r.transfer=function(n){for(var i,o,a,s=[],l=1;l<arguments.length;l++)s[l-1]=arguments[l];if(t.isClosed){var u={cause:"Connection",idInfo:t.idInfo,funcName:e};return Promise.reject(new c("".concat(t.idInfo.side," Endpoint's call.").concat(e," called after close"),u))}var d=null!==(a=null!==(i=r.callTimeout)&&void 0!==i?i:null===(o=t.getCallTimeout)||void 0===o?void 0:o.call(t))&&void 0!==a?a:1/0;return t.sendCall(e,s,d,n)},r.callTimeout=void 0,r},e}(),U=function(){function e(e,t,r){this.callTimeout=1/0,this.onPostMessageError=L,this._idInfo=e,this._state=t,this.createMode=r;var n=function(t){return function(){var r="Outside"===e.side?"inside":"outside",n={cause:"Connection",idInfo:e};throw new c("".concat(e.side," Endpoint's ").concat(t," referenced before the ").concat(r," Endpoint started"),n)}};Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:n("post")},call:{configurable:!0,enumerable:!1,get:n("call")}})}return e._create=function(t,r,n){var i,o,a=r.port,s=r.options,l=r.createMode,u={type:"Endpoint",side:t,id:null==s?void 0:s.id};try{i=new K(u,a),o=new e(u,i,l)}catch(e){return Promise.reject(e)}return new Promise((function(e,r){var a;i.getCallTimeout=function(){return o.callTimeout},i.getOnPostMessageError=function(){return o.onPostMessageError},i.onImports=function(e,t){Object.defineProperties(o,{post:{configurable:!0,enumerable:!1,writable:!1,value:e},call:{configurable:!0,enumerable:!1,writable:!1,value:t}}),m.resolve()},i.onClose=function(){return o.close("Force")};var l,d=function(e){var t,r;return null!==(r=null!==(t=null==e?void 0:e.createTimeout)&&void 0!==t?t:null==h?void 0:h.createTimeout)&&void 0!==r?r:3e5}(s),m=M(d,(function(){var e="Outside"===t?"inside":"outside",r={cause:"Timeout",idInfo:u,timeout:d},n=new c("".concat(t," Endpoint timed out waiting for the ").concat(e," to start"),r);m.reject(n)}),{resolve:e,reject:r});o._closedDuringCreate=function(){m.resolve()};try{l=n(o)}catch(e){return m.reject(e)}null===(a=o._state)||void 0===a||a.setExports(l)})).then((function(){return o._closedDuringCreate=void 0,o}),(function(e){return o._closedDuringCreate=void 0,o.close(),Promise.reject(e)}))},e.prototype.hasBeenClosed=function(){return void 0===this._state},e.prototype.close=function(e){var t,r;if(this._state){if(this._closedDuringCreate){if("Force"!==e){var n={cause:"Connection",idInfo:this._idInfo};throw new c("".concat(this._idInfo.side," Endpoint's close called during creation"),n)}this._closedDuringCreate()}var i=this._state;this._state=void 0;try{i.close(),null===(t=this._onClose)||void 0===t||t.call(this),null===(r=this.onClose)||void 0===r||r.call(this)}catch(e){n={cause:"Connection",idInfo:this._idInfo,error:s(e)},b(new c("".concat(this._idInfo.side," Endpoint's close threw an error"),n))}}},e.createOutside=function(t,r){return void 0===r&&(r=function(){}),e._create("Outside",t,r)},e.createInside=function(t,r){return e._create("Inside",t,r)},e}();function B(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var i=e.slice(0,n+1),o=e.slice(n+1).split("&"),a=0;a<o.length&&("="!==o[a][t.length]||o[a].slice(0,t.length)!==t);a+=1);return o[a]="".concat(t,"=").concat(r),i+o.join("&")}function G(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?B(e,"retries",String(n)):e)}catch(e){r=e}throw r}function W(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++)G(n[r],t);else importScripts.apply(void 0,e)}function V(){return"undefined"!=typeof WorkerGlobalScope}function j(){return self.name}const q='!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=8)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__esDecorate",(function(){return f})),r.d(t,"__runInitializers",(function(){return l})),r.d(t,"__propKey",(function(){return s})),r.d(t,"__setFunctionName",(function(){return d})),r.d(t,"__metadata",(function(){return p})),r.d(t,"__awaiter",(function(){return y})),r.d(t,"__generator",(function(){return v})),r.d(t,"__createBinding",(function(){return _})),r.d(t,"__exportStar",(function(){return g})),r.d(t,"__values",(function(){return b})),r.d(t,"__read",(function(){return h})),r.d(t,"__spread",(function(){return m})),r.d(t,"__spreadArrays",(function(){return w})),r.d(t,"__spreadArray",(function(){return O})),r.d(t,"__await",(function(){return j})),r.d(t,"__asyncGenerator",(function(){return G})),r.d(t,"__asyncDelegator",(function(){return S})),r.d(t,"__asyncValues",(function(){return P})),r.d(t,"__makeTemplateObject",(function(){return T})),r.d(t,"__importStar",(function(){return E})),r.d(t,"__importDefault",(function(){return F})),r.d(t,"__classPrivateFieldGet",(function(){return k})),r.d(t,"__classPrivateFieldSet",(function(){return C})),r.d(t,"__classPrivateFieldIn",(function(){return D}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t,r,n,o,i){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var u,c=n.kind,f="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?n.static?e:e.prototype:null,s=t||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),d=!1,p=r.length-1;p>=0;p--){var y={};for(var v in n)y[v]="access"===v?{}:n[v];for(var v in n.access)y.access[v]=n.access[v];y.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(e||null))};var _=(0,r[p])("accessor"===c?{get:s.get,set:s.set}:s[f],y);if("accessor"===c){if(void 0===_)continue;if(null===_||"object"!=typeof _)throw new TypeError("Object expected");(u=a(_.get))&&(s.get=u),(u=a(_.set))&&(s.set=u),(u=a(_.init))&&o.push(u)}else(u=a(_))&&("field"===c?o.push(u):s[f]=u)}l&&Object.defineProperty(l,n.name,s),d=!0}function l(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function s(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function y(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function v(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}var _=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function g(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||_(t,e,r)}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function w(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function O(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function j(e){return this instanceof j?(this.v=e,this):new j(e)}function G(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof j?Promise.resolve(r.value.v).then(c,f):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function S(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:j(e[n](t)),done:!1}:o?o(t):t}:o}}function P(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=b(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function T(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var x=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&_(t,e,r);return x(t,e),t}function F(e){return e&&e.__esModule?e:{default:e}}function k(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function C(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function D(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n={};function o(){return void 0===globalThis.__get_feature_gate_dictionary_variable?n:globalThis.__get_feature_gate_dictionary_variable()}function i(e,t){var r;return null!==(r=o()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=o,t.getStringFeatureGate=i,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=i(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=i(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=i(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";function n(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0,t.getChangeGateDictionary=n,t.isChangeGateEnabled=function(e){var t;return null===(t=n()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(4),t),n.__exportStar(r(2),t),n.__exportStar(r(5),t),n.__exportStar(r(6),t),n.__exportStar(r(7),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function i(e){for(var t,r,i={},a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];i[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),i)})),f}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){return i(e)?{isError:!0,value:u(e)}:{isError:!1,value:e}}function f(e){throw new ReferenceError("".concat(e," is not defined"))}function l(e,t,r){void 0===r&&(r=f);try{for(var n=t.split("."),o=0,i=n;o<i.length;o++){e=e[i[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var s=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return s.transfer.apply(s,Object(n.__spreadArray)([e,void 0],t,!1))};s.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var d;!function(e){e[e.InitResult=0]="InitResult",e[e.WorkerError=1]="WorkerError",e[e.CreateWorker=2]="CreateWorker"}(d||(d={}));var p="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function y(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:p()))}function v(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),i=e.slice(n+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(r),o+i.join("&")}function _(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?v(e,"retries",String(n)):e)}catch(e){r=e}throw r}function g(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){_(n[r],t)}else importScripts.apply(void 0,e)}var b=r(3);self.onmessage=function(e){var t,r,i=e.data,u=i.config,f=i.port,s=i.options,v=i.script,_=i.args,h=i.featureGateDictionary,m=i.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(b.setFeatureGateDictionaryGetter)((function(){return h})),Object(b.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=s.importScriptsMaxRetries)&&void 0!==t?t:u.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===u.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return g([u.typedWorkersUrl],O),(w=l(self,null!==(e=u.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(u),w}var G={status:"Pending",start:p()};function S(e,t){var r=e?void 0:c(a(t)),n={kind:d.InitResult,error:r,stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw y(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=y(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return g(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==s?void 0:s.importScriptUrls)&&void 0!==e?e:u.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==v.scriptUrl?[v.scriptUrl]:[],!0),O),l(self,v.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:u,importTypedWorkers:j,connection:{port:f,options:s,createMode:"Thread"}}],_,!1))})).then((function(){return S(!0)}),(function(e){return S(!1,e)}))}catch(e){S(!1,e)}}}]);';var H=-1,z=function(){function e(e,t){var r,n;try{var i;r=function(e){var t="def"in e?e:k(e),r=t.def,n=t.args,i=t.transferables;if("function"!=typeof r)return[r,n,i,void 0];var o="__generatedInsideInit".concat(H+=1);return[{scriptUrl:void 0,insideInitName:o},n,i,"var ".concat(o," = ").concat(r.toString(),";")]}(t),this.script=r[0],this.args=r[1],this.transferables=r[2];var o=void 0===(i=r[3])?[q]:[i,"\n\n",q];this.blobUrl=URL.createObjectURL(new Blob(o,{type:"application/javascript"}));var a={};null!=e.id&&(a.name=e.id),this.worker=new Worker(this.blobUrl,a)}catch(e){throw null===(n=this.worker)||void 0===n||n.terminate(),this.revokeBlobUrl(),e}}return e.prototype.revokeBlobUrl=function(){void 0!==this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)},e.prototype.createInside=function(e,t){var r=this,n=e.port,s=e.options,l={type:"Thread",side:"Outside",id:s.id},u=this.worker,d=new Promise((function(e,d){r.createCallbacks={resolve:e,reject:d};var m={config:y(),port:n,options:s,script:r.script,args:r.args,featureGateDictionary:(0,P.getFeatureGateDictionary)(),changeGateDictionary:(0,P.getChangeGateDictionary)()};u.postMessage(m,(0,i.__spreadArray)([n],r.transferables,!0)),u.onerror=function(e){e.preventDefault();var t=function(e,t,r){if(a(r.error)){if(o(r.error))return r.error;var n={cause:"UnhandledError",idInfo:e,error:r.error};return new c("".concat(t," received an unhandled error"),n)}if(null==r.message){var i={cause:"UnhandledError",idInfo:e};return new c("".concat(t," received a non-error (worker script fetch probably failed)"),i)}var s={cause:"UnhandledError",idInfo:e},l="".concat(r.message," at ").concat(r.filename,":").concat(r.lineno,":").concat(r.colno);return new c("".concat(t," received an unhandled error: ").concat(l),s)}(l,"worker.onerror",e);r.createCallbacks?r.createCallbacks.reject(t):b(t)},u.onmessage=function(e){var n,i,o=e.data;switch(o.kind){case p.InitResult:return t.insideInit=o.stopwatch,void 0===o.error?null===(n=r.createCallbacks)||void 0===n?void 0:n.resolve():null===(i=r.createCallbacks)||void 0===i?void 0:i.reject(g(o.error));case p.WorkerError:return b(g(o.error));case p.CreateWorker:return T(o.stats)}}}));return A(d,(function(){r.createCallbacks=void 0}))},e.prototype.terminate=function(){var e;if(this.worker){var t=this.worker;this.worker=void 0,null===(e=this.createCallbacks)||void 0===e||e.resolve(),t.terminate(),this.revokeBlobUrl()}},e}(),$="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function Q(){return{status:"Pending",start:$()}}function Y(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:$()))}function J(e,t){function r(t){throw Y(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=Y(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}}function X(e){return Math.round(1e3*e)/1e3}function Z(e,t,r){return e<t?t:e>r?r:e}function ee(e,t,r){var n,i,o,a=Z(null!==(n=null==e?void 0:e.start)&&void 0!==n?n:1/0,t,r),s=Z(null!==(i=null==e?void 0:e.end)&&void 0!==i?i:1/0,t,r);return{status:null!==(o=null==e?void 0:e.status)&&void 0!==o?o:"Pending",start:X(a-t),end:X(s-t),duration:X(s-a)}}var te=(0,i.__assign)((0,i.__assign)({},n),{createWorker:oe});function re(e,t,r,n,i){var o,a=new MessageChannel,s=a.port1,l=a.port2;return Promise.all([n({port:s,options:e,createMode:t}),J(r.createOutside=Q(),(function(){return U.createOutside({port:l,options:e,createMode:t},(function(e){return i(o=e)}))}))]).then((function(){return o}),(function(e){return o?o.close("Force"):l.close(),Promise.reject(e)}))}function ne(e,t,r,n){return re(e,"Local",t,(function(e){return function(e,t,r){var n="def"in r?r:k(r),o=n.def,a=n.args;if("function"!=typeof o){var s={cause:"InternalError",idInfo:{type:"Endpoint",side:"Inside",id:e.options.id}};return Promise.reject(new c("Loading an InsideScript to create a local worker is unimplemented",s))}return Promise.resolve().then((function(){return J(t.insideInit=Q(),(function(){return o.apply(void 0,(0,i.__spreadArray)([{config:y(),importTypedWorkers:function(){return te},connection:e}],a,!1)).then((function(){}))}))}))}(e,t,r)}),n)}function ie(e,t,r,n){var i;t.createThread=Q();try{i=new z(e,r)}catch(e){return Y(t.createThread,"Error"),Promise.reject(e)}return Y(t.createThread,"Success"),re(e,"Thread",t,(function(e){return i.createInside(e,t)}),n).then((function(e){return e.hasBeenClosed()?i.terminate():e._onClose=i.terminate.bind(i),e}),(function(e){return i.terminate(),Promise.reject(e)}))}function oe(e,t,r){void 0===r&&(r=function(){});var n=function(e){var t,r,n=null!==(r=null!==(t=null==e?void 0:e.createMode)&&void 0!==t?t:null==h?void 0:h.createMode)&&void 0!==r?r:f;return"ThreadOrLocal"===n?S()?"Thread":"Local":n}(e),i="local"in t?"Local"===n?t.local:t.thread:t,o="Local"===n?ne:ie,a={id:e.id,createMode:n,createWorker:Q()},s=J(a.createWorker,(function(){return o(function(e){return{id:e.id,createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls,importScriptsMaxRetries:e.importScriptsMaxRetries}}(e),a,i,r)}));return A(s,(function(){var e=function(e){var t=e.id,r=e.createMode,n=e.createWorker,i=e.insideInit,o=e.createOutside,a=e.createThread,s=n.status,l=n.start,u=n.end;if("Pending"!==s&&void 0!==u)return{id:t,createMode:r,createWorker:{status:s,absStart:l,duration:X(u-l)},createThread:"Thread"===r?ee(a,l,u):void 0,createOutside:ee(o,l,u),insideInit:ee(i,l,u)}}(a);e&&T(e)}))}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(45856);var n=r(65839);excelOnlineCalc=n}();
//# sourceMappingURL=excelOnlineCalcWP5.min.js.map